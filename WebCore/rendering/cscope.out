cscope 15 /data/WebKit-r57509_back/WebKit-r57509/WebCore/rendering               0002295977
	@AutoTableLayout.cpp

22 
	~"cÚfig.h
"

23 
	~"AutoTabËLayout.h
"

25 
	~"R’d”TabË.h
"

26 
	~"R’d”TabËC–l.h
"

27 
	~"R’d”TabËCŞ.h
"

28 
	~"R’d”TabËSeùiÚ.h
"

30 
usšg
 
Çme¥aû
 
	g¡d
;

32 
Çme¥aû
 
	gWebCÜe
 {

34 
	gAutoTabËLayout
::
AutoTabËLayout
(
R’d”TabË
* 
bË
)

35 : 
TabËLayout
(
bË
)

36 , 
m_hasP”ûÁ
(
çl£
)

37 , 
m_³rûÁagesDœty
(
Œue
)

38 , 
m_effWidthDœty
(
Œue
)

39 , 
m_tÙ®P”ûÁ
(0)

43 
	gAutoTabËLayout
::~
AutoTabËLayout
()

51 
AutoTabËLayout
::
»ÿlcCŞumn
(
effCŞ
)

53 
Layout
 &
l
 = 
m_ÏyoutSŒuù
[
effCŞ
];

55 
R’d”Objeù
* 
	gchd
 = 
m_bË
->
fœ¡Chd
();

58 
R’d”TabËC–l
* 
	gfixedCÚŒibutÜ
 = 0;

59 
R’d”TabËC–l
* 
	gmaxCÚŒibutÜ
 = 0;

61 
	gchd
) {

62 ià(
	gchd
->
isTabËCŞ
())

63 
toR’d”TabËCŞ
(
chd
)->
ÿlcP»fWidths
();

64 ià(
	gchd
->
isTabËSeùiÚ
()) {

65 
R’d”TabËSeùiÚ
* 
	g£ùiÚ
 = 
toR’d”TabËSeùiÚ
(
chd
);

66 
	gnumRows
 = 
£ùiÚ
->
numRows
();

67 
R’d”TabËC–l
* 
	gÏ¡
 = 0;

68 
	gi
 = 0; i < 
	gnumRows
; i++) {

69 
	gR’d”TabËSeùiÚ
::
C–lSŒuù
 
cu¼’t
 = 
£ùiÚ
->
ûÎAt
(
i
, 
effCŞ
);

70 
R’d”TabËC–l
* 
	gûÎ
 = 
cu¼’t
.
ûÎ
;

72 
boŞ
 
	gûÎHasCÚ‹Á
 = 
ûÎ
 && (ûÎ->
fœ¡Chd
(è|| c–l->
¡yË
()->
hasBÜd”
(è|| c–l->¡yË()->
hasPaddšg
());

73 ià(
	gûÎHasCÚ‹Á
)

74 
	gl
.
	gem±yC–lsOÆy
 = 
çl£
;

76 ià(
	gcu¼’t
.
	gšCŞS·n
)

78 ià(
	gûÎ
 && c–l->
cŞS·n
() == 1) {

81 
l
.
mšWidth
 = 
max
Ö.mšWidth, 
ûÎHasCÚ‹Á
 ? 1 : 0);

82 
	gl
.
	gmaxWidth
 = 
max
(
l
.
maxWidth
, 1);

83 ià(
	gûÎ
->
´efWidthsDœty
())

84 
	gûÎ
->
ÿlcP»fWidths
();

85 
	gl
.
	gmšWidth
 = 
max
(
ûÎ
->
mšP»fWidth
(), 
l
.
mšWidth
);

86 ià(
	gûÎ
->
maxP»fWidth
(è> 
	gl
.
	gmaxWidth
) {

87 
	gl
.
	gmaxWidth
 = 
ûÎ
->
maxP»fWidth
();

88 
	gmaxCÚŒibutÜ
 = 
ûÎ
;

91 
L’gth
 
	gw
 = 
ûÎ
->
¡yËOrCŞWidth
();

93 ià(
	gw
.
¿wV®ue
() > 32760)

94 
	gw
.
£tRawV®ue
(32760);

95 ià(
	gw
.
isNeg©ive
())

96 
	gw
.
£tV®ue
(0);

97 
	gw
.
ty³
()) {

98 
	gFixed
:

100 ià(
w
.
v®ue
(è> 0 && ()
l
.
width
.
ty³
(è!ğ
P”ûÁ
) {

101 
wv®
 = 
ûÎ
->
ÿlcBÜd”BoxWidth
(
w
.
v®ue
());

102 ià(
	gl
.
	gwidth
.
isFixed
()) {

104 ià((
	gwv®
 > 
	gl
.
	gwidth
.
v®ue
()) ||

105 ((
	gl
.
	gwidth
.
v®ue
(è=ğ
wv®
è&& (
maxCÚŒibutÜ
 =ğ
ûÎ
))) {

106 
l
.
width
.
£tV®ue
(
wv®
);

107 
	gfixedCÚŒibutÜ
 = 
ûÎ
;

110 
	gl
.
	gwidth
.
£tV®ue
(
Fixed
, 
wv®
);

111 
	gfixedCÚŒibutÜ
 = 
ûÎ
;

115 
	gP”ûÁ
:

116 
m_hasP”ûÁ
 = 
Œue
;

117 ià(
	gw
.
isPos™ive
(è&& (!
	gl
.
	gwidth
.
isP”ûÁ
(è|| w.
¿wV®ue
() >†.width.rawValue()))

118 
	gl
.
	gwidth
 = 
w
;

120 
	gR–©ive
:

123 ià(
w
.
isAuto
(è|| (w.
isR–©ive
(è&& w.
v®ue
(è> 
l
.
width
.
¿wV®ue
()))

124 
l
.
width
 = 
w
;

129 ià(
	gûÎ
 && (!
	geffCŞ
 || 
	g£ùiÚ
->
ûÎAt
(
i
, 
effCŞ
-1).ûÎ !ğ
ûÎ
)) {

132 
l
.
mšWidth
 = 
max
Ö.mšWidth, 
ûÎHasCÚ‹Á
 ? 1 : 0);

133 
	gl
.
	gmaxWidth
 = 
max
(
l
.
maxWidth
, 1);

134 
š£¹S·nC–l
(
ûÎ
);

136 
	gÏ¡
 = 
ûÎ
;

140 
	gchd
 = 
chd
->
ÃxtSiblšg
();

144 ià(
	gl
.
	gwidth
.
isFixed
()) {

145 ià(
	gm_bË
->
¡yË
()->
htmlHacks
(è&& 
	gl
.
	gmaxWidth
 >†.
	gwidth
.
v®ue
(è&& 
	gfixedCÚŒibutÜ
 !ğ
maxCÚŒibutÜ
) {

146 
l
.
width
 = 
L’gth
();

147 
	gfixedCÚŒibutÜ
 = 0;

151 
	gl
.
	gmaxWidth
 = 
max
(
l
.
maxWidth
,†.
mšWidth
);

156 
	gAutoTabËLayout
::
fuÎReÿlc
()

158 
m_³rûÁagesDœty
 = 
Œue
;

159 
	gm_hasP”ûÁ
 = 
çl£
;

160 
	gm_effWidthDœty
 = 
Œue
;

162 
	gnEffCŞs
 = 
m_bË
->
numEffCŞs
();

163 
	gm_ÏyoutSŒuù
.
»size
(
nEffCŞs
);

164 
	gm_ÏyoutSŒuù
.
fl
(
Layout
());

165 
	gm_¥ªC–ls
.
fl
(0);

167 
R’d”Objeù
 *
	gchd
 = 
m_bË
->
fœ¡Chd
();

168 
L’gth
 
	gg½Width
;

169 
	gcCŞ
 = 0;

170 
	gchd
) {

171 ià(
	gchd
->
isTabËCŞ
()) {

172 
R’d”TabËCŞ
 *
	gcŞ
 = 
toR’d”TabËCŞ
(
chd
);

173 
	g¥ª
 = 
cŞ
->
¥ª
();

174 ià(
	gcŞ
->
fœ¡Chd
()) {

175 
	gg½Width
 = 
cŞ
->
¡yË
()->
width
();

177 
L’gth
 
	gw
 = 
cŞ
->
¡yË
()->
width
();

178 ià(
	gw
.
isAuto
())

179 
	gw
 = 
g½Width
;

180 ià((
	gw
.
isFixed
(è|| w.
isP”ûÁ
()è&& w.
isZ”o
())

181 
	gw
 = 
L’gth
();

182 
	gcEffCŞ
 = 
m_bË
->
cŞToEffCŞ
(
cCŞ
);

183 ià(!
	gw
.
isAuto
(è&& 
	g¥ª
 =ğ1 && 
cEffCŞ
 < 
nEffCŞs
) {

184 ià(
m_bË
->
¥ªOfEffCŞ
(
cEffCŞ
) == 1) {

185 
m_ÏyoutSŒuù
[
cEffCŞ
].
width
 = 
w
;

186 ià(
	gw
.
isFixed
(è&& 
	gm_ÏyoutSŒuù
[
cEffCŞ
].
	gmaxWidth
 < w.
v®ue
())

187 
	gm_ÏyoutSŒuù
[
cEffCŞ
].
	gmaxWidth
 = 
w
.
v®ue
();

190 
	gcCŞ
 +ğ
¥ª
;

196 
R’d”Objeù
 *
	gÃxt
 = 
chd
->
fœ¡Chd
();

197 ià(!
	gÃxt
)

198 
	gÃxt
 = 
chd
->
ÃxtSiblšg
();

199 ià(!
	gÃxt
 && 
	gchd
->
·»Á
()->
isTabËCŞ
()) {

200 
	gÃxt
 = 
chd
->
·»Á
()->
ÃxtSiblšg
();

201 
	gg½Width
 = 
L’gth
();

203 
	gchd
 = 
Ãxt
;

207 
	gi
 = 0; i < 
	gnEffCŞs
; i++)

208 
»ÿlcCŞumn
(
i
);

211 
boŞ
 
shouldSÿËCŞumns
(
R’d”TabË
* 
bË
)

215 
boŞ
 
	gsÿË
 = 
Œue
;

216 
	gbË
) {

217 
L’gth
 
	gtw
 = 
bË
->
¡yË
()->
width
();

218 ià((
	gtw
.
isAuto
(è||w.
isP”ûÁ
()è&& !
	gbË
->
isPos™iÚed
()) {

219 
R’d”Block
* 
	gcb
 = 
bË
->
cÚššgBlock
();

220 
	gcb
 && !cb->
isR’d”V›w
(è&& !cb->
isTabËC–l
() &&

221 
	gcb
->
¡yË
()->
width
().
isAuto
(è&& !cb->
isPos™iÚed
())

222 
	gcb
 = 
cb
->
cÚššgBlock
();

224 
	gbË
 = 0;

225 ià(
	gcb
 && cb->
isTabËC–l
() &&

226 (
	gcb
->
¡yË
()->
width
().
isAuto
(è|| cb->¡yË()->width().
isP”ûÁ
())) {

227 ià(
	gtw
.
isP”ûÁ
())

228 
	gsÿË
 = 
çl£
;

230 
R’d”TabËC–l
* 
	gûÎ
 = 
toR’d”TabËC–l
(
cb
);

231 ià(
	gûÎ
->
cŞS·n
(è> 1 || c–l->
bË
()->
¡yË
()->
width
().
isAuto
())

232 
	gsÿË
 = 
çl£
;

234 
	gbË
 = 
ûÎ
->
bË
();

239 
	gbË
 = 0;

241  
	gsÿË
;

244 
	gAutoTabËLayout
::
ÿlcP»fWidths
(& 
mšWidth
, & 
maxWidth
)

246 
fuÎReÿlc
();

248 
	g¥ªMaxWidth
 = 
ÿlcEfãùiveWidth
();

249 
	gmšWidth
 = 0;

250 
	gmaxWidth
 = 0;

251 
	gmaxP”ûÁ
 = 0;

252 
	gmaxNÚP”ûÁ
 = 0;

253 
boŞ
 
	gsÿËCŞumns
 = 
shouldSÿËCŞumns
(
m_bË
);

257 cÚ¡ 
	g•sÚ
 = 1;

259 
	g»maššgP”ûÁ
 = 100 * 
³rûÁSÿËFaùÜ
;

260 
	gi
 = 0; i < 
	gm_ÏyoutSŒuù
.
size
(); i++) {

261 
	gmšWidth
 +ğ
m_ÏyoutSŒuù
[
i
].
effMšWidth
;

262 
	gmaxWidth
 +ğ
m_ÏyoutSŒuù
[
i
].
effMaxWidth
;

263 ià(
	gsÿËCŞumns
) {

264 ià(
	gm_ÏyoutSŒuù
[
i
].
	geffWidth
.
isP”ûÁ
()) {

265 
	g³rûÁ
 = 
mš
(
m_ÏyoutSŒuù
[
i
].
effWidth
.
¿wV®ue
(), 
»maššgP”ûÁ
);

266 
	gpw
 = 
¡©ic_ÿ¡
<>(
m_ÏyoutSŒuù
[
i
].
effMaxWidth
è* 100 * 
³rûÁSÿËFaùÜ
 / 
max
(
³rûÁ
, 
•sÚ
);

267 
	gmaxP”ûÁ
 = 
max
(
pw
, 
maxP”ûÁ
);

268 
	g»maššgP”ûÁ
 -ğ
³rûÁ
;

270 
	gmaxNÚP”ûÁ
 +ğ
m_ÏyoutSŒuù
[
i
].
effMaxWidth
;

274 ià(
	gsÿËCŞumns
) {

275 
	gmaxNÚP”ûÁ
 = 
maxNÚP”ûÁ
 * 100 * 
³rûÁSÿËFaùÜ
 / 
max
(
»maššgP”ûÁ
, 
•sÚ
);

276 
	gmaxWidth
 = 
max
(
maxWidth
, 
¡©ic_ÿ¡
<>(
mš
(
maxNÚP”ûÁ
, 
INT_MAX
 / 2.0f)));

277 
	gmaxWidth
 = 
max
(
maxWidth
, 
¡©ic_ÿ¡
<>(
mš
(
maxP”ûÁ
, 
INT_MAX
 / 2.0f)));

280 
	gmaxWidth
 = 
max
(
maxWidth
, 
¥ªMaxWidth
);

282 
	gbs
 = 
m_bË
->
bÜd”sPaddšgAndS·cšg
();

283 
	gmšWidth
 +ğ
bs
;

284 
	gmaxWidth
 +ğ
bs
;

286 
L’gth
 
	gtw
 = 
m_bË
->
¡yË
()->
width
();

287 ià(
	gtw
.
isFixed
(è&&w.
v®ue
() > 0) {

288 
	gmšWidth
 = 
max
(
mšWidth
, 
tw
.
v®ue
());

289 
	gmaxWidth
 = 
mšWidth
;

297 
	gAutoTabËLayout
::
ÿlcEfãùiveWidth
()

299 
tMaxWidth
 = 0;

301 
	gnEffCŞs
 = 
m_ÏyoutSŒuù
.
size
();

302 
	gh¥acšg
 = 
m_bË
->
hBÜd”S·cšg
();

304 
	gi
 = 0; i < 
	gnEffCŞs
; i++) {

305 
	gm_ÏyoutSŒuù
[
i
].
	geffWidth
 = 
m_ÏyoutSŒuù
[i].
width
;

306 
	gm_ÏyoutSŒuù
[
i
].
	geffMšWidth
 = 
m_ÏyoutSŒuù
[i].
mšWidth
;

307 
	gm_ÏyoutSŒuù
[
i
].
	geffMaxWidth
 = 
m_ÏyoutSŒuù
[i].
maxWidth
;

310 
	gi
 = 0; i < 
	gm_¥ªC–ls
.
size
(); i++) {

311 
R’d”TabËC–l
 *
	gûÎ
 = 
m_¥ªC–ls
[
i
];

312 ià(!
	gûÎ
)

314 
	g¥ª
 = 
ûÎ
->
cŞS·n
();

316 
L’gth
 
	gw
 = 
ûÎ
->
¡yËOrCŞWidth
();

317 ià(!
	gw
.
isR–©ive
(è&& w.
isZ”o
())

318 
	gw
 = 
L’gth
();

320 
	gcŞ
 = 
m_bË
->
cŞToEffCŞ
(
ûÎ
->
cŞ
());

321 
	gÏ¡CŞ
 = 
cŞ
;

322 
	gcMšWidth
 = 
ûÎ
->
mšP»fWidth
(è+ 
h¥acšg
;

323 
	gcMaxWidth
 = 
ûÎ
->
maxP»fWidth
(è+ 
h¥acšg
;

324 
	gtÙ®P”ûÁ
 = 0;

325 
	gmšWidth
 = 0;

326 
	gmaxWidth
 = 0;

327 
boŞ
 
	g®lCŞsA»P”ûÁ
 = 
Œue
;

328 
boŞ
 
	g®lCŞsA»Fixed
 = 
Œue
;

329 
boŞ
 
	ghaveAuto
 = 
çl£
;

330 
boŞ
 
	g¥ªHasEm±yC–lsOÆy
 = 
Œue
;

331 
	gfixedWidth
 = 0;

332 
	gÏ¡CŞ
 < 
	gnEffCŞs
 && 
	g¥ª
 > 0) {

333 
	gm_ÏyoutSŒuù
[
Ï¡CŞ
].
	gwidth
.
ty³
()) {

334 
	gP”ûÁ
:

335 
tÙ®P”ûÁ
 +ğ
m_ÏyoutSŒuù
[
Ï¡CŞ
].
width
.
¿wV®ue
();

336 
	g®lCŞsA»Fixed
 = 
çl£
;

338 
	gFixed
:

339 ià(
m_ÏyoutSŒuù
[
Ï¡CŞ
].
width
.
v®ue
() > 0) {

340 
fixedWidth
 +ğ
m_ÏyoutSŒuù
[
Ï¡CŞ
].
width
.
v®ue
();

341 
	g®lCŞsA»P”ûÁ
 = 
çl£
;

347 
	gAuto
:

348 
haveAuto
 = 
Œue
;

358 ià(!
m_ÏyoutSŒuù
[
Ï¡CŞ
].
effWidth
.
isP”ûÁ
()) {

359 
m_ÏyoutSŒuù
[
Ï¡CŞ
].
effWidth
 = 
L’gth
();

360 
	g®lCŞsA»P”ûÁ
 = 
çl£
;

363 
	gtÙ®P”ûÁ
 +ğ
m_ÏyoutSŒuù
[
Ï¡CŞ
].
effWidth
.
¿wV®ue
();

364 
	g®lCŞsA»Fixed
 = 
çl£
;

366 ià(!
	gm_ÏyoutSŒuù
[
Ï¡CŞ
].
	gem±yC–lsOÆy
)

367 
	g¥ªHasEm±yC–lsOÆy
 = 
çl£
;

368 
	g¥ª
 -ğ
m_bË
->
¥ªOfEffCŞ
(
Ï¡CŞ
);

369 
	gmšWidth
 +ğ
m_ÏyoutSŒuù
[
Ï¡CŞ
].
effMšWidth
;

370 
	gmaxWidth
 +ğ
m_ÏyoutSŒuù
[
Ï¡CŞ
].
effMaxWidth
;

371 
	gÏ¡CŞ
++;

372 
	gcMšWidth
 -ğ
h¥acšg
;

373 
	gcMaxWidth
 -ğ
h¥acšg
;

377 ià(
	gw
.
isP”ûÁ
()) {

378 ià(
	gtÙ®P”ûÁ
 > 
	gw
.
¿wV®ue
(è|| 
	g®lCŞsA»P”ûÁ
) {

380 
	gw
 = 
L’gth
();

382 
	g¥ªMax
 = 
max
(
maxWidth
, 
cMaxWidth
);

383 
	gtMaxWidth
 = 
max
(
tMaxWidth
, 
¥ªMax
 * 100 * 
³rûÁSÿËFaùÜ
 / 
w
.
¿wV®ue
());

386 
	g³rûÁMissšg
 = 
w
.
¿wV®ue
(è- 
tÙ®P”ûÁ
;

387 
	gtÙ®Width
 = 0;

388 
	gpos
 = 
cŞ
;…o < 
	gÏ¡CŞ
;…os++) {

389 ià(!(
	gm_ÏyoutSŒuù
[
pos
].
	geffWidth
.
isP”ûÁ
()))

390 
	gtÙ®Width
 +ğ
m_ÏyoutSŒuù
[
pos
].
effMaxWidth
;

393 
	gpos
 = 
cŞ
;…o < 
	gÏ¡CŞ
 && 
	gtÙ®Width
 > 0;…os++) {

394 ià(!(
	gm_ÏyoutSŒuù
[
pos
].
	geffWidth
.
isP”ûÁ
())) {

395 
	g³rûÁ
 = 
¡©ic_ÿ¡
<>(
³rûÁMissšg
 * stic_ÿ¡<>(
m_ÏyoutSŒuù
[
pos
].
effMaxWidth
è/ 
tÙ®Width
);

396 
	gtÙ®Width
 -ğ
m_ÏyoutSŒuù
[
pos
].
effMaxWidth
;

397 
	g³rûÁMissšg
 -ğ
³rûÁ
;

398 ià(
	g³rûÁ
 > 0)

399 
	gm_ÏyoutSŒuù
[
pos
].
	geffWidth
.
£tRawV®ue
(
P”ûÁ
, 
³rûÁ
);

401 
	gm_ÏyoutSŒuù
[
pos
].
	geffWidth
 = 
L’gth
();

409 ià(
	gcMšWidth
 > 
	gmšWidth
) {

410 ià(
	g®lCŞsA»Fixed
) {

411 
	gpos
 = 
cŞ
; 
	gfixedWidth
 > 0 &&…o < 
	gÏ¡CŞ
;…os++) {

412 
	gw
 = 
max
(
m_ÏyoutSŒuù
[
pos
].
effMšWidth
, 
cMšWidth
 * m_ÏyoutSŒuù[pos].
width
.
v®ue
(è/ 
fixedWidth
);

413 
	gfixedWidth
 -ğ
m_ÏyoutSŒuù
[
pos
].
width
.
v®ue
();

414 
	gcMšWidth
 -ğ
w
;

415 
	gm_ÏyoutSŒuù
[
pos
].
	geffMšWidth
 = 
w
;

419 
	gmaxw
 = 
maxWidth
;

420 
	gmšw
 = 
mšWidth
;

423 
	gpos
 = 
cŞ
; 
	gmaxw
 >ğ0 && 
pos
 < 
Ï¡CŞ
;…os++) {

424 ià(
	gm_ÏyoutSŒuù
[
pos
].
	gwidth
.
isFixed
(è&& 
	ghaveAuto
 && 
	gfixedWidth
 <ğ
cMšWidth
) {

425 
w
 = 
max
(
m_ÏyoutSŒuù
[
pos
].
effMšWidth
, m_ÏyoutSŒuù[pos].
width
.
v®ue
());

426 
	gfixedWidth
 -ğ
m_ÏyoutSŒuù
[
pos
].
width
.
v®ue
();

427 
	gmšw
 -ğ
m_ÏyoutSŒuù
[
pos
].
effMšWidth
;

428 
	gmaxw
 -ğ
m_ÏyoutSŒuù
[
pos
].
effMaxWidth
;

429 
	gcMšWidth
 -ğ
w
;

430 
	gm_ÏyoutSŒuù
[
pos
].
	geffMšWidth
 = 
w
;

434 
	gpos
 = 
cŞ
; 
	gmaxw
 >ğ0 && 
pos
 < 
Ï¡CŞ
 && 
mšw
 < 
cMšWidth
;…os++) {

435 ià(!(
	gm_ÏyoutSŒuù
[
pos
].
	gwidth
.
isFixed
(è&& 
	ghaveAuto
 && 
	gfixedWidth
 <ğ
cMšWidth
)) {

436 
w
 = 
max
(
m_ÏyoutSŒuù
[
pos
].
effMšWidth
, 
¡©ic_ÿ¡
<>(
maxw
 ? 
cMšWidth
 * stic_ÿ¡<>(m_ÏyoutSŒuù[pos].
effMaxWidth
) / maxw : cMinWidth));

437 
	gw
 = 
mš
(
m_ÏyoutSŒuù
[
pos
].
effMšWidth
+(
cMšWidth
-
mšw
), 
w
);

439 
	gmaxw
 -ğ
m_ÏyoutSŒuù
[
pos
].
effMaxWidth
;

440 
	gmšw
 -ğ
m_ÏyoutSŒuù
[
pos
].
effMšWidth
;

441 
	gcMšWidth
 -ğ
w
;

442 
	gm_ÏyoutSŒuù
[
pos
].
	geffMšWidth
 = 
w
;

447 ià(!(
	gw
.
isP”ûÁ
())) {

448 ià(
	gcMaxWidth
 > 
	gmaxWidth
) {

449 
	gpos
 = 
cŞ
; 
	gmaxWidth
 >ğ0 && 
pos
 < 
Ï¡CŞ
;…os++) {

450 
	gw
 = 
max
(
m_ÏyoutSŒuù
[
pos
].
effMaxWidth
, 
¡©ic_ÿ¡
<>(
maxWidth
 ? 
cMaxWidth
 * static_cast<>(m_layoutStruct[pos].effMaxWidth) / maxWidth : cMaxWidth));

451 
	gmaxWidth
 -ğ
m_ÏyoutSŒuù
[
pos
].
effMaxWidth
;

452 
	gcMaxWidth
 -ğ
w
;

453 
	gm_ÏyoutSŒuù
[
pos
].
	geffMaxWidth
 = 
w
;

457 
	gpos
 = 
cŞ
;…o < 
	gÏ¡CŞ
;…os++)

458 
	gm_ÏyoutSŒuù
[
pos
].
	gmaxWidth
 = 
max
(
m_ÏyoutSŒuù
[pos].
maxWidth
, m_ÏyoutSŒuù[pos].
mšWidth
);

461 ià(
	g¥ªHasEm±yC–lsOÆy
)

462 
	gpos
 = 
cŞ
;…o < 
	gÏ¡CŞ
;…os++)

463 
	gm_ÏyoutSŒuù
[
pos
].
	gem±yC–lsOÆy
 = 
çl£
;

465 
	gm_effWidthDœty
 = 
çl£
;

467  
	g¡©ic_ÿ¡
<>(
mš
(
tMaxWidth
, 
INT_MAX
 / 2.0f));

473 
	gAutoTabËLayout
::
š£¹S·nC–l
(
R’d”TabËC–l
 *
ûÎ
)

475 ià(!
ûÎ
 || c–l->
cŞS·n
() == 1)

478 
	gsize
 = 
m_¥ªC–ls
.
size
();

479 ià(!
	gsize
 || 
	gm_¥ªC–ls
[
size
-1] != 0) {

480 
m_¥ªC–ls
.
grow
(
size
 + 10);

481 
	gi
 = 0; i < 10; i++)

482 
	gm_¥ªC–ls
[
size
+
i
] = 0;

483 
	gsize
 += 10;

487 
	gpos
 = 0;

488 
	g¥ª
 = 
ûÎ
->
cŞS·n
();

489 
	gpos
 < 
	gm_¥ªC–ls
.
size
(è&& m_¥ªC–ls[
pos
] && 
	g¥ª
 > m_¥ªC–ls[pos]->
cŞS·n
())

490 
	gpos
++;

491 
memmove
(
m_¥ªC–ls
.
d©a
()+
pos
+1, m_¥ªC–ls.d©a()+pos, (
size
-pos-1)*(
R’d”TabËC–l
 *));

492 
	gm_¥ªC–ls
[
pos
] = 
ûÎ
;

496 
	gAutoTabËLayout
::
Ïyout
()

499 
bËWidth
 = 
m_bË
->
width
(è- m_bË->
bÜd”sPaddšgAndS·cšg
();

500 
	gavaabË
 = 
bËWidth
;

501 
	gnEffCŞs
 = 
m_bË
->
numEffCŞs
();

503 ià(
	gnEffCŞs
 !ğ()
m_ÏyoutSŒuù
.
size
()) {

504 
fuÎReÿlc
();

505 
	gnEffCŞs
 = 
m_bË
->
numEffCŞs
();

508 ià(
	gm_effWidthDœty
)

509 
ÿlcEfãùiveWidth
();

511 
boŞ
 
	ghaveP”ûÁ
 = 
çl£
;

512 
boŞ
 
	ghaveR–©ive
 = 
çl£
;

513 
	gtÙ®R–©ive
 = 0;

514 
	gnumAuto
 = 0;

515 
	gnumFixed
 = 0;

516 
	gtÙ®Auto
 = 0;

517 
	gtÙ®Fixed
 = 0;

518 
	gtÙ®P”ûÁ
 = 0;

519 
	g®locAuto
 = 0;

520 
	gnumAutoEm±yC–lsOÆy
 = 0;

523 
	gi
 = 0; i < 
	gnEffCŞs
; i++) {

524 
	gw
 = 
m_ÏyoutSŒuù
[
i
].
effMšWidth
;

525 
	gm_ÏyoutSŒuù
[
i
].
	gÿlcWidth
 = 
w
;

526 
	gavaabË
 -ğ
w
;

527 
	gL’gth
& 
	gwidth
 = 
m_ÏyoutSŒuù
[
i
].
effWidth
;

528 
	gwidth
.
ty³
()) {

529 
	gP”ûÁ
:

530 
haveP”ûÁ
 = 
Œue
;

531 
	gtÙ®P”ûÁ
 +ğ
width
.
¿wV®ue
();

533 
	gR–©ive
:

534 
haveR–©ive
 = 
Œue
;

535 
	gtÙ®R–©ive
 +ğ
width
.
v®ue
();

537 
	gFixed
:

538 
numFixed
++;

539 
	gtÙ®Fixed
 +ğ
m_ÏyoutSŒuù
[
i
].
effMaxWidth
;

542 
	gAuto
:

543 
Stic
:

544 ià(
m_ÏyoutSŒuù
[
i
].
em±yC–lsOÆy
)

545 
numAutoEm±yC–lsOÆy
++;

547 
	gnumAuto
++;

548 
	gtÙ®Auto
 +ğ
m_ÏyoutSŒuù
[
i
].
effMaxWidth
;

549 
	g®locAuto
 +ğ
w
;

558 ià(
	gavaabË
 > 0 && 
	ghaveP”ûÁ
) {

559 
	gi
 = 0; i < 
	gnEffCŞs
; i++) {

560 
	gL’gth
 &
	gwidth
 = 
m_ÏyoutSŒuù
[
i
].
effWidth
;

561 ià(
	gwidth
.
isP”ûÁ
()) {

562 
	gw
 = 
max
((
m_ÏyoutSŒuù
[
i
].
effMšWidth
), 
width
.
ÿlcMšV®ue
(
bËWidth
));

563 
	gavaabË
 +ğ
m_ÏyoutSŒuù
[
i
].
ÿlcWidth
 - 
w
;

564 
	gm_ÏyoutSŒuù
[
i
].
	gÿlcWidth
 = 
w
;

567 ià(
	gtÙ®P”ûÁ
 > 100 * 
	g³rûÁSÿËFaùÜ
) {

569 
	gexûss
 = 
bËWidth
*(
tÙ®P”ûÁ
 - 100 * 
³rûÁSÿËFaùÜ
) / (100 *…ercentScaleFactor);

570 
	gi
 = 
nEffCŞs
-1; i >= 0; i--) {

571 ià(
	gm_ÏyoutSŒuù
[
i
].
	geffWidth
.
isP”ûÁ
()) {

572 
	gw
 = 
m_ÏyoutSŒuù
[
i
].
ÿlcWidth
;

573 
	g»duùiÚ
 = 
mš
(
w
, 
exûss
);

575 
	gexûss
 -ğ
»duùiÚ
;

576 
	gÃwWidth
 = 
max
(
¡©ic_ÿ¡
<>(
m_ÏyoutSŒuù
[
i
].
effMšWidth
), 
w
 - 
»duùiÚ
);

577 
	gavaabË
 +ğ
w
 - 
ÃwWidth
;

578 
	gm_ÏyoutSŒuù
[
i
].
	gÿlcWidth
 = 
ÃwWidth
;

585 ià(
	gavaabË
 > 0) {

586 
	gi
 = 0; i < 
	gnEffCŞs
; ++i) {

587 
	gL’gth
 &
	gwidth
 = 
m_ÏyoutSŒuù
[
i
].
effWidth
;

588 ià(
	gwidth
.
isFixed
(è&& width.
v®ue
(è> 
	gm_ÏyoutSŒuù
[
i
].
	gÿlcWidth
) {

589 
	gavaabË
 +ğ
m_ÏyoutSŒuù
[
i
].
ÿlcWidth
 - 
width
.
v®ue
();

590 
	gm_ÏyoutSŒuù
[
i
].
	gÿlcWidth
 = 
width
.
v®ue
();

596 ià(
	gavaabË
 > 0) {

597 
	gi
 = 0; i < 
	gnEffCŞs
; i++) {

598 
	gL’gth
 &
	gwidth
 = 
m_ÏyoutSŒuù
[
i
].
effWidth
;

599 ià(
	gwidth
.
isR–©ive
(è&& width.
v®ue
() != 0) {

601 
w
 = 
width
.
v®ue
(è* 
bËWidth
 / 
tÙ®R–©ive
;

602 
	gavaabË
 +ğ
m_ÏyoutSŒuù
[
i
].
ÿlcWidth
 - 
w
;

603 
	gm_ÏyoutSŒuù
[
i
].
	gÿlcWidth
 = 
w
;

609 ià(
	gavaabË
 > 0 && 
	gnumAuto
) {

610 
	gavaabË
 +ğ
®locAuto
;

611 
	gi
 = 0; i < 
	gnEffCŞs
; i++) {

612 
	gL’gth
 &
	gwidth
 = 
m_ÏyoutSŒuù
[
i
].
effWidth
;

613 ià(
	gwidth
.
isAuto
(è&& 
	gtÙ®Auto
 !ğ0 && !
m_ÏyoutSŒuù
[
i
].
em±yC–lsOÆy
) {

614 
w
 = 
max
(
m_ÏyoutSŒuù
[
i
].
ÿlcWidth
, 
¡©ic_ÿ¡
<>(
avaabË
 * stic_ÿ¡<>(m_ÏyoutSŒuù[i].
effMaxWidth
è/ 
tÙ®Auto
));

615 
	gavaabË
 -ğ
w
;

616 
	gtÙ®Auto
 -ğ
m_ÏyoutSŒuù
[
i
].
effMaxWidth
;

617 
	gm_ÏyoutSŒuù
[
i
].
	gÿlcWidth
 = 
w
;

623 ià(
	gavaabË
 > 0 && 
	gnumFixed
) {

625 
	gi
 = 0; i < 
	gnEffCŞs
; i++) {

626 
	gL’gth
 &
	gwidth
 = 
m_ÏyoutSŒuù
[
i
].
effWidth
;

627 ià(
	gwidth
.
isFixed
()) {

628 
	gw
 = 
¡©ic_ÿ¡
<>(
avaabË
 * stic_ÿ¡<>(
m_ÏyoutSŒuù
[
i
].
effMaxWidth
è/ 
tÙ®Fixed
);

629 
	gavaabË
 -ğ
w
;

630 
	gtÙ®Fixed
 -ğ
m_ÏyoutSŒuù
[
i
].
effMaxWidth
;

631 
	gm_ÏyoutSŒuù
[
i
].
	gÿlcWidth
 +ğ
w
;

637 ià(
	gavaabË
 > 0 && 
	gm_hasP”ûÁ
 && 
	gtÙ®P”ûÁ
 < 100 * 
	g³rûÁSÿËFaùÜ
) {

639 
	gi
 = 0; i < 
	gnEffCŞs
; i++) {

640 
	gL’gth
 &
	gwidth
 = 
m_ÏyoutSŒuù
[
i
].
effWidth
;

641 ià(
	gwidth
.
isP”ûÁ
()) {

642 
	gw
 = 
avaabË
 * 
width
.
¿wV®ue
(è/ 
tÙ®P”ûÁ
;

643 
	gavaabË
 -ğ
w
;

644 
	gtÙ®P”ûÁ
 -ğ
width
.
¿wV®ue
();

645 
	gm_ÏyoutSŒuù
[
i
].
	gÿlcWidth
 +ğ
w
;

646 ià(!
	gavaabË
 || !
	gtÙ®P”ûÁ
) ;

652 ià(
	gavaabË
 > 0 && 
	gnEffCŞs
 > 
	gnumAutoEm±yC–lsOÆy
) {

653 
	gtÙ®
 = 
nEffCŞs
 - 
numAutoEm±yC–lsOÆy
;

655 
	gi
 = 
nEffCŞs
;

656 
	gi
--) {

658 ià(
	gm_ÏyoutSŒuù
[
i
].
	geffWidth
.
isAuto
(è&& m_ÏyoutSŒuù[i].
	gem±yC–lsOÆy
)

660 
	gw
 = 
avaabË
 / 
tÙ®
;

661 
	gavaabË
 -ğ
w
;

662 
	gtÙ®
--;

663 
	gm_ÏyoutSŒuù
[
i
].
	gÿlcWidth
 +ğ
w
;

669 ià(
	gavaabË
 < 0) {

676 ià(
	gavaabË
 < 0) {

677 
	gmw
 = 0;

678 
	gi
 = 
nEffCŞs
-1; i >= 0; i--) {

679 
	gL’gth
 &
	gwidth
 = 
m_ÏyoutSŒuù
[
i
].
effWidth
;

680 ià(
	gwidth
.
isAuto
())

681 
	gmw
 +ğ
m_ÏyoutSŒuù
[
i
].
ÿlcWidth
 - m_ÏyoutSŒuù[i].
effMšWidth
;

684 
	gi
 = 
nEffCŞs
-1; i >ğ0 && 
mw
 > 0; i--) {

685 
	gL’gth
 &
	gwidth
 = 
m_ÏyoutSŒuù
[
i
].
effWidth
;

686 ià(
	gwidth
.
isAuto
()) {

687 
	gmšMaxDiff
 = 
m_ÏyoutSŒuù
[
i
].
ÿlcWidth
-m_ÏyoutSŒuù[i].
effMšWidth
;

688 
	g»duû
 = 
avaabË
 * 
mšMaxDiff
 / 
mw
;

689 
	gm_ÏyoutSŒuù
[
i
].
	gÿlcWidth
 +ğ
»duû
;

690 
	gavaabË
 -ğ
»duû
;

691 
	gmw
 -ğ
mšMaxDiff
;

692 ià(
	gavaabË
 >= 0)

698 ià(
	gavaabË
 < 0) {

699 
	gmw
 = 0;

700 
	gi
 = 
nEffCŞs
-1; i >= 0; i--) {

701 
	gL’gth
& 
	gwidth
 = 
m_ÏyoutSŒuù
[
i
].
effWidth
;

702 ià(
	gwidth
.
isR–©ive
())

703 
	gmw
 +ğ
m_ÏyoutSŒuù
[
i
].
ÿlcWidth
 - m_ÏyoutSŒuù[i].
effMšWidth
;

706 
	gi
 = 
nEffCŞs
-1; i >ğ0 && 
mw
 > 0; i--) {

707 
	gL’gth
& 
	gwidth
 = 
m_ÏyoutSŒuù
[
i
].
effWidth
;

708 ià(
	gwidth
.
isR–©ive
()) {

709 
	gmšMaxDiff
 = 
m_ÏyoutSŒuù
[
i
].
ÿlcWidth
-m_ÏyoutSŒuù[i].
effMšWidth
;

710 
	g»duû
 = 
avaabË
 * 
mšMaxDiff
 / 
mw
;

711 
	gm_ÏyoutSŒuù
[
i
].
	gÿlcWidth
 +ğ
»duû
;

712 
	gavaabË
 -ğ
»duû
;

713 
	gmw
 -ğ
mšMaxDiff
;

714 ià(
	gavaabË
 >= 0)

720 ià(
	gavaabË
 < 0) {

721 
	gmw
 = 0;

722 
	gi
 = 
nEffCŞs
-1; i >= 0; i--) {

723 
	gL’gth
& 
	gwidth
 = 
m_ÏyoutSŒuù
[
i
].
effWidth
;

724 ià(
	gwidth
.
isFixed
())

725 
	gmw
 +ğ
m_ÏyoutSŒuù
[
i
].
ÿlcWidth
 - m_ÏyoutSŒuù[i].
effMšWidth
;

728 
	gi
 = 
nEffCŞs
-1; i >ğ0 && 
mw
 > 0; i--) {

729 
	gL’gth
& 
	gwidth
 = 
m_ÏyoutSŒuù
[
i
].
effWidth
;

730 ià(
	gwidth
.
isFixed
()) {

731 
	gmšMaxDiff
 = 
m_ÏyoutSŒuù
[
i
].
ÿlcWidth
-m_ÏyoutSŒuù[i].
effMšWidth
;

732 
	g»duû
 = 
avaabË
 * 
mšMaxDiff
 / 
mw
;

733 
	gm_ÏyoutSŒuù
[
i
].
	gÿlcWidth
 +ğ
»duû
;

734 
	gavaabË
 -ğ
»duû
;

735 
	gmw
 -ğ
mšMaxDiff
;

736 ià(
	gavaabË
 >= 0)

742 ià(
	gavaabË
 < 0) {

743 
	gmw
 = 0;

744 
	gi
 = 
nEffCŞs
-1; i >= 0; i--) {

745 
	gL’gth
& 
	gwidth
 = 
m_ÏyoutSŒuù
[
i
].
effWidth
;

746 ià(
	gwidth
.
isP”ûÁ
())

747 
	gmw
 +ğ
m_ÏyoutSŒuù
[
i
].
ÿlcWidth
 - m_ÏyoutSŒuù[i].
effMšWidth
;

750 
	gi
 = 
nEffCŞs
-1; i >ğ0 && 
mw
 > 0; i--) {

751 
	gL’gth
& 
	gwidth
 = 
m_ÏyoutSŒuù
[
i
].
effWidth
;

752 ià(
	gwidth
.
isP”ûÁ
()) {

753 
	gmšMaxDiff
 = 
m_ÏyoutSŒuù
[
i
].
ÿlcWidth
-m_ÏyoutSŒuù[i].
effMšWidth
;

754 
	g»duû
 = 
avaabË
 * 
mšMaxDiff
 / 
mw
;

755 
	gm_ÏyoutSŒuù
[
i
].
	gÿlcWidth
 +ğ
»duû
;

756 
	gavaabË
 -ğ
»duû
;

757 
	gmw
 -ğ
mšMaxDiff
;

758 ià(
	gavaabË
 >= 0)

765 
	gpos
 = 0;

766 
	gi
 = 0; i < 
	gnEffCŞs
; i++) {

767 
	gm_bË
->
cŞumnPos™iÚs
()[
i
] = 
pos
;

768 
	gpos
 +ğ
m_ÏyoutSŒuù
[
i
].
ÿlcWidth
 + 
m_bË
->
hBÜd”S·cšg
();

770 
	gm_bË
->
cŞumnPos™iÚs
()[
m_bË
->cŞumnPos™iÚs().
size
(è- 1] = 
pos
;

774 
	gAutoTabËLayout
::
ÿlcP”ûÁages
() const

776 
tÙ®P”ûÁ
 = 0;

777 
	gi
 = 0; i < 
	gm_ÏyoutSŒuù
.
size
(); i++) {

778 ià(
	gm_ÏyoutSŒuù
[
i
].
	gwidth
.
isP”ûÁ
())

779 
	gtÙ®P”ûÁ
 +ğ
m_ÏyoutSŒuù
[
i
].
width
.
¿wV®ue
();

781 
	gm_tÙ®P”ûÁ
 = 
tÙ®P”ûÁ
 / 
³rûÁSÿËFaùÜ
;

782 
	gm_³rûÁagesDœty
 = 
çl£
;

785 #undeà
DEBUG_LAYOUT


	@AutoTableLayout.h

21 #iâdeà
AutoTabËLayout_h


22 
	#AutoTabËLayout_h


	)

24 
	~"L’gth.h
"

25 
	~"TabËLayout.h
"

26 
	~<wtf/VeùÜ.h
>

28 
Çme¥aû
 
	gWebCÜe
 {

30 
şass
 
	gR’d”TabË
;

31 
şass
 
	gR’d”TabËC–l
;

33 şas 
	cAutoTabËLayout
 : 
public
 
TabËLayout
 {

34 
public
:

35 
AutoTabËLayout
(
R’d”TabË
*);

36 ~
AutoTabËLayout
();

38 
vœtu®
 
ÿlcP»fWidths
(& 
mšWidth
, & 
maxWidth
);

39 
vœtu®
 
Ïyout
();

41 
	g´Ùeùed
:

42 
fuÎReÿlc
();

43 
»ÿlcCŞumn
(
effCŞ
);

45 
ÿlcP”ûÁages
() const;

46 
tÙ®P”ûÁ
() const

48 ià(
	gm_³rûÁagesDœty
)

49 
ÿlcP”ûÁages
();

50  
	gm_tÙ®P”ûÁ
;

53 
ÿlcEfãùiveWidth
();

55 
š£¹S·nC–l
(
R’d”TabËC–l
*);

57 
	sLayout
 {

58 
Layout
()

59 : 
mšWidth
(0)

60 , 
maxWidth
(0)

61 , 
effMšWidth
(0)

62 , 
effMaxWidth
(0)

63 , 
ÿlcWidth
(0)

64 , 
em±yC–lsOÆy
(
Œue
) {}

65 
L’gth
 
	gwidth
;

66 
L’gth
 
	geffWidth
;

67 
	gmšWidth
;

68 
	gmaxWidth
;

69 
	geffMšWidth
;

70 
	geffMaxWidth
;

71 
	gÿlcWidth
;

72 
boŞ
 
	gem±yC–lsOÆy
;

75 
	gVeùÜ
<
	gLayout
, 4> 
	gm_ÏyoutSŒuù
;

76 
	gVeùÜ
<
	gR’d”TabËC–l
*, 4> 
	gm_¥ªC–ls
;

77 
boŞ
 
	gm_hasP”ûÁ
 : 1;

78 
mubË
 
boŞ
 
	gm_³rûÁagesDœty
 : 1;

79 
mubË
 
boŞ
 
	gm_effWidthDœty
 : 1;

80 
mubË
 
	gm_tÙ®P”ûÁ
;

	@BidiRun.cpp

24 
	~"cÚfig.h
"

25 
	~"BidiRun.h
"

26 
	~"IÆšeBox.h
"

27 
	~"R’d”A»Ç.h
"

28 
	~<wtf/RefCouÁedL—kCouÁ”.h
>

30 
usšg
 
Çme¥aû
 
	gWTF
;

32 
Çme¥aû
 
	gWebCÜe
 {

34 #iâdeà
NDEBUG


35 
RefCouÁedL—kCouÁ”
 
bidiRunCouÁ”
("BidiRun");

37 
boŞ
 
	gšBidiRunDe¡roy
;

40 
	gBidiRun
::
de¡roy
()

42 #iâdeà
NDEBUG


43 
šBidiRunDe¡roy
 = 
Œue
;

45 
R’d”A»Ç
* 
	g»nd”A»Ç
 = 
m_objeù
->
»nd”A»Ç
();

46 
d–‘e
 
	gthis
;

47 #iâdeà
NDEBUG


48 
	gšBidiRunDe¡roy
 = 
çl£
;

52 
	g»nd”A»Ç
->
ä“
(*
»š‹½»t_ÿ¡
<
size_t
*>(
this
),his);

55 * 
	gBidiRun
::
İ”©Ü
 
Ãw
(
size_t
 
sz
, 
R’d”A»Ç
* 
»nd”A»Ç
è
throw
()

57 #iâdeà
NDEBUG


58 
	gbidiRunCouÁ”
.
šüem’t
();

60  
	g»nd”A»Ç
->
®loÿ‹
(
sz
);

63 
	gBidiRun
::
İ”©Ü
 
d–‘e
(* 
±r
, 
size_t
 
sz
)

65 #iâdeà
NDEBUG


66 
	gbidiRunCouÁ”
.
deüem’t
();

68 
ASSERT
(
šBidiRunDe¡roy
);

71 *(
	gsize_t
*)
	g±r
 = 
sz
;

	@BidiRun.h

24 #iâdeà
BidiRun_h


25 
	#BidiRun_h


	)

27 
	~<wtf/StdLibExŒas.h
>

28 
	~"BidiResŞv”.h
"

29 
	~"R’d”Text.h
"

31 
Çme¥aû
 
	gWebCÜe
 {

33 
şass
 
	gBidiCÚ‹xt
;

34 
şass
 
	gIÆšeBox
;

36 
	gBidiRun
 : 
BidiCh¬aù”Run
 {

37 
BidiRun
(
¡¬t
, 
¡İ
, 
R’d”Objeù
* 
objeù
, 
BidiCÚ‹xt
* 
cÚ‹xt
, 
WTF
::
Unicode
::
DœeùiÚ
 
dœ
)

38 : 
BidiCh¬aù”Run
(
¡¬t
, 
¡İ
, 
cÚ‹xt
, 
dœ
)

39 , 
m_objeù
(
objeù
)

40 , 
m_box
(0)

44 
de¡roy
();

47 * 
İ”©Ü
 
Ãw
(
size_t
, 
R’d”A»Ç
*è
throw
();

50 
İ”©Ü
 
d–‘e
(*, 
size_t
);

52 
BidiRun
* 
Ãxt
(è{  
	g¡©ic_ÿ¡
<
	gBidiRun
*>(
	gm_Ãxt
); }

54 
	g´iv©e
:

56 * 
İ”©Ü
 
Ãw
(
size_t
è
throw
();

58 
	gpublic
:

59 
R’d”Objeù
* 
m_objeù
;

60 
IÆšeBox
* 
	gm_box
;

	@CounterNode.cpp

22 
	~"cÚfig.h
"

23 
	~"CouÁ”Node.h
"

25 
	~"R’d”CouÁ”.h
"

26 
	~"R’d”Objeù.h
"

27 
	~<¡dio.h
>

29 
Çme¥aû
 
	gWebCÜe
 {

31 
	gCouÁ”Node
::
CouÁ”Node
(
R’d”Objeù
* 
o
, 
boŞ
 
hasRe£tTy³
, 
v®ue
)

32 : 
m_hasRe£tTy³
(
hasRe£tTy³
)

33 , 
m_v®ue
(
v®ue
)

34 , 
m_couÁInP¬’t
(0)

35 , 
m_»nd””
(
o
)

36 , 
m_·»Á
(0)

37 , 
m_´eviousSiblšg
(0)

38 , 
m_ÃxtSiblšg
(0)

39 , 
m_fœ¡Chd
(0)

40 , 
m_Ï¡Chd
(0)

44 
CouÁ”Node
* 
	gCouÁ”Node
::
ÃxtInP»Ord”Aá”Chd»n
(cÚ¡ CouÁ”Node* 
¡ayW™hš
) const

46 ià(
this
 =ğ
¡ayW™hš
)

49 cÚ¡ 
CouÁ”Node
* 
	gcu¼’t
 = 
this
;

50 
CouÁ”Node
* 
	gÃxt
;

51 !(
	gÃxt
 = 
cu¼’t
->
m_ÃxtSiblšg
)) {

52 
cu¼’t
 = cu¼’t->
m_·»Á
;

53 ià(!
	gcu¼’t
 || cu¼’ˆ=ğ
¡ayW™hš
)

56  
	gÃxt
;

59 
CouÁ”Node
* 
	gCouÁ”Node
::
ÃxtInP»Ord”
(cÚ¡ CouÁ”Node* 
¡ayW™hš
) const

61 ià(
CouÁ”Node
* 
Ãxt
 = 
m_fœ¡Chd
)

62  
Ãxt
;

64  
ÃxtInP»Ord”Aá”Chd»n
(
¡ayW™hš
);

67 
CouÁ”Node
* 
	gCouÁ”Node
::
Ï¡Desûndªt
() const

69 
CouÁ”Node
* 
Ï¡
 = 
m_Ï¡Chd
;

70 ià(!
	gÏ¡
)

73 
CouÁ”Node
* 
	gÏ¡Chd
 = 
Ï¡
->
m_Ï¡Chd
)

74 
Ï¡
 = 
Ï¡Chd
;

76  
	gÏ¡
;

79 
CouÁ”Node
* 
	gCouÁ”Node
::
´eviousInP»Ord”
() const

81 
CouÁ”Node
* 
´evious
 = 
m_´eviousSiblšg
;

82 ià(!
	g´evious
)

83  
	gm_·»Á
;

85 
CouÁ”Node
* 
	gÏ¡Chd
 = 
´evious
->
m_Ï¡Chd
)

86 
´evious
 = 
Ï¡Chd
;

88  
	g´evious
;

91 
	gCouÁ”Node
::
compu‹CouÁInP¬’t
() const

93 
šüem’t
 = 
aùsAsRe£t
(è? 0 : 
m_v®ue
;

94 ià(
	gm_´eviousSiblšg
)

95  
	gm_´eviousSiblšg
->
	gm_couÁInP¬’t
 + 
	gšüem’t
;

96 
ASSERT
(
m_·»Á
->
m_fœ¡Chd
 =ğ
this
);

97  
	gm_·»Á
->
	gm_v®ue
 + 
	gšüem’t
;

100 
	gCouÁ”Node
::
»£tR’d””
(cÚ¡ 
AtomicSŒšg
& 
id’tif›r
) const

102 ià(!
m_»nd””
 || m_»nd””->
docum’tBešgDe¡royed
())

104 ià(
R’d”ObjeùChdLi¡
* 
	gchd»n
 = 
m_»nd””
->
vœtu®Chd»n
())

105 
chd»n
->
šv®id©eCouÁ”s
(
m_»nd””
, 
id’tif›r
);

108 
	gCouÁ”Node
::
»£tR’d””s
(cÚ¡ 
AtomicSŒšg
& 
id’tif›r
) const

110 cÚ¡ 
CouÁ”Node
* 
node
 = 
this
;

112 
	gnode
->
»£tR’d””
(
id’tif›r
);

113 
	gnode
 = 
node
->
ÃxtInP»Ord”
(
this
);

114 } 
	gnode
);

117 
	gCouÁ”Node
::
»couÁ
(cÚ¡ 
AtomicSŒšg
& 
id’tif›r
)

119 
CouÁ”Node
* 
node
 = 
this
; 
	gnode
;‚odğnode->
m_ÃxtSiblšg
) {

120 
ŞdCouÁ
 = 
node
->
m_couÁInP¬’t
;

121 
	gÃwCouÁ
 = 
node
->
compu‹CouÁInP¬’t
();

122 ià(
	gŞdCouÁ
 =ğ
ÃwCouÁ
)

124 
	gnode
->
	gm_couÁInP¬’t
 = 
ÃwCouÁ
;

125 
	gnode
->
»£tR’d””s
(
id’tif›r
);

129 
	gCouÁ”Node
::
š£¹Aá”
(
CouÁ”Node
* 
ÃwChd
, CouÁ”Node* 
»fChd
, cÚ¡ 
AtomicSŒšg
& 
id’tif›r
)

131 
ASSERT
(
ÃwChd
);

132 
ASSERT
(!
ÃwChd
->
m_·»Á
);

133 
ASSERT
(!
ÃwChd
->
m_´eviousSiblšg
);

134 
ASSERT
(!
ÃwChd
->
m_ÃxtSiblšg
);

135 
ASSERT
(!
»fChd
 ||„efChd->
m_·»Á
 =ğ
this
);

137 ià(
	gÃwChd
->
	gm_hasRe£tTy³
) {

138 
	gm_Ï¡Chd
 !ğ
»fChd
)

139 
R’d”CouÁ”
::
de¡royCouÁ”Node
(
m_Ï¡Chd
->
»nd””
(), 
id’tif›r
);

142 
CouÁ”Node
* 
	gÃxt
;

144 ià(
	g»fChd
) {

145 
	gÃxt
 = 
»fChd
->
m_ÃxtSiblšg
;

146 
	g»fChd
->
	gm_ÃxtSiblšg
 = 
ÃwChd
;

148 
	gÃxt
 = 
m_fœ¡Chd
;

149 
	gm_fœ¡Chd
 = 
ÃwChd
;

152 
	gÃwChd
->
	gm_·»Á
 = 
this
;

153 
	gÃwChd
->
	gm_´eviousSiblšg
 = 
»fChd
;

155 ià(!
	gÃwChd
->
	gm_fœ¡Chd
 ||‚ewChd->
	gm_hasRe£tTy³
) {

156 
	gÃwChd
->
	gm_ÃxtSiblšg
 = 
Ãxt
;

157 ià(
	gÃxt
) {

158 
ASSERT
(
Ãxt
->
m_´eviousSiblšg
 =ğ
»fChd
);

159 
	gÃxt
->
	gm_´eviousSiblšg
 = 
ÃwChd
;

161 
ASSERT
(
m_Ï¡Chd
 =ğ
»fChd
);

162 
	gm_Ï¡Chd
 = 
ÃwChd
;

165 
	gÃwChd
->
	gm_couÁInP¬’t
 = 
ÃwChd
->
compu‹CouÁInP¬’t
();

166 
	gÃwChd
->
»£tR’d””s
(
id’tif›r
);

167 ià(
	gÃxt
)

168 
	gÃxt
->
»couÁ
(
id’tif›r
);

174 
CouÁ”Node
* 
	gÏ¡
 = 
ÃwChd
->
m_Ï¡Chd
;

175 
CouÁ”Node
* 
	gfœ¡
 = 
ÃwChd
->
m_fœ¡Chd
;

177 
	gÃwChd
->
	gm_ÃxtSiblšg
 = 
fœ¡
;

178 
	gfœ¡
->
	gm_´eviousSiblšg
 = 
ÃwChd
;

188 
	gÏ¡
->
	gm_ÃxtSiblšg
 = 
Ãxt
;

189 ià(
	gÃxt
)

190 
	gÃxt
->
	gm_´eviousSiblšg
 = 
Ï¡
;

192 
	gm_Ï¡Chd
 = 
Ï¡
;

193 
	gÃxt
 = 
fœ¡
; ;‚exˆğ
Ãxt
->
m_ÃxtSiblšg
) {

194 
Ãxt
->
m_·»Á
 = 
this
;

195 ià(
	gÏ¡
 =ğ
Ãxt
)

198 
	gÃwChd
->
	gm_fœ¡Chd
 = 0;

199 
	gÃwChd
->
	gm_Ï¡Chd
 = 0;

200 
	gÃwChd
->
	gm_couÁInP¬’t
 = 
ÃwChd
->
compu‹CouÁInP¬’t
();

201 
	gÃwChd
->
»£tR’d””
(
id’tif›r
);

202 
	gfœ¡
->
»couÁ
(
id’tif›r
);

205 
	gCouÁ”Node
::
»moveChd
(
CouÁ”Node
* 
ŞdChd
, cÚ¡ 
AtomicSŒšg
& 
id’tif›r
)

207 
ASSERT
(
ŞdChd
);

208 
ASSERT
(!
ŞdChd
->
m_fœ¡Chd
);

209 
ASSERT
(!
ŞdChd
->
m_Ï¡Chd
);

211 
CouÁ”Node
* 
	gÃxt
 = 
ŞdChd
->
m_ÃxtSiblšg
;

212 
CouÁ”Node
* 
	g´evious
 = 
ŞdChd
->
m_´eviousSiblšg
;

214 
	gŞdChd
->
	gm_ÃxtSiblšg
 = 0;

215 
	gŞdChd
->
	gm_´eviousSiblšg
 = 0;

216 
	gŞdChd
->
	gm_·»Á
 = 0;

218 ià(
	g´evious
)

219 
	g´evious
->
	gm_ÃxtSiblšg
 = 
Ãxt
;

221 
ASSERT
(
m_fœ¡Chd
 =ğ
ŞdChd
);

222 
	gm_fœ¡Chd
 = 
Ãxt
;

225 ià(
	gÃxt
)

226 
	gÃxt
->
	gm_´eviousSiblšg
 = 
´evious
;

228 
ASSERT
(
m_Ï¡Chd
 =ğ
ŞdChd
);

229 
	gm_Ï¡Chd
 = 
´evious
;

232 ià(
	gÃxt
)

233 
	gÃxt
->
»couÁ
(
id’tif›r
);

236 #iâdeà
NDEBUG


238 
showT»eAndM¬k
(cÚ¡ 
CouÁ”Node
* 
node
)

240 cÚ¡ 
CouÁ”Node
* 
	groÙ
 = 
node
;

241 
	groÙ
->
·»Á
())

242 
	groÙ
 = 
roÙ
->
·»Á
();

244 cÚ¡ 
CouÁ”Node
* 
	gcu¼’t
 = 
roÙ
; cu¼’t; cu¼’ˆğ
cu¼’t
->
ÃxtInP»Ord”
()) {

245 
fwr™e
((
cu¼’t
 =ğ
node
è? "*" : " ", 1, 1, 
¡d”r
);

246 cÚ¡ 
CouÁ”Node
* 
	g·»Á
 = 
cu¼’t
;…¬’ˆ&&…¬’ˆ!ğ
roÙ
;…¬’ˆğ
·»Á
->parent())

247 
fwr™e
(" ", 1, 2, 
¡d”r
);

248 
årštf
(
¡d”r
, "%p %s: %d %d P:%p PS:%p NS:%p R:%p\n",

249 
cu¼’t
, cu¼’t->
aùsAsRe£t
(è? "»£t____" : "šüem’t", cu¼’t->
v®ue
(),

250 
cu¼’t
->
couÁInP¬’t
(), cu¼’t->
·»Á
(), cu¼’t->
´eviousSiblšg
(),

251 
cu¼’t
->
ÃxtSiblšg
(), cu¼’t->
»nd””
());

259 #iâdeà
NDEBUG


261 
showT»e
(cÚ¡ 
WebCÜe
::
CouÁ”Node
* 
couÁ”
)

263 ià(
couÁ”
)

264 
showT»eAndM¬k
(
couÁ”
);

	@CounterNode.h

22 #iâdeà
CouÁ”Node_h


23 
	#CouÁ”Node_h


	)

25 
	~<wtf/NÚcİyabË.h
>

36 
Çme¥aû
 
	gWebCÜe
 {

38 
şass
 
	gAtomicSŒšg
;

39 
şass
 
	gR’d”Objeù
;

41 şas 
	cCouÁ”Node
 : 
public
 
NÚcİyabË
 {

42 
public
:

43 
CouÁ”Node
(
R’d”Objeù
*, 
boŞ
 
isRe£t
, 
v®ue
);

45 
boŞ
 
aùsAsRe£t
(ècÚ¡ {  
	gm_hasRe£tTy³
 || !
	gm_·»Á
; }

46 
boŞ
 
hasRe£tTy³
(ècÚ¡ {  
	gm_hasRe£tTy³
; }

47 
v®ue
(ècÚ¡ {  
	gm_v®ue
; }

48 
couÁInP¬’t
(ècÚ¡ {  
	gm_couÁInP¬’t
; }

49 
R’d”Objeù
* 
»nd””
(ècÚ¡ {  
	gm_»nd””
; }

51 
CouÁ”Node
* 
·»Á
(ècÚ¡ {  
	gm_·»Á
; }

52 
CouÁ”Node
* 
´eviousSiblšg
(ècÚ¡ {  
	gm_´eviousSiblšg
; }

53 
CouÁ”Node
* 
ÃxtSiblšg
(ècÚ¡ {  
	gm_ÃxtSiblšg
; }

54 
CouÁ”Node
* 
fœ¡Chd
(ècÚ¡ {  
	gm_fœ¡Chd
; }

55 
CouÁ”Node
* 
Ï¡Chd
(ècÚ¡ {  
	gm_Ï¡Chd
; }

56 
CouÁ”Node
* 
Ï¡Desûndªt
() const;

57 
CouÁ”Node
* 
´eviousInP»Ord”
() const;

58 
CouÁ”Node
* 
ÃxtInP»Ord”
(cÚ¡ CouÁ”Node* 
¡ayW™hš
 = 0) const;

59 
CouÁ”Node
* 
ÃxtInP»Ord”Aá”Chd»n
(cÚ¡ CouÁ”Node* 
¡ayW™hš
 = 0) const;

61 
š£¹Aá”
(
CouÁ”Node
* 
ÃwChd
, CouÁ”Node* 
befÜeChd
, cÚ¡ 
AtomicSŒšg
& 
id’tif›r
);

64 
»moveChd
(
CouÁ”Node
*, cÚ¡ 
AtomicSŒšg
& 
id’tif›r
);

66 
	g´iv©e
:

67 
compu‹CouÁInP¬’t
() const;

68 
»couÁ
(cÚ¡ 
AtomicSŒšg
& 
id’tif›r
);

72 
»£tR’d””
(cÚ¡ 
AtomicSŒšg
& 
id’tif›r
) const;

77 
»£tR’d””s
(cÚ¡ 
AtomicSŒšg
& 
id’tif›r
) const;

79 
boŞ
 
	gm_hasRe£tTy³
;

80 
	gm_v®ue
;

81 
	gm_couÁInP¬’t
;

82 
R’d”Objeù
* 
	gm_»nd””
;

84 
CouÁ”Node
* 
	gm_·»Á
;

85 
CouÁ”Node
* 
	gm_´eviousSiblšg
;

86 
CouÁ”Node
* 
	gm_ÃxtSiblšg
;

87 
CouÁ”Node
* 
	gm_fœ¡Chd
;

88 
CouÁ”Node
* 
	gm_Ï¡Chd
;

93 #iâdeà
NDEBUG


95 
showT»e
(cÚ¡ 
WebCÜe
::
CouÁ”Node
*);

	@EllipsisBox.cpp

20 
	~"cÚfig.h
"

21 
	~"EÎsisBox.h
"

23 
	~"Docum’t.h
"

24 
	~"G¿phicsCÚ‹xt.h
"

25 
	~"H™Te¡ResuÉ.h
"

26 
	~"RoÙIÆšeBox.h
"

28 
Çme¥aû
 
	gWebCÜe
 {

30 
	gEÎsisBox
::
·št
(
R’d”Objeù
::
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

32 
G¿phicsCÚ‹xt
* 
	gcÚ‹xt
 = 
·štInfo
.
cÚ‹xt
;

33 
R’d”StyË
* 
	g¡yË
 = 
m_»nd””
->
¡yË
(
m_fœ¡Lše
);

34 
CŞÜ
 
	g‹xtCŞÜ
 = 
¡yË
->
cŞÜ
();

35 ià(
	g‹xtCŞÜ
 !ğ
cÚ‹xt
->
flCŞÜ
())

36 
cÚ‹xt
->
£tFlCŞÜ
(
‹xtCŞÜ
, 
¡yË
->
cŞÜS·û
());

37 
boŞ
 
	g£tShadow
 = 
çl£
;

38 ià(
	g¡yË
->
‹xtShadow
()) {

39 
	gcÚ‹xt
->
£tShadow
(
IÁSize
(
¡yË
->
‹xtShadow
()->
x
(), styË->‹xtShadow()->
y
()),

40 
¡yË
->
‹xtShadow
()->
blur
(), styË->‹xtShadow()->
cŞÜ
(), styË->
cŞÜS·û
());

41 
	g£tShadow
 = 
Œue
;

44 ià(
£ËùiÚS‹
(è!ğ
R’d”Objeù
::
S–eùiÚNÚe
) {

45 
·štS–eùiÚ
(
cÚ‹xt
, 
tx
, 
ty
, 
¡yË
, styË->
fÚt
());

48 
CŞÜ
 
	gfÜeground
 = 
·štInfo
.
fÜûBÏckText
 ? CŞÜ::
bÏck
 : 
»nd””
()->
£ËùiÚFÜegroundCŞÜ
();

49 ià(
	gfÜeground
.
isV®id
(è&& fÜeground !ğ
‹xtCŞÜ
)

50 
cÚ‹xt
->
£tFlCŞÜ
(
fÜeground
, 
¡yË
->
cŞÜS·û
());

53 cÚ¡ 
	gSŒšg
& 
	g¡r
 = 
m_¡r
;

54 
	gcÚ‹xt
->
d¿wText
(
¡yË
->
fÚt
(), 
TextRun
(
¡r
.
ch¬aù”s
(), sŒ.
Ëngth
(), 
çl£
, 0, 0, f®£, styË->
visu®lyOrd”ed
()), 
IÁPošt
(
m_x
 + 
tx
, 
m_y
 + 
ty
 + styË->fÚt().
asûÁ
()));

57 ià(
	g‹xtCŞÜ
 !ğ
cÚ‹xt
->
flCŞÜ
())

58 
cÚ‹xt
->
£tFlCŞÜ
(
‹xtCŞÜ
, 
¡yË
->
cŞÜS·û
());

60 ià(
	g£tShadow
)

61 
	gcÚ‹xt
->
ş—rShadow
();

63 ià(
	gm_m¬kupBox
) {

65 
	gtx
 +ğ
m_x
 + 
m_width
 - 
m_m¬kupBox
->
x
();

66 
	gty
 +ğ
m_y
 + 
¡yË
->
fÚt
().
asûÁ
(è- (
m_m¬kupBox
->
y
(è+ m_m¬kupBox->
»nd””
()->¡yË(
m_fœ¡Lše
)->font().ascent());

67 
	gm_m¬kupBox
->
·št
(
·štInfo
, 
tx
, 
ty
);

71 
IÁReù
 
	gEÎsisBox
::
£ËùiÚReù
(
tx
, 
ty
)

73 
R’d”StyË
* 
	g¡yË
 = 
m_»nd””
->
¡yË
(
m_fœ¡Lše
);

74 cÚ¡ 
	gFÚt
& 
	gf
 = 
¡yË
->
fÚt
();

75  
’şosšgIÁReù
(
f
.
£ËùiÚReùFÜText
(
TextRun
(
m_¡r
.
ch¬aù”s
(), m_¡r.
Ëngth
(), 
çl£
, 0, 0, f®£, 
¡yË
->
visu®lyOrd”ed
()),

76 
IÁPošt
(
m_x
 + 
tx
, 
m_y
 + 
ty
 + 
roÙ
()->
£ËùiÚTİ
()),„oÙ()->
£ËùiÚHeight
()));

79 
	gEÎsisBox
::
·štS–eùiÚ
(
G¿phicsCÚ‹xt
* 
cÚ‹xt
, 
tx
, 
ty
, 
R’d”StyË
* 
¡yË
, cÚ¡ 
FÚt
& 
fÚt
)

81 
CŞÜ
 
	g‹xtCŞÜ
 = 
¡yË
->
cŞÜ
();

82 
CŞÜ
 
	gc
 = 
m_»nd””
->
£ËùiÚBackgroundCŞÜ
();

83 ià(!
	gc
.
isV®id
(è|| !c.
®pha
())

88 ià(
	g‹xtCŞÜ
 =ğ
c
)

89 
c
 = 
CŞÜ
(0xfà- c.
»d
(), 0xfà- c.
g»’
(), 0xfà- c.
blue
());

91 
	gcÚ‹xt
->
§ve
();

92 
	gy
 = 
roÙ
()->
£ËùiÚTİ
();

93 
	gh
 = 
roÙ
()->
£ËùiÚHeight
();

94 
	gcÚ‹xt
->
ş
(
IÁReù
(
m_x
 + 
tx
, 
y
 + 
ty
, 
m_width
, 
h
));

95 
	gcÚ‹xt
->
d¿wHighlightFÜText
(
fÚt
, 
TextRun
(
m_¡r
.
ch¬aù”s
(), m_¡r.
Ëngth
(), 
çl£
, 0, 0, f®£, 
¡yË
->
visu®lyOrd”ed
()),

96 
IÁPošt
(
m_x
 + 
tx
, 
m_y
 + 
ty
 + 
y
), 
h
, 
c
, 
¡yË
->
cŞÜS·û
());

97 
	gcÚ‹xt
->
»¡Üe
();

100 
boŞ
 
	gEÎsisBox
::
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
& 
»que¡
, 
H™Te¡ResuÉ
& 
»suÉ
, 
x
, 
y
, 
tx
, 
ty
)

102 
	gtx
 +ğ
m_x
;

103 
	gty
 +ğ
m_y
;

106 ià(
	gm_m¬kupBox
) {

107 
R’d”StyË
* 
	g¡yË
 = 
m_»nd””
->
¡yË
(
m_fœ¡Lše
);

108 
	gmtx
 = 
tx
 + 
m_width
 - 
m_m¬kupBox
->
x
();

109 
	gmty
 = 
ty
 + 
¡yË
->
fÚt
().
asûÁ
(è- (
m_m¬kupBox
->
y
(è+ m_m¬kupBox->
»nd””
()->¡yË(
m_fœ¡Lše
)->font().ascent());

110 ià(
	gm_m¬kupBox
->
nodeAtPošt
(
»que¡
, 
»suÉ
, 
x
, 
y
, 
mtx
, 
mty
)) {

111 
»nd””
()->
upd©eH™Te¡ResuÉ
(
»suÉ
, 
IÁPošt
(
x
 - 
mtx
, 
y
 - 
mty
));

112  
	gŒue
;

116 ià(
visibËToH™Te¡šg
(è&& 
IÁReù
(
tx
, 
ty
, 
m_width
, 
m_height
).
cÚšs
(
x
, 
y
)) {

117 
»nd””
()->
upd©eH™Te¡ResuÉ
(
»suÉ
, 
IÁPošt
(
x
 - 
tx
, 
y
 - 
ty
));

118  
	gŒue
;

121  
	gçl£
;

	@EllipsisBox.h

20 #iâdeà
EÎsisBox_h


21 
	#EÎsisBox_h


	)

23 
	~"IÆšeBox.h
"

25 
Çme¥aû
 
	gWebCÜe
 {

27 
şass
 
	gH™Te¡Reque¡
;

28 
şass
 
	gH™Te¡ResuÉ
;

30 şas 
	cEÎsisBox
 : 
public
 
IÆšeBox
 {

31 
public
:

32 
EÎsisBox
(
R’d”Objeù
* 
obj
, cÚ¡ 
AtomicSŒšg
& 
–lsisSŒ
, 
IÆšeFlowBox
* 
·»Á
,

33 
width
, 
height
, 
y
, 
boŞ
 
fœ¡Lše
, 
IÆšeBox
* 
m¬kupBox
)

34 : 
IÆšeBox
(
obj
, 0, 
y
, 
width
, 
fœ¡Lše
, 
Œue
, 
çl£
, f®£, 0, 0, 
·»Á
)

35 , 
m_height
(
height
)

36 , 
m_¡r
(
–lsisSŒ
)

37 , 
m_m¬kupBox
(
m¬kupBox
)

38 , 
m_£ËùiÚS‹
(
R’d”Objeù
::
S–eùiÚNÚe
)

42 
vœtu®
 
·št
(
R’d”Objeù
::
PaštInfo
&, 
tx
, 
ty
);

43 
vœtu®
 
boŞ
 
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, 
x
, 
y
, 
tx
, 
ty
);

44 
£tS–eùiÚS‹
(
R’d”Objeù
::
S–eùiÚS‹
 
s
è{ 
m_£ËùiÚS‹
 = s; }

45 
IÁReù
 
£ËùiÚReù
(
tx
, 
ty
);

47 
	g´iv©e
:

48 
vœtu®
 
height
(ècÚ¡ {  
m_height
; }

49 
vœtu®
 
	gR’d”Objeù
::
S–eùiÚS‹
 
£ËùiÚS‹
(è{  
m_£ËùiÚS‹
; }

50 
·štS–eùiÚ
(
G¿phicsCÚ‹xt
*, 
tx
, 
ty
, 
R’d”StyË
*, cÚ¡ 
FÚt
&);

52 
	gm_height
;

53 
AtomicSŒšg
 
	gm_¡r
;

54 
IÆšeBox
* 
	gm_m¬kupBox
;

55 
	gR’d”Objeù
::
S–eùiÚS‹
 
m_£ËùiÚS‹
;

	@FixedTableLayout.cpp

22 
	~"cÚfig.h
"

23 
	~"FixedTabËLayout.h
"

25 
	~"R’d”TabË.h
"

26 
	~"R’d”TabËC–l.h
"

27 
	~"R’d”TabËCŞ.h
"

28 
	~"R’d”TabËSeùiÚ.h
"

71 
usšg
 
Çme¥aû
 
	g¡d
;

73 
Çme¥aû
 
	gWebCÜe
 {

75 
	gFixedTabËLayout
::
FixedTabËLayout
(
R’d”TabË
* 
bË
)

76 : 
TabËLayout
(
bË
)

80 
FixedTabËLayout
::
ÿlcWidthA¼ay
()

82 
u£dWidth
 = 0;

85 
R’d”Objeù
* 
	gchd
 = 
m_bË
->
fœ¡Chd
();

86 
	gnEffCŞs
 = 
m_bË
->
numEffCŞs
();

87 
	gm_width
.
»size
(
nEffCŞs
);

88 
	gm_width
.
fl
(
L’gth
(
Auto
));

90 
	gcu¼’tEfãùiveCŞumn
 = 0;

91 
L’gth
 
	gg½Width
;

92 
	gchd
) {

93 ià(
	gchd
->
isTabËCŞ
()) {

94 
R’d”TabËCŞ
* 
	gcŞ
 = 
toR’d”TabËCŞ
(
chd
);

95 ià(
	gcŞ
->
fœ¡Chd
())

96 
	gg½Width
 = 
cŞ
->
¡yË
()->
width
();

98 
L’gth
 
	gw
 = 
cŞ
->
¡yË
()->
width
();

99 ià(
	gw
.
isAuto
())

100 
	gw
 = 
g½Width
;

101 
	geffWidth
 = 0;

102 ià(
	gw
.
isFixed
(è&& w.
v®ue
() > 0)

103 
	geffWidth
 = 
w
.
v®ue
();

105 
	g¥ª
 = 
cŞ
->
¥ª
();

106 
	g¥ª
) {

107 
	g¥ªInCu¼’tEfãùiveCŞumn
;

108 ià(
	gcu¼’tEfãùiveCŞumn
 >ğ
nEffCŞs
) {

109 
m_bË
->
­³ndCŞumn
(
¥ª
);

110 
	gnEffCŞs
++;

111 
	gm_width
.
­³nd
(
L’gth
());

112 
	g¥ªInCu¼’tEfãùiveCŞumn
 = 
¥ª
;

114 ià(
	g¥ª
 < 
	gm_bË
->
¥ªOfEffCŞ
(
cu¼’tEfãùiveCŞumn
)) {

115 
	gm_bË
->
¥l™CŞumn
(
cu¼’tEfãùiveCŞumn
, 
¥ª
);

116 
	gnEffCŞs
++;

117 
	gm_width
.
­³nd
(
L’gth
());

119 
	g¥ªInCu¼’tEfãùiveCŞumn
 = 
m_bË
->
¥ªOfEffCŞ
(
cu¼’tEfãùiveCŞumn
);

121 ià((
	gw
.
isFixed
(è|| w.
isP”ûÁ
()è&& w.
isPos™ive
()) {

122 
	gm_width
[
cu¼’tEfãùiveCŞumn
].
£tRawV®ue
(
w
.
ty³
(), w.
¿wV®ue
(è* 
¥ªInCu¼’tEfãùiveCŞumn
);

123 
	gu£dWidth
 +ğ
effWidth
 * 
¥ªInCu¼’tEfãùiveCŞumn
;

125 
	g¥ª
 -ğ
¥ªInCu¼’tEfãùiveCŞumn
;

126 
	gcu¼’tEfãùiveCŞumn
++;

129 
toR’d”TabËCŞ
(
chd
)->
ÿlcP»fWidths
();

133 
R’d”Objeù
* 
	gÃxt
 = 
chd
->
fœ¡Chd
();

134 ià(!
	gÃxt
)

135 
	gÃxt
 = 
chd
->
ÃxtSiblšg
();

136 ià(!
	gÃxt
 && 
	gchd
->
·»Á
()->
isTabËCŞ
()) {

137 
	gÃxt
 = 
chd
->
·»Á
()->
ÃxtSiblšg
();

138 
	gg½Width
 = 
L’gth
();

140 
	gchd
 = 
Ãxt
;

144 
R’d”TabËSeùiÚ
* 
	g£ùiÚ
 = 
m_bË
->
h—d”
();

145 ià(!
	g£ùiÚ
)

146 
	g£ùiÚ
 = 
m_bË
->
fœ¡Body
();

147 ià(!
	g£ùiÚ
)

148 
	g£ùiÚ
 = 
m_bË
->
foÙ”
();

149 ià(
	g£ùiÚ
 && !£ùiÚ->
numRows
())

150 
	g£ùiÚ
 = 
m_bË
->
£ùiÚB–ow
(
£ùiÚ
, 
Œue
);

151 ià(
	g£ùiÚ
) {

152 
	gcCŞ
 = 0;

153 
R’d”Objeù
* 
	gfœ¡Row
 = 
£ùiÚ
->
fœ¡Chd
();

154 
	gchd
 = 
fœ¡Row
->
fœ¡Chd
();

155 
	gchd
) {

156 ià(
	gchd
->
isTabËC–l
()) {

157 
R’d”TabËC–l
* 
	gûÎ
 = 
toR’d”TabËC–l
(
chd
);

158 ià(
	gûÎ
->
´efWidthsDœty
())

159 
	gûÎ
->
ÿlcP»fWidths
();

161 
L’gth
 
	gw
 = 
ûÎ
->
¡yËOrCŞWidth
();

162 
	g¥ª
 = 
ûÎ
->
cŞS·n
();

163 
	geffWidth
 = 0;

164 ià(
	gw
.
isFixed
(è&& w.
isPos™ive
())

165 
	geffWidth
 = 
w
.
v®ue
();

167 
	gu£dS·n
 = 0;

168 
	gi
 = 0;

169 
	gu£dS·n
 < 
	g¥ª
) {

170 
ASSERT
(
cCŞ
 + 
i
 < 
nEffCŞs
);

171 
	geS·n
 = 
m_bË
->
¥ªOfEffCŞ
(
cCŞ
 + 
i
);

173 ià(
	gm_width
[
cCŞ
 + 
i
].
isAuto
(è&& 
	gw
.
ty³
(è!ğ
Auto
) {

174 
m_width
[
cCŞ
 + 
i
].
£tRawV®ue
(
w
.
ty³
(), w.
¿wV®ue
(è* 
eS·n
 / 
¥ª
);

175 
	gu£dWidth
 +ğ
effWidth
 * 
eS·n
 / 
¥ª
;

177 
	gu£dS·n
 +ğ
eS·n
;

178 
	gi
++;

180 
	gcCŞ
 +ğ
i
;

182 
	gchd
 = 
chd
->
ÃxtSiblšg
();

186  
	gu£dWidth
;

192 
	#TABLE_MAX_WIDTH
 15000

	)

194 
	gFixedTabËLayout
::
ÿlcP»fWidths
(& 
mšWidth
, & 
maxWidth
)

205 
	gbs
 = 
m_bË
->
bÜd”sPaddšgAndS·cšg
();

207 
	gbËWidth
 = 
m_bË
->
¡yË
()->
width
().
isFixed
(è? m_bË->¡yË()->width().
v®ue
(è- 
bs
 : 0;

208 
	gmw
 = 
ÿlcWidthA¼ay
(
bËWidth
è+ 
bs
;

210 
	gmšWidth
 = 
max
(
mw
, 
bËWidth
);

211 
	gmaxWidth
 = 
mšWidth
;

227 ià(
	gm_bË
->
¡yË
()->
htmlHacks
(è&& m_bË->¡yË()->
width
().
isP”ûÁ
()

228 && 
	gmaxWidth
 < 
	gTABLE_MAX_WIDTH
)

229 
	gmaxWidth
 = 
TABLE_MAX_WIDTH
;

232 
	gFixedTabËLayout
::
Ïyout
()

234 
bËWidth
 = 
m_bË
->
width
(è- m_bË->
bÜd”sPaddšgAndS·cšg
();

235 
	gnEffCŞs
 = 
m_bË
->
numEffCŞs
();

236 
	gVeùÜ
<> 
ÿlcWidth
(
nEffCŞs
, 0);

238 
	gnumAuto
 = 0;

239 
	gautoS·n
 = 0;

240 
	gtÙ®FixedWidth
 = 0;

241 
	gtÙ®P”ûÁWidth
 = 0;

242 
	gtÙ®RawP”ûÁ
 = 0;

248 
	gi
 = 0; i < 
	gnEffCŞs
; i++) {

249 ià(
	gm_width
[
i
].
isFixed
()) {

250 
	gÿlcWidth
[
i
] = 
m_width
[i].
v®ue
();

251 
	gtÙ®FixedWidth
 +ğ
ÿlcWidth
[
i
];

252 } ià(
	gm_width
[
i
].
isP”ûÁ
()) {

253 
	gÿlcWidth
[
i
] = 
m_width
[i].
ÿlcV®ue
(
bËWidth
);

254 
	gtÙ®P”ûÁWidth
 +ğ
ÿlcWidth
[
i
];

255 
	gtÙ®RawP”ûÁ
 +ğ
m_width
[
i
].
¿wV®ue
();

256 } ià(
	gm_width
[
i
].
isAuto
()) {

257 
	gnumAuto
++;

258 
	gautoS·n
 +ğ
m_bË
->
¥ªOfEffCŞ
(
i
);

262 
	gh¥acšg
 = 
m_bË
->
hBÜd”S·cšg
();

263 
	gtÙ®Width
 = 
tÙ®FixedWidth
 + 
tÙ®P”ûÁWidth
;

264 ià(!
	gnumAuto
 || 
	gtÙ®Width
 > 
	gbËWidth
) {

267 ià(
	gtÙ®Width
 !ğ
bËWidth
) {

269 ià(
tÙ®FixedWidth
 && 
tÙ®Width
 < 
bËWidth
) {

270 
tÙ®FixedWidth
 = 0;

271 
	gi
 = 0; i < 
	gnEffCŞs
; i++) {

272 ià(
	gm_width
[
i
].
isFixed
()) {

273 
	gÿlcWidth
[
i
] = 
ÿlcWidth
[i] * 
bËWidth
 / 
tÙ®Width
;

274 
	gtÙ®FixedWidth
 +ğ
ÿlcWidth
[
i
];

278 ià(
	gtÙ®RawP”ûÁ
) {

279 
	gtÙ®P”ûÁWidth
 = 0;

280 
	gi
 = 0; i < 
	gnEffCŞs
; i++) {

281 ià(
	gm_width
[
i
].
isP”ûÁ
()) {

282 
	gÿlcWidth
[
i
] = 
m_width
[i].
¿wV®ue
(è* (
bËWidth
 - 
tÙ®FixedWidth
è/ 
tÙ®RawP”ûÁ
;

283 
	gtÙ®P”ûÁWidth
 +ğ
ÿlcWidth
[
i
];

287 
	gtÙ®Width
 = 
tÙ®FixedWidth
 + 
tÙ®P”ûÁWidth
;

291 
	g»maššgWidth
 = 
bËWidth
 - 
tÙ®FixedWidth
 - 
tÙ®P”ûÁWidth
 - 
h¥acšg
 * (
autoS·n
 - 
numAuto
);

292 
	gÏ¡Auto
 = 0;

293 
	gi
 = 0; i < 
	gnEffCŞs
; i++) {

294 ià(
	gm_width
[
i
].
isAuto
()) {

295 
	g¥ª
 = 
m_bË
->
¥ªOfEffCŞ
(
i
);

296 
	gw
 = 
»maššgWidth
 * 
¥ª
 / 
autoS·n
;

297 
	gÿlcWidth
[
i
] = 
w
 + 
h¥acšg
 * (
¥ª
 - 1);

298 
	g»maššgWidth
 -ğ
w
;

299 ià(!
	g»maššgWidth
)

301 
	gÏ¡Auto
 = 
i
;

302 
	gnumAuto
--;

303 
	gautoS·n
 -ğ
¥ª
;

307 ià(
	g»maššgWidth
)

308 
	gÿlcWidth
[
Ï¡Auto
] +ğ
»maššgWidth
;

309 
	gtÙ®Width
 = 
bËWidth
;

312 ià(
	gtÙ®Width
 < 
	gbËWidth
) {

314 
	g»maššgWidth
 = 
bËWidth
 - 
tÙ®Width
;

315 
	gtÙ®
 = 
nEffCŞs
;

316 
	gtÙ®
) {

317 
	gw
 = 
»maššgWidth
 / 
tÙ®
;

318 
	g»maššgWidth
 -ğ
w
;

319 
	gÿlcWidth
[--
tÙ®
] +ğ
w
;

321 ià(
	gnEffCŞs
 > 0)

322 
	gÿlcWidth
[
nEffCŞs
 - 1] +ğ
»maššgWidth
;

325 
	gpos
 = 0;

326 
	gi
 = 0; i < 
	gnEffCŞs
; i++) {

327 
	gm_bË
->
cŞumnPos™iÚs
()[
i
] = 
pos
;

328 
	gpos
 +ğ
ÿlcWidth
[
i
] + 
h¥acšg
;

330 
	gcŞPos™iÚsSize
 = 
m_bË
->
cŞumnPos™iÚs
().
size
();

331 ià(
	gcŞPos™iÚsSize
 > 0)

332 
	gm_bË
->
cŞumnPos™iÚs
()[
cŞPos™iÚsSize
 - 1] = 
pos
;

	@FixedTableLayout.h

21 #iâdeà
FixedTabËLayout_h


22 
	#FixedTabËLayout_h


	)

24 
	~"L’gth.h
"

25 
	~"TabËLayout.h
"

26 
	~<wtf/VeùÜ.h
>

28 
Çme¥aû
 
	gWebCÜe
 {

30 
şass
 
	gR’d”TabË
;

32 şas 
	cFixedTabËLayout
 : 
public
 
TabËLayout
 {

33 
public
:

34 
FixedTabËLayout
(
R’d”TabË
*);

36 
vœtu®
 
ÿlcP»fWidths
(& 
mšWidth
, & 
maxWidth
);

37 
vœtu®
 
Ïyout
();

39 
	g´Ùeùed
:

40 
ÿlcWidthA¼ay
(
bËWidth
);

42 
	gVeùÜ
<
	gL’gth
> 
	gm_width
;

	@GapRects.h

23 #iâdeà
G­Reùs_h


24 
	#G­Reùs_h


	)

26 
	~"IÁReù.h
"

28 
Çme¥aû
 
	gWebCÜe
 {

30 
	sG­Reùs
 {

31 cÚ¡ 
	gIÁReù
& 
Ëá
(ècÚ¡ {  
	gm_Ëá
; }

32 cÚ¡ 
	gIÁReù
& 
ûÁ”
(ècÚ¡ {  
	gm_ûÁ”
; }

33 cÚ¡ 
	gIÁReù
& 
right
(ècÚ¡ {  
	gm_right
; }

35 
un™eLeá
(cÚ¡ 
IÁReù
& 
r
è{ 
	gm_Ëá
.
un™e
(r); }

36 
un™eC’‹r
(cÚ¡ 
IÁReù
& 
r
è{ 
	gm_ûÁ”
.
un™e
(r); }

37 
un™eRight
(cÚ¡ 
IÁReù
& 
r
è{ 
	gm_right
.
un™e
(r); }

38 
un™e
(cÚ¡ 
G­Reùs
& 
o
è{ 
un™eLeá
(o.
Ëá
()); 
un™eC’‹r
(o.
ûÁ”
()); 
un™eRight
(o.
right
()); }

40 
İ”©Ü
 
IÁReù
() const

42 
IÁReù
 
	g»suÉ
 = 
m_Ëá
;

43 
	g»suÉ
.
un™e
(
m_ûÁ”
);

44 
	g»suÉ
.
un™e
(
m_right
);

45  
	g»suÉ
;

48 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
G­Reùs
& 
Ùh”
)

50  
m_Ëá
 =ğ
Ùh”
.
Ëá
(è&& 
m_ûÁ”
 =ğÙh”.
ûÁ”
(è&& 
m_right
 =ğÙh”.
right
();

52 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
G­Reùs
& 
Ùh”
è{  !(*
this
 == other); }

54 
	g´iv©e
:

55 
IÁReù
 
m_Ëá
;

56 
IÁReù
 
	gm_ûÁ”
;

57 
IÁReù
 
	gm_right
;

	@HitTestRequest.h

22 #iâdeà
H™Te¡Reque¡_h


23 
	#H™Te¡Reque¡_h


	)

25 
Çme¥aû
 
	gWebCÜe
 {

27 şas 
	cH™Te¡Reque¡
 {

28 
	gpublic
:

29 
	eReque¡Ty³
 {

30 
R—dOÆy
 = 0x1,

31 
	gAùive
 = 0x2,

32 
	gMou£Move
 = 0x4,

33 
	gMou£Up
 = 0x8,

34 
	gIgnÜeClpšg
 = 0x10

37 
H™Te¡Reque¡
(
»que¡Ty³
)

38 : 
m_»que¡Ty³
(
»que¡Ty³
)

42 
boŞ
 
»adOÆy
(ècÚ¡ {  
m_»que¡Ty³
 & 
R—dOÆy
; }

43 
boŞ
 
aùive
(ècÚ¡ {  
	gm_»que¡Ty³
 & 
	gAùive
; }

44 
boŞ
 
mou£Move
(ècÚ¡ {  
	gm_»que¡Ty³
 & 
	gMou£Move
; }

45 
boŞ
 
mou£Up
(ècÚ¡ {  
	gm_»que¡Ty³
 & 
	gMou£Up
; }

46 
boŞ
 
ignÜeClpšg
(ècÚ¡ {  
	gm_»que¡Ty³
 & 
	gIgnÜeClpšg
; }

48 
	g´iv©e
:

49 
m_»que¡Ty³
;

	@HitTestResult.cpp

21 
	~"cÚfig.h
"

22 
	~"H™Te¡ResuÉ.h
"

24 
	~"F¿me.h
"

25 
	~"F¿meT»e.h
"

26 
	~"HTMLAnchÜEËm’t.h
"

27 
	~"HTMLImageEËm’t.h
"

28 
	~"HTMLIÅutEËm’t.h
"

29 
	~"HTMLMedŸEËm’t.h
"

30 
	~"HTMLNames.h
"

31 
	~"R’d”Image.h
"

32 
	~"SüŞlb¬.h
"

33 
	~"S–eùiÚCÚŒŞËr.h
"

35 #ià
ENABLE
(
SVG
)

36 
	~"SVGNames.h
"

37 
	~"XLškNames.h
"

40 #ià
ENABLE
(
WML
)

41 
	~"WMLImageEËm’t.h
"

42 
	~"WMLNames.h
"

45 
Çme¥aû
 
	gWebCÜe
 {

47 
usšg
 
Çme¥aû
 
	gHTMLNames
;

49 
	gH™Te¡ResuÉ
::
H™Te¡ResuÉ
(cÚ¡ 
IÁPošt
& 
pošt
)

50 : 
m_pošt
(
pošt
)

51 , 
m_isOv”Widg‘
(
çl£
)

55 
	gH™Te¡ResuÉ
::
H™Te¡ResuÉ
(cÚ¡ H™Te¡ResuÉ& 
Ùh”
)

56 : 
m_šÃrNode
(
Ùh”
.
šÃrNode
())

57 , 
m_šÃrNÚSh¬edNode
(
Ùh”
.
šÃrNÚSh¬edNode
())

58 , 
m_pošt
(
Ùh”
.
pošt
())

59 , 
m_loÿlPošt
(
Ùh”
.
loÿlPošt
())

60 , 
m_šÃrURLEËm’t
(
Ùh”
.
URLEËm’t
())

61 , 
m_süŞlb¬
(
Ùh”
.
süŞlb¬
())

62 , 
m_isOv”Widg‘
(
Ùh”
.
isOv”Widg‘
())

66 
	gH™Te¡ResuÉ
::~
H™Te¡ResuÉ
()

70 
H™Te¡ResuÉ
& H™Te¡ResuÉ::
İ”©Ü
=(cÚ¡ H™Te¡ResuÉ& 
Ùh”
)

72 
m_šÃrNode
 = 
Ùh”
.
šÃrNode
();

73 
	gm_šÃrNÚSh¬edNode
 = 
Ùh”
.
šÃrNÚSh¬edNode
();

74 
	gm_pošt
 = 
Ùh”
.
pošt
();

75 
	gm_loÿlPošt
 = 
Ùh”
.
loÿlPošt
();

76 
	gm_šÃrURLEËm’t
 = 
Ùh”
.
URLEËm’t
();

77 
	gm_süŞlb¬
 = 
Ùh”
.
süŞlb¬
();

78 
	gm_isOv”Widg‘
 = 
Ùh”
.
isOv”Widg‘
();

79  *
	gthis
;

82 
	gH™Te¡ResuÉ
::
£tToNÚShadowAnû¡Ü
()

84 
Node
* 
node
 = 
šÃrNode
();

85 ià(
	gnode
)

86 
	gnode
 = 
node
->
shadowAnû¡ÜNode
();

87 
£tIÂ”Node
(
node
);

88 
	gnode
 = 
šÃrNÚSh¬edNode
();

89 ià(
	gnode
)

90 
	gnode
 = 
node
->
shadowAnû¡ÜNode
();

91 
£tIÂ”NÚSh¬edNode
(
node
);

94 
	gH™Te¡ResuÉ
::
£tIÂ”Node
(
Node
* 
n
)

96 
m_šÃrNode
 = 
n
;

99 
	gH™Te¡ResuÉ
::
£tIÂ”NÚSh¬edNode
(
Node
* 
n
)

101 
m_šÃrNÚSh¬edNode
 = 
n
;

104 
	gH™Te¡ResuÉ
::
£tURLEËm’t
(
EËm’t
* 
n
)

106 
m_šÃrURLEËm’t
 = 
n
;

109 
	gH™Te¡ResuÉ
::
£tSüŞlb¬
(
SüŞlb¬
* 
s
)

111 
m_süŞlb¬
 = 
s
;

114 
F¿me
* 
	gH™Te¡ResuÉ
::
rg‘F¿me
() const

116 ià(!
m_šÃrURLEËm’t
)

119 
F¿me
* 
	gäame
 = 
m_šÃrURLEËm’t
->
docum’t
()->
äame
();

120 ià(!
	gäame
)

123  
	gäame
->
Œ“
()->
fšd
(
m_šÃrURLEËm’t
->
rg‘
());

126 
boŞ
 
	gH™Te¡ResuÉ
::
isS–eùed
() const

128 ià(!
m_šÃrNÚSh¬edNode
)

129  
çl£
;

131 
F¿me
* 
	gäame
 = 
m_šÃrNÚSh¬edNode
->
docum’t
()->
äame
();

132 ià(!
	gäame
)

133  
	gçl£
;

135  
	gäame
->
£ËùiÚ
()->
cÚšs
(
m_pošt
);

138 
SŒšg
 
	gH™Te¡ResuÉ
::
¥–lšgToŞT
(
TextDœeùiÚ
& 
dœ
) const

140 
dœ
 = 
LTR
;

143 ià(!
	gm_šÃrNÚSh¬edNode
)

144  
SŒšg
();

146 
Docum’tM¬k”
* 
	gm¬k”
 = 
m_šÃrNÚSh¬edNode
->
docum’t
()->
m¬k”CÚššgPošt
(
m_pošt
, Docum’tM¬k”::
G¿mm¬
);

147 ià(!
	gm¬k”
)

148  
SŒšg
();

150 ià(
R’d”Objeù
* 
	g»nd””
 = 
m_šÃrNÚSh¬edNode
->
»nd””
())

151 
dœ
 = 
»nd””
->
¡yË
()->
dœeùiÚ
();

152  
	gm¬k”
->
	gdesütiÚ
;

155 
SŒšg
 
	gH™Te¡ResuÉ
::
»¶aûdSŒšg
() const

159 ià(!
m_šÃrNÚSh¬edNode
)

160  
SŒšg
();

162 
Docum’tM¬k”
* 
	gm¬k”
 = 
m_šÃrNÚSh¬edNode
->
docum’t
()->
m¬k”CÚššgPošt
(
m_pošt
, Docum’tM¬k”::
R•Ïûm’t
);

163 ià(!
	gm¬k”
)

164  
SŒšg
();

166  
	gm¬k”
->
	gdesütiÚ
;

169 
SŒšg
 
	gH™Te¡ResuÉ
::
t™Ë
(
TextDœeùiÚ
& 
dœ
) const

171 
dœ
 = 
LTR
;

174 
Node
* 
	gt™ËNode
 = 
m_šÃrNode
.
g‘
();™ËNode;™ËNodğ
t™ËNode
->
·»ÁNode
()) {

175 ià(
t™ËNode
->
isEËm’tNode
()) {

176 
SŒšg
 
t™Ë
 = 
¡©ic_ÿ¡
<
EËm’t
*>(
t™ËNode
)->title();

177 ià(!
	gt™Ë
.
isEm±y
()) {

178 ià(
R’d”Objeù
* 
	g»nd””
 = 
t™ËNode
->
»nd””
())

179 
dœ
 = 
»nd””
->
¡yË
()->
dœeùiÚ
();

180  
	gt™Ë
;

184  
SŒšg
();

187 
SŒšg
 
di¥ÏySŒšg
(cÚ¡ SŒšg& 
¡ršg
, cÚ¡ 
Node
* 
node
)

189 ià(!
	gnode
)

190  
	g¡ršg
;

191  
	gnode
->
docum’t
()->
di¥ÏySŒšgModif›dByEncodšg
(
¡ršg
);

194 
SŒšg
 
	gH™Te¡ResuÉ
::
®tDi¥ÏySŒšg
() const

196 ià(!
m_šÃrNÚSh¬edNode
)

197  
SŒšg
();

199 ià(
	gm_šÃrNÚSh¬edNode
->
hasTagName
(
imgTag
)) {

200 
HTMLImageEËm’t
* 
	gimage
 = 
¡©ic_ÿ¡
<HTMLImageEËm’t*>(
m_šÃrNÚSh¬edNode
.
g‘
());

201  
di¥ÏySŒšg
(
image
->
g‘A‰ribu‹
(
®tA‰r
), 
m_šÃrNÚSh¬edNode
.
g‘
());

204 ià(
	gm_šÃrNÚSh¬edNode
->
hasTagName
(
šputTag
)) {

205 
HTMLIÅutEËm’t
* 
	gšput
 = 
¡©ic_ÿ¡
<HTMLIÅutEËm’t*>(
m_šÃrNÚSh¬edNode
.
g‘
());

206  
di¥ÏySŒšg
(
šput
->
®t
(), 
m_šÃrNÚSh¬edNode
.
g‘
());

209 #ià
ENABLE
(
WML
)

210 ià(
	gm_šÃrNÚSh¬edNode
->
hasTagName
(
WMLNames
::
imgTag
)) {

211 
WMLImageEËm’t
* 
image
 = 
¡©ic_ÿ¡
<WMLImageEËm’t*>(
m_šÃrNÚSh¬edNode
.
g‘
());

212  
di¥ÏySŒšg
(
image
->
®tText
(), 
m_šÃrNÚSh¬edNode
.
g‘
());

216  
SŒšg
();

219 
Image
* 
	gH™Te¡ResuÉ
::
image
() const

221 ià(!
m_šÃrNÚSh¬edNode
)

224 
R’d”Objeù
* 
	g»nd””
 = 
m_šÃrNÚSh¬edNode
->
»nd””
();

225 ià(
	g»nd””
 &&„’d””->
isImage
()) {

226 
R’d”Image
* 
	gimage
 = 
¡©ic_ÿ¡
<
WebCÜe
::R’d”Image*>(
»nd””
);

227 ià(
	gimage
->
ÿchedImage
(è&& !image->ÿchedImage()->
”rÜOccu¼ed
())

228  
	gimage
->
ÿchedImage
()->
image
();

234 
IÁReù
 
	gH™Te¡ResuÉ
::
imageReù
() const

236 ià(!
image
())

237  
IÁReù
();

238  
	gm_šÃrNÚSh¬edNode
->
»nd”Box
()->
absŞu‹CÚ‹ÁQuad
().
’şosšgBoundšgBox
();

241 
KURL
 
	gH™Te¡ResuÉ
::
absŞu‹ImageURL
() const

243 ià(!(
m_šÃrNÚSh¬edNode
 && m_šÃrNÚSh¬edNode->
docum’t
()))

244  
KURL
();

246 ià(!(
	gm_šÃrNÚSh¬edNode
->
»nd””
(è&& m_šÃrNÚSh¬edNode->»nd””()->
isImage
()))

247  
KURL
();

249 
AtomicSŒšg
 
	gu¾SŒšg
;

250 ià(
	gm_šÃrNÚSh¬edNode
->
hasTagName
(
embedTag
)

251 || 
	gm_šÃrNÚSh¬edNode
->
hasTagName
(
imgTag
)

252 || 
	gm_šÃrNÚSh¬edNode
->
hasTagName
(
šputTag
)

253 || 
	gm_šÃrNÚSh¬edNode
->
hasTagName
(
objeùTag
)

254 #ià
ENABLE
(
SVG
)

255 || 
	gm_šÃrNÚSh¬edNode
->
hasTagName
(
SVGNames
::
imageTag
)

257 #ià
ENABLE
(
WML
)

258 || 
m_šÃrNÚSh¬edNode
->
hasTagName
(
WMLNames
::
imgTag
)

261 
EËm’t
* 
–em’t
 = 
¡©ic_ÿ¡
<EËm’t*>(
m_šÃrNÚSh¬edNode
.
g‘
());

262 
	gu¾SŒšg
 = 
–em’t
->
g‘A‰ribu‹
ÓËm’t->
imageSourûA‰ribu‹Name
());

264  
KURL
();

266  
	gm_šÃrNÚSh¬edNode
->
docum’t
()->
com¶‘eURL
(
d•»ÿ‹dP¬£URL
(
u¾SŒšg
));

269 
KURL
 
	gH™Te¡ResuÉ
::
absŞu‹MedŸURL
() const

271 #ià
ENABLE
(
VIDEO
)

272 ià(!(
m_šÃrNÚSh¬edNode
 && m_šÃrNÚSh¬edNode->
docum’t
()))

273  
KURL
();

275 ià(!(
	gm_šÃrNÚSh¬edNode
->
»nd””
(è&& m_šÃrNÚSh¬edNode->»nd””()->
isMedŸ
()))

276  
KURL
();

278 
AtomicSŒšg
 
	gu¾SŒšg
;

279 ià(
	gm_šÃrNÚSh¬edNode
->
hasTagName
(
HTMLNames
::
videoTag
è|| 
m_šÃrNÚSh¬edNode
->hasTagName(HTMLNames::
audioTag
)) {

280 
HTMLMedŸEËm’t
* 
medŸEËm’t
 = 
¡©ic_ÿ¡
<HTMLMedŸEËm’t*>(
m_šÃrNÚSh¬edNode
.
g‘
());

281 
	gu¾SŒšg
 = 
medŸEËm’t
->
cu¼’tSrc
();

283  
KURL
();

285  
	gm_šÃrNÚSh¬edNode
->
docum’t
()->
com¶‘eURL
(
d•»ÿ‹dP¬£URL
(
u¾SŒšg
));

287  
KURL
();

291 
KURL
 
	gH™Te¡ResuÉ
::
absŞu‹LškURL
() const

293 ià(!(
m_šÃrURLEËm’t
 && m_šÃrURLEËm’t->
docum’t
()))

294  
KURL
();

296 
AtomicSŒšg
 
	gu¾SŒšg
;

297 ià(
	gm_šÃrURLEËm’t
->
hasTagName
(
aTag
è|| m_šÃrURLEËm’t->hasTagName(
¬—Tag
è|| m_šÃrURLEËm’t->hasTagName(
lškTag
))

298 
	gu¾SŒšg
 = 
m_šÃrURLEËm’t
->
g‘A‰ribu‹
(
h»fA‰r
);

299 #ià
ENABLE
(
SVG
)

300 ià(
	gm_šÃrURLEËm’t
->
hasTagName
(
SVGNames
::
aTag
))

301 
u¾SŒšg
 = 
m_šÃrURLEËm’t
->
g‘A‰ribu‹
(
XLškNames
::
h»fA‰r
);

303 #ià
ENABLE
(
WML
)

304 ià(
	gm_šÃrURLEËm’t
->
hasTagName
(
WMLNames
::
aTag
))

305 
u¾SŒšg
 = 
m_šÃrURLEËm’t
->
g‘A‰ribu‹
(
h»fA‰r
);

308  
KURL
();

310  
	gm_šÃrURLEËm’t
->
docum’t
()->
com¶‘eURL
(
d•»ÿ‹dP¬£URL
(
u¾SŒšg
));

313 
boŞ
 
	gH™Te¡ResuÉ
::
isLiveLšk
() const

315 ià(!(
m_šÃrURLEËm’t
 && m_šÃrURLEËm’t->
docum’t
()))

316  
çl£
;

318 ià(
	gm_šÃrURLEËm’t
->
hasTagName
(
aTag
))

319  
	g¡©ic_ÿ¡
<
	gHTMLAnchÜEËm’t
*>(
	gm_šÃrURLEËm’t
.
g‘
())->
isLiveLšk
();

320 #ià
ENABLE
(
SVG
)

321 ià(
	gm_šÃrURLEËm’t
->
hasTagName
(
SVGNames
::
aTag
))

322  
m_šÃrURLEËm’t
->
isLšk
();

324 #ià
ENABLE
(
WML
)

325 ià(
	gm_šÃrURLEËm’t
->
hasTagName
(
WMLNames
::
aTag
))

326  
m_šÃrURLEËm’t
->
isLšk
();

329  
	gçl£
;

332 
SŒšg
 
	gH™Te¡ResuÉ
::
t™ËDi¥ÏySŒšg
() const

334 ià(!
m_šÃrURLEËm’t
)

335  
SŒšg
();

337  
di¥ÏySŒšg
(
m_šÃrURLEËm’t
->
t™Ë
(), m_šÃrURLEËm’t.
g‘
());

340 
SŒšg
 
	gH™Te¡ResuÉ
::
‹xtCÚ‹Á
() const

342 ià(!
m_šÃrURLEËm’t
)

343  
SŒšg
();

344  
	gm_šÃrURLEËm’t
->
‹xtCÚ‹Á
();

351 
boŞ
 
	gH™Te¡ResuÉ
::
isCÚ‹ÁEd™abË
() const

353 ià(!
m_šÃrNÚSh¬edNode
)

354  
çl£
;

356 ià(
	gm_šÃrNÚSh¬edNode
->
hasTagName
(
‹x»aTag
è|| m_šÃrNÚSh¬edNode->hasTagName(
isšdexTag
))

357  
	gŒue
;

359 ià(
	gm_šÃrNÚSh¬edNode
->
hasTagName
(
šputTag
))

360  
	g¡©ic_ÿ¡
<
	gHTMLIÅutEËm’t
*>(
	gm_šÃrNÚSh¬edNode
.
g‘
())->
isTextF›ld
();

362  
	gm_šÃrNÚSh¬edNode
->
isCÚ‹ÁEd™abË
();

	@HitTestResult.h

20 #iâdeà
H™Te¡ResuÉ_h


21 
	#H™Te¡ResuÉ_h


	)

23 
	~"IÁPošt.h
"

24 
	~"TextDœeùiÚ.h
"

25 
	~<wtf/RefPŒ.h
>

27 
Çme¥aû
 
	gWebCÜe
 {

29 
şass
 
	gEËm’t
;

30 
şass
 
	gF¿me
;

31 
şass
 
	gImage
;

32 
şass
 
	gIÁReù
;

33 
şass
 
	gKURL
;

34 
şass
 
	gNode
;

35 
şass
 
	gSüŞlb¬
;

36 
şass
 
	gSŒšg
;

38 şas 
	cH™Te¡ResuÉ
 {

39 
	gpublic
:

40 
H™Te¡ResuÉ
(cÚ¡ 
IÁPošt
&);

41 
H™Te¡ResuÉ
(const HitTestResult&);

42 ~
H™Te¡ResuÉ
();

43 
	gH™Te¡ResuÉ
& 
	gİ”©Ü
=(cÚ¡ 
H™Te¡ResuÉ
&);

45 
Node
* 
šÃrNode
(ècÚ¡ {  
	gm_šÃrNode
.
g‘
(); }

46 
Node
* 
šÃrNÚSh¬edNode
(ècÚ¡ {  
	gm_šÃrNÚSh¬edNode
.
g‘
(); }

47 
IÁPošt
 
pošt
(ècÚ¡ {  
	gm_pošt
; }

48 
IÁPošt
 
loÿlPošt
(ècÚ¡ {  
	gm_loÿlPošt
; }

49 
EËm’t
* 
URLEËm’t
(ècÚ¡ {  
	gm_šÃrURLEËm’t
.
g‘
(); }

50 
SüŞlb¬
* 
süŞlb¬
(ècÚ¡ {  
	gm_süŞlb¬
.
g‘
(); }

51 
boŞ
 
isOv”Widg‘
(ècÚ¡ {  
	gm_isOv”Widg‘
; }

53 
£tToNÚShadowAnû¡Ü
();

55 
£tIÂ”Node
(
Node
*);

56 
£tIÂ”NÚSh¬edNode
(
Node
*);

57 
£tPošt
(cÚ¡ 
IÁPošt
& 
p
è{ 
	gm_pošt
 =…; }

58 
£tLoÿlPošt
(cÚ¡ 
IÁPošt
& 
p
è{ 
	gm_loÿlPošt
 =…; }

59 
£tURLEËm’t
(
EËm’t
*);

60 
£tSüŞlb¬
(
SüŞlb¬
*);

61 
£tIsOv”Widg‘
(
boŞ
 
b
è{ 
	gm_isOv”Widg‘
 = b; }

63 
F¿me
* 
rg‘F¿me
() const;

64 
boŞ
 
isS–eùed
() const;

65 
SŒšg
 
¥–lšgToŞT
(
TextDœeùiÚ
&) const;

66 
SŒšg
 
»¶aûdSŒšg
() const;

67 
SŒšg
 
t™Ë
(
TextDœeùiÚ
&) const;

68 
SŒšg
 
®tDi¥ÏySŒšg
() const;

69 
SŒšg
 
t™ËDi¥ÏySŒšg
() const;

70 
Image
* 
image
() const;

71 
IÁReù
 
imageReù
() const;

72 
KURL
 
absŞu‹ImageURL
() const;

73 
KURL
 
absŞu‹MedŸURL
() const;

74 
KURL
 
absŞu‹LškURL
() const;

75 
SŒšg
 
‹xtCÚ‹Á
() const;

76 
boŞ
 
isLiveLšk
() const;

77 
boŞ
 
isCÚ‹ÁEd™abË
() const;

79 
	g´iv©e
:

80 
RefPŒ
<
Node
> 
m_šÃrNode
;

81 
	gRefPŒ
<
	gNode
> 
	gm_šÃrNÚSh¬edNode
;

82 
IÁPošt
 
	gm_pošt
;

83 
IÁPošt
 
	gm_loÿlPošt
;

85 
	gRefPŒ
<
	gEËm’t
> 
	gm_šÃrURLEËm’t
;

86 
	gRefPŒ
<
	gSüŞlb¬
> 
	gm_süŞlb¬
;

87 
boŞ
 
	gm_isOv”Widg‘
;

90 
SŒšg
 
di¥ÏySŒšg
(cÚ¡ SŒšg&, cÚ¡ 
Node
*);

	@InlineBox.cpp

20 
	~"cÚfig.h
"

21 
	~"IÆšeBox.h
"

23 
	~"H™Te¡ResuÉ.h
"

24 
	~"IÆšeFlowBox.h
"

25 
	~"R’d”A»Ç.h
"

26 
	~"R’d”Box.h
"

27 
	~"RoÙIÆšeBox.h
"

29 
usšg
 
Çme¥aû
 
	g¡d
;

31 
Çme¥aû
 
	gWebCÜe
 {

33 #iâdeà
NDEBUG


34 
boŞ
 
	gšIÆšeBoxD‘ach
;

37 #iâdeà
NDEBUG


39 
	gIÆšeBox
::~
IÆšeBox
()

41 ià(!
m_hasBadP¬’t
 && 
m_·»Á
)

42 
m_·»Á
->
£tHasBadChdLi¡
();

47 
	gIÆšeBox
::
»move
()

49 ià(
·»Á
())

50 
·»Á
()->
»moveChd
(
this
);

53 
	gIÆšeBox
::
de¡roy
(
R’d”A»Ç
* 
»nd”A»Ç
)

55 #iâdeà
NDEBUG


56 
šIÆšeBoxD‘ach
 = 
Œue
;

58 
d–‘e
 
	gthis
;

59 #iâdeà
NDEBUG


60 
	gšIÆšeBoxD‘ach
 = 
çl£
;

64 
	g»nd”A»Ç
->
ä“
(*(
size_t
 *)
this
,his);

67 * 
	gIÆšeBox
::
İ”©Ü
 
Ãw
(
size_t
 
sz
, 
R’d”A»Ç
* 
»nd”A»Ç
è
throw
()

69  
	g»nd”A»Ç
->
®loÿ‹
(
sz
);

72 
	gIÆšeBox
::
İ”©Ü
 
d–‘e
(* 
±r
, 
size_t
 
sz
)

74 
ASSERT
(
šIÆšeBoxD‘ach
);

77 *(
	gsize_t
 *)
	g±r
 = 
sz
;

80 #iâdeà
NDEBUG


81 
	gIÆšeBox
::
showT»eFÜThis
() const

83 ià(
m_»nd””
)

84 
m_»nd””
->
showT»eFÜThis
();

88 
	gIÆšeBox
::
height
() const

90 #ià
ENABLE
(
SVG
)

91 ià(
hasVœtu®Height
())

92  
vœtu®Height
();

95 ià(
»nd””
()->
isText
())

96  
	gm_isText
 ? 
»nd””
()->
¡yË
(
m_fœ¡Lše
)->
fÚt
().
height
() : 0;

97 ià(
»nd””
()->
isBox
(è&& 
·»Á
())

98  
toR’d”Box
(
m_»nd””
)->
height
();

100 
ASSERT
(
isIÆšeFlowBox
());

101 
R’d”BoxMod–Objeù
* 
	gæowObjeù
 = 
boxMod–Objeù
();

102 cÚ¡ 
	gFÚt
& 
	gfÚt
 = 
»nd””
()->
¡yË
(
m_fœ¡Lše
)->
fÚt
();

103 
	g»suÉ
 = 
fÚt
.
height
();

104 ià(
·»Á
())

105 
	g»suÉ
 +ğ
æowObjeù
->
bÜd”Tİ
(è+ flowObjeù->
·ddšgTİ
(è+ flowObjeù->
bÜd”BÙtom
(è+ flowObjeù->
·ddšgBÙtom
();

106  
	g»suÉ
;

109 
	gIÆšeBox
::
ÿ»tMšOff£t
() const

111  
m_»nd””
->
ÿ»tMšOff£t
();

114 
	gIÆšeBox
::
ÿ»tMaxOff£t
() const

116  
m_»nd””
->
ÿ»tMaxOff£t
();

119 
	gIÆšeBox
::
ÿ»tMaxR’d”edOff£t
() const

124 
	gIÆšeBox
::
dœtyLšeBoxes
()

126 
m¬kDœty
();

127 
IÆšeFlowBox
* 
	gcu¼
 = 
·»Á
(); cu¼ && !cu¼->
isDœty
(); cu¼ = 
cu¼
->parent())

128 
cu¼
->
m¬kDœty
();

131 
	gIÆšeBox
::
d–‘eLše
(
R’d”A»Ç
* 
¬’a
)

133 ià(!
m_exŒaùed
 && 
m_»nd””
->
isBox
())

134 
toR’d”Box
(
m_»nd””
)->
£tIÆšeBoxW¿µ”
(0);

135 
de¡roy
(
¬’a
);

138 
	gIÆšeBox
::
exŒaùLše
()

140 
m_exŒaùed
 = 
Œue
;

141 ià(
	gm_»nd””
->
isBox
())

142 
toR’d”Box
(
m_»nd””
)->
£tIÆšeBoxW¿µ”
(0);

145 
	gIÆšeBox
::
©chLše
()

147 
m_exŒaùed
 = 
çl£
;

148 ià(
	gm_»nd””
->
isBox
())

149 
toR’d”Box
(
m_»nd””
)->
£tIÆšeBoxW¿µ”
(
this
);

152 
	gIÆšeBox
::
adju¡Pos™iÚ
(
dx
, 
dy
)

154 
	gm_x
 +ğ
dx
;

155 
	gm_y
 +ğ
dy
;

156 ià(
	gm_»nd””
->
isR•Ïûd
()) {

157 
R’d”Box
* 
	gbox
 = 
toR’d”Box
(
m_»nd””
);

158 
	gbox
->
move
(
dx
, 
dy
);

162 
	gIÆšeBox
::
·št
(
R’d”Objeù
::
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

164 ià(!
»nd””
()->
shouldPaštW™hšRoÙ
(
·štInfo
è|| (
	g·štInfo
.
	gpha£
 !ğ
PaštPha£FÜeground
 &&…aštInfo.
pha£
 !ğ
PaštPha£S–eùiÚ
))

170 
boŞ
 
	g´e£rvePha£
 = 
·štInfo
.
pha£
 =ğ
PaštPha£S–eùiÚ
 ||…aštInfo.pha£ =ğ
PaštPha£TextCl
;

171 
	gR’d”Objeù
::
PaštInfo
 
šfo
(
·štInfo
);

172 
	gšfo
.
	gpha£
 = 
´e£rvePha£
 ? 
·štInfo
.
pha£
 : 
PaštPha£BlockBackground
;

173 
»nd””
()->
·št
(
šfo
, 
tx
, 
ty
);

174 ià(!
	g´e£rvePha£
) {

175 
	gšfo
.
	gpha£
 = 
PaštPha£ChdBlockBackgrounds
;

176 
»nd””
()->
·št
(
šfo
, 
tx
, 
ty
);

177 
	gšfo
.
	gpha£
 = 
PaštPha£Flßt
;

178 
»nd””
()->
·št
(
šfo
, 
tx
, 
ty
);

179 
	gšfo
.
	gpha£
 = 
PaštPha£FÜeground
;

180 
»nd””
()->
·št
(
šfo
, 
tx
, 
ty
);

181 
	gšfo
.
	gpha£
 = 
PaštPha£Ouše
;

182 
»nd””
()->
·št
(
šfo
, 
tx
, 
ty
);

186 
boŞ
 
	gIÆšeBox
::
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
& 
»que¡
, 
H™Te¡ResuÉ
& 
»suÉ
, 
x
, 
y
, 
tx
, 
ty
)

191  
»nd””
()->
h™Te¡
(
»que¡
, 
»suÉ
, 
IÁPošt
(
x
, 
y
), 
tx
, 
ty
);

194 cÚ¡ 
RoÙIÆšeBox
* 
	gIÆšeBox
::
roÙ
() const

196 ià(
m_·»Á
)

197  
m_·»Á
->
roÙ
();

198 
ASSERT
(
isRoÙIÆšeBox
());

199  
	g¡©ic_ÿ¡
<cÚ¡ 
	gRoÙIÆšeBox
*>(
	gthis
);

202 
RoÙIÆšeBox
* 
	gIÆšeBox
::
roÙ
()

204 ià(
m_·»Á
)

205  
m_·»Á
->
roÙ
();

206 
ASSERT
(
isRoÙIÆšeBox
());

207  
	g¡©ic_ÿ¡
<
	gRoÙIÆšeBox
*>(
	gthis
);

210 
boŞ
 
	gIÆšeBox
::
ÃxtOnLšeExi¡s
() const

212 ià(!
m_d‘”mšedIfNextOnLšeExi¡s
) {

213 
m_d‘”mšedIfNextOnLšeExi¡s
 = 
Œue
;

215 ià(!
·»Á
())

216 
	gm_ÃxtOnLšeExi¡s
 = 
çl£
;

217 ià(
ÃxtOnLše
())

218 
	gm_ÃxtOnLšeExi¡s
 = 
Œue
;

220 
	gm_ÃxtOnLšeExi¡s
 = 
·»Á
()->
ÃxtOnLšeExi¡s
();

222  
	gm_ÃxtOnLšeExi¡s
;

225 
boŞ
 
	gIÆšeBox
::
´evOnLšeExi¡s
() const

227 ià(!
m_d‘”mšedIfP»vOnLšeExi¡s
) {

228 
m_d‘”mšedIfP»vOnLšeExi¡s
 = 
Œue
;

230 ià(!
·»Á
())

231 
	gm_´evOnLšeExi¡s
 = 
çl£
;

232 ià(
´evOnLše
())

233 
	gm_´evOnLšeExi¡s
 = 
Œue
;

235 
	gm_´evOnLšeExi¡s
 = 
·»Á
()->
´evOnLšeExi¡s
();

237  
	gm_´evOnLšeExi¡s
;

240 
IÆšeBox
* 
	gIÆšeBox
::
ÃxtL—fChd
() const

242 
IÆšeBox
* 
Ëaf
 = 0;

243 
IÆšeBox
* 
	gbox
 = 
ÃxtOnLše
(); box && !
	gËaf
; box = 
box
->nextOnLine())

244 
Ëaf
 = 
box
->
isL—f
(è? box : 
¡©ic_ÿ¡
<
IÆšeFlowBox
*>(box)->
fœ¡L—fChd
();

245 ià(!
	gËaf
 && 
·»Á
())

246 
	gËaf
 = 
·»Á
()->
ÃxtL—fChd
();

247  
	gËaf
;

250 
IÆšeBox
* 
	gIÆšeBox
::
´evL—fChd
() const

252 
IÆšeBox
* 
Ëaf
 = 0;

253 
IÆšeBox
* 
	gbox
 = 
´evOnLše
(); box && !
	gËaf
; box = 
box
->prevOnLine())

254 
Ëaf
 = 
box
->
isL—f
(è? box : 
¡©ic_ÿ¡
<
IÆšeFlowBox
*>(box)->
Ï¡L—fChd
();

255 ià(!
	gËaf
 && 
·»Á
())

256 
	gËaf
 = 
·»Á
()->
´evL—fChd
();

257  
	gËaf
;

260 
	gR’d”Objeù
::
S–eùiÚS‹
 
IÆšeBox
::
£ËùiÚS‹
()

262  
»nd””
()->
£ËùiÚS‹
();

265 
boŞ
 
	gIÆšeBox
::
ÿnAccommod©eEÎsis
(boŞ 
Ér
, 
blockEdge
, 
–lsisWidth
)

268 ià(!
	gm_»nd””
 || !m_»nd””->
isR•Ïûd
())

269  
	gŒue
;

271 
IÁReù
 
boxReù
(
m_x
, 0, 
m_width
, 10);

272 
IÁReù
 
–lsisReù
(
Ér
 ? 
blockEdge
 - 
–lsisWidth
 : blockEdge, 0,ƒllipsisWidth, 10);

273  !(
	gboxReù
.
š‹r£ùs
(
–lsisReù
));

276 
	gIÆšeBox
::
¶aûEÎsisBox
(
boŞ
, , , , bool&)

284 #iâdeà
NDEBUG


286 
showT»e
(cÚ¡ 
WebCÜe
::
IÆšeBox
* 
b
)

288 ià(
b
)

289 
b
->
showT»eFÜThis
();

	@InlineBox.h

21 #iâdeà
IÆšeBox_h


22 
	#IÆšeBox_h


	)

24 
	~"R’d”BoxMod–Objeù.h
"

25 
	~"TextDœeùiÚ.h
"

27 
Çme¥aû
 
	gWebCÜe
 {

29 
şass
 
	gH™Te¡Reque¡
;

30 
şass
 
	gH™Te¡ResuÉ
;

31 
şass
 
	gRoÙIÆšeBox
;

36 şas 
	cIÆšeBox
 {

37 
	gpublic
:

38 
IÆšeBox
(
R’d”Objeù
* 
obj
)

39 : 
m_Ãxt
(0)

40 , 
m_´ev
(0)

41 , 
m_·»Á
(0)

42 , 
m_»nd””
(
obj
)

43 , 
m_x
(0)

44 , 
m_y
(0)

45 , 
m_width
(0)

46 , 
m_fœ¡Lše
(
çl£
)

47 , 
m_cÚ¡ruùed
(
çl£
)

48 , 
m_bidiEmbeddšgLev–
(0)

49 , 
m_dœty
(
çl£
)

50 , 
m_exŒaùed
(
çl£
)

51 #ià
ENABLE
(
SVG
)

52 , 
m_hasVœtu®Height
(
çl£
)

54 , 
m_’dsW™hB»ak
(
çl£
)

55 , 
m_hasS–eùedChd»n
(
çl£
)

56 , 
m_hasEÎsisBox
(
çl£
)

57 , 
m_dœOv”ride
(
çl£
)

58 , 
m_isText
(
çl£
)

59 , 
m_d‘”mšedIfNextOnLšeExi¡s
(
çl£
)

60 , 
m_d‘”mšedIfP»vOnLšeExi¡s
(
çl£
)

61 , 
m_ÃxtOnLšeExi¡s
(
çl£
)

62 , 
m_´evOnLšeExi¡s
(
çl£
)

63 , 
m_toAdd
(0)

64 #iâdeà
NDEBUG


65 , 
m_hasBadP¬’t
(
çl£
)

70 
IÆšeBox
(
R’d”Objeù
* 
obj
, 
x
, 
y
, 
width
, 
boŞ
 
fœ¡Lše
, boŞ 
cÚ¡ruùed
,

71 
boŞ
 
dœty
, boŞ 
exŒaùed
, 
IÆšeBox
* 
Ãxt
, IÆšeBox* 
´ev
, 
IÆšeFlowBox
* 
·»Á
)

72 : 
m_Ãxt
(
Ãxt
)

73 , 
m_´ev
(
´ev
)

74 , 
m_·»Á
(
·»Á
)

75 , 
m_»nd””
(
obj
)

76 , 
m_x
(
x
)

77 , 
m_y
(
y
)

78 , 
m_width
(
width
)

79 , 
m_fœ¡Lše
(
fœ¡Lše
)

80 , 
m_cÚ¡ruùed
(
cÚ¡ruùed
)

81 , 
m_bidiEmbeddšgLev–
(0)

82 , 
m_dœty
(
dœty
)

83 , 
m_exŒaùed
(
exŒaùed
)

84 #ià
ENABLE
(
SVG
)

85 , 
m_hasVœtu®Height
(
çl£
)

87 , 
m_’dsW™hB»ak
(
çl£
)

88 , 
m_hasS–eùedChd»n
(
çl£
)

89 , 
m_hasEÎsisBox
(
çl£
)

90 , 
m_dœOv”ride
(
çl£
)

91 , 
m_isText
(
çl£
)

92 , 
m_d‘”mšedIfNextOnLšeExi¡s
(
çl£
)

93 , 
m_d‘”mšedIfP»vOnLšeExi¡s
(
çl£
)

94 , 
m_ÃxtOnLšeExi¡s
(
çl£
)

95 , 
m_´evOnLšeExi¡s
(
çl£
)

96 , 
m_toAdd
(0)

97 #iâdeà
NDEBUG


98 , 
m_hasBadP¬’t
(
çl£
)

103 
	gvœtu®
 ~
IÆšeBox
();

105 
vœtu®
 
de¡roy
(
R’d”A»Ç
*);

107 
vœtu®
 
d–‘eLše
(
R’d”A»Ç
*);

108 
vœtu®
 
exŒaùLše
();

109 
vœtu®
 
©chLše
();

111 
vœtu®
 
boŞ
 
isLšeB»ak
(ècÚ¡ {  
	gçl£
; }

113 
vœtu®
 
adju¡Pos™iÚ
(
dx
, 
dy
);

115 
vœtu®
 
·št
(
R’d”Objeù
::
PaštInfo
&, 
tx
, 
ty
);

116 
vœtu®
 
boŞ
 
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, 
x
, 
y
, 
tx
, 
ty
);

119 * 
İ”©Ü
 
Ãw
(
size_t
, 
R’d”A»Ç
*è
throw
();

122 
İ”©Ü
 
d–‘e
(*, 
size_t
);

124 
	g´iv©e
:

126 * 
İ”©Ü
 
Ãw
(
size_t
è
throw
();

128 
	gpublic
:

129 #iâdeà
NDEBUG


130 
showT»eFÜThis
() const;

133 
boŞ
 
isText
(ècÚ¡ {  
	gm_isText
; }

134 
£tIsText
(
boŞ
 
b
è{ 
	gm_isText
 = b; }

136 
vœtu®
 
boŞ
 
isIÆšeBox
(è{  
	gçl£
; }

137 
vœtu®
 
boŞ
 
isIÆšeFlowBox
(ècÚ¡ {  
	gçl£
; }

138 
vœtu®
 
boŞ
 
isIÆšeTextBox
(è{  
	gçl£
; }

139 
vœtu®
 
boŞ
 
isRoÙIÆšeBox
(ècÚ¡ {  
	gçl£
; }

140 #ià
ENABLE
(
SVG
)

141 
vœtu®
 
boŞ
 
isSVGRoÙIÆšeBox
(è{  
	gçl£
; }

143 
boŞ
 
hasVœtu®Height
(ècÚ¡ {  
	gm_hasVœtu®Height
; }

144 
£tHasVœtu®Height
(è{ 
	gm_hasVœtu®Height
 = 
Œue
; }

145 
vœtu®
 
vœtu®Height
(ècÚ¡ { 
ASSERT_NOT_REACHED
();  0; }

148 
boŞ
 
isCÚ¡ruùed
(è{  
	gm_cÚ¡ruùed
; }

149 
vœtu®
 
£tCÚ¡ruùed
()

151 
	gm_cÚ¡ruùed
 = 
Œue
;

152 ià(
	gm_Ãxt
)

153 
	gm_Ãxt
->
£tCÚ¡ruùed
();

156 
£tExŒaùed
(
boŞ
 
b
 = 
Œue
è{ 
m_exŒaùed
 = b; }

158 
£tFœ¡LšeStyËB™
(
boŞ
 
f
è{ 
	gm_fœ¡Lše
 = f; }

159 
boŞ
 
isFœ¡LšeStyË
(ècÚ¡ {  
	gm_fœ¡Lše
; }

161 
»move
();

163 
IÆšeBox
* 
ÃxtOnLše
(ècÚ¡ {  
	gm_Ãxt
; }

164 
IÆšeBox
* 
´evOnLše
(ècÚ¡ {  
	gm_´ev
; }

165 
£tNextOnLše
(
IÆšeBox
* 
Ãxt
)

167 
ASSERT
(
m_·»Á
 || !
Ãxt
);

168 
	gm_Ãxt
 = 
Ãxt
;

170 
£tP»vOnLše
(
IÆšeBox
* 
´ev
)

172 
ASSERT
(
m_·»Á
 || !
´ev
);

173 
	gm_´ev
 = 
´ev
;

175 
boŞ
 
ÃxtOnLšeExi¡s
() const;

176 
boŞ
 
´evOnLšeExi¡s
() const;

178 
vœtu®
 
boŞ
 
isL—f
(ècÚ¡ {  
	gŒue
; }

180 
IÆšeBox
* 
ÃxtL—fChd
() const;

181 
IÆšeBox
* 
´evL—fChd
() const;

183 
R’d”Objeù
* 
»nd””
(ècÚ¡ {  
	gm_»nd””
; }

185 
IÆšeFlowBox
* 
·»Á
() const

187 
ASSERT
(!
m_hasBadP¬’t
);

188  
	gm_·»Á
;

190 
£tP¬’t
(
IÆšeFlowBox
* 
·r
è{ 
	gm_·»Á
 =…ar; }

192 cÚ¡ 
RoÙIÆšeBox
* 
roÙ
() const;

193 
RoÙIÆšeBox
* 
roÙ
();

195 
£tWidth
(
w
è{ 
	gm_width
 = w; }

196 
width
(ècÚ¡ {  
	gm_width
; }

199 
£tX
(
x
è{ 
	gm_x
 = x; }

200 
x
(ècÚ¡ {  
	gm_x
; }

203 
£tY
(
y
è{ 
	gm_y
 = y; }

204 
y
(ècÚ¡ {  
	gm_y
; }

206 
height
() const;

208 
šlše
 
ba£lšePos™iÚ
(
boŞ
 
isRoÙLšeBox
ècÚ¡ {  
»nd””
()->ba£lšePos™iÚ(
m_fœ¡Lše
, isRootLineBox); }

209 
šlše
 
lšeHeight
(
boŞ
 
isRoÙLšeBox
ècÚ¡ {  
»nd””
()->lšeHeight(
m_fœ¡Lše
, isRootLineBox); }

211 
vœtu®
 
ÿ»tMšOff£t
() const;

212 
vœtu®
 
ÿ»tMaxOff£t
() const;

213 
vœtu®
 
ÿ»tMaxR’d”edOff£t
() const;

215 
bidiLev–
(ècÚ¡ {  
	gm_bidiEmbeddšgLev–
; }

216 
£tBidiLev–
(
Ëv–
è{ 
	gm_bidiEmbeddšgLev–
 =†evel; }

217 
TextDœeùiÚ
 
dœeùiÚ
(ècÚ¡ {  
	gm_bidiEmbeddšgLev–
 % 2 ? 
	gRTL
 : 
LTR
; }

218 
ÿ»tLeámo¡Off£t
(ècÚ¡ {  
dœeùiÚ
(è=ğ
LTR
 ? 
ÿ»tMšOff£t
(è: 
ÿ»tMaxOff£t
(); }

219 
ÿ»tRightmo¡Off£t
(ècÚ¡ {  
dœeùiÚ
(è=ğ
LTR
 ? 
ÿ»tMaxOff£t
(è: 
ÿ»tMšOff£t
(); }

221 
vœtu®
 
ş—rTrunÿtiÚ
() { }

223 
boŞ
 
isDœty
(ècÚ¡ {  
	gm_dœty
; }

224 
m¬kDœty
(
boŞ
 
dœty
 = 
Œue
è{ 
m_dœty
 = dirty; }

226 
dœtyLšeBoxes
();

228 
vœtu®
 
	gR’d”Objeù
::
S–eùiÚS‹
 
£ËùiÚS‹
();

230 
vœtu®
 
boŞ
 
ÿnAccommod©eEÎsis
(boŞ 
Ér
, 
blockEdge
, 
–lsisWidth
);

232 
vœtu®
 
¶aûEÎsisBox
(
boŞ
 
Ér
, 
visibËLeáEdge
, 
visibËRightEdge
, 
–lsisWidth
, bool&);

234 
£tHasBadP¬’t
();

236 
toAdd
(ècÚ¡ {  
	gm_toAdd
; }

238 
boŞ
 
visibËToH™Te¡šg
(ècÚ¡ {  
»nd””
()->
¡yË
()->
visib™y
(è=ğ
VISIBLE
 &&„’d””()->¡yË()->
poš‹rEv’ts
(è!ğ
PE_NONE
; }

241 
R’d”BoxMod–Objeù
* 
boxMod–Objeù
() const

243 ià(!
	gm_»nd””
->
isText
())

244  
toR’d”BoxMod–Objeù
(
m_»nd””
);

248 
	g´iv©e
:

249 
IÆšeBox
* 
m_Ãxt
;

250 
IÆšeBox
* 
	gm_´ev
;

252 
IÆšeFlowBox
* 
	gm_·»Á
;

254 
	gpublic
:

255 
R’d”Objeù
* 
m_»nd””
;

257 
	gm_x
;

258 
	gm_y
;

259 
	gm_width
;

264 
	g´Ùeùed
:

265 
boŞ
 
m_fœ¡Lše
 : 1;

266 
	g´iv©e
:

267 
boŞ
 
m_cÚ¡ruùed
 : 1;

268 
	gm_bidiEmbeddšgLev–
 : 6;

269 
	g´Ùeùed
:

270 
boŞ
 
m_dœty
 : 1;

271 
boŞ
 
	gm_exŒaùed
 : 1;

272 
boŞ
 
	gm_hasVœtu®Height
 : 1;

275 
boŞ
 
	gm_’dsW™hB»ak
 : 1;

276 
boŞ
 
	gm_hasS–eùedChd»n
 : 1;

277 
boŞ
 
	gm_hasEÎsisBox
 : 1;

280 
	gpublic
:

281 
boŞ
 
m_dœOv”ride
 : 1;

282 
boŞ
 
	gm_isText
 : 1;

283 
	g´Ùeùed
:

284 
mubË
 
boŞ
 
m_d‘”mšedIfNextOnLšeExi¡s
 : 1;

285 
mubË
 
boŞ
 
	gm_d‘”mšedIfP»vOnLšeExi¡s
 : 1;

286 
mubË
 
boŞ
 
	gm_ÃxtOnLšeExi¡s
 : 1;

287 
mubË
 
boŞ
 
	gm_´evOnLšeExi¡s
 : 1;

288 
	gm_toAdd
 : 12;

290 #iâdeà
NDEBUG


291 
	g´iv©e
:

292 
boŞ
 
m_hasBadP¬’t
;

296 #ifdeà
NDEBUG


297 
šlše
 
	gIÆšeBox
::~
	$IÆšeBox
()

299 
	}
}

302 
šlše
 
IÆšeBox
::
	$£tHasBadP¬’t
()

304 #iâdeà
NDEBUG


305 
m_hasBadP¬’t
 = 
Œue
;

307 
	}
}

311 #iâdeà
NDEBUG


313 
showT»e
(cÚ¡ 
WebCÜe
::
IÆšeBox
*);

	@InlineFlowBox.cpp

20 
	~"cÚfig.h
"

21 
	~"IÆšeFlowBox.h
"

23 
	~"CachedImage.h
"

24 
	~"CSSPrİ”tyNames.h
"

25 
	~"Docum’t.h
"

26 
	~"EÎsisBox.h
"

27 
	~"G¿phicsCÚ‹xt.h
"

28 
	~"IÆšeTextBox.h
"

29 
	~"H™Te¡ResuÉ.h
"

30 
	~"RoÙIÆšeBox.h
"

31 
	~"R’d”Block.h
"

32 
	~"R’d”IÆše.h
"

33 
	~"R’d”Lay”.h
"

34 
	~"R’d”Li¡M¬k”.h
"

35 
	~"R’d”TabËC–l.h
"

36 
	~"RoÙIÆšeBox.h
"

37 
	~"Text.h
"

39 
	~<m©h.h
>

41 
usšg
 
Çme¥aû
 
	g¡d
;

43 
Çme¥aû
 
	gWebCÜe
 {

45 #iâdeà
NDEBUG


47 
	gIÆšeFlowBox
::~
IÆšeFlowBox
()

49 ià(!
m_hasBadChdLi¡
)

50 
IÆšeBox
* 
chd
 = 
fœ¡Chd
(); 
	gchd
; chd = chd->
ÃxtOnLše
())

51 
chd
->
£tHasBadP¬’t
();

56 
	gIÆšeFlowBox
::
g‘FlowS·cšgWidth
()

58 
tÙWidth
 = 
m¬gšBÜd”PaddšgLeá
(è+ 
m¬gšBÜd”PaddšgRight
();

59 
IÆšeBox
* 
	gcu¼
 = 
fœ¡Chd
(); cu¼; cu¼ = 
cu¼
->
ÃxtOnLše
()) {

60 ià(
cu¼
->
isIÆšeFlowBox
())

61 
tÙWidth
 +ğ
¡©ic_ÿ¡
<
IÆšeFlowBox
*>(
cu¼
)->
g‘FlowS·cšgWidth
();

63  
	gtÙWidth
;

66 
	gIÆšeFlowBox
::
addToLše
(
IÆšeBox
* 
chd
)

68 
ASSERT
(!
chd
->
·»Á
());

69 
ASSERT
(!
chd
->
ÃxtOnLše
());

70 
ASSERT
(!
chd
->
´evOnLše
());

71 
checkCÚsi¡’cy
();

73 
	gchd
->
£tP¬’t
(
this
);

74 ià(!
	gm_fœ¡Chd
) {

75 
	gm_fœ¡Chd
 = 
chd
;

76 
	gm_Ï¡Chd
 = 
chd
;

78 
	gm_Ï¡Chd
->
£tNextOnLše
(
chd
);

79 
	gchd
->
£tP»vOnLše
(
m_Ï¡Chd
);

80 
	gm_Ï¡Chd
 = 
chd
;

82 
	gchd
->
£tFœ¡LšeStyËB™
(
m_fœ¡Lše
);

83 ià(
	gchd
->
isText
())

84 
	gm_hasTextChd»n
 = 
Œue
;

85 ià(
	gchd
->
»nd””
()->
£ËùiÚS‹
(è!ğ
R’d”Objeù
::
S–eùiÚNÚe
)

86 
roÙ
()->
£tHasS–eùedChd»n
(
Œue
);

88 
checkCÚsi¡’cy
();

91 
	gIÆšeFlowBox
::
»moveChd
(
IÆšeBox
* 
chd
)

93 
checkCÚsi¡’cy
();

95 ià(!
	gm_dœty
)

96 
dœtyLšeBoxes
();

98 
roÙ
()->
chdRemoved
(
chd
);

100 ià(
	gchd
 =ğ
m_fœ¡Chd
)

101 
m_fœ¡Chd
 = 
chd
->
ÃxtOnLše
();

102 ià(
	gchd
 =ğ
m_Ï¡Chd
)

103 
m_Ï¡Chd
 = 
chd
->
´evOnLše
();

104 ià(
	gchd
->
ÃxtOnLše
())

105 
	gchd
->
ÃxtOnLše
()->
£tP»vOnLše
(
chd
->
´evOnLše
());

106 ià(
	gchd
->
´evOnLše
())

107 
	gchd
->
´evOnLše
()->
£tNextOnLše
(
chd
->
ÃxtOnLše
());

109 
	gchd
->
£tP¬’t
(0);

111 
checkCÚsi¡’cy
();

114 
	gIÆšeFlowBox
::
d–‘eLše
(
R’d”A»Ç
* 
¬’a
)

116 
IÆšeBox
* 
chd
 = 
fœ¡Chd
();

117 
IÆšeBox
* 
	gÃxt
 = 0;

118 
	gchd
) {

119 
ASSERT
(
this
 =ğ
chd
->
·»Á
());

120 
	gÃxt
 = 
chd
->
ÃxtOnLše
();

121 #iâdeà
NDEBUG


122 
	gchd
->
£tP¬’t
(0);

124 
	gchd
->
d–‘eLše
(
¬’a
);

125 
	gchd
 = 
Ãxt
;

127 #iâdeà
NDEBUG


128 
	gm_fœ¡Chd
 = 0;

129 
	gm_Ï¡Chd
 = 0;

132 
»moveLšeBoxFromR’d”Objeù
();

133 
de¡roy
(
¬’a
);

136 
	gIÆšeFlowBox
::
»moveLšeBoxFromR’d”Objeù
()

138 
toR’d”IÆše
(
»nd””
())->
lšeBoxes
()->
»moveLšeBox
(
this
);

141 
	gIÆšeFlowBox
::
exŒaùLše
()

143 ià(!
m_exŒaùed
)

144 
exŒaùLšeBoxFromR’d”Objeù
();

145 
IÆšeBox
* 
	gchd
 = 
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtOnLše
())

146 
chd
->
exŒaùLše
();

149 
	gIÆšeFlowBox
::
exŒaùLšeBoxFromR’d”Objeù
()

151 
toR’d”IÆše
(
»nd””
())->
lšeBoxes
()->
exŒaùLšeBox
(
this
);

154 
	gIÆšeFlowBox
::
©chLše
()

156 ià(
m_exŒaùed
)

157 
©chLšeBoxToR’d”Objeù
();

158 
IÆšeBox
* 
	gchd
 = 
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtOnLše
())

159 
chd
->
©chLše
();

162 
	gIÆšeFlowBox
::
©chLšeBoxToR’d”Objeù
()

164 
toR’d”IÆše
(
»nd””
())->
lšeBoxes
()->
©chLšeBox
(
this
);

167 
	gIÆšeFlowBox
::
adju¡Pos™iÚ
(
dx
, 
dy
)

169 
	gIÆšeBox
::
adju¡Pos™iÚ
(
dx
, 
dy
);

170 
IÆšeBox
* 
	gchd
 = 
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtOnLše
())

171 
chd
->
adju¡Pos™iÚ
(
dx
, 
dy
);

172 ià(
	gm_ov”æow
)

173 
	gm_ov”æow
->
move
(
dx
, 
dy
);

176 
R’d”LšeBoxLi¡
* 
	gIÆšeFlowBox
::
»nd””LšeBoxes
() const

178  
toR’d”IÆše
(
»nd””
())->
lšeBoxes
();

181 
boŞ
 
	gIÆšeFlowBox
::
ÚEndChaš
(
R’d”Objeù
* 
’dObjeù
)

183 ià(!
’dObjeù
)

184  
çl£
;

186 ià(
	g’dObjeù
 =ğ
»nd””
())

187  
Œue
;

189 
R’d”Objeù
* 
	gcu¼
 = 
’dObjeù
;

190 
R’d”Objeù
* 
	g·»Á
 = 
cu¼
->
·»Á
();

191 
	g·»Á
 && !·»Á->
isR’d”Block
()) {

192 ià(
	g·»Á
->
Ï¡Chd
(è!ğ
cu¼
 || 
·»Á
 =ğ
»nd””
())

193  
çl£
;

195 
	gcu¼
 = 
·»Á
;

196 
	g·»Á
 = 
cu¼
->
·»Á
();

199  
	gŒue
;

202 
	gIÆšeFlowBox
::
d‘”mšeS·cšgFÜFlowBoxes
(
boŞ
 
Ï¡Lše
, 
R’d”Objeù
* 
’dObjeù
)

206 
boŞ
 
	gšşudeLeáEdge
 = 
çl£
;

207 
boŞ
 
	gšşudeRightEdge
 = 
çl£
;

210 ià(
·»Á
()) {

211 
boŞ
 
	gÉr
 = 
»nd””
()->
¡yË
()->
dœeùiÚ
(è=ğ
LTR
;

215 
R’d”LšeBoxLi¡
* 
	glšeBoxLi¡
 = 
»nd””LšeBoxes
();

216 ià(!
	glšeBoxLi¡
->
fœ¡LšeBox
()->
isCÚ¡ruùed
(è&& !
»nd””
()->
isIÆšeCÚtšu©iÚ
()) {

217 ià(
	gÉr
 && 
	glšeBoxLi¡
->
fœ¡LšeBox
(è=ğ
this
)

218 
šşudeLeáEdge
 = 
Œue
;

219 ià(!
	gÉr
 && 
	glšeBoxLi¡
->
Ï¡LšeBox
(è=ğ
this
)

220 
šşudeRightEdge
 = 
Œue
;

230 ià(!
	glšeBoxLi¡
->
Ï¡LšeBox
()->
isCÚ¡ruùed
()) {

231 
R’d”IÆše
* 
	gšlšeFlow
 = 
toR’d”IÆše
(
»nd””
());

232 ià(
	gÉr
) {

233 ià(!
ÃxtLšeBox
() &&

234 ((
	gÏ¡Lše
 && !
	gšlšeFlow
->
cÚtšu©iÚ
()è|| 
ÃxtOnLšeExi¡s
(è|| 
ÚEndChaš
(
’dObjeù
)))

235 
	gšşudeRightEdge
 = 
Œue
;

237 ià((!
´evLšeBox
(è||…»vLšeBox()->
isCÚ¡ruùed
()) &&

238 ((
	gÏ¡Lše
 && !
	gšlšeFlow
->
cÚtšu©iÚ
()è|| 
´evOnLšeExi¡s
(è|| 
ÚEndChaš
(
’dObjeù
)))

239 
	gšşudeLeáEdge
 = 
Œue
;

244 
£tEdges
(
šşudeLeáEdge
, 
šşudeRightEdge
);

247 
IÆšeBox
* 
	gcu¼Chd
 = 
fœ¡Chd
(); cu¼Chd; cu¼Chd = 
cu¼Chd
->
ÃxtOnLše
()) {

248 ià(
cu¼Chd
->
isIÆšeFlowBox
()) {

249 
IÆšeFlowBox
* 
cu¼Flow
 = 
¡©ic_ÿ¡
<IÆšeFlowBox*>(
cu¼Chd
);

250 
	gcu¼Flow
->
d‘”mšeS·cšgFÜFlowBoxes
(
Ï¡Lše
, 
’dObjeù
);

255 
	gIÆšeFlowBox
::
¶aûBoxesHÜizÚÎy
(
xPos
, 
boŞ
& 
ÃedsWÜdS·cšg
)

258 
£tX
(
xPos
);

260 
	gËáLayoutOv”æow
 = 
xPos
;

261 
	grightLayoutOv”æow
 = 
xPos
;

262 
	gËáVisu®Ov”æow
 = 
xPos
;

263 
	grightVisu®Ov”æow
 = 
xPos
;

265 
	gboxShadowLeá
;

266 
	gboxShadowRight
;

267 
»nd””
()->
¡yË
(
m_fœ¡Lše
)->
g‘BoxShadowHÜizÚlEx‹Á
(
boxShadowLeá
, 
boxShadowRight
);

269 
	gËáVisu®Ov”æow
 = 
mš
(
xPos
 + 
boxShadowLeá
, 
ËáVisu®Ov”æow
);

271 
	g¡¬tX
 = 
xPos
;

272 
	gxPos
 +ğ
bÜd”Leá
(è+ 
·ddšgLeá
();

274 
IÆšeBox
* 
	gcu¼
 = 
fœ¡Chd
(); cu¼; cu¼ = 
cu¼
->
ÃxtOnLše
()) {

275 ià(
cu¼
->
»nd””
()->
isText
()) {

276 
IÆšeTextBox
* 
‹xt
 = 
¡©ic_ÿ¡
<IÆšeTextBox*>(
cu¼
);

277 
R’d”Text
* 
	g¹
 = 
toR’d”Text
(
‹xt
->
»nd””
());

278 ià(
	g¹
->
‹xtL’gth
()) {

279 ià(
	gÃedsWÜdS·cšg
 && 
isS·ûOrNewlše
(
¹
->
ch¬aù”s
()[
‹xt
->
¡¬t
()]))

280 
	gxPos
 +ğ
¹
->
¡yË
(
m_fœ¡Lše
)->
fÚt
().
wÜdS·cšg
();

281 
	gÃedsWÜdS·cšg
 = !
isS·ûOrNewlše
(
¹
->
ch¬aù”s
()[
‹xt
->
’d
()]);

283 
	g‹xt
->
£tX
(
xPos
);

285 
	g¡rokeOv”æow
 = 
¡©ic_ÿ¡
<>(
ûf
(
¹
->
¡yË
()->
‹xtSŒokeWidth
() / 2.0f));

289 
	gË‰”S·cšg
 = 
mš
(0, ()
¹
->
¡yË
(
m_fœ¡Lše
)->
fÚt
().
Ë‰”S·cšg
());

290 
	grightLayoutOv”æow
 = 
max
(
xPos
 + 
‹xt
->
width
(è- 
Ë‰”S·cšg
, 
rightLayoutOv”æow
);

292 
GlyphOv”æow
* 
	gglyphOv”æow
 = 
¡©ic_ÿ¡
<
IÆšeTextBox
*>(
cu¼
)->
glyphOv”æow
();

294 
	gËáGlyphOv”æow
 = -
¡rokeOv”æow
 - (
glyphOv”æow
 ? glyphOv”æow->
Ëá
 : 0);

295 
	grightGlyphOv”æow
 = 
¡rokeOv”æow
 - 
Ë‰”S·cšg
 + (
glyphOv”æow
 ? glyphOv”æow->
right
 : 0);

297 
	gchdOv”æowLeá
 = 
ËáGlyphOv”æow
;

298 
	gchdOv”æowRight
 = 
rightGlyphOv”æow
;

299 cÚ¡ 
ShadowD©a
* 
	gshadow
 = 
¹
->
¡yË
()->
‹xtShadow
(); shadow; shadow = 
shadow
->
Ãxt
()) {

300 
chdOv”æowLeá
 = 
mš
(chdOv”æowLeá, 
shadow
->
x
(è- shadow->
blur
(è+ 
ËáGlyphOv”æow
);

301 
	gchdOv”æowRight
 = 
max
(
chdOv”æowRight
, 
shadow
->
x
(è+ shadow->
blur
(è+ 
rightGlyphOv”æow
);

304 
	gËáVisu®Ov”æow
 = 
mš
(
xPos
 + 
chdOv”æowLeá
, 
ËáVisu®Ov”æow
);

305 
	grightVisu®Ov”æow
 = 
max
(
xPos
 + 
‹xt
->
width
(è+ 
chdOv”æowRight
, 
rightVisu®Ov”æow
);

307 
	gxPos
 +ğ
‹xt
->
width
();

309 ià(
	gcu¼
->
»nd””
()->
isPos™iÚed
()) {

310 ià(
	gcu¼
->
»nd””
()->
·»Á
()->
¡yË
()->
dœeùiÚ
(è=ğ
LTR
)

311 
cu¼
->
£tX
(
xPos
);

316 
	gcu¼
->
£tX
(
roÙ
()->
block
()->
width
(è- 
xPos
);

319 ià(
	gcu¼
->
»nd””
()->
isR’d”IÆše
()) {

320 
IÆšeFlowBox
* 
	gæow
 = 
¡©ic_ÿ¡
<IÆšeFlowBox*>(
cu¼
);

321 
	gxPos
 +ğ
æow
->
m¬gšLeá
();

322 
	gxPos
 = 
æow
->
¶aûBoxesHÜizÚÎy
(
xPos
, 
ÃedsWÜdS·cšg
);

323 
	gxPos
 +ğ
æow
->
m¬gšRight
();

324 
	gËáLayoutOv”æow
 = 
mš
(
ËáLayoutOv”æow
, 
æow
->leftLayoutOverflow());

325 
	grightLayoutOv”æow
 = 
max
(
rightLayoutOv”æow
, 
æow
->rightLayoutOverflow());

326 
	gËáVisu®Ov”æow
 = 
mš
(
ËáVisu®Ov”æow
, 
æow
->leftVisualOverflow());

327 
	grightVisu®Ov”æow
 = 
max
(
rightVisu®Ov”æow
, 
æow
->rightVisualOverflow());

328 } ià(!
	gcu¼
->
»nd””
()->
isLi¡M¬k”
(è|| 
toR’d”Li¡M¬k”
(
cu¼
->»nd””())->
isInside
()) {

329 
	gxPos
 +ğ
cu¼
->
boxMod–Objeù
()->
m¬gšLeá
();

330 
	gcu¼
->
£tX
(
xPos
);

332 
R’d”Box
* 
	gbox
 = 
toR’d”Box
(
cu¼
->
»nd””
());

333 
	gchdLeáOv”æow
 = 
box
->
hasOv”æowCl
(è? 0 : box->
ËáLayoutOv”æow
();

334 
	gchdRightOv”æow
 = 
box
->
hasOv”æowCl
(è? 
cu¼
->
width
(è: box->
rightLayoutOv”æow
();

336 
	gËáLayoutOv”æow
 = 
mš
(
xPos
 + 
chdLeáOv”æow
, 
ËáLayoutOv”æow
);

337 
	grightLayoutOv”æow
 = 
max
(
xPos
 + 
chdRightOv”æow
, 
rightLayoutOv”æow
);

339 
	gËáVisu®Ov”æow
 = 
mš
(
xPos
 + 
box
->
ËáVisu®Ov”æow
(),†eftVisualOverflow);

340 
	grightVisu®Ov”æow
 = 
max
(
xPos
 + 
box
->
rightVisu®Ov”æow
(),„ightVisualOverflow);

342 
	gxPos
 +ğ
cu¼
->
width
(è+ cu¼->
boxMod–Objeù
()->
m¬gšRight
();

347 
	gxPos
 +ğ
bÜd”Right
(è+ 
·ddšgRight
();

348 
£tWidth
(
xPos
 - 
¡¬tX
);

349 
	grightVisu®Ov”æow
 = 
max
(
x
(è+ 
width
(è+ 
boxShadowRight
, 
rightVisu®Ov”æow
);

350 
	grightLayoutOv”æow
 = 
max
(
x
(è+ 
width
(), 
rightLayoutOv”æow
);

352 
£tHÜizÚlOv”æowPos™iÚs
(
ËáLayoutOv”æow
, 
rightLayoutOv”æow
, 
ËáVisu®Ov”æow
, 
rightVisu®Ov”æow
);

353  
	gxPos
;

356 
	gIÆšeFlowBox
::
adju¡MaxAsûÁAndDesûÁ
(& 
maxAsûÁ
, & 
maxDesûÁ
,

357 
maxPos™iÚTİ
, 
maxPos™iÚBÙtom
)

359 
IÆšeBox
* 
	gcu¼
 = 
fœ¡Chd
(); cu¼; cu¼ = 
cu¼
->
ÃxtOnLše
()) {

362 ià(
cu¼
->
»nd””
()->
isPos™iÚed
())

364 ià(
	gcu¼
->
y
(è=ğ
Pos™iÚTİ
 || 
cu¼
->y(è=ğ
Pos™iÚBÙtom
) {

365 
lšeHeight
 = 
cu¼
->lšeHeight(
çl£
);

366 ià(
	gcu¼
->
y
(è=ğ
Pos™iÚTİ
) {

367 ià(
maxAsûÁ
 + 
maxDesûÁ
 < 
lšeHeight
)

368 
maxDesûÁ
 = 
lšeHeight
 - 
maxAsûÁ
;

371 ià(
	gmaxAsûÁ
 + 
	gmaxDesûÁ
 < 
	glšeHeight
)

372 
	gmaxAsûÁ
 = 
lšeHeight
 - 
maxDesûÁ
;

375 ià(
	gmaxAsûÁ
 + 
	gmaxDesûÁ
 >ğ
max
(
maxPos™iÚTİ
, 
maxPos™iÚBÙtom
))

379 ià(
	gcu¼
->
isIÆšeFlowBox
())

380 
	g¡©ic_ÿ¡
<
	gIÆšeFlowBox
*>(
	gcu¼
)->
adju¡MaxAsûÁAndDesûÁ
(
maxAsûÁ
, 
maxDesûÁ
, 
maxPos™iÚTİ
, 
maxPos™iÚBÙtom
);

384 
v”tiÿlPos™iÚFÜBox
(
IÆšeBox
* 
cu¼
, 
boŞ
 
fœ¡Lše
)

386 ià(
	gcu¼
->
»nd””
()->
isText
())

387  
	gcu¼
->
·»Á
()->
y
();

388 ià(
	gcu¼
->
»nd””
()->
isBox
())

389  
toR’d”Box
(
cu¼
->
»nd””
())->
v”tiÿlPos™iÚ
(
fœ¡Lše
);

390  
toR’d”IÆše
(
cu¼
->
»nd””
())->
v”tiÿlPos™iÚFromCache
(
fœ¡Lše
);

393 
	gIÆšeFlowBox
::
compu‹LogiÿlBoxHeights
(& 
maxPos™iÚTİ
, & 
maxPos™iÚBÙtom
,

394 & 
maxAsûÁ
, & 
maxDesûÁ
, 
boŞ
 
¡riùMode
)

396 ià(
isRoÙIÆšeBox
()) {

398 
	gheight
 = 
lšeHeight
(
Œue
);

399 
	gba£lše
 = 
ba£lšePos™iÚ
(
Œue
);

400 ià(
hasTextChd»n
(è|| 
	g¡riùMode
) {

401 
	gasûÁ
 = 
ba£lše
;

402 
	gdesûÁ
 = 
height
 - 
asûÁ
;

403 ià(
	gmaxAsûÁ
 < 
	gasûÁ
)

404 
	gmaxAsûÁ
 = 
asûÁ
;

405 ià(
	gmaxDesûÁ
 < 
	gdesûÁ
)

406 
	gmaxDesûÁ
 = 
desûÁ
;

410 
IÆšeBox
* 
	gcu¼
 = 
fœ¡Chd
(); cu¼; cu¼ = 
cu¼
->
ÃxtOnLše
()) {

411 ià(
cu¼
->
»nd””
()->
isPos™iÚed
())

414 
boŞ
 
	gisIÆšeFlow
 = 
cu¼
->
isIÆšeFlowBox
();

416 
	glšeHeight
;

417 
	gba£lše
;

418 
	gVeùÜ
<cÚ¡ 
	gSim¶eFÚtD©a
*>* 
	gu£dFÚts
 = 0;

419 ià(
	gcu¼
->
isIÆšeTextBox
())

420 
	gu£dFÚts
 = 
¡©ic_ÿ¡
<
IÆšeTextBox
*>(
cu¼
)->
çÎbackFÚts
();

422 ià(
	gu£dFÚts
) {

423 
	gu£dFÚts
->
­³nd
(
cu¼
->
»nd””
()->
¡yË
(
m_fœ¡Lše
)->
fÚt
().
´im¬yFÚt
());

424 
L’gth
 
	g·»ÁLšeHeight
 = 
cu¼
->
»nd””
()->
·»Á
()->
¡yË
()->
lšeHeight
();

425 ià(
	g·»ÁLšeHeight
.
isNeg©ive
()) {

426 
	gba£lšeToBÙtom
 = 0;

427 
	gba£lše
 = 0;

428 
size_t
 
	gi
 = 0; i < 
	gu£dFÚts
->
size
(); ++i) {

429 
	gh®fL—dšg
 = (
u£dFÚts
->
©
(
i
)->
lšeS·cšg
(è- u£dFÚts->©(i)->
asûÁ
(è- u£dFÚts->©(i)->
desûÁ
()) / 2;

430 
	gba£lše
 = 
max
(
ba£lše
, 
h®fL—dšg
 + 
u£dFÚts
->
©
(
i
)->
asûÁ
());

431 
	gba£lšeToBÙtom
 = 
max
(
ba£lšeToBÙtom
, 
u£dFÚts
->
©
(
i
)->
lšeS·cšg
(è- u£dFÚts->©(i)->
asûÁ
(è- u£dFÚts->©(i)->
desûÁ
(è- 
h®fL—dšg
);

433 
	glšeHeight
 = 
ba£lše
 + 
ba£lšeToBÙtom
;

434 } ià(
	g·»ÁLšeHeight
.
isP”ûÁ
()) {

435 
	glšeHeight
 = 
·»ÁLšeHeight
.
ÿlcMšV®ue
(
cu¼
->
»nd””
()->
¡yË
()->
fÚtSize
());

436 
	gba£lše
 = 0;

437 
size_t
 
	gi
 = 0; i < 
	gu£dFÚts
->
size
(); ++i) {

438 
	gh®fL—dšg
 = (
lšeHeight
 - 
u£dFÚts
->
©
(
i
)->
asûÁ
(è- u£dFÚts->©(i)->
desûÁ
()) / 2;

439 
	gba£lše
 = 
max
(
ba£lše
, 
h®fL—dšg
 + 
u£dFÚts
->
©
(
i
)->
asûÁ
());

442 
	glšeHeight
 = 
·»ÁLšeHeight
.
v®ue
();

443 
	gba£lše
 = 0;

444 
size_t
 
	gi
 = 0; i < 
	gu£dFÚts
->
size
(); ++i) {

445 
	gh®fL—dšg
 = (
lšeHeight
 - 
u£dFÚts
->
©
(
i
)->
asûÁ
(è- u£dFÚts->©(i)->
desûÁ
()) / 2;

446 
	gba£lše
 = 
max
(
ba£lše
, 
h®fL—dšg
 + 
u£dFÚts
->
©
(
i
)->
asûÁ
());

450 
	glšeHeight
 = 
cu¼
->
lšeHeight
(
çl£
);

451 
	gba£lše
 = 
cu¼
->
ba£lšePos™iÚ
(
çl£
);

454 
	gcu¼
->
£tY
(
v”tiÿlPos™iÚFÜBox
(
cu¼
, 
m_fœ¡Lše
));

455 ià(
	gcu¼
->
y
(è=ğ
Pos™iÚTİ
) {

456 ià(
maxPos™iÚTİ
 < 
lšeHeight
)

457 
maxPos™iÚTİ
 = 
lšeHeight
;

458 } ià(
	gcu¼
->
y
(è=ğ
Pos™iÚBÙtom
) {

459 ià(
maxPos™iÚBÙtom
 < 
lšeHeight
)

460 
maxPos™iÚBÙtom
 = 
lšeHeight
;

461 } ià((!
	gisIÆšeFlow
 || 
	g¡©ic_ÿ¡
<
	gIÆšeFlowBox
*>(
	gcu¼
)->
hasTextChd»n
()è|| cu¼->
boxMod–Objeù
()->
hasHÜizÚlBÜd”sOrPaddšg
(è|| 
	g¡riùMode
) {

462 
	gasûÁ
 = 
ba£lše
 - 
cu¼
->
y
();

463 
	gdesûÁ
 = 
lšeHeight
 - 
asûÁ
;

464 ià(
	gmaxAsûÁ
 < 
	gasûÁ
)

465 
	gmaxAsûÁ
 = 
asûÁ
;

466 ià(
	gmaxDesûÁ
 < 
	gdesûÁ
)

467 
	gmaxDesûÁ
 = 
desûÁ
;

470 ià(
	gcu¼
->
isIÆšeFlowBox
())

471 
	g¡©ic_ÿ¡
<
	gIÆšeFlowBox
*>(
	gcu¼
)->
compu‹LogiÿlBoxHeights
(
maxPos™iÚTİ
, 
maxPos™iÚBÙtom
, 
maxAsûÁ
, 
maxDesûÁ
, 
¡riùMode
);

475 
	gIÆšeFlowBox
::
¶aûBoxesV”tiÿÎy
(
yPos
, 
maxHeight
, 
maxAsûÁ
, 
boŞ
 
¡riùMode
, & 
£ËùiÚTİ
, & 
£ËùiÚBÙtom
)

477 ià(
isRoÙIÆšeBox
())

478 
£tY
(
yPos
 + 
maxAsûÁ
 - 
ba£lšePos™iÚ
(
Œue
));

480 
IÆšeBox
* 
	gcu¼
 = 
fœ¡Chd
(); cu¼; cu¼ = 
cu¼
->
ÃxtOnLše
()) {

481 ià(
cu¼
->
»nd””
()->
isPos™iÚed
())

486 
boŞ
 
	gisIÆšeFlow
 = 
cu¼
->
isIÆšeFlowBox
();

487 ià(
	gisIÆšeFlow
)

488 
	g¡©ic_ÿ¡
<
	gIÆšeFlowBox
*>(
	gcu¼
)->
¶aûBoxesV”tiÿÎy
(
yPos
, 
maxHeight
, 
maxAsûÁ
, 
¡riùMode
, 
£ËùiÚTİ
, 
£ËùiÚBÙtom
);

490 
boŞ
 
	gchdAfãùsTİBÙtomPos
 = 
Œue
;

491 ià(
	gcu¼
->
y
(è=ğ
Pos™iÚTİ
)

492 
cu¼
->
£tY
(
yPos
);

493 ià(
	gcu¼
->
y
(è=ğ
Pos™iÚBÙtom
)

494 
cu¼
->
£tY
(
yPos
 + 
maxHeight
 - cu¼->
lšeHeight
(
çl£
));

496 ià((
	gisIÆšeFlow
 && !
	g¡©ic_ÿ¡
<
	gIÆšeFlowBox
*>(
	gcu¼
)->
hasTextChd»n
()è&& !cu¼->
boxMod–Objeù
()->
hasHÜizÚlBÜd”sOrPaddšg
(è&& !
	g¡riùMode
)

497 
	gchdAfãùsTİBÙtomPos
 = 
çl£
;

498 
	gposAdju¡
 = 
maxAsûÁ
 - 
cu¼
->
ba£lšePos™iÚ
(
çl£
);

499 
	gcu¼
->
£tY
(
cu¼
->
y
(è+ 
yPos
 + 
posAdju¡
);

502 
	gÃwY
 = 
cu¼
->
y
();

503 ià(
	gcu¼
->
isText
(è|| cu¼->
isIÆšeFlowBox
()) {

504 cÚ¡ 
	gFÚt
& 
	gfÚt
 = 
cu¼
->
»nd””
()->
¡yË
(
m_fœ¡Lše
)->
fÚt
();

505 
	gÃwY
 +ğ
cu¼
->
ba£lšePos™iÚ
(
çl£
è- 
fÚt
.
asûÁ
();

506 ià(
	gcu¼
->
isIÆšeFlowBox
())

507 
	gÃwY
 -ğ
cu¼
->
boxMod–Objeù
()->
bÜd”Tİ
(è+ cu¼->boxMod–Objeù()->
·ddšgTİ
();

508 } ià(!
	gcu¼
->
»nd””
()->
isBR
()) {

509 
R’d”Box
* 
	gbox
 = 
toR’d”Box
(
cu¼
->
»nd””
());

510 
	gÃwY
 +ğ
box
->
m¬gšTİ
();

513 
	gcu¼
->
£tY
(
ÃwY
);

515 ià(
	gchdAfãùsTİBÙtomPos
) {

516 
	gboxHeight
 = 
cu¼
->
height
();

517 
	g£ËùiÚTİ
 = 
mš
(
£ËùiÚTİ
, 
ÃwY
);

518 
	g£ËùiÚBÙtom
 = 
max
(
£ËùiÚBÙtom
, 
ÃwY
 + 
boxHeight
);

522 ià(
isRoÙIÆšeBox
()) {

523 cÚ¡ 
	gFÚt
& 
	gfÚt
 = 
»nd””
()->
¡yË
(
m_fœ¡Lše
)->
fÚt
();

524 
£tY
(
y
(è+ 
ba£lšePos™iÚ
(
Œue
è- 
fÚt
.
asûÁ
());

525 ià(
hasTextChd»n
(è|| 
	g¡riùMode
) {

526 
	g£ËùiÚTİ
 = 
mš
(
£ËùiÚTİ
, 
y
());

527 
	g£ËùiÚBÙtom
 = 
max
(
£ËùiÚBÙtom
, 
y
(è+ 
height
());

532 
	gIÆšeFlowBox
::
compu‹V”tiÿlOv”æow
(
lšeTİ
, 
lšeBÙtom
, 
boŞ
 
¡riùMode
)

534 
	gboxHeight
 = 
height
();

538 
	gtİOv”æow
 = 
max
(
y
(), 
lšeTİ
);

539 
	gbÙtomOv”æow
 = 
mš
(
y
(è+ 
boxHeight
, 
lšeBÙtom
);

541 
	gtİLayoutOv”æow
 = 
tİOv”æow
;

542 
	gbÙtomLayoutOv”æow
 = 
bÙtomOv”æow
;

544 
	gtİVisu®Ov”æow
 = 
tİOv”æow
;

545 
	gbÙtomVisu®Ov”æow
 = 
bÙtomOv”æow
;

548 ià(
·»Á
()) {

549 
	gboxShadowTİ
;

550 
	gboxShadowBÙtom
;

551 
»nd””
()->
¡yË
(
m_fœ¡Lše
)->
g‘BoxShadowV”tiÿlEx‹Á
(
boxShadowTİ
, 
boxShadowBÙtom
);

553 
	gtİVisu®Ov”æow
 = 
mš
(
y
(è+ 
boxShadowTİ
, 
tİVisu®Ov”æow
);

554 
	gbÙtomVisu®Ov”æow
 = 
max
(
y
(è+ 
boxHeight
 + 
boxShadowBÙtom
, 
bÙtomVisu®Ov”æow
);

557 
IÆšeBox
* 
	gcu¼
 = 
fœ¡Chd
(); cu¼; cu¼ = 
cu¼
->
ÃxtOnLše
()) {

558 ià(
cu¼
->
»nd””
()->
isPos™iÚed
())

561 ià(
	gcu¼
->
»nd””
()->
isText
()) {

562 
IÆšeTextBox
* 
	g‹xt
 = 
¡©ic_ÿ¡
<IÆšeTextBox*>(
cu¼
);

563 
R’d”Text
* 
	g¹
 = 
toR’d”Text
(
‹xt
->
»nd””
());

564 ià(
	g¹
->
isBR
())

567 
	g¡rokeOv”æow
 = 
¡©ic_ÿ¡
<>(
ûf
(
¹
->
¡yË
()->
‹xtSŒokeWidth
() / 2.0f));

569 
GlyphOv”æow
* 
	gglyphOv”æow
 = 
¡©ic_ÿ¡
<
IÆšeTextBox
*>(
cu¼
)->
glyphOv”æow
();

571 
	gtİGlyphOv”æow
 = -
¡rokeOv”æow
 - (
glyphOv”æow
 ? glyphOv”æow->
tİ
 : 0);

572 
	gbÙtomGlyphOv”æow
 = 
¡rokeOv”æow
 + (
glyphOv”æow
 ? glyphOv”æow->
bÙtom
 : 0);

574 
	gchdOv”æowTİ
 = 
tİGlyphOv”æow
;

575 
	gchdOv”æowBÙtom
 = 
bÙtomGlyphOv”æow
;

576 cÚ¡ 
ShadowD©a
* 
	gshadow
 = 
¹
->
¡yË
()->
‹xtShadow
(); shadow; shadow = 
shadow
->
Ãxt
()) {

577 
chdOv”æowTİ
 = 
mš
(chdOv”æowTİ, 
shadow
->
y
(è- shadow->
blur
(è+ 
tİGlyphOv”æow
);

578 
	gchdOv”æowBÙtom
 = 
max
(
chdOv”æowBÙtom
, 
shadow
->
y
(è+ shadow->
blur
(è+ 
bÙtomGlyphOv”æow
);

581 
	gtİVisu®Ov”æow
 = 
mš
(
cu¼
->
y
(è+ 
chdOv”æowTİ
, 
tİVisu®Ov”æow
);

582 
	gbÙtomVisu®Ov”æow
 = 
max
(
cu¼
->
y
(è+ 
‹xt
->
height
(è+ 
chdOv”æowBÙtom
, 
bÙtomVisu®Ov”æow
);

583 } ià(
	gcu¼
->
»nd””
()->
isR’d”IÆše
()) {

584 
IÆšeFlowBox
* 
	gæow
 = 
¡©ic_ÿ¡
<IÆšeFlowBox*>(
cu¼
);

585 
	gæow
->
compu‹V”tiÿlOv”æow
(
lšeTİ
, 
lšeBÙtom
, 
¡riùMode
);

586 
	gtİLayoutOv”æow
 = 
mš
(
tİLayoutOv”æow
, 
æow
->topLayoutOverflow());

587 
	gbÙtomLayoutOv”æow
 = 
max
(
bÙtomLayoutOv”æow
, 
æow
->bottomLayoutOverflow());

588 
	gtİVisu®Ov”æow
 = 
mš
(
tİVisu®Ov”æow
, 
æow
->topVisualOverflow());

589 
	gbÙtomVisu®Ov”æow
 = 
max
(
bÙtomVisu®Ov”æow
, 
æow
->bottomVisualOverflow());

590 } ià(!
	gcu¼
->
boxMod–Objeù
()->
hasS–fPaštšgLay”
()){

592 
R’d”Box
* 
	gbox
 = 
toR’d”Box
(
cu¼
->
»nd””
());

593 
	gboxY
 = 
cu¼
->
y
();

594 
	gchdTİOv”æow
 = 
box
->
hasOv”æowCl
(è? 0 : box->
tİLayoutOv”æow
();

595 
	gchdBÙtomOv”æow
 = 
box
->
hasOv”æowCl
(è? 
cu¼
->
height
(è: box->
bÙtomLayoutOv”æow
();

596 
	gtİLayoutOv”æow
 = 
mš
(
boxY
 + 
chdTİOv”æow
, 
tİLayoutOv”æow
);

597 
	gbÙtomLayoutOv”æow
 = 
max
(
boxY
 + 
chdBÙtomOv”æow
, 
bÙtomLayoutOv”æow
);

598 
	gtİVisu®Ov”æow
 = 
mš
(
boxY
 + 
box
->
tİVisu®Ov”æow
(),opVisualOverflow);

599 
	gbÙtomVisu®Ov”æow
 = 
max
(
boxY
 + 
box
->
bÙtomVisu®Ov”æow
(), bottomVisualOverflow);

603 
£tV”tiÿlOv”æowPos™iÚs
(
tİLayoutOv”æow
, 
bÙtomLayoutOv”æow
, 
tİVisu®Ov”æow
, 
bÙtomVisu®Ov”æow
, 
boxHeight
);

606 
boŞ
 
	gIÆšeFlowBox
::
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
& 
»que¡
, 
H™Te¡ResuÉ
& 
»suÉ
, 
x
, 
y
, 
tx
, 
ty
)

608 
IÁReù
 
ov”æowReù
(
visibËOv”æowReù
());

609 
	gov”æowReù
.
move
(
tx
, 
ty
);

610 ià(!
	gov”æowReù
.
cÚšs
(
x
, 
y
))

611  
	gçl£
;

614 
IÆšeBox
* 
	gcu¼
 = 
Ï¡Chd
(); cu¼; cu¼ = 
cu¼
->
´evOnLše
()) {

615 ià((
cu¼
->
»nd””
()->
isText
(è|| !cu¼->
boxMod–Objeù
()->
hasS–fPaštšgLay”
()è&& cu¼->
nodeAtPošt
(
»que¡
, 
»suÉ
, 
x
, 
y
, 
tx
, 
ty
)) {

616 
»nd””
()->
upd©eH™Te¡ResuÉ
(
»suÉ
, 
IÁPošt
(
x
 - 
tx
, 
y
 - 
ty
));

617  
	gŒue
;

622 
IÁReù
 
»ù
(
tx
 + 
m_x
, 
ty
 + 
m_y
, 
m_width
, 
height
());

623 ià(
visibËToH™Te¡šg
(è&& 
	g»ù
.
cÚšs
(
x
, 
y
)) {

624 
»nd””
()->
upd©eH™Te¡ResuÉ
(
»suÉ
, 
IÁPošt
(
x
 - 
tx
, 
y
 - 
ty
));

625  
	gŒue
;

628  
	gçl£
;

631 
	gIÆšeFlowBox
::
·št
(
R’d”Objeù
::
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

633 
IÁReù
 
ov”æowReù
(
visibËOv”æowReù
());

634 
	gov”æowReù
.
šæ©e
(
»nd””
()->
maxim®OušeSize
(
·štInfo
.
pha£
));

635 
	gov”æowReù
.
move
(
tx
, 
ty
);

637 ià(!
	g·štInfo
.
	g»ù
.
š‹r£ùs
(
ov”æowReù
))

640 ià(
	g·štInfo
.
	gpha£
 !ğ
PaštPha£ChdOušes
) {

641 ià(
·štInfo
.
pha£
 =ğ
PaštPha£Ouše
 ||…aštInfo.pha£ =ğ
PaštPha£S–fOuše
) {

644 ià(
»nd””
()->
¡yË
()->
visib™y
(è=ğ
VISIBLE
 &&„’d””()->
hasOuše
(è&& !
isRoÙIÆšeBox
()) {

645 
R’d”IÆše
* 
šlšeFlow
 = 
toR’d”IÆše
(
»nd””
());

646 ià((
	gšlšeFlow
->
cÚtšu©iÚ
(è|| iÆšeFlow->
isIÆšeCÚtšu©iÚ
()è&& !
boxMod–Objeù
()->
hasS–fPaštšgLay”
()) {

649 
R’d”Block
* 
	gblock
 = 
»nd””
()->
cÚššgBlock
()->containingBlock();

650 
	gblock
->
addCÚtšu©iÚW™hOuše
(
toR’d”IÆše
(
»nd””
()->
node
()->renderer()));

651 } ià(!
	gšlšeFlow
->
isIÆšeCÚtšu©iÚ
())

652 
	g·štInfo
.
	goušeObjeùs
->
add
(
šlšeFlow
);

654 } ià(
	g·štInfo
.
	gpha£
 =ğ
PaštPha£Mask
) {

655 
·štMask
(
·štInfo
, 
tx
, 
ty
);

659 
·štBoxDecÜ©iÚs
(
·štInfo
, 
tx
, 
ty
);

662 
·štTextDecÜ©iÚs
(
·štInfo
, 
tx
, 
ty
, 
çl£
);

666 ià(
	g·štInfo
.
	gpha£
 =ğ
PaštPha£Mask
)

669 
PaštPha£
 
	g·štPha£
 = 
·štInfo
.
pha£
 =ğ
PaštPha£ChdOušes
 ? 
PaštPha£Ouše
 :…aintInfo.phase;

670 
	gR’d”Objeù
::
PaštInfo
 
chdInfo
(
·štInfo
);

671 
	gchdInfo
.
	gpha£
 = 
·štPha£
;

672 
	gchdInfo
.
	g·štšgRoÙ
 = 
»nd””
()->
·štšgRoÙFÜChd»n
(
·štInfo
);

675 ià(
	g·štPha£
 !ğ
PaštPha£S–fOuše
) {

676 
IÆšeBox
* 
cu¼
 = 
fœ¡Chd
(); 
	gcu¼
; cu¼ = cu¼->
ÃxtOnLše
()) {

677 ià(
cu¼
->
»nd””
()->
isText
(è|| !cu¼->
boxMod–Objeù
()->
hasS–fPaštšgLay”
())

678 
cu¼
->
·št
(
chdInfo
, 
tx
, 
ty
);

683 ià(
	g·štInfo
.
	gpha£
 =ğ
PaštPha£FÜeground
 || 
·štInfo
.
pha£
 =ğ
PaštPha£S–eùiÚ
)

684 
·štTextDecÜ©iÚs
(
·štInfo
, 
tx
, 
ty
, 
Œue
);

687 
	gIÆšeFlowBox
::
·štFlLay”s
(cÚ¡ 
R’d”Objeù
::
PaštInfo
& 
·štInfo
, cÚ¡ 
CŞÜ
& 
c
, cÚ¡ 
FlLay”
* 
flLay”
, 
_tx
, 
_ty
, 
w
, 
h
, 
Compos™eO³¿tÜ
 
İ
)

689 ià(!
	gflLay”
)

691 
·štFlLay”s
(
·štInfo
, 
c
, 
flLay”
->
Ãxt
(), 
_tx
, 
_ty
, 
w
, 
h
, 
İ
);

692 
·štFlLay”
(
·štInfo
, 
c
, 
flLay”
, 
_tx
, 
_ty
, 
w
, 
h
, 
İ
);

695 
	gIÆšeFlowBox
::
·štFlLay”
(cÚ¡ 
R’d”Objeù
::
PaštInfo
& 
·štInfo
, cÚ¡ 
CŞÜ
& 
c
, cÚ¡ 
FlLay”
* 
flLay”
, 
tx
, 
ty
, 
w
, 
h
, 
Compos™eO³¿tÜ
 
İ
)

697 
StyËImage
* 
	gimg
 = 
flLay”
->
image
();

698 
boŞ
 
	ghasFlImage
 = 
img
 && img->
ÿnR’d”
(
»nd””
()->
¡yË
()->
efãùiveZoom
());

699 ià((!
	ghasFlImage
 && !
»nd””
()->
¡yË
()->
hasBÜd”Radius
()è|| (!
´evLšeBox
(è&& !
ÃxtLšeBox
()è|| !
·»Á
())

700 
boxMod–Objeù
()->
·štFlLay”Ex‹nded
(
·štInfo
, 
c
, 
flLay”
, 
tx
, 
ty
, 
w
, 
h
, 
this
, 
İ
);

710 
	gxOff£tOnLše
 = 0;

711 
IÆšeFlowBox
* 
	gcu¼
 = 
´evLšeBox
(); cu¼; cu¼ = 
cu¼
->prevLineBox())

712 
xOff£tOnLše
 +ğ
cu¼
->
width
();

713 
	g¡¬tX
 = 
tx
 - 
xOff£tOnLše
;

714 
	gtÙ®Width
 = 
xOff£tOnLše
;

715 
IÆšeFlowBox
* 
	gcu¼
 = 
this
; cu¼; cu¼ = 
cu¼
->
ÃxtLšeBox
())

716 
tÙ®Width
 +ğ
cu¼
->
width
();

717 
	g·štInfo
.
	gcÚ‹xt
->
§ve
();

718 
	g·štInfo
.
	gcÚ‹xt
->
ş
(
IÁReù
(
tx
, 
ty
, 
width
(), 
height
()));

719 
boxMod–Objeù
()->
·štFlLay”Ex‹nded
(
·štInfo
, 
c
, 
flLay”
, 
¡¬tX
, 
ty
, 
tÙ®Width
, 
h
, 
this
, 
İ
);

720 
	g·štInfo
.
	gcÚ‹xt
->
»¡Üe
();

724 
	gIÆšeFlowBox
::
·štBoxShadow
(
G¿phicsCÚ‹xt
* 
cÚ‹xt
, 
R’d”StyË
* 
s
, 
ShadowStyË
 
shadowStyË
, 
tx
, 
ty
, 
w
, 
h
)

726 ià((!
´evLšeBox
(è&& !
ÃxtLšeBox
()è|| !
·»Á
())

727 
boxMod–Objeù
()->
·štBoxShadow
(
cÚ‹xt
, 
tx
, 
ty
, 
w
, 
h
, 
s
, 
shadowStyË
);

731 
boxMod–Objeù
()->
·štBoxShadow
(
cÚ‹xt
, 
tx
, 
ty
, 
w
, 
h
, 
s
, 
shadowStyË
, 
šşudeLeáEdge
(), 
šşudeRightEdge
());

735 
	gIÆšeFlowBox
::
·štBoxDecÜ©iÚs
(
R’d”Objeù
::
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

738 ià(!
»nd””
()->
shouldPaštW™hšRoÙ
(
·štInfo
è||„’d””()->
¡yË
()->
visib™y
(è!ğ
VISIBLE
 ||…aštInfo.
pha£
 !ğ
PaštPha£FÜeground
)

741 
	gx
 = 
m_x
;

742 
	gy
 = 
m_y
;

743 
	gw
 = 
width
();

744 
	gh
 = 
height
();

747 
boŞ
 
	g¡riùMode
 = 
»nd””
()->
docum’t
()->
šSŒiùMode
();

748 ià(!
hasTextChd»n
(è&& !
	g¡riùMode
) {

749 
RoÙIÆšeBox
* 
	groÙBox
 = 
roÙ
();

750 
	gbÙtom
 = 
mš
(
roÙBox
->
lšeBÙtom
(), 
y
 + 
h
);

751 
	gy
 = 
max
(
roÙBox
->
lšeTİ
(), 
y
);

752 
	gh
 = 
bÙtom
 - 
y
;

756 
	gtx
 +ğ
x
;

757 
	gty
 +ğ
y
;

759 
G¿phicsCÚ‹xt
* 
	gcÚ‹xt
 = 
·štInfo
.
cÚ‹xt
;

763 
R’d”StyË
* 
	g¡yËToU£
 = 
»nd””
()->
¡yË
(
m_fœ¡Lše
);

764 ià((!
·»Á
(è&& 
	gm_fœ¡Lše
 && 
	g¡yËToU£
 !ğ
»nd””
()->
¡yË
()è|| (·»Á(è&&„’d””()->
hasBoxDecÜ©iÚs
())) {

766 ià(
¡yËToU£
->
boxShadow
())

767 
·štBoxShadow
(
cÚ‹xt
, 
¡yËToU£
, 
NÜm®
, 
tx
, 
ty
, 
w
, 
h
);

769 
CŞÜ
 
	gc
 = 
¡yËToU£
->
vis™edD•’d’tCŞÜ
(
CSSPrİ”tyBackgroundCŞÜ
);

770 
·štFlLay”s
(
·štInfo
, 
c
, 
¡yËToU£
->
backgroundLay”s
(), 
tx
, 
ty
, 
w
, 
h
);

772 ià(
	g¡yËToU£
->
boxShadow
())

773 
·štBoxShadow
(
cÚ‹xt
, 
¡yËToU£
, 
In£t
, 
tx
, 
ty
, 
w
, 
h
);

777 ià(
·»Á
(è&& 
»nd””
()->
¡yË
()->
hasBÜd”
()) {

778 
StyËImage
* 
	gbÜd”Image
 = 
»nd””
()->
¡yË
()->
bÜd”Image
().
image
();

779 
boŞ
 
	ghasBÜd”Image
 = 
bÜd”Image
 && bÜd”Image->
ÿnR’d”
(
¡yËToU£
->
efãùiveZoom
());

780 ià(
	ghasBÜd”Image
 && !
	gbÜd”Image
->
isLßded
())

785 ià(!
	ghasBÜd”Image
 || (!
´evLšeBox
(è&& !
ÃxtLšeBox
()))

786 
boxMod–Objeù
()->
·štBÜd”
(
cÚ‹xt
, 
tx
, 
ty
, 
w
, 
h
, 
»nd””
()->
¡yË
(), 
šşudeLeáEdge
(), 
šşudeRightEdge
());

796 
	gxOff£tOnLše
 = 0;

797 
IÆšeFlowBox
* 
	gcu¼
 = 
´evLšeBox
(); cu¼; cu¼ = 
cu¼
->prevLineBox())

798 
xOff£tOnLše
 +ğ
cu¼
->
width
();

799 
	g¡¬tX
 = 
tx
 - 
xOff£tOnLše
;

800 
	gtÙ®Width
 = 
xOff£tOnLše
;

801 
IÆšeFlowBox
* 
	gcu¼
 = 
this
; cu¼; cu¼ = 
cu¼
->
ÃxtLšeBox
())

802 
tÙ®Width
 +ğ
cu¼
->
width
();

803 
	gcÚ‹xt
->
§ve
();

804 
	gcÚ‹xt
->
ş
(
IÁReù
(
tx
, 
ty
, 
w
, 
h
));

805 
boxMod–Objeù
()->
·štBÜd”
(
cÚ‹xt
, 
¡¬tX
, 
ty
, 
tÙ®Width
, 
h
, 
»nd””
()->
¡yË
());

806 
	gcÚ‹xt
->
»¡Üe
();

812 
	gIÆšeFlowBox
::
·štMask
(
R’d”Objeù
::
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

814 ià(!
»nd””
()->
shouldPaštW™hšRoÙ
(
·štInfo
è||„’d””()->
¡yË
()->
visib™y
(è!ğ
VISIBLE
 ||…aštInfo.
pha£
 !ğ
PaštPha£Mask
)

817 
	gx
 = 
m_x
;

818 
	gy
 = 
m_y
;

819 
	gw
 = 
width
();

820 
	gh
 = 
height
();

823 
boŞ
 
	g¡riùMode
 = 
»nd””
()->
docum’t
()->
šSŒiùMode
();

824 ià(!
hasTextChd»n
(è&& !
	g¡riùMode
) {

825 
RoÙIÆšeBox
* 
	groÙBox
 = 
roÙ
();

826 
	gbÙtom
 = 
mš
(
roÙBox
->
lšeBÙtom
(), 
y
 + 
h
);

827 
	gy
 = 
max
(
roÙBox
->
lšeTİ
(), 
y
);

828 
	gh
 = 
bÙtom
 - 
y
;

832 
	gtx
 +ğ
x
;

833 
	gty
 +ğ
y
;

835 cÚ¡ 
	gNšeP›ûImage
& 
	gmaskNšeP›ûImage
 = 
»nd””
()->
¡yË
()->
maskBoxImage
();

836 
StyËImage
* 
	gmaskBoxImage
 = 
»nd””
()->
¡yË
()->
maskBoxImage
().
image
();

839 
boŞ
 
	gpushT¿n¥¬’cyLay”
 = 
çl£
;

840 
boŞ
 
	gcompos™edMask
 = 
»nd””
()->
hasLay”
(è&& 
boxMod–Objeù
()->
Ïy”
()->
hasCompos™edMask
();

841 
Compos™eO³¿tÜ
 
	gcompos™eOp
 = 
Compos™eSourûOv”
;

842 ià(!
	gcompos™edMask
) {

843 ià((
	gmaskBoxImage
 && 
»nd””
()->
¡yË
()->
maskLay”s
()->
hasImage
()è||„’d””()->¡yË()->maskLay”s()->
Ãxt
())

844 
	gpushT¿n¥¬’cyLay”
 = 
Œue
;

846 
	gcompos™eOp
 = 
Compos™eDe¡š©iÚIn
;

847 ià(
	gpushT¿n¥¬’cyLay”
) {

848 
	g·štInfo
.
	gcÚ‹xt
->
£tCompos™eO³¿tiÚ
(
Compos™eDe¡š©iÚIn
);

849 
	g·štInfo
.
	gcÚ‹xt
->
begšT¿n¥¬’cyLay”
(1.0f);

850 
	gcompos™eOp
 = 
Compos™eSourûOv”
;

854 
·štFlLay”s
(
·štInfo
, 
CŞÜ
(), 
»nd””
()->
¡yË
()->
maskLay”s
(), 
tx
, 
ty
, 
w
, 
h
, 
compos™eOp
);

856 
boŞ
 
	ghasBoxImage
 = 
maskBoxImage
 && maskBoxImage->
ÿnR’d”
(
»nd””
()->
¡yË
()->
efãùiveZoom
());

857 ià(!
	ghasBoxImage
 || !
	gmaskBoxImage
->
isLßded
())

862 ià(!
´evLšeBox
(è&& !
ÃxtLšeBox
()) {

863 
boxMod–Objeù
()->
·štNšeP›ûImage
(
·štInfo
.
cÚ‹xt
, 
tx
, 
ty
, 
w
, 
h
, 
»nd””
()->
¡yË
(), 
maskNšeP›ûImage
, 
compos™eOp
);

867 
	gxOff£tOnLše
 = 0;

868 
IÆšeFlowBox
* 
	gcu¼
 = 
´evLšeBox
(); cu¼; cu¼ = 
cu¼
->prevLineBox())

869 
xOff£tOnLše
 +ğ
cu¼
->
width
();

870 
	g¡¬tX
 = 
tx
 - 
xOff£tOnLše
;

871 
	gtÙ®Width
 = 
xOff£tOnLše
;

872 
IÆšeFlowBox
* 
	gcu¼
 = 
this
; cu¼; cu¼ = 
cu¼
->
ÃxtLšeBox
())

873 
tÙ®Width
 +ğ
cu¼
->
width
();

874 
	g·štInfo
.
	gcÚ‹xt
->
§ve
();

875 
	g·štInfo
.
	gcÚ‹xt
->
ş
(
IÁReù
(
tx
, 
ty
, 
w
, 
h
));

876 
boxMod–Objeù
()->
·štNšeP›ûImage
(
·štInfo
.
cÚ‹xt
, 
¡¬tX
, 
ty
, 
tÙ®Width
, 
h
, 
»nd””
()->
¡yË
(), 
maskNšeP›ûImage
, 
compos™eOp
);

877 
	g·štInfo
.
	gcÚ‹xt
->
»¡Üe
();

880 ià(
	gpushT¿n¥¬’cyLay”
)

881 
	g·štInfo
.
	gcÚ‹xt
->
’dT¿n¥¬’cyLay”
();

884 
boŞ
 
shouldD¿wTextDecÜ©iÚ
(
R’d”Objeù
* 
obj
)

886 
R’d”Objeù
* 
	gcu¼
 = 
obj
->
fœ¡Chd
(); cu¼; cu¼ = 
cu¼
->
ÃxtSiblšg
()) {

887 ià(
cu¼
->
isR’d”IÆše
())

888  
Œue
;

889 ià(
	gcu¼
->
isText
(è&& !cu¼->
isBR
()) {

890 ià(!
	gcu¼
->
¡yË
()->
cŞÏp£Wh™eS·û
())

891  
	gŒue
;

892 
Node
* 
	gcu¼EËm’t
 = 
cu¼
->
node
();

893 ià(!
	gcu¼EËm’t
)

894  
	gŒue
;

895 ià(!
	gcu¼EËm’t
->
isTextNode
())

896  
	gŒue
;

897 ià(!
	g¡©ic_ÿ¡
<
	gText
*>(
	gcu¼EËm’t
)->
cÚšsOÆyWh™e¥aû
())

898  
	gŒue
;

901  
	gçl£
;

904 
	gIÆšeFlowBox
::
·štTextDecÜ©iÚs
(
R’d”Objeù
::
PaštInfo
& 
·štInfo
, 
tx
, 
ty
, 
boŞ
 
·š‹dChd»n
)

908 ià(
»nd””
()->
¡yË
()->
htmlHacks
(è|| !»nd””()->
shouldPaštW™hšRoÙ
(
·štInfo
) ||

909 
»nd””
()->
¡yË
()->
visib™y
(è!ğ
VISIBLE
)

913 ià(
	g·štInfo
.
	gpha£
 =ğ
PaštPha£S–eùiÚ
 && 
·štInfo
.
fÜûBÏckText
)

916 
G¿phicsCÚ‹xt
* 
	gcÚ‹xt
 = 
·štInfo
.
cÚ‹xt
;

917 
	gtx
 +ğ
m_x
;

918 
	gty
 +ğ
m_y
;

919 
R’d”StyË
* 
	g¡yËToU£
 = 
»nd””
()->
¡yË
(
m_fœ¡Lše
);

920 
	gdeco
 = 
·»Á
(è? 
¡yËToU£
->
‹xtDecÜ©iÚ
(è: styËToU£->
‹xtDecÜ©iÚsInEfãù
();

921 ià(
	gdeco
 !ğ
TDNONE
 &&

922 ((!
·š‹dChd»n
 && ((
deco
 & 
UNDERLINE
è|| (decØ& 
OVERLINE
))è|| (·š‹dChd»À&& (decØ& 
LINE_THROUGH
))) &&

923 
shouldD¿wTextDecÜ©iÚ
(
»nd””
())) {

924 
x
 = 
m_x
 + 
bÜd”Leá
(è+ 
·ddšgLeá
();

925 
	gw
 = 
m_width
 - (
bÜd”Leá
(è+ 
·ddšgLeá
(è+ 
bÜd”Right
(è+ 
·ddšgRight
());

926 
RoÙIÆšeBox
* 
	groÙLše
 = 
roÙ
();

927 ià(
	groÙLše
->
–lsisBox
()) {

928 
	g–lsisX
 = 
m_x
 + 
roÙLše
->
–lsisBox
()->
x
();

929 
	g–lsisWidth
 = 
roÙLše
->
–lsisBox
()->
width
();

930 
boŞ
 
	gÉr
 = 
»nd””
()->
¡yË
()->
dœeùiÚ
(è=ğ
LTR
;

931 ià(
	groÙLše
 =ğ
this
) {

935 
boŞ
 
ÉrTrunÿtiÚ
 = 
Ér
 && (
x
 + 
w
 >ğ
–lsisX
 + 
–lsisWidth
);

936 
boŞ
 
	g¹lTrunÿtiÚ
 = !
Ér
 && (
x
 <ğ
–lsisX
 + 
–lsisWidth
);

937 ià(
	gÉrTrunÿtiÚ
)

938 
	gw
 -ğ(
x
 + 
w
è- (
–lsisX
 + 
–lsisWidth
);

939 ià(
	g¹lTrunÿtiÚ
) {

940 
	gdx
 = 
m_x
 - ((
–lsisX
 - m_xè+ 
–lsisWidth
);

941 
	gtx
 -ğ
dx
;

942 
	gw
 +ğ
dx
;

945 
boŞ
 
	gÉrPa¡EÎsis
 = 
Ér
 && 
x
 >ğ
–lsisX
;

946 
boŞ
 
	g¹lPa¡EÎsis
 = !
Ér
 && (
x
 + 
w
è<ğ(
–lsisX
 + 
–lsisWidth
);

947 ià(
	gÉrPa¡EÎsis
 || 
	g¹lPa¡EÎsis
)

950 
boŞ
 
	gÉrTrunÿtiÚ
 = 
Ér
 && 
x
 + 
w
 >ğ
–lsisX
;

951 
boŞ
 
	g¹lTrunÿtiÚ
 = !
Ér
 && 
x
 <ğ
–lsisX
;

952 ià(
	gÉrTrunÿtiÚ
)

953 
	gw
 -ğ(
x
 + 
w
 - 
–lsisX
);

954 ià(
	g¹lTrunÿtiÚ
) {

955 
	gdx
 = 
m_x
 - ((
–lsisX
 - m_xè+ 
–lsisWidth
);

956 
	gtx
 -ğ
dx
;

957 
	gw
 +ğ
dx
;

963 
	gtx
 +ğ
bÜd”Leá
(è+ 
·ddšgLeá
();

965 
CŞÜ
 
	gund”lše
, 
	gov”lše
, 
	glš‘hrough
;

966 
	gund”lše
 = 
ov”lše
 = 
lš‘hrough
 = 
¡yËToU£
->
vis™edD•’d’tCŞÜ
(
CSSPrİ”tyCŞÜ
);

967 ià(!
·»Á
())

968 
»nd””
()->
g‘TextDecÜ©iÚCŞÜs
(
deco
, 
und”lše
, 
ov”lše
, 
lš‘hrough
);

970 
boŞ
 
	gisPrštšg
 = 
»nd””
()->
docum’t
()->
´štšg
();

971 
	gcÚ‹xt
->
£tSŒokeThickÃss
(1.0f);

973 
boŞ
 
	g·štUnd”lše
 = 
deco
 & 
UNDERLINE
 && !
·š‹dChd»n
;

974 
boŞ
 
	g·štOv”lše
 = 
deco
 & 
OVERLINE
 && !
·š‹dChd»n
;

975 
boŞ
 
	g·štLšeThrough
 = 
deco
 & 
LINE_THROUGH
 && 
·š‹dChd»n
;

977 
boŞ
 
	glšesA»O·que
 = !
isPrštšg
 && (!
·štUnd”lše
 || 
und”lše
.
®pha
(è=ğ255è&& (!
·štOv”lše
 || 
ov”lše
.®pha(è=ğ255è&& (!
·štLšeThrough
 || 
lš‘hrough
.alpha() == 255);

979 
	gba£lšePos
 = 
»nd””
()->
¡yË
(
m_fœ¡Lše
)->
fÚt
().
asûÁ
();

980 ià(!
isRoÙIÆšeBox
())

981 
	gba£lšePos
 +ğ
bÜd”Tİ
(è+ 
·ddšgTİ
();

983 
boŞ
 
	g£tCl
 = 
çl£
;

984 
	gexŒaOff£t
 = 0;

985 cÚ¡ 
ShadowD©a
* 
	gshadow
 = 
¡yËToU£
->
‹xtShadow
();

986 ià(!
	glšesA»O·que
 && 
	gshadow
 && shadow->
Ãxt
()) {

987 
IÁReù
 
şReù
(
tx
, 
ty
, 
w
, 
ba£lšePos
 + 2);

988 cÚ¡ 
ShadowD©a
* 
	gs
 = 
shadow
; s; s = 
s
->
Ãxt
()) {

989 
IÁReù
 
shadowReù
(
tx
, 
ty
, 
w
, 
ba£lšePos
 + 2);

990 
	gshadowReù
.
šæ©e
(
s
->
blur
());

991 
	gshadowReù
.
move
(
s
->
x
(), s->
y
());

992 
	gşReù
.
un™e
(
shadowReù
);

993 
	gexŒaOff£t
 = 
max
(
exŒaOff£t
, max(0, 
s
->
y
()è+ s->
blur
());

995 
	gcÚ‹xt
->
§ve
();

996 
	gcÚ‹xt
->
ş
(
şReù
);

997 
	gexŒaOff£t
 +ğ
ba£lšePos
 + 2;

998 
	gty
 +ğ
exŒaOff£t
;

999 
	g£tCl
 = 
Œue
;

1002 
CŞÜS·û
 
	gcŞÜS·û
 = 
»nd””
()->
¡yË
()->
cŞÜS·û
();

1003 
boŞ
 
	g£tShadow
 = 
çl£
;

1005 ià(
	gshadow
) {

1006 ià(!
	gshadow
->
Ãxt
()) {

1008 
	gty
 -ğ
exŒaOff£t
;

1009 
	gexŒaOff£t
 = 0;

1011 
	gcÚ‹xt
->
£tShadow
(
IÁSize
(
shadow
->
x
(), shadow->
y
(è- 
exŒaOff£t
), shadow->
blur
(), shadow->
cŞÜ
(), 
cŞÜS·û
);

1012 
	g£tShadow
 = 
Œue
;

1013 
	gshadow
 = 
shadow
->
Ãxt
();

1016 ià(
	g·štUnd”lše
) {

1017 
	gcÚ‹xt
->
£tSŒokeCŞÜ
(
und”lše
, 
cŞÜS·û
);

1018 
	gcÚ‹xt
->
£tSŒokeStyË
(
SŞidSŒoke
);

1020 
	gcÚ‹xt
->
d¿wLšeFÜText
(
IÁPošt
(
tx
, 
ty
 + 
ba£lšePos
 + 1), 
w
, 
isPrštšg
);

1022 ià(
	g·štOv”lše
) {

1023 
	gcÚ‹xt
->
£tSŒokeCŞÜ
(
ov”lše
, 
cŞÜS·û
);

1024 
	gcÚ‹xt
->
£tSŒokeStyË
(
SŞidSŒoke
);

1025 
	gcÚ‹xt
->
d¿wLšeFÜText
(
IÁPošt
(
tx
, 
ty
), 
w
, 
isPrštšg
);

1027 ià(
	g·štLšeThrough
) {

1028 
	gcÚ‹xt
->
£tSŒokeCŞÜ
(
lš‘hrough
, 
cŞÜS·û
);

1029 
	gcÚ‹xt
->
£tSŒokeStyË
(
SŞidSŒoke
);

1030 
	gcÚ‹xt
->
d¿wLšeFÜText
(
IÁPošt
(
tx
, 
ty
 + 2 * 
ba£lšePos
 / 3), 
w
, 
isPrštšg
);

1032 } 
	gshadow
);

1034 ià(
	g£tCl
)

1035 
	gcÚ‹xt
->
»¡Üe
();

1036 ià(
	g£tShadow
)

1037 
	gcÚ‹xt
->
ş—rShadow
();

1041 
IÆšeBox
* 
	gIÆšeFlowBox
::
fœ¡L—fChd
() const

1043 
IÆšeBox
* 
Ëaf
 = 0;

1044 
IÆšeBox
* 
	gchd
 = 
fœ¡Chd
(); chd && !
	gËaf
; chd = 
chd
->
ÃxtOnLše
())

1045 
Ëaf
 = 
chd
->
isL—f
(è? chd : 
¡©ic_ÿ¡
<
IÆšeFlowBox
*>(chd)->
fœ¡L—fChd
();

1046  
	gËaf
;

1049 
IÆšeBox
* 
	gIÆšeFlowBox
::
Ï¡L—fChd
() const

1051 
IÆšeBox
* 
Ëaf
 = 0;

1052 
IÆšeBox
* 
	gchd
 = 
Ï¡Chd
(); chd && !
	gËaf
; chd = 
chd
->
´evOnLše
())

1053 
Ëaf
 = 
chd
->
isL—f
(è? chd : 
¡©ic_ÿ¡
<
IÆšeFlowBox
*>(chd)->
Ï¡L—fChd
();

1054  
	gËaf
;

1057 
	gR’d”Objeù
::
S–eùiÚS‹
 
IÆšeFlowBox
::
£ËùiÚS‹
()

1059  
R’d”Objeù
::
S–eùiÚNÚe
;

1062 
boŞ
 
	gIÆšeFlowBox
::
ÿnAccommod©eEÎsis
(boŞ 
Ér
, 
blockEdge
, 
–lsisWidth
)

1064 
IÆšeBox
 *
	gbox
 = 
fœ¡Chd
(); box; box = 
box
->
ÃxtOnLše
()) {

1065 ià(!
box
->
ÿnAccommod©eEÎsis
(
Ér
, 
blockEdge
, 
–lsisWidth
))

1066  
çl£
;

1068  
	gŒue
;

1071 
	gIÆšeFlowBox
::
¶aûEÎsisBox
(
boŞ
 
Ér
, 
blockLeáEdge
, 
blockRightEdge
, 
–lsisWidth
, boŞ& 
foundBox
)

1073 
	g»suÉ
 = -1;

1078 
IÆšeBox
 *
	gbox
 = 
Ér
 ? 
fœ¡Chd
(è: 
Ï¡Chd
();

1081 
	gvisibËLeáEdge
 = 
blockLeáEdge
;

1082 
	gvisibËRightEdge
 = 
blockRightEdge
;

1084 
	gbox
) {

1085 
	gcu¼ResuÉ
 = 
box
->
¶aûEÎsisBox
(
Ér
, 
visibËLeáEdge
, 
visibËRightEdge
, 
–lsisWidth
, 
foundBox
);

1086 ià(
	gcu¼ResuÉ
 !ğ-1 && 
»suÉ
 == -1)

1087 
»suÉ
 = 
cu¼ResuÉ
;

1089 ià(
	gÉr
) {

1090 
	gvisibËLeáEdge
 +ğ
box
->
width
();

1091 
	gbox
 = 
box
->
ÃxtOnLše
();

1094 
	gvisibËRightEdge
 -ğ
box
->
width
();

1095 
	gbox
 = 
box
->
´evOnLše
();

1098  
	g»suÉ
;

1101 
	gIÆšeFlowBox
::
ş—rTrunÿtiÚ
()

1103 
IÆšeBox
 *
box
 = 
fœ¡Chd
(); 
	gbox
; box = box->
ÃxtOnLše
())

1104 
box
->
ş—rTrunÿtiÚ
();

1107 #iâdeà
NDEBUG


1109 
	gIÆšeFlowBox
::
checkCÚsi¡’cy
() const

1111 #ifdeà
CHECK_CONSISTENCY


1112 
ASSERT
(!
m_hasBadChdLi¡
);

1113 cÚ¡ 
IÆšeBox
* 
	g´ev
 = 0;

1114 cÚ¡ 
IÆšeBox
* 
	gchd
 = 
m_fœ¡Chd
; chd; chd = 
chd
->
ÃxtOnLše
()) {

1115 
ASSERT
(
chd
->
·»Á
(è=ğ
this
);

1116 
ASSERT
(
chd
->
´evOnLše
(è=ğ
´ev
);

1117 
	g´ev
 = 
chd
;

1119 
ASSERT
(
´ev
 =ğ
m_Ï¡Chd
);

	@InlineFlowBox.h

21 #iâdeà
IÆšeFlowBox_h


22 
	#IÆšeFlowBox_h


	)

24 
	~"IÆšeBox.h
"

25 
	~"R’d”Ov”æow.h
"

27 
Çme¥aû
 
	gWebCÜe
 {

29 
şass
 
	gH™Te¡Reque¡
;

30 
şass
 
	gH™Te¡ResuÉ
;

31 
şass
 
	gR’d”LšeBoxLi¡
;

33 şas 
	cIÆšeFlowBox
 : 
public
 
IÆšeBox
 {

34 
public
:

35 
IÆšeFlowBox
(
R’d”Objeù
* 
obj
)

36 : 
IÆšeBox
(
obj
)

37 , 
m_fœ¡Chd
(0)

38 , 
m_Ï¡Chd
(0)

39 , 
m_´evLšeBox
(0)

40 , 
m_ÃxtLšeBox
(0)

41 , 
m_šşudeLeáEdge
(
çl£
)

42 , 
m_šşudeRightEdge
(
çl£
)

43 #iâdeà
NDEBUG


44 , 
m_hasBadChdLi¡
(
çl£
)

52 
	gm_hasTextChd»n
 = 
obj
->
¡yË
()->
di¥Ïy
(è=ğ
LIST_ITEM
;

55 #iâdeà
NDEBUG


56 
	gvœtu®
 ~
IÆšeFlowBox
();

59 
IÆšeFlowBox
* 
´evLšeBox
(ècÚ¡ {  
	gm_´evLšeBox
; }

60 
IÆšeFlowBox
* 
ÃxtLšeBox
(ècÚ¡ {  
	gm_ÃxtLšeBox
; }

61 
£tNextLšeBox
(
IÆšeFlowBox
* 
n
è{ 
	gm_ÃxtLšeBox
 =‚; }

62 
£tP»viousLšeBox
(
IÆšeFlowBox
* 
p
è{ 
	gm_´evLšeBox
 =…; }

64 
IÆšeBox
* 
fœ¡Chd
(ècÚ¡ { 
checkCÚsi¡’cy
();  
	gm_fœ¡Chd
; }

65 
IÆšeBox
* 
Ï¡Chd
(ècÚ¡ { 
checkCÚsi¡’cy
();  
	gm_Ï¡Chd
; }

67 
vœtu®
 
boŞ
 
isL—f
(ècÚ¡ {  
	gçl£
; }

69 
IÆšeBox
* 
fœ¡L—fChd
() const;

70 
IÆšeBox
* 
Ï¡L—fChd
() const;

72 
vœtu®
 
£tCÚ¡ruùed
()

74 
	gIÆšeBox
::
£tCÚ¡ruùed
();

75 ià(
fœ¡Chd
())

76 
fœ¡Chd
()->
£tCÚ¡ruùed
();

79 
addToLše
(
IÆšeBox
* 
chd
);

80 
vœtu®
 
d–‘eLše
(
R’d”A»Ç
*);

81 
vœtu®
 
exŒaùLše
();

82 
vœtu®
 
©chLše
();

83 
vœtu®
 
adju¡Pos™iÚ
(
dx
, 
dy
);

85 
vœtu®
 
exŒaùLšeBoxFromR’d”Objeù
();

86 
vœtu®
 
©chLšeBoxToR’d”Objeù
();

87 
vœtu®
 
»moveLšeBoxFromR’d”Objeù
();

89 
vœtu®
 
ş—rTrunÿtiÚ
();

91 
vœtu®
 
·štBoxDecÜ©iÚs
(
R’d”Objeù
::
PaštInfo
&, 
tx
, 
ty
);

92 
vœtu®
 
·štMask
(
R’d”Objeù
::
PaštInfo
&, 
tx
, 
ty
);

93 
·štFlLay”s
(cÚ¡ 
R’d”Objeù
::
PaštInfo
&, cÚ¡ 
CŞÜ
&, cÚ¡ 
FlLay”
*, 
tx
, 
ty
, 
w
, 
h
, 
Compos™eO³¿tÜ
 = 
Compos™eSourûOv”
);

94 
·štFlLay”
(cÚ¡ 
R’d”Objeù
::
PaštInfo
&, cÚ¡ 
CŞÜ
&, cÚ¡ 
FlLay”
*, 
tx
, 
ty
, 
w
, 
h
, 
Compos™eO³¿tÜ
 = 
Compos™eSourûOv”
);

95 
·štBoxShadow
(
G¿phicsCÚ‹xt
*, 
R’d”StyË
*, 
ShadowStyË
, 
tx
, 
ty
, 
w
, 
h
);

96 
vœtu®
 
·štTextDecÜ©iÚs
(
R’d”Objeù
::
PaštInfo
&, 
tx
, 
ty
, 
boŞ
 
·š‹dChd»n
 = 
çl£
);

97 
vœtu®
 
·št
(
R’d”Objeù
::
PaštInfo
&, 
tx
, 
ty
);

98 
vœtu®
 
boŞ
 
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, 
x
, 
y
, 
tx
, 
ty
);

100 
vœtu®
 
R’d”LšeBoxLi¡
* 
»nd””LšeBoxes
() const;

102 
m¬gšBÜd”PaddšgLeá
(ècÚ¡ {  
m¬gšLeá
(è+ 
bÜd”Leá
(è+ 
·ddšgLeá
(); }

103 
m¬gšBÜd”PaddšgRight
(ècÚ¡ {  
m¬gšRight
(è+ 
bÜd”Right
(è+ 
·ddšgRight
(); }

104 
m¬gšLeá
(ècÚ¡ { ià(
šşudeLeáEdge
()è 
boxMod–Objeù
()->marginLeft();  0; }

105 
m¬gšRight
(ècÚ¡ { ià(
šşudeRightEdge
()è 
boxMod–Objeù
()->marginRight();  0; }

106 
bÜd”Leá
(ècÚ¡ { ià(
šşudeLeáEdge
()è 
»nd””
()->
¡yË
()->
bÜd”LeáWidth
();  0; }

107 
bÜd”Right
(ècÚ¡ { ià(
šşudeRightEdge
()è 
»nd””
()->
¡yË
()->
bÜd”RightWidth
();  0; }

108 
bÜd”Tİ
(ècÚ¡ {  
»nd””
()->
¡yË
()->
bÜd”TİWidth
(); }

109 
bÜd”BÙtom
(ècÚ¡ {  
»nd””
()->
¡yË
()->
bÜd”BÙtomWidth
(); }

110 
·ddšgLeá
(ècÚ¡ { ià(
šşudeLeáEdge
()è 
boxMod–Objeù
()->paddingLeft();  0; }

111 
·ddšgRight
(ècÚ¡ { ià(
šşudeRightEdge
()è 
boxMod–Objeù
()->paddingRight();  0; }

112 
·ddšgTİ
(ècÚ¡ {  
boxMod–Objeù
()->paddingTop(); }

113 
·ddšgBÙtom
(ècÚ¡ {  
boxMod–Objeù
()->paddingBottom(); }

115 
boŞ
 
šşudeLeáEdge
(ècÚ¡ {  
	gm_šşudeLeáEdge
; }

116 
boŞ
 
šşudeRightEdge
(ècÚ¡ {  
	gm_šşudeRightEdge
; }

117 
£tEdges
(
boŞ
 
šşudeLeá
, boŞ 
šşudeRight
)

119 
	gm_šşudeLeáEdge
 = 
šşudeLeá
;

120 
	gm_šşudeRightEdge
 = 
šşudeRight
;

124 
d‘”mšeS·cšgFÜFlowBoxes
(
boŞ
 
Ï¡Lše
, 
R’d”Objeù
* 
’dObjeù
);

125 
g‘FlowS·cšgWidth
();

126 
boŞ
 
ÚEndChaš
(
R’d”Objeù
* 
’dObjeù
);

127 
vœtu®
 
¶aûBoxesHÜizÚÎy
(
x
, 
boŞ
& 
ÃedsWÜdS·cšg
);

128 
compu‹LogiÿlBoxHeights
(& 
maxPos™iÚTİ
, & 
maxPos™iÚBÙtom
,

129 & 
maxAsûÁ
, & 
maxDesûÁ
, 
boŞ
 
¡riùMode
);

130 
adju¡MaxAsûÁAndDesûÁ
(& 
maxAsûÁ
, & 
maxDesûÁ
,

131 
maxPos™iÚTİ
, 
maxPos™iÚBÙtom
);

132 
¶aûBoxesV”tiÿÎy
(
y
, 
maxHeight
, 
maxAsûÁ
, 
boŞ
 
¡riùMode
, & 
lšeTİ
, & 
lšeBÙtom
);

133 
compu‹V”tiÿlOv”æow
(
lšeTİ
, 
lšeBÙtom
, 
boŞ
 
¡riùMode
);

135 
»moveChd
(
IÆšeBox
* 
chd
);

137 
vœtu®
 
	gR’d”Objeù
::
S–eùiÚS‹
 
£ËùiÚS‹
();

139 
vœtu®
 
boŞ
 
ÿnAccommod©eEÎsis
(boŞ 
Ér
, 
blockEdge
, 
–lsisWidth
);

140 
vœtu®
 
¶aûEÎsisBox
(
boŞ
 
Ér
, 
blockLeáEdge
, 
blockRightEdge
, 
–lsisWidth
, bool&);

142 
boŞ
 
hasTextChd»n
(ècÚ¡ {  
	gm_hasTextChd»n
; }

144 
checkCÚsi¡’cy
() const;

145 
£tHasBadChdLi¡
();

147 
tİVisibËOv”æow
(ècÚ¡ {  
	g¡d
::
mš
(
tİLayoutOv”æow
(), 
tİVisu®Ov”æow
()); }

148 
bÙtomVisibËOv”æow
(ècÚ¡ {  
	g¡d
::
max
(
bÙtomLayoutOv”æow
(), 
bÙtomVisu®Ov”æow
()); }

149 
ËáVisibËOv”æow
(ècÚ¡ {  
	g¡d
::
mš
(
ËáLayoutOv”æow
(), 
ËáVisu®Ov”æow
()); }

150 
rightVisibËOv”æow
(ècÚ¡ {  
	g¡d
::
max
(
rightLayoutOv”æow
(), 
rightVisu®Ov”æow
()); }

151 
IÁReù
 
visibËOv”æowReù
(ècÚ¡ {  
	gm_ov”æow
 ? m_ov”æow->visibËOv”æowReù(è: IÁReù(
m_x
, 
m_y
, 
m_width
, 
height
()); }

153 
tİLayoutOv”æow
(ècÚ¡ {  
	gm_ov”æow
 ? m_ov”æow->tİLayoutOv”æow(è: 
m_y
; }

154 
bÙtomLayoutOv”æow
(ècÚ¡ {  
	gm_ov”æow
 ? m_ov”æow->bÙtomLayoutOv”æow(è: 
m_y
 + 
height
(); }

155 
ËáLayoutOv”æow
(ècÚ¡ {  
	gm_ov”æow
 ? m_ov”æow->ËáLayoutOv”æow(è: 
m_x
; }

156 
rightLayoutOv”æow
(ècÚ¡ {  
	gm_ov”æow
 ? m_ov”æow->rightLayoutOv”æow(è: 
m_x
 + 
m_width
; }

157 
IÁReù
 
ÏyoutOv”æowReù
(ècÚ¡ {  
	gm_ov”æow
 ? m_ov”æow->ÏyoutOv”æowReù(è: IÁReù(
m_x
, 
m_y
, 
m_width
, 
height
()); }

159 
tİVisu®Ov”æow
(ècÚ¡ {  
	gm_ov”æow
 ? m_ov”æow->tİVisu®Ov”æow(è: 
m_y
; }

160 
bÙtomVisu®Ov”æow
(ècÚ¡ {  
	gm_ov”æow
 ? m_ov”æow->bÙtomVisu®Ov”æow(è: 
m_y
 + 
height
(); }

161 
ËáVisu®Ov”æow
(ècÚ¡ {  
	gm_ov”æow
 ? m_ov”æow->ËáVisu®Ov”æow(è: 
m_x
; }

162 
rightVisu®Ov”æow
(ècÚ¡ {  
	gm_ov”æow
 ? m_ov”æow->rightVisu®Ov”æow(è: 
m_x
 + 
m_width
; }

163 
IÁReù
 
visu®Ov”æowReù
(ècÚ¡ {  
	gm_ov”æow
 ? m_ov”æow->visu®Ov”æowReù(è: IÁReù(
m_x
, 
m_y
, 
m_width
, 
height
()); }

165 
£tHÜizÚlOv”æowPos™iÚs
(
ËáLayoutOv”æow
, 
rightLayoutOv”æow
, 
ËáVisu®Ov”æow
, 
rightVisu®Ov”æow
);

166 
£tV”tiÿlOv”æowPos™iÚs
(
tİLayoutOv”æow
, 
bÙtomLayoutOv”æow
, 
tİVisu®Ov”æow
, 
bÙtomVisu®Ov”æow
, 
boxHeight
);

168 
	g´Ùeùed
:

169 
OwnPŒ
<
R’d”Ov”æow
> 
m_ov”æow
;

171 
vœtu®
 
boŞ
 
isIÆšeFlowBox
(ècÚ¡ {  
	gŒue
; }

173 
IÆšeBox
* 
	gm_fœ¡Chd
;

174 
IÆšeBox
* 
	gm_Ï¡Chd
;

176 
IÆšeFlowBox
* 
	gm_´evLšeBox
;

177 
IÆšeFlowBox
* 
	gm_ÃxtLšeBox
;

179 
boŞ
 
	gm_šşudeLeáEdge
 : 1;

180 
boŞ
 
	gm_šşudeRightEdge
 : 1;

181 
boŞ
 
	gm_hasTextChd»n
 : 1;

183 #iâdeà
NDEBUG


184 
boŞ
 
	gm_hasBadChdLi¡
;

188 
šlše
 
	gIÆšeFlowBox
::
	$£tHÜizÚlOv”æowPos™iÚs
(
ËáLayoutOv”æow
, 
rightLayoutOv”æow
, 
ËáVisu®Ov”æow
, 
rightVisu®Ov”æow
)

190 ià(!
m_ov”æow
) {

191 ià(
ËáLayoutOv”æow
 =ğ
m_x
 && 
rightLayoutOv”æow
 =ğm_x + 
m_width
 && 
ËáVisu®Ov”æow
 =ğm_x && 
rightVisu®Ov”æow
 == m_x + m_width)

193 
m_ov”æow
.
	`£t
(
Ãw
 
	`R’d”Ov”æow
(
	`IÁReù
(
m_x
, 
m_y
, 
m_width
, 
m_»nd””
->
	`¡yË
(
m_fœ¡Lše
)->
	`fÚt
().
	`height
())));

196 
m_ov”æow
->
	`£tLeáLayoutOv”æow
(
ËáLayoutOv”æow
);

197 
m_ov”æow
->
	`£tRightLayoutOv”æow
(
rightLayoutOv”æow
);

198 
m_ov”æow
->
	`£tLeáVisu®Ov”æow
(
ËáVisu®Ov”æow
);

199 
m_ov”æow
->
	`£tRightVisu®Ov”æow
(
rightVisu®Ov”æow
);

200 
	}
}

202 
šlše
 
	gIÆšeFlowBox
::
	$£tV”tiÿlOv”æowPos™iÚs
(
tİLayoutOv”æow
, 
bÙtomLayoutOv”æow
, 
tİVisu®Ov”æow
, 
bÙtomVisu®Ov”æow
, 
boxHeight
)

204 ià(!
m_ov”æow
) {

205 ià(
tİLayoutOv”æow
 =ğ
m_y
 && 
bÙtomLayoutOv”æow
 =ğm_y + 
boxHeight
 && 
tİVisu®Ov”æow
 =ğm_y && 
bÙtomVisu®Ov”æow
 == m_y + boxHeight)

207 
m_ov”æow
.
	`£t
(
Ãw
 
	`R’d”Ov”æow
(
	`IÁReù
(
m_x
, 
m_y
, 
m_width
, 
boxHeight
)));

210 
m_ov”æow
->
	`£tTİLayoutOv”æow
(
tİLayoutOv”æow
);

211 
m_ov”æow
->
	`£tBÙtomLayoutOv”æow
(
bÙtomLayoutOv”æow
);

212 
m_ov”æow
->
	`£tTİVisu®Ov”æow
(
tİVisu®Ov”æow
);

213 
m_ov”æow
->
	`£tBÙtomVisu®Ov”æow
(
bÙtomVisu®Ov”æow
);

214 
	}
}

216 #ifdeà
NDEBUG


217 
šlše
 
	gIÆšeFlowBox
::
	$checkCÚsi¡’cy
() const

219 
	}
}

222 
šlše
 
IÆšeFlowBox
::
	$£tHasBadChdLi¡
()

224 #iâdeà
NDEBUG


225 
m_hasBadChdLi¡
 = 
Œue
;

227 
	}
}

231 #iâdeà
NDEBUG


233 
showT»e
(cÚ¡ 
WebCÜe
::
IÆšeFlowBox
*);

	@InlineIterator.h

23 #iâdeà
IÆšeI‹¿tÜ_h


24 
	#IÆšeI‹¿tÜ_h


	)

26 
	~"BidiRun.h
"

27 
	~"R’d”Block.h
"

28 
	~"R’d”Text.h
"

29 
	~<wtf/AlwaysIÆše.h
>

30 
	~<wtf/StdLibExŒas.h
>

32 
Çme¥aû
 
	gWebCÜe
 {

34 şas 
	cIÆšeI‹¿tÜ
 {

35 
	gpublic
:

36 
IÆšeI‹¿tÜ
()

37 : 
block
(0)

38 , 
obj
(0)

39 , 
pos
(0)

40 , 
ÃxtB»akabËPos™iÚ
(-1)

44 
IÆšeI‹¿tÜ
(
R’d”Block
* 
b
, 
R’d”Objeù
* 
o
, 
p
)

45 : 
block
(
b
)

46 , 
obj
(
o
)

47 , 
pos
(
p
)

48 , 
ÃxtB»akabËPos™iÚ
(-1)

52 
šüem’t
(
IÆšeBidiResŞv”
* 
»sŞv”
 = 0);

53 
boŞ
 
©End
() const;

55 
UCh¬
 
cu¼’t
() const;

56 
	gWTF
::
Unicode
::
DœeùiÚ
 
dœeùiÚ
() const;

58 
R’d”Block
* 
	gblock
;

59 
R’d”Objeù
* 
	gobj
;

60 
	gpos
;

61 
	gÃxtB»akabËPos™iÚ
;

64 
šlše
 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
IÆšeI‹¿tÜ
& 
™1
, cÚ¡ 
	gIÆšeI‹¿tÜ
& 
	g™2
)

66  
	g™1
.
	gpos
 =ğ
™2
.
pos
 && 
™1
.
obj
 == it2.obj;

69 
šlše
 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
IÆšeI‹¿tÜ
& 
™1
, cÚ¡ 
	gIÆšeI‹¿tÜ
& 
	g™2
)

71  
	g™1
.
	gpos
 !ğ
™2
.
pos
 || 
™1
.
obj
 != it2.obj;

74 
šlše
 
R’d”Objeù
* 
	$bidiNext
(
R’d”Block
* 
block
, 
R’d”Objeù
* 
cu¼’t
, 
IÆšeBidiResŞv”
* 
»sŞv”
 = 0, 
boŞ
 
skIÆšes
 = 
Œue
, boŞ* 
’dOfIÆšePŒ
 = 0)

76 
R’d”Objeù
* 
Ãxt
 = 0;

77 
boŞ
 
ŞdEndOfIÆše
 = 
’dOfIÆšePŒ
 ? *’dOfIÆšePŒ : 
çl£
;

78 
boŞ
 
’dOfIÆše
 = 
çl£
;

80 
cu¼’t
) {

81 
Ãxt
 = 0;

82 ià(!
ŞdEndOfIÆše
 && !
cu¼’t
->
	`isFlßtšg
(è&& !cu¼’t->
	`isR•Ïûd
(è&& !cu¼’t->
	`isPos™iÚed
(è&& !cu¼’t->
	`isText
()) {

83 
Ãxt
 = 
cu¼’t
->
	`fœ¡Chd
();

84 ià(
Ãxt
 && 
»sŞv”
 &&‚ext->
	`isR’d”IÆše
()) {

85 
EUnicodeBidi
 
ub
 = 
Ãxt
->
	`¡yË
()->
	`unicodeBidi
();

86 ià(
ub
 !ğ
UBNÜm®
) {

87 
TextDœeùiÚ
 
dœ
 = 
Ãxt
->
	`¡yË
()->
	`dœeùiÚ
();

88 
WTF
::
Unicode
::
DœeùiÚ
 
d
 = (
ub
 =ğ
Embed


89 ? (
dœ
 =ğ
RTL
 ? 
WTF
::
Unicode
::
RightToLeáEmbeddšg
 : WTF::Unicode::
LeáToRightEmbeddšg
)

90 : (
dœ
 =ğ
RTL
 ? 
WTF
::
Unicode
::
RightToLeáOv”ride
 : WTF::Unicode::
LeáToRightOv”ride
));

91 
»sŞv”
->
	`embed
(
d
);

96 ià(!
Ãxt
) {

97 ià(!
skIÆšes
 && !
ŞdEndOfIÆše
 && 
cu¼’t
->
	`isR’d”IÆše
()) {

98 
Ãxt
 = 
cu¼’t
;

99 
’dOfIÆše
 = 
Œue
;

103 
cu¼’t
 && cu¼’ˆ!ğ
block
) {

104 ià(
»sŞv”
 && 
cu¼’t
->
	`isR’d”IÆše
(è&& cu¼’t->
	`¡yË
()->
	`unicodeBidi
(è!ğ
UBNÜm®
)

105 
»sŞv”
->
	`embed
(
WTF
::
Unicode
::
PİDœeùiÚ®FÜm©
);

107 
Ãxt
 = 
cu¼’t
->
	`ÃxtSiblšg
();

108 ià(
Ãxt
) {

109 ià(
»sŞv”
 && 
Ãxt
->
	`isR’d”IÆše
()) {

110 
EUnicodeBidi
 
ub
 = 
Ãxt
->
	`¡yË
()->
	`unicodeBidi
();

111 ià(
ub
 !ğ
UBNÜm®
) {

112 
TextDœeùiÚ
 
dœ
 = 
Ãxt
->
	`¡yË
()->
	`dœeùiÚ
();

113 
WTF
::
Unicode
::
DœeùiÚ
 
d
 = (
ub
 =ğ
Embed


114 ? (
dœ
 =ğ
RTL
 ? 
WTF
::
Unicode
::
RightToLeáEmbeddšg
: WTF::Unicode::
LeáToRightEmbeddšg
)

115 : (
dœ
 =ğ
RTL
 ? 
WTF
::
Unicode
::
RightToLeáOv”ride
 : WTF::Unicode::
LeáToRightOv”ride
));

116 
»sŞv”
->
	`embed
(
d
);

122 
cu¼’t
 = cu¼’t->
	`·»Á
();

123 ià(!
skIÆšes
 && 
cu¼’t
 && cu¼’ˆ!ğ
block
 && cu¼’t->
	`isR’d”IÆše
()) {

124 
Ãxt
 = 
cu¼’t
;

125 
’dOfIÆše
 = 
Œue
;

131 ià(!
Ãxt
)

134 ià(
Ãxt
->
	`isText
(è||‚ext->
	`isFlßtšg
(è||‚ext->
	`isR•Ïûd
(è||‚ext->
	`isPos™iÚed
()

135 || ((!
skIÆšes
 || !
Ãxt
->
	`fœ¡Chd
())

136 && 
Ãxt
->
	`isR’d”IÆše
()))

138 
cu¼’t
 = 
Ãxt
;

141 ià(
’dOfIÆšePŒ
)

142 *
’dOfIÆšePŒ
 = 
’dOfIÆše
;

144  
Ãxt
;

145 
	}
}

147 
šlše
 
R’d”Objeù
* 
	$bidiFœ¡
(
R’d”Block
* 
block
, 
IÆšeBidiResŞv”
* 
»sŞv”
, 
boŞ
 
skIÆšes
 = 
Œue
)

149 ià(!
block
->
	`fœ¡Chd
())

152 
R’d”Objeù
* 
o
 = 
block
->
	`fœ¡Chd
();

153 ià(
o
->
	`isR’d”IÆše
()) {

154 ià(
»sŞv”
) {

155 
EUnicodeBidi
 
ub
 = 
o
->
	`¡yË
()->
	`unicodeBidi
();

156 ià(
ub
 !ğ
UBNÜm®
) {

157 
TextDœeùiÚ
 
dœ
 = 
o
->
	`¡yË
()->
	`dœeùiÚ
();

158 
WTF
::
Unicode
::
DœeùiÚ
 
d
 = (
ub
 =ğ
Embed


159 ? (
dœ
 =ğ
RTL
 ? 
WTF
::
Unicode
::
RightToLeáEmbeddšg
 : WTF::Unicode::
LeáToRightEmbeddšg
)

160 : (
dœ
 =ğ
RTL
 ? 
WTF
::
Unicode
::
RightToLeáOv”ride
 : WTF::Unicode::
LeáToRightOv”ride
));

161 
»sŞv”
->
	`embed
(
d
);

164 ià(
skIÆšes
 && 
o
->
	`fœ¡Chd
())

165 
o
 = 
	`bidiNext
(
block
, o, 
»sŞv”
, 
skIÆšes
);

168 ià(
»sŞv”
)

169 
»sŞv”
->
	`comm™Ex¶ic™Embeddšg
();

170  
o
;

174 ià(
o
 && !o->
	`isText
(è&& !o->
	`isR•Ïûd
(è&& !o->
	`isFlßtšg
(è&& !o->
	`isPos™iÚed
())

175 
o
 = 
	`bidiNext
(
block
, o, 
»sŞv”
, 
skIÆšes
);

177 ià(
»sŞv”
)

178 
»sŞv”
->
	`comm™Ex¶ic™Embeddšg
();

179  
o
;

180 
	}
}

182 
šlše
 
	gIÆšeI‹¿tÜ
::
	$šüem’t
(
IÆšeBidiResŞv”
* 
»sŞv”
)

184 ià(!
obj
)

186 ià(
obj
->
	`isText
()) {

187 
pos
++;

188 ià(
pos
 >ğ
	`toR’d”Text
(
obj
)->
	`‹xtL’gth
()) {

189 
obj
 = 
	`bidiNext
(
block
, obj, 
»sŞv”
);

190 
pos
 = 0;

191 
ÃxtB»akabËPos™iÚ
 = -1;

194 
obj
 = 
	`bidiNext
(
block
, obj, 
»sŞv”
);

195 
pos
 = 0;

196 
ÃxtB»akabËPos™iÚ
 = -1;

198 
	}
}

200 
šlše
 
boŞ
 
	gIÆšeI‹¿tÜ
::
	$©End
() const

202  !
obj
;

203 
	}
}

205 
šlše
 
UCh¬
 
	gIÆšeI‹¿tÜ
::
	$cu¼’t
() const

207 ià(!
obj
 || !obj->
	`isText
())

210 
R’d”Text
* 
‹xt
 = 
	`toR’d”Text
(
obj
);

211 ià(
pos
 >ğ
‹xt
->
	`‹xtL’gth
())

214  
‹xt
->
	`ch¬aù”s
()[
pos
];

215 
	}
}

217 
ALWAYS_INLINE
 
	gWTF
::
Unicode
::
DœeùiÚ
 
IÆšeI‹¿tÜ
::
	$dœeùiÚ
() const

219 ià(
UCh¬
 
c
 = 
	`cu¼’t
())

220  
WTF
::
Unicode
::
	`dœeùiÚ
(
c
);

222 ià(
obj
 && obj->
	`isLi¡M¬k”
())

223  
obj
->
	`¡yË
()->
	`dœeùiÚ
(è=ğ
LTR
 ? 
WTF
::
Unicode
::
LeáToRight
 : WTF::Unicode::
RightToLeá
;

225  
WTF
::
Unicode
::
Oth”NeuŒ®
;

226 
	}
}

228 
	g‹m¶©e
<>

229 
šlše
 
	gIÆšeBidiResŞv”
::
	$šüem’t
()

231 
cu¼’t
.
	`šüem’t
(
this
);

232 
	}
}

234 
	g‹m¶©e
 <>

235 
šlše
 
	gIÆšeBidiResŞv”
::
	$­³ndRun
()

237 ià(!
em±yRun
 && !
eÜ
.
	`©End
()) {

238 
¡¬t
 = 
sÜ
.
pos
;

239 
R’d”Objeù
 *
obj
 = 
sÜ
.obj;

240 
obj
 && obj !ğ
eÜ
.obj && obj !ğ
’dOfLše
.obj) {

241 
R’d”Block
::
	`­³ndRunsFÜObjeù
(
¡¬t
, 
obj
->
	`Ëngth
(), obj, *
this
);

242 
¡¬t
 = 0;

243 
obj
 = 
	`bidiNext
(
sÜ
.
block
, obj);

245 ià(
obj
) {

246 
pos
 = 
obj
 =ğ
eÜ
.obj ?ƒÜ.po : 
UINT_MAX
;

247 ià(
obj
 =ğ
’dOfLše
.obj &&ƒndOfLše.
pos
 <=…os) {

248 
»achedEndOfLše
 = 
Œue
;

249 
pos
 = 
’dOfLše
.pos;

252 
’d
 = 
obj
->
	`Ëngth
(è? 
pos
+1 : 0;

253 
R’d”Block
::
	`­³ndRunsFÜObjeù
(
¡¬t
, 
’d
, 
obj
, *
this
);

256 
eÜ
.
	`šüem’t
();

257 
sÜ
 = 
eÜ
;

260 
m_dœeùiÚ
 = 
WTF
::
Unicode
::
Oth”NeuŒ®
;

261 
m_¡©us
.
eÜ
 = 
WTF
::
Unicode
::
Oth”NeuŒ®
;

262 
	}
}

	@InlineTextBox.cpp

23 
	~"cÚfig.h
"

24 
	~"IÆšeTextBox.h
"

26 
	~"Chrome.h
"

27 
	~"ChromeCl›Á.h
"

28 
	~"Docum’t.h
"

29 
	~"Ed™Ü.h
"

30 
	~"EÎsisBox.h
"

31 
	~"F¿me.h
"

32 
	~"G¿phicsCÚ‹xt.h
"

33 
	~"H™Te¡ResuÉ.h
"

34 
	~"Page.h
"

35 
	~"R’d”A»Ç.h
"

36 
	~"R’d”Block.h
"

37 
	~"R’d”Theme.h
"

38 
	~"Text.h
"

39 
	~"b»ak_lšes.h
"

40 
	~<wtf/AlwaysIÆše.h
>

42 
usšg
 
Çme¥aû
 
	g¡d
;

44 
Çme¥aû
 
	gWebCÜe
 {

46 
	gIÆšeTextBox
::
£ËùiÚTİ
()

48  
roÙ
()->
£ËùiÚTİ
();

51 
	gIÆšeTextBox
::
£ËùiÚHeight
()

53  
roÙ
()->
£ËùiÚHeight
();

56 
boŞ
 
	gIÆšeTextBox
::
isS–eùed
(
¡¬tPos
, 
’dPos
) const

58 
	gsPos
 = 
max
(
¡¬tPos
 - 
m_¡¬t
, 0);

59 
	gePos
 = 
mš
(
’dPos
 - 
m_¡¬t
, ()
m_Ën
);

60  (
	gsPos
 < 
	gePos
);

63 
	gR’d”Objeù
::
S–eùiÚS‹
 
IÆšeTextBox
::
£ËùiÚS‹
()

65 
R’d”Objeù
::
S–eùiÚS‹
 
¡©e
 = 
»nd””
()->
£ËùiÚS‹
();

66 ià(
	g¡©e
 =ğ
R’d”Objeù
::
S–eùiÚS¹
 || 
¡©e
 =ğR’d”Objeù::
S–eùiÚEnd
 || s‹ =ğR’d”Objeù::
S–eùiÚBÙh
) {

67 
¡¬tPos
, 
’dPos
;

68 
»nd””
()->
£ËùiÚS¹End
(
¡¬tPos
, 
’dPos
);

70 
	gÏ¡S–eùabË
 = 
¡¬t
(è+ 
Ën
(è- (
isLšeB»ak
() ? 1 : 0);

72 
boŞ
 
	g¡¬t
 = (
¡©e
 !ğ
R’d”Objeù
::
S–eùiÚEnd
 && 
¡¬tPos
 >ğ
m_¡¬t
 && s¹Po < m_¡¬ˆ+ 
m_Ën
);

73 
boŞ
 
	g’d
 = (
¡©e
 !ğ
R’d”Objeù
::
S–eùiÚS¹
 && 
’dPos
 > 
m_¡¬t
 &&ƒndPo <ğ
Ï¡S–eùabË
);

74 ià(
	g¡¬t
 && 
	g’d
)

75 
	g¡©e
 = 
R’d”Objeù
::
S–eùiÚBÙh
;

76 ià(
	g¡¬t
)

77 
	g¡©e
 = 
R’d”Objeù
::
S–eùiÚS¹
;

78 ià(
	g’d
)

79 
	g¡©e
 = 
R’d”Objeù
::
S–eùiÚEnd
;

80 ià((
	g¡©e
 =ğ
R’d”Objeù
::
S–eùiÚEnd
 || 
¡¬tPos
 < 
m_¡¬t
) &&

81 (
¡©e
 =ğ
R’d”Objeù
::
S–eùiÚS¹
 || 
’dPos
 > 
Ï¡S–eùabË
))

82 
¡©e
 = 
R’d”Objeù
::
S–eùiÚInside
;

83 ià(
	g¡©e
 =ğ
R’d”Objeù
::
S–eùiÚBÙh
)

84 
¡©e
 = 
R’d”Objeù
::
S–eùiÚNÚe
;

88 ià(
	gm_ŒunÿtiÚ
 !ğ
cNoTrunÿtiÚ
 && 
roÙ
()->
–lsisBox
()) {

89 
EÎsisBox
* 
–lsis
 = 
roÙ
()->
–lsisBox
();

90 ià(
	g¡©e
 !ğ
R’d”Objeù
::
S–eùiÚNÚe
) {

91 
¡¬t
, 
’d
;

92 
£ËùiÚS¹End
(
¡¬t
, 
’d
);

97 
	g–lsis
->
£tS–eùiÚS‹
(
’d
 >ğ
m_ŒunÿtiÚ
 && 
¡¬t
 <= m_truncation ?

98 
R’d”Objeù
::
S–eùiÚInside
 : R’d”Objeù::
S–eùiÚNÚe
);

100 
	g–lsis
->
£tS–eùiÚS‹
(
R’d”Objeù
::
S–eùiÚNÚe
);

103  
	g¡©e
;

106 
IÁReù
 
	gIÆšeTextBox
::
£ËùiÚReù
(
tx
, 
ty
, 
¡¬tPos
, 
’dPos
)

108 
	gsPos
 = 
max
(
¡¬tPos
 - 
m_¡¬t
, 0);

109 
	gePos
 = 
mš
(
’dPos
 - 
m_¡¬t
, ()
m_Ën
);

111 ià(
	gsPos
 > 
	gePos
)

112  
IÁReù
();

114 
R’d”Text
* 
	g‹xtObj
 = 
‹xtR’d””
();

115 
	g£lTİ
 = 
£ËùiÚTİ
();

116 
	g£lHeight
 = 
£ËùiÚHeight
();

117 cÚ¡ 
	gFÚt
& 
	gf
 = 
‹xtObj
->
¡yË
(
m_fœ¡Lše
)->
fÚt
();

119 
IÁReù
 
	gr
 = 
’şosšgIÁReù
(
f
.
£ËùiÚReùFÜText
(
TextRun
(
‹xtObj
->
‹xt
()->
ch¬aù”s
(è+ 
m_¡¬t
, 
m_Ën
,extObj->
®lowTabs
(), 
‹xtPos
(), 
m_toAdd
, 
dœeùiÚ
(è=ğ
RTL
, 
m_dœOv”ride
),

120 
IÁPošt
(
tx
 + 
m_x
, 
ty
 + 
£lTİ
), 
£lHeight
, 
sPos
, 
ePos
));

121 ià(
	gr
.
x
(è> 
	gtx
 + 
	gm_x
 + 
	gm_width
)

122 
	gr
.
£tWidth
(0);

123 ià(
	gr
.
right
(è- 1 > 
	gtx
 + 
	gm_x
 + 
	gm_width
)

124 
	gr
.
£tWidth
(
tx
 + 
m_x
 + 
m_width
 - 
r
.
x
());

125  
	gr
;

128 
	gIÆšeTextBox
::
d–‘eLše
(
R’d”A»Ç
* 
¬’a
)

130 
toR’d”Text
(
»nd””
())->
»moveTextBox
(
this
);

131 
de¡roy
(
¬’a
);

134 
	gIÆšeTextBox
::
exŒaùLše
()

136 ià(
m_exŒaùed
)

139 
toR’d”Text
(
»nd””
())->
exŒaùTextBox
(
this
);

142 
	gIÆšeTextBox
::
©chLše
()

144 ià(!
m_exŒaùed
)

147 
toR’d”Text
(
»nd””
())->
©chTextBox
(
this
);

150 
	gIÆšeTextBox
::
¶aûEÎsisBox
(
boŞ
 
æowIsLTR
, 
visibËLeáEdge
, 
visibËRightEdge
, 
–lsisWidth
, boŞ& 
foundBox
)

152 ià(
	gfoundBox
) {

153 
	gm_ŒunÿtiÚ
 = 
cFuÎTrunÿtiÚ
;

158 
	g–lsisX
 = 
æowIsLTR
 ? 
visibËRightEdge
 - 
–lsisWidth
 : 
visibËLeáEdge
 +ƒllipsisWidth;

163 
boŞ
 
	gÉrFuÎTrunÿtiÚ
 = 
æowIsLTR
 && 
–lsisX
 <ğ
m_x
;

164 
boŞ
 
	g¹lFuÎTrunÿtiÚ
 = !
æowIsLTR
 && 
–lsisX
 >ğ(
m_x
 + 
m_width
);

165 ià(
	gÉrFuÎTrunÿtiÚ
 || 
	g¹lFuÎTrunÿtiÚ
) {

167 
	gm_ŒunÿtiÚ
 = 
cFuÎTrunÿtiÚ
;

168 
	gfoundBox
 = 
Œue
;

172 
boŞ
 
	gÉrEÎsisW™hšBox
 = 
æowIsLTR
 && (
–lsisX
 < 
m_x
 + 
m_width
);

173 
boŞ
 
	g¹lEÎsisW™hšBox
 = !
æowIsLTR
 && (
–lsisX
 > 
m_x
);

174 ià(
	gÉrEÎsisW™hšBox
 || 
	g¹lEÎsisW™hšBox
) {

175 
	gfoundBox
 = 
Œue
;

180 
boŞ
 
	gÉr
 = 
dœeùiÚ
(è=ğ
LTR
;

181 ià(
	gÉr
 !ğ
æowIsLTR
) {

183 
visibËBoxWidth
 = 
visibËRightEdge
 - 
visibËLeáEdge
 - 
–lsisWidth
;

184 
	g–lsisX
 = 
Ér
 ? 
m_x
 + 
visibËBoxWidth
 : m_x + 
m_width
 - visibleBoxWidth;

187 
	goff£t
 = 
off£tFÜPos™iÚ
(
–lsisX
, 
çl£
);

188 ià(
	goff£t
 == 0) {

191 
m_ŒunÿtiÚ
 = 
cFuÎTrunÿtiÚ
;

192  
mš
(
–lsisX
, 
m_x
);

196 
	gm_ŒunÿtiÚ
 = 
off£t
;

200 
	gwidthOfVisibËText
 = 
toR’d”Text
(
»nd””
())->
width
(
m_¡¬t
, 
off£t
, 
‹xtPos
(), 
m_fœ¡Lše
);

207 ià(
	gæowIsLTR
)

208  
	gm_x
 + 
	gwidthOfVisibËText
;

210  (
	gm_x
 + 
	gm_width
è- 
	gwidthOfVisibËText
 - 
	g–lsisWidth
;

215 
CŞÜ
 
cÜ»ùedTextCŞÜ
(CŞÜ 
‹xtCŞÜ
, CŞÜ 
backgroundCŞÜ
)

220 
	gd
 = 
difã»nûSqu¬ed
(
‹xtCŞÜ
, 
backgroundCŞÜ
);

222 ià(
	gd
 > 65025) {

223  
	g‹xtCŞÜ
;

226 
	gdi¡ªûFromWh™e
 = 
difã»nûSqu¬ed
(
‹xtCŞÜ
, 
CŞÜ
::
wh™e
);

227 
	gdi¡ªûFromBÏck
 = 
difã»nûSqu¬ed
(
‹xtCŞÜ
, 
CŞÜ
::
bÏck
);

229 ià(
	gdi¡ªûFromWh™e
 < 
	gdi¡ªûFromBÏck
) {

230  
	g‹xtCŞÜ
.
d¬k
();

233  
	g‹xtCŞÜ
.
light
();

236 
upd©eG¿phicsCÚ‹xt
(
G¿phicsCÚ‹xt
* 
cÚ‹xt
, cÚ¡ 
CŞÜ
& 
flCŞÜ
, cÚ¡ CŞÜ& 
¡rokeCŞÜ
, 
¡rokeThickÃss
, 
CŞÜS·û
 
cŞÜS·û
)

238 
	gmode
 = 
cÚ‹xt
->
‹xtD¿wšgMode
();

239 ià(
	g¡rokeThickÃss
 > 0) {

240 
	gÃwMode
 = 
mode
 | 
cTextSŒoke
;

241 ià(
	gmode
 !ğ
ÃwMode
) {

242 
cÚ‹xt
->
£tTextD¿wšgMode
(
ÃwMode
);

243 
	gmode
 = 
ÃwMode
;

247 ià(
	gmode
 & 
	gcTextFl
 && (
	gflCŞÜ
 !ğ
cÚ‹xt
->
flCŞÜ
(è|| 
cŞÜS·û
 !ğcÚ‹xt->
flCŞÜS·û
()))

248 
cÚ‹xt
->
£tFlCŞÜ
(
flCŞÜ
, 
cŞÜS·û
);

250 ià(
	gmode
 & 
	gcTextSŒoke
) {

251 ià(
	g¡rokeCŞÜ
 !ğ
cÚ‹xt
->
¡rokeCŞÜ
())

252 
cÚ‹xt
->
£tSŒokeCŞÜ
(
¡rokeCŞÜ
, 
cŞÜS·û
);

253 ià(
	g¡rokeThickÃss
 !ğ
cÚ‹xt
->
¡rokeThickÃss
())

254 
cÚ‹xt
->
£tSŒokeThickÃss
(
¡rokeThickÃss
);

258 
boŞ
 
	gIÆšeTextBox
::
isLšeB»ak
() const

260  
»nd””
()->
isBR
(è|| (»nd””()->
¡yË
()->
´e£rveNewlše
(è&& 
Ën
(è=ğ1 && (*
‹xtR’d””
()->
‹xt
())[
¡¬t
()] == '\n');

263 
boŞ
 
	gIÆšeTextBox
::
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
& 
»suÉ
, 
x
, 
y
, 
tx
, 
ty
)

265 ià(
isLšeB»ak
())

266  
	gçl£
;

268 
IÁReù
 
»ù
(
tx
 + 
m_x
, 
ty
 + 
m_y
, 
m_width
, 
height
());

269 ià(
	gm_ŒunÿtiÚ
 !ğ
cFuÎTrunÿtiÚ
 && 
visibËToH™Te¡šg
(è&& 
»ù
.
cÚšs
(
x
, 
y
)) {

270 
»nd””
()->
upd©eH™Te¡ResuÉ
(
»suÉ
, 
IÁPošt
(
x
 - 
tx
, 
y
 - 
ty
));

271  
	gŒue
;

273  
	gçl£
;

276 
·štTextW™hShadows
(
G¿phicsCÚ‹xt
* 
cÚ‹xt
, cÚ¡ 
FÚt
& 
fÚt
, cÚ¡ 
TextRun
& 
‹xtRun
, 
¡¬tOff£t
, 
’dOff£t
, 
ŒunÿtiÚPošt
, cÚ¡ 
IÁPošt
& 
‹xtOrigš
, 
x
, 
y
, 
w
, 
h
, cÚ¡ 
ShadowD©a
* 
shadow
, 
boŞ
 
¡roked
)

278 
CŞÜ
 
	gflCŞÜ
 = 
cÚ‹xt
->
flCŞÜ
();

279 
CŞÜS·û
 
	gflCŞÜS·û
 = 
cÚ‹xt
->
flCŞÜS·û
();

280 
boŞ
 
	gİaque
 = 
flCŞÜ
.
®pha
() == 255;

281 ià(!
	gİaque
)

282 
	gcÚ‹xt
->
£tFlCŞÜ
(
CŞÜ
::
bÏck
, 
flCŞÜS·û
);

285 
IÁSize
 
	gexŒaOff£t
;

287 ià(
	gshadow
) {

288 
IÁSize
 
shadowOff£t
(
shadow
->
x
(), shadow->
y
());

289 
	gshadowBlur
 = 
shadow
->
blur
();

290 cÚ¡ 
	gCŞÜ
& 
	gshadowCŞÜ
 = 
shadow
->
cŞÜ
();

292 ià(
	gshadow
->
Ãxt
(è|| 
	g¡roked
 || !
	gİaque
) {

293 
IÁReù
 
shadowReù
(
x
, 
y
, 
w
, 
h
);

294 
	gshadowReù
.
šæ©e
(
shadowBlur
);

295 
	gshadowReù
.
move
(
shadowOff£t
);

296 
	gcÚ‹xt
->
§ve
();

297 
	gcÚ‹xt
->
ş
(
shadowReù
);

299 
	gexŒaOff£t
 = 
IÁSize
(0, 2 * 
h
 + 
max
(0, 
shadowOff£t
.
height
()è+ 
shadowBlur
);

300 
	gshadowOff£t
 -ğ
exŒaOff£t
;

302 
	gcÚ‹xt
->
£tShadow
(
shadowOff£t
, 
shadowBlur
, 
shadowCŞÜ
, 
flCŞÜS·û
);

303 } ià(!
	gİaque
)

304 
	gcÚ‹xt
->
£tFlCŞÜ
(
flCŞÜ
, 
flCŞÜS·û
);

306 ià(
	g¡¬tOff£t
 <ğ
’dOff£t
)

307 
cÚ‹xt
->
d¿wText
(
fÚt
, 
‹xtRun
, 
‹xtOrigš
 + 
exŒaOff£t
, 
¡¬tOff£t
, 
’dOff£t
);

309 ià(
	g’dOff£t
 > 0)

310 
	gcÚ‹xt
->
d¿wText
(
fÚt
, 
‹xtRun
, 
‹xtOrigš
 + 
exŒaOff£t
, 0, 
’dOff£t
);

311 ià(
	g¡¬tOff£t
 < 
	gŒunÿtiÚPošt
)

312 
	gcÚ‹xt
->
d¿wText
(
fÚt
, 
‹xtRun
, 
‹xtOrigš
 + 
exŒaOff£t
, 
¡¬tOff£t
, 
ŒunÿtiÚPošt
);

315 ià(!
	gshadow
)

318 ià(
	gshadow
->
Ãxt
(è|| 
	g¡roked
 || !
	gİaque
)

319 
	gcÚ‹xt
->
»¡Üe
();

321 
	gcÚ‹xt
->
ş—rShadow
();

323 
	gshadow
 = 
shadow
->
Ãxt
();

324 } 
	gshadow
 || 
	g¡roked
 || !
	gİaque
);

327 
	gIÆšeTextBox
::
·št
(
R’d”Objeù
::
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

329 ià(
isLšeB»ak
(è|| !
»nd””
()->
shouldPaštW™hšRoÙ
(
·štInfo
è||„’d””()->
¡yË
()->
visib™y
(è!ğ
VISIBLE
 ||

330 
m_ŒunÿtiÚ
 =ğ
cFuÎTrunÿtiÚ
 || 
·štInfo
.
pha£
 =ğ
PaštPha£Ouše
)

333 
ASSERT
(
·štInfo
.
pha£
 !ğ
PaštPha£S–fOuše
 &&…aštInfo.pha£ !ğ
PaštPha£ChdOušes
);

337 
	gËáOv”æow
 = 
·»Á
()->
x
(è-…¬’t()->
ËáVisu®Ov”æow
();

338 
	grightOv”æow
 = 
·»Á
()->
rightVisu®Ov”æow
(è- (·»Á()->
x
(è+…¬’t()->
width
());

339 
	gxPos
 = 
tx
 + 
m_x
 - 
ËáOv”æow
;

340 
	gw
 = 
width
(è+ 
ËáOv”æow
 + 
rightOv”æow
;

341 ià(
	gxPos
 >ğ
·štInfo
.
»ù
.
right
(è|| 
xPos
 + 
w
 <ğ·štInfo.»ù.
x
())

344 
boŞ
 
	gisPrštšg
 = 
‹xtR’d””
()->
docum’t
()->
´štšg
();

347 
boŞ
 
	ghaveS–eùiÚ
 = !
isPrštšg
 && 
·štInfo
.
pha£
 !ğ
PaštPha£TextCl
 && 
£ËùiÚS‹
(è!ğ
R’d”Objeù
::
S–eùiÚNÚe
;

348 ià(!
	ghaveS–eùiÚ
 && 
	g·štInfo
.
	gpha£
 =ğ
PaštPha£S–eùiÚ
)

352 ià(
	gm_ŒunÿtiÚ
 !ğ
cNoTrunÿtiÚ
) {

353 
TextDœeùiÚ
 
æowDœeùiÚ
 = 
»nd””
()->
cÚššgBlock
()->
¡yË
()->
dœeùiÚ
();

354 ià(
	gæowDœeùiÚ
 !ğ
dœeùiÚ
()) {

363 
widthOfVisibËText
 = 
toR’d”Text
(
»nd””
())->
width
(
m_¡¬t
, 
m_ŒunÿtiÚ
, 
‹xtPos
(), 
m_fœ¡Lše
);

364 
	gwidthOfHidd’Text
 = 
m_width
 - 
widthOfVisibËText
;

366 
	gtx
 +ğ
dœeùiÚ
(è=ğ
LTR
 ? 
widthOfHidd’Text
 : -widthOfHiddenText;

370 
G¿phicsCÚ‹xt
* 
	gcÚ‹xt
 = 
·štInfo
.
cÚ‹xt
;

373 
boŞ
 
	gcÚšsCompos™iÚ
 = 
»nd””
()->
node
(è&&„’d””()->
docum’t
()->
äame
()->
ed™Ü
()->
compos™iÚNode
() ==„enderer()->node();

374 
boŞ
 
	gu£Cu¡omUnd”lšes
 = 
cÚšsCompos™iÚ
 && 
»nd””
()->
docum’t
()->
äame
()->
ed™Ü
()->
compos™iÚU£sCu¡omUnd”lšes
();

377 
R’d”StyË
* 
	g¡yËToU£
 = 
»nd””
()->
¡yË
(
m_fœ¡Lše
);

378 
	gd
 = 
¡yËToU£
->
‹xtDecÜ©iÚsInEfãù
();

379 cÚ¡ 
	gFÚt
& 
	gfÚt
 = 
¡yËToU£
->
fÚt
();

383 ià(
	g·štInfo
.
	gpha£
 !ğ
PaštPha£S–eùiÚ
 && 
·štInfo
.
pha£
 !ğ
PaštPha£TextCl
 && !
isPrštšg
) {

384 #ià
PLATFORM
(
MAC
)

386 ià(
¡yËToU£
->
highlight
(è!ğ
nuÎAtom
 && !
cÚ‹xt
->
·štšgDi§bËd
())

387 
·štCu¡omHighlight
(
tx
, 
ty
, 
¡yËToU£
->
highlight
());

390 ià(
	gcÚšsCompos™iÚ
 && !
	gu£Cu¡omUnd”lšes
)

391 
·štCompos™iÚBackground
(
cÚ‹xt
, 
tx
, 
ty
, 
¡yËToU£
, 
fÚt
,

392 
»nd””
()->
docum’t
()->
äame
()->
ed™Ü
()->
compos™iÚS¹
(),

393 
»nd””
()->
docum’t
()->
äame
()->
ed™Ü
()->
compos™iÚEnd
());

395 
·štDocum’tM¬k”s
(
cÚ‹xt
, 
tx
, 
ty
, 
¡yËToU£
, 
fÚt
, 
Œue
);

397 ià(
	ghaveS–eùiÚ
 && !
	gu£Cu¡omUnd”lšes
)

398 
·štS–eùiÚ
(
cÚ‹xt
, 
tx
, 
ty
, 
¡yËToU£
, 
fÚt
);

402 ià(
	gm_Ën
 <= 0)

405 
CŞÜ
 
	g‹xtFlCŞÜ
;

406 
CŞÜ
 
	g‹xtSŒokeCŞÜ
;

407 
	g‹xtSŒokeWidth
 = 
¡yËToU£
->
‹xtSŒokeWidth
();

408 cÚ¡ 
ShadowD©a
* 
	g‹xtShadow
 = 
·štInfo
.
fÜûBÏckText
 ? 0 : 
¡yËToU£
->
‹xtShadow
();

410 ià(
	g·štInfo
.
	gfÜûBÏckText
) {

411 
	g‹xtFlCŞÜ
 = 
CŞÜ
::
bÏck
;

412 
	g‹xtSŒokeCŞÜ
 = 
CŞÜ
::
bÏck
;

414 
	g‹xtFlCŞÜ
 = 
¡yËToU£
->
vis™edD•’d’tCŞÜ
(
CSSPrİ”tyWebk™TextFlCŞÜ
);

417 ià(
	g¡yËToU£
->
fÜûBackgroundsToWh™e
())

418 
	g‹xtFlCŞÜ
 = 
cÜ»ùedTextCŞÜ
(
‹xtFlCŞÜ
, 
CŞÜ
::
wh™e
);

420 
	g‹xtSŒokeCŞÜ
 = 
¡yËToU£
->
vis™edD•’d’tCŞÜ
(
CSSPrİ”tyWebk™TextSŒokeCŞÜ
);

423 ià(
	g¡yËToU£
->
fÜûBackgroundsToWh™e
())

424 
	g‹xtSŒokeCŞÜ
 = 
cÜ»ùedTextCŞÜ
(
‹xtSŒokeCŞÜ
, 
CŞÜ
::
wh™e
);

427 
boŞ
 
	g·štS–eùedTextOÆy
 = (
·štInfo
.
pha£
 =ğ
PaštPha£S–eùiÚ
);

428 
boŞ
 
	g·štS–eùedTextS•¬©–y
 = 
çl£
;

430 
CŞÜ
 
	g£ËùiÚFlCŞÜ
 = 
‹xtFlCŞÜ
;

431 
CŞÜ
 
	g£ËùiÚSŒokeCŞÜ
 = 
‹xtSŒokeCŞÜ
;

432 
	g£ËùiÚSŒokeWidth
 = 
‹xtSŒokeWidth
;

433 cÚ¡ 
ShadowD©a
* 
	g£ËùiÚShadow
 = 
‹xtShadow
;

434 ià(
	ghaveS–eùiÚ
) {

436 
CŞÜ
 
	gfÜeground
 = 
·štInfo
.
fÜûBÏckText
 ? CŞÜ::
bÏck
 : 
»nd””
()->
£ËùiÚFÜegroundCŞÜ
();

437 ià(
	gfÜeground
.
isV®id
(è&& fÜeground !ğ
£ËùiÚFlCŞÜ
) {

438 ià(!
·štS–eùedTextOÆy
)

439 
·štS–eùedTextS•¬©–y
 = 
Œue
;

440 
	g£ËùiÚFlCŞÜ
 = 
fÜeground
;

443 ià(
R’d”StyË
* 
	gp£udoStyË
 = 
»nd””
()->
g‘CachedP£udoStyË
(
SELECTION
)) {

444 cÚ¡ 
ShadowD©a
* 
shadow
 = 
·štInfo
.
fÜûBÏckText
 ? 0 : 
p£udoStyË
->
‹xtShadow
();

445 ià(
	gshadow
 !ğ
£ËùiÚShadow
) {

446 ià(!
·štS–eùedTextOÆy
)

447 
·štS–eùedTextS•¬©–y
 = 
Œue
;

448 
	g£ËùiÚShadow
 = 
shadow
;

451 
	g¡rokeWidth
 = 
p£udoStyË
->
‹xtSŒokeWidth
();

452 ià(
	g¡rokeWidth
 !ğ
£ËùiÚSŒokeWidth
) {

453 ià(!
·štS–eùedTextOÆy
)

454 
·štS–eùedTextS•¬©–y
 = 
Œue
;

455 
	g£ËùiÚSŒokeWidth
 = 
¡rokeWidth
;

458 
CŞÜ
 
	g¡roke
 = 
·štInfo
.
fÜûBÏckText
 ? CŞÜ::
bÏck
 : 
p£udoStyË
->
‹xtSŒokeCŞÜ
();

459 ià(!
	g¡roke
.
isV®id
())

460 
	g¡roke
 = 
p£udoStyË
->
cŞÜ
();

461 ià(
	g¡roke
 !ğ
£ËùiÚSŒokeCŞÜ
) {

462 ià(!
·štS–eùedTextOÆy
)

463 
·štS–eùedTextS•¬©–y
 = 
Œue
;

464 
	g£ËùiÚSŒokeCŞÜ
 = 
¡roke
;

469 
	gba£lše
 = 
»nd””
()->
¡yË
(
m_fœ¡Lše
)->
fÚt
().
asûÁ
();

470 
IÁPošt
 
‹xtOrigš
(
m_x
 + 
tx
, 
m_y
 + 
ty
 + 
ba£lše
);

471 
TextRun
 
‹xtRun
(
‹xtR’d””
()->
‹xt
()->
ch¬aù”s
(è+ 
m_¡¬t
, 
m_Ën
,extR’d””()->
®lowTabs
(), 
‹xtPos
(), 
m_toAdd
, 
dœeùiÚ
(è=ğ
RTL
, 
m_dœOv”ride
 || 
¡yËToU£
->
visu®lyOrd”ed
());

473 
	gsPos
 = 0;

474 
	gePos
 = 0;

475 ià(
	g·štS–eùedTextOÆy
 || 
	g·štS–eùedTextS•¬©–y
)

476 
£ËùiÚS¹End
(
sPos
, 
ePos
);

478 
	gËngth
 = 
m_Ën
;

479 ià(
	gm_ŒunÿtiÚ
 !ğ
cNoTrunÿtiÚ
) {

480 
sPos
 = 
mš
<>(sPos, 
	gm_ŒunÿtiÚ
);

481 
	gePos
 = 
mš
<>(
ePos
, 
	gm_ŒunÿtiÚ
);

482 
	gËngth
 = 
m_ŒunÿtiÚ
;

485 ià(!
	g·štS–eùedTextOÆy
) {

488 ià(
	g‹xtSŒokeWidth
 > 0)

489 
	gcÚ‹xt
->
§ve
();

491 
upd©eG¿phicsCÚ‹xt
(
cÚ‹xt
, 
‹xtFlCŞÜ
, 
‹xtSŒokeCŞÜ
, 
‹xtSŒokeWidth
, 
¡yËToU£
->
cŞÜS·û
());

492 ià(!
	g·štS–eùedTextS•¬©–y
 || 
	gePos
 <ğ
sPos
) {

494 
·štTextW™hShadows
(
cÚ‹xt
, 
fÚt
, 
‹xtRun
, 0, 
Ëngth
,†’gth, 
‹xtOrigš
, 
m_x
 + 
tx
, 
m_y
 + 
ty
, 
width
(), 
height
(), 
‹xtShadow
, 
‹xtSŒokeWidth
 > 0);

496 
·štTextW™hShadows
(
cÚ‹xt
, 
fÚt
, 
‹xtRun
, 
ePos
, 
sPos
, 
Ëngth
, 
‹xtOrigš
, 
m_x
 + 
tx
, 
m_y
 + 
ty
, 
width
(), 
height
(), 
‹xtShadow
, 
‹xtSŒokeWidth
 > 0);

498 ià(
	g‹xtSŒokeWidth
 > 0)

499 
	gcÚ‹xt
->
»¡Üe
();

502 ià((
	g·štS–eùedTextOÆy
 || 
	g·štS–eùedTextS•¬©–y
è&& 
	gsPos
 < 
	gePos
) {

504 ià(
	g£ËùiÚSŒokeWidth
 > 0)

505 
	gcÚ‹xt
->
§ve
();

507 
upd©eG¿phicsCÚ‹xt
(
cÚ‹xt
, 
£ËùiÚFlCŞÜ
, 
£ËùiÚSŒokeCŞÜ
, 
£ËùiÚSŒokeWidth
, 
¡yËToU£
->
cŞÜS·û
());

508 
·štTextW™hShadows
(
cÚ‹xt
, 
fÚt
, 
‹xtRun
, 
sPos
, 
ePos
, 
Ëngth
, 
‹xtOrigš
, 
m_x
 + 
tx
, 
m_y
 + 
ty
, 
width
(), 
height
(), 
£ËùiÚShadow
, 
£ËùiÚSŒokeWidth
 > 0);

510 ià(
	g£ËùiÚSŒokeWidth
 > 0)

511 
	gcÚ‹xt
->
»¡Üe
();

515 ià(
	gd
 !ğ
TDNONE
 && 
·štInfo
.
pha£
 !ğ
PaštPha£S–eùiÚ
 && 
¡yËToU£
->
htmlHacks
()) {

516 
cÚ‹xt
->
£tSŒokeCŞÜ
(
¡yËToU£
->
vis™edD•’d’tCŞÜ
(
CSSPrİ”tyCŞÜ
), styËToU£->
cŞÜS·û
());

517 
·štDecÜ©iÚ
(
cÚ‹xt
, 
tx
, 
ty
, 
d
, 
‹xtShadow
);

520 ià(
	g·štInfo
.
	gpha£
 =ğ
PaštPha£FÜeground
) {

521 
·štDocum’tM¬k”s
(
cÚ‹xt
, 
tx
, 
ty
, 
¡yËToU£
, 
fÚt
, 
çl£
);

523 ià(
	gu£Cu¡omUnd”lšes
) {

524 cÚ¡ 
	gVeùÜ
<
	gCompos™iÚUnd”lše
>& 
	gund”lšes
 = 
»nd””
()->
docum’t
()->
äame
()->
ed™Ü
()->
cu¡omCompos™iÚUnd”lšes
();

525 
size_t
 
	gnumUnd”lšes
 = 
und”lšes
.
size
();

527 
size_t
 
	gšdex
 = 0; index < 
	gnumUnd”lšes
; ++index) {

528 cÚ¡ 
	gCompos™iÚUnd”lše
& 
	gund”lše
 = 
und”lšes
[
šdex
];

530 ià(
	gund”lše
.
	g’dOff£t
 <ğ
¡¬t
())

536 ià(
	gund”lše
.
	g¡¬tOff£t
 <ğ
’d
()) {

538 
·štCompos™iÚUnd”lše
(
cÚ‹xt
, 
tx
, 
ty
, 
und”lše
);

539 ià(
	gund”lše
.
	g’dOff£t
 > 
’d
() + 1)

550 
	gIÆšeTextBox
::
£ËùiÚS¹End
(& 
sPos
, & 
ePos
)

552 
	g¡¬tPos
, 
	g’dPos
;

553 ià(
»nd””
()->
£ËùiÚS‹
(è=ğ
R’d”Objeù
::
S–eùiÚInside
) {

554 
¡¬tPos
 = 0;

555 
	g’dPos
 = 
‹xtR’d””
()->
‹xtL’gth
();

557 
‹xtR’d””
()->
£ËùiÚS¹End
(
¡¬tPos
, 
’dPos
);

558 ià(
»nd””
()->
£ËùiÚS‹
(è=ğ
R’d”Objeù
::
S–eùiÚS¹
)

559 
’dPos
 = 
‹xtR’d””
()->
‹xtL’gth
();

560 ià(
»nd””
()->
£ËùiÚS‹
(è=ğ
R’d”Objeù
::
S–eùiÚEnd
)

561 
¡¬tPos
 = 0;

564 
	gsPos
 = 
max
(
¡¬tPos
 - 
m_¡¬t
, 0);

565 
	gePos
 = 
mš
(
’dPos
 - 
m_¡¬t
, ()
m_Ën
);

568 
	gIÆšeTextBox
::
·štS–eùiÚ
(
G¿phicsCÚ‹xt
* 
cÚ‹xt
, 
tx
, 
ty
, 
R’d”StyË
* 
¡yË
, cÚ¡ 
FÚt
& 
fÚt
)

571 
	gsPos
, 
	gePos
;

572 
£ËùiÚS¹End
(
sPos
, 
ePos
);

573 ià(
	gsPos
 >ğ
ePos
)

576 
CŞÜ
 
	g‹xtCŞÜ
 = 
¡yË
->
vis™edD•’d’tCŞÜ
(
CSSPrİ”tyCŞÜ
);

577 
CŞÜ
 
	gc
 = 
»nd””
()->
£ËùiÚBackgroundCŞÜ
();

578 ià(!
	gc
.
isV®id
(è|| c.
®pha
() == 0)

583 ià(
	g‹xtCŞÜ
 =ğ
c
)

584 
c
 = 
CŞÜ
(0xfà- c.
»d
(), 0xfà- c.
g»’
(), 0xfà- c.
blue
());

586 
	gcÚ‹xt
->
§ve
();

587 
upd©eG¿phicsCÚ‹xt
(
cÚ‹xt
, 
c
, c, 0, 
¡yË
->
cŞÜS·û
());

588 
	gy
 = 
£ËùiÚTİ
();

589 
	gh
 = 
£ËùiÚHeight
();

592 
	gËngth
 = 
m_ŒunÿtiÚ
 !ğ
cNoTrunÿtiÚ
 ? m_ŒunÿtiÚ : 
m_Ën
;

593 
	gcÚ‹xt
->
ş
(
IÁReù
(
m_x
 + 
tx
, 
y
 + 
ty
, 
m_width
, 
h
));

594 
	gcÚ‹xt
->
d¿wHighlightFÜText
(
fÚt
, 
TextRun
(
‹xtR’d””
()->
‹xt
()->
ch¬aù”s
(è+ 
m_¡¬t
, 
Ëngth
,extR’d””()->
®lowTabs
(), 
‹xtPos
(), 
m_toAdd
,

595 
dœeùiÚ
(è=ğ
RTL
, 
m_dœOv”ride
 || 
¡yË
->
visu®lyOrd”ed
()),

596 
IÁPošt
(
m_x
 + 
tx
, 
y
 + 
ty
), 
h
, 
c
, 
¡yË
->
cŞÜS·û
(), 
sPos
, 
ePos
);

597 
	gcÚ‹xt
->
»¡Üe
();

600 
	gIÆšeTextBox
::
·štCompos™iÚBackground
(
G¿phicsCÚ‹xt
* 
cÚ‹xt
, 
tx
, 
ty
, 
R’d”StyË
* 
¡yË
, cÚ¡ 
FÚt
& 
fÚt
, 
¡¬tPos
, 
’dPos
)

602 
	goff£t
 = 
m_¡¬t
;

603 
	gsPos
 = 
max
(
¡¬tPos
 - 
off£t
, 0);

604 
	gePos
 = 
mš
(
’dPos
 - 
off£t
, ()
m_Ën
);

606 ià(
	gsPos
 >ğ
ePos
)

609 
	gcÚ‹xt
->
§ve
();

611 
CŞÜ
 
	gc
 = Color(225, 221, 85);

613 
upd©eG¿phicsCÚ‹xt
(
cÚ‹xt
, 
c
, c, 0, 
¡yË
->
cŞÜS·û
());

615 
	gy
 = 
£ËùiÚTİ
();

616 
	gh
 = 
£ËùiÚHeight
();

617 
	gcÚ‹xt
->
d¿wHighlightFÜText
(
fÚt
, 
TextRun
(
‹xtR’d””
()->
‹xt
()->
ch¬aù”s
(è+ 
m_¡¬t
, 
m_Ën
,extR’d””()->
®lowTabs
(), 
‹xtPos
(), 
m_toAdd
,

618 
dœeùiÚ
(è=ğ
RTL
, 
m_dœOv”ride
 || 
¡yË
->
visu®lyOrd”ed
()),

619 
IÁPošt
(
m_x
 + 
tx
, 
y
 + 
ty
), 
h
, 
c
, 
¡yË
->
cŞÜS·û
(), 
sPos
, 
ePos
);

620 
	gcÚ‹xt
->
»¡Üe
();

623 #ià
PLATFORM
(
MAC
)

625 
	gIÆšeTextBox
::
·štCu¡omHighlight
(
tx
, 
ty
, cÚ¡ 
AtomicSŒšg
& 
ty³
)

627 
F¿me
* 
	gäame
 = 
»nd””
()->
docum’t
()->
äame
();

628 ià(!
	gäame
)

630 
Page
* 
	g·ge
 = 
äame
->
·ge
();

631 ià(!
	g·ge
)

634 
RoÙIÆšeBox
* 
	gr
 = 
roÙ
();

635 
FlßtReù
 
roÙReù
(
tx
 + 
r
->
x
(), 
ty
 + 
£ËùiÚTİ
(),„->
width
(), 
£ËùiÚHeight
());

636 
FlßtReù
 
‹xtReù
(
tx
 + 
x
(), 
roÙReù
.
y
(), 
width
(),„oÙReù.
height
());

638 
	g·ge
->
chrome
()->
ş›Á
()->
·štCu¡omHighlight
(
»nd””
()->
node
(), 
ty³
, 
‹xtReù
, 
roÙReù
, 
Œue
, 
çl£
);

643 
	gIÆšeTextBox
::
·štDecÜ©iÚ
(
G¿phicsCÚ‹xt
* 
cÚ‹xt
, 
tx
, 
ty
, 
deco
, cÚ¡ 
ShadowD©a
* 
shadow
)

645 
	gtx
 +ğ
m_x
;

646 
	gty
 +ğ
m_y
;

648 ià(
	gm_ŒunÿtiÚ
 =ğ
cFuÎTrunÿtiÚ
)

651 
	gwidth
 = 
m_width
;

652 ià(
	gm_ŒunÿtiÚ
 !ğ
cNoTrunÿtiÚ
) {

653 
width
 = 
toR’d”Text
(
»nd””
())->width(
m_¡¬t
, 
m_ŒunÿtiÚ
, 
‹xtPos
(), 
m_fœ¡Lše
);

654 ià(
dœeùiÚ
(è=ğ
RTL
)

655 
tx
 +ğ(
m_width
 - 
width
);

659 
CŞÜ
 
	gund”lše
, 
	gov”lše
, 
	glš‘hrough
;

660 
»nd””
()->
g‘TextDecÜ©iÚCŞÜs
(
deco
, 
und”lše
, 
ov”lše
, 
lš‘hrough
, 
Œue
);

663 
boŞ
 
	gisPrštšg
 = 
‹xtR’d””
()->
docum’t
()->
´štšg
();

664 
	gcÚ‹xt
->
£tSŒokeThickÃss
(1.0f);

666 
boŞ
 
	glšesA»O·que
 = !
isPrštšg
 && (!(
deco
 & 
UNDERLINE
è|| 
und”lše
.
®pha
(è=ğ255è&& (!(decØ& 
OVERLINE
è|| 
ov”lše
.®pha(è=ğ255è&& (!(decØ& 
LINE_THROUGH
è|| 
lš‘hrough
.alpha() == 255);

668 
	gba£lše
 = 
»nd””
()->
¡yË
(
m_fœ¡Lše
)->
fÚt
().
asûÁ
();

670 
boŞ
 
	g£tCl
 = 
çl£
;

671 
	gexŒaOff£t
 = 0;

672 ià(!
	glšesA»O·que
 && 
	gshadow
 && shadow->
Ãxt
()) {

673 
	gcÚ‹xt
->
§ve
();

674 
IÁReù
 
şReù
(
tx
, 
ty
, 
width
, 
ba£lše
 + 2);

675 cÚ¡ 
ShadowD©a
* 
	gs
 = 
shadow
; s; s = 
s
->
Ãxt
()) {

676 
IÁReù
 
shadowReù
(
tx
, 
ty
, 
width
, 
ba£lše
 + 2);

677 
	gshadowReù
.
šæ©e
(
s
->
blur
());

678 
	gshadowReù
.
move
(
s
->
x
(), s->
y
());

679 
	gşReù
.
un™e
(
shadowReù
);

680 
	gexŒaOff£t
 = 
max
(
exŒaOff£t
, max(0, 
s
->
y
()è+ s->
blur
());

682 
	gcÚ‹xt
->
§ve
();

683 
	gcÚ‹xt
->
ş
(
şReù
);

684 
	gexŒaOff£t
 +ğ
ba£lše
 + 2;

685 
	gty
 +ğ
exŒaOff£t
;

686 
	g£tCl
 = 
Œue
;

689 
CŞÜS·û
 
	gcŞÜS·û
 = 
»nd””
()->
¡yË
()->
cŞÜS·û
();

690 
boŞ
 
	g£tShadow
 = 
çl£
;

693 ià(
	gshadow
) {

694 ià(!
	gshadow
->
Ãxt
()) {

696 
	gty
 -ğ
exŒaOff£t
;

697 
	gexŒaOff£t
 = 0;

699 
	gcÚ‹xt
->
£tShadow
(
IÁSize
(
shadow
->
x
(), shadow->
y
(è- 
exŒaOff£t
), shadow->
blur
(), shadow->
cŞÜ
(), 
cŞÜS·û
);

700 
	g£tShadow
 = 
Œue
;

701 
	gshadow
 = 
shadow
->
Ãxt
();

704 ià(
	gdeco
 & 
	gUNDERLINE
) {

705 
	gcÚ‹xt
->
£tSŒokeCŞÜ
(
und”lše
, 
cŞÜS·û
);

706 
	gcÚ‹xt
->
£tSŒokeStyË
(
SŞidSŒoke
);

708 
	gcÚ‹xt
->
d¿wLšeFÜText
(
IÁPošt
(
tx
, 
ty
 + 
ba£lše
 + 1), 
width
, 
isPrštšg
);

710 ià(
	gdeco
 & 
	gOVERLINE
) {

711 
	gcÚ‹xt
->
£tSŒokeCŞÜ
(
ov”lše
, 
cŞÜS·û
);

712 
	gcÚ‹xt
->
£tSŒokeStyË
(
SŞidSŒoke
);

713 
	gcÚ‹xt
->
d¿wLšeFÜText
(
IÁPošt
(
tx
, 
ty
), 
width
, 
isPrštšg
);

715 ià(
	gdeco
 & 
	gLINE_THROUGH
) {

716 
	gcÚ‹xt
->
£tSŒokeCŞÜ
(
lš‘hrough
, 
cŞÜS·û
);

717 
	gcÚ‹xt
->
£tSŒokeStyË
(
SŞidSŒoke
);

718 
	gcÚ‹xt
->
d¿wLšeFÜText
(
IÁPošt
(
tx
, 
ty
 + 2 * 
ba£lše
 / 3), 
width
, 
isPrštšg
);

720 } 
	gshadow
);

722 ià(
	g£tCl
)

723 
	gcÚ‹xt
->
»¡Üe
();

724 ià(
	g£tShadow
)

725 
	gcÚ‹xt
->
ş—rShadow
();

728 
	gIÆšeTextBox
::
·štS³ÎšgOrG¿mm¬M¬k”
(
G¿phicsCÚ‹xt
* 
±
, 
tx
, 
ty
, cÚ¡ 
Docum’tM¬k”
& 
m¬k”
, 
R’d”StyË
* 
¡yË
, cÚ¡ 
FÚt
& 
fÚt
, 
boŞ
 
g¿mm¬
)

731 ià(
‹xtR’d””
()->
docum’t
()->
´štšg
())

734 ià(
	gm_ŒunÿtiÚ
 =ğ
cFuÎTrunÿtiÚ
)

737 
	g¡¬t
 = 0;

738 
	gwidth
 = 
m_width
;

741 
boŞ
 
	gm¬k”S·nsWhŞeBox
 = 
Œue
;

742 ià(
	gm_¡¬t
 <ğ()
m¬k”
.
¡¬tOff£t
)

743 
m¬k”S·nsWhŞeBox
 = 
çl£
;

744 ià((
’d
(è+ 1è!ğ
m¬k”
.
’dOff£t
)

745 
m¬k”S·nsWhŞeBox
 = 
çl£
;

746 ià(
	gm_ŒunÿtiÚ
 !ğ
cNoTrunÿtiÚ
)

747 
m¬k”S·nsWhŞeBox
 = 
çl£
;

749 ià(!
	gm¬k”S·nsWhŞeBox
 || 
	gg¿mm¬
) {

750 
	g¡¬tPos™iÚ
 = 
max
<>(
m¬k”
.
¡¬tOff£t
 - 
m_¡¬t
, 0);

751 
	g’dPos™iÚ
 = 
mš
<>(
m¬k”
.
’dOff£t
 - 
m_¡¬t
, 
	gm_Ën
);

753 ià(
	gm_ŒunÿtiÚ
 !ğ
cNoTrunÿtiÚ
)

754 
’dPos™iÚ
 = 
mš
<>ÓndPos™iÚ, 
	gm_ŒunÿtiÚ
);

757 
IÁPošt
 
¡¬tPošt
(
tx
 + 
m_x
, 
ty
 + 
£ËùiÚTİ
());

758 
TextRun
 
run
(
‹xtR’d””
()->
‹xt
()->
ch¬aù”s
(è+ 
m_¡¬t
, 
m_Ën
,extR’d””()->
®lowTabs
(), 
‹xtPos
(), 
m_toAdd
, 
dœeùiÚ
(è=ğ
RTL
, 
m_dœOv”ride
 || 
¡yË
->
visu®lyOrd”ed
());

759 
	gh
 = 
£ËùiÚHeight
();

761 
IÁReù
 
	gm¬k”Reù
 = 
’şosšgIÁReù
(
fÚt
.
£ËùiÚReùFÜText
(
run
, 
¡¬tPošt
, 
h
, 
¡¬tPos™iÚ
, 
’dPos™iÚ
));

762 
	g¡¬t
 = 
m¬k”Reù
.
x
(è- 
¡¬tPošt
.x();

763 
	gwidth
 = 
m¬k”Reù
.
width
();

767 ià(
	gg¿mm¬
) {

768 
	gm¬k”Reù
.
move
(-
tx
, -
ty
);

769 
	gm¬k”Reù
 = 
»nd””
()->
loÿlToAbsŞu‹Quad
(
FlßtReù
(
m¬k”Reù
)).
’şosšgBoundšgBox
();

770 
»nd””
()->
docum’t
()->
£tR’d”edReùFÜM¬k”
Ô’d””()->
node
(), 
m¬k”
, 
m¬k”Reù
);

780 
	glšeThickÃss
 = 
cMis¥–lšgLšeThickÃss
;

781 
	gba£lše
 = 
»nd””
()->
¡yË
(
m_fœ¡Lše
)->
fÚt
().
asûÁ
();

782 
	gdesûÁ
 = 
height
(è- 
ba£lše
;

783 
	gund”lšeOff£t
;

784 ià(
	gdesûÁ
 <ğ(2 + 
lšeThickÃss
)) {

786 
und”lšeOff£t
 = 
height
(è- 
lšeThickÃss
;

789 
	gund”lšeOff£t
 = 
ba£lše
 + 2;

791 
	g±
->
d¿wLšeFÜMis¥–lšgOrBadG¿mm¬
(
IÁPošt
(
tx
 + 
m_x
 + 
¡¬t
, 
ty
 + 
m_y
 + 
und”lšeOff£t
), 
width
, 
g¿mm¬
);

794 
	gIÆšeTextBox
::
·štTextM©chM¬k”
(
G¿phicsCÚ‹xt
* 
±
, 
tx
, 
ty
, cÚ¡ 
Docum’tM¬k”
& 
m¬k”
, 
R’d”StyË
* 
¡yË
, cÚ¡ 
FÚt
& 
fÚt
)

798 
	gy
 = 
£ËùiÚTİ
();

799 
	gh
 = 
£ËùiÚHeight
();

801 
	gsPos
 = 
max
(
m¬k”
.
¡¬tOff£t
 - 
m_¡¬t
, ()0);

802 
	gePos
 = 
mš
(
m¬k”
.
’dOff£t
 - 
m_¡¬t
, ()
m_Ën
);

803 
TextRun
 
run
(
‹xtR’d””
()->
‹xt
()->
ch¬aù”s
(è+ 
m_¡¬t
, 
m_Ën
,extR’d””()->
®lowTabs
(), 
‹xtPos
(), 
m_toAdd
, 
dœeùiÚ
(è=ğ
RTL
, 
m_dœOv”ride
 || 
¡yË
->
visu®lyOrd”ed
());

806 
IÁReù
 
	gm¬k”Reù
 = 
’şosšgIÁReù
(
fÚt
.
£ËùiÚReùFÜText
(
run
, 
IÁPošt
(
m_x
, 
y
), 
h
, 
sPos
, 
ePos
));

807 
	gm¬k”Reù
 = 
»nd””
()->
loÿlToAbsŞu‹Quad
(
FlßtReù
(
m¬k”Reù
)).
’şosšgBoundšgBox
();

808 
»nd””
()->
docum’t
()->
£tR’d”edReùFÜM¬k”
Ô’d””()->
node
(), 
m¬k”
, 
m¬k”Reù
);

811 ià(
»nd””
()->
docum’t
()->
äame
()->
m¬kedTextM©chesA»Highligh‹d
()) {

812 
CŞÜ
 
	gcŞÜ
 = 
m¬k”
.
aùiveM©ch
 ?

813 
»nd””
()->
theme
()->
¶©fÜmAùiveTextS—rchHighlightCŞÜ
() :

814 
»nd””
()->
theme
()->
¶©fÜmIÇùiveTextS—rchHighlightCŞÜ
();

815 
	g±
->
§ve
();

816 
upd©eG¿phicsCÚ‹xt
(
±
, 
cŞÜ
, cŞÜ, 0, 
¡yË
->
cŞÜS·û
());

817 
	g±
->
ş
(
IÁReù
(
tx
 + 
m_x
, 
ty
 + 
y
, 
m_width
, 
h
));

818 
	g±
->
d¿wHighlightFÜText
(
fÚt
, 
run
, 
IÁPošt
(
m_x
 + 
tx
, 
y
 + 
ty
), 
h
, 
cŞÜ
, 
¡yË
->
cŞÜS·û
(), 
sPos
, 
ePos
);

819 
	g±
->
»¡Üe
();

823 
	gIÆšeTextBox
::
compu‹ReùFÜR•Ïûm’tM¬k”
(, , cÚ¡ 
Docum’tM¬k”
& 
m¬k”
, 
R’d”StyË
* 
¡yË
, cÚ¡ 
FÚt
& 
fÚt
)

826 
	gy
 = 
£ËùiÚTİ
();

827 
	gh
 = 
£ËùiÚHeight
();

829 
	gsPos
 = 
max
(
m¬k”
.
¡¬tOff£t
 - 
m_¡¬t
, ()0);

830 
	gePos
 = 
mš
(
m¬k”
.
’dOff£t
 - 
m_¡¬t
, ()
m_Ën
);

831 
TextRun
 
run
(
‹xtR’d””
()->
‹xt
()->
ch¬aù”s
(è+ 
m_¡¬t
, 
m_Ën
,extR’d””()->
®lowTabs
(), 
‹xtPos
(), 
m_toAdd
, 
dœeùiÚ
(è=ğ
RTL
, 
m_dœOv”ride
 || 
¡yË
->
visu®lyOrd”ed
());

832 
IÁPošt
 
	g¡¬tPošt
 = IÁPošt(
m_x
, 
y
);

835 
IÁReù
 
	gm¬k”Reù
 = 
’şosšgIÁReù
(
fÚt
.
£ËùiÚReùFÜText
(
run
, 
¡¬tPošt
, 
h
, 
sPos
, 
ePos
));

836 
	gm¬k”Reù
 = 
»nd””
()->
loÿlToAbsŞu‹Quad
(
FlßtReù
(
m¬k”Reù
)).
’şosšgBoundšgBox
();

837 
»nd””
()->
docum’t
()->
£tR’d”edReùFÜM¬k”
Ô’d””()->
node
(), 
m¬k”
, 
m¬k”Reù
);

840 
	gIÆšeTextBox
::
·štDocum’tM¬k”s
(
G¿phicsCÚ‹xt
* 
±
, 
tx
, 
ty
, 
R’d”StyË
* 
¡yË
, cÚ¡ 
FÚt
& 
fÚt
, 
boŞ
 
background
)

842 ià(!
»nd””
()->
node
())

845 
	gVeùÜ
<
	gDocum’tM¬k”
> 
	gm¬k”s
 = 
»nd””
()->
docum’t
()->
m¬k”sFÜNode
Ô’d””()->
node
());

846 
	gVeùÜ
<
	gDocum’tM¬k”
>::
™”©Ü
 
m¬k”It
 = 
m¬k”s
.
begš
();

850  ; 
	gm¬k”It
 !ğ
m¬k”s
.
’d
(); markerIt++) {

851 cÚ¡ 
	gDocum’tM¬k”
& 
	gm¬k”
 = *
m¬k”It
;

854 
	gm¬k”
.
	gty³
) {

855 
	gDocum’tM¬k”
::
G¿mm¬
:

856 
Docum’tM¬k”
::
S³Îšg
:

857 
Docum’tM¬k”
::
R•Ïûm’t
:

858 ià(
background
)

862 
	gDocum’tM¬k”
::
TextM©ch
:

863 ià(!
background
)

868 
ASSERT_NOT_REACHED
();

871 ià(
	gm¬k”
.
	g’dOff£t
 <ğ
¡¬t
())

876 ià(
	gm¬k”
.
	g¡¬tOff£t
 > 
’d
())

881 
	gm¬k”
.
	gty³
) {

882 
	gDocum’tM¬k”
::
S³Îšg
:

883 
·štS³ÎšgOrG¿mm¬M¬k”
(
±
, 
tx
, 
ty
, 
m¬k”
, 
¡yË
, 
fÚt
, 
çl£
);

885 
	gDocum’tM¬k”
::
G¿mm¬
:

886 
·štS³ÎšgOrG¿mm¬M¬k”
(
±
, 
tx
, 
ty
, 
m¬k”
, 
¡yË
, 
fÚt
, 
Œue
);

888 
	gDocum’tM¬k”
::
TextM©ch
:

889 
·štTextM©chM¬k”
(
±
, 
tx
, 
ty
, 
m¬k”
, 
¡yË
, 
fÚt
);

891 
	gDocum’tM¬k”
::
R•Ïûm’t
:

892 
compu‹ReùFÜR•Ïûm’tM¬k”
(
tx
, 
ty
, 
m¬k”
, 
¡yË
, 
fÚt
);

895 
ASSERT_NOT_REACHED
();

902 
	gIÆšeTextBox
::
·štCompos™iÚUnd”lše
(
G¿phicsCÚ‹xt
* 
ùx
, 
tx
, 
ty
, cÚ¡ 
Compos™iÚUnd”lše
& 
und”lše
)

904 
	gtx
 +ğ
m_x
;

905 
	gty
 +ğ
m_y
;

907 ià(
	gm_ŒunÿtiÚ
 =ğ
cFuÎTrunÿtiÚ
)

910 
	g¡¬t
 = 0;

911 
	gwidth
 = 
m_width
;

912 
boŞ
 
	gu£WhŞeWidth
 = 
Œue
;

913 
	g·štS¹
 = 
m_¡¬t
;

914 
	g·štEnd
 = 
’d
() + 1;

915 ià(
	g·štS¹
 <ğ
und”lše
.
¡¬tOff£t
) {

916 
·štS¹
 = 
und”lše
.
¡¬tOff£t
;

917 
	gu£WhŞeWidth
 = 
çl£
;

918 
	g¡¬t
 = 
toR’d”Text
(
»nd””
())->
width
(
m_¡¬t
, 
·štS¹
 - m_¡¬t, 
‹xtPos
(), 
m_fœ¡Lše
);

920 ià(
	g·štEnd
 !ğ
und”lše
.
’dOff£t
) {

921 
·štEnd
 = 
mš
ÕaštEnd, ()
und”lše
.
’dOff£t
);

922 
	gu£WhŞeWidth
 = 
çl£
;

924 ià(
	gm_ŒunÿtiÚ
 !ğ
cNoTrunÿtiÚ
) {

925 
·štEnd
 = 
mš
ÕaštEnd, ()
m_¡¬t
 + 
m_ŒunÿtiÚ
);

926 
	gu£WhŞeWidth
 = 
çl£
;

928 ià(!
	gu£WhŞeWidth
) {

929 
	gwidth
 = 
toR’d”Text
(
»nd””
())->
width
(
·štS¹
, 
·štEnd
 -…aštS¹, 
‹xtPos
(è+ 
¡¬t
, 
m_fœ¡Lše
);

935 
	glšeThickÃss
 = 1;

936 
	gba£lše
 = 
»nd””
()->
¡yË
(
m_fœ¡Lše
)->
fÚt
().
asûÁ
();

937 ià(
	gund”lše
.
	gthick
 && 
height
(è- 
	gba£lše
 >= 2)

938 
lšeThickÃss
 = 2;

942 
	g¡¬t
 += 1;

943 
	gwidth
 -= 2;

945 
	gùx
->
£tSŒokeCŞÜ
(
und”lše
.
cŞÜ
, 
»nd””
()->
¡yË
()->
cŞÜS·û
());

946 
	gùx
->
£tSŒokeThickÃss
(
lšeThickÃss
);

947 
	gùx
->
d¿wLšeFÜText
(
IÁPošt
(
tx
 + 
¡¬t
, 
ty
 + 
height
(è- 
lšeThickÃss
), 
width
, 
‹xtR’d””
()->
docum’t
()->
´štšg
());

950 
	gIÆšeTextBox
::
ÿ»tMšOff£t
() const

952  
m_¡¬t
;

955 
	gIÆšeTextBox
::
ÿ»tMaxOff£t
() const

957  
m_¡¬t
 + 
m_Ën
;

960 
	gIÆšeTextBox
::
ÿ»tMaxR’d”edOff£t
() const

962  
m_¡¬t
 + 
m_Ën
;

965 
	gIÆšeTextBox
::
‹xtPos
() const

967 ià(
x
() == 0)

970 
R’d”Block
* 
	gblockEËm’t
 = 
»nd””
()->
cÚššgBlock
();

971  
dœeùiÚ
(è=ğ
RTL
 ? 
x
(è- 
blockEËm’t
->
bÜd”Right
(è- blockEËm’t->
·ddšgRight
()

972 : 
x
(è- 
blockEËm’t
->
bÜd”Leá
(è- blockEËm’t->
·ddšgLeá
();

975 
	gIÆšeTextBox
::
off£tFÜPos™iÚ
(
_x
, 
boŞ
 
šşudeP¬tŸlGlyphs
) const

977 ià(
isLšeB»ak
())

980 
R’d”Text
* 
	g‹xt
 = 
toR’d”Text
(
»nd””
());

981 
R’d”StyË
* 
	g¡yË
 = 
‹xt
->
¡yË
(
m_fœ¡Lše
);

982 cÚ¡ 
FÚt
* 
	gf
 = &
¡yË
->
fÚt
();

983  
	gf
->
off£tFÜPos™iÚ
(
TextRun
(
‹xtR’d””
()->
‹xt
()->
ch¬aù”s
(è+ 
m_¡¬t
, 
m_Ën
,extR’d””()->
®lowTabs
(), 
‹xtPos
(), 
m_toAdd
, 
dœeùiÚ
(è=ğ
RTL
, 
m_dœOv”ride
 || 
¡yË
->
visu®lyOrd”ed
()),

984 
_x
 - 
m_x
, 
šşudeP¬tŸlGlyphs
);

987 
	gIÆšeTextBox
::
pos™iÚFÜOff£t
(
off£t
) const

989 
ASSERT
(
off£t
 >ğ
m_¡¬t
);

990 
ASSERT
(
off£t
 <ğ
m_¡¬t
 + 
m_Ën
);

992 ià(
isLšeB»ak
())

993  
	gm_x
;

995 
R’d”Text
* 
	g‹xt
 = 
toR’d”Text
(
»nd””
());

996 cÚ¡ 
	gFÚt
& 
	gf
 = 
‹xt
->
¡yË
(
m_fœ¡Lše
)->
fÚt
();

997 
	gäom
 = 
dœeùiÚ
(è=ğ
RTL
 ? 
off£t
 - 
m_¡¬t
 : 0;

998 
	gto
 = 
dœeùiÚ
(è=ğ
RTL
 ? 
m_Ën
 : 
off£t
 - 
m_¡¬t
;

1000  
’şosšgIÁReù
(
f
.
£ËùiÚReùFÜText
(
TextRun
(
‹xt
->‹xt()->
ch¬aù”s
(è+ 
m_¡¬t
, 
m_Ën
, 
‹xtR’d””
()->
®lowTabs
(), 
‹xtPos
(), 
m_toAdd
, 
dœeùiÚ
(è=ğ
RTL
, 
m_dœOv”ride
),

1001 
IÁPošt
(
m_x
, 0), 0, 
äom
, 
to
)).
right
();

1004 
boŞ
 
	gIÆšeTextBox
::
cÚšsC¬‘Off£t
(
off£t
) const

1007 ià(
off£t
 < 
m_¡¬t
)

1008  
çl£
;

1010 
	g·¡End
 = 
m_¡¬t
 + 
m_Ën
;

1013 ià(
	goff£t
 < 
	g·¡End
)

1014  
	gŒue
;

1017 ià(
	goff£t
 > 
	g·¡End
)

1018  
	gçl£
;

1021 ià(
isLšeB»ak
())

1022  
	gçl£
;

1025  
	gŒue
;

1028 
	gIÆšeTextBox
::
£tF®lbackFÚts
(cÚ¡ 
HashS‘
<cÚ¡ 
Sim¶eFÚtD©a
*>& 
çÎbackFÚts
)

1030 ià(!
s_glyphOv”æowAndF®lbackFÚtsM­
)

1031 
s_glyphOv”æowAndF®lbackFÚtsM­
 = 
Ãw
 
GlyphOv”æowAndF®lbackFÚtsM­
;

1033 
	gGlyphOv”æowAndF®lbackFÚtsM­
::
™”©Ü
 
™
 = 
s_glyphOv”æowAndF®lbackFÚtsM­
->
add
(
this
, 
make_·œ
(
VeùÜ
<cÚ¡ 
Sim¶eFÚtD©a
*>(), 
GlyphOv”æow
())).
	gfœ¡
;

1034 
ASSERT
(
™
->
£cÚd
.
fœ¡
.
isEm±y
());

1035 
cİyToVeùÜ
(
çÎbackFÚts
, 
™
->
£cÚd
.
fœ¡
);

1038 
	gVeùÜ
<cÚ¡ 
	gSim¶eFÚtD©a
*>* 
	gIÆšeTextBox
::
çÎbackFÚts
() const

1040 ià(!
s_glyphOv”æowAndF®lbackFÚtsM­
)

1043 
	gGlyphOv”æowAndF®lbackFÚtsM­
::
™”©Ü
 
™
 = 
s_glyphOv”æowAndF®lbackFÚtsM­
->
fšd
(
this
);

1044 ià(
	g™
 =ğ
s_glyphOv”æowAndF®lbackFÚtsM­
->
’d
())

1047  &
	g™
->
	g£cÚd
.
	gfœ¡
;

1050 
	gIÆšeTextBox
::
GlyphOv”æowAndF®lbackFÚtsM­
* 
IÆšeTextBox
::
s_glyphOv”æowAndF®lbackFÚtsM­
 = 0;

1052 
	gIÆšeTextBox
::
£tGlyphOv”æow
(cÚ¡ 
GlyphOv”æow
& 
glyphOv”æow
)

1054 ià(!
s_glyphOv”æowAndF®lbackFÚtsM­
)

1055 
s_glyphOv”æowAndF®lbackFÚtsM­
 = 
Ãw
 
GlyphOv”æowAndF®lbackFÚtsM­
;

1057 
	gGlyphOv”æowAndF®lbackFÚtsM­
::
™”©Ü
 
™
 = 
s_glyphOv”æowAndF®lbackFÚtsM­
->
add
(
this
, 
make_·œ
(
VeùÜ
<cÚ¡ 
Sim¶eFÚtD©a
*>(), 
GlyphOv”æow
())).
	gfœ¡
;

1058 
	g™
->
	g£cÚd
.£cÚd = 
glyphOv”æow
;

1061 
GlyphOv”æow
* 
	gIÆšeTextBox
::
glyphOv”æow
() const

1063 ià(!
s_glyphOv”æowAndF®lbackFÚtsM­
)

1065 
	gGlyphOv”æowAndF®lbackFÚtsM­
::
™”©Ü
 
™
 = 
s_glyphOv”æowAndF®lbackFÚtsM­
->
fšd
(
this
);

1066 ià(
	g™
 =ğ
s_glyphOv”æowAndF®lbackFÚtsM­
->
’d
())

1069  &
	g™
->
	g£cÚd
.second;

	@InlineTextBox.h

23 #iâdeà
IÆšeTextBox_h


24 
	#IÆšeTextBox_h


	)

26 
	~"IÆšeBox.h
"

27 
	~"R’d”Text.h
"

29 
Çme¥aû
 
	gWebCÜe
 {

31 
	gCompos™iÚUnd”lše
;

33 cÚ¡ 
	gcNoTrunÿtiÚ
 = 
USHRT_MAX
;

34 cÚ¡ 
	gcFuÎTrunÿtiÚ
 = 
USHRT_MAX
 - 1;

37 
upd©eG¿phicsCÚ‹xt
(
G¿phicsCÚ‹xt
*, cÚ¡ 
CŞÜ
& 
flCŞÜ
, cÚ¡ CŞÜ& 
¡rokeCŞÜ
, 
¡rokeThickÃss
, 
CŞÜS·û
);

38 
CŞÜ
 
cÜ»ùedTextCŞÜ
(CŞÜ 
‹xtCŞÜ
, CŞÜ 
backgroundCŞÜ
);

40 şas 
	cIÆšeTextBox
 : 
public
 
IÆšeBox
 {

41 
public
:

42 
IÆšeTextBox
(
R’d”Objeù
* 
obj
)

43 : 
IÆšeBox
(
obj
)

44 , 
m_´evTextBox
(0)

45 , 
m_ÃxtTextBox
(0)

46 , 
m_¡¬t
(0)

47 , 
m_Ën
(0)

48 , 
m_ŒunÿtiÚ
(
cNoTrunÿtiÚ
)

52 
IÆšeTextBox
* 
´evTextBox
(ècÚ¡ {  
	gm_´evTextBox
; }

53 
IÆšeTextBox
* 
ÃxtTextBox
(ècÚ¡ {  
	gm_ÃxtTextBox
; }

54 
£tNextTextBox
(
IÆšeTextBox
* 
n
è{ 
	gm_ÃxtTextBox
 =‚; }

55 
£tP»viousTextBox
(
IÆšeTextBox
* 
p
è{ 
	gm_´evTextBox
 =…; }

57 
¡¬t
(ècÚ¡ {  
	gm_¡¬t
; }

58 
’d
(ècÚ¡ {  
	gm_Ën
 ? 
	gm_¡¬t
 + m_ËÀ- 1 : 
m_¡¬t
; }

59 
Ën
(ècÚ¡ {  
	gm_Ën
; }

61 
£tS¹
(
¡¬t
è{ 
	gm_¡¬t
 = start; }

62 
£tL’
(
Ën
è{ 
	gm_Ën
 =†en; }

64 
off£tRun
(
d
è{ 
	gm_¡¬t
 += d; }

66 
£tF®lbackFÚts
(cÚ¡ 
HashS‘
<cÚ¡ 
Sim¶eFÚtD©a
*>&);

67 
	gVeùÜ
<cÚ¡ 
	gSim¶eFÚtD©a
*>* 
çÎbackFÚts
() const;

69 
£tGlyphOv”æow
(cÚ¡ 
GlyphOv”æow
&);

70 
GlyphOv”æow
* 
glyphOv”æow
() const;

72 
ş—rGlyphOv”æowAndF®lbackFÚtM­
()

74 ià(
	gs_glyphOv”æowAndF®lbackFÚtsM­
)

75 
	gs_glyphOv”æowAndF®lbackFÚtsM­
->
ş—r
();

78 
ŒunÿtiÚ
(è{  
	gm_ŒunÿtiÚ
; }

80 
	g´iv©e
:

81 
vœtu®
 
£ËùiÚTİ
();

82 
vœtu®
 
£ËùiÚHeight
();

84 
	gpublic
:

85 
vœtu®
 
IÁReù
 
£ËùiÚReù
(
absx
, 
absy
, 
¡¬tPos
, 
’dPos
);

86 
boŞ
 
isS–eùed
(
¡¬tPos
, 
’dPos
) const;

87 
£ËùiÚS¹End
(& 
sPos
, & 
ePos
);

89 
	g´iv©e
:

90 
vœtu®
 
·št
(
R’d”Objeù
::
PaštInfo
&, 
tx
, 
ty
);

91 
vœtu®
 
boŞ
 
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, 
x
, 
y
, 
tx
, 
ty
);

93 
	gpublic
:

94 
R’d”Text
* 
‹xtR’d””
() const;

96 
	g´iv©e
:

97 
vœtu®
 
d–‘eLše
(
R’d”A»Ç
*);

98 
vœtu®
 
exŒaùLše
();

99 
vœtu®
 
©chLše
();

101 
	gpublic
:

102 
vœtu®
 
R’d”Objeù
::
S–eùiÚS‹
 
£ËùiÚS‹
();

104 
	g´iv©e
:

105 
vœtu®
 
ş—rTrunÿtiÚ
(è{ 
m_ŒunÿtiÚ
 = 
cNoTrunÿtiÚ
; }

106 
vœtu®
 
¶aûEÎsisBox
(
boŞ
 
æowIsLTR
, 
visibËLeáEdge
, 
visibËRightEdge
, 
–lsisWidth
, boŞ& 
foundBox
);

108 
	gpublic
:

109 
vœtu®
 
boŞ
 
isLšeB»ak
() const;

111 
£tS·ûAdd
(
add
è{ 
	gm_width
 -ğ
m_toAdd
; 
	gm_toAdd
 =‡dd; m_width += m_toAdd; }

113 
	g´iv©e
:

114 
vœtu®
 
boŞ
 
isIÆšeTextBox
(è{  
Œue
; }

116 
	gpublic
:

117 
vœtu®
 
ÿ»tMšOff£t
() const;

118 
vœtu®
 
ÿ»tMaxOff£t
() const;

120 
	g´iv©e
:

121 
vœtu®
 
ÿ»tMaxR’d”edOff£t
() const;

123 
‹xtPos
() const;

125 
	gpublic
:

126 
vœtu®
 
off£tFÜPos™iÚ
(
x
, 
boŞ
 
šşudeP¬tŸlGlyphs
 = 
Œue
) const;

127 
vœtu®
 
pos™iÚFÜOff£t
(
off£t
) const;

129 
boŞ
 
cÚšsC¬‘Off£t
(
off£t
) const;

131 
	g´iv©e
:

132 
IÆšeTextBox
* 
m_´evTextBox
;

133 
IÆšeTextBox
* 
	gm_ÃxtTextBox
;

135 
	gm_¡¬t
;

136 
	gm_Ën
;

138 
	gm_ŒunÿtiÚ
;

141 
	gHashM­
<cÚ¡ 
	tIÆšeTextBox
*, 
	t·œ
<
	tVeùÜ
<cÚ¡ 
	tSim¶eFÚtD©a
*>, 
	tGlyphOv”æow
> > 
	tGlyphOv”æowAndF®lbackFÚtsM­
;

142 
GlyphOv”æowAndF®lbackFÚtsM­
* 
	gs_glyphOv”æowAndF®lbackFÚtsM­
;

144 
	g´Ùeùed
:

145 
·štCompos™iÚBackground
(
G¿phicsCÚ‹xt
*, 
tx
, 
ty
, 
R’d”StyË
*, cÚ¡ 
FÚt
&, 
¡¬tPos
, 
’dPos
);

146 
·štDocum’tM¬k”s
(
G¿phicsCÚ‹xt
*, 
tx
, 
ty
, 
R’d”StyË
*, cÚ¡ 
FÚt
&, 
boŞ
 
background
);

147 
·štCompos™iÚUnd”lše
(
G¿phicsCÚ‹xt
*, 
tx
, 
ty
, cÚ¡ 
Compos™iÚUnd”lše
&);

148 #ià
PLATFORM
(
MAC
)

149 
·štCu¡omHighlight
(
tx
, 
ty
, cÚ¡ 
AtomicSŒšg
& 
ty³
);

152 
	g´iv©e
:

153 
·štDecÜ©iÚ
(
G¿phicsCÚ‹xt
*, 
tx
, 
ty
, 
decÜ©iÚ
, cÚ¡ 
ShadowD©a
*);

154 
·štS–eùiÚ
(
G¿phicsCÚ‹xt
*, 
tx
, 
ty
, 
R’d”StyË
*, cÚ¡ 
FÚt
&);

155 
·štS³ÎšgOrG¿mm¬M¬k”
(
G¿phicsCÚ‹xt
*, 
tx
, 
ty
, cÚ¡ 
Docum’tM¬k”
&, 
R’d”StyË
*, cÚ¡ 
FÚt
&, 
boŞ
 
g¿mm¬
);

156 
·štTextM©chM¬k”
(
G¿phicsCÚ‹xt
*, 
tx
, 
ty
, cÚ¡ 
Docum’tM¬k”
&, 
R’d”StyË
*, cÚ¡ 
FÚt
&);

157 
compu‹ReùFÜR•Ïûm’tM¬k”
(
tx
, 
ty
, cÚ¡ 
Docum’tM¬k”
&, 
R’d”StyË
*, cÚ¡ 
FÚt
&);

160 
šlše
 
R’d”Text
* 
	gIÆšeTextBox
::
	$‹xtR’d””
() const

162  
	`toR’d”Text
(
	`»nd””
());

163 
	}
}

	@LayoutState.cpp

26 
	~"cÚfig.h
"

27 
	~"LayoutS‹.h
"

29 
	~"R’d”A»Ç.h
"

30 
	~"R’d”IÆše.h
"

31 
	~"R’d”Lay”.h
"

32 
	~"R’d”V›w.h
"

34 
Çme¥aû
 
	gWebCÜe
 {

36 
	gLayoutS‹
::
LayoutS‹
(LayoutS‹* 
´ev
, 
R’d”Box
* 
»nd””
, cÚ¡ 
IÁSize
& 
off£t
)

37 : 
m_Ãxt
(
´ev
)

38 #iâdeà
NDEBUG


39 , 
m_»nd””
(
»nd””
)

42 
ASSERT
(
m_Ãxt
);

44 
boŞ
 
	gfixed
 = 
»nd””
->
isPos™iÚed
(è&&„’d””->
¡yË
()->
pos™iÚ
(è=ğ
FixedPos™iÚ
;

45 ià(
	gfixed
) {

47 
FlßtPošt
 
	gfixedOff£t
 = 
»nd””
->
v›w
()->
loÿlToAbsŞu‹
(FlßtPošt(), 
Œue
);

48 
	gm_off£t
 = 
IÁSize
(
fixedOff£t
.
x
(), fixedOff£t.
y
()è+ 
	goff£t
;

50 
	gm_off£t
 = 
´ev
->
m_off£t
 + 
off£t
;

52 ià(
	g»nd””
->
isR–Pos™iÚed
()) {

53 ià(
	g»nd””
->
hasLay”
())

54 
	gm_off£t
 +ğ
»nd””
->
Ïy”
()->
»ÏtivePos™iÚOff£t
();

55 } ià(
	g»nd””
->
isPos™iÚed
(è&& !
	gfixed
) {

56 ià(
R’d”Objeù
* 
	gcÚš”
 = 
»nd””
->
cÚš”
()) {

57 ià(
cÚš”
->
isR–Pos™iÚed
(è&& cÚš”->
isR’d”IÆše
())

58 
m_off£t
 +ğ
toR’d”IÆše
(
cÚš”
)->
»ÏtivePos™iÚedIÆšeOff£t
(
»nd””
);

62 
	gm_ş³d
 = !
fixed
 && 
´ev
->
m_ş³d
;

63 ià(
	gm_ş³d
)

64 
	gm_şReù
 = 
´ev
->
m_şReù
;

66 ià(
	g»nd””
->
hasOv”æowCl
()) {

67 
R’d”Lay”
* 
	gÏy”
 = 
»nd””
->
Ïy”
();

68 
IÁReù
 
şReù
(
toPošt
(
m_off£t
è+ 
»nd””
->
v›w
()->
ÏyoutD–
(), 
Ïy”
->
size
());

69 ià(
	gm_ş³d
)

70 
	gm_şReù
.
š‹r£ù
(
şReù
);

72 
	gm_şReù
 = 
şReù
;

73 
	gm_ş³d
 = 
Œue
;

75 
	gm_off£t
 -ğ
Ïy”
->
süŞËdCÚ‹ÁOff£t
();

78 
	gm_ÏyoutD–
 = 
m_Ãxt
->
m_ÏyoutD–
;

83 
	gLayoutS‹
::
LayoutS‹
(
R’d”Objeù
* 
roÙ
)

84 : 
m_ş³d
(
çl£
)

85 , 
m_Ãxt
(0)

86 #iâdeà
NDEBUG


87 , 
m_»nd””
(
roÙ
)

90 
R’d”Objeù
* 
	gcÚš”
 = 
roÙ
->
cÚš”
();

91 
FlßtPošt
 
	gabsCÚ‹ÁPošt
 = 
cÚš”
->
loÿlToAbsŞu‹
(FlßtPošt(), 
çl£
, 
Œue
);

92 
	gm_off£t
 = 
IÁSize
(
absCÚ‹ÁPošt
.
x
(),‡bsCÚ‹ÁPošt.
y
());

95 #iâdeà
NDEBUG


96 
boŞ
 
	gšLayoutS‹De¡roy
;

99 
	gLayoutS‹
::
de¡roy
(
R’d”A»Ç
* 
»nd”A»Ç
)

101 #iâdeà
NDEBUG


102 
šLayoutS‹De¡roy
 = 
Œue
;

104 
d–‘e
 
	gthis
;

105 #iâdeà
NDEBUG


106 
	gšLayoutS‹De¡roy
 = 
çl£
;

108 
	g»nd”A»Ç
->
ä“
(*(
size_t
*)
this
,his);

111 * 
	gLayoutS‹
::
İ”©Ü
 
Ãw
(
size_t
 
sz
, 
R’d”A»Ç
* 
»nd”A»Ç
è
throw
()

113  
	g»nd”A»Ç
->
®loÿ‹
(
sz
);

116 
	gLayoutS‹
::
İ”©Ü
 
d–‘e
(* 
±r
, 
size_t
 
sz
)

118 
ASSERT
(
šLayoutS‹De¡roy
);

119 *(
	gsize_t
*)
	g±r
 = 
sz
;

	@LayoutState.h

26 #iâdeà
LayoutS‹_h


27 
	#LayoutS‹_h


	)

29 
	~"IÁReù.h
"

30 
	~"IÁSize.h
"

31 
	~<wtf/NÚcİyabË.h
>

33 
Çme¥aû
 
	gWebCÜe
 {

35 
şass
 
	gR’d”A»Ç
;

36 
şass
 
	gR’d”Box
;

37 
şass
 
	gR’d”Objeù
;

39 şas 
	cLayoutS‹
 : 
public
 
NÚcİyabË
 {

40 
public
:

41 
LayoutS‹
()

42 : 
m_ş³d
(
çl£
)

43 , 
m_Ãxt
(0)

44 #iâdeà
NDEBUG


45 , 
m_»nd””
(0)

50 
LayoutS‹
(LayoutS‹*, 
R’d”Box
*, cÚ¡ 
IÁSize
& 
off£t
);

51 
LayoutS‹
(
R’d”Objeù
*);

53 
de¡roy
(
R’d”A»Ç
*);

56 * 
İ”©Ü
 
Ãw
(
size_t
, 
R’d”A»Ç
*è
throw
();

59 
İ”©Ü
 
d–‘e
(*, 
size_t
);

61 
	g´iv©e
:

63 * 
İ”©Ü
 
Ãw
(
size_t
è
throw
();

65 
	gpublic
:

66 
boŞ
 
m_ş³d
;

67 
IÁReù
 
	gm_şReù
;

68 
IÁSize
 
	gm_off£t
;

69 
IÁSize
 
	gm_ÏyoutD–
;

72 
LayoutS‹
* 
	gm_Ãxt
;

73 #iâdeà
NDEBUG


74 
R’d”Objeù
* 
	gm_»nd””
;

	@MediaControlElements.cpp

29 
	~"cÚfig.h
"

31 #ià
ENABLE
(
VIDEO
)

33 
	~"MedŸCÚŒŞEËm’ts.h
"

35 
	~"Ev’tNames.h
"

36 
	~"FlßtCÚv”siÚ.h
"

37 
	~"F¿me.h
"

38 
	~"HTMLNames.h
"

39 
	~"LoÿlizedSŒšgs.h
"

40 
	~"Mou£Ev’t.h
"

41 
	~"Page.h
"

42 
	~"R’d”MedŸ.h
"

43 
	~"R’d”Slid”.h
"

44 
	~"R’d”Theme.h
"

46 
Çme¥aû
 
	gWebCÜe
 {

48 
usšg
 
Çme¥aû
 
	gHTMLNames
;

50 
HTMLMedŸEËm’t
* 
toP¬’tMedŸEËm’t
(
R’d”Objeù
* 
o
)

52 
Node
* 
	gnode
 = 
o
->
node
();

53 
Node
* 
	gmedŸNode
 = 
node
 ?‚ode->
shadowAnû¡ÜNode
() : 0;

54 ià(!
	gmedŸNode
 || (!medŸNode->
hasTagName
(
HTMLNames
::
videoTag
è&& !
medŸNode
->hasTagName(HTMLNames::
audioTag
)))

57  
	g¡©ic_ÿ¡
<
	gHTMLMedŸEËm’t
*>(
	gmedŸNode
);

61 cÚ¡ 
	gcS“kR•—tD–ay
 = 0.1f;

62 cÚ¡ 
	gcS‹pTime
 = 0.07f;

63 cÚ¡ 
	gcS“kTime
 = 0.2f;

65 
	gMedŸCÚŒŞShadowRoÙEËm’t
::
MedŸCÚŒŞShadowRoÙEËm’t
(
Docum’t
* 
docum’t
, 
HTMLMedŸEËm’t
* 
medŸEËm’t
)

66 : 
HTMLDivEËm’t
(
divTag
, 
docum’t
)

67 , 
m_medŸEËm’t
(
medŸEËm’t
)

69 
	gRefPŒ
<
	gR’d”StyË
> 
	groÙStyË
 = 
R’d”StyË
::
ü—‹
();

70 
	groÙStyË
->
šh”™From
(
medŸEËm’t
->
»nd””
()->
¡yË
());

71 
	groÙStyË
->
£tDi¥Ïy
(
BLOCK
);

72 
	groÙStyË
->
£tPos™iÚ
(
R–©ivePos™iÚ
);

73 
R’d”MedŸCÚŒŞShadowRoÙ
* 
	g»nd””
 = 
Ãw
 (
medŸEËm’t
->
»nd””
()->
»nd”A»Ç
()èR’d”MedŸCÚŒŞShadowRoÙ(
this
);

74 
	g»nd””
->
£tStyË
(
roÙStyË
.
»Ëa£
());

75 
£tR’d””
(
»nd””
);

76 
£tA‰ached
();

77 
£tInDocum’t
(
Œue
);

80 
	gMedŸCÚŒŞShadowRoÙEËm’t
::
upd©eStyË
()

82 ià(
»nd””
()) {

83 
R’d”StyË
* 
tim–šeCÚš”StyË
 = 
m_medŸEËm’t
->
»nd””
()->
g‘CachedP£udoStyË
(
MEDIA_CONTROLS_TIMELINE_CONTAINER
);

84 
»nd””
()->
£tStyË
(
tim–šeCÚš”StyË
);

90 
	gMedŸCÚŒŞEËm’t
::
MedŸCÚŒŞEËm’t
(
Docum’t
* 
docum’t
, 
P£udoId
 
p£udo
, 
HTMLMedŸEËm’t
* 
medŸEËm’t
)

91 : 
HTMLDivEËm’t
(
divTag
, 
docum’t
)

92 , 
m_medŸEËm’t
(
medŸEËm’t
)

93 , 
m_p£udoStyËId
(
p£udo
)

95 
£tInDocum’t
(
Œue
);

96 
	gp£udo
) {

97 
	gMEDIA_CONTROLS_CURRENT_TIME_DISPLAY
:

98 
m_di¥ÏyTy³
 = 
MedŸCu¼’tTimeDi¥Ïy
;

100 
	gMEDIA_CONTROLS_TIME_REMAINING_DISPLAY
:

101 
m_di¥ÏyTy³
 = 
MedŸTimeRemaššgDi¥Ïy
;

103 
	gMEDIA_CONTROLS_TIMELINE_CONTAINER
:

104 
m_di¥ÏyTy³
 = 
MedŸTim–šeCÚš”
;

106 
	gMEDIA_CONTROLS_STATUS_DISPLAY
:

107 
m_di¥ÏyTy³
 = 
MedŸStusDi¥Ïy
;

109 
	gMEDIA_CONTROLS_PANEL
:

110 
m_di¥ÏyTy³
 = 
MedŸCÚŒŞsPª–
;

112 
	gMEDIA_CONTROLS_VOLUME_SLIDER_CONTAINER
:

113 
m_di¥ÏyTy³
 = 
MedŸVŞumeSlid”CÚš”
;

116 
ASSERT_NOT_REACHED
();

121 
	gMedŸCÚŒŞEËm’t
::
©chToP¬’t
(
EËm’t
* 
·»Á
)

123 
·»Á
->
addChd
(
this
);

126 
	gMedŸCÚŒŞEËm’t
::
upd©e
()

128 ià(
»nd””
())

129 
»nd””
()->
upd©eFromEËm’t
();

130 
upd©eStyË
();

133 
	gPassRefPŒ
<
	gR’d”StyË
> 
	gMedŸCÚŒŞEËm’t
::
¡yËFÜEËm’t
()

135 
R’d”StyË
* 
¡yË
 = 
m_medŸEËm’t
->
»nd””
()->
g‘CachedP£udoStyË
(
m_p£udoStyËId
);

136 ià(!
	g¡yË
)

141 
	g¡yË
->
£tTextDecÜ©iÚ
(
TDNONE
);

142 
	g¡yË
->
£tTextDecÜ©iÚsInEfãù
(
TDNONE
);

144  
	g¡yË
;

147 
boŞ
 
	gMedŸCÚŒŞEËm’t
::
»nd””IsN“ded
(
R’d”StyË
* 
¡yË
)

149 
ASSERT
(
docum’t
()->
·ge
());

151  
	gHTMLDivEËm’t
::
»nd””IsN“ded
(
¡yË
è&& 
·»Á
(è&&…¬’t()->
»nd””
()

152 && (!
¡yË
->
hasAµ—¿nû
(è|| 
docum’t
()->
·ge
()->
theme
()->
shouldR’d”MedŸCÚŒŞP¬t
(¡yË->
­³¬ªû
(), 
m_medŸEËm’t
));

155 
	gMedŸCÚŒŞEËm’t
::
©ch
()

157 
RefPŒ
<
R’d”StyË
> 
¡yË
 = 
¡yËFÜEËm’t
();

158 ià(!
	g¡yË
)

160 
boŞ
 
	gÃedsR’d””
 = 
»nd””IsN“ded
(
¡yË
.
g‘
());

161 ià(!
	gÃedsR’d””
)

163 
R’d”Objeù
* 
	g»nd””
 = 
ü—‹R’d””
(
m_medŸEËm’t
->
»nd””
()->
»nd”A»Ç
(), 
¡yË
.
g‘
());

164 ià(!
	g»nd””
)

166 
	g»nd””
->
£tStyË
(
¡yË
.
g‘
());

167 
£tR’d””
(
»nd””
);

168 ià(
·»Á
(è&&…¬’t()->
»nd””
()) {

170 
Node
* 
	gsiblšg
 = 
ÃxtSiblšg
();

171 
	gsiblšg
 && !siblšg->
»nd””
())

172 
	gsiblšg
 = 
siblšg
->
ÃxtSiblšg
();

173 
·»Á
()->
»nd””
()->
addChd
Ô’d””, 
siblšg
 ? sibling->renderer() : 0);

175 
	gCÚš”Node
::
©ch
();

178 
	gMedŸCÚŒŞEËm’t
::
upd©eStyË
()

180 ià(!
m_medŸEËm’t
 || !m_medŸEËm’t->
»nd””
())

183 
	gRefPŒ
<
	gR’d”StyË
> 
	g¡yË
 = 
¡yËFÜEËm’t
();

184 ià(!
	g¡yË
)

187 
boŞ
 
	gÃedsR’d””
 = 
»nd””IsN“ded
(
¡yË
.
g‘
()è&& 
·»Á
(è&&…¬’t()->
»nd””
();

188 ià(
»nd””
(è&& !
	gÃedsR’d””
)

189 
d‘ach
();

190 ià(!
»nd””
(è&& 
	gÃedsR’d””
)

191 
©ch
();

192 ià(
»nd””
()) {

193 
»nd””
()->
£tStyË
(
¡yË
.
g‘
());

196 ià(
fœ¡Chd
(è&& fœ¡Chd()->
»nd””
())

197 
fœ¡Chd
()->
»nd””
()->
£tStyË
(
¡yË
.
g‘
());

203 
	gMedŸCÚŒŞTim–šeCÚš”EËm’t
::
MedŸCÚŒŞTim–šeCÚš”EËm’t
(
Docum’t
* 
docum’t
, 
HTMLMedŸEËm’t
* 
–em’t
)

204 : 
MedŸCÚŒŞEËm’t
(
docum’t
, 
MEDIA_CONTROLS_TIMELINE_CONTAINER
, 
–em’t
)

208 
boŞ
 
	gMedŸCÚŒŞTim–šeCÚš”EËm’t
::
»nd””IsN“ded
(
R’d”StyË
* 
¡yË
)

210 ià(!
MedŸCÚŒŞEËm’t
::
»nd””IsN“ded
(
¡yË
))

211  
çl£
;

216 ià(!
	gm_medŸEËm’t
->
»nd””
()->
g‘CachedP£udoStyË
(
MEDIA_CONTROLS_STATUS_DISPLAY
))

217  
	gŒue
;

219 
	gdu¿tiÚ
 = 
m_medŸEËm’t
->
du¿tiÚ
();

220  !
i¢ª
(
du¿tiÚ
è&& !
isšf
(duration);

225 
	gMedŸCÚŒŞVŞumeSlid”CÚš”EËm’t
::
MedŸCÚŒŞVŞumeSlid”CÚš”EËm’t
(
Docum’t
* 
doc
, 
HTMLMedŸEËm’t
* 
–em’t
)

226 : 
MedŸCÚŒŞEËm’t
(
doc
, 
MEDIA_CONTROLS_VOLUME_SLIDER_CONTAINER
, 
–em’t
)

227 , 
m_isVisibË
(
çl£
)

228 , 
m_x
(0)

229 , 
m_y
(0)

233 
	gPassRefPŒ
<
	gR’d”StyË
> 
	gMedŸCÚŒŞVŞumeSlid”CÚš”EËm’t
::
¡yËFÜEËm’t
()

235 
RefPŒ
<
R’d”StyË
> 
¡yË
 = 
MedŸCÚŒŞEËm’t
::
¡yËFÜEËm’t
();

236 
	g¡yË
->
£tPos™iÚ
(
AbsŞu‹Pos™iÚ
);

237 
	g¡yË
->
£tLeá
(
L’gth
(
m_x
, 
Fixed
));

238 
	g¡yË
->
£tTİ
(
L’gth
(
m_y
, 
Fixed
));

239 
	g¡yË
->
£tDi¥Ïy
(
m_isVisibË
 ? 
BLOCK
 : 
NONE
);

240  
	g¡yË
;

243 
	gMedŸCÚŒŞVŞumeSlid”CÚš”EËm’t
::
£tVisibË
(
boŞ
 
visibË
)

245 ià(
visibË
 =ğ
m_isVisibË
)

247 
	gm_isVisibË
 = 
visibË
;

250 
	gMedŸCÚŒŞVŞumeSlid”CÚš”EËm’t
::
£tPos™iÚ
(
x
, 
y
)

252 ià(
	gx
 =ğ
m_x
 && 
y
 =ğ
m_y
)

254 
	gm_x
 = 
x
;

255 
	gm_y
 = 
y
;

258 
boŞ
 
	gMedŸCÚŒŞVŞumeSlid”CÚš”EËm’t
::
h™Te¡
(cÚ¡ 
IÁPošt
& 
absPošt
)

260 ià(
»nd””
(è&&„’d””()->
¡yË
()->
hasAµ—¿nû
())

261  
»nd””
()->
theme
()->
h™Te¡MedŸCÚŒŞP¬t
Ô’d””(), 
absPošt
);

263  
	gçl£
;

268 
	gMedŸCÚŒŞStusDi¥ÏyEËm’t
::
MedŸCÚŒŞStusDi¥ÏyEËm’t
(
Docum’t
* 
docum’t
, 
HTMLMedŸEËm’t
* 
–em’t
)

269 : 
MedŸCÚŒŞEËm’t
(
docum’t
, 
MEDIA_CONTROLS_STATUS_DISPLAY
, 
–em’t
)

270 , 
m_¡©eBešgDi¥Ïyed
(
NÙhšg
)

274 
	gMedŸCÚŒŞStusDi¥ÏyEËm’t
::
upd©e
()

276 
MedŸCÚŒŞEËm’t
::
upd©e
();

279 
S‹BešgDi¥Ïyed
 
	gÃwS‹ToDi¥Ïy
 = 
NÙhšg
;

281 ià(
	gm_medŸEËm’t
->
»adyS‹
(è!ğ
HTMLMedŸEËm’t
::
HAVE_ENOUGH_DATA
 && !
m_medŸEËm’t
->
cu¼’tSrc
().
isEm±y
())

282 
ÃwS‹ToDi¥Ïy
 = 
Lßdšg
;

283 ià(
	gm_medŸEËm’t
->
mov›LßdTy³
(è=ğ
MedŸPÏy”
::
LiveSŒ—m
)

284 
ÃwS‹ToDi¥Ïy
 = 
LiveBrßdÿ¡
;

287 ià(
	gÃwS‹ToDi¥Ïy
 =ğ
m_¡©eBešgDi¥Ïyed
)

289 
	gm_¡©eBešgDi¥Ïyed
 = 
ÃwS‹ToDi¥Ïy
;

291 
Exû±iÚCode
 
	ge
;

292 
	gm_¡©eBešgDi¥Ïyed
) {

293 
	gNÙhšg
:

294 
£tIÂ”Text
("", 
e
);

296 
	gLßdšg
:

297 
£tIÂ”Text
(
medŸEËm’tLßdšgS‹Text
(), 
e
);

299 
	gLiveBrßdÿ¡
:

300 
£tIÂ”Text
(
medŸEËm’tLiveBrßdÿ¡S‹Text
(), 
e
);

305 
boŞ
 
	gMedŸCÚŒŞStusDi¥ÏyEËm’t
::
»nd””IsN“ded
(
R’d”StyË
* 
¡yË
)

307 ià(!
MedŸCÚŒŞEËm’t
::
»nd””IsN“ded
(
¡yË
))

308  
çl£
;

309 
	gdu¿tiÚ
 = 
m_medŸEËm’t
->
du¿tiÚ
();

310  (
i¢ª
(
du¿tiÚ
è|| 
isšf
(duration));

315 
	gMedŸCÚŒŞIÅutEËm’t
::
MedŸCÚŒŞIÅutEËm’t
(
Docum’t
* 
docum’t
, 
P£udoId
 
p£udo
, cÚ¡ 
SŒšg
& 
ty³
, 
HTMLMedŸEËm’t
* 
medŸEËm’t
)

316 : 
HTMLIÅutEËm’t
(
šputTag
, 
docum’t
)

317 , 
m_medŸEËm’t
(
medŸEËm’t
)

318 , 
m_p£udoStyËId
(
p£udo
)

320 
£tIÅutTy³
(
ty³
);

321 
£tInDocum’t
(
Œue
);

323 
	gp£udo
) {

324 
	gMEDIA_CONTROLS_MUTE_BUTTON
:

325 
m_di¥ÏyTy³
 = 
MedŸMu‹Bu‰Ú
;

327 
	gMEDIA_CONTROLS_PLAY_BUTTON
:

328 
m_di¥ÏyTy³
 = 
MedŸPÏyBu‰Ú
;

330 
	gMEDIA_CONTROLS_SEEK_FORWARD_BUTTON
:

331 
m_di¥ÏyTy³
 = 
MedŸS“kFÜw¬dBu‰Ú
;

333 
	gMEDIA_CONTROLS_SEEK_BACK_BUTTON
:

334 
m_di¥ÏyTy³
 = 
MedŸS“kBackBu‰Ú
;

336 
	gMEDIA_CONTROLS_FULLSCREEN_BUTTON
:

337 
m_di¥ÏyTy³
 = 
MedŸFuÎsü“nBu‰Ú
;

339 
	gMEDIA_CONTROLS_TIMELINE
:

340 
m_di¥ÏyTy³
 = 
MedŸSlid”
;

342 
	gMEDIA_CONTROLS_RETURN_TO_REALTIME_BUTTON
:

343 
m_di¥ÏyTy³
 = 
MedŸR‘uºToR—ÉimeBu‰Ú
;

345 
	gMEDIA_CONTROLS_REWIND_BUTTON
:

346 
m_di¥ÏyTy³
 = 
MedŸRewšdBu‰Ú
;

348 
	gMEDIA_CONTROLS_VOLUME_SLIDER
:

349 
m_di¥ÏyTy³
 = 
MedŸVŞumeSlid”
;

351 
	gMEDIA_CONTROLS_TOGGLE_CLOSED_CAPTIONS_BUTTON
:

352 
m_di¥ÏyTy³
 = 
MedŸShowClo£dC­tiÚsBu‰Ú
;

355 
ASSERT_NOT_REACHED
();

360 
	gMedŸCÚŒŞIÅutEËm’t
::
©chToP¬’t
(
EËm’t
* 
·»Á
)

362 
·»Á
->
addChd
(
this
);

365 
	gMedŸCÚŒŞIÅutEËm’t
::
upd©e
()

367 
upd©eDi¥ÏyTy³
();

368 ià(
»nd””
())

369 
»nd””
()->
upd©eFromEËm’t
();

370 
upd©eStyË
();

373 
	gPassRefPŒ
<
	gR’d”StyË
> 
	gMedŸCÚŒŞIÅutEËm’t
::
¡yËFÜEËm’t
()

375  
m_medŸEËm’t
->
»nd””
()->
g‘CachedP£udoStyË
(
m_p£udoStyËId
);

378 
boŞ
 
	gMedŸCÚŒŞIÅutEËm’t
::
»nd””IsN“ded
(
R’d”StyË
* 
¡yË
)

380 
ASSERT
(
docum’t
()->
·ge
());

382  
	gHTMLIÅutEËm’t
::
»nd””IsN“ded
(
¡yË
è&& 
·»Á
(è&&…¬’t()->
»nd””
()

383 && (!
¡yË
->
hasAµ—¿nû
(è|| 
docum’t
()->
·ge
()->
theme
()->
shouldR’d”MedŸCÚŒŞP¬t
(¡yË->
­³¬ªû
(), 
m_medŸEËm’t
));

386 
	gMedŸCÚŒŞIÅutEËm’t
::
©ch
()

388 
RefPŒ
<
R’d”StyË
> 
¡yË
 = 
¡yËFÜEËm’t
();

389 ià(!
	g¡yË
)

392 
boŞ
 
	gÃedsR’d””
 = 
»nd””IsN“ded
(
¡yË
.
g‘
());

393 ià(!
	gÃedsR’d””
)

395 
R’d”Objeù
* 
	g»nd””
 = 
ü—‹R’d””
(
m_medŸEËm’t
->
»nd””
()->
»nd”A»Ç
(), 
¡yË
.
g‘
());

396 ià(!
	g»nd””
)

398 
	g»nd””
->
£tStyË
(
¡yË
.
g‘
());

399 
£tR’d””
(
»nd””
);

400 ià(
·»Á
(è&&…¬’t()->
»nd””
()) {

402 
Node
* 
	gsiblšg
 = 
ÃxtSiblšg
();

403 
	gsiblšg
 && !siblšg->
»nd””
())

404 
	gsiblšg
 = 
siblšg
->
ÃxtSiblšg
();

405 
·»Á
()->
»nd””
()->
addChd
Ô’d””, 
siblšg
 ? sibling->renderer() : 0);

407 
	gCÚš”Node
::
©ch
();

410 
	gMedŸCÚŒŞIÅutEËm’t
::
upd©eStyË
()

412 ià(!
m_medŸEËm’t
 || !m_medŸEËm’t->
»nd””
())

415 
	gRefPŒ
<
	gR’d”StyË
> 
	g¡yË
 = 
¡yËFÜEËm’t
();

416 ià(!
	g¡yË
)

419 
boŞ
 
	gÃedsR’d””
 = 
»nd””IsN“ded
(
¡yË
.
g‘
()è&& 
·»Á
(è&&…¬’t()->
»nd””
();

420 ià(
»nd””
(è&& !
	gÃedsR’d””
)

421 
d‘ach
();

422 ià(!
»nd””
(è&& 
	gÃedsR’d””
)

423 
©ch
();

424 ià(
»nd””
())

425 
»nd””
()->
£tStyË
(
¡yË
.
g‘
());

428 
boŞ
 
	gMedŸCÚŒŞIÅutEËm’t
::
h™Te¡
(cÚ¡ 
IÁPošt
& 
absPošt
)

430 ià(
»nd””
(è&&„’d””()->
¡yË
()->
hasAµ—¿nû
())

431  
»nd””
()->
theme
()->
h™Te¡MedŸCÚŒŞP¬t
Ô’d””(), 
absPošt
);

433  
	gçl£
;

436 
	gMedŸCÚŒŞIÅutEËm’t
::
£tDi¥ÏyTy³
(
MedŸCÚŒŞEËm’tTy³
 
di¥ÏyTy³
)

438 ià(
di¥ÏyTy³
 =ğ
m_di¥ÏyTy³
)

441 
	gm_di¥ÏyTy³
 = 
di¥ÏyTy³
;

442 ià(
R’d”Objeù
* 
	gobjeù
 = 
»nd””
())

443 
objeù
->
»·št
();

448 
	gMedŸCÚŒŞMu‹Bu‰ÚEËm’t
::
MedŸCÚŒŞMu‹Bu‰ÚEËm’t
(
Docum’t
* 
docum’t
, 
HTMLMedŸEËm’t
* 
–em’t
)

449 : 
MedŸCÚŒŞIÅutEËm’t
(
docum’t
, 
MEDIA_CONTROLS_MUTE_BUTTON
, "bu‰Ú", 
–em’t
)

453 
	gMedŸCÚŒŞMu‹Bu‰ÚEËm’t
::
deçuÉEv’tHªdËr
(
Ev’t
* 
ev’t
)

455 ià(
ev’t
->
ty³
(è=ğ
ev’tNames
().
şickEv’t
) {

456 
m_medŸEËm’t
->
£tMu‹d
(!m_medŸEËm’t->
mu‹d
());

457 
	gev’t
->
£tDeçuÉHªdËd
();

459 
	gHTMLIÅutEËm’t
::
deçuÉEv’tHªdËr
(
ev’t
);

462 
	gMedŸCÚŒŞMu‹Bu‰ÚEËm’t
::
upd©eDi¥ÏyTy³
()

464 
£tDi¥ÏyTy³
(
m_medŸEËm’t
->
mu‹d
(è? 
MedŸUnMu‹Bu‰Ú
 : 
MedŸMu‹Bu‰Ú
);

469 
	gMedŸCÚŒŞPÏyBu‰ÚEËm’t
::
MedŸCÚŒŞPÏyBu‰ÚEËm’t
(
Docum’t
* 
docum’t
, 
HTMLMedŸEËm’t
* 
–em’t
)

470 : 
MedŸCÚŒŞIÅutEËm’t
(
docum’t
, 
MEDIA_CONTROLS_PLAY_BUTTON
, "bu‰Ú", 
–em’t
)

474 
	gMedŸCÚŒŞPÏyBu‰ÚEËm’t
::
deçuÉEv’tHªdËr
(
Ev’t
* 
ev’t
)

476 ià(
ev’t
->
ty³
(è=ğ
ev’tNames
().
şickEv’t
) {

477 
m_medŸEËm’t
->
toggËPÏyS‹
();

478 
	gev’t
->
£tDeçuÉHªdËd
();

480 
	gHTMLIÅutEËm’t
::
deçuÉEv’tHªdËr
(
ev’t
);

483 
	gMedŸCÚŒŞPÏyBu‰ÚEËm’t
::
upd©eDi¥ÏyTy³
()

485 
£tDi¥ÏyTy³
(
m_medŸEËm’t
->
ÿnPÏy
(è? 
MedŸPÏyBu‰Ú
 : 
MedŸPau£Bu‰Ú
);

490 
	gMedŸCÚŒŞS“kBu‰ÚEËm’t
::
MedŸCÚŒŞS“kBu‰ÚEËm’t
(
Docum’t
* 
docum’t
, 
HTMLMedŸEËm’t
* 
–em’t
, 
boŞ
 
fÜw¬d
)

491 : 
MedŸCÚŒŞIÅutEËm’t
(
docum’t
, 
fÜw¬d
 ? 
MEDIA_CONTROLS_SEEK_FORWARD_BUTTON
 : 
MEDIA_CONTROLS_SEEK_BACK_BUTTON
,

492 "bu‰Ú", 
–em’t
)

493 , 
m_fÜw¬d
(
fÜw¬d
)

494 , 
m_£ekšg
(
çl£
)

495 , 
m_ÿ±uršg
(
çl£
)

496 , 
m_£ekTim”
(
this
, &
MedŸCÚŒŞS“kBu‰ÚEËm’t
::
£ekTim”Fœed
)

500 
MedŸCÚŒŞS“kBu‰ÚEËm’t
::
deçuÉEv’tHªdËr
(
Ev’t
* 
ev’t
)

502 ià(
ev’t
->
ty³
(è=ğ
ev’tNames
().
mou£downEv’t
) {

503 ià(
F¿me
* 
äame
 = 
docum’t
()->frame()) {

504 
m_ÿ±uršg
 = 
Œue
;

505 
	gäame
->
ev’tHªdËr
()->
£tC­turšgMou£Ev’tsNode
(
this
);

507 
	gm_medŸEËm’t
->
·u£
(
ev’t
->
äomU£rGe¡u»
());

508 
	gm_£ekTim”
.
¡¬tR•—tšg
(
cS“kR•—tD–ay
);

509 
	gev’t
->
£tDeçuÉHªdËd
();

510 } ià(
	gev’t
->
ty³
(è=ğ
ev’tNames
().
mou£upEv’t
) {

511 ià(
m_ÿ±uršg
)

512 ià(
F¿me
* 
äame
 = 
docum’t
()->frame()) {

513 
m_ÿ±uršg
 = 
çl£
;

514 
	gäame
->
ev’tHªdËr
()->
£tC­turšgMou£Ev’tsNode
(0);

516 
Exû±iÚCode
 
	gec
;

517 ià(
	gm_£ekšg
 || 
	gm_£ekTim”
.
isAùive
()) {

518 ià(!
	gm_£ekšg
) {

519 
	g¡•Time
 = 
m_fÜw¬d
 ? 
cS‹pTime
 : -cStepTime;

520 
	gm_medŸEËm’t
->
£tCu¼’tTime
(
m_medŸEËm’t
->
cu¼’tTime
(è+ 
¡•Time
, 
ec
);

522 
	gm_£ekTim”
.
¡İ
();

523 
	gm_£ekšg
 = 
çl£
;

524 
	gev’t
->
£tDeçuÉHªdËd
();

527 
	gHTMLIÅutEËm’t
::
deçuÉEv’tHªdËr
(
ev’t
);

530 
	gMedŸCÚŒŞS“kBu‰ÚEËm’t
::
£ekTim”Fœed
(
Tim”
<
MedŸCÚŒŞS“kBu‰ÚEËm’t
>*)

532 
Exû±iÚCode
 
ec
;

533 
	gm_£ekšg
 = 
Œue
;

534 
	g£ekTime
 = 
m_fÜw¬d
 ? 
cS“kTime
 : -cSeekTime;

535 
	gm_medŸEËm’t
->
£tCu¼’tTime
(
m_medŸEËm’t
->
cu¼’tTime
(è+ 
£ekTime
, 
ec
);

538 
	gMedŸCÚŒŞS“kBu‰ÚEËm’t
::
d‘ach
()

540 ià(
m_ÿ±uršg
) {

541 ià(
F¿me
* 
äame
 = 
docum’t
()->frame())

542 
äame
->
ev’tHªdËr
()->
£tC­turšgMou£Ev’tsNode
(0);

544 
	gMedŸCÚŒŞIÅutEËm’t
::
d‘ach
();

550 
	gMedŸCÚŒŞRewšdBu‰ÚEËm’t
::
MedŸCÚŒŞRewšdBu‰ÚEËm’t
(
Docum’t
* 
docum’t
, 
HTMLMedŸEËm’t
* 
–em’t
)

551 : 
MedŸCÚŒŞIÅutEËm’t
(
docum’t
, 
MEDIA_CONTROLS_REWIND_BUTTON
, "bu‰Ú", 
–em’t
)

555 
	gMedŸCÚŒŞRewšdBu‰ÚEËm’t
::
deçuÉEv’tHªdËr
(
Ev’t
* 
ev’t
)

557 ià(
ev’t
->
ty³
(è=ğ
ev’tNames
().
şickEv’t
) {

558 
m_medŸEËm’t
->
»wšd
(30);

559 
	gev’t
->
£tDeçuÉHªdËd
();

561 
	gHTMLIÅutEËm’t
::
deçuÉEv’tHªdËr
(
ev’t
);

567 
	gMedŸCÚŒŞR‘uºToR—ÉimeBu‰ÚEËm’t
::
MedŸCÚŒŞR‘uºToR—ÉimeBu‰ÚEËm’t
(
Docum’t
* 
docum’t
, 
HTMLMedŸEËm’t
* 
–em’t
)

568 : 
MedŸCÚŒŞIÅutEËm’t
(
docum’t
, 
MEDIA_CONTROLS_RETURN_TO_REALTIME_BUTTON
, "bu‰Ú", 
–em’t
)

572 
	gMedŸCÚŒŞR‘uºToR—ÉimeBu‰ÚEËm’t
::
deçuÉEv’tHªdËr
(
Ev’t
* 
ev’t
)

574 ià(
ev’t
->
ty³
(è=ğ
ev’tNames
().
şickEv’t
) {

575 
m_medŸEËm’t
->
»tuºToR—Éime
();

576 
	gev’t
->
£tDeçuÉHªdËd
();

578 
	gHTMLIÅutEËm’t
::
deçuÉEv’tHªdËr
(
ev’t
);

584 
	gMedŸCÚŒŞToggËClo£dC­tiÚsBu‰ÚEËm’t
::
MedŸCÚŒŞToggËClo£dC­tiÚsBu‰ÚEËm’t
(
Docum’t
* 
doc
, 
HTMLMedŸEËm’t
* 
–em’t
)

585 : 
MedŸCÚŒŞIÅutEËm’t
(
doc
, 
MEDIA_CONTROLS_TOGGLE_CLOSED_CAPTIONS_BUTTON
, "bu‰Ú", 
–em’t
)

589 
	gMedŸCÚŒŞToggËClo£dC­tiÚsBu‰ÚEËm’t
::
deçuÉEv’tHªdËr
(
Ev’t
* 
ev’t
)

591 ià(
ev’t
->
ty³
(è=ğ
ev’tNames
().
şickEv’t
) {

592 
m_medŸEËm’t
->
£tClo£dC­tiÚsVisibË
(!m_medŸEËm’t->
şo£dC­tiÚsVisibË
());

593 
£tChecked
(
m_medŸEËm’t
->
şo£dC­tiÚsVisibË
());

594 
	gev’t
->
£tDeçuÉHªdËd
();

596 
	gHTMLIÅutEËm’t
::
deçuÉEv’tHªdËr
(
ev’t
);

599 
	gMedŸCÚŒŞToggËClo£dC­tiÚsBu‰ÚEËm’t
::
upd©eDi¥ÏyTy³
()

601 
£tDi¥ÏyTy³
(
m_medŸEËm’t
->
şo£dC­tiÚsVisibË
(è? 
MedŸHideClo£dC­tiÚsBu‰Ú
 : 
MedŸShowClo£dC­tiÚsBu‰Ú
);

607 
	gMedŸCÚŒŞTim–šeEËm’t
::
MedŸCÚŒŞTim–šeEËm’t
(
Docum’t
* 
docum’t
, 
HTMLMedŸEËm’t
* 
–em’t
)

608 : 
MedŸCÚŒŞIÅutEËm’t
(
docum’t
, 
MEDIA_CONTROLS_TIMELINE
, "¿nge", 
–em’t
)

612 
	gMedŸCÚŒŞTim–šeEËm’t
::
deçuÉEv’tHªdËr
(
Ev’t
* 
ev’t
)

615 ià(
ev’t
->
isMou£Ev’t
(è&& 
¡©ic_ÿ¡
<
Mou£Ev’t
*>Óv’t)->
bu‰Ú
())

618 ià(!
©ched
())

621 ià(
	gev’t
->
ty³
(è=ğ
ev’tNames
().
mou£downEv’t
)

622 
m_medŸEËm’t
->
begšSüubbšg
();

624 
	gMedŸCÚŒŞIÅutEËm’t
::
deçuÉEv’tHªdËr
(
ev’t
);

626 ià(
	gev’t
->
ty³
(è=ğ
ev’tNames
().
mou£ov”Ev’t
 || 
ev’t
->ty³(è=ğev’tNames().
mou£outEv’t
 ||ƒv’t->ty³(è=ğev’tNames().
mou£moveEv’t
)

629 
	gtime
 = 
Ç¼owP»cisiÚToFlßt
(
v®ue
().
toDoubË
());

630 ià(
	gtime
 !ğ
m_medŸEËm’t
->
cu¼’tTime
()) {

631 
Exû±iÚCode
 
ec
;

632 
	gm_medŸEËm’t
->
£tCu¼’tTime
(
time
, 
ec
);

635 
R’d”Slid”
* 
	g¦id”
 = 
toR’d”Slid”
(
»nd””
());

636 ià(
	g¦id”
 && slid”->
šD¿gMode
())

637 
toR’d”MedŸ
(
m_medŸEËm’t
->
»nd””
())->
upd©eTimeDi¥Ïy
();

639 ià(
	gev’t
->
ty³
(è=ğ
ev’tNames
().
mou£upEv’t
)

640 
m_medŸEËm’t
->
’dSüubbšg
();

643 
	gMedŸCÚŒŞTim–šeEËm’t
::
upd©e
(
boŞ
 
upd©eDu¿tiÚ
)

645 ià(
upd©eDu¿tiÚ
) {

646 
dur
 = 
m_medŸEËm’t
->
du¿tiÚ
();

647 
£tA‰ribu‹
(
maxA‰r
, 
SŒšg
::
numb”
(
isfš™e
(
dur
) ? dur : 0));

649 
£tV®ue
(
SŒšg
::
numb”
(
m_medŸEËm’t
->
cu¼’tTime
()));

650 
	gMedŸCÚŒŞIÅutEËm’t
::
upd©e
();

655 
	gMedŸCÚŒŞVŞumeSlid”EËm’t
::
MedŸCÚŒŞVŞumeSlid”EËm’t
(
Docum’t
* 
docum’t
, 
HTMLMedŸEËm’t
* 
–em’t
)

656 : 
MedŸCÚŒŞIÅutEËm’t
(
docum’t
, 
MEDIA_CONTROLS_VOLUME_SLIDER
, "¿nge", 
–em’t
)

660 
	gMedŸCÚŒŞVŞumeSlid”EËm’t
::
deçuÉEv’tHªdËr
(
Ev’t
* 
ev’t
)

663 ià(
ev’t
->
isMou£Ev’t
(è&& 
¡©ic_ÿ¡
<
Mou£Ev’t
*>Óv’t)->
bu‰Ú
())

666 ià(!
©ched
())

669 
	gMedŸCÚŒŞIÅutEËm’t
::
deçuÉEv’tHªdËr
(
ev’t
);

671 ià(
	gev’t
->
ty³
(è=ğ
ev’tNames
().
mou£ov”Ev’t
 || 
ev’t
->ty³(è=ğev’tNames().
mou£outEv’t
 ||ƒv’t->ty³(è=ğev’tNames().
mou£moveEv’t
)

674 
	gvŞume
 = 
Ç¼owP»cisiÚToFlßt
(
v®ue
().
toDoubË
());

675 ià(
	gvŞume
 !ğ
m_medŸEËm’t
->
vŞume
()) {

676 
Exû±iÚCode
 
ec
 = 0;

677 
	gm_medŸEËm’t
->
£tVŞume
(
vŞume
, 
ec
);

678 
ASSERT
(!
ec
);

682 
	gMedŸCÚŒŞVŞumeSlid”EËm’t
::
upd©e
()

684 
vŞume
 = 
m_medŸEËm’t
->volume();

685 ià(
v®ue
().
toFlßt
(è!ğ
vŞume
)

686 
£tV®ue
(
SŒšg
::
numb”
(
vŞume
));

687 
	gMedŸCÚŒŞIÅutEËm’t
::
upd©e
();

692 
	gMedŸCÚŒŞFuÎsü“nBu‰ÚEËm’t
::
MedŸCÚŒŞFuÎsü“nBu‰ÚEËm’t
(
Docum’t
* 
docum’t
, 
HTMLMedŸEËm’t
* 
–em’t
)

693 : 
MedŸCÚŒŞIÅutEËm’t
(
docum’t
, 
MEDIA_CONTROLS_FULLSCREEN_BUTTON
, "bu‰Ú", 
–em’t
)

697 
	gMedŸCÚŒŞFuÎsü“nBu‰ÚEËm’t
::
deçuÉEv’tHªdËr
(
Ev’t
* 
ev’t
)

699 ià(
ev’t
->
ty³
(è=ğ
ev’tNames
().
şickEv’t
) {

700 
m_medŸEËm’t
->
’‹rFuÎsü“n
();

701 
	gev’t
->
£tDeçuÉHªdËd
();

703 
	gHTMLIÅutEËm’t
::
deçuÉEv’tHªdËr
(
ev’t
);

708 
	gMedŸCÚŒŞTimeDi¥ÏyEËm’t
::
MedŸCÚŒŞTimeDi¥ÏyEËm’t
(
Docum’t
* 
docum’t
, 
P£udoId
 
p£udo
, 
HTMLMedŸEËm’t
* 
–em’t
)

709 : 
MedŸCÚŒŞEËm’t
(
docum’t
, 
p£udo
, 
–em’t
)

710 , 
m_cu¼’tV®ue
(0)

711 , 
m_isVisibË
(
Œue
)

715 
	gPassRefPŒ
<
	gR’d”StyË
> 
	gMedŸCÚŒŞTimeDi¥ÏyEËm’t
::
¡yËFÜEËm’t
()

717 
RefPŒ
<
R’d”StyË
> 
¡yË
 = 
MedŸCÚŒŞEËm’t
::
¡yËFÜEËm’t
();

718 ià(!
	gm_isVisibË
) {

719 
	g¡yË
 = 
R’d”StyË
::
şÚe
(
¡yË
.
g‘
());

720 
	g¡yË
->
£tWidth
(
L’gth
(0, 
Fixed
));

722  
	g¡yË
;

725 
	gMedŸCÚŒŞTimeDi¥ÏyEËm’t
::
£tVisibË
(
boŞ
 
visibË
)

727 ià(
visibË
 =ğ
m_isVisibË
)

729 
	gm_isVisibË
 = 
visibË
;

733 ià(!
»nd””
(è|| !»nd””()->
¡yË
())

736 
	gRefPŒ
<
	gR’d”StyË
> 
	g¡yË
 = 
¡yËFÜEËm’t
();

737 
»nd””
()->
£tStyË
(
¡yË
.
g‘
());

740 
	gMedŸCÚŒŞTimeDi¥ÏyEËm’t
::
£tCu¼’tV®ue
(
time
)

742 
m_cu¼’tV®ue
 = 
time
;

	@MediaControlElements.h

29 #iâdeà
MedŸCÚŒŞEËm’ts_h


30 
	#MedŸCÚŒŞEËm’ts_h


	)

32 #ià
ENABLE
(
VIDEO
)

34 
	~"HTMLDivEËm’t.h
"

35 
	~"HTMLIÅutEËm’t.h
"

36 
	~"HTMLMedŸEËm’t.h
"

37 
	~"R’d”Block.h
"

41 
Çme¥aû
 
	gWebCÜe
 {

43 
şass
 
	gEv’t
;

44 
şass
 
	gF¿me
;

47 
	eMedŸCÚŒŞEËm’tTy³
 {

48 
	gMedŸFuÎsü“nBu‰Ú
 = 0,

49 
	gMedŸMu‹Bu‰Ú
,

50 
	gMedŸPÏyBu‰Ú
,

51 
	gMedŸS“kBackBu‰Ú
,

52 
	gMedŸS“kFÜw¬dBu‰Ú
,

53 
	gMedŸSlid”
,

54 
	gMedŸSlid”Thumb
,

55 
	gMedŸRewšdBu‰Ú
,

56 
	gMedŸR‘uºToR—ÉimeBu‰Ú
,

57 
	gMedŸShowClo£dC­tiÚsBu‰Ú
,

58 
	gMedŸHideClo£dC­tiÚsBu‰Ú
,

59 
	gMedŸUnMu‹Bu‰Ú
,

60 
	gMedŸPau£Bu‰Ú
,

61 
	gMedŸTim–šeCÚš”
,

62 
	gMedŸCu¼’tTimeDi¥Ïy
,

63 
	gMedŸTimeRemaššgDi¥Ïy
,

64 
	gMedŸStusDi¥Ïy
,

65 
	gMedŸCÚŒŞsPª–
,

66 
	gMedŸVŞumeSlid”CÚš”
,

67 
	gMedŸVŞumeSlid”
,

68 
	gMedŸVŞumeSlid”Thumb


71 
HTMLMedŸEËm’t
* 
toP¬’tMedŸEËm’t
(
R’d”Objeù
*);

73 şas 
	cMedŸCÚŒŞShadowRoÙEËm’t
 : 
public
 
HTMLDivEËm’t
 {

74 
public
:

75 
MedŸCÚŒŞShadowRoÙEËm’t
(
Docum’t
*, 
HTMLMedŸEËm’t
*);

77 
vœtu®
 
boŞ
 
isShadowNode
(ècÚ¡ {  
	gŒue
; }

78 
vœtu®
 
Node
* 
shadowP¬’tNode
(è{  
	gm_medŸEËm’t
; }

80 
upd©eStyË
();

82 
	g´iv©e
:

83 
HTMLMedŸEËm’t
* 
m_medŸEËm’t
;

88 şas 
	cMedŸCÚŒŞEËm’t
 : 
public
 
HTMLDivEËm’t
 {

89 
public
:

90 
MedŸCÚŒŞEËm’t
(
Docum’t
*, 
P£udoId
, 
HTMLMedŸEËm’t
*);

91 
vœtu®
 
©ch
();

92 
vœtu®
 
boŞ
 
»nd””IsN“ded
(
R’d”StyË
*);

94 
vœtu®
 
	gPassRefPŒ
<
	gR’d”StyË
> 
¡yËFÜEËm’t
();

95 
©chToP¬’t
(
EËm’t
*);

96 
upd©e
();

97 
vœtu®
 
upd©eStyË
();

99 
MedŸCÚŒŞEËm’tTy³
 
di¥ÏyTy³
(ècÚ¡ {  
	gm_di¥ÏyTy³
; }

101 
HTMLMedŸEËm’t
* 
medŸEËm’t
(ècÚ¡ {  
	gm_medŸEËm’t
; }

102 
vœtu®
 
boŞ
 
isMedŸCÚŒŞEËm’t
(ècÚ¡ {  
	gŒue
; }

104 
	g´Ùeùed
:

105 
HTMLMedŸEËm’t
* 
m_medŸEËm’t
;

106 
P£udoId
 
	gm_p£udoStyËId
;

107 
MedŸCÚŒŞEËm’tTy³
 
	gm_di¥ÏyTy³
;

112 şas 
	cMedŸCÚŒŞTim–šeCÚš”EËm’t
 : 
public
 
MedŸCÚŒŞEËm’t
 {

113 
public
:

114 
MedŸCÚŒŞTim–šeCÚš”EËm’t
(
Docum’t
*, 
HTMLMedŸEËm’t
*);

115 
vœtu®
 
boŞ
 
»nd””IsN“ded
(
R’d”StyË
*);

120 şas 
	cMedŸCÚŒŞVŞumeSlid”CÚš”EËm’t
 : 
public
 
MedŸCÚŒŞEËm’t
 {

121 
public
:

122 
MedŸCÚŒŞVŞumeSlid”CÚš”EËm’t
(
Docum’t
*, 
HTMLMedŸEËm’t
*);

123 
vœtu®
 
	gPassRefPŒ
<
	gR’d”StyË
> 
¡yËFÜEËm’t
();

124 
£tVisibË
(
boŞ
);

125 
boŞ
 
isVisibË
(è{  
	gm_isVisibË
; }

126 
£tPos™iÚ
(
x
, 
y
);

127 
boŞ
 
h™Te¡
(cÚ¡ 
IÁPošt
& 
absPošt
);

129 
	g´iv©e
:

130 
boŞ
 
m_isVisibË
;

131 
	gm_x
, 
	gm_y
;

136 şas 
	cMedŸCÚŒŞStusDi¥ÏyEËm’t
 : 
public
 
MedŸCÚŒŞEËm’t
 {

137 
public
:

138 
MedŸCÚŒŞStusDi¥ÏyEËm’t
(
Docum’t
*, 
HTMLMedŸEËm’t
*);

139 
vœtu®
 
upd©e
();

140 
vœtu®
 
boŞ
 
»nd””IsN“ded
(
R’d”StyË
*);

141 
	g´iv©e
:

142 
	eS‹BešgDi¥Ïyed
 { 
NÙhšg
, 
	gLßdšg
, 
	gLiveBrßdÿ¡
 };

143 
S‹BešgDi¥Ïyed
 
	gm_¡©eBešgDi¥Ïyed
;

148 şas 
	cMedŸCÚŒŞIÅutEËm’t
 : 
public
 
HTMLIÅutEËm’t
 {

149 
public
:

150 
MedŸCÚŒŞIÅutEËm’t
(
Docum’t
*, 
P£udoId
, cÚ¡ 
SŒšg
& 
ty³
, 
HTMLMedŸEËm’t
*);

151 
vœtu®
 
©ch
();

152 
vœtu®
 
boŞ
 
»nd””IsN“ded
(
R’d”StyË
*);

154 
vœtu®
 
	gPassRefPŒ
<
	gR’d”StyË
> 
¡yËFÜEËm’t
();

155 
©chToP¬’t
(
EËm’t
*);

156 
upd©e
();

157 
upd©eStyË
();

159 
boŞ
 
h™Te¡
(cÚ¡ 
IÁPošt
& 
absPošt
);

160 
MedŸCÚŒŞEËm’tTy³
 
di¥ÏyTy³
(ècÚ¡ {  
	gm_di¥ÏyTy³
; }

162 
HTMLMedŸEËm’t
* 
medŸEËm’t
(ècÚ¡ {  
	gm_medŸEËm’t
; }

163 
vœtu®
 
boŞ
 
isMedŸCÚŒŞEËm’t
(ècÚ¡ {  
	gŒue
; }

165 
	g´Ùeùed
:

166 
vœtu®
 
upd©eDi¥ÏyTy³
() { }

167 
£tDi¥ÏyTy³
(
MedŸCÚŒŞEËm’tTy³
);

169 
HTMLMedŸEËm’t
* 
	gm_medŸEËm’t
;

170 
P£udoId
 
	gm_p£udoStyËId
;

171 
MedŸCÚŒŞEËm’tTy³
 
	gm_di¥ÏyTy³
;

176 şas 
	cMedŸCÚŒŞMu‹Bu‰ÚEËm’t
 : 
public
 
MedŸCÚŒŞIÅutEËm’t
 {

177 
public
:

178 
MedŸCÚŒŞMu‹Bu‰ÚEËm’t
(
Docum’t
*, 
HTMLMedŸEËm’t
*);

179 
vœtu®
 
deçuÉEv’tHªdËr
(
Ev’t
*);

180 
vœtu®
 
upd©eDi¥ÏyTy³
();

185 şas 
	cMedŸCÚŒŞPÏyBu‰ÚEËm’t
 : 
public
 
MedŸCÚŒŞIÅutEËm’t
 {

186 
public
:

187 
MedŸCÚŒŞPÏyBu‰ÚEËm’t
(
Docum’t
*, 
HTMLMedŸEËm’t
*);

188 
vœtu®
 
deçuÉEv’tHªdËr
(
Ev’t
*);

189 
vœtu®
 
upd©eDi¥ÏyTy³
();

194 şas 
	cMedŸCÚŒŞS“kBu‰ÚEËm’t
 : 
public
 
MedŸCÚŒŞIÅutEËm’t
 {

195 
public
:

196 
MedŸCÚŒŞS“kBu‰ÚEËm’t
(
Docum’t
*, 
HTMLMedŸEËm’t
*, 
boŞ
 
fÜw¬d
);

197 
vœtu®
 
deçuÉEv’tHªdËr
(
Ev’t
*);

198 
vœtu®
 
d‘ach
();

199 
£ekTim”Fœed
(
Tim”
<
MedŸCÚŒŞS“kBu‰ÚEËm’t
>*);

201 
	g´iv©e
:

202 
boŞ
 
m_fÜw¬d
;

203 
boŞ
 
	gm_£ekšg
;

204 
boŞ
 
	gm_ÿ±uršg
;

205 
	gTim”
<
	gMedŸCÚŒŞS“kBu‰ÚEËm’t
> 
	gm_£ekTim”
;

210 şas 
	cMedŸCÚŒŞRewšdBu‰ÚEËm’t
 : 
public
 
MedŸCÚŒŞIÅutEËm’t
 {

211 
public
:

212 
MedŸCÚŒŞRewšdBu‰ÚEËm’t
(
Docum’t
*, 
HTMLMedŸEËm’t
*);

213 
vœtu®
 
deçuÉEv’tHªdËr
(
Ev’t
*);

218 şas 
	cMedŸCÚŒŞR‘uºToR—ÉimeBu‰ÚEËm’t
 : 
public
 
MedŸCÚŒŞIÅutEËm’t
 {

219 
public
:

220 
MedŸCÚŒŞR‘uºToR—ÉimeBu‰ÚEËm’t
(
Docum’t
*, 
HTMLMedŸEËm’t
*);

221 
vœtu®
 
deçuÉEv’tHªdËr
(
Ev’t
*);

226 şas 
	cMedŸCÚŒŞToggËClo£dC­tiÚsBu‰ÚEËm’t
 : 
public
 
MedŸCÚŒŞIÅutEËm’t
 {

227 
public
:

228 
MedŸCÚŒŞToggËClo£dC­tiÚsBu‰ÚEËm’t
(
Docum’t
*, 
HTMLMedŸEËm’t
*);

229 
vœtu®
 
deçuÉEv’tHªdËr
(
Ev’t
*);

230 
vœtu®
 
upd©eDi¥ÏyTy³
();

235 şas 
	cMedŸCÚŒŞTim–šeEËm’t
 : 
public
 
MedŸCÚŒŞIÅutEËm’t
 {

236 
public
:

237 
MedŸCÚŒŞTim–šeEËm’t
(
Docum’t
*, 
HTMLMedŸEËm’t
*);

238 
vœtu®
 
deçuÉEv’tHªdËr
(
Ev’t
*);

239 
upd©e
(
boŞ
 
upd©eDu¿tiÚ
 = 
Œue
);

244 şas 
	cMedŸCÚŒŞVŞumeSlid”EËm’t
 : 
public
 
MedŸCÚŒŞIÅutEËm’t
 {

245 
public
:

246 
MedŸCÚŒŞVŞumeSlid”EËm’t
(
Docum’t
*, 
HTMLMedŸEËm’t
*);

247 
vœtu®
 
deçuÉEv’tHªdËr
(
Ev’t
*);

248 
vœtu®
 
upd©e
();

253 şas 
	cMedŸCÚŒŞFuÎsü“nBu‰ÚEËm’t
 : 
public
 
MedŸCÚŒŞIÅutEËm’t
 {

254 
public
:

255 
MedŸCÚŒŞFuÎsü“nBu‰ÚEËm’t
(
Docum’t
*, 
HTMLMedŸEËm’t
*);

256 
vœtu®
 
deçuÉEv’tHªdËr
(
Ev’t
*);

261 şas 
	cMedŸCÚŒŞTimeDi¥ÏyEËm’t
 : 
public
 
MedŸCÚŒŞEËm’t
 {

262 
public
:

263 
MedŸCÚŒŞTimeDi¥ÏyEËm’t
(
Docum’t
*, 
P£udoId
, 
HTMLMedŸEËm’t
*);

264 
£tVisibË
(
boŞ
);

265 
vœtu®
 
	gPassRefPŒ
<
	gR’d”StyË
> 
¡yËFÜEËm’t
();

267 
£tCu¼’tV®ue
();

268 
cu¼’tV®ue
(ècÚ¡ {  
	gm_cu¼’tV®ue
; }

270 
	g´iv©e
:

271 
m_cu¼’tV®ue
;

272 
boŞ
 
	gm_isVisibË
;

277 şas 
	cR’d”MedŸCÚŒŞShadowRoÙ
 : 
public
 
R’d”Block
 {

278 
public
:

279 
R’d”MedŸCÚŒŞShadowRoÙ
(
EËm’t
* 
e
è: 
R’d”Block
(e) { }

280 
£tP¬’t
(
R’d”Objeù
* 
p
) { RenderObject::setParent(p); }

	@OverlapTestRequestClient.h

26 #iâdeà
Ov”ÏpTe¡Reque¡Cl›Á_h


27 
	#Ov”ÏpTe¡Reque¡Cl›Á_h


	)

29 
Çme¥aû
 
	gWebCÜe
 {

31 şas 
	cOv”ÏpTe¡Reque¡Cl›Á
 {

32 
	gpublic
:

33 
vœtu®
 ~
Ov”ÏpTe¡Reque¡Cl›Á
() { }

34 
vœtu®
 
£tOv”ÏpTe¡ResuÉ
(
boŞ
) = 0;

	@PointerEventsHitRules.cpp

20 
	~"cÚfig.h
"

21 
	~"Poš‹rEv’tsH™RuËs.h
"

23 
Çme¥aû
 
	gWebCÜe
 {

25 
	gPoš‹rEv’tsH™RuËs
::
Poš‹rEv’tsH™RuËs
(
EH™Te¡šg
 
h™Te¡šg
, 
EPoš‹rEv’ts
 
poš‹rEv’ts
)

26 : 
»quœeVisibË
(
çl£
)

27 , 
»quœeFl
(
çl£
)

28 , 
»quœeSŒoke
(
çl£
)

29 , 
ÿnH™SŒoke
(
çl£
)

30 , 
ÿnH™Fl
(
çl£
)

32 ià(
	gh™Te¡šg
 =ğ
SVG_PATH_HITTESTING
) {

33 
poš‹rEv’ts
)

35 
PE_VISIBLE_PAINTED
:

36 
PE_AUTO
:

37 
»quœeFl
 = 
Œue
;

38 
	g»quœeSŒoke
 = 
Œue
;

39 
	gPE_VISIBLE
:

40 
»quœeVisibË
 = 
Œue
;

41 
	gÿnH™Fl
 = 
Œue
;

42 
	gÿnH™SŒoke
 = 
Œue
;

44 
	gPE_VISIBLE_FILL
:

45 
»quœeVisibË
 = 
Œue
;

46 
	gÿnH™Fl
 = 
Œue
;

48 
	gPE_VISIBLE_STROKE
:

49 
»quœeVisibË
 = 
Œue
;

50 
	gÿnH™SŒoke
 = 
Œue
;

52 
	gPE_PAINTED
:

53 
»quœeFl
 = 
Œue
;

54 
	g»quœeSŒoke
 = 
Œue
;

55 
	gPE_ALL
:

56 
ÿnH™Fl
 = 
Œue
;

57 
	gÿnH™SŒoke
 = 
Œue
;

59 
	gPE_FILL
:

60 
ÿnH™Fl
 = 
Œue
;

62 
	gPE_STROKE
:

63 
ÿnH™SŒoke
 = 
Œue
;

65 
	gPE_NONE
:

70 
	gpoš‹rEv’ts
)

72 
	gPE_VISIBLE_PAINTED
:

73 
PE_AUTO
:

74 
»quœeVisibË
 = 
Œue
;

75 
	g»quœeFl
 = 
Œue
;

76 
	g»quœeSŒoke
 = 
Œue
;

77 
	gÿnH™Fl
 = 
Œue
;

78 
	gÿnH™SŒoke
 = 
Œue
;

80 
	gPE_VISIBLE_FILL
:

81 
PE_VISIBLE_STROKE
:

82 
PE_VISIBLE
:

83 
»quœeVisibË
 = 
Œue
;

84 
	gÿnH™Fl
 = 
Œue
;

85 
	gÿnH™SŒoke
 = 
Œue
;

87 
	gPE_PAINTED
:

88 
»quœeFl
 = 
Œue
;

89 
	g»quœeSŒoke
 = 
Œue
;

90 
	gÿnH™Fl
 = 
Œue
;

91 
	gÿnH™SŒoke
 = 
Œue
;

93 
	gPE_FILL
:

94 
PE_STROKE
:

95 
PE_ALL
:

96 
ÿnH™Fl
 = 
Œue
;

97 
	gÿnH™SŒoke
 = 
Œue
;

99 
	gPE_NONE
:

	@PointerEventsHitRules.h

20 #iâdeà
Poš‹rEv’tsH™RuËs_h


21 
	#Poš‹rEv’tsH™RuËs_h


	)

23 
	~"R’d”StyËCÚ¡ªts.h
"

25 
Çme¥aû
 
	gWebCÜe
 {

27 şas 
	cPoš‹rEv’tsH™RuËs
 {

28 
	gpublic
:

29 
	eEH™Te¡šg
 {

30 
SVG_IMAGE_HITTESTING
,

31 
	gSVG_PATH_HITTESTING
,

32 
	gSVG_TEXT_HITTESTING


35 
Poš‹rEv’tsH™RuËs
(
EH™Te¡šg
, 
EPoš‹rEv’ts
);

37 
boŞ
 
	g»quœeVisibË
;

38 
boŞ
 
	g»quœeFl
;

39 
boŞ
 
	g»quœeSŒoke
;

40 
boŞ
 
	gÿnH™SŒoke
;

41 
boŞ
 
	gÿnH™Fl
;

	@RenderApplet.cpp

22 
	~"cÚfig.h
"

23 
	~"R’d”AµËt.h
"

25 
	~"F¿me.h
"

26 
	~"HTMLAµËtEËm’t.h
"

27 
	~"HTMLNames.h
"

28 
	~"HTMLP¬amEËm’t.h
"

29 
	~"Widg‘.h
"

31 
Çme¥aû
 
	gWebCÜe
 {

33 
usšg
 
Çme¥aû
 
	gHTMLNames
;

35 
	gR’d”AµËt
::
R’d”AµËt
(
HTMLAµËtEËm’t
* 
­¶‘
, cÚ¡ 
HashM­
<
SŒšg
, SŒšg>& 
¬gs
)

36 : 
R’d”Widg‘
(
­¶‘
)

37 , 
m_¬gs
(
¬gs
)

39 
£tIÆše
(
Œue
);

42 
IÁSize
 
	gR’d”AµËt
::
šŒšsicSize
() const

48  
widg‘
(è? 
IÁSize
(50, 50) : IntSize(150, 150);

51 
	gR’d”AµËt
::
ü—‹Widg‘IfNeûs§ry
()

53 
HTMLAµËtEËm’t
* 
–em’t
 = 
¡©ic_ÿ¡
<HTMLAµËtEËm’t*>(
node
());

54 ià(
widg‘
(è|| !
	g–em’t
->
isFšishedP¬sšgChd»n
())

61 
	gcÚ‹ÁWidth
 = 
¡yË
()->
width
().
isFixed
(è? styË()->width().
v®ue
() :

62 
width
(è- 
bÜd”Leá
(è- 
bÜd”Right
(è- 
·ddšgLeá
(è- 
·ddšgRight
();

63 
	gcÚ‹ÁHeight
 = 
¡yË
()->
height
().
isFixed
(è? styË()->height().
v®ue
() :

64 
height
(è- 
bÜd”Tİ
(è- 
bÜd”BÙtom
(è- 
·ddšgTİ
(è- 
·ddšgBÙtom
();

65 
Node
* 
	gchd
 = 
–em’t
->
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
()) {

66 ià(
chd
->
hasTagName
(
·¿mTag
)) {

67 
HTMLP¬amEËm’t
* 
p
 = 
¡©ic_ÿ¡
<HTMLP¬amEËm’t*>(
chd
);

68 ià(!
	gp
->
Çme
().
isEm±y
())

69 
	gm_¬gs
.
£t
(
p
->
Çme
(),…->
v®ue
());

73 
F¿me
* 
	gäame
 = 
docum’t
()->
äame
();

74 
ASSERT
(
äame
);

75 
£tWidg‘
(
äame
->
lßd”
()->
ü—‹JavaAµËtWidg‘
(
IÁSize
(
cÚ‹ÁWidth
, 
cÚ‹ÁHeight
), 
–em’t
, 
m_¬gs
));

78 
	gR’d”AµËt
::
Ïyout
()

80 
ASSERT
(
ÃedsLayout
());

82 
ÿlcWidth
();

83 
ÿlcHeight
();

86 
ü—‹Widg‘IfNeûs§ry
();

87 
£tN“dsLayout
(
çl£
);

	@RenderApplet.h

22 #iâdeà
R’d”AµËt_h


23 
	#R’d”AµËt_h


	)

25 
	~"R’d”Widg‘.h
"

26 
	~"SŒšgHash.h
"

28 
Çme¥aû
 
	gWebCÜe
 {

30 
şass
 
	gHTMLAµËtEËm’t
;

32 şas 
	cR’d”AµËt
 : 
public
 
R’d”Widg‘
 {

33 
public
:

34 
R’d”AµËt
(
HTMLAµËtEËm’t
*, cÚ¡ 
HashM­
<
SŒšg
, SŒšg>& 
¬gs
);

36 
ü—‹Widg‘IfNeûs§ry
();

38 
	g´iv©e
:

39 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderApplet"; }

41 
vœtu®
 
boŞ
 
isAµËt
(ècÚ¡ {  
	gŒue
; }

43 
vœtu®
 
Ïyout
();

44 
vœtu®
 
IÁSize
 
šŒšsicSize
() const;

46 
	gHashM­
<
	gSŒšg
, SŒšg> 
	gm_¬gs
;

49 
šlše
 
R’d”AµËt
* 
	$toR’d”AµËt
(
R’d”Objeù
* 
objeù
)

51 
	`ASSERT
(!
objeù
 || objeù->
	`isAµËt
());

52  
¡©ic_ÿ¡
<
R’d”AµËt
*>(
objeù
);

53 
	}
}

56 
toR’d”AµËt
(cÚ¡ 
R’d”AµËt
*);

	@RenderArena.cpp

35 
	~"cÚfig.h
"

36 
	~"R’d”A»Ç.h
"

38 
	~<¡dlib.h
>

39 
	~<¡ršg.h
>

40 
	~<wtf/As£¹iÚs.h
>

42 
	#ROUNDUP
(
x
, 
y
è((((x)+((y)-1))/(y))*(y))

	)

44 
Çme¥aû
 
	gWebCÜe
 {

46 #iâdeà
NDEBUG


48 cÚ¡ 
	gsigÇtu»
 = 0xDBA00AEA;

49 cÚ¡ 
	gsigÇtu»D—d
 = 0xDBA00AED;

52 
R’d”A»Ç
* 
	g¬’a
;

53 
size_t
 
	gsize
;

54 
	gsigÇtu»
;

55 } 
	tR’d”A»ÇDebugH—d”
;

59 
	gR’d”A»Ç
::
R’d”A»Ç
(
¬’aSize
)

62 
INIT_ARENA_POOL
(&
m_poŞ
, "R’d”A»Ç", 
¬’aSize
);

65 
mem£t
(
m_»cyş”s
, 0, (m_recyclers));

68 
	gR’d”A»Ç
::~
R’d”A»Ç
()

70 
FšishA»ÇPoŞ
(&
m_poŞ
);

73 * 
	gR’d”A»Ç
::
®loÿ‹
(
size_t
 
size
)

75 #iâdeà
NDEBUG


77 
ASSERT
(
this
);

78 * 
	gblock
 = ::
m®loc
((
R’d”A»ÇDebugH—d”
è+ 
size
);

79 
R’d”A»ÇDebugH—d”
* 
	gh—d”
 = 
¡©ic_ÿ¡
<R’d”A»ÇDebugH—d”*>(
block
);

80 
	gh—d”
->
	g¬’a
 = 
this
;

81 
	gh—d”
->
	gsize
 = 
size
;

82 
	gh—d”
->
	gsigÇtu»
 = 
sigÇtu»
;

83  
	gh—d”
 + 1;

85 * 
	g»suÉ
 = 0;

88 
	gsize
 = 
ROUNDUP
(
size
, (*));

91 ià(
	gsize
 < 
	ggMaxRecyşedSize
) {

92 cÚ¡ 
	gšdex
 = 
size
 >> 2;

94 
	g»suÉ
 = 
m_»cyş”s
[
šdex
];

95 ià(
	g»suÉ
) {

97 * 
	gÃxt
 = *((**)
»suÉ
);

98 
	gm_»cyş”s
[
šdex
] = 
Ãxt
;

102 ià(!
	g»suÉ
) {

104 
ARENA_ALLOCATE
(
»suÉ
, &
m_poŞ
, 
size
);

107  
	g»suÉ
;

111 
	gR’d”A»Ç
::
ä“
(
size_t
 
size
, * 
±r
)

113 #iâdeà
NDEBUG


115 
R’d”A»ÇDebugH—d”
* 
	gh—d”
 = 
¡©ic_ÿ¡
<R’d”A»ÇDebugH—d”*>(
±r
) - 1;

116 
ASSERT
(
h—d”
->
sigÇtu»
 == signature);

117 
ASSERT_UNUSED
(
size
, 
h—d”
->size == size);

118 
ASSERT
(
h—d”
->
¬’a
 =ğ
this
);

119 
	gh—d”
->
	gsigÇtu»
 = 
sigÇtu»D—d
;

120 ::
ä“
(
h—d”
);

123 
	gsize
 = 
ROUNDUP
(
size
, (*));

126 ià(
	gsize
 < 
	ggMaxRecyşedSize
) {

127 cÚ¡ 
	gšdex
 = 
size
 >> 2;

128 * 
	gcu¼’tTİ
 = 
m_»cyş”s
[
šdex
];

129 
	gm_»cyş”s
[
šdex
] = 
±r
;

130 *((**)
	g±r
èğ
cu¼’tTİ
;

	@RenderArena.h

35 #iâdeà
R’d”A»Ç_h


36 
	#R’d”A»Ç_h


	)

38 
	~"A»Ç.h
"

39 
	~<wtf/NÚcİyabË.h
>

41 
Çme¥aû
 
	gWebCÜe
 {

43 cÚ¡ 
size_t
 
	ggMaxRecyşedSize
 = 400;

45 şas 
	cR’d”A»Ç
 : 
public
 
NÚcİyabË
 {

46 
public
:

47 
R’d”A»Ç
(
¬’aSize
 = 4096);

48 ~
R’d”A»Ç
();

51 * 
®loÿ‹
(
size_t
);

52 
ä“
(
size_t
, *);

54 
	g´iv©e
:

56 
A»ÇPoŞ
 
m_poŞ
;

60 * 
	gm_»cyş”s
[
gMaxRecyşedSize
 >> 2];

	@RenderBR.cpp

22 
	~"cÚfig.h
"

23 
	~"R’d”BR.h
"

25 
	~"Docum’t.h
"

26 
	~"IÆšeTextBox.h
"

27 
	~"VisibËPos™iÚ.h
"

29 
Çme¥aû
 
	gWebCÜe
 {

31 
	gR’d”BR
::
R’d”BR
(
Node
* 
node
)

32 : 
R’d”Text
(
node
, 
SŒšgIm¶
::
ü—‹
("\n"))

33 , 
m_lšeHeight
(-1)

37 
	gR’d”BR
::~
R’d”BR
()

41 
R’d”BR
::
ba£lšePos™iÚ
(
boŞ
 
fœ¡Lše
, boŞ 
isRoÙLšeBox
) const

43 ià(
fœ¡TextBox
(è&& !fœ¡TextBox()->
isText
())

45  
	gR’d”Text
::
ba£lšePos™iÚ
(
fœ¡Lše
, 
isRoÙLšeBox
);

48 
	gR’d”BR
::
lšeHeight
(
boŞ
 
fœ¡Lše
, bool ) const

50 ià(
fœ¡TextBox
(è&& !fœ¡TextBox()->
isText
())

53 ià(
	gfœ¡Lše
) {

54 
R’d”StyË
* 
	gs
 = 
¡yË
(
fœ¡Lše
);

55 
L’gth
 
	glh
 = 
s
->
lšeHeight
();

56 ià(
	glh
.
isNeg©ive
()) {

57 ià(
	gs
 =ğ
¡yË
()) {

58 ià(
m_lšeHeight
 == -1)

59 
m_lšeHeight
 = 
R’d”Objeù
::
lšeHeight
(
çl£
);

60  
	gm_lšeHeight
;

62  
	gs
->
fÚt
().
lšeS·cšg
();

64 ià(
	glh
.
isP”ûÁ
())

65  
	glh
.
ÿlcMšV®ue
(
s
->
fÚtSize
());

66  
	glh
.
v®ue
();

69 ià(
	gm_lšeHeight
 == -1)

70 
m_lšeHeight
 = 
R’d”Objeù
::
lšeHeight
(
çl£
);

71  
	gm_lšeHeight
;

74 
	gR’d”BR
::
¡yËDidChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
)

76 
	gR’d”Text
::
¡yËDidChªge
(
diff
, 
ŞdStyË
);

77 
	gm_lšeHeight
 = -1;

80 
	gR’d”BR
::
ÿ»tMšOff£t
() const

85 
	gR’d”BR
::
ÿ»tMaxOff£t
() const

90 
	gR’d”BR
::
ÿ»tMaxR’d”edOff£t
() const

95 
VisibËPos™iÚ
 
	gR’d”BR
::
pos™iÚFÜPošt
(cÚ¡ 
IÁPošt
&)

97  
ü—‹VisibËPos™iÚ
(0, 
DOWNSTREAM
);

	@RenderBR.h

21 #iâdeà
R’d”BR_h


22 
	#R’d”BR_h


	)

24 
	~"R’d”Text.h
"

30 
Çme¥aû
 
	gWebCÜe
 {

32 
şass
 
	gPos™iÚ
;

34 şas 
	cR’d”BR
 : 
public
 
R’d”Text
 {

35 
public
:

36 
R’d”BR
(
Node
*);

37 
	gvœtu®
 ~
R’d”BR
();

39 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderBR"; }

41 
vœtu®
 
IÁReù
 
£ËùiÚReùFÜR•ašt
(
R’d”BoxMod–Objeù
* , 
boŞ
 ) {  IntRect(); }

43 
vœtu®
 
width
(, , cÚ¡ 
FÚt
&, ) const {  0; }

44 
vœtu®
 
width
(, , , 
boŞ
 ) const {  0; }

46 
vœtu®
 
lšeHeight
(
boŞ
 
fœ¡Lše
, boŞ 
isRoÙLšeBox
 = 
çl£
) const;

47 
vœtu®
 
ba£lšePos™iÚ
(
boŞ
 
fœ¡Lše
, boŞ 
isRoÙLšeBox
 = 
çl£
) const;

50 
vœtu®
 
boŞ
 
isBR
(ècÚ¡ {  
	gŒue
; }

52 
vœtu®
 
ÿ»tMšOff£t
() const;

53 
vœtu®
 
ÿ»tMaxOff£t
() const;

54 
vœtu®
 
ÿ»tMaxR’d”edOff£t
() const;

56 
vœtu®
 
VisibËPos™iÚ
 
pos™iÚFÜPošt
(cÚ¡ 
IÁPošt
&);

58 
	g´Ùeùed
:

59 
vœtu®
 
¡yËDidChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
);

61 
	g´iv©e
:

62 
mubË
 
m_lšeHeight
;

	@RenderBlock.cpp

23 
	~"cÚfig.h
"

24 
	~"R’d”Block.h
"

26 
	~"Docum’t.h
"

27 
	~"EËm’t.h
"

28 
	~"FlßtQuad.h
"

29 
	~"F¿me.h
"

30 
	~"F¿meV›w.h
"

31 
	~"G¿phicsCÚ‹xt.h
"

32 
	~"HTMLFÜmEËm’t.h
"

33 
	~"HTMLNames.h
"

34 
	~"H™Te¡ResuÉ.h
"

35 
	~"IÆšeTextBox.h
"

36 
	~"R’d”FËxibËBox.h
"

37 
	~"R’d”Image.h
"

38 
	~"R’d”IÆše.h
"

39 
	~"R’d”M¬qu“.h
"

40 
	~"R’d”R•liÿ.h
"

41 
	~"R’d”TabËC–l.h
"

42 
	~"R’d”TextF¿gm’t.h
"

43 
	~"R’d”Theme.h
"

44 
	~"R’d”V›w.h
"

45 
	~"S–eùiÚCÚŒŞËr.h
"

46 
	~"S‘tšgs.h
"

47 
	~"T¿nsfÜmS‹.h
"

48 
	~<wtf/StdLibExŒas.h
>

50 
usšg
 
Çme¥aû
 
	g¡d
;

51 
usšg
 
Çme¥aû
 
	gWTF
;

52 
usšg
 
Çme¥aû
 
	gUnicode
;

54 
Çme¥aû
 
	gWebCÜe
 {

58 cÚ¡ 
	gv”tiÿlLšeClickFudgeFaùÜ
 = 3;

60 
usšg
 
Çme¥aû
 
	gHTMLNames
;

62 
	gCŞumnInfo
 : 
public
 
NÚcİyabË
 {

63 
CŞumnInfo
()

64 : 
m_desœedCŞumnWidth
(0)

65 , 
m_desœedCŞumnCouÁ
(1)

67 
	gm_desœedCŞumnWidth
;

68 
	gm_desœedCŞumnCouÁ
;

69 
	gVeùÜ
<
	gIÁReù
> 
	gm_cŞumnReùs
;

72 
	gWTF
::
	tHashM­
<cÚ¡ 
	tR’d”Box
*, 
	tCŞumnInfo
*> 
	tCŞumnInfoM­
;

73 
CŞumnInfoM­
* 
	ggCŞumnInfoM­
 = 0;

75 
	gWTF
::
	tHashM­
<cÚ¡ 
	tR’d”Block
*, 
	tHashS‘
<
	tR’d”Box
*>*> 
	tP”ûÁHeightDesûndªtsM­
;

76 
P”ûÁHeightDesûndªtsM­
* 
	ggP”ûÁHeightDesûndªtsM­
 = 0;

78 
	gWTF
::
	tHashM­
<cÚ¡ 
	tR’d”Box
*, 
	tHashS‘
<
	tR’d”Block
*>*> 
	tP”ûÁHeightCÚš”M­
;

79 
P”ûÁHeightCÚš”M­
* 
	ggP”ûÁHeightCÚš”M­
 = 0;

81 
	gWTF
::
	tHashM­
<
	tR’d”Block
*, 
	tLi¡HashS‘
<
	tR’d”IÆše
*>*> 
	tCÚtšu©iÚOušeTabËM­
;

83 
	gWTF
::
	tHashS‘
<
	tR’d”Block
*> 
	tD–ayedUpd©eSüŞlInfoS‘
;

84 
	ggD–ayUpd©eSüŞlInfo
 = 0;

85 
D–ayedUpd©eSüŞlInfoS‘
* 
	ggD–ayedUpd©eSüŞlInfoS‘
 = 0;

88 
	gR’d”Block
::
M¬gšInfo
::M¬gšInfo(
R’d”Block
* 
block
, 
tİ
, 
bÙtom
)

93 
	gm_ÿnCŞÏp£W™hChd»n
 = !
block
->
isR’d”V›w
(è&& !block->
isRoÙ
(è&& !block->
isPos™iÚed
() &&

94 !
block
->
isFlßtšg
(è&& !block->
isTabËC–l
(è&& !block->
hasOv”æowCl
(è&& !block->
isIÆšeBlockOrIÆšeTabË
();

96 
	gm_ÿnCŞÏp£TİW™hChd»n
 = 
m_ÿnCŞÏp£W™hChd»n
 && (
tİ
 =ğ0è&& 
block
->
¡yË
()->
m¬gšTİCŞÏp£
(è!ğ
MSEPARATE
;

102 
	gm_ÿnCŞÏp£BÙtomW™hChd»n
 = 
m_ÿnCŞÏp£W™hChd»n
 && (
bÙtom
 == 0) &&

103 (
block
->
¡yË
()->
height
().
isAuto
(è&& block->¡yË()->height().
v®ue
(è=ğ0è&& block->¡yË()->
m¬gšBÙtomCŞÏp£
(è!ğ
MSEPARATE
;

105 
	gm_quœkCÚš”
 = 
block
->
isTabËC–l
(è|| block->
isBody
(è|| block->
¡yË
()->
m¬gšTİCŞÏp£
(è=ğ
MDISCARD
 ||

106 
block
->
¡yË
()->
m¬gšBÙtomCŞÏp£
(è=ğ
MDISCARD
;

108 
	gm_©TİOfBlock
 = 
Œue
;

109 
	gm_©BÙtomOfBlock
 = 
çl£
;

111 
	gm_posM¬gš
 = 
m_ÿnCŞÏp£TİW™hChd»n
 ? 
block
->
maxTİM¬gš
(
Œue
) : 0;

112 
	gm_ÃgM¬gš
 = 
m_ÿnCŞÏp£TİW™hChd»n
 ? 
block
->
maxTİM¬gš
(
çl£
) : 0;

114 
	gm_tİQuœk
 = 
m_bÙtomQuœk
 = 
m_d‘”mšedTİQuœk
 = 
çl£
;

119 
	gR’d”Block
::
R’d”Block
(
Node
* 
node
)

120 : 
R’d”Box
(
node
)

121 , 
m_æßtšgObjeùs
(0)

122 , 
m_pos™iÚedObjeùs
(0)

123 , 
m_šlšeCÚtšu©iÚ
(0)

124 , 
m_maxM¬gš
(0)

125 , 
m_lšeHeight
(-1)

127 
£tChd»nIÆše
(
Œue
);

130 
	gR’d”Block
::~
R’d”Block
()

132 
d–‘e
 
m_æßtšgObjeùs
;

133 
d–‘e
 
	gm_pos™iÚedObjeùs
;

134 
d–‘e
 
	gm_maxM¬gš
;

136 ià(
hasCŞumns
())

137 
d–‘e
 
	ggCŞumnInfoM­
->
ke
(
this
);

139 ià(
	ggP”ûÁHeightDesûndªtsM­
) {

140 ià(
	gHashS‘
<
	gR’d”Box
*>* 
	gdesûndªtS‘
 = 
gP”ûÁHeightDesûndªtsM­
->
ke
(
this
)) {

141 
HashS‘
<
R’d”Box
*>::
™”©Ü
 
’d
 = 
desûndªtS‘
->end();

142 
	gHashS‘
<
	gR’d”Box
*>::
™”©Ü
 
desûndªt
 = 
desûndªtS‘
->
begš
(); 
	gdesûndªt
 !ğ
’d
; ++descendant) {

143 
	gHashS‘
<
	gR’d”Block
*>* 
	gcÚš”S‘
 = 
gP”ûÁHeightCÚš”M­
->
g‘
(*
desûndªt
);

144 
ASSERT
(
cÚš”S‘
);

145 ià(!
	gcÚš”S‘
)

147 
ASSERT
(
cÚš”S‘
->
cÚšs
(
this
));

148 
	gcÚš”S‘
->
»move
(
this
);

149 ià(
	gcÚš”S‘
->
isEm±y
()) {

150 
	ggP”ûÁHeightCÚš”M­
->
»move
(*
desûndªt
);

151 
d–‘e
 
	gcÚš”S‘
;

154 
d–‘e
 
	gdesûndªtS‘
;

159 
	gR’d”Block
::
de¡roy
()

163 
chd»n
()->
de¡royLeáov”Chd»n
();

168 ià(
	gm_šlšeCÚtšu©iÚ
) {

169 
	gm_šlšeCÚtšu©iÚ
->
de¡roy
();

170 
	gm_šlšeCÚtšu©iÚ
 = 0;

173 ià(!
docum’tBešgDe¡royed
()) {

174 ià(
fœ¡LšeBox
()) {

179 ià(
isS–eùiÚBÜd”
())

180 
v›w
()->
ş—rS–eùiÚ
();

185 ià(
isAnÚymousBlock
()) {

186 
IÆšeFlowBox
* 
	gbox
 = 
fœ¡LšeBox
(); box; box = 
box
->
ÃxtLšeBox
()) {

187 
IÆšeBox
* 
chdBox
 = 
box
->
fœ¡Chd
())

188 
chdBox
->
»move
();

191 } ià(
isIÆše
(è&& 
·»Á
())

192 
·»Á
()->
dœtyLšesFromChªgedChd
(
this
);

195 
	gm_lšeBoxes
.
d–‘eLšeBoxes
(
»nd”A»Ç
());

197 
	gR’d”Box
::
de¡roy
();

200 
	gR’d”Block
::
¡yËWlChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ÃwStyË
)

202 
£tR•Ïûd
(
ÃwStyË
->
isDi¥ÏyR•ÏûdTy³
());

204 ià(
¡yË
(è&& 
·»Á
(è&& 
	gdiff
 =ğ
StyËDifã»nûLayout
 && styË()->
pos™iÚ
(è!ğ
ÃwStyË
->position()) {

205 ià(
ÃwStyË
->
pos™iÚ
(è=ğ
SticPos™iÚ
)

208 
»movePos™iÚedObjeùs
(0);

209 ià(
¡yË
()->
pos™iÚ
(è=ğ
SticPos™iÚ
) {

212 
R’d”Objeù
* 
cb
 = 
·»Á
();

213 
	gcb
 && (cb->
¡yË
()->
pos™iÚ
(è=ğ
SticPos™iÚ
 || (
cb
->
isIÆše
(è&& !cb->
isR•Ïûd
())è&& !cb->
isR’d”V›w
()) {

214 ià(
cb
->
¡yË
()->
pos™iÚ
(è=ğ
R–©ivePos™iÚ
 && cb->
isIÆše
(è&& !cb->
isR•Ïûd
()) {

215 
cb
 = cb->
cÚššgBlock
();

218 
	gcb
 = 
cb
->
·»Á
();

221 ià(
	gcb
->
isR’d”Block
())

222 
toR’d”Block
(
cb
)->
»movePos™iÚedObjeùs
(
this
);

226 
	gR’d”Box
::
¡yËWlChªge
(
diff
, 
ÃwStyË
);

229 
	gR’d”Block
::
¡yËDidChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
)

231 
	gR’d”Box
::
¡yËDidChªge
(
diff
, 
ŞdStyË
);

234 
R’d”Objeù
* 
	gchd
 = 
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
()) {

235 ià(
chd
->
isAnÚymousBlock
()) {

236 
RefPŒ
<
R’d”StyË
> 
ÃwStyË
 = R’d”StyË::
ü—‹
();

237 
	gÃwStyË
->
šh”™From
(
¡yË
());

238 
	gÃwStyË
->
£tDi¥Ïy
(
BLOCK
);

239 
	gchd
->
£tStyË
(
ÃwStyË
.
»Ëa£
());

243 
	gm_lšeHeight
 = -1;

246 ià(!
isAnÚymous
(è&& 
docum’t
()->
u£sBefÜeAá”RuËs
(è&& 
ÿnHaveChd»n
()) {

247 
upd©eBefÜeAá”CÚ‹Á
(
BEFORE
);

248 
upd©eBefÜeAá”CÚ‹Á
(
AFTER
);

250 
upd©eFœ¡L‘‹r
();

253 
	gR’d”Block
::
upd©eBefÜeAá”CÚ‹Á
(
P£udoId
 
p£udoId
)

256 ià(
·»Á
(è&&…¬’t()->
ü—‹sAnÚymousW¿µ”
())

258  
chd»n
()->
upd©eBefÜeAá”CÚ‹Á
(
this
, 
p£udoId
);

261 
	gR’d”Block
::
addChd
(
R’d”Objeù
* 
ÃwChd
, R’d”Objeù* 
befÜeChd
)

264 ià(!
	gbefÜeChd
) {

265 
R’d”Objeù
* 
	gÏ¡R’d””
 = 
Ï¡Chd
();

267 ià(
isAá”CÚ‹Á
(
Ï¡R’d””
))

268 
	gbefÜeChd
 = 
Ï¡R’d””
;

269 ià(
	gÏ¡R’d””
 &&†a¡R’d””->
isAnÚymousBlock
(è&& 
isAá”CÚ‹Á
(
Ï¡R’d””
->
Ï¡Chd
()))

270 
	gbefÜeChd
 = 
Ï¡R’d””
->
Ï¡Chd
();

273 
boŞ
 
	gmadeBoxesNÚIÆše
 = 
çl£
;

277 ià(
	gbefÜeChd
 && befÜeChd->
·»Á
(è!ğ
this
) {

278 
R’d”Objeù
* 
ªÚymousChd
 = 
befÜeChd
->
·»Á
();

279 
ASSERT
(
ªÚymousChd
);

281 
	gªÚymousChd
->
·»Á
(è!ğ
this
)

282 
ªÚymousChd
 =‡nÚymousChd->
·»Á
();

284 
ASSERT
(
ªÚymousChd
->
isAnÚymous
());

286 ià(
	gªÚymousChd
->
isAnÚymousBlock
()) {

288 ià(
	gÃwChd
->
isIÆše
(è|| 
	gbefÜeChd
->
·»Á
()->
fœ¡Chd
(è!ğ
befÜeChd
)

289 
befÜeChd
->
·»Á
()->
addChd
(
ÃwChd
, beforeChild);

291 
addChd
(
ÃwChd
, 
befÜeChd
->
·»Á
());

295 
ASSERT
(
ªÚymousChd
->
isTabË
());

296 ià((
	gÃwChd
->
isTabËCŞ
(è&&‚ewChd->
¡yË
()->
di¥Ïy
(è=ğ
TABLE_COLUMN_GROUP
)

297 || (
ÃwChd
->
isR’d”Block
(è&&‚ewChd->
¡yË
()->
di¥Ïy
(è=ğ
TABLE_CAPTION
)

298 || 
ÃwChd
->
isTabËSeùiÚ
()

299 || 
ÃwChd
->
isTabËRow
()

300 || 
ÃwChd
->
isTabËC–l
()) {

302 
ªÚymousChd
->
addChd
(
ÃwChd
, 
befÜeChd
);

307 
	gbefÜeChd
 = 
ªÚymousChd
;

313 ià(
chd»nIÆše
(è&& !
	gÃwChd
->
isIÆše
(è&& !ÃwChd->
isFlßtšgOrPos™iÚed
()) {

315 
makeChd»nNÚIÆše
(
befÜeChd
);

316 
	gmadeBoxesNÚIÆše
 = 
Œue
;

318 ià(
	gbefÜeChd
 && befÜeChd->
·»Á
(è!ğ
this
) {

319 
befÜeChd
 = befÜeChd->
·»Á
();

320 
ASSERT
(
befÜeChd
->
isAnÚymousBlock
());

321 
ASSERT
(
befÜeChd
->
·»Á
(è=ğ
this
);

323 } ià(!
chd»nIÆše
(è&& (
	gÃwChd
->
isFlßtšgOrPos™iÚed
(è||‚ewChd->
isIÆše
())) {

327 
R’d”Objeù
* 
	gaá”Chd
 = 
befÜeChd
 ? befÜeChd->
´eviousSiblšg
(è: 
Ï¡Chd
();

329 ià(
	gaá”Chd
 &&‡á”Chd->
isAnÚymousBlock
()) {

330 
	gaá”Chd
->
addChd
(
ÃwChd
);

334 ià(
	gÃwChd
->
isIÆše
()) {

336 
R’d”Block
* 
	gÃwBox
 = 
ü—‹AnÚymousBlock
();

337 
	gR’d”Box
::
addChd
(
ÃwBox
, 
befÜeChd
);

338 
	gÃwBox
->
addChd
(
ÃwChd
);

343 
	gR’d”Box
::
addChd
(
ÃwChd
, 
befÜeChd
);

345 ià(
	gmadeBoxesNÚIÆše
 && 
·»Á
(è&& 
isAnÚymousBlock
(è&&…¬’t()->
isR’d”Block
())

346 
toR’d”Block
(
·»Á
())->
»moveLeáov”AnÚymousBlock
(
this
);

350 
g‘IÆšeRun
(
R’d”Objeù
* 
¡¬t
, R’d”Objeù* 
bound¬y
,

351 
R’d”Objeù
*& 
šlšeRunS¹
,

352 
R’d”Objeù
*& 
šlšeRunEnd
)

367 
R’d”Objeù
 * 
	gcu¼
 = 
¡¬t
;

368 
boŞ
 
	g§wIÆše
;

370 
	gcu¼
 && !(cu¼->
isIÆše
(è|| cu¼->
isFlßtšgOrPos™iÚed
()))

371 
	gcu¼
 = 
cu¼
->
ÃxtSiblšg
();

373 
	gšlšeRunS¹
 = 
šlšeRunEnd
 = 
cu¼
;

375 ià(!
	gcu¼
)

378 
	g§wIÆše
 = 
cu¼
->
isIÆše
();

380 
	gcu¼
 = 
cu¼
->
ÃxtSiblšg
();

381 
	gcu¼
 && (cu¼->
isIÆše
(è|| cu¼->
isFlßtšgOrPos™iÚed
()è&& (cu¼ !ğ
bound¬y
)) {

382 
šlšeRunEnd
 = 
cu¼
;

383 ià(
	gcu¼
->
isIÆše
())

384 
	g§wIÆše
 = 
Œue
;

385 
	gcu¼
 = 
cu¼
->
ÃxtSiblšg
();

387 } !
	g§wIÆše
);

390 
	gR’d”Block
::
d–‘eLšeBoxT»e
()

392 
m_lšeBoxes
.
d–‘eLšeBoxT»e
(
»nd”A»Ç
());

395 
RoÙIÆšeBox
* 
	gR’d”Block
::
ü—‹RoÙIÆšeBox
()

397  
Ãw
 (
»nd”A»Ç
()è
RoÙIÆšeBox
(
this
);

400 
RoÙIÆšeBox
* 
	gR’d”Block
::
ü—‹AndAµ’dRoÙIÆšeBox
()

402 
RoÙIÆšeBox
* 
roÙBox
 = 
ü—‹RoÙIÆšeBox
();

403 
	gm_lšeBoxes
.
­³ndLšeBox
(
roÙBox
);

404  
	groÙBox
;

407 
	gR’d”Block
::
moveChdTo
(
R’d”Objeù
* 
to
, 
R’d”ObjeùChdLi¡
* 
toChdLi¡
, R’d”Objeù* 
chd
)

409 
ASSERT
(
this
 =ğ
chd
->
·»Á
());

410 
	gtoChdLi¡
->
­³ndChdNode
(
to
, 
chd»n
()->
»moveChdNode
(
this
, 
chd
, 
çl£
), false);

413 
	gR’d”Block
::
moveChdTo
(
R’d”Objeù
* 
to
, 
R’d”ObjeùChdLi¡
* 
toChdLi¡
, R’d”Objeù* 
befÜeChd
, R’d”Objeù* 
chd
)

415 
ASSERT
(
this
 =ğ
chd
->
·»Á
());

416 
ASSERT
(!
befÜeChd
 || 
to
 =ğbefÜeChd->
·»Á
());

417 
	gtoChdLi¡
->
š£¹ChdNode
(
to
, 
chd»n
()->
»moveChdNode
(
this
, 
chd
, 
çl£
), 
befÜeChd
, false);

420 
	gR’d”Block
::
moveAÎChd»nTo
(
R’d”Objeù
* 
to
, 
R’d”ObjeùChdLi¡
* 
toChdLi¡
)

422 
R’d”Objeù
* 
	gÃxtChd
 = 
chd»n
()->
fœ¡Chd
();

423 
	gÃxtChd
) {

424 
R’d”Objeù
* 
	gchd
 = 
ÃxtChd
;

425 
	gÃxtChd
 = 
chd
->
ÃxtSiblšg
();

426 
	gtoChdLi¡
->
­³ndChdNode
(
to
, 
chd»n
()->
»moveChdNode
(
this
, 
chd
, 
çl£
), false);

430 
	gR’d”Block
::
moveAÎChd»nTo
(
R’d”Objeù
* 
to
, 
R’d”ObjeùChdLi¡
* 
toChdLi¡
, R’d”Objeù* 
befÜeChd
)

432 
ASSERT
(!
befÜeChd
 || 
to
 =ğbefÜeChd->
·»Á
());

433 ià(!
	gbefÜeChd
) {

434 
moveAÎChd»nTo
(
to
, 
toChdLi¡
);

437 
R’d”Objeù
* 
	gÃxtChd
 = 
chd»n
()->
fœ¡Chd
();

438 
	gÃxtChd
) {

439 
R’d”Objeù
* 
	gchd
 = 
ÃxtChd
;

440 
	gÃxtChd
 = 
chd
->
ÃxtSiblšg
();

441 
	gtoChdLi¡
->
š£¹ChdNode
(
to
, 
chd»n
()->
»moveChdNode
(
this
, 
chd
, 
çl£
), 
befÜeChd
, false);

445 
	gR’d”Block
::
makeChd»nNÚIÆše
(
R’d”Objeù
 *
š£¹iÚPošt
)

454 
ASSERT
(
isIÆšeBlockOrIÆšeTabË
(è|| !
isIÆše
());

455 
ASSERT
(!
š£¹iÚPošt
 || in£¹iÚPošt->
·»Á
(è=ğ
this
);

457 
£tChd»nIÆše
(
çl£
);

459 
R’d”Objeù
 *
	gchd
 = 
fœ¡Chd
();

460 ià(!
	gchd
)

463 
d–‘eLšeBoxT»e
();

465 
	gchd
) {

466 
R’d”Objeù
 *
	gšlšeRunS¹
, *
	gšlšeRunEnd
;

467 
g‘IÆšeRun
(
chd
, 
š£¹iÚPošt
, 
šlšeRunS¹
, 
šlšeRunEnd
);

469 ià(!
	gšlšeRunS¹
)

472 
	gchd
 = 
šlšeRunEnd
->
ÃxtSiblšg
();

474 
R’d”Block
* 
	gblock
 = 
ü—‹AnÚymousBlock
();

475 
chd»n
()->
š£¹ChdNode
(
this
, 
block
, 
šlšeRunS¹
);

476 
R’d”Objeù
* 
	go
 = 
šlšeRunS¹
;

477 
	go
 !ğ
šlšeRunEnd
) {

478 
R’d”Objeù
* 
no
 = 
o
;

479 
	go
 = 
no
->
ÃxtSiblšg
();

481 
moveChdTo
(
block
, block->
chd»n
(), 
no
);

483 
moveChdTo
(
block
, block->
chd»n
(), 
šlšeRunEnd
);

486 #iâdeà
NDEBUG


487 
R’d”Objeù
 *
	gc
 = 
fœ¡Chd
(); c; c = 
c
->
ÃxtSiblšg
())

488 
ASSERT
(!
c
->
isIÆše
());

491 
»·št
();

494 
	gR’d”Block
::
»moveLeáov”AnÚymousBlock
(
R’d”Block
* 
chd
)

496 
ASSERT
(
chd
->
isAnÚymousBlock
());

497 
ASSERT
(!
chd
->
chd»nIÆše
());

499 ià(
	gchd
->
šlšeCÚtšu©iÚ
())

502 
R’d”Objeù
* 
	gfœ¡AnChd
 = 
chd
->
m_chd»n
.
fœ¡Chd
();

503 
R’d”Objeù
* 
	gÏ¡AnChd
 = 
chd
->
m_chd»n
.
Ï¡Chd
();

504 ià(
	gfœ¡AnChd
) {

505 
R’d”Objeù
* 
	go
 = 
fœ¡AnChd
;

506 
	go
) {

507 
	go
->
£tP¬’t
(
this
);

508 
	go
 = 
o
->
ÃxtSiblšg
();

510 
	gfœ¡AnChd
->
£tP»viousSiblšg
(
chd
->
´eviousSiblšg
());

511 
	gÏ¡AnChd
->
£tNextSiblšg
(
chd
->
ÃxtSiblšg
());

512 ià(
	gchd
->
´eviousSiblšg
())

513 
	gchd
->
´eviousSiblšg
()->
£tNextSiblšg
(
fœ¡AnChd
);

514 ià(
	gchd
->
ÃxtSiblšg
())

515 
	gchd
->
ÃxtSiblšg
()->
£tP»viousSiblšg
(
Ï¡AnChd
);

517 ià(
	gchd
->
´eviousSiblšg
())

518 
	gchd
->
´eviousSiblšg
()->
£tNextSiblšg
(
chd
->
ÃxtSiblšg
());

519 ià(
	gchd
->
ÃxtSiblšg
())

520 
	gchd
->
ÃxtSiblšg
()->
£tP»viousSiblšg
(
chd
->
´eviousSiblšg
());

522 ià(
	gchd
 =ğ
m_chd»n
.
fœ¡Chd
())

523 
m_chd»n
.
£tFœ¡Chd
(
fœ¡AnChd
);

524 ià(
	gchd
 =ğ
m_chd»n
.
Ï¡Chd
())

525 
m_chd»n
.
£tLa¡Chd
(
Ï¡AnChd
);

526 
	gchd
->
£tP¬’t
(0);

527 
	gchd
->
£tP»viousSiblšg
(0);

528 
	gchd
->
£tNextSiblšg
(0);

530 
	gchd
->
chd»n
()->
£tFœ¡Chd
(0);

531 
	gchd
->
	gm_Ãxt
 = 0;

533 
	gchd
->
de¡roy
();

536 
	gR’d”Block
::
»moveChd
(
R’d”Objeù
* 
ŞdChd
)

541 
R’d”Objeù
* 
´ev
 = 
ŞdChd
->
´eviousSiblšg
();

542 
R’d”Objeù
* 
	gÃxt
 = 
ŞdChd
->
ÃxtSiblšg
();

543 
boŞ
 
	gÿnD–‘eAnÚymousBlocks
 = !
docum’tBešgDe¡royed
(è&& !
isIÆše
(è&& !
ŞdChd
->isInline() &&

544 (!
ŞdChd
->
isR’d”Block
(è|| !
toR’d”Block
(ŞdChd)->
šlšeCÚtšu©iÚ
()) &&

545 (!
´ev
 || (´ev->
isAnÚymousBlock
(è&&…»v->
chd»nIÆše
())) &&

546 (!
Ãxt
 || (Ãxt->
isAnÚymousBlock
(è&&‚ext->
chd»nIÆše
()));

547 ià(
	gÿnD–‘eAnÚymousBlocks
 && 
	g´ev
 && 
	gÃxt
) {

550 
	g´ev
->
£tN“dsLayoutAndP»fWidthsReÿlc
();

551 
R’d”Block
* 
	gÃxtBlock
 = 
toR’d”Block
(
Ãxt
);

552 
R’d”Block
* 
	g´evBlock
 = 
toR’d”Block
(
´ev
);

553 
	gÃxtBlock
->
moveAÎChd»nTo
(
´evBlock
,…»vBlock->
chd»n
());

555 
	gÃxtBlock
->
d–‘eLšeBoxT»e
();

556 
	gÃxtBlock
->
de¡roy
();

559 
	gR’d”Box
::
»moveChd
(
ŞdChd
);

561 
R’d”Objeù
* 
	gchd
 = 
´ev
 ?…»v : 
Ãxt
;

562 ià(
	gÿnD–‘eAnÚymousBlocks
 && 
	gchd
 && !chd->
´eviousSiblšg
(è&& !chd->
ÃxtSiblšg
(è&& !
isFËxibËBox
()) {

566 
£tN“dsLayoutAndP»fWidthsReÿlc
();

567 
R’d”Block
* 
	gªÚBlock
 = 
toR’d”Block
(
chd»n
()->
»moveChdNode
(
this
, 
chd
, 
çl£
));

568 
£tChd»nIÆše
(
Œue
);

569 
	gªÚBlock
->
moveAÎChd»nTo
(
this
, 
chd»n
());

571 
	gªÚBlock
->
d–‘eLšeBoxT»e
();

572 
	gªÚBlock
->
de¡roy
();

576 ià(
chd»nIÆše
(è&& !
fœ¡Chd
())

577 
lšeBoxes
()->
d–‘eLšeBoxes
(
»nd”A»Ç
());

580 
boŞ
 
	gR’d”Block
::
isS–fCŞÏpsšgBlock
() const

588 ià(
height
() > 0 ||

589 
isTabË
(è|| (
bÜd”BÙtom
(è+ 
·ddšgBÙtom
(è+ 
bÜd”Tİ
(è+ 
·ddšgTİ
()) != 0 ||

590 
¡yË
()->
mšHeight
().
isPos™ive
() ||

591 
¡yË
()->
m¬gšTİCŞÏp£
(è=ğ
MSEPARATE
 || styË()->
m¬gšBÙtomCŞÏp£
() == MSEPARATE)

592  
çl£
;

594 
boŞ
 
	ghasAutoHeight
 = 
¡yË
()->
height
().
isAuto
();

595 ià(
¡yË
()->
height
().
isP”ûÁ
(è&& !¡yË()->
htmlHacks
()) {

596 
	ghasAutoHeight
 = 
Œue
;

597 
R’d”Block
* 
	gcb
 = 
cÚššgBlock
(); !cb->
isR’d”V›w
(); cb = 
cb
->containingBlock()) {

598 ià(
cb
->
¡yË
()->
height
().
isFixed
(è|| cb->
isTabËC–l
())

599 
hasAutoHeight
 = 
çl£
;

605 ià(
	ghasAutoHeight
 || ((
¡yË
()->
height
().
isFixed
(è|| styË()->height().
isP”ûÁ
()è&& styË()->height().
isZ”o
())) {

608 ià(
chd»nIÆše
())

609  !
fœ¡LšeBox
();

613 
R’d”Box
* 
	gchd
 = 
fœ¡ChdBox
(); chd; chd = 
chd
->
ÃxtSiblšgBox
()) {

614 ià(
chd
->
isFlßtšgOrPos™iÚed
())

616 ià(!
	gchd
->
isS–fCŞÏpsšgBlock
())

617  
	gçl£
;

619  
	gŒue
;

621  
	gçl£
;

624 
	gR’d”Block
::
¡¬tD–ayUpd©eSüŞlInfo
()

626 ià(
gD–ayUpd©eSüŞlInfo
 == 0) {

627 
ASSERT
(!
gD–ayedUpd©eSüŞlInfoS‘
);

628 
	ggD–ayedUpd©eSüŞlInfoS‘
 = 
Ãw
 
D–ayedUpd©eSüŞlInfoS‘
;

630 
ASSERT
(
gD–ayedUpd©eSüŞlInfoS‘
);

631 ++
	ggD–ayUpd©eSüŞlInfo
;

634 
	gR’d”Block
::
fšishD–ayUpd©eSüŞlInfo
()

636 --
gD–ayUpd©eSüŞlInfo
;

637 
ASSERT
(
gD–ayUpd©eSüŞlInfo
 >= 0);

638 ià(
	ggD–ayUpd©eSüŞlInfo
 == 0) {

639 
ASSERT
(
gD–ayedUpd©eSüŞlInfoS‘
);

641 
	gOwnPŒ
<
	gD–ayedUpd©eSüŞlInfoS‘
> 
šfoS‘
(
gD–ayedUpd©eSüŞlInfoS‘
);

642 
	ggD–ayedUpd©eSüŞlInfoS‘
 = 0;

644 
	gD–ayedUpd©eSüŞlInfoS‘
::
™”©Ü
 
™
 = 
šfoS‘
->
begš
(); 
	g™
 !ğšfoS‘->
’d
(); ++it) {

645 
R’d”Block
* 
	gblock
 = *
™
;

646 ià(
	gblock
->
hasOv”æowCl
()) {

647 
	gblock
->
Ïy”
()->
upd©eSüŞlInfoAá”Layout
();

653 
	gR’d”Block
::
upd©eSüŞlInfoAá”Layout
()

655 ià(
hasOv”æowCl
()) {

656 ià(
gD–ayUpd©eSüŞlInfo
)

657 
gD–ayedUpd©eSüŞlInfoS‘
->
add
(
this
);

659 
Ïy”
()->
upd©eSüŞlInfoAá”Layout
();

663 
	gR’d”Block
::
Ïyout
()

666 
upd©eFœ¡L‘‹r
();

670 
ÏyoutBlock
(
çl£
);

674 ià(
hasCÚŒŞCl
(è&& 
	gm_ov”æow
)

675 
ş—rLayoutOv”æow
();

678 
	gR’d”Block
::
ÏyoutBlock
(
boŞ
 
»ÏyoutChd»n
)

680 
ASSERT
(
ÃedsLayout
());

682 ià(
isIÆše
(è&& !
isIÆšeBlockOrIÆšeTabË
())

685 ià(!
	g»ÏyoutChd»n
 && 
ÏyoutOÆyPos™iÚedObjeùs
())

688 
LayoutR•aš‹r
 
»·š‹r
(*
this
, 
m_ev”HadLayout
 && 
checkFÜR•aštDuršgLayout
());

689 
LayoutS‹Mašš”
 
¡©ePush”
(
v›w
(), 
this
, 
IÁSize
(
x
(), 
y
()), 
hasCŞumns
(è|| 
hasT¿nsfÜm
(è|| 
hasReæeùiÚ
());

691 
	gŞdWidth
 = 
width
();

692 
	gŞdCŞumnWidth
 = 
desœedCŞumnWidth
();

694 
ÿlcWidth
();

695 
ÿlcCŞumnWidth
();

697 
	gm_ov”æow
.
ş—r
();

699 ià(
	gŞdWidth
 !ğ
width
(è|| 
ŞdCŞumnWidth
 !ğ
desœedCŞumnWidth
())

700 
»ÏyoutChd»n
 = 
Œue
;

702 
ş—rFlßts
();

704 
	g´eviousHeight
 = 
height
();

705 
£tHeight
(0);

717 
boŞ
 
	gisC–l
 = 
isTabËC–l
();

718 ià(!
	gisC–l
) {

719 
š™MaxM¬gšV®ues
();

721 
£tTİM¬gšQuœk
(
¡yË
()->
m¬gšTİ
().
quœk
());

722 
£tBÙtomM¬gšQuœk
(
¡yË
()->
m¬gšBÙtom
().
quœk
());

724 
Node
* 
	gn
 = 
node
();

725 ià(
	gn
 &&‚->
hasTagName
(
fÜmTag
è&& 
	g¡©ic_ÿ¡
<
	gHTMLFÜmEËm’t
*>Ò)->
isM®fÜmed
()) {

728 
£tMaxBÙtomM¬gšs
(0, 0);

733 ià(
süŞlsOv”æow
()) {

734 ià(
¡yË
()->
ov”æowX
(è=ğ
OSCROLL
)

735 
Ïy”
()->
£tHasHÜizÚlSüŞlb¬
(
Œue
);

736 ià(
¡yË
()->
ov”æowY
(è=ğ
OSCROLL
)

737 
Ïy”
()->
£tHasV”tiÿlSüŞlb¬
(
Œue
);

740 
	g»·štTİ
 = 0;

741 
	g»·štBÙtom
 = 0;

742 
	gmaxFlßtBÙtom
 = 0;

743 ià(
chd»nIÆše
())

744 
ÏyoutIÆšeChd»n
(
»ÏyoutChd»n
, 
»·štTİ
, 
»·štBÙtom
);

746 
ÏyoutBlockChd»n
(
»ÏyoutChd»n
, 
maxFlßtBÙtom
);

749 
	gtoAdd
 = 
bÜd”BÙtom
(è+ 
·ddšgBÙtom
(è+ 
hÜizÚlSüŞlb¬Height
();

750 ià(
æßtBÙtom
(è> (
height
(è- 
	gtoAdd
è&& 
ex·ndsToEnşo£Ov”hªgšgFlßts
())

751 
£tHeight
(
æßtBÙtom
(è+ 
toAdd
);

755 
	gsšgËCŞumnBÙtom
 = 
ÏyoutCŞumns
();

758 
	gŞdHeight
 = 
height
();

759 
ÿlcHeight
();

760 ià(
	gŞdHeight
 !ğ
height
()) {

761 ià(
ŞdHeight
 > 
height
(è&& 
maxFlßtBÙtom
 > height(è&& !
chd»nIÆše
()) {

763 
R’d”Objeù
* 
chd
 = 
fœ¡Chd
(); 
	gchd
; chd = chd->
ÃxtSiblšg
()) {

764 ià(
chd
->
isBlockFlow
(è&& !chd->
isFlßtšgOrPos™iÚed
()) {

765 
R’d”Block
* 
block
 = 
toR’d”Block
(
chd
);

766 ià(
	gblock
->
æßtBÙtom
(è+ block->
y
(è> 
height
())

767 
addOv”hªgšgFlßts
(
block
, -block->
x
(), -block->
y
(), 
çl£
);

773 
ÏyoutCŞumns
(
sšgËCŞumnBÙtom
);

776 ià(
	g´eviousHeight
 !ğ
height
())

777 
»ÏyoutChd»n
 = 
Œue
;

781 ià(
isRoÙ
(è|| 
ex·ndsToEnşo£Ov”hªgšgFlßts
())

782 
addOv”æowFromFlßts
();

785 ià(!
hasCŞumns
()) {

786 ià(
chd»nIÆše
())

787 
addOv”æowFromIÆšeChd»n
();

789 
addOv”æowFromBlockChd»n
();

793 
addShadowOv”æow
();

795 
ÏyoutPos™iÚedObjeùs
(
»ÏyoutChd»n
 || 
isRoÙ
());

797 
pos™iÚLi¡M¬k”
();

799 
	g¡©ePush”
.
pİ
();

803 
upd©eSüŞlInfoAá”Layout
();

806 
boŞ
 
	gdidFuÎR•ašt
 = 
»·š‹r
.
»·štAá”Layout
();

807 ià(!
	gdidFuÎR•ašt
 && 
	g»·štTİ
 !ğ
»·štBÙtom
 && (
¡yË
()->
visib™y
(è=ğ
VISIBLE
 || 
’şosšgLay”
()->
hasVisibËCÚ‹Á
())) {

808 
»·štLeá
 = 
mš
(
ËáVisu®Ov”æow
(), 
ËáLayoutOv”æow
());

809 
	g»·štRight
 = 
max
(
rightVisu®Ov”æow
(), 
rightLayoutOv”æow
());

810 
IÁReù
 
»·štReù
(
»·štLeá
, 
»·štTİ
, 
»·štRight
 -„•aštLeá, 
»·štBÙtom
 -„epaintTop);

815 
	g»·štReù
.
šæ©e
(
maxim®OušeSize
(
PaštPha£Ouše
));

817 ià(
hasOv”æowCl
()) {

819 
	g»·štReù
.
move
(-
Ïy”
()->
süŞËdCÚ‹ÁOff£t
());

822 
	g»·štReù
.
š‹r£ù
(
IÁReù
(0, 0, 
width
(), 
height
()));

826 ià(!
	g»·štReù
.
isEm±y
()) {

827 
»·štReùªgË
(
»·štReù
);

828 ià(
hasReæeùiÚ
())

829 
»·štReùªgË
(
»æeùedReù
(
»·štReù
));

832 
£tN“dsLayout
(
çl£
);

835 
	gR’d”Block
::
addOv”æowFromBlockChd»n
()

837 
R’d”Box
* 
chd
 = 
fœ¡ChdBox
(); 
	gchd
; chd = chd->
ÃxtSiblšgBox
()) {

838 ià(!
chd
->
isFlßtšgOrPos™iÚed
())

839 
addOv”æowFromChd
(
chd
);

843 
	gR’d”Block
::
addOv”æowFromFlßts
()

845 
IÁReù
 
»suÉ
;

846 ià(!
	gm_æßtšgObjeùs
)

848 
FlßtšgObjeù
* 
	gr
;

849 
	gD•»ÿ‹dPŒLi¡I‹¿tÜ
<
	gFlßtšgObjeù
> 
™
(*
m_æßtšgObjeùs
);

850 ; (
	gr
 = 
™
.
cu¼’t
()); ++
	g™
) {

851 ià(
	gr
->
	gm_shouldPašt
 && !r->
	gm_»nd””
->
hasS–fPaštšgLay”
())

852 
addOv”æowFromChd
(
r
->
m_»nd””
, 
IÁSize
Ô->
m_Ëá
 +„->m_»nd””->
m¬gšLeá
(),„->
m_tİ
 +„->m_»nd””->
m¬gšTİ
()));

857 
boŞ
 
	gR’d”Block
::
ex·ndsToEnşo£Ov”hªgšgFlßts
() const

859  
isIÆšeBlockOrIÆšeTabË
(è|| 
isFlßtšgOrPos™iÚed
(è|| 
hasOv”æowCl
(è|| (
·»Á
(è&&…¬’t()->
isFËxibËBox
()è|| 
hasCŞumns
(è|| 
isTabËC–l
(è|| 
isF›ld£t
();

862 
	gR’d”Block
::
adju¡Pos™iÚedBlock
(
R’d”Box
* 
chd
, cÚ¡ 
M¬gšInfo
& 
m¬gšInfo
)

864 ià(
	gchd
->
¡yË
()->
hasSticX
()) {

865 ià(
¡yË
()->
dœeùiÚ
(è=ğ
LTR
)

866 
chd
->
Ïy”
()->
£tSticX
(
bÜd”Leá
(è+ 
·ddšgLeá
());

868 
	gchd
->
Ïy”
()->
£tSticX
(
bÜd”Right
(è+ 
·ddšgRight
());

871 ià(
	gchd
->
¡yË
()->
hasSticY
()) {

872 
	gy
 = 
height
();

873 ià(!
	gm¬gšInfo
.
ÿnCŞÏp£W™hTİ
()) {

874 
	gchd
->
ÿlcV”tiÿlM¬gšs
();

875 
	gm¬gšTİ
 = 
chd
->
m¬gšTİ
();

876 
	gcŞÏp£dTİPos
 = 
m¬gšInfo
.
posM¬gš
();

877 
	gcŞÏp£dTİNeg
 = 
m¬gšInfo
.
ÃgM¬gš
();

878 ià(
	gm¬gšTİ
 > 0) {

879 ià(
	gm¬gšTİ
 > 
	gcŞÏp£dTİPos
)

880 
	gcŞÏp£dTİPos
 = 
m¬gšTİ
;

882 ià(-
	gm¬gšTİ
 > 
	gcŞÏp£dTİNeg
)

883 
	gcŞÏp£dTİNeg
 = -
m¬gšTİ
;

885 
	gy
 +ğ(
cŞÏp£dTİPos
 - 
cŞÏp£dTİNeg
è- 
m¬gšTİ
;

887 
R’d”Lay”
* 
	gchdLay”
 = 
chd
->
Ïy”
();

888 ià(
	gchdLay”
->
¡©icY
(è!ğ
y
) {

889 
chd
->
Ïy”
()->
£tSticY
(
y
);

890 
	gchd
->
£tChdN“dsLayout
(
Œue
, 
çl£
);

895 
	gR’d”Block
::
adju¡FlßtšgBlock
(cÚ¡ 
M¬gšInfo
& 
m¬gšInfo
)

910 
m¬gšOff£t
 = 
m¬gšInfo
.
ÿnCŞÏp£W™hTİ
(è? 0 : m¬gšInfo.
m¬gš
();

911 
£tHeight
(
height
(è+ 
m¬gšOff£t
);

912 
pos™iÚNewFlßts
();

913 
£tHeight
(
height
(è- 
m¬gšOff£t
);

916 
boŞ
 
	gR’d”Block
::
hªdËS³cŸlChd
(
R’d”Box
* 
chd
, cÚ¡ 
M¬gšInfo
& 
m¬gšInfo
)

919  
hªdËPos™iÚedChd
(
chd
, 
m¬gšInfo
)

920 || 
hªdËFlßtšgChd
(
chd
, 
m¬gšInfo
)

921 || 
hªdËRunInChd
(
chd
);

925 
boŞ
 
	gR’d”Block
::
hªdËPos™iÚedChd
(
R’d”Box
* 
chd
, cÚ¡ 
M¬gšInfo
& 
m¬gšInfo
)

927 ià(
	gchd
->
isPos™iÚed
()) {

928 
	gchd
->
cÚššgBlock
()->
š£¹Pos™iÚedObjeù
(
chd
);

929 
adju¡Pos™iÚedBlock
(
chd
, 
m¬gšInfo
);

930  
	gŒue
;

932  
	gçl£
;

935 
boŞ
 
	gR’d”Block
::
hªdËFlßtšgChd
(
R’d”Box
* 
chd
, cÚ¡ 
M¬gšInfo
& 
m¬gšInfo
)

937 ià(
	gchd
->
isFlßtšg
()) {

938 
š£¹FlßtšgObjeù
(
chd
);

939 
adju¡FlßtšgBlock
(
m¬gšInfo
);

940  
	gŒue
;

942  
	gçl£
;

945 
boŞ
 
	gR’d”Block
::
hªdËRunInChd
(
R’d”Box
* 
chd
)

950 ià(!
chd
->
isRunIn
(è|| !chd->
chd»nIÆše
())

951  
çl£
;

953 ià(!
	gchd
->
isR’d”Block
())

954  
	gçl£
;

957 
R’d”Block
* 
	gblockRunIn
 = 
toR’d”Block
(
chd
);

958 
R’d”Objeù
* 
	gcu¼
 = 
blockRunIn
->
ÃxtSiblšg
();

959 
	gcu¼
 && cu¼->
isFlßtšgOrPos™iÚed
())

960 
	gcu¼
 = 
cu¼
->
ÃxtSiblšg
();

962 ià(!
	gcu¼
 || !cu¼->
isR’d”Block
(è|| !cu¼->
chd»nIÆše
(è|| cu¼->
isRunIn
(è|| cu¼->
isAnÚymous
())

963  
	gçl£
;

965 
R’d”Block
* 
	gcu¼Block
 = 
toR’d”Block
(
cu¼
);

968 
chd»n
()->
»moveChdNode
(
this
, 
blockRunIn
);

971 
Node
* 
	grunInNode
 = 
blockRunIn
->
node
();

972 
R’d”IÆše
* 
	gšlšeRunIn
 = 
Ãw
 (
»nd”A»Ç
()èR’d”IÆše(
runInNode
 ?„unInNod: 
docum’t
());

973 
	gšlšeRunIn
->
£tStyË
(
blockRunIn
->
¡yË
());

975 
boŞ
 
	grunInIsG’”©ed
 = 
chd
->
¡yË
()->
¡yËTy³
(è=ğ
BEFORE
 || chd->¡yË()->¡yËTy³(è=ğ
AFTER
;

979 
R’d”Objeù
* 
	grunInChd
 = 
blockRunIn
->
fœ¡Chd
();„unInChd;„unInChd = 
runInChd
->
ÃxtSiblšg
()) {

980 ià(
runInIsG’”©ed
 || (
runInChd
->
¡yË
()->
¡yËTy³
(è!ğ
BEFORE
 &&„unInChd->¡yË()->¡yËTy³(è!ğ
AFTER
)) {

981 
blockRunIn
->
chd»n
()->
»moveChdNode
(blockRunIn, 
runInChd
, 
çl£
);

982 
	gšlšeRunIn
->
addChd
(
runInChd
);

987 
	gcu¼Block
->
chd»n
()->
š£¹ChdNode
(
cu¼Block
, 
šlšeRunIn
, cu¼Block->
fœ¡Chd
());

990 ià(
	grunInNode
)

991 
	grunInNode
->
£tR’d””
(
šlšeRunIn
);

994 
	gblockRunIn
->
de¡roy
();

999  
	gŒue
;

1002 
	gR’d”Block
::
cŞÏp£M¬gšs
(
R’d”Box
* 
chd
, 
M¬gšInfo
& 
m¬gšInfo
)

1005 
	gposTİ
 = 
chd
->
maxTİM¬gš
(
Œue
);

1006 
	gÃgTİ
 = 
chd
->
maxTİM¬gš
(
çl£
);

1010 ià(
	gchd
->
isS–fCŞÏpsšgBlock
()) {

1011 
	gposTİ
 = 
max
(
posTİ
, 
chd
->
maxBÙtomM¬gš
(
Œue
));

1012 
	gÃgTİ
 = 
max
(
ÃgTİ
, 
chd
->
maxBÙtomM¬gš
(
çl£
));

1017 
boŞ
 
	gtİQuœk
 = 
chd
->
isTİM¬gšQuœk
(è|| 
¡yË
()->
m¬gšTİCŞÏp£
(è=ğ
MDISCARD
;

1019 ià(
	gm¬gšInfo
.
ÿnCŞÏp£W™hTİ
()) {

1023 ià(!
¡yË
()->
htmlHacks
(è|| !
	gm¬gšInfo
.
quœkCÚš”
(è|| !
	gtİQuœk
)

1024 
£tMaxTİM¬gšs
(
max
(
posTİ
, 
maxTİPosM¬gš
()), max(
ÃgTİ
, 
maxTİNegM¬gš
()));

1030 ià(!
	gm¬gšInfo
.
d‘”mšedTİQuœk
(è&& !
	gtİQuœk
 && (
	gposTİ
-
	gÃgTİ
)) {

1031 
£tTİM¬gšQuœk
(
çl£
);

1032 
	gm¬gšInfo
.
£tD‘”mšedTİQuœk
(
Œue
);

1035 ià(!
	gm¬gšInfo
.
d‘”mšedTİQuœk
(è&& 
	gtİQuœk
 && 
m¬gšTİ
() == 0)

1041 
£tTİM¬gšQuœk
(
Œue
);

1044 ià(
	gm¬gšInfo
.
quœkCÚš”
(è&& m¬gšInfo.
©TİOfBlock
(è&& (
	gposTİ
 - 
	gÃgTİ
))

1045 
	gm¬gšInfo
.
£tTİQuœk
(
tİQuœk
);

1047 
	gypos
 = 
height
();

1048 ià(
	gchd
->
isS–fCŞÏpsšgBlock
()) {

1052 
	gcŞÏp£dTİPos
 = 
max
(
m¬gšInfo
.
posM¬gš
(), 
chd
->
maxTİM¬gš
(
Œue
));

1053 
	gcŞÏp£dTİNeg
 = 
max
(
m¬gšInfo
.
ÃgM¬gš
(), 
chd
->
maxTİM¬gš
(
çl£
));

1054 
	gm¬gšInfo
.
£tM¬gš
(
cŞÏp£dTİPos
, 
cŞÏp£dTİNeg
);

1058 
	gm¬gšInfo
.
£tPosM¬gšIfL¬g”
(
chd
->
maxBÙtomM¬gš
(
Œue
));

1059 
	gm¬gšInfo
.
£tNegM¬gšIfL¬g”
(
chd
->
maxBÙtomM¬gš
(
çl£
));

1061 ià(!
	gm¬gšInfo
.
ÿnCŞÏp£W™hTİ
())

1066 
	gypos
 = 
height
(è+ 
cŞÏp£dTİPos
 - 
cŞÏp£dTİNeg
;

1069 ià(
	gchd
->
¡yË
()->
m¬gšTİCŞÏp£
(è=ğ
MSEPARATE
) {

1070 
£tHeight
(
height
(è+ 
m¬gšInfo
.
m¬gš
(è+ 
chd
->
m¬gšTİ
());

1071 
	gypos
 = 
height
();

1073 ià(!
	gm¬gšInfo
.
©TİOfBlock
() ||

1074 (!
	gm¬gšInfo
.
ÿnCŞÏp£TİW™hChd»n
()

1075 && (!
¡yË
()->
htmlHacks
(è|| !
	gm¬gšInfo
.
quœkCÚš”
(è|| !m¬gšInfo.
tİQuœk
()))) {

1078 
£tHeight
(
height
(è+ 
max
(
m¬gšInfo
.
posM¬gš
(), 
posTİ
è- max(m¬gšInfo.
ÃgM¬gš
(), 
ÃgTİ
));

1079 
	gypos
 = 
height
();

1082 
	gm¬gšInfo
.
£tPosM¬gš
(
chd
->
maxBÙtomM¬gš
(
Œue
));

1083 
	gm¬gšInfo
.
£tNegM¬gš
(
chd
->
maxBÙtomM¬gš
(
çl£
));

1085 ià(
	gm¬gšInfo
.
m¬gš
())

1086 
	gm¬gšInfo
.
£tBÙtomQuœk
(
chd
->
isBÙtomM¬gšQuœk
(è|| 
¡yË
()->
m¬gšBÙtomCŞÏp£
(è=ğ
MDISCARD
);

1089  
	gypos
;

1092 
	gR’d”Block
::
ş—rFlßtsIfN“ded
(
R’d”Box
* 
chd
, 
M¬gšInfo
& 
m¬gšInfo
, 
ŞdTİPosM¬gš
, 
ŞdTİNegM¬gš
, 
yPos
)

1094 
	gheightInü—£
 = 
g‘CË¬D–
(
chd
, 
yPos
);

1095 ià(!
	gheightInü—£
)

1096  
	gyPos
;

1098 ià(
	gchd
->
isS–fCŞÏpsšgBlock
()) {

1106 
boŞ
 
	g©BÙtomOfBlock
 = 
Œue
;

1107 
R’d”Box
* 
	gcu¼
 = 
chd
->
ÃxtSiblšgBox
(); cu¼ && 
	g©BÙtomOfBlock
; cu¼ = 
cu¼
->nextSiblingBox()) {

1108 ià(!
cu¼
->
isFlßtšgOrPos™iÚed
())

1109 
©BÙtomOfBlock
 = 
çl£
;

1111 ià(
	g©BÙtomOfBlock
) {

1112 
	gm¬gšInfo
.
£tPosM¬gš
(
chd
->
maxBÙtomM¬gš
(
Œue
));

1113 
	gm¬gšInfo
.
£tNegM¬gš
(
chd
->
maxBÙtomM¬gš
(
çl£
));

1115 
	gm¬gšInfo
.
£tPosM¬gš
(
max
(
chd
->
maxTİM¬gš
(
Œue
), chd->
maxBÙtomM¬gš
(true)));

1116 
	gm¬gšInfo
.
£tNegM¬gš
(
max
(
chd
->
maxTİM¬gš
(
çl£
), chd->
maxBÙtomM¬gš
(false)));

1121 
£tHeight
(
chd
->
y
(è- 
max
(0, 
m¬gšInfo
.
m¬gš
()));

1124 
£tHeight
(
height
(è+ 
heightInü—£
);

1126 ià(
	gm¬gšInfo
.
ÿnCŞÏp£W™hTİ
()) {

1132 
£tMaxTİM¬gšs
(
ŞdTİPosM¬gš
, 
ŞdTİNegM¬gš
);

1133 
	gm¬gšInfo
.
£tAtTİOfBlock
(
çl£
);

1136  
	gyPos
 + 
	gheightInü—£
;

1139 
	gR’d”Block
::
e¡im©eV”tiÿlPos™iÚ
(
R’d”Box
* 
chd
, cÚ¡ 
M¬gšInfo
& 
m¬gšInfo
)

1143 
	gyPosE¡im©e
 = 
height
();

1144 ià(!
	gm¬gšInfo
.
ÿnCŞÏp£W™hTİ
()) {

1145 
	gchdM¬gšTİ
 = 
chd
->
£lfN“dsLayout
(è? chd->
m¬gšTİ
(è: chd->
cŞÏp£dM¬gšTİ
();

1146 
	gyPosE¡im©e
 +ğ
max
(
m¬gšInfo
.
m¬gš
(), 
chdM¬gšTİ
);

1148 
	gyPosE¡im©e
 +ğ
g‘CË¬D–
(
chd
, 
yPosE¡im©e
);

1149  
	gyPosE¡im©e
;

1152 
	gR’d”Block
::
d‘”mšeHÜizÚlPos™iÚ
(
R’d”Box
* 
chd
)

1154 ià(
¡yË
()->
dœeùiÚ
(è=ğ
LTR
) {

1155 
xPos
 = 
bÜd”Leá
(è+ 
·ddšgLeá
();

1158 
	gchPos
 = 
xPos
 + 
chd
->
m¬gšLeá
();

1162 ià(
	gchd
->
avoidsFlßts
()) {

1163 
	gËáOff
 = 
ËáOff£t
(
height
(), 
çl£
);

1164 ià(
¡yË
()->
‹xtAlign
(è!ğ
WEBKIT_CENTER
 && 
chd
->¡yË()->
m¬gšLeá
().
ty³
(è!ğ
Auto
) {

1165 ià(
chd
->
m¬gšLeá
() < 0)

1166 
ËáOff
 +ğ
chd
->
m¬gšLeá
();

1167 
	gchPos
 = 
max
(
chPos
, 
ËáOff
);

1169 ià(
	gËáOff
 !ğ
xPos
) {

1175 
chd
->
ÿlcHÜizÚlM¬gšs
(chd->
¡yË
()->
m¬gšLeá
(), chd->¡yË()->
m¬gšRight
(), 
lšeWidth
(chd->
y
(), 
çl£
));

1176 
	gchPos
 = 
ËáOff
 + 
chd
->
m¬gšLeá
();

1179 
v›w
()->
addLayoutD–
(
IÁSize
(
chd
->
x
(è- 
chPos
, 0));

1180 
	gchd
->
£tLoÿtiÚ
(
chPos
, 
chd
->
y
());

1182 
	gxPos
 = 
width
(è- 
bÜd”Right
(è- 
·ddšgRight
(è- 
v”tiÿlSüŞlb¬Width
();

1183 
	gchPos
 = 
xPos
 - (
chd
->
width
(è+ chd->
m¬gšRight
());

1184 ià(
	gchd
->
avoidsFlßts
()) {

1185 
	grightOff
 = 
rightOff£t
(
height
(), 
çl£
);

1186 ià(
¡yË
()->
‹xtAlign
(è!ğ
WEBKIT_CENTER
 && 
chd
->¡yË()->
m¬gšRight
().
ty³
(è!ğ
Auto
) {

1187 ià(
chd
->
m¬gšRight
() < 0)

1188 
rightOff
 -ğ
chd
->
m¬gšRight
();

1189 
	gchPos
 = 
mš
(
chPos
, 
rightOff
 - 
chd
->
width
());

1190 } ià(
	grightOff
 !ğ
xPos
) {

1196 
chd
->
ÿlcHÜizÚlM¬gšs
(chd->
¡yË
()->
m¬gšLeá
(), chd->¡yË()->
m¬gšRight
(), 
lšeWidth
(chd->
y
(), 
çl£
));

1197 
	gchPos
 = 
rightOff
 - 
chd
->
m¬gšRight
(è- chd->
width
();

1200 
v›w
()->
addLayoutD–
(
IÁSize
(
chd
->
x
(è- 
chPos
, 0));

1201 
	gchd
->
£tLoÿtiÚ
(
chPos
, 
chd
->
y
());

1205 
	gR’d”Block
::
£tCŞÏp£dBÙtomM¬gš
(cÚ¡ 
M¬gšInfo
& 
m¬gšInfo
)

1207 ià(
m¬gšInfo
.
ÿnCŞÏp£W™hBÙtom
(è&& !m¬gšInfo.
ÿnCŞÏp£W™hTİ
()) {

1210 
£tMaxBÙtomM¬gšs
(
max
(
maxBÙtomPosM¬gš
(), 
m¬gšInfo
.
posM¬gš
()), max(
maxBÙtomNegM¬gš
(), m¬gšInfo.
ÃgM¬gš
()));

1212 ià(!
	gm¬gšInfo
.
bÙtomQuœk
())

1213 
£tBÙtomM¬gšQuœk
(
çl£
);

1215 ià(
	gm¬gšInfo
.
bÙtomQuœk
(è&& 
m¬gšBÙtom
() == 0)

1219 
£tBÙtomM¬gšQuœk
(
Œue
);

1223 
	gR’d”Block
::
hªdËBÙtomOfBlock
(
tİ
, 
bÙtom
, 
M¬gšInfo
& 
m¬gšInfo
)

1225 
	gm¬gšInfo
.
£tAtBÙtomOfBlock
(
Œue
);

1228 ià(!
	gm¬gšInfo
.
ÿnCŞÏp£W™hBÙtom
(è&& !m¬gšInfo.
ÿnCŞÏp£W™hTİ
()

1229 && (!
¡yË
()->
htmlHacks
(è|| !
	gm¬gšInfo
.
quœkCÚš”
(è|| !m¬gšInfo.
bÙtomQuœk
()))

1230 
£tHeight
(
height
(è+ 
m¬gšInfo
.
m¬gš
());

1233 
£tHeight
(
height
(è+ 
bÙtom
);

1237 
£tHeight
(
max
(
height
(), 
tİ
 + 
bÙtom
));

1240 
£tCŞÏp£dBÙtomM¬gš
(
m¬gšInfo
);

1243 
	gR’d”Block
::
ÏyoutBlockChd»n
(
boŞ
 
»ÏyoutChd»n
, & 
maxFlßtBÙtom
)

1245 ià(
	ggP”ûÁHeightDesûndªtsM­
) {

1246 ià(
	gHashS‘
<
	gR’d”Box
*>* 
	gdesûndªts
 = 
gP”ûÁHeightDesûndªtsM­
->
g‘
(
this
)) {

1247 
HashS‘
<
R’d”Box
*>::
™”©Ü
 
’d
 = 
desûndªts
->end();

1248 
	gHashS‘
<
	gR’d”Box
*>::
™”©Ü
 
™
 = 
desûndªts
->
begš
(); 
	g™
 !ğ
’d
; ++it) {

1249 
R’d”Box
* 
	gbox
 = *
™
;

1250 
	gbox
 !ğ
this
) {

1251 ià(
box
->
nÜm®ChdN“dsLayout
())

1253 
	gbox
->
£tChdN“dsLayout
(
Œue
, 
çl£
);

1254 
	gbox
 = 
box
->
cÚššgBlock
();

1255 
ASSERT
(
box
);

1256 ià(!
	gbox
)

1263 
	gtİ
 = 
bÜd”Tİ
(è+ 
·ddšgTİ
();

1264 
	gbÙtom
 = 
bÜd”BÙtom
(è+ 
·ddšgBÙtom
(è+ 
hÜizÚlSüŞlb¬Height
();

1266 
£tHeight
(
tİ
);

1269 
M¬gšInfo
 
m¬gšInfo
(
this
, 
tİ
, 
bÙtom
);

1273 
R’d”Objeù
* 
	gËg’d
 = 
ÏyoutLeg’d
(
»ÏyoutChd»n
);

1275 
	g´eviousFlßtBÙtom
 = 0;

1276 
	gmaxFlßtBÙtom
 = 0;

1278 
R’d”Box
* 
	gÃxt
 = 
fœ¡ChdBox
();

1280 
	gÃxt
) {

1281 
R’d”Box
* 
	gchd
 = 
Ãxt
;

1282 
	gÃxt
 = 
chd
->
ÃxtSiblšgBox
();

1284 ià(
	gËg’d
 =ğ
chd
)

1290 ià(
	g»ÏyoutChd»n
 || ((
	gchd
->
¡yË
()->
height
().
isP”ûÁ
(è|| chd->¡yË()->
mšHeight
().isP”ûÁ(è|| chd->¡yË()->
maxHeight
().isP”ûÁ()è&& !
isR’d”V›w
()))

1291 
	gchd
->
£tChdN“dsLayout
(
Œue
, 
çl£
);

1294 ià(
	g»ÏyoutChd»n
 && (
	gchd
->
¡yË
()->
·ddšgLeá
().
isP”ûÁ
(è|| chd->¡yË()->
·ddšgRight
().isPercent()))

1295 
	gchd
->
£tP»fWidthsDœty
(
Œue
, 
çl£
);

1299 ià(
hªdËS³cŸlChd
(
chd
, 
m¬gšInfo
))

1303 
ÏyoutBlockChd
(
chd
, 
m¬gšInfo
, 
´eviousFlßtBÙtom
, 
maxFlßtBÙtom
);

1308 
hªdËBÙtomOfBlock
(
tİ
, 
bÙtom
, 
m¬gšInfo
);

1311 
	gR’d”Block
::
ÏyoutBlockChd
(
R’d”Box
* 
chd
, 
M¬gšInfo
& 
m¬gšInfo
, & 
´eviousFlßtBÙtom
, & 
maxFlßtBÙtom
)

1313 
	gŞdTİPosM¬gš
 = 
maxTİPosM¬gš
();

1314 
	gŞdTİNegM¬gš
 = 
maxTİNegM¬gš
();

1317 
	gchd
->
ÿlcV”tiÿlM¬gšs
();

1320 ià(
	gchd
->
¡yË
()->
m¬gšTİCŞÏp£
(è=ğ
MSEPARATE
) {

1321 
m¬gšInfo
.
£tAtTİOfBlock
(
çl£
);

1322 
	gm¬gšInfo
.
ş—rM¬gš
();

1328 
	gyPosE¡im©e
 = 
e¡im©eV”tiÿlPos™iÚ
(
chd
, 
m¬gšInfo
);

1331 
IÁReù
 
ŞdReù
(
chd
->
x
(), chd->
y
(è, chd->
width
(), chd->
height
());

1332 #iâdeà
NDEBUG


1333 
IÁSize
 
	gŞdLayoutD–
 = 
v›w
()->
ÏyoutD–
();

1336 
v›w
()->
addLayoutD–
(
IÁSize
(0, 
chd
->
y
(è- 
yPosE¡im©e
));

1337 
	gchd
->
£tLoÿtiÚ
(
chd
->
x
(), 
yPosE¡im©e
);

1339 
boŞ
 
	gm¬kDesûndªtsW™hFlßts
 = 
çl£
;

1340 ià(
	gyPosE¡im©e
 !ğ
ŞdReù
.
y
(è&& !
chd
->
avoidsFlßts
(è&& chd->
isBlockFlow
(è&& 
toR’d”Block
(chd)->
cÚšsFlßts
())

1341 
m¬kDesûndªtsW™hFlßts
 = 
Œue
;

1342 ià(!
	gchd
->
avoidsFlßts
(è|| chd->
shrškToAvoidFlßts
()) {

1345 
	gfb
 = 
max
(
´eviousFlßtBÙtom
, 
æßtBÙtom
());

1346 ià(
	gfb
 > 
	gyPosE¡im©e
)

1347 
	gm¬kDesûndªtsW™hFlßts
 = 
Œue
;

1350 ià(
	gchd
->
isR’d”Block
()) {

1351 ià(
	gm¬kDesûndªtsW™hFlßts
)

1352 
toR’d”Block
(
chd
)->
m¬kAÎDesûndªtsW™hFlßtsFÜLayout
();

1354 
	g´eviousFlßtBÙtom
 = 
max
(
´eviousFlßtBÙtom
, 
ŞdReù
.
y
(è+ 
toR’d”Block
(
chd
)->
æßtBÙtom
());

1357 
boŞ
 
	gchdHadLayout
 = 
chd
->
m_ev”HadLayout
;

1358 
boŞ
 
	gchdN“dedLayout
 = 
chd
->
ÃedsLayout
();

1359 ià(
	gchdN“dedLayout
)

1360 
	gchd
->
Ïyout
();

1364 
	gyBefÜeCË¬
 = 
cŞÏp£M¬gšs
(
chd
, 
m¬gšInfo
);

1367 
	gyAá”CË¬
 = 
ş—rFlßtsIfN“ded
(
chd
, 
m¬gšInfo
, 
ŞdTİPosM¬gš
, 
ŞdTİNegM¬gš
, 
yBefÜeCË¬
);

1369 
v›w
()->
addLayoutD–
(
IÁSize
(0, 
yPosE¡im©e
 - 
yAá”CË¬
));

1370 
	gchd
->
£tLoÿtiÚ
(
chd
->
x
(), 
yAá”CË¬
);

1373 ià(
	gyAá”CË¬
 !ğ
yPosE¡im©e
) {

1374 ià(
chd
->
shrškToAvoidFlßts
()) {

1379 
chd
->
£tChdN“dsLayout
(
Œue
, 
çl£
);

1381 ià(!
	gchd
->
avoidsFlßts
(è&& chd->
isBlockFlow
(è&& 
toR’d”Block
(
chd
)->
cÚšsFlßts
())

1382 
toR’d”Block
(
chd
)->
m¬kAÎDesûndªtsW™hFlßtsFÜLayout
();

1384 
	gchd
->
ÏyoutIfN“ded
();

1389 ià(
	gm¬gšInfo
.
©TİOfBlock
(è&& !
	gchd
->
isS–fCŞÏpsšgBlock
())

1390 
	gm¬gšInfo
.
£tAtTİOfBlock
(
çl£
);

1393 
d‘”mšeHÜizÚlPos™iÚ
(
chd
);

1396 
£tHeight
(
height
(è+ 
chd
->height());

1397 ià(
	gchd
->
¡yË
()->
m¬gšBÙtomCŞÏp£
(è=ğ
MSEPARATE
) {

1398 
£tHeight
(
height
(è+ 
chd
->
m¬gšBÙtom
());

1399 
	gm¬gšInfo
.
ş—rM¬gš
();

1403 ià(
	gchd
->
isBlockFlow
(è&& 
toR’d”Block
(
chd
)->
cÚšsFlßts
())

1404 
	gmaxFlßtBÙtom
 = 
max
(
maxFlßtBÙtom
, 
addOv”hªgšgFlßts
(
toR’d”Block
(
chd
), -chd->
x
(), -chd->
y
(), !
chdN“dedLayout
));

1406 
IÁSize
 
chdOff£t
(
chd
->
x
(è- 
ŞdReù
.x(), chd->
y
() - oldRect.y());

1407 ià(
	gchdOff£t
.
width
(è|| chdOff£t.
height
()) {

1408 
v›w
()->
addLayoutD–
(
chdOff£t
);

1413 ià(
	gchdHadLayout
 && !
£lfN“dsLayout
(è&& 
	gchd
->
checkFÜR•aštDuršgLayout
())

1414 
	gchd
->
»·štDuršgLayoutIfMoved
(
ŞdReù
);

1417 ià(!
	gchdHadLayout
 && 
	gchd
->
checkFÜR•aštDuršgLayout
()) {

1418 
	gchd
->
»·št
();

1419 
	gchd
->
»·štOv”hªgšgFlßts
(
Œue
);

1422 
ASSERT
(
ŞdLayoutD–
 =ğ
v›w
()->
ÏyoutD–
());

1425 
boŞ
 
	gR’d”Block
::
ÏyoutOÆyPos™iÚedObjeùs
()

1427 ià(!
posChdN“dsLayout
(è|| 
nÜm®ChdN“dsLayout
(è|| 
£lfN“dsLayout
())

1428  
çl£
;

1430 
LayoutS‹Mašš”
 
¡©ePush”
(
v›w
(), 
this
, 
IÁSize
(
x
(), 
y
()), 
hasCŞumns
(è|| 
hasT¿nsfÜm
(è|| 
hasReæeùiÚ
());

1432 ià(
ÃedsPos™iÚedMovem’tLayout
()) {

1433 
ŒyLayoutDošgPos™iÚedMovem’tOÆy
();

1434 ià(
ÃedsLayout
())

1435  
	gçl£
;

1439 
ÏyoutPos™iÚedObjeùs
(
çl£
);

1441 
	g¡©ePush”
.
pİ
();

1443 
upd©eSüŞlInfoAá”Layout
();

1445 
£tN“dsLayout
(
çl£
);

1446  
	gŒue
;

1449 
	gR’d”Block
::
ÏyoutPos™iÚedObjeùs
(
boŞ
 
»ÏyoutChd»n
)

1451 ià(
m_pos™iÚedObjeùs
) {

1452 
R’d”Box
* 
r
;

1453 
I‹¿tÜ
 
	g’d
 = 
m_pos™iÚedObjeùs
->
’d
();

1454 
I‹¿tÜ
 
	g™
 = 
m_pos™iÚedObjeùs
->
begš
(); iˆ!ğ
’d
; ++it) {

1455 
	gr
 = *
™
;

1460 ià(
	g»ÏyoutChd»n
 || (
	gr
->
¡yË
()->
hasSticY
(è&&„->
·»Á
(è!ğ
this
 && 
r
->·»Á()->
isBlockFlow
()))

1461 
r
->
£tChdN“dsLayout
(
Œue
, 
çl£
);

1465 
	gr
->
£tP»fWidthsDœty
(
Œue
, 
çl£
);

1469 ià(
	gr
->
ÃedsPos™iÚedMovem’tLayoutOÆy
())

1470 
	gr
->
ŒyLayoutDošgPos™iÚedMovem’tOÆy
();

1471 
	gr
->
ÏyoutIfN“ded
();

1476 
	gR’d”Block
::
m¬kPos™iÚedObjeùsFÜLayout
()

1478 ià(
m_pos™iÚedObjeùs
) {

1479 
R’d”Box
* 
r
;

1480 
I‹¿tÜ
 
	g’d
 = 
m_pos™iÚedObjeùs
->
’d
();

1481 
I‹¿tÜ
 
	g™
 = 
m_pos™iÚedObjeùs
->
begš
(); iˆ!ğ
’d
; ++it) {

1482 
	gr
 = *
™
;

1483 
	gr
->
£tChdN“dsLayout
(
Œue
);

1488 
	gR’d”Block
::
»·štOv”hªgšgFlßts
(
boŞ
 
·štAÎDesûndªts
)

1491 ià(
hasOv”hªgšgFlßts
()) {

1494 
ASSERT
(
m_æßtšgObjeùs
);

1495 ià(!
	gm_æßtšgObjeùs
)

1498 
FlßtšgObjeù
* 
	gr
;

1499 
	gD•»ÿ‹dPŒLi¡I‹¿tÜ
<
	gFlßtšgObjeù
> 
™
(*
m_æßtšgObjeùs
);

1503 
v›w
()->
di§bËLayoutS‹
();

1504  ; (
	gr
 = 
™
.
cu¼’t
()); ++
	g™
) {

1508 ià(
	gr
->
	gm_bÙtom
 > 
height
(è&& ((
	g·štAÎDesûndªts
 &&„->
	gm_»nd””
->
isDesûndªtOf
(
this
)è||„->
	gm_shouldPašt
è&& !r->m_»nd””->
hasS–fPaštšgLay”
()) {

1509 
	gr
->
	gm_»nd””
->
»·št
();

1510 
	gr
->
	gm_»nd””
->
»·štOv”hªgšgFlßts
();

1513 
v›w
()->
’abËLayoutS‹
();

1517 
	gR’d”Block
::
·št
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

1519 
	gtx
 +ğ
x
();

1520 
	gty
 +ğ
y
();

1522 
PaštPha£
 
	gpha£
 = 
·štInfo
.
pha£
;

1527 ià(!
isRoÙ
()) {

1528 
IÁReù
 
	gov”æowBox
 = 
visibËOv”æowReù
();

1529 
	gov”æowBox
.
šæ©e
(
maxim®OušeSize
(
·štInfo
.
pha£
));

1530 
	gov”æowBox
.
move
(
tx
, 
ty
);

1531 ià(!
	gov”æowBox
.
š‹r£ùs
(
·štInfo
.
»ù
))

1535 
boŞ
 
	gpushedCl
 = 
pushCÚ‹ÁsCl
(
·štInfo
, 
tx
, 
ty
);

1536 
·štObjeù
(
·štInfo
, 
tx
, 
ty
);

1537 ià(
	gpushedCl
)

1538 
pİCÚ‹ÁsCl
(
·štInfo
, 
pha£
, 
tx
, 
ty
);

1543 ià(
hasOv”æowCl
(è&& 
¡yË
()->
visib™y
(è=ğ
VISIBLE
 && (
pha£
 =ğ
PaštPha£BlockBackground
 ||…ha£ =ğ
PaštPha£ChdBlockBackground
è&& 
shouldPaštW™hšRoÙ
(
·štInfo
))

1544 
Ïy”
()->
·štOv”æowCÚŒŞs
(
·štInfo
.
cÚ‹xt
, 
tx
, 
ty
,…aštInfo.
»ù
);

1547 
	gR’d”Block
::
·štCŞumnRuËs
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

1549 cÚ¡ 
	gCŞÜ
& 
	gruËCŞÜ
 = 
¡yË
()->
vis™edD•’d’tCŞÜ
(
CSSPrİ”tyWebk™CŞumnRuËCŞÜ
);

1550 
boŞ
 
	gruËT¿n¥¬’t
 = 
¡yË
()->
cŞumnRuËIsT¿n¥¬’t
();

1551 
EBÜd”StyË
 
	gruËStyË
 = 
¡yË
()->
cŞumnRuËStyË
();

1552 
	gruËWidth
 = 
¡yË
()->
cŞumnRuËWidth
();

1553 
	gcŞG­
 = 
cŞumnG­
();

1554 
boŞ
 
	g»nd”RuË
 = 
ruËStyË
 > 
BHIDDEN
 && !
ruËT¿n¥¬’t
 && 
ruËWidth
 <ğ
cŞG­
;

1555 ià(!
	g»nd”RuË
)

1559 
	gcu¼XOff£t
 = 0;

1560 
	gruËAdd
 = 
bÜd”Leá
(è+ 
·ddšgLeá
();

1561 
	gruËX
 = 0;

1562 
	gVeùÜ
<
	gIÁReù
>* 
	gcŞReùs
 = 
cŞumnReùs
();

1563 
	gcŞCouÁ
 = 
cŞReùs
->
size
();

1564 
	gi
 = 0; i < 
	gcŞCouÁ
; i++) {

1566 
IÁReù
 
	gcŞReù
 = 
cŞReùs
->
©
(
i
);

1569 ià(
¡yË
()->
dœeùiÚ
(è=ğ
LTR
) {

1570 
ruËX
 +ğ
cŞReù
.
width
(è+ 
cŞG­
 / 2;

1571 
	gcu¼XOff£t
 +ğ
cŞReù
.
width
(è+ 
cŞG­
;

1573 
	gruËX
 -ğ(
cŞReù
.
width
(è+ 
cŞG­
 / 2);

1574 
	gcu¼XOff£t
 -ğ(
cŞReù
.
width
(è+ 
cŞG­
);

1578 ià(
	gi
 < 
	gcŞCouÁ
 - 1) {

1579 
	gruËS¹
 = 
tx
 + 
ruËX
 - 
ruËWidth
 / 2 + 
ruËAdd
;

1580 
	gruËEnd
 = 
ruËS¹
 + 
ruËWidth
;

1581 
	gruËTİ
 = 
ty
 + 
bÜd”Tİ
(è+ 
·ddšgTİ
();

1582 
	gruËBÙtom
 = 
ruËTİ
 + 
cÚ‹ÁHeight
();

1583 
d¿wLšeFÜBoxSide
(
·štInfo
.
cÚ‹xt
, 
ruËS¹
, 
ruËTİ
, 
ruËEnd
, 
ruËBÙtom
,

1584 
¡yË
()->
dœeùiÚ
(è=ğ
LTR
 ? 
BSLeá
 : 
BSRight
, 
ruËCŞÜ
, 
ruËStyË
, 0, 0);

1587 
	gruËX
 = 
cu¼XOff£t
;

1591 
	gR’d”Block
::
·štCŞumnCÚ‹Ás
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
, 
boŞ
 
·štšgFlßts
)

1594 
G¿phicsCÚ‹xt
* 
	gcÚ‹xt
 = 
·štInfo
.
cÚ‹xt
;

1595 
	gcu¼XOff£t
 = 0;

1596 
	gcu¼YOff£t
 = 0;

1597 
	gcŞG­
 = 
cŞumnG­
();

1598 
	gVeùÜ
<
	gIÁReù
>* 
	gcŞReùs
 = 
cŞumnReùs
();

1599 
	gcŞCouÁ
 = 
cŞReùs
->
size
();

1600 
	gi
 = 0; i < 
	gcŞCouÁ
; i++) {

1602 
IÁReù
 
	gcŞReù
 = 
cŞReùs
->
©
(
i
);

1603 
	gcŞReù
.
move
(
tx
, 
ty
);

1604 
	gcÚ‹xt
->
§ve
();

1608 
	gcÚ‹xt
->
ş
(
cŞReù
);

1611 
PaštInfo
 
šfo
(
·štInfo
);

1612 
	gšfo
.
	g»ù
.
š‹r£ù
(
cŞReù
);

1615 
	gfš®X
 = 
tx
 + 
cu¼XOff£t
;

1616 
	gfš®Y
 = 
ty
 + 
cu¼YOff£t
;

1617 ià(
	g·štšgFlßts
)

1618 
·štFlßts
(
šfo
, 
fš®X
, 
fš®Y
, 
·štInfo
.
pha£
 =ğ
PaštPha£S–eùiÚ
 ||…aštInfo.pha£ =ğ
PaštPha£TextCl
);

1620 
·štCÚ‹Ás
(
šfo
, 
fš®X
, 
fš®Y
);

1623 ià(
¡yË
()->
dœeùiÚ
(è=ğ
LTR
)

1624 
cu¼XOff£t
 +ğ
cŞReù
.
width
(è+ 
cŞG­
;

1626 
	gcu¼XOff£t
 -ğ(
cŞReù
.
width
(è+ 
cŞG­
);

1628 
	gcu¼YOff£t
 -ğ
cŞReù
.
height
();

1630 
	gcÚ‹xt
->
»¡Üe
();

1634 
	gR’d”Block
::
·štCÚ‹Ás
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

1639 ià(
docum’t
()->
didLayoutW™hP’dšgStyËsh“ts
(è&& !
isR’d”V›w
())

1642 ià(
chd»nIÆše
())

1643 
	gm_lšeBoxes
.
·št
(
this
, 
·štInfo
, 
tx
, 
ty
);

1645 
·štChd»n
(
·štInfo
, 
tx
, 
ty
);

1648 
	gR’d”Block
::
·štChd»n
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

1650 
PaštPha£
 
	gÃwPha£
 = (
·štInfo
.
pha£
 =ğ
PaštPha£ChdOušes
è? 
PaštPha£Ouše
 :…aintInfo.phase;

1651 
	gÃwPha£
 = (
ÃwPha£
 =ğ
PaštPha£ChdBlockBackgrounds
è? 
PaštPha£ChdBlockBackground
 :‚ewPhase;

1654 
PaštInfo
 
šfo
(
·štInfo
);

1655 
	gšfo
.
	gpha£
 = 
ÃwPha£
;

1656 
	gšfo
.
	g·štšgRoÙ
 = 
·štšgRoÙFÜChd»n
(
·štInfo
);

1657 
boŞ
 
	gisPrštšg
 = 
docum’t
()->
´štšg
();

1659 
R’d”Box
* 
	gchd
 = 
fœ¡ChdBox
(); chd; chd = 
chd
->
ÃxtSiblšgBox
()) {

1661 ià(
isPrštšg
 && !
chd»nIÆše
(è&& 
chd
->
¡yË
()->
·geB»akBefÜe
(è=ğ
PBALWAYS


1662 && (
ty
 + 
chd
->
y
()è> 
·štInfo
.
»ù
.y()

1663 && (
ty
 + 
chd
->
y
()è< 
·štInfo
.
»ù
.
bÙtom
()) {

1664 
v›w
()->
£tBe¡Trunÿ‹dAt
(
ty
 + 
chd
->
y
(), 
this
, 
Œue
);

1669 ià(
	gisPrštšg
 && !
chd»nIÆše
(è&& 
	gchd
->
¡yË
()->
·geB»akInside
(è=ğ
PBAVOID


1670 && 
ty
 + 
chd
->
y
(è> 
·štInfo
.
»ù
.y()

1671 && 
ty
 + 
chd
->
y
(è< 
·štInfo
.
»ù
.
bÙtom
()

1672 && 
ty
 + 
chd
->
y
(è+ chd->
height
(è> 
·štInfo
.
»ù
.
bÙtom
()) {

1673 
v›w
()->
£tBe¡Trunÿ‹dAt
(
ty
 + 
chd
->
y
(), 
this
, 
Œue
);

1677 ià(!
	gchd
->
hasS–fPaštšgLay”
(è&& !chd->
isFlßtšg
())

1678 
	gchd
->
·št
(
šfo
, 
tx
, 
ty
);

1681 ià(
	gisPrštšg
 && !
chd»nIÆše
(è&& 
	gchd
->
¡yË
()->
·geB»akAá”
(è=ğ
PBALWAYS


1682 && (
ty
 + 
chd
->
y
(è+ chd->
height
()è> 
·štInfo
.
»ù
.y()

1683 && (
ty
 + 
chd
->
y
(è+ chd->
height
()è< 
·štInfo
.
»ù
.
bÙtom
()) {

1684 
v›w
()->
£tBe¡Trunÿ‹dAt
(
ty
 + 
chd
->
y
(è+ chd->
height
(è+ 
max
(0, chd->
cŞÏp£dM¬gšBÙtom
()), 
this
, 
Œue
);

1690 
	gR’d”Block
::
·štC¬‘
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
, 
C¬‘Ty³
 
ty³
)

1692 
S–eùiÚCÚŒŞËr
* 
	g£ËùiÚ
 = 
ty³
 =ğ
CursÜC¬‘
 ? 
docum’t
()->
äame
()->
£ËùiÚ
(è: docum’t()->äame()->
d¿gC¬‘CÚŒŞËr
();

1695 
boŞ
 
	gÿ»tBrowsšg
 = 
docum’t
()->
äame
()->
£‰šgs
(è&& docum’t()->äame()->£‰šgs()->
ÿ»tBrowsšgEÇbËd
();

1696 
R’d”Objeù
* 
	gÿ»tPaš‹r
 = 
£ËùiÚ
->
ÿ»tR’d””
();

1697 ià(
	gÿ»tPaš‹r
 =ğ
this
 && (
£ËùiÚ
->
isCÚ‹ÁEd™abË
(è|| 
ÿ»tBrowsšg
)) {

1700 
off£tFÜCÚ‹Ás
(
tx
, 
ty
);

1702 ià(
	gty³
 =ğ
CursÜC¬‘
)

1703 
docum’t
()->
äame
()->
£ËùiÚ
()->
·štC¬‘
(
·štInfo
.
cÚ‹xt
, 
tx
, 
ty
,…aštInfo.
»ù
);

1705 
docum’t
()->
äame
()->
·štD¿gC¬‘
(
·štInfo
.
cÚ‹xt
, 
tx
, 
ty
,…aštInfo.
»ù
);

1709 
	gR’d”Block
::
·štObjeù
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

1711 
PaštPha£
 
	g·štPha£
 = 
·štInfo
.
pha£
;

1714 ià((
	g·štPha£
 =ğ
PaštPha£BlockBackground
 || 
·štPha£
 =ğ
PaštPha£ChdBlockBackground
è&& 
¡yË
()->
visib™y
(è=ğ
VISIBLE
) {

1715 ià(
hasBoxDecÜ©iÚs
())

1716 
·štBoxDecÜ©iÚs
(
·štInfo
, 
tx
, 
ty
);

1717 ià(
hasCŞumns
())

1718 
·štCŞumnRuËs
(
·štInfo
, 
tx
, 
ty
);

1721 ià(
	g·štPha£
 =ğ
PaštPha£Mask
 && 
¡yË
()->
visib™y
(è=ğ
VISIBLE
) {

1722 
·štMask
(
·štInfo
, 
tx
, 
ty
);

1727 ià(
	g·štPha£
 =ğ
PaštPha£BlockBackground
)

1731 
	gsüŞËdX
 = 
tx
;

1732 
	gsüŞËdY
 = 
ty
;

1733 ià(
hasOv”æowCl
()) {

1734 
IÁSize
 
	goff£t
 = 
Ïy”
()->
süŞËdCÚ‹ÁOff£t
();

1735 
	gsüŞËdX
 -ğ
off£t
.
width
();

1736 
	gsüŞËdY
 -ğ
off£t
.
height
();

1740 ià(
	g·štPha£
 !ğ
PaštPha£S–fOuše
) {

1741 ià(
hasCŞumns
())

1742 
·štCŞumnCÚ‹Ás
(
·štInfo
, 
süŞËdX
, 
süŞËdY
);

1744 
·štCÚ‹Ás
(
·štInfo
, 
süŞËdX
, 
süŞËdY
);

1749 
boŞ
 
	gisPrštšg
 = 
docum’t
()->
´štšg
();

1750 ià(!
	gisPrštšg
 && !
hasCŞumns
())

1751 
·štS–eùiÚ
(
·štInfo
, 
süŞËdX
, 
süŞËdY
);

1754 ià(
	g·štPha£
 =ğ
PaštPha£Flßt
 || 
·štPha£
 =ğ
PaštPha£S–eùiÚ
 ||…aštPha£ =ğ
PaštPha£TextCl
) {

1755 ià(
hasCŞumns
())

1756 
·štCŞumnCÚ‹Ás
(
·štInfo
, 
süŞËdX
, 
süŞËdY
, 
Œue
);

1758 
·štFlßts
(
·štInfo
, 
süŞËdX
, 
süŞËdY
, 
·štPha£
 =ğ
PaštPha£S–eùiÚ
 ||…aštPha£ =ğ
PaštPha£TextCl
);

1762 ià((
	g·štPha£
 =ğ
PaštPha£Ouše
 || 
·štPha£
 =ğ
PaštPha£S–fOuše
è&& 
hasOuše
(è&& 
¡yË
()->
visib™y
(è=ğ
VISIBLE
)

1763 
·štOuše
(
·štInfo
.
cÚ‹xt
, 
tx
, 
ty
, 
width
(), 
height
());

1766 ià((
	g·štPha£
 =ğ
PaštPha£Ouše
 || 
·štPha£
 =ğ
PaštPha£ChdOušes
)) {

1767 ià(
šlšeCÚtšu©iÚ
(è&& iÆšeCÚtšu©iÚ()->
hasOuše
(è&& iÆšeCÚtšu©iÚ()->
¡yË
()->
visib™y
(è=ğ
VISIBLE
) {

1768 
R’d”IÆše
* 
šlšeR’d””
 = 
toR’d”IÆše
(
šlšeCÚtšu©iÚ
()->
node
()->
»nd””
());

1769 ià(!
	gšlšeR’d””
->
hasS–fPaštšgLay”
())

1770 
cÚššgBlock
()->
addCÚtšu©iÚW™hOuše
(
šlšeR’d””
);

1771 ià(!
	gšlšeR’d””
->
fœ¡LšeBox
())

1772 
	gšlšeR’d””
->
·štOuše
(
·štInfo
.
cÚ‹xt
, 
tx
 - 
x
(è+ 
šlšeR’d””
->
cÚššgBlock
()->x(),

1773 
ty
 - 
y
(è+ 
šlšeR’d””
->
cÚššgBlock
()->y());

1775 
·štCÚtšu©iÚOušes
(
·štInfo
, 
tx
, 
ty
);

1781 ià(
	g·štPha£
 =ğ
PaštPha£FÜeground
) {

1782 
·štC¬‘
(
·štInfo
, 
süŞËdX
, 
süŞËdY
, 
CursÜC¬‘
);

1783 
·štC¬‘
(
·štInfo
, 
süŞËdX
, 
süŞËdY
, 
D¿gC¬‘
);

1787 
	gR’d”Block
::
·štFlßts
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
, 
boŞ
 
´e£rvePha£
)

1789 ià(!
	gm_æßtšgObjeùs
)

1792 
FlßtšgObjeù
* 
	gr
;

1793 
	gD•»ÿ‹dPŒLi¡I‹¿tÜ
<
	gFlßtšgObjeù
> 
™
(*
m_æßtšgObjeùs
);

1794 ; (
	gr
 = 
™
.
cu¼’t
()); ++
	g™
) {

1796 ià(
	gr
->
	gm_shouldPašt
 && !r->
	gm_»nd””
->
hasS–fPaštšgLay”
()) {

1797 
PaštInfo
 
cu¼’tPaštInfo
(
·štInfo
);

1798 
	gcu¼’tPaštInfo
.
	gpha£
 = 
´e£rvePha£
 ? 
·štInfo
.
pha£
 : 
PaštPha£BlockBackground
;

1799 
	gcu¼’tTX
 = 
tx
 + 
r
->
m_Ëá
 -„->
m_»nd””
->
x
(è+„->m_»nd””->
m¬gšLeá
();

1800 
	gcu¼’tTY
 = 
ty
 + 
r
->
m_tİ
 -„->
m_»nd””
->
y
(è+„->m_»nd””->
m¬gšTİ
();

1801 
	gr
->
	gm_»nd””
->
·št
(
cu¼’tPaštInfo
, 
cu¼’tTX
, 
cu¼’tTY
);

1802 ià(!
	g´e£rvePha£
) {

1803 
	gcu¼’tPaštInfo
.
	gpha£
 = 
PaštPha£ChdBlockBackgrounds
;

1804 
	gr
->
	gm_»nd””
->
·št
(
cu¼’tPaštInfo
, 
cu¼’tTX
, 
cu¼’tTY
);

1805 
	gcu¼’tPaštInfo
.
	gpha£
 = 
PaštPha£Flßt
;

1806 
	gr
->
	gm_»nd””
->
·št
(
cu¼’tPaštInfo
, 
cu¼’tTX
, 
cu¼’tTY
);

1807 
	gcu¼’tPaštInfo
.
	gpha£
 = 
PaštPha£FÜeground
;

1808 
	gr
->
	gm_»nd””
->
·št
(
cu¼’tPaštInfo
, 
cu¼’tTX
, 
cu¼’tTY
);

1809 
	gcu¼’tPaštInfo
.
	gpha£
 = 
PaštPha£Ouše
;

1810 
	gr
->
	gm_»nd””
->
·št
(
cu¼’tPaštInfo
, 
cu¼’tTX
, 
cu¼’tTY
);

1816 
	gR’d”Block
::
·štEÎsisBoxes
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

1818 ià(!
shouldPaštW™hšRoÙ
(
·štInfo
è|| !
fœ¡LšeBox
())

1821 ià(
¡yË
()->
visib™y
(è=ğ
VISIBLE
 && 
·štInfo
.
pha£
 =ğ
PaštPha£FÜeground
) {

1824 
yPos
 = 
ty
 + 
fœ¡LšeBox
()->
y
();

1825 
	gh
 = 
Ï¡LšeBox
()->
y
(è+†a¡LšeBox()->
height
(è- 
fœ¡LšeBox
()->y();

1826 ià(
	gyPos
 >ğ
·štInfo
.
»ù
.
bÙtom
(è|| 
yPos
 + 
h
 <ğ·štInfo.»ù.
y
())

1832 
RoÙIÆšeBox
* 
	gcu¼
 = 
fœ¡RoÙBox
(); cu¼; cu¼ = 
cu¼
->
ÃxtRoÙBox
()) {

1833 
yPos
 = 
ty
 + 
cu¼
->
y
();

1834 
	gh
 = 
cu¼
->
height
();

1835 ià(
	gcu¼
->
–lsisBox
(è&& 
	gyPos
 < 
	g·štInfo
.
	g»ù
.
bÙtom
(è&& yPo + 
	gh
 >…aštInfo.»ù.
y
())

1836 
	gcu¼
->
·štEÎsisBox
(
·štInfo
, 
tx
, 
ty
);

1841 
CÚtšu©iÚOušeTabËM­
* 
cÚtšu©iÚOušeTabË
()

1843 
DEFINE_STATIC_LOCAL
(
CÚtšu©iÚOušeTabËM­
, 
bË
, ());

1844  &
	gbË
;

1847 
	gR’d”Block
::
addCÚtšu©iÚW™hOuše
(
R’d”IÆše
* 
æow
)

1851 
ASSERT
(!
æow
->
Ïy”
(è&& !æow->
isIÆšeCÚtšu©iÚ
());

1853 
CÚtšu©iÚOušeTabËM­
* 
	gbË
 = 
cÚtšu©iÚOušeTabË
();

1854 
	gLi¡HashS‘
<
	gR’d”IÆše
*>* 
	gcÚtšu©iÚs
 = 
bË
->
g‘
(
this
);

1855 ià(!
	gcÚtšu©iÚs
) {

1856 
	gcÚtšu©iÚs
 = 
Ãw
 
Li¡HashS‘
<
R’d”IÆše
*>;

1857 
	gbË
->
£t
(
this
, 
cÚtšu©iÚs
);

1860 
	gcÚtšu©iÚs
->
add
(
æow
);

1863 
	gR’d”Block
::
·štCÚtšu©iÚOušes
(
PaštInfo
& 
šfo
, 
tx
, 
ty
)

1865 
CÚtšu©iÚOušeTabËM­
* 
	gbË
 = 
cÚtšu©iÚOušeTabË
();

1866 ià(
	gbË
->
isEm±y
())

1869 
	gLi¡HashS‘
<
	gR’d”IÆše
*>* 
	gcÚtšu©iÚs
 = 
bË
->
g‘
(
this
);

1870 ià(!
	gcÚtšu©iÚs
)

1874 
	gLi¡HashS‘
<
	gR’d”IÆše
*>::
™”©Ü
 
’d
 = 
cÚtšu©iÚs
->end();

1875 
	gLi¡HashS‘
<
	gR’d”IÆše
*>::
™”©Ü
 
™
 = 
cÚtšu©iÚs
->
begš
(); 
	g™
 !ğ
’d
; ++it) {

1877 
R’d”IÆše
* 
	gæow
 = *
™
;

1878 
R’d”Block
* 
	gblock
 = 
æow
->
cÚššgBlock
();

1879  ; 
	gblock
 && block !ğ
this
; block = 
block
->
cÚššgBlock
()) {

1880 
tx
 +ğ
block
->
x
();

1881 
	gty
 +ğ
block
->
y
();

1883 
ASSERT
(
block
);

1884 
	gæow
->
·štOuše
(
šfo
.
cÚ‹xt
, 
tx
, 
ty
);

1888 
d–‘e
 
	gcÚtšu©iÚs
;

1889 
	gbË
->
»move
(
this
);

1892 
	gR’d”Block
::
£tS–eùiÚS‹
(
S–eùiÚS‹
 
s
)

1894 ià(
£ËùiÚS‹
(è=ğ
s
)

1897 ià(
	gs
 =ğ
S–eùiÚInside
 && 
£ËùiÚS‹
(è!ğ
S–eùiÚNÚe
)

1900 ià((
	gs
 =ğ
S–eùiÚS¹
 && 
£ËùiÚS‹
(è=ğ
S–eùiÚEnd
) ||

1901 (
s
 =ğ
S–eùiÚEnd
 && 
£ËùiÚS‹
(è=ğ
S–eùiÚS¹
))

1902 
R’d”Box
::
£tS–eùiÚS‹
(
S–eùiÚBÙh
);

1904 
	gR’d”Box
::
£tS–eùiÚS‹
(
s
);

1906 
R’d”Block
* 
	gcb
 = 
cÚššgBlock
();

1907 ià(
	gcb
 && !cb->
isR’d”V›w
())

1908 
	gcb
->
£tS–eùiÚS‹
(
s
);

1911 
boŞ
 
	gR’d”Block
::
shouldPaštS–eùiÚG­s
() const

1913  
£ËùiÚS‹
(è!ğ
S–eùiÚNÚe
 && 
¡yË
()->
visib™y
(è=ğ
VISIBLE
 && 
isS–eùiÚRoÙ
();

1916 
boŞ
 
	gR’d”Block
::
isS–eùiÚRoÙ
() const

1918 ià(!
node
())

1919  
çl£
;

1922 ià(
isTabË
())

1923  
	gçl£
;

1925 ià(
isBody
(è|| 
isRoÙ
(è|| 
hasOv”æowCl
(è|| 
isR–Pos™iÚed
() ||

1926 
isFlßtšgOrPos™iÚed
(è|| 
isTabËC–l
(è|| 
isIÆšeBlockOrIÆšeTabË
(è|| 
hasT¿nsfÜm
() ||

1927 
hasReæeùiÚ
(è|| 
hasMask
())

1928  
	gŒue
;

1930 ià(
v›w
(è&& v›w()->
£ËùiÚS¹
()) {

1931 
Node
* 
	g¡¬tEËm’t
 = 
v›w
()->
£ËùiÚS¹
()->
node
();

1932 ià(
	g¡¬tEËm’t
 && s¹EËm’t->
roÙEd™abËEËm’t
(è=ğ
node
())

1933  
Œue
;

1936  
	gçl£
;

1939 
G­Reùs
 
	gR’d”Block
::
£ËùiÚG­ReùsFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
)

1941 
ASSERT
(!
ÃedsLayout
());

1943 ià(!
shouldPaštS–eùiÚG­s
())

1944  
G­Reùs
();

1947 
T¿nsfÜmS‹
 
ŒªsfÜmS‹
(T¿nsfÜmS‹::
AµlyT¿nsfÜmDœeùiÚ
, 
FlßtPošt
());

1948 
m­LoÿlToCÚš”
(
»·štCÚš”
, 
çl£
, f®£, 
ŒªsfÜmS‹
);

1949 
IÁPošt
 
	goff£tFromR•aštCÚš”
 = 
roundedIÁPošt
(
ŒªsfÜmS‹
.
m­³dPošt
());

1951 ià(
hasOv”æowCl
())

1952 
	goff£tFromR•aštCÚš”
 -ğ
Ïy”
()->
süŞËdCÚ‹ÁOff£t
();

1954 
	gÏ¡Tİ
 = 0;

1955 
	gÏ¡Leá
 = 
ËáS–eùiÚOff£t
(
this
, 
Ï¡Tİ
);

1956 
	gÏ¡Right
 = 
rightS–eùiÚOff£t
(
this
, 
Ï¡Tİ
);

1958  
flS–eùiÚG­s
(
this
, 
off£tFromR•aštCÚš”
.
x
(), off£tFromR•aštCÚš”.
y
(), off£tFromR•aštCÚš”.x(), off£tFromR•aštCÚš”.y(), 
Ï¡Tİ
, 
Ï¡Leá
, 
Ï¡Right
);

1961 
	gR’d”Block
::
·štS–eùiÚ
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

1963 ià(
shouldPaštS–eùiÚG­s
(è&& 
	g·štInfo
.
	gpha£
 =ğ
PaštPha£FÜeground
) {

1964 
Ï¡Tİ
 = 0;

1965 
	gÏ¡Leá
 = 
ËáS–eùiÚOff£t
(
this
, 
Ï¡Tİ
);

1966 
	gÏ¡Right
 = 
rightS–eùiÚOff£t
(
this
, 
Ï¡Tİ
);

1967 
	g·štInfo
.
	gcÚ‹xt
->
§ve
();

1968 
IÁReù
 
	gg­ReùsBounds
 = 
flS–eùiÚG­s
(
this
, 
tx
, 
ty
,x,y, 
Ï¡Tİ
, 
Ï¡Leá
, 
Ï¡Right
, &
·štInfo
);

1969 ià(!
	gg­ReùsBounds
.
isEm±y
()) {

1970 ià(
R’d”Lay”
* 
	gÏy”
 = 
’şosšgLay”
()) {

1971 
g­ReùsBounds
.
move
(
IÁSize
(-
tx
, -
ty
));

1972 ià(!
hasLay”
()) {

1973 
FlßtReù
 
loÿlBounds
(
g­ReùsBounds
);

1974 
	gg­ReùsBounds
 = 
loÿlToCÚš”Quad
(
loÿlBounds
, 
Ïy”
->
»nd””
()).
’şosšgBoundšgBox
();

1975 
	gg­ReùsBounds
.
move
(
Ïy”
->
süŞËdCÚ‹ÁOff£t
());

1977 
	gÏy”
->
addBlockS–eùiÚG­sBounds
(
g­ReùsBounds
);

1980 
	g·štInfo
.
	gcÚ‹xt
->
»¡Üe
();

1984 #iâdeà
BUILDING_ON_TIGER


1985 
şOutPos™iÚedObjeùs
(cÚ¡ 
R’d”Objeù
::
PaštInfo
* 
·štInfo
, 
tx
, 
ty
, 
Li¡HashS‘
<
R’d”Box
*>* 
pos™iÚedObjeùs
)

1987 ià(!
	gpos™iÚedObjeùs
)

1990 
	gLi¡HashS‘
<
	gR’d”Box
*>::
cÚ¡_™”©Ü
 
’d
 = 
pos™iÚedObjeùs
->end();

1991 
	gLi¡HashS‘
<
	gR’d”Box
*>::
cÚ¡_™”©Ü
 
™
 = 
pos™iÚedObjeùs
->
begš
(); 
	g™
 !ğ
’d
; ++it) {

1992 
R’d”Box
* 
	gr
 = *
™
;

1993 
	g·štInfo
->
	gcÚ‹xt
->
şOut
(
IÁReù
(
tx
 + 
r
->
x
(), 
ty
 +„->
y
(),„->
width
(),„->
height
()));

1998 
G­Reùs
 
	gR’d”Block
::
flS–eùiÚG­s
(
R’d”Block
* 
roÙBlock
, 
blockX
, 
blockY
, 
tx
, 
ty
,

1999 & 
Ï¡Tİ
, & 
Ï¡Leá
, & 
Ï¡Right
, cÚ¡ 
PaštInfo
* 
·štInfo
)

2001 #iâdeà
BUILDING_ON_TIGER


2004 ià(
	g·štInfo
) {

2006 
şOutPos™iÚedObjeùs
(
·štInfo
, 
tx
, 
ty
, 
m_pos™iÚedObjeùs
);

2007 ià(
isBody
(è|| 
isRoÙ
())

2008 
R’d”Block
* 
	gcb
 = 
cÚššgBlock
(); cb && !cb->
isR’d”V›w
(); cb = 
cb
->containingBlock())

2009 
şOutPos™iÚedObjeùs
(
·štInfo
, 
cb
->
x
(), cb->
y
(), cb->
m_pos™iÚedObjeùs
);

2010 ià(
	gm_æßtšgObjeùs
) {

2011 
	gD•»ÿ‹dPŒLi¡I‹¿tÜ
<
	gFlßtšgObjeù
> 
™
(*
m_æßtšgObjeùs
); 
	g™
.
cu¼’t
(); ++it) {

2012 
FlßtšgObjeù
* 
	gr
 = 
™
.
cu¼’t
();

2013 
	g·štInfo
->
	gcÚ‹xt
->
şOut
(
IÁReù
(
tx
 + 
r
->
m_Ëá
 +„->
m_»nd””
->
m¬gšLeá
(),

2014 
ty
 + 
r
->
m_tİ
 +„->
m_»nd””
->
m¬gšTİ
(),

2015 
r
->
m_»nd””
->
width
(),„->m_»nd””->
height
()));

2023 
G­Reùs
 
	g»suÉ
;

2024 ià(!
isBlockFlow
())

2025  
	g»suÉ
;

2027 ià(
hasCŞumns
(è|| 
hasT¿nsfÜm
()) {

2029 
	gÏ¡Tİ
 = (
ty
 - 
blockY
è+ 
height
();

2030 
	gÏ¡Leá
 = 
ËáS–eùiÚOff£t
(
roÙBlock
, 
height
());

2031 
	gÏ¡Right
 = 
rightS–eùiÚOff£t
(
roÙBlock
, 
height
());

2032  
	g»suÉ
;

2035 ià(
chd»nIÆše
())

2036 
	g»suÉ
 = 
flIÆšeS–eùiÚG­s
(
roÙBlock
, 
blockX
, 
blockY
, 
tx
, 
ty
, 
Ï¡Tİ
, 
Ï¡Leá
, 
Ï¡Right
, 
·štInfo
);

2038 
	g»suÉ
 = 
flBlockS–eùiÚG­s
(
roÙBlock
, 
blockX
, 
blockY
, 
tx
, 
ty
, 
Ï¡Tİ
, 
Ï¡Leá
, 
Ï¡Right
, 
·štInfo
);

2041 ià(
	groÙBlock
 =ğ
this
 && (
£ËùiÚS‹
(è!ğ
S–eùiÚBÙh
 && s–eùiÚS‹(è!ğ
S–eùiÚEnd
))

2042 
»suÉ
.
un™eC’‹r
(
flV”tiÿlS–eùiÚG­
(
Ï¡Tİ
, 
Ï¡Leá
, 
Ï¡Right
, 
ty
 + 
height
(),

2043 
roÙBlock
, 
blockX
, 
blockY
, 
·štInfo
));

2044  
	g»suÉ
;

2047 
G­Reùs
 
	gR’d”Block
::
flIÆšeS–eùiÚG­s
(
R’d”Block
* 
roÙBlock
, 
blockX
, 
blockY
, 
tx
, 
ty
,

2048 & 
Ï¡Tİ
, & 
Ï¡Leá
, & 
Ï¡Right
, cÚ¡ 
PaštInfo
* 
·štInfo
)

2050 
G­Reùs
 
	g»suÉ
;

2052 
boŞ
 
	gcÚšsS¹
 = 
£ËùiÚS‹
(è=ğ
S–eùiÚS¹
 || s–eùiÚS‹(è=ğ
S–eùiÚBÙh
;

2054 ià(!
fœ¡LšeBox
()) {

2055 ià(
	gcÚšsS¹
) {

2058 
	gÏ¡Tİ
 = (
ty
 - 
blockY
è+ 
height
();

2059 
	gÏ¡Leá
 = 
ËáS–eùiÚOff£t
(
roÙBlock
, 
height
());

2060 
	gÏ¡Right
 = 
rightS–eùiÚOff£t
(
roÙBlock
, 
height
());

2062  
	g»suÉ
;

2065 
RoÙIÆšeBox
* 
	gÏ¡S–eùedLše
 = 0;

2066 
RoÙIÆšeBox
* 
	gcu¼
;

2067 
	gcu¼
 = 
fœ¡RoÙBox
(); cu¼ && !cu¼->
hasS–eùedChd»n
(); cu¼ = 
cu¼
->
ÃxtRoÙBox
()) { }

2070 ; 
	gcu¼
 && cu¼->
hasS–eùedChd»n
(); cu¼ = 
cu¼
->
ÃxtRoÙBox
()) {

2071 
£lTİ
 = 
cu¼
->
£ËùiÚTİ
();

2072 
	g£lHeight
 = 
cu¼
->
£ËùiÚHeight
();

2074 ià(!
	gcÚšsS¹
 && !
	gÏ¡S–eùedLše
 &&

2075 
£ËùiÚS‹
(è!ğ
S–eùiÚS¹
 && s–eùiÚS‹(è!ğ
S–eùiÚBÙh
)

2076 
»suÉ
.
un™eC’‹r
(
flV”tiÿlS–eùiÚG­
(
Ï¡Tİ
, 
Ï¡Leá
, 
Ï¡Right
, 
ty
 + 
£lTİ
,

2077 
roÙBlock
, 
blockX
, 
blockY
, 
·štInfo
));

2079 ià(!
	g·štInfo
 || (
	gty
 + 
	g£lTİ
 <…aštInfo->
	g»ù
.
bÙtom
(è&&y + s–Tİ + 
	g£lHeight
 >…aštInfo->»ù.
y
()))

2080 
	g»suÉ
.
un™e
(
cu¼
->
flLšeS–eùiÚG­
(
£lTİ
, 
£lHeight
, 
roÙBlock
, 
blockX
, 
blockY
, 
tx
, 
ty
, 
·štInfo
));

2082 
	gÏ¡S–eùedLše
 = 
cu¼
;

2085 ià(
	gcÚšsS¹
 && !
	gÏ¡S–eùedLše
)

2087 
	gÏ¡S–eùedLše
 = 
Ï¡RoÙBox
();

2089 ià(
	gÏ¡S–eùedLše
 && 
£ËùiÚS‹
(è!ğ
S–eùiÚEnd
 && s–eùiÚS‹(è!ğ
S–eùiÚBÙh
) {

2091 
Ï¡Tİ
 = (
ty
 - 
blockY
è+ 
Ï¡S–eùedLše
->
£ËùiÚBÙtom
();

2092 
	gÏ¡Leá
 = 
ËáS–eùiÚOff£t
(
roÙBlock
, 
Ï¡S–eùedLše
->
£ËùiÚBÙtom
());

2093 
	gÏ¡Right
 = 
rightS–eùiÚOff£t
(
roÙBlock
, 
Ï¡S–eùedLše
->
£ËùiÚBÙtom
());

2095  
	g»suÉ
;

2098 
G­Reùs
 
	gR’d”Block
::
flBlockS–eùiÚG­s
(
R’d”Block
* 
roÙBlock
, 
blockX
, 
blockY
, 
tx
, 
ty
,

2099 & 
Ï¡Tİ
, & 
Ï¡Leá
, & 
Ï¡Right
, cÚ¡ 
PaštInfo
* 
·štInfo
)

2101 
G­Reùs
 
	g»suÉ
;

2104 
R’d”Box
* 
	gcu¼
;

2105 
	gcu¼
 = 
fœ¡ChdBox
(); cu¼ && cu¼->
£ËùiÚS‹
(è=ğ
S–eùiÚNÚe
; cu¼ = 
cu¼
->
ÃxtSiblšgBox
()) { }

2107 
boŞ
 
§wS–eùiÚEnd
 = 
çl£
; 
	gcu¼
 && !
	g§wS–eùiÚEnd
; cu¼ = 
cu¼
->
ÃxtSiblšgBox
()) {

2108 
S–eùiÚS‹
 
chdS‹
 = 
cu¼
->
£ËùiÚS‹
();

2109 ià(
	gchdS‹
 =ğ
S–eùiÚBÙh
 || 
chdS‹
 =ğ
S–eùiÚEnd
)

2110 
§wS–eùiÚEnd
 = 
Œue
;

2112 ià(
	gcu¼
->
isFlßtšgOrPos™iÚed
())

2115 ià(
	gcu¼
->
isR–Pos™iÚed
(è&& cu¼->
hasLay”
()) {

2118 
IÁSize
 
	g»lOff£t
 = 
cu¼
->
Ïy”
()->
»ÏtivePos™iÚOff£t
();

2119 ià(
	g»lOff£t
.
width
(è||„–Off£t.
height
())

2123 
boŞ
 
	g·štsOwnS–eùiÚ
 = 
cu¼
->
shouldPaštS–eùiÚG­s
(è|| cu¼->
isTabË
();

2124 
boŞ
 
	gflBlockG­s
 = 
·štsOwnS–eùiÚ
 || (
cu¼
->
ÿnBeS–eùiÚL—f
(è&& 
chdS‹
 !ğ
S–eùiÚNÚe
);

2125 ià(
	gflBlockG­s
) {

2127 ià(
	gchdS‹
 =ğ
S–eùiÚEnd
 || 
chdS‹
 =ğ
S–eùiÚInside
)

2129 
»suÉ
.
un™eC’‹r
(
flV”tiÿlS–eùiÚG­
(
Ï¡Tİ
, 
Ï¡Leá
, 
Ï¡Right
,

2130 
ty
 + 
cu¼
->
y
(), 
roÙBlock
, 
blockX
, 
blockY
, 
·štInfo
));

2134 ià(
	g·štsOwnS–eùiÚ
 && (
	gchdS‹
 =ğ
S–eùiÚS¹
 || 
§wS–eùiÚEnd
))

2135 
chdS‹
 = 
S–eùiÚNÚe
;

2138 
boŞ
 
	gËáG­
, 
	grightG­
;

2139 
g‘HÜizÚlS–eùiÚG­Info
(
chdS‹
, 
ËáG­
, 
rightG­
);

2141 ià(
	gËáG­
)

2142 
	g»suÉ
.
un™eLeá
(
flLeáS–eùiÚG­
(
this
, 
cu¼
->
x
(), cu¼->
y
(), cu¼->
height
(), 
roÙBlock
, 
blockX
, 
blockY
, 
tx
, 
ty
, 
·štInfo
));

2143 ià(
	grightG­
)

2144 
	g»suÉ
.
un™eRight
(
flRightS–eùiÚG­
(
this
, 
cu¼
->
x
(è+ cu¼->
width
(), cu¼->
y
(), cu¼->
height
(), 
roÙBlock
, 
blockX
, 
blockY
, 
tx
, 
ty
, 
·štInfo
));

2149 
	gÏ¡Tİ
 = (
ty
 - 
blockY
è+ (
cu¼
->
y
(è+ cu¼->
height
());

2150 
	gÏ¡Leá
 = 
ËáS–eùiÚOff£t
(
roÙBlock
, 
cu¼
->
y
(è+ cu¼->
height
());

2151 
	gÏ¡Right
 = 
rightS–eùiÚOff£t
(
roÙBlock
, 
cu¼
->
y
(è+ cu¼->
height
());

2152 } ià(
	gchdS‹
 !ğ
S–eùiÚNÚe
)

2154 
»suÉ
.
un™e
(
toR’d”Block
(
cu¼
)->
flS–eùiÚG­s
(
roÙBlock
, 
blockX
, 
blockY
, 
tx
 + cu¼->
x
(), 
ty
 + cu¼->
y
(),

2155 
Ï¡Tİ
, 
Ï¡Leá
, 
Ï¡Right
, 
·štInfo
));

2157  
	g»suÉ
;

2160 
IÁReù
 
	gR’d”Block
::
flHÜizÚlS–eùiÚG­
(
R’d”Objeù
* 
£lObj
, 
xPos
, 
yPos
, 
width
, 
height
, cÚ¡ 
PaštInfo
* 
·štInfo
)

2162 ià(
	gwidth
 <ğ0 || 
height
 <= 0)

2163  
IÁReù
();

2164 
IÁReù
 
g­Reù
(
xPos
, 
yPos
, 
width
, 
height
);

2165 ià(
	g·štInfo
 && 
	g£lObj
->
¡yË
()->
visib™y
(è=ğ
VISIBLE
)

2166 
·štInfo
->
cÚ‹xt
->
flReù
(
g­Reù
, 
£lObj
->
£ËùiÚBackgroundCŞÜ
(), s–Obj->
¡yË
()->
cŞÜS·û
());

2167  
	gg­Reù
;

2170 
IÁReù
 
	gR’d”Block
::
flV”tiÿlS–eùiÚG­
(
Ï¡Tİ
, 
Ï¡Leá
, 
Ï¡Right
, 
bÙtomY
, 
R’d”Block
* 
roÙBlock
,

2171 
blockX
, 
blockY
, cÚ¡ 
PaštInfo
* 
·štInfo
)

2173 
	gtİ
 = 
blockY
 + 
Ï¡Tİ
;

2174 
	gheight
 = 
bÙtomY
 - 
tİ
;

2175 ià(
	gheight
 <= 0)

2176  
IÁReù
();

2179 
	gËá
 = 
blockX
 + 
max
(
Ï¡Leá
, 
ËáS–eùiÚOff£t
(
roÙBlock
, 
bÙtomY
));

2180 
	gright
 = 
blockX
 + 
mš
(
Ï¡Right
, 
rightS–eùiÚOff£t
(
roÙBlock
, 
bÙtomY
));

2181 
	gwidth
 = 
right
 - 
Ëá
;

2182 ià(
	gwidth
 <= 0)

2183  
IÁReù
();

2185 
IÁReù
 
g­Reù
(
Ëá
, 
tİ
, 
width
, 
height
);

2186 ià(
	g·štInfo
)

2187 
	g·štInfo
->
	gcÚ‹xt
->
flReù
(
g­Reù
, 
£ËùiÚBackgroundCŞÜ
(), 
¡yË
()->
cŞÜS·û
());

2188  
	gg­Reù
;

2191 
IÁReù
 
	gR’d”Block
::
flLeáS–eùiÚG­
(
R’d”Objeù
* 
£lObj
, 
xPos
, 
yPos
, 
height
, 
R’d”Block
* 
roÙBlock
,

2192 
blockX
, , 
tx
, 
ty
, cÚ¡ 
PaštInfo
* 
·štInfo
)

2194 
	gtİ
 = 
yPos
 + 
ty
;

2195 
	gËá
 = 
blockX
 + 
max
(
ËáS–eùiÚOff£t
(
roÙBlock
, 
yPos
),†eáS–eùiÚOff£tÔoÙBlock, yPo + 
height
));

2196 
	gright
 = 
mš
(
xPos
 + 
tx
, 
blockX
 + mš(
rightS–eùiÚOff£t
(
roÙBlock
, 
yPos
),„ightS–eùiÚOff£tÔoÙBlock, yPo + 
height
)));

2197 
	gwidth
 = 
right
 - 
Ëá
;

2198 ià(
	gwidth
 <= 0)

2199  
IÁReù
();

2201 
IÁReù
 
g­Reù
(
Ëá
, 
tİ
, 
width
, 
height
);

2202 ià(
	g·štInfo
)

2203 
	g·štInfo
->
	gcÚ‹xt
->
flReù
(
g­Reù
, 
£lObj
->
£ËùiÚBackgroundCŞÜ
(), s–Obj->
¡yË
()->
cŞÜS·û
());

2204  
	gg­Reù
;

2207 
IÁReù
 
	gR’d”Block
::
flRightS–eùiÚG­
(
R’d”Objeù
* 
£lObj
, 
xPos
, 
yPos
, 
height
, 
R’d”Block
* 
roÙBlock
,

2208 
blockX
, , 
tx
, 
ty
, cÚ¡ 
PaštInfo
* 
·štInfo
)

2210 
	gËá
 = 
max
(
xPos
 + 
tx
, 
blockX
 + max(
ËáS–eùiÚOff£t
(
roÙBlock
, 
yPos
),†eáS–eùiÚOff£tÔoÙBlock, yPo + 
height
)));

2211 
	gtİ
 = 
yPos
 + 
ty
;

2212 
	gright
 = 
blockX
 + 
mš
(
rightS–eùiÚOff£t
(
roÙBlock
, 
yPos
),„ightS–eùiÚOff£tÔoÙBlock, yPo + 
height
));

2213 
	gwidth
 = 
right
 - 
Ëá
;

2214 ià(
	gwidth
 <= 0)

2215  
IÁReù
();

2217 
IÁReù
 
g­Reù
(
Ëá
, 
tİ
, 
width
, 
height
);

2218 ià(
	g·štInfo
)

2219 
	g·štInfo
->
	gcÚ‹xt
->
flReù
(
g­Reù
, 
£lObj
->
£ËùiÚBackgroundCŞÜ
(), s–Obj->
¡yË
()->
cŞÜS·û
());

2220  
	gg­Reù
;

2223 
	gR’d”Block
::
g‘HÜizÚlS–eùiÚG­Info
(
S–eùiÚS‹
 
¡©e
, 
boŞ
& 
ËáG­
, boŞ& 
rightG­
)

2225 
boŞ
 
	gÉr
 = 
¡yË
()->
dœeùiÚ
(è=ğ
LTR
;

2226 
	gËáG­
 = (
¡©e
 =ğ
R’d”Objeù
::
S–eùiÚInside
) ||

2227 (
¡©e
 =ğ
R’d”Objeù
::
S–eùiÚEnd
 && 
Ér
) ||

2228 (
¡©e
 =ğ
R’d”Objeù
::
S–eùiÚS¹
 && !
Ér
);

2229 
	grightG­
 = (
¡©e
 =ğ
R’d”Objeù
::
S–eùiÚInside
) ||

2230 (
¡©e
 =ğ
R’d”Objeù
::
S–eùiÚS¹
 && 
Ér
) ||

2231 (
¡©e
 =ğ
R’d”Objeù
::
S–eùiÚEnd
 && !
Ér
);

2234 
	gR’d”Block
::
ËáS–eùiÚOff£t
(
R’d”Block
* 
roÙBlock
, 
yPos
)

2236 
	gËá
 = 
ËáOff£t
(
yPos
, 
çl£
);

2237 ià(
	gËá
 =ğ
bÜd”Leá
(è+ 
·ddšgLeá
()) {

2238 ià(
roÙBlock
 !ğ
this
)

2240  
cÚššgBlock
()->
ËáS–eùiÚOff£t
(
roÙBlock
, 
yPos
 + 
y
());

2241  
	gËá
;

2244 
R’d”Block
* 
	gcb
 = 
this
;

2245 
	gcb
 !ğ
roÙBlock
) {

2246 
Ëá
 +ğ
cb
->
x
();

2247 
	gcb
 = 
cb
->
cÚššgBlock
();

2251  
	gËá
;

2254 
	gR’d”Block
::
rightS–eùiÚOff£t
(
R’d”Block
* 
roÙBlock
, 
yPos
)

2256 
	gright
 = 
rightOff£t
(
yPos
, 
çl£
);

2257 ià(
	gright
 =ğ(
cÚ‹ÁWidth
(è+ (
bÜd”Leá
(è+ 
·ddšgLeá
()))) {

2258 ià(
roÙBlock
 !ğ
this
)

2260  
cÚššgBlock
()->
rightS–eùiÚOff£t
(
roÙBlock
, 
yPos
 + 
y
());

2261  
	gright
;

2264 
R’d”Block
* 
	gcb
 = 
this
;

2265 
	gcb
 !ğ
roÙBlock
) {

2266 
right
 +ğ
cb
->
x
();

2267 
	gcb
 = 
cb
->
cÚššgBlock
();

2270  
	gright
;

2273 
	gR’d”Block
::
š£¹Pos™iÚedObjeù
(
R’d”Box
* 
o
)

2276 ià(!
m_pos™iÚedObjeùs
)

2277 
m_pos™iÚedObjeùs
 = 
Ãw
 
Li¡HashS‘
<
R’d”Box
*>;

2279 
	gm_pos™iÚedObjeùs
->
add
(
o
);

2282 
	gR’d”Block
::
»movePos™iÚedObjeù
(
R’d”Box
* 
o
)

2284 ià(
m_pos™iÚedObjeùs
)

2285 
m_pos™iÚedObjeùs
->
»move
(
o
);

2288 
	gR’d”Block
::
»movePos™iÚedObjeùs
(
R’d”Block
* 
o
)

2290 ià(!
m_pos™iÚedObjeùs
)

2293 
R’d”Box
* 
	gr
;

2295 
I‹¿tÜ
 
	g’d
 = 
m_pos™iÚedObjeùs
->
’d
();

2297 
	gVeùÜ
<
	gR’d”Box
*, 16> 
	gd—dObjeùs
;

2299 
I‹¿tÜ
 
	g™
 = 
m_pos™iÚedObjeùs
->
begš
(); iˆ!ğ
’d
; ++it) {

2300 
	gr
 = *
™
;

2301 ià(!
	go
 || 
	gr
->
isDesûndªtOf
(
o
)) {

2302 ià(
	go
)

2303 
	gr
->
£tChdN“dsLayout
(
Œue
, 
çl£
);

2307 
R’d”Objeù
* 
	gp
 = 
r
->
·»Á
();

2308 
	gp
 && !p->
isR’d”Block
())

2309 
	gp
 = 
p
->
·»Á
();

2310 ià(
	gp
)

2311 
	gp
->
£tChdN“dsLayout
(
Œue
);

2313 
	gd—dObjeùs
.
­³nd
(
r
);

2317 
	gi
 = 0; i < 
	gd—dObjeùs
.
size
(); i++)

2318 
	gm_pos™iÚedObjeùs
->
»move
(
d—dObjeùs
.
©
(
i
));

2321 
	gR’d”Block
::
š£¹FlßtšgObjeù
(
R’d”Box
* 
o
)

2323 
ASSERT
(
o
->
isFlßtšg
());

2326 ià(!
	gm_æßtšgObjeùs
) {

2327 
	gm_æßtšgObjeùs
 = 
Ãw
 
D•»ÿ‹dPŒLi¡
<
FlßtšgObjeù
>;

2328 
	gm_æßtšgObjeùs
->
£tAutoD–‘e
(
Œue
);

2331 
	gD•»ÿ‹dPŒLi¡I‹¿tÜ
<
	gFlßtšgObjeù
> 
™
(*
m_æßtšgObjeùs
);

2332 
FlßtšgObjeù
* 
	gf
;

2333  (
	gf
 = 
™
.
cu¼’t
()) ) {

2334 ià(
f
->
m_»nd””
 =ğ
o
) ;

2335 ++
	g™
;

2341 
	go
->
ÏyoutIfN“ded
();

2343 
FlßtšgObjeù
* 
	gÃwObj
 = 
Ãw
 FlßtšgObjeù(
o
->
¡yË
()->
æßtšg
(è=ğ
FLEFT
 ? FlßtšgObjeù::
FlßtLeá
 : FlßtšgObjeù::
FlßtRight
);

2345 
	gÃwObj
->
	gm_tİ
 = -1;

2346 
	gÃwObj
->
	gm_bÙtom
 = -1;

2347 
	gÃwObj
->
	gm_width
 = 
o
->
width
(è+ o->
m¬gšLeá
(è+ o->
m¬gšRight
();

2348 
	gÃwObj
->
	gm_shouldPašt
 = !
o
->
hasS–fPaštšgLay”
();

2349 
	gÃwObj
->
	gm_isDesûndªt
 = 
Œue
;

2350 
	gÃwObj
->
	gm_»nd””
 = 
o
;

2352 
	gm_æßtšgObjeùs
->
­³nd
(
ÃwObj
);

2355 
	gR’d”Block
::
»moveFlßtšgObjeù
(
R’d”Box
* 
o
)

2357 ià(
m_æßtšgObjeùs
) {

2358 
D•»ÿ‹dPŒLi¡I‹¿tÜ
<
FlßtšgObjeù
> 
™
(*
m_æßtšgObjeùs
);

2359 
	g™
.
cu¼’t
()) {

2360 ià(
	g™
.
cu¼’t
()->
	gm_»nd””
 =ğ
o
) {

2361 ià(
chd»nIÆše
()) {

2362 
bÙtom
 = 
™
.
cu¼’t
()->
m_bÙtom
;

2366 
	gbÙtom
 = 
max
(
bÙtom
, 
™
.
cu¼’t
()->
m_tİ
 + 1);

2367 
m¬kLšesDœtyInV”tiÿlRªge
(0, 
bÙtom
);

2369 
	gm_æßtšgObjeùs
->
»moveRef
(
™
.
cu¼’t
());

2371 ++
	g™
;

2376 
boŞ
 
	gR’d”Block
::
pos™iÚNewFlßts
()

2378 ià(!
m_æßtšgObjeùs
)

2379  
çl£
;

2381 
FlßtšgObjeù
* 
	gf
 = 
m_æßtšgObjeùs
->
Ï¡
();

2384 ià(!
	gf
 || f->
	gm_tİ
 != -1)

2385  
çl£
;

2390 
FlßtšgObjeù
* 
	gÏ¡Flßt
 = 
m_æßtšgObjeùs
->
g‘P»v
();

2391 
	gÏ¡Flßt
 &&†a¡Flßt->
	gm_tİ
 == -1) {

2392 
f
 = 
m_æßtšgObjeùs
->
´ev
();

2393 
	gÏ¡Flßt
 = 
m_æßtšgObjeùs
->
g‘P»v
();

2396 
	gy
 = 
height
();

2399 ià(
	gÏ¡Flßt
)

2400 
	gy
 = 
max
(
Ï¡Flßt
->
m_tİ
, 
y
);

2403 
	gf
) {

2406 ià(
	gf
->
	gm_»nd””
->
cÚššgBlock
(è!ğ
this
) {

2407 
f
 = 
m_æßtšgObjeùs
->
Ãxt
();

2411 
R’d”Box
* 
	go
 = 
f
->
m_»nd””
;

2412 
	g_height
 = 
o
->
height
(è+ o->
m¬gšTİ
(è+ o->
m¬gšBÙtom
();

2414 
	gro
 = 
rightOff£t
();

2415 
	glo
 = 
ËáOff£t
();

2416 
	gfwidth
 = 
f
->
m_width
;

2417 ià(
	gro
 - 
	glo
 < 
	gfwidth
)

2418 
	gfwidth
 = 
ro
 - 
lo
;

2420 
IÁReù
 
ŞdReù
(
o
->
x
(), o->
y
(è, o->
width
(), o->
height
());

2422 ià(
	go
->
¡yË
()->
ş—r
(è& 
	gCLEFT
)

2423 
	gy
 = 
max
(
ËáBÙtom
(), 
y
);

2424 ià(
	go
->
¡yË
()->
ş—r
(è& 
	gCRIGHT
)

2425 
	gy
 = 
max
(
rightBÙtom
(), 
y
);

2427 ià(
	go
->
¡yË
()->
æßtšg
(è=ğ
FLEFT
) {

2428 
heightRemaššgLeá
 = 1;

2429 
	gheightRemaššgRight
 = 1;

2430 
	gfx
 = 
ËáR–Off£t
(
y
, 
lo
, 
çl£
, &
heightRemaššgLeá
);

2431 
rightR–Off£t
(
y
, 
ro
, 
çl£
, &
heightRemaššgRight
)-
	gfx
 < 
	gfwidth
) {

2432 
	gy
 +ğ
mš
(
heightRemaššgLeá
, 
heightRemaššgRight
);

2433 
	gfx
 = 
ËáR–Off£t
(
y
, 
lo
, 
çl£
, &
heightRemaššgLeá
);

2435 
	gfx
 = 
max
(0, 
fx
);

2436 
	gf
->
	gm_Ëá
 = 
fx
;

2437 
	go
->
£tLoÿtiÚ
(
fx
 + 
o
->
m¬gšLeá
(), 
y
 + o->
m¬gšTİ
());

2439 
	gheightRemaššgLeá
 = 1;

2440 
	gheightRemaššgRight
 = 1;

2441 
	gfx
 = 
rightR–Off£t
(
y
, 
ro
, 
çl£
, &
heightRemaššgRight
);

2442 
	gfx
 - 
ËáR–Off£t
(
y
, 
lo
, 
çl£
, &
heightRemaššgLeá
è< 
	gfwidth
) {

2443 
	gy
 +ğ
mš
(
heightRemaššgLeá
, 
heightRemaššgRight
);

2444 
	gfx
 = 
rightR–Off£t
(
y
, 
ro
, 
çl£
, &
heightRemaššgRight
);

2446 
	gf
->
	gm_Ëá
 = 
fx
 - 
f
->
m_width
;

2447 
	go
->
£tLoÿtiÚ
(
fx
 - 
o
->
m¬gšRight
(è- o->
width
(), 
y
 + o->
m¬gšTİ
());

2450 
	gf
->
	gm_tİ
 = 
y
;

2451 
	gf
->
	gm_bÙtom
 = 
f
->
m_tİ
 + 
_height
;

2454 ià(
	go
->
checkFÜR•aštDuršgLayout
())

2455 
	go
->
»·štDuršgLayoutIfMoved
(
ŞdReù
);

2457 
	gf
 = 
m_æßtšgObjeùs
->
Ãxt
();

2459  
	gŒue
;

2462 
	gR’d”Block
::
ÃwLše
(
ECË¬
 
ş—r
)

2464 
pos™iÚNewFlßts
();

2466 
	gÃwY
 = 0;

2467 
	gş—r
)

2469 
	gCLEFT
:

2470 
ÃwY
 = 
ËáBÙtom
();

2472 
	gCRIGHT
:

2473 
ÃwY
 = 
rightBÙtom
();

2475 
	gCBOTH
:

2476 
ÃwY
 = 
æßtBÙtom
();

2480 ià(
height
(è< 
	gÃwY
)

2481 
£tHeight
(
ÃwY
);

2484 
	gR’d”Block
::
addP”ûÁHeightDesûndªt
(
R’d”Box
* 
desûndªt
)

2486 ià(!
gP”ûÁHeightDesûndªtsM­
) {

2487 
gP”ûÁHeightDesûndªtsM­
 = 
Ãw
 
P”ûÁHeightDesûndªtsM­
;

2488 
	ggP”ûÁHeightCÚš”M­
 = 
Ãw
 
P”ûÁHeightCÚš”M­
;

2491 
	gHashS‘
<
	gR’d”Box
*>* 
	gdesûndªtS‘
 = 
gP”ûÁHeightDesûndªtsM­
->
g‘
(
this
);

2492 ià(!
	gdesûndªtS‘
) {

2493 
	gdesûndªtS‘
 = 
Ãw
 
HashS‘
<
R’d”Box
*>;

2494 
	ggP”ûÁHeightDesûndªtsM­
->
£t
(
this
, 
desûndªtS‘
);

2496 
boŞ
 
	gadded
 = 
desûndªtS‘
->
add
(
desûndªt
).
£cÚd
;

2497 ià(!
	gadded
) {

2498 
ASSERT
(
gP”ûÁHeightCÚš”M­
->
g‘
(
desûndªt
));

2499 
ASSERT
(
gP”ûÁHeightCÚš”M­
->
g‘
(
desûndªt
)->
cÚšs
(
this
));

2503 
	gHashS‘
<
	gR’d”Block
*>* 
	gcÚš”S‘
 = 
gP”ûÁHeightCÚš”M­
->
g‘
(
desûndªt
);

2504 ià(!
	gcÚš”S‘
) {

2505 
	gcÚš”S‘
 = 
Ãw
 
HashS‘
<
R’d”Block
*>;

2506 
	ggP”ûÁHeightCÚš”M­
->
£t
(
desûndªt
, 
cÚš”S‘
);

2508 
ASSERT
(!
cÚš”S‘
->
cÚšs
(
this
));

2509 
	gcÚš”S‘
->
add
(
this
);

2512 
	gR’d”Block
::
»moveP”ûÁHeightDesûndªt
(
R’d”Box
* 
desûndªt
)

2514 ià(!
gP”ûÁHeightCÚš”M­
)

2517 
	gHashS‘
<
	gR’d”Block
*>* 
	gcÚš”S‘
 = 
gP”ûÁHeightCÚš”M­
->
ke
(
desûndªt
);

2518 ià(!
	gcÚš”S‘
)

2521 
	gHashS‘
<
	gR’d”Block
*>::
™”©Ü
 
’d
 = 
cÚš”S‘
->end();

2522 
	gHashS‘
<
	gR’d”Block
*>::
™”©Ü
 
™
 = 
cÚš”S‘
->
begš
(); 
	g™
 !ğ
’d
; ++it) {

2523 
R’d”Block
* 
	gcÚš”
 = *
™
;

2524 
	gHashS‘
<
	gR’d”Box
*>* 
	gdesûndªtS‘
 = 
gP”ûÁHeightDesûndªtsM­
->
g‘
(
cÚš”
);

2525 
ASSERT
(
desûndªtS‘
);

2526 ià(!
	gdesûndªtS‘
)

2528 
ASSERT
(
desûndªtS‘
->
cÚšs
(
desûndªt
));

2529 
	gdesûndªtS‘
->
»move
(
desûndªt
);

2530 ià(
	gdesûndªtS‘
->
isEm±y
()) {

2531 
	ggP”ûÁHeightDesûndªtsM­
->
»move
(
cÚš”
);

2532 
d–‘e
 
	gdesûndªtS‘
;

2536 
d–‘e
 
	gcÚš”S‘
;

2539 
	gHashS‘
<
	gR’d”Box
*>* 
	gR’d”Block
::
³rûÁHeightDesûndªts
() const

2541  
gP”ûÁHeightDesûndªtsM­
 ? gP”ûÁHeightDesûndªtsM­->
g‘
(
this
) : 0;

2544 
	gR’d”Block
::
ËáOff£t
() const

2546  
bÜd”Leá
(è+ 
·ddšgLeá
();

2549 
	gR’d”Block
::
ËáR–Off£t
(
y
, 
fixedOff£t
, 
boŞ
 
­¶yTextInd’t
, * 
heightRemaššg
) const

2551 
	gËá
 = 
fixedOff£t
;

2552 ià(
	gm_æßtšgObjeùs
) {

2553 iàĞ
	gheightRemaššg
 ) *heightRemaining = 1;

2554 
FlßtšgObjeù
* 
	gr
;

2555 
	gD•»ÿ‹dPŒLi¡I‹¿tÜ
<
	gFlßtšgObjeù
> 
™
(*
m_æßtšgObjeùs
);

2556  ; (
	gr
 = 
™
.
cu¼’t
()); ++
	g™
 )

2558 ià(
	gr
->
	gm_tİ
 <ğ
y
 && 
r
->
m_bÙtom
 > y &&

2559 
r
->
ty³
(è=ğ
FlßtšgObjeù
::
FlßtLeá
 &&

2560 
r
->
m_Ëá
 +„->
m_width
 > 
Ëá
) {

2561 
Ëá
 = 
r
->
m_Ëá
 +„->
m_width
;

2562 iàĞ
	gheightRemaššg
 ) *heightRemaššg = 
r
->
m_bÙtom
 - 
y
;

2567 ià(
	g­¶yTextInd’t
 && 
¡yË
()->
dœeùiÚ
(è=ğ
LTR
) {

2568 
cw
 = 0;

2569 ià(
¡yË
()->
‹xtInd’t
().
isP”ûÁ
())

2570 
	gcw
 = 
cÚššgBlock
()->
avaabËWidth
();

2571 
	gËá
 +ğ
¡yË
()->
‹xtInd’t
().
ÿlcMšV®ue
(
cw
);

2574  
	gËá
;

2577 
	gR’d”Block
::
rightOff£t
() const

2579  
bÜd”Leá
(è+ 
·ddšgLeá
(è+ 
avaabËWidth
();

2582 
	gR’d”Block
::
rightR–Off£t
(
y
, 
fixedOff£t
, 
boŞ
 
­¶yTextInd’t
, * 
heightRemaššg
) const

2584 
	gright
 = 
fixedOff£t
;

2586 ià(
	gm_æßtšgObjeùs
) {

2587 ià(
	gheightRemaššg
) *heightRemaining = 1;

2588 
FlßtšgObjeù
* 
	gr
;

2589 
	gD•»ÿ‹dPŒLi¡I‹¿tÜ
<
	gFlßtšgObjeù
> 
™
(*
m_æßtšgObjeùs
);

2590  ; (
	gr
 = 
™
.
cu¼’t
()); ++
	g™
 )

2592 ià(
	gr
->
	gm_tİ
 <ğ
y
 && 
r
->
m_bÙtom
 > y &&

2593 
r
->
ty³
(è=ğ
FlßtšgObjeù
::
FlßtRight
 &&

2594 
r
->
m_Ëá
 < 
right
) {

2595 
right
 = 
r
->
m_Ëá
;

2596 iàĞ
	gheightRemaššg
 ) *heightRemaššg = 
r
->
m_bÙtom
 - 
y
;

2601 ià(
	g­¶yTextInd’t
 && 
¡yË
()->
dœeùiÚ
(è=ğ
RTL
) {

2602 
cw
 = 0;

2603 ià(
¡yË
()->
‹xtInd’t
().
isP”ûÁ
())

2604 
	gcw
 = 
cÚššgBlock
()->
avaabËWidth
();

2605 
	gright
 -ğ
¡yË
()->
‹xtInd’t
().
ÿlcMšV®ue
(
cw
);

2608  
	gright
;

2612 
	gR’d”Block
::
lšeWidth
(
y
, 
boŞ
 
fœ¡Lše
) const

2614 
	g»suÉ
 = 
rightOff£t
(
y
, 
fœ¡Lše
è- 
ËáOff£t
(y, firstLine);

2615  (
	g»suÉ
 < 0è? 0 : 
»suÉ
;

2618 
	gR’d”Block
::
ÃxtFlßtBÙtomB–ow
(
height
) const

2620 ià(!
m_æßtšgObjeùs
)

2623 
	gbÙtom
 = 
INT_MAX
;

2624 
FlßtšgObjeù
* 
	gr
;

2625 
	gD•»ÿ‹dPŒLi¡I‹¿tÜ
<
	gFlßtšgObjeù
> 
™
(*
m_æßtšgObjeùs
);

2626  ; (
	gr
 = 
™
.
cu¼’t
()); ++
	g™
) {

2627 ià(
	gr
->
	gm_bÙtom
 > 
	gheight
)

2628 
	gbÙtom
 = 
mš
(
r
->
m_bÙtom
, 
bÙtom
);

2631  
	gbÙtom
 =ğ
INT_MAX
 ? 0 : 
bÙtom
;

2635 
	gR’d”Block
::
æßtBÙtom
() const

2637 ià(!
m_æßtšgObjeùs
)  0;

2638 
	gbÙtom
 = 0;

2639 
FlßtšgObjeù
* 
	gr
;

2640 
	gD•»ÿ‹dPŒLi¡I‹¿tÜ
<
	gFlßtšgObjeù
> 
™
(*
m_æßtšgObjeùs
);

2641  ; (
	gr
 = 
™
.
cu¼’t
()); ++
	g™
 )

2642 ià(
	gr
->
	gm_bÙtom
>
	gbÙtom
)

2643 
	gbÙtom
 = 
r
->
m_bÙtom
;

2644  
	gbÙtom
;

2647 
	gR’d”Block
::
lowe¡Pos™iÚ
(
boŞ
 
šşudeOv”æowIÁ”iÜ
, boŞ 
šşudeS–f
) const

2649 
	gbÙtom
 = 
šşudeS–f
 && 
width
(è> 0 ? 
height
() : 0;

2651 ià(!
	gšşudeOv”æowIÁ”iÜ
 && (
hasOv”æowCl
(è|| 
hasCÚŒŞCl
()))

2652  
	gbÙtom
;

2654 ià(!
fœ¡Chd
(è&& (!
width
(è|| !
height
()))

2655  
	gbÙtom
;

2657 ià(!
hasCŞumns
()) {

2664 
R’d”Objeù
* 
	gc
 = 
fœ¡Chd
(); c; c = 
c
->
ÃxtSiblšg
()) {

2665 ià(!
c
->
isFlßtšgOrPos™iÚed
(è&& c->
isBox
()) {

2666 
R’d”Box
* 
chdBox
 = 
toR’d”Box
(
c
);

2667 
	gbÙtom
 = 
max
(
bÙtom
, 
chdBox
->
y
(è+ chdBox->
lowe¡Pos™iÚ
(
çl£
));

2672 ià(
	gšşudeS–f
 && 
isR–Pos™iÚed
())

2673 
	gbÙtom
 +ğ
»ÏtivePos™iÚOff£tY
();

2674 ià(!
	gšşudeOv”æowIÁ”iÜ
 && 
hasOv”æowCl
())

2675  
	gbÙtom
;

2677 
	g»ÏtiveOff£t
 = 
šşudeS–f
 && 
isR–Pos™iÚed
(è? 
»ÏtivePos™iÚOff£tY
() : 0;

2679 ià(
	gšşudeS–f
)

2680 
	gbÙtom
 = 
max
(
bÙtom
, 
bÙtomLayoutOv”æow
(è+ 
»ÏtiveOff£t
);

2682 ià(
	gm_pos™iÚedObjeùs
) {

2683 
R’d”Box
* 
	gr
;

2684 
I‹¿tÜ
 
	g’d
 = 
m_pos™iÚedObjeùs
->
’d
();

2685 
I‹¿tÜ
 
	g™
 = 
m_pos™iÚedObjeùs
->
begš
(); iˆ!ğ
’d
; ++it) {

2686 
	gr
 = *
™
;

2689 ià(
	gr
->
¡yË
()->
pos™iÚ
(è!ğ
FixedPos™iÚ
) {

2693 ià(!
isR’d”V›w
(è|| 
r
->
x
(è+„->
width
(è> 0 ||„->x(è+„->
rightmo¡Pos™iÚ
(
çl£
) > 0) {

2694 
Í
 = 
r
->
y
(è+„->
lowe¡Pos™iÚ
(
çl£
);

2695 
	gbÙtom
 = 
max
(
bÙtom
, 
Í
 + 
»ÏtiveOff£t
);

2701 ià(
hasCŞumns
()) {

2702 
	gVeùÜ
<
	gIÁReù
>* 
	gcŞReùs
 = 
cŞumnReùs
();

2703 
	gi
 = 0; i < 
	gcŞReùs
->
size
(); i++)

2704 
	gbÙtom
 = 
max
(
bÙtom
, 
cŞReùs
->
©
(
i
).bÙtom(è+ 
»ÏtiveOff£t
);

2705  
	gbÙtom
;

2708 ià(
	gm_æßtšgObjeùs
) {

2709 
FlßtšgObjeù
* 
	gr
;

2710 
	gD•»ÿ‹dPŒLi¡I‹¿tÜ
<
	gFlßtšgObjeù
> 
™
(*
m_æßtšgObjeùs
);

2711  ; (
	gr
 = 
™
.
cu¼’t
()); ++
	g™
 ) {

2712 ià(
	gr
->
	gm_shouldPašt
 ||„->
	gm_»nd””
->
hasS–fPaštšgLay”
()) {

2713 
	gÍ
 = 
r
->
m_tİ
 +„->
m_»nd””
->
m¬gšTİ
(è+„->m_»nd””->
lowe¡Pos™iÚ
(
çl£
);

2714 
	gbÙtom
 = 
max
(
bÙtom
, 
Í
 + 
»ÏtiveOff£t
);

2719 ià(!
	gšşudeS–f
) {

2720 
	gbÙtom
 = 
max
(
bÙtom
, 
bÜd”Tİ
(è+ 
·ddšgTİ
(è+ 
·ddšgBÙtom
(è+ 
»ÏtiveOff£t
);

2721 ià(
chd»nIÆše
()) {

2722 ià(
Ï¡RoÙBox
()) {

2723 
	gchdBÙtomEdge
 = 
Ï¡RoÙBox
()->
£ËùiÚBÙtom
();

2724 
	gbÙtom
 = 
max
(
bÙtom
, 
chdBÙtomEdge
 + 
·ddšgBÙtom
(è+ 
»ÏtiveOff£t
);

2728 
R’d”Box
* 
	gcu¼Box
 = 
Ï¡ChdBox
();

2729 
	gcu¼Box
 && cu¼Box->
isFlßtšgOrPos™iÚed
())

2730 
	gcu¼Box
 = 
cu¼Box
->
´eviousSiblšgBox
();

2731 ià(
	gcu¼Box
) {

2732 
	gchdBÙtomEdge
 = 
cu¼Box
->
y
(è+ cu¼Box->
height
(è+ cu¼Box->
cŞÏp£dM¬gšBÙtom
();

2733 
	gbÙtom
 = 
max
(
bÙtom
, 
chdBÙtomEdge
 + 
·ddšgBÙtom
(è+ 
»ÏtiveOff£t
);

2738  
	gbÙtom
;

2741 
	gR’d”Block
::
rightmo¡Pos™iÚ
(
boŞ
 
šşudeOv”æowIÁ”iÜ
, boŞ 
šşudeS–f
) const

2743 
	gright
 = 
šşudeS–f
 && 
height
(è> 0 ? 
width
() : 0;

2745 ià(!
	gšşudeOv”æowIÁ”iÜ
 && (
hasOv”æowCl
(è|| 
hasCÚŒŞCl
()))

2746  
	gright
;

2748 ià(!
fœ¡Chd
(è&& (!
width
(è|| !
height
()))

2749  
	gright
;

2751 ià(!
hasCŞumns
()) {

2756 
R’d”Objeù
* 
	gc
 = 
fœ¡Chd
(); c; c = 
c
->
ÃxtSiblšg
()) {

2757 ià(!
c
->
isFlßtšgOrPos™iÚed
(è&& c->
isBox
()) {

2758 
R’d”Box
* 
chdBox
 = 
toR’d”Box
(
c
);

2759 
	gright
 = 
max
(
right
, 
chdBox
->
x
(è+ chdBox->
rightmo¡Pos™iÚ
(
çl£
));

2764 ià(
	gšşudeS–f
 && 
isR–Pos™iÚed
())

2765 
	gright
 +ğ
»ÏtivePos™iÚOff£tX
();

2767 ià(!
	gšşudeOv”æowIÁ”iÜ
 && 
hasOv”æowCl
())

2768  
	gright
;

2770 
	g»ÏtiveOff£t
 = 
šşudeS–f
 && 
isR–Pos™iÚed
(è? 
»ÏtivePos™iÚOff£tX
() : 0;

2772 ià(
	gšşudeS–f
)

2773 
	gright
 = 
max
(
right
, 
rightLayoutOv”æow
(è+ 
»ÏtiveOff£t
);

2775 ià(
	gm_pos™iÚedObjeùs
) {

2776 
R’d”Box
* 
	gr
;

2777 
I‹¿tÜ
 
	g’d
 = 
m_pos™iÚedObjeùs
->
’d
();

2778 
I‹¿tÜ
 
	g™
 = 
m_pos™iÚedObjeùs
->
begš
(è; iˆ!ğ
’d
; ++it) {

2779 
	gr
 = *
™
;

2782 ià(
	gr
->
¡yË
()->
pos™iÚ
(è!ğ
FixedPos™iÚ
) {

2786 ià(!
isR’d”V›w
(è|| 
r
->
y
(è+„->
height
(è> 0 ||„->y(è+„->
lowe¡Pos™iÚ
(
çl£
) > 0) {

2787 
½
 = 
r
->
x
(è+„->
rightmo¡Pos™iÚ
(
çl£
);

2788 
	gright
 = 
max
(
right
, 
½
 + 
»ÏtiveOff£t
);

2794 ià(
hasCŞumns
()) {

2796 ià(
¡yË
()->
dœeùiÚ
(è=ğ
LTR
)

2797 
right
 = 
max
(
cŞumnReùs
()->
Ï¡
().right(è+ 
»ÏtiveOff£t
,„ight);

2798  
	gright
;

2801 ià(
	gm_æßtšgObjeùs
) {

2802 
FlßtšgObjeù
* 
	gr
;

2803 
	gD•»ÿ‹dPŒLi¡I‹¿tÜ
<
	gFlßtšgObjeù
> 
™
(*
m_æßtšgObjeùs
);

2804  ; (
	gr
 = 
™
.
cu¼’t
()); ++
	g™
 ) {

2805 ià(
	gr
->
	gm_shouldPašt
 ||„->
	gm_»nd””
->
hasS–fPaštšgLay”
()) {

2806 
	g½
 = 
r
->
m_Ëá
 +„->
m_»nd””
->
m¬gšLeá
(è+„->m_»nd””->
rightmo¡Pos™iÚ
(
çl£
);

2807 
	gright
 = 
max
(
right
, 
½
 + 
»ÏtiveOff£t
);

2812 ià(!
	gšşudeS–f
) {

2813 
	gright
 = 
max
(
right
, 
bÜd”Leá
(è+ 
·ddšgLeá
(è+ 
·ddšgRight
(è+ 
»ÏtiveOff£t
);

2814 ià(
chd»nIÆše
()) {

2815 
IÆšeFlowBox
* 
	gcu¼Box
 = 
fœ¡LšeBox
(); cu¼Box; cu¼Box = 
cu¼Box
->
ÃxtLšeBox
()) {

2816 
chdRightEdge
 = 
cu¼Box
->
x
(è+ cu¼Box->
width
();

2820 ià(
node
(è&&‚ode()->
isCÚ‹ÁEd™abË
(è&&‚ode(è=ğnode()->
roÙEd™abËEËm’t
(è&& 
¡yË
()->
dœeùiÚ
(è=ğ
LTR
 && !
·ddšgRight
())

2821 
chdRightEdge
 += 1;

2822 
	gright
 = 
max
(
right
, 
chdRightEdge
 + 
·ddšgRight
(è+ 
»ÏtiveOff£t
);

2826 
R’d”Box
* 
	gcu¼Box
 = 
fœ¡ChdBox
(); cu¼Box; cu¼Box = 
cu¼Box
->
ÃxtSiblšgBox
()) {

2827 ià(
cu¼Box
->
isFlßtšgOrPos™iÚed
())

2829 
	gchdRightEdge
 = 
cu¼Box
->
x
(è+ cu¼Box->
width
(è+ cu¼Box->
m¬gšRight
();

2830 
	gright
 = 
max
(
right
, 
chdRightEdge
 + 
·ddšgRight
(è+ 
»ÏtiveOff£t
);

2835  
	gright
;

2838 
	gR’d”Block
::
Ëámo¡Pos™iÚ
(
boŞ
 
šşudeOv”æowIÁ”iÜ
, boŞ 
šşudeS–f
) const

2840 
	gËá
 = 
šşudeS–f
 && 
height
(è> 0 ? 0 : 
width
();

2842 ià(!
	gšşudeOv”æowIÁ”iÜ
 && (
hasOv”æowCl
(è|| 
hasCÚŒŞCl
()))

2843  
	gËá
;

2845 ià(!
fœ¡Chd
(è&& (!
width
(è|| !
height
()))

2846  
	gËá
;

2848 ià(!
hasCŞumns
()) {

2853 
R’d”Objeù
* 
	gc
 = 
fœ¡Chd
(); c; c = 
c
->
ÃxtSiblšg
()) {

2854 ià(!
c
->
isFlßtšgOrPos™iÚed
(è&& c->
isBox
()) {

2855 
R’d”Box
* 
chdBox
 = 
toR’d”Box
(
c
);

2856 
	gËá
 = 
mš
(
Ëá
, 
chdBox
->
x
(è+ chdBox->
Ëámo¡Pos™iÚ
(
çl£
));

2861 ià(
	gšşudeS–f
 && 
isR–Pos™iÚed
())

2862 
	gËá
 +ğ
»ÏtivePos™iÚOff£tX
();

2864 ià(!
	gšşudeOv”æowIÁ”iÜ
 && 
hasOv”æowCl
())

2865  
	gËá
;

2867 
	g»ÏtiveOff£t
 = 
šşudeS–f
 && 
isR–Pos™iÚed
(è? 
»ÏtivePos™iÚOff£tX
() : 0;

2869 ià(
	gšşudeS–f
)

2870 
	gËá
 = 
mš
(
Ëá
, 
ËáLayoutOv”æow
(è+ 
»ÏtiveOff£t
);

2872 ià(
	gm_pos™iÚedObjeùs
) {

2873 
R’d”Box
* 
	gr
;

2874 
I‹¿tÜ
 
	g’d
 = 
m_pos™iÚedObjeùs
->
’d
();

2875 
I‹¿tÜ
 
	g™
 = 
m_pos™iÚedObjeùs
->
begš
(); iˆ!ğ
’d
; ++it) {

2876 
	gr
 = *
™
;

2879 ià(
	gr
->
¡yË
()->
pos™iÚ
(è!ğ
FixedPos™iÚ
) {

2883 ià(!
isR’d”V›w
(è|| 
r
->
y
(è+„->
height
(è> 0 ||„->y(è+„->
lowe¡Pos™iÚ
(
çl£
) > 0) {

2884 
Í
 = 
r
->
x
(è+„->
Ëámo¡Pos™iÚ
(
çl£
);

2885 
	gËá
 = 
mš
(
Ëá
, 
Í
 + 
»ÏtiveOff£t
);

2891 ià(
hasCŞumns
()) {

2893 ià(
¡yË
()->
dœeùiÚ
(è=ğ
RTL
)

2894 
Ëá
 = 
mš
(
cŞumnReùs
()->
Ï¡
().
x
(è+ 
»ÏtiveOff£t
,†eft);

2895  
	gËá
;

2898 ià(
	gm_æßtšgObjeùs
) {

2899 
FlßtšgObjeù
* 
	gr
;

2900 
	gD•»ÿ‹dPŒLi¡I‹¿tÜ
<
	gFlßtšgObjeù
> 
™
(*
m_æßtšgObjeùs
);

2901  ; (
	gr
 = 
™
.
cu¼’t
()); ++
	g™
 ) {

2902 ià(
	gr
->
	gm_shouldPašt
 ||„->
	gm_»nd””
->
hasS–fPaštšgLay”
()) {

2903 
	gÍ
 = 
r
->
m_Ëá
 +„->
m_»nd””
->
m¬gšLeá
(è+„->m_»nd””->
Ëámo¡Pos™iÚ
(
çl£
);

2904 
	gËá
 = 
mš
(
Ëá
, 
Í
 + 
»ÏtiveOff£t
);

2909 ià(!
	gšşudeS–f
 && 
fœ¡LšeBox
()) {

2910 
IÆšeFlowBox
* 
	gcu¼Box
 = 
fœ¡LšeBox
(); cu¼Box; cu¼Box = 
cu¼Box
->
ÃxtLšeBox
())

2911 
Ëá
 = 
mš
Öeá, ()
cu¼Box
->
x
(è+ 
»ÏtiveOff£t
);

2914  
	gËá
;

2918 
	gR’d”Block
::
ËáBÙtom
()

2920 ià(!
m_æßtšgObjeùs
)  0;

2921 
	gbÙtom
 = 0;

2922 
FlßtšgObjeù
* 
	gr
;

2923 
	gD•»ÿ‹dPŒLi¡I‹¿tÜ
<
	gFlßtšgObjeù
> 
™
(*
m_æßtšgObjeùs
);

2924  ; (
	gr
 = 
™
.
cu¼’t
()); ++
	g™
 )

2925 ià(
	gr
->
	gm_bÙtom
 > 
	gbÙtom
 &&„->
ty³
(è=ğ
FlßtšgObjeù
::
FlßtLeá
)

2926 
bÙtom
 = 
r
->
m_bÙtom
;

2928  
	gbÙtom
;

2932 
	gR’d”Block
::
rightBÙtom
()

2934 ià(!
m_æßtšgObjeùs
)  0;

2935 
	gbÙtom
 = 0;

2936 
FlßtšgObjeù
* 
	gr
;

2937 
	gD•»ÿ‹dPŒLi¡I‹¿tÜ
<
	gFlßtšgObjeù
> 
™
(*
m_æßtšgObjeùs
);

2938  ; (
	gr
 = 
™
.
cu¼’t
()); ++
	g™
 )

2939 ià(
	gr
->
	gm_bÙtom
>
	gbÙtom
 &&„->
ty³
(è=ğ
FlßtšgObjeù
::
FlßtRight
)

2940 
bÙtom
 = 
r
->
m_bÙtom
;

2942  
	gbÙtom
;

2945 
	gR’d”Block
::
m¬kLšesDœtyInV”tiÿlRªge
(
tİ
, 
bÙtom
, 
RoÙIÆšeBox
* 
highe¡
)

2947 ià(
	gtİ
 >ğ
bÙtom
)

2950 
RoÙIÆšeBox
* 
	glowe¡DœtyLše
 = 
Ï¡RoÙBox
();

2951 
RoÙIÆšeBox
* 
	gaá”Lowe¡
 = 
lowe¡DœtyLše
;

2952 
	glowe¡DœtyLše
 &&†owe¡DœtyLše->
blockHeight
(è>ğ
bÙtom
) {

2953 
aá”Lowe¡
 = 
lowe¡DœtyLše
;

2954 
	glowe¡DœtyLše
 = 
lowe¡DœtyLše
->
´evRoÙBox
();

2957 
	gaá”Lowe¡
 &&‡á”Lowe¡ !ğ
highe¡
 && 
aá”Lowe¡
->
blockHeight
(è>ğ
tİ
) {

2958 
aá”Lowe¡
->
m¬kDœty
();

2959 
	gaá”Lowe¡
 = 
aá”Lowe¡
->
´evRoÙBox
();

2963 
	gR’d”Block
::
ş—rFlßts
()

2966 ià(
avoidsFlßts
(è|| 
isRoÙ
(è|| 
isR’d”V›w
(è|| 
isFlßtšgOrPos™iÚed
(è|| 
isTabËC–l
()) {

2967 ià(
m_æßtšgObjeùs
)

2968 
m_æßtšgObjeùs
->
ş—r
();

2972 
	gHashM­
<
	tR’d”Objeù
*, 
	tFlßtšgObjeù
*> 
	tR’d””ToFlßtInfoM­
;

2973 
R’d””ToFlßtInfoM­
 
	gæßtM­
;

2975 ià(
	gm_æßtšgObjeùs
) {

2976 ià(
chd»nIÆše
()) {

2977 
	gm_æßtšgObjeùs
->
fœ¡
();

2978 
FlßtšgObjeù
* 
	gf
 = 
m_æßtšgObjeùs
->
ke
())

2979 
æßtM­
.
add
(
f
->
m_»nd””
, f);

2981 
	gm_æßtšgObjeùs
->
ş—r
();

2987 
boŞ
 
	g·»ÁHasFlßts
 = 
çl£
;

2988 
R’d”Objeù
* 
	g´ev
 = 
´eviousSiblšg
();

2989 
	g´ev
 && (´ev->
isFlßtšgOrPos™iÚed
(è|| !´ev->
isBox
(è|| !´ev->
isR’d”Block
(è|| 
toR’d”Block
(
´ev
)->
avoidsFlßts
())) {

2990 ià(
	g´ev
->
isFlßtšg
())

2991 
	g·»ÁHasFlßts
 = 
Œue
;

2992 
	g´ev
 = 
´ev
->
´eviousSiblšg
();

2996 
	goff£t
 = 
y
();

2997 ià(
	g·»ÁHasFlßts
) {

2998 
R’d”Block
* 
	g·»ÁBlock
 = 
toR’d”Block
(
·»Á
());

2999 
addIÁrudšgFlßts
(
·»ÁBlock
,…¬’tBlock->
bÜd”Leá
(è+…¬’tBlock->
·ddšgLeá
(), 
off£t
);

3002 
	gxoff£t
 = 0;

3003 ià(
	g´ev
)

3004 
	goff£t
 -ğ
toR’d”Box
(
´ev
)->
y
();

3005 ià(
·»Á
()->
isBox
()) {

3006 
	g´ev
 = 
·»Á
();

3007 
	gxoff£t
 +ğ
toR’d”Box
(
´ev
)->
bÜd”Leá
(è+oR’d”BoxÕ»v)->
·ddšgLeá
();

3011 ià(!
	g´ev
 || !´ev->
isR’d”Block
())

3014 
R’d”Block
* 
	gblock
 = 
toR’d”Block
(
´ev
);

3015 ià(
	gblock
->
	gm_æßtšgObjeùs
 && block->
æßtBÙtom
(è> 
	goff£t
)

3016 
addIÁrudšgFlßts
(
block
, 
xoff£t
, 
off£t
);

3018 ià(
chd»nIÆše
()) {

3019 
	gchªgeTİ
 = 
num”ic_lim™s
<>::
max
();

3020 
	gchªgeBÙtom
 = 
num”ic_lim™s
<>::
mš
();

3021 ià(
	gm_æßtšgObjeùs
) {

3022 
FlßtšgObjeù
* 
	gf
 = 
m_æßtšgObjeùs
->
fœ¡
(); f; f = m_æßtšgObjeùs->
Ãxt
()) {

3023 
FlßtšgObjeù
* 
ŞdFlßtšgObjeù
 = 
æßtM­
.
g‘
(
f
->
m_»nd””
);

3024 ià(
	gŞdFlßtšgObjeù
) {

3025 ià(
	gf
->
	gm_width
 !ğ
ŞdFlßtšgObjeù
->
m_width
 || 
f
->
m_Ëá
 != oldFloatingObject->m_left) {

3026 
chªgeTİ
 = 0;

3027 
	gchªgeBÙtom
 = 
max
(
chªgeBÙtom
, max(
f
->
m_bÙtom
, 
ŞdFlßtšgObjeù
->m_bottom));

3028 } ià(
	gf
->
	gm_bÙtom
 !ğ
ŞdFlßtšgObjeù
->
m_bÙtom
) {

3029 
chªgeTİ
 = 
mš
(chªgeTİ, mš(
f
->
m_bÙtom
, 
ŞdFlßtšgObjeù
->m_bottom));

3030 
	gchªgeBÙtom
 = 
max
(
chªgeBÙtom
, max(
f
->
m_bÙtom
, 
ŞdFlßtšgObjeù
->m_bottom));

3033 
	gæßtM­
.
»move
(
f
->
m_»nd””
);

3034 
d–‘e
 
	gŞdFlßtšgObjeù
;

3036 
	gchªgeTİ
 = 0;

3037 
	gchªgeBÙtom
 = 
max
(
chªgeBÙtom
, 
f
->
m_bÙtom
);

3042 
	gR’d””ToFlßtInfoM­
::
™”©Ü
 
’d
 = 
æßtM­
.end();

3043 
	gR’d””ToFlßtInfoM­
::
™”©Ü
 
™
 = 
æßtM­
.
begš
(); 
	g™
 !ğ
’d
; ++it) {

3044 
FlßtšgObjeù
* 
	gæßtšgObjeù
 = (*
™
).
£cÚd
;

3045 ià(!
	gæßtšgObjeù
->
	gm_isDesûndªt
) {

3046 
	gchªgeTİ
 = 0;

3047 
	gchªgeBÙtom
 = 
max
(
chªgeBÙtom
, 
æßtšgObjeù
->
m_bÙtom
);

3050 
d–‘eAÎV®ues
(
æßtM­
);

3052 
m¬kLšesDœtyInV”tiÿlRªge
(
chªgeTİ
, 
chªgeBÙtom
);

3056 
	gR’d”Block
::
addOv”hªgšgFlßts
(
R’d”Block
* 
chd
, 
xoff
, 
yoff
, 
boŞ
 
makeChdPaštOth”Flßts
)

3059 ià(
	gchd
->
hasOv”æowCl
(è|| !chd->
cÚšsFlßts
(è|| chd->
isRoÙ
())

3062 
	glowe¡FlßtBÙtom
 = 0;

3066 
	gD•»ÿ‹dPŒLi¡I‹¿tÜ
<
	gFlßtšgObjeù
> 
™
(*
chd
->
m_æßtšgObjeùs
);

3067 
FlßtšgObjeù
* 
	gr
; (¸ğ
™
.
cu¼’t
()); ++
	g™
) {

3068 
	gbÙtom
 = 
chd
->
y
(è+ 
r
->
m_bÙtom
;

3069 
	glowe¡FlßtBÙtom
 = 
max
(
lowe¡FlßtBÙtom
, 
bÙtom
);

3071 ià(
	gbÙtom
 > 
height
()) {

3073 ià(!
cÚšsFlßt
(
r
->
m_»nd””
)) {

3074 
FlßtšgObjeù
 *
	gæßtšgObj
 = 
Ãw
 FlßtšgObjeù(
r
->
ty³
());

3075 
	gæßtšgObj
->
	gm_tİ
 = 
r
->
m_tİ
 - 
yoff
;

3076 
	gæßtšgObj
->
	gm_bÙtom
 = 
r
->
m_bÙtom
 - 
yoff
;

3077 
	gæßtšgObj
->
	gm_Ëá
 = 
r
->
m_Ëá
 - 
xoff
;

3078 
	gæßtšgObj
->
	gm_width
 = 
r
->
m_width
;

3079 
	gæßtšgObj
->
	gm_»nd””
 = 
r
->
m_»nd””
;

3085 ià(
	gr
->
	gm_»nd””
->
’şosšgS–fPaštšgLay”
() ==ƒnclosingSelfPaintingLayer())

3086 
r
->
m_shouldPašt
 = 
çl£
;

3088 
	gæßtšgObj
->
	gm_shouldPašt
 = 
çl£
;

3091 ià(!
	gm_æßtšgObjeùs
) {

3092 
	gm_æßtšgObjeùs
 = 
Ãw
 
D•»ÿ‹dPŒLi¡
<
FlßtšgObjeù
>;

3093 
	gm_æßtšgObjeùs
->
£tAutoD–‘e
(
Œue
);

3095 
	gm_æßtšgObjeùs
->
­³nd
(
æßtšgObj
);

3097 } ià(
	gmakeChdPaštOth”Flßts
 && !
	gr
->
	gm_shouldPašt
 && !r->
	gm_»nd””
->
hasS–fPaštšgLay”
() &&

3098 
	gr
->
	gm_»nd””
->
isDesûndªtOf
(
chd
è&&„->m_»nd””->
’şosšgLay”
() == child->enclosingLayer())

3104 
r
->
m_shouldPašt
 = 
Œue
;

3106 ià(
	gr
->
	gm_shouldPašt
 && !r->
	gm_»nd””
->
hasS–fPaštšgLay”
())

3107 
	gchd
->
addOv”æowFromChd
(
r
->
m_»nd””
, 
IÁSize
Ô->
m_Ëá
 +„->m_»nd””->
m¬gšLeá
(),„->
m_tİ
 +„->m_»nd””->
m¬gšTİ
()));

3109  
	glowe¡FlßtBÙtom
;

3112 
	gR’d”Block
::
addIÁrudšgFlßts
(
R’d”Block
* 
´ev
, 
xoff
, 
yoff
)

3115 ià(!
	g´ev
->
	gm_æßtšgObjeùs
)

3118 
	gD•»ÿ‹dPŒLi¡I‹¿tÜ
<
	gFlßtšgObjeù
> 
™
(*
´ev
->
m_æßtšgObjeùs
);

3119 
FlßtšgObjeù
 *
	gr
; (¸ğ
™
.
cu¼’t
()); ++
	g™
) {

3120 ià(
	gr
->
	gm_bÙtom
 > 
	gyoff
) {

3123 
FlßtšgObjeù
* 
	gf
 = 0;

3124 ià(
	gm_æßtšgObjeùs
) {

3125 
	gD•»ÿ‹dPŒLi¡I‹¿tÜ
<
	gFlßtšgObjeù
> 
™
(*
m_æßtšgObjeùs
);

3126 (
	gf
 = 
™
.
cu¼’t
())) {

3127 ià(
f
->
m_»nd””
 =ğ
r
->m_renderer) ;

3128 ++
	g™
;

3131 ià(!
	gf
) {

3132 
FlßtšgObjeù
 *
	gæßtšgObj
 = 
Ãw
 FlßtšgObjeù(
r
->
ty³
());

3133 
	gæßtšgObj
->
	gm_tİ
 = 
r
->
m_tİ
 - 
yoff
;

3134 
	gæßtšgObj
->
	gm_bÙtom
 = 
r
->
m_bÙtom
 - 
yoff
;

3135 
	gæßtšgObj
->
	gm_Ëá
 = 
r
->
m_Ëá
 - 
xoff
;

3141 ià(
	g´ev
 !ğ
·»Á
())

3142 
æßtšgObj
->
m_Ëá
 +ğ
´ev
->
m¬gšLeá
();

3143 
	gæßtšgObj
->
	gm_Ëá
 -ğ
m¬gšLeá
();

3144 
	gæßtšgObj
->
	gm_shouldPašt
 = 
çl£
;

3145 
	gæßtšgObj
->
	gm_width
 = 
r
->
m_width
;

3146 
	gæßtšgObj
->
	gm_»nd””
 = 
r
->
m_»nd””
;

3149 ià(!
	gm_æßtšgObjeùs
) {

3150 
	gm_æßtšgObjeùs
 = 
Ãw
 
D•»ÿ‹dPŒLi¡
<
FlßtšgObjeù
>;

3151 
	gm_æßtšgObjeùs
->
£tAutoD–‘e
(
Œue
);

3153 
	gm_æßtšgObjeùs
->
­³nd
(
æßtšgObj
);

3159 
boŞ
 
	gR’d”Block
::
avoidsFlßts
() const

3162  
R’d”Box
::
avoidsFlßts
(è|| !
¡yË
()->
hasAutoCŞumnCouÁ
(è|| !¡yË()->
hasAutoCŞumnWidth
();

3165 
boŞ
 
	gR’d”Block
::
cÚšsFlßt
(
R’d”Objeù
* 
o
)

3167 ià(
m_æßtšgObjeùs
) {

3168 
D•»ÿ‹dPŒLi¡I‹¿tÜ
<
FlßtšgObjeù
> 
™
(*
m_æßtšgObjeùs
);

3169 
	g™
.
cu¼’t
()) {

3170 ià(
	g™
.
cu¼’t
()->
	gm_»nd””
 =ğ
o
)

3171  
Œue
;

3172 ++
	g™
;

3175  
	gçl£
;

3178 
	gR’d”Block
::
m¬kAÎDesûndªtsW™hFlßtsFÜLayout
(
R’d”Box
* 
æßtToRemove
, 
boŞ
 
šLayout
)

3180 
£tChdN“dsLayout
(
Œue
, !
šLayout
);

3182 ià(
	gæßtToRemove
)

3183 
»moveFlßtšgObjeù
(
æßtToRemove
);

3186 ià(!
chd»nIÆše
()) {

3187 
R’d”Objeù
* 
	gchd
 = 
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
()) {

3188 ià((!
æßtToRemove
 && 
chd
->
isFlßtšgOrPos™iÚed
()è|| !chd->
isR’d”Block
())

3190 
R’d”Block
* 
	gchdBlock
 = 
toR’d”Block
(
chd
);

3191 ià((
	gæßtToRemove
 ? 
	gchdBlock
->
cÚšsFlßt
(
æßtToRemove
è: 
chdBlock
->
cÚšsFlßts
()è|| chdBlock->
shrškToAvoidFlßts
())

3192 
chdBlock
->
m¬kAÎDesûndªtsW™hFlßtsFÜLayout
(
æßtToRemove
, 
šLayout
);

3197 
	gR’d”Block
::
visibËTİOfHighe¡FlßtEx‹ndšgB–ow
(
bÙtom
, 
maxHeight
) const

3199 
	gtİ
 = 
bÙtom
;

3200 ià(
	gm_æßtšgObjeùs
) {

3201 
FlßtšgObjeù
* 
	gæßtšgObjeù
;

3202 
	gD•»ÿ‹dPŒLi¡I‹¿tÜ
<
	gFlßtšgObjeù
> 
™
(*
m_æßtšgObjeùs
); (
	gæßtšgObjeù
 = it.
cu¼’t
()); ++
	g™
) {

3203 
R’d”Box
* 
	gæßtšgBox
 = 
æßtšgObjeù
->
m_»nd””
;

3204 
IÁReù
 
	gvisibËOv”æow
 = 
æßtšgBox
->
visibËOv”æowReù
();

3205 
	gvisibËOv”æow
.
move
(
æßtšgBox
->
x
(), flßtšgBox->
y
());

3206 ià(
	gvisibËOv”æow
.
y
(è< 
	gtİ
 && visibËOv”æow.
bÙtom
(è> 
	gbÙtom
 && visibËOv”æow.
height
(è<ğ
maxHeight
 && 
æßtšgBox
->
cÚššgBlock
(è=ğ
this
)

3207 
tİ
 = 
visibËOv”æow
.
y
();

3211 ià(!
chd»nIÆše
()) {

3212 
R’d”Objeù
* 
	gchd
 = 
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
()) {

3213 ià(
chd
->
isFlßtšgOrPos™iÚed
(è|| !chd->
isR’d”Block
())

3215 
R’d”Block
* 
	gchdBlock
 = 
toR’d”Block
(
chd
);

3216 
	gtİ
 = 
mš
(
tİ
, 
chdBlock
->
y
(è+ chdBlock->
visibËTİOfHighe¡FlßtEx‹ndšgB–ow
(
bÙtom
 - chdBlock->y(), 
maxHeight
));

3220  
	gtİ
;

3223 
	gR’d”Block
::
g‘CË¬D–
(
R’d”Box
* 
chd
, 
yPos
)

3226 ià(!
cÚšsFlßts
())

3230 
boŞ
 
	gş—rS‘
 = 
chd
->
¡yË
()->
ş—r
(è!ğ
CNONE
;

3231 
	gbÙtom
 = 0;

3232 
	gchd
->
¡yË
()->
ş—r
()) {

3233 
	gCNONE
:

3235 
	gCLEFT
:

3236 
bÙtom
 = 
ËáBÙtom
();

3238 
	gCRIGHT
:

3239 
bÙtom
 = 
rightBÙtom
();

3241 
	gCBOTH
:

3242 
bÙtom
 = 
æßtBÙtom
();

3247 
	g»suÉ
 = 
ş—rS‘
 ? 
max
(0, 
bÙtom
 - 
yPos
) : 0;

3248 ià(!
	g»suÉ
 && 
	gchd
->
avoidsFlßts
()) {

3249 
	gavaabËWidth
 = 
this
->
avaabËWidth
();

3250 ià(
	gchd
->
mšP»fWidth
(è> 
	gavaabËWidth
)

3253 
	gy
 = 
yPos
;

3254 
	gŒue
) {

3255 
	gwidthAtY
 = 
lšeWidth
(
y
, 
çl£
);

3256 ià(
	gwidthAtY
 =ğ
avaabËWidth
)

3257  
y
 - 
yPos
;

3259 
	gŞdChdY
 = 
chd
->
y
();

3260 
	gŞdChdWidth
 = 
chd
->
width
();

3261 
	gchd
->
£tY
(
y
);

3262 
	gchd
->
ÿlcWidth
();

3263 
	gchdWidthAtY
 = 
chd
->
width
();

3264 
	gchd
->
£tY
(
ŞdChdY
);

3265 
	gchd
->
£tWidth
(
ŞdChdWidth
);

3267 ià(
	gchdWidthAtY
 <ğ
widthAtY
)

3268  
y
 - 
yPos
;

3270 
	gy
 = 
ÃxtFlßtBÙtomB–ow
(
y
);

3271 
ASSERT
(
y
 >ğ
yPos
);

3272 ià(
	gy
 < 
	gyPos
)

3275 
ASSERT_NOT_REACHED
();

3277  
	g»suÉ
;

3280 
boŞ
 
	gR’d”Block
::
isPoštInOv”æowCÚŒŞ
(
H™Te¡ResuÉ
& 
»suÉ
, 
_x
, 
_y
, 
_tx
, 
_ty
)

3282 ià(!
süŞlsOv”æow
())

3283  
	gçl£
;

3285  
Ïy”
()->
h™Te¡Ov”æowCÚŒŞs
(
»suÉ
, 
IÁPošt
(
_x
 - 
_tx
, 
_y
 - 
_ty
));

3288 
boŞ
 
	gR’d”Block
::
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
& 
»que¡
, 
H™Te¡ResuÉ
& 
»suÉ
, 
_x
, 
_y
, 
_tx
, 
_ty
, 
H™Te¡AùiÚ
 
h™Te¡AùiÚ
)

3290 
	gtx
 = 
_tx
 + 
x
();

3291 
	gty
 = 
_ty
 + 
y
();

3293 ià(!
isR’d”V›w
()) {

3295 
IÁReù
 
	gov”æowBox
 = 
visibËOv”æowReù
();

3296 
	gov”æowBox
.
move
(
tx
, 
ty
);

3297 ià(!
	gov”æowBox
.
cÚšs
(
_x
, 
_y
))

3298  
	gçl£
;

3301 ià((
	gh™Te¡AùiÚ
 =ğ
H™Te¡BlockBackground
 || 
h™Te¡AùiÚ
 =ğ
H™Te¡ChdBlockBackground
è&& 
isPoštInOv”æowCÚŒŞ
(
»suÉ
, 
_x
, 
_y
, 
tx
, 
ty
)) {

3302 
upd©eH™Te¡ResuÉ
(
»suÉ
, 
IÁPošt
(
_x
 - 
tx
, 
_y
 - 
ty
));

3303  
	gŒue
;

3307 
boŞ
 
	gu£Ov”æowCl
 = 
hasOv”æowCl
(è&& !
hasS–fPaštšgLay”
();

3308 
boŞ
 
	gu£Cl
 = (
hasCÚŒŞCl
(è|| 
u£Ov”æowCl
);

3309 
boŞ
 
	gcheckChd»n
 = !
u£Cl
 || (
hasCÚŒŞCl
(è? 
cÚŒŞClReù
(
tx
, 
ty
).
cÚšs
(
_x
, 
_y
è: 
ov”æowClReù
(tx,y).contains(_x, _y));

3310 ià(
	gcheckChd»n
) {

3312 
	gsüŞËdX
 = 
tx
;

3313 
	gsüŞËdY
 = 
ty
;

3314 ià(
hasOv”æowCl
()) {

3315 
IÁSize
 
	goff£t
 = 
Ïy”
()->
süŞËdCÚ‹ÁOff£t
();

3316 
	gsüŞËdX
 -ğ
off£t
.
width
();

3317 
	gsüŞËdY
 -ğ
off£t
.
height
();

3321 ià(!
hasCŞumns
(è&& 
h™Te¡CÚ‹Ás
(
»que¡
, 
»suÉ
, 
_x
, 
_y
, 
süŞËdX
, 
süŞËdY
, 
h™Te¡AùiÚ
))

3322  
	gŒue
;

3325 ià(
hasCŞumns
(è&& 
h™Te¡CŞumns
(
»que¡
, 
»suÉ
, 
_x
, 
_y
, 
süŞËdX
, 
süŞËdY
, 
h™Te¡AùiÚ
))

3326  
	gŒue
;

3329 ià(
	gh™Te¡AùiÚ
 =ğ
H™Te¡Flßt
 && 
m_æßtšgObjeùs
) {

3330 ià(
isR’d”V›w
()) {

3331 
süŞËdX
 +ğ
toR’d”V›w
(
this
)->
äameV›w
()->
süŞlX
();

3332 
	gsüŞËdY
 +ğ
toR’d”V›w
(
this
)->
äameV›w
()->
süŞlY
();

3335 
FlßtšgObjeù
* 
	go
;

3336 
	gD•»ÿ‹dPŒLi¡I‹¿tÜ
<
	gFlßtšgObjeù
> 
™
(*
m_æßtšgObjeùs
);

3337 
	g™
.
toLa¡
(); (
	go
 = 
™
.
cu¼’t
()); --it) {

3338 ià(
	go
->
	gm_shouldPašt
 && !o->
	gm_»nd””
->
hasS–fPaštšgLay”
()) {

3339 
	gxoff£t
 = 
süŞËdX
 + 
o
->
m_Ëá
 + o->
m_»nd””
->
m¬gšLeá
(è- o->m_»nd””->
x
();

3340 
	gyoff£t
 = 
süŞËdY
 + 
o
->
m_tİ
 + o->
m_»nd””
->
m¬gšTİ
(è- o->m_»nd””->
y
();

3341 ià(
	go
->
	gm_»nd””
->
h™Te¡
(
»que¡
, 
»suÉ
, 
IÁPošt
(
_x
, 
_y
), 
xoff£t
, 
yoff£t
)) {

3342 
upd©eH™Te¡ResuÉ
(
»suÉ
, 
IÁPošt
(
_x
 - 
xoff£t
, 
_y
 - 
yoff£t
));

3343  
	gŒue
;

3351 ià(
	gh™Te¡AùiÚ
 =ğ
H™Te¡BlockBackground
 || 
h™Te¡AùiÚ
 =ğ
H™Te¡ChdBlockBackground
) {

3352 
IÁReù
 
boundsReù
(
tx
, 
ty
, 
width
(), 
height
());

3353 ià(
visibËToH™Te¡šg
(è&& 
	gboundsReù
.
cÚšs
(
_x
, 
_y
)) {

3354 
upd©eH™Te¡ResuÉ
(
»suÉ
, 
IÁPošt
(
_x
 - 
tx
, 
_y
 - 
ty
));

3355  
	gŒue
;

3359  
	gçl£
;

3362 
boŞ
 
	gR’d”Block
::
h™Te¡CŞumns
(cÚ¡ 
H™Te¡Reque¡
& 
»que¡
, 
H™Te¡ResuÉ
& 
»suÉ
, 
x
, 
y
, 
tx
, 
ty
, 
H™Te¡AùiÚ
 
h™Te¡AùiÚ
)

3367 
	gcu¼XOff£t
 = 0;

3368 
	gcu¼YOff£t
 = 0;

3369 
	gcŞG­
 = 
cŞumnG­
();

3370 
	gVeùÜ
<
	gIÁReù
>* 
	gcŞReùs
 = 
cŞumnReùs
();

3371 
	gi
 = 0; i < 
	gcŞReùs
->
size
(); i++) {

3372 
IÁReù
 
	gcŞReù
 = 
cŞReùs
->
©
(
i
);

3373 
	gcŞReù
.
move
(
tx
, 
ty
);

3375 ià(
	gcŞReù
.
cÚšs
(
x
, 
y
)) {

3379 
	gfš®X
 = 
tx
 + 
cu¼XOff£t
;

3380 
	gfš®Y
 = 
ty
 + 
cu¼YOff£t
;

3381  
h™Te¡CÚ‹Ás
(
»que¡
, 
»suÉ
, 
x
, 
y
, 
fš®X
, 
fš®Y
, 
h™Te¡AùiÚ
);

3385 ià(
¡yË
()->
dœeùiÚ
(è=ğ
LTR
)

3386 
cu¼XOff£t
 +ğ
cŞReù
.
width
(è+ 
cŞG­
;

3388 
	gcu¼XOff£t
 -ğ(
cŞReù
.
width
(è+ 
cŞG­
);

3390 
	gcu¼YOff£t
 -ğ
cŞReù
.
height
();

3393  
	gçl£
;

3396 
boŞ
 
	gR’d”Block
::
h™Te¡CÚ‹Ás
(cÚ¡ 
H™Te¡Reque¡
& 
»que¡
, 
H™Te¡ResuÉ
& 
»suÉ
, 
x
, 
y
, 
tx
, 
ty
, 
H™Te¡AùiÚ
 
h™Te¡AùiÚ
)

3398 ià(
chd»nIÆše
(è&& !
isTabË
()) {

3400 ià(
	gm_lšeBoxes
.
h™Te¡
(
this
, 
»que¡
, 
»suÉ
, 
x
, 
y
, 
tx
, 
ty
, 
h™Te¡AùiÚ
)) {

3401 
upd©eH™Te¡ResuÉ
(
»suÉ
, 
IÁPošt
(
x
 - 
tx
, 
y
 - 
ty
));

3402  
	gŒue
;

3406 
H™Te¡AùiÚ
 
	gchdH™Te¡
 = 
h™Te¡AùiÚ
;

3407 ià(
	gh™Te¡AùiÚ
 =ğ
H™Te¡ChdBlockBackgrounds
)

3408 
chdH™Te¡
 = 
H™Te¡ChdBlockBackground
;

3409 
R’d”Box
* 
	gchd
 = 
Ï¡ChdBox
(); chd; chd = 
chd
->
´eviousSiblšgBox
()) {

3410 ià(!
chd
->
hasS–fPaštšgLay”
(è&& !chd->
isFlßtšg
(è&& chd->
nodeAtPošt
(
»que¡
, 
»suÉ
, 
x
, 
y
, 
tx
, 
ty
, 
chdH™Te¡
)) {

3411 
upd©eH™Te¡ResuÉ
(
»suÉ
, 
IÁPošt
(
x
 - 
tx
, 
y
 - 
ty
));

3412  
	gŒue
;

3417  
	gçl£
;

3420 
Pos™iÚ
 
	gR’d”Block
::
pos™iÚFÜBox
(
IÆšeBox
 *
box
, 
boŞ
 
¡¬t
) const

3422 ià(!
	gbox
)

3423  
Pos™iÚ
();

3425 ià(!
	gbox
->
»nd””
()->
node
())

3426  
Pos™iÚ
(
node
(), 
¡¬t
 ? 
ÿ»tMšOff£t
(è: 
ÿ»tMaxOff£t
());

3428 ià(!
	gbox
->
isIÆšeTextBox
())

3429  
Pos™iÚ
(
box
->
»nd””
()->
node
(), 
¡¬t
 ? box->»nd””()->
ÿ»tMšOff£t
(è: box->»nd””()->
ÿ»tMaxOff£t
());

3431 
IÆšeTextBox
 *
	g‹xtBox
 = 
¡©ic_ÿ¡
<IÆšeTextBox *>(
box
);

3432  
Pos™iÚ
(
box
->
»nd””
()->
node
(), 
¡¬t
 ? 
‹xtBox
->¡¬t(è:extBox->¡¬t(è+extBox->
Ën
());

3435 
Pos™iÚ
 
	gR’d”Block
::
pos™iÚFÜR’d””
(
R’d”Objeù
* 
»nd””
, 
boŞ
 
¡¬t
) const

3437 ià(!
	g»nd””
)

3438  
Pos™iÚ
(
node
(), 0);

3440 
Node
* 
	gn
 = 
»nd””
->
node
() ?„enderer->node() :‚ode();

3441 ià(!
	gn
)

3442  
Pos™iÚ
();

3444 
ASSERT
(
»nd””
 =ğ
n
->renderer());

3446 
	goff£t
 = 
¡¬t
 ? 
»nd””
->
ÿ»tMšOff£t
(è:„’d””->
ÿ»tMaxOff£t
();

3449 
ASSERT
(!
n
->
isCh¬aù”D©aNode
(è|| 
»nd””
->
isText
());

3451  
Pos™iÚ
(
n
, 
off£t
);

3457 
VisibËPos™iÚ
 
pos™iÚFÜPoštRe¥eùšgEd™šgBound¬›s
(
R’d”Box
* 
·»Á
, R’d”Box* 
chd
, cÚ¡ 
IÁPošt
& 
poštInP¬’tCoÜdš©es
)

3459 
IÁPošt
 
poštInChdCoÜdš©es
(
poštInP¬’tCoÜdš©es
 - 
chd
->
loÿtiÚ
());

3462 
Node
* 
	gchdNode
 = 
chd
->
node
();

3463 ià(!
	gchdNode
)

3464  
	gchd
->
pos™iÚFÜPošt
(
poštInChdCoÜdš©es
);

3468 
R’d”Objeù
* 
	gªû¡Ü
 = 
·»Á
;

3469 
	gªû¡Ü
 && !ªû¡Ü->
node
())

3470 
	gªû¡Ü
 = 
ªû¡Ü
->
·»Á
();

3473 ià(!
	gªû¡Ü
 ||‡nû¡Ü->
node
()->
isCÚ‹ÁEd™abË
(è=ğ
chdNode
->isContentEditable())

3474  
chd
->
pos™iÚFÜPošt
(
poštInChdCoÜdš©es
);

3477 
	gchdMidX
 = 
chd
->
width
() / 2;

3478 ià(
	gpoštInChdCoÜdš©es
.
x
(è< 
	gchdMidX
)

3479  
	gªû¡Ü
->
ü—‹VisibËPos™iÚ
(
chdNode
->
nodeIndex
(), 
DOWNSTREAM
);

3480  
	gªû¡Ü
->
ü—‹VisibËPos™iÚ
(
chdNode
->
nodeIndex
(è+ 1, 
UPSTREAM
);

3483 
VisibËPos™iÚ
 
	gR’d”Block
::
pos™iÚFÜPoštW™hIÆšeChd»n
(cÚ¡ 
IÁPošt
& 
poštInCÚ‹Ás
)

3485 
ASSERT
(
chd»nIÆše
());

3487 ià(!
fœ¡RoÙBox
())

3488  
ü—‹VisibËPos™iÚ
(0, 
DOWNSTREAM
);

3491 
IÆšeBox
* 
	gşo£¡Box
 = 0;

3492 
RoÙIÆšeBox
* 
	gfœ¡RoÙBoxW™hChd»n
 = 0;

3493 
RoÙIÆšeBox
* 
	gÏ¡RoÙBoxW™hChd»n
 = 0;

3494 
RoÙIÆšeBox
* 
	groÙ
 = 
fœ¡RoÙBox
();„oÙ;„oÙ = 
roÙ
->
ÃxtRoÙBox
()) {

3495 ià(!
roÙ
->
fœ¡L—fChd
())

3497 ià(!
	gfœ¡RoÙBoxW™hChd»n
)

3498 
	gfœ¡RoÙBoxW™hChd»n
 = 
roÙ
;

3499 
	gÏ¡RoÙBoxW™hChd»n
 = 
roÙ
;

3503 
	gbÙtom
;

3504 ià(
	groÙ
->
ÃxtRoÙBox
()) {

3507 
	gbÙtom
 = 
roÙ
->
ÃxtRoÙBox
()->
lšeTİ
();

3509 
	gbÙtom
 = 
roÙ
->
lšeBÙtom
(è+ 
v”tiÿlLšeClickFudgeFaùÜ
;

3512 ià(
	gpoštInCÚ‹Ás
.
y
(è< 
	gbÙtom
) {

3513 
	gşo£¡Box
 = 
roÙ
->
şo£¡L—fChdFÜXPos
(
poštInCÚ‹Ás
.
x
());

3514 ià(
	gşo£¡Box
)

3519 
S‘tšgs
* 
	g£‰šgs
 = 
docum’t
()->
£‰šgs
();

3520 
boŞ
 
	gu£WšdowsBehaviÜ
 = 
£‰šgs
 && s‘tšgs->
ed™šgBehaviÜ
(è=ğ
Ed™šgWšdowsBehaviÜ
;

3522 ià(
	gu£WšdowsBehaviÜ
 && !
	gşo£¡Box
 && 
	gÏ¡RoÙBoxW™hChd»n
) {

3524 
	gşo£¡Box
 = 
Ï¡RoÙBoxW™hChd»n
->
şo£¡L—fChdFÜXPos
(
poštInCÚ‹Ás
.
x
());

3527 ià(
	gşo£¡Box
) {

3528 ià(!
	gu£WšdowsBehaviÜ
 && 
	gpoštInCÚ‹Ás
.
y
(è< 
	gfœ¡RoÙBoxW™hChd»n
->
lšeTİ
(è- 
	gv”tiÿlLšeClickFudgeFaùÜ
) {

3530  
VisibËPos™iÚ
(
pos™iÚFÜBox
(
fœ¡RoÙBoxW™hChd»n
->
fœ¡L—fChd
(), 
Œue
), 
DOWNSTREAM
);

3534  
	gşo£¡Box
->
»nd””
()->
pos™iÚFÜPošt
(
IÁPošt
(
poštInCÚ‹Ás
.
x
(), 
şo£¡Box
->
m_y
));

3537 ià(
	gÏ¡RoÙBoxW™hChd»n
) {

3539 
ASSERT
(!
u£WšdowsBehaviÜ
);

3540  
VisibËPos™iÚ
(
pos™iÚFÜBox
(
Ï¡RoÙBoxW™hChd»n
->
Ï¡L—fChd
(), 
çl£
), 
DOWNSTREAM
);

3546  
ü—‹VisibËPos™iÚ
(0, 
DOWNSTREAM
);

3549 
šlše
 
boŞ
 
isChdH™Te¡Cªdid©e
(
R’d”Box
* 
box
)

3551  
	gbox
->
height
(è&& box->
¡yË
()->
visib™y
(è=ğ
VISIBLE
 && !
box
->
isFlßtšgOrPos™iÚed
();

3554 
VisibËPos™iÚ
 
	gR’d”Block
::
pos™iÚFÜPošt
(cÚ¡ 
IÁPošt
& 
pošt
)

3556 ià(
isTabË
())

3557  
R’d”Box
::
pos™iÚFÜPošt
(
pošt
);

3559 ià(
isR•Ïûd
()) {

3560 ià(
	gpošt
.
y
(è< 0 || (pošt.y(è< 
height
(è&&…ošt.
x
() < 0))

3561  
ü—‹VisibËPos™iÚ
(
ÿ»tMšOff£t
(), 
DOWNSTREAM
);

3562 ià(
	gpošt
.
y
(è>ğ
height
(è|| (
pošt
.y(è>ğ0 &&…ošt.
x
(è>ğ
width
()))

3563  
ü—‹VisibËPos™iÚ
(
ÿ»tMaxOff£t
(), 
DOWNSTREAM
);

3566 
	gcÚ‹ÁsX
 = 
pošt
.
x
();

3567 
	gcÚ‹ÁsY
 = 
pošt
.
y
();

3568 
off£tFÜCÚ‹Ás
(
cÚ‹ÁsX
, 
cÚ‹ÁsY
);

3569 
IÁPošt
 
poštInCÚ‹Ás
(
cÚ‹ÁsX
, 
cÚ‹ÁsY
);

3571 ià(
chd»nIÆše
())

3572  
pos™iÚFÜPoštW™hIÆšeChd»n
(
poštInCÚ‹Ás
);

3574 ià(
Ï¡ChdBox
(è&& 
	gcÚ‹ÁsY
 >†a¡ChdBox()->
y
()) {

3575 
R’d”Box
* 
	gchdBox
 = 
Ï¡ChdBox
(); chdBox; chdBox = 
chdBox
->
´eviousSiblšgBox
()) {

3576 ià(
isChdH™Te¡Cªdid©e
(
chdBox
))

3577  
pos™iÚFÜPoštRe¥eùšgEd™šgBound¬›s
(
this
, 
chdBox
, 
poštInCÚ‹Ás
);

3580 
R’d”Box
* 
	gchdBox
 = 
fœ¡ChdBox
(); chdBox; chdBox = 
chdBox
->
ÃxtSiblšgBox
()) {

3582 ià(
isChdH™Te¡Cªdid©e
(
chdBox
è&& 
cÚ‹ÁsY
 < chdBox->
äameReù
().
bÙtom
())

3583  
pos™iÚFÜPoštRe¥eùšgEd™šgBound¬›s
(
this
, 
chdBox
, 
poštInCÚ‹Ás
);

3588  
	gR’d”Box
::
pos™iÚFÜPošt
(
pošt
);

3591 
	gR’d”Block
::
off£tFÜCÚ‹Ás
(& 
tx
, & 
ty
) const

3593 
IÁPošt
 
cÚ‹ÁsPošt
(
tx
, 
ty
);

3595 ià(
hasOv”æowCl
())

3596 
	gcÚ‹ÁsPošt
 +ğ
Ïy”
()->
süŞËdCÚ‹ÁOff£t
();

3598 ià(
hasCŞumns
())

3599 
adju¡PoštToCŞumnCÚ‹Ás
(
cÚ‹ÁsPošt
);

3601 
	gtx
 = 
cÚ‹ÁsPošt
.
x
();

3602 
	gty
 = 
cÚ‹ÁsPošt
.
y
();

3605 
	gR’d”Block
::
avaabËWidth
() const

3608 ià(
hasCŞumns
())

3609  
desœedCŞumnWidth
();

3610  
cÚ‹ÁWidth
();

3613 
	gR’d”Block
::
cŞumnG­
() const

3615 ià(
¡yË
()->
hasNÜm®CŞumnG­
())

3616  
¡yË
()->
fÚtDesütiÚ
().
compu‹dPix–Size
();

3617  
	g¡©ic_ÿ¡
<>(
¡yË
()->
cŞumnG­
());

3620 
	gR’d”Block
::
ÿlcCŞumnWidth
()

3623 
desœedCŞumnCouÁ
 = 1;

3624 
	gdesœedCŞumnWidth
 = 
cÚ‹ÁWidth
();

3627 ià(
docum’t
()->
´štšg
(è|| (
¡yË
()->
hasAutoCŞumnCouÁ
(è&& styË()->
hasAutoCŞumnWidth
())) {

3628 
£tDesœedCŞumnCouÁAndWidth
(
desœedCŞumnCouÁ
, 
desœedCŞumnWidth
);

3632 
	gavaWidth
 = 
desœedCŞumnWidth
;

3633 
	gcŞG­
 = 
cŞumnG­
();

3634 
	gcŞWidth
 = 
max
(1, 
¡©ic_ÿ¡
<>(
¡yË
()->
cŞumnWidth
()));

3635 
	gcŞCouÁ
 = 
max
(1, 
¡©ic_ÿ¡
<>(
¡yË
()->
cŞumnCouÁ
()));

3637 ià(
¡yË
()->
hasAutoCŞumnWidth
()) {

3638 ià((
	gcŞCouÁ
 - 1è* 
	gcŞG­
 < 
	gavaWidth
) {

3639 
	gdesœedCŞumnCouÁ
 = 
cŞCouÁ
;

3640 
	gdesœedCŞumnWidth
 = (
avaWidth
 - (
desœedCŞumnCouÁ
 - 1è* 
cŞG­
) / desiredColumnCount;

3641 } ià(
	gcŞG­
 < 
	gavaWidth
) {

3642 
	gdesœedCŞumnCouÁ
 = 
avaWidth
 / 
cŞG­
;

3643 ià(
	gdesœedCŞumnCouÁ
 < 1)

3644 
	gdesœedCŞumnCouÁ
 = 1;

3645 
	gdesœedCŞumnWidth
 = (
avaWidth
 - (
desœedCŞumnCouÁ
 - 1è* 
cŞG­
) / desiredColumnCount;

3647 } ià(
¡yË
()->
hasAutoCŞumnCouÁ
()) {

3648 ià(
	gcŞWidth
 < 
	gavaWidth
) {

3649 
	gdesœedCŞumnCouÁ
 = (
avaWidth
 + 
cŞG­
è/ (
cŞWidth
 + colGap);

3650 ià(
	gdesœedCŞumnCouÁ
 < 1)

3651 
	gdesœedCŞumnCouÁ
 = 1;

3652 
	gdesœedCŞumnWidth
 = (
avaWidth
 - (
desœedCŞumnCouÁ
 - 1è* 
cŞG­
) / desiredColumnCount;

3656 ià(
cŞCouÁ
 * 
	gcŞWidth
 + (
	gcŞCouÁ
 - 1è* 
	gcŞG­
 <ğ
avaWidth
) {

3657 
desœedCŞumnCouÁ
 = 
cŞCouÁ
;

3658 
	gdesœedCŞumnWidth
 = 
cŞWidth
;

3659 } ià(
	gcŞWidth
 < 
	gavaWidth
) {

3660 
	gdesœedCŞumnCouÁ
 = (
avaWidth
 + 
cŞG­
è/ (
cŞWidth
 + colGap);

3661 ià(
	gdesœedCŞumnCouÁ
 < 1)

3662 
	gdesœedCŞumnCouÁ
 = 1;

3663 
	gdesœedCŞumnWidth
 = (
avaWidth
 - (
desœedCŞumnCouÁ
 - 1è* 
cŞG­
) / desiredColumnCount;

3666 
£tDesœedCŞumnCouÁAndWidth
(
desœedCŞumnCouÁ
, 
desœedCŞumnWidth
);

3669 
	gR’d”Block
::
£tDesœedCŞumnCouÁAndWidth
(
couÁ
, 
width
)

3671 ià(
	gcouÁ
 =ğ1 && 
¡yË
()->
hasAutoCŞumnWidth
()) {

3672 ià(
hasCŞumns
()) {

3673 
d–‘e
 
gCŞumnInfoM­
->
ke
(
this
);

3674 
£tHasCŞumns
(
çl£
);

3677 
CŞumnInfo
* 
	gšfo
;

3678 ià(
hasCŞumns
())

3679 
	gšfo
 = 
gCŞumnInfoM­
->
g‘
(
this
);

3681 ià(!
	ggCŞumnInfoM­
)

3682 
	ggCŞumnInfoM­
 = 
Ãw
 
CŞumnInfoM­
;

3683 
	gšfo
 = 
Ãw
 
CŞumnInfo
;

3684 
	ggCŞumnInfoM­
->
add
(
this
, 
šfo
);

3685 
£tHasCŞumns
(
Œue
);

3687 
	gšfo
->
	gm_desœedCŞumnCouÁ
 = 
couÁ
;

3688 
	gšfo
->
	gm_desœedCŞumnWidth
 = 
width
;

3692 
	gR’d”Block
::
desœedCŞumnWidth
() const

3694 ià(!
hasCŞumns
())

3695  
cÚ‹ÁWidth
();

3696  
	ggCŞumnInfoM­
->
g‘
(
this
)->
	gm_desœedCŞumnWidth
;

3699 
	gR’d”Block
::
desœedCŞumnCouÁ
() const

3701 ià(!
hasCŞumns
())

3703  
	ggCŞumnInfoM­
->
g‘
(
this
)->
	gm_desœedCŞumnCouÁ
;

3706 
	gVeùÜ
<
	gIÁReù
>* 
	gR’d”Block
::
cŞumnReùs
() const

3708 ià(!
hasCŞumns
())

3710  &
	ggCŞumnInfoM­
->
g‘
(
this
)->
	gm_cŞumnReùs
;

3713 
	gR’d”Block
::
ÏyoutCŞumns
(
’dOfCÚ‹Á
, 
»que¡edCŞumnHeight
)

3716 ià(!
hasCŞumns
())

3719 
CŞumnInfo
* 
	gšfo
 = 
gCŞumnInfoM­
->
g‘
(
this
);

3720 
	gdesœedCŞumnWidth
 = 
šfo
->
m_desœedCŞumnWidth
;

3721 
	gdesœedCŞumnCouÁ
 = 
šfo
->
m_desœedCŞumnCouÁ
;

3722 
	gVeùÜ
<
	gIÁReù
>* 
	gcŞumnReùs
 = &
šfo
->
m_cŞumnReùs
;

3724 
boŞ
 
	gcompu‹IÁršsicHeight
 = (
’dOfCÚ‹Á
 == -1);

3728 
	gcŞumnSlİ
 = 
lšeHeight
(
çl£
) / 2;

3729 
	g»maššgSlİS·û
 = 
cŞumnSlİ
 * 
desœedCŞumnCouÁ
;

3730 
	gavaabËHeight
 = 
cÚ‹ÁHeight
();

3731 
	gcŞHeight
;

3732 ià(
	gcompu‹IÁršsicHeight
 && 
	g»que¡edCŞumnHeight
 >= 0)

3733 
cŞHeight
 = 
»que¡edCŞumnHeight
;

3734 ià(
	gcompu‹IÁršsicHeight
)

3735 
	gcŞHeight
 = 
avaabËHeight
 / 
desœedCŞumnCouÁ
 + 
cŞumnSlİ
;

3737 
	gcŞHeight
 = 
avaabËHeight
;

3738 
	gÜigš®CŞHeight
 = 
cŞHeight
;

3740 
	gcŞG­
 = 
cŞumnG­
();

3743 
	gcŞumnReùs
->
ş—r
();

3748 
R’d”V›w
* 
	gv
 = 
v›w
();

3749 
	gËá
 = 
bÜd”Leá
(è+ 
·ddšgLeá
();

3750 
	gtİ
 = 
bÜd”Tİ
(è+ 
·ddšgTİ
();

3751 
	gcu¼X
 = 
¡yË
()->
dœeùiÚ
(è=ğ
LTR
 ? 
bÜd”Leá
(è+ 
·ddšgLeá
(è: bÜd”Leá(è+…addšgLeá(è+ 
cÚ‹ÁWidth
(è- 
desœedCŞumnWidth
;

3752 
	gcu¼Y
 = 
tİ
;

3753 
	gcŞCouÁ
 = 
desœedCŞumnCouÁ
;

3754 
	gmaxCŞBÙtom
 = 
bÜd”Tİ
(è+ 
·ddšgTİ
();

3755 
	gcÚ‹ÁBÙtom
 = 
tİ
 + 
avaabËHeight
;

3756 
	gmšimumCŞumnHeight
 = -1;

3757 
	gi
 = 0; i < 
	gcŞCouÁ
; i++) {

3759 ià(
	gcompu‹IÁršsicHeight
 && 
	gi
 =ğ
cŞCouÁ
 - 1)

3760 
cŞHeight
 = 
avaabËHeight
;

3763 
IÁReù
 
cŞReù
(
cu¼X
, 
tİ
, 
desœedCŞumnWidth
, 
cŞHeight
);

3765 
	gŒunÿtiÚPošt
 = 
visibËTİOfHighe¡FlßtEx‹ndšgB–ow
(
cu¼Y
 + 
cŞHeight
, colHeight);

3768 
IÁReù
 
·geReù
(
Ëá
, 
cu¼Y
, 
desœedCŞumnWidth
, 
ŒunÿtiÚPošt
 - currY);

3769 
	gv
->
£tPrštReù
(
·geReù
);

3770 
	gv
->
£tTrunÿ‹dAt
(
ŒunÿtiÚPošt
);

3771 
G¿phicsCÚ‹xt
 
cÚ‹xt
((
PÏtfÜmG¿phicsCÚ‹xt
*)0);

3772 
	gR’d”Objeù
::
PaštInfo
 
·štInfo
(&
cÚ‹xt
, 
·geReù
, 
PaštPha£FÜeground
, 
çl£
, 0, 0);

3774 
£tHasCŞumns
(
çl£
);

3775 
·štObjeù
(
·štInfo
, 0, 0);

3776 
£tHasCŞumns
(
Œue
);

3778 ià(
	gcompu‹IÁršsicHeight
 && 
	gv
->
mšimumCŞumnHeight
(è> 
	gÜigš®CŞHeight
) {

3780 
	gmšimumCŞumnHeight
 = 
max
(
mšimumCŞumnHeight
, 
v
->minimumColumnHeight());

3783 
	gadju¡edBÙtom
 = 
v
->
be¡Trunÿ‹dAt
();

3784 ià(
	gadju¡edBÙtom
 <ğ
cu¼Y
)

3785 
adju¡edBÙtom
 = 
ŒunÿtiÚPošt
;

3787 
	gcŞReù
.
£tHeight
(
adju¡edBÙtom
 - 
cu¼Y
);

3791 ià(
	gcompu‹IÁršsicHeight
) {

3792 
	glo¡S·û
 = 
cŞHeight
 - 
cŞReù
.
height
();

3793 ià(
	glo¡S·û
 > 
	g»maššgSlİS·û
) {

3795 
	g¥aûToRedi¡ribu‹
 = 
lo¡S·û
 - 
»maššgSlİS·û
;

3796 
	g»maššgCŞumns
 = 
cŞCouÁ
 - 
i
 + 1;

3797 
	gcŞHeight
 +ğ
¥aûToRedi¡ribu‹
 / 
»maššgCŞumns
;

3799 
	g»maššgSlİS·û
 = 
max
(0, 
»maššgSlİS·û
 - 
lo¡S·û
);

3802 ià(
¡yË
()->
dœeùiÚ
(è=ğ
LTR
)

3803 
cu¼X
 +ğ
desœedCŞumnWidth
 + 
cŞG­
;

3805 
	gcu¼X
 -ğ(
desœedCŞumnWidth
 + 
cŞG­
);

3807 
	gcu¼Y
 +ğ
cŞReù
.
height
();

3808 
	gavaabËHeight
 -ğ
cŞReù
.
height
();

3810 
	gmaxCŞBÙtom
 = 
max
(
cŞReù
.
bÙtom
(), 
maxCŞBÙtom
);

3812 
	gcŞumnReùs
->
­³nd
(
cŞReù
);

3815 ià(
	gcu¼Y
 < 
	g’dOfCÚ‹Á
 && 
	gi
 =ğ
cŞCouÁ
 - 1 && (
compu‹IÁršsicHeight
 || 
cÚ‹ÁHeight
()))

3816 
cŞCouÁ
++;

3819 ià(
	gmšimumCŞumnHeight
 >= 0) {

3821  
ÏyoutCŞumns
(
’dOfCÚ‹Á
, 
mšimumCŞumnHeight
);

3824 
	gov”æowRight
 = 
max
(
width
(), 
cu¼X
 - 
cŞG­
);

3825 
	gov”æowLeá
 = 
mš
(0, 
cu¼X
 + 
desœedCŞumnWidth
 + 
cŞG­
);

3826 
	gov”æowHeight
 = 
maxCŞBÙtom
;

3827 
	gtoAdd
 = 
bÜd”BÙtom
(è+ 
·ddšgBÙtom
(è+ 
hÜizÚlSüŞlb¬Height
();

3829 ià(
	gcompu‹IÁršsicHeight
)

3830 
£tHeight
(
maxCŞBÙtom
 + 
toAdd
);

3832 
	gm_ov”æow
.
ş—r
();

3833 
addLayoutOv”æow
(
IÁReù
(
ov”æowLeá
, 0, 
ov”æowRight
 - ov”æowLeá, 
ov”æowHeight
));

3835 
	gv
->
£tPrštReù
(
IÁReù
());

3836 
	gv
->
£tTrunÿ‹dAt
(0);

3838 
ASSERT
(
cŞCouÁ
 =ğ
cŞumnReùs
->
size
());

3840  
	gcÚ‹ÁBÙtom
;

3843 
	gR’d”Block
::
adju¡PoštToCŞumnCÚ‹Ás
(
IÁPošt
& 
pošt
) const

3846 ià(!
hasCŞumns
())

3849 
	gVeùÜ
<
	gIÁReù
>* 
	gcŞReùs
 = 
cŞumnReùs
();

3852 
	gcŞG­
 = 
cŞumnG­
();

3853 
	gËáG­
 = 
cŞG­
 / 2;

3854 
IÁPošt
 
cŞumnPošt
(
cŞReùs
->
©
(0).
loÿtiÚ
());

3855 
	gyOff£t
 = 0;

3856 
	gi
 = 0; i < 
	gcŞReùs
->
size
(); i++) {

3858 
IÁReù
 
	gcŞReù
 = 
cŞReùs
->
©
(
i
);

3859 
IÁReù
 
g­AndCŞumnReù
(
cŞReù
.
x
(è- 
ËáG­
, cŞReù.
y
(), cŞReù.
width
(è+ 
cŞG­
, cŞReù.
height
());

3861 ià(
	gpošt
.
x
(è>ğ
g­AndCŞumnReù
.x(è&& 
pošt
.x(è< g­AndCŞumnReù.
right
()) {

3865 ià(
pošt
.
y
(è< 
g­AndCŞumnReù
.y())

3866 
pošt
 = 
g­AndCŞumnReù
.
loÿtiÚ
();

3869 ià(
	gpošt
.
y
(è>ğ
g­AndCŞumnReù
.
bÙtom
()) {

3870 
pošt
 = 
g­AndCŞumnReù
.
loÿtiÚ
();

3871 
	gpošt
.
move
(0, 
g­AndCŞumnReù
.
height
());

3875 
	gpošt
.
move
(
cŞumnPošt
.
x
(è- 
cŞReù
.x(), 
yOff£t
);

3880 
	gyOff£t
 +ğ
cŞReù
.
height
();

3884 
	gR’d”Block
::
adju¡ReùFÜCŞumns
(
IÁReù
& 
r
) const

3887 ià(!
hasCŞumns
())

3890 
	gVeùÜ
<
	gIÁReù
>* 
	gcŞReùs
 = 
cŞumnReùs
();

3893 
IÁReù
 
	g»suÉ
;

3896 
	gcu¼XOff£t
 = 0;

3897 
	gcu¼YOff£t
 = 0;

3898 
	gcŞG­
 = 
cŞumnG­
();

3899 
	gi
 = 0; i < 
	gcŞReùs
->
size
(); i++) {

3900 
IÁReù
 
	gcŞReù
 = 
cŞReùs
->
©
(
i
);

3902 
IÁReù
 
	g»·štReù
 = 
r
;

3903 
	g»·štReù
.
move
(
cu¼XOff£t
, 
cu¼YOff£t
);

3905 
	g»·štReù
.
š‹r£ù
(
cŞReù
);

3907 
	g»suÉ
.
un™e
(
»·štReù
);

3910 ià(
¡yË
()->
dœeùiÚ
(è=ğ
LTR
)

3911 
cu¼XOff£t
 +ğ
cŞReù
.
width
(è+ 
cŞG­
;

3913 
	gcu¼XOff£t
 -ğ(
cŞReù
.
width
(è+ 
cŞG­
);

3915 
	gcu¼YOff£t
 -ğ
cŞReù
.
height
();

3918 
	gr
 = 
»suÉ
;

3921 
	gR’d”Block
::
adju¡FÜCŞumns
(
IÁSize
& 
off£t
, cÚ¡ 
IÁPošt
& 
pošt
) const

3923 ià(!
hasCŞumns
())

3928 
	gVeùÜ
<
	gIÁReù
>& 
	gcŞumnReùs
 = *
this
->
cŞumnReùs
();

3930 
	gg­Width
 = 
cŞumnG­
();

3931 
	gxOff£t
 = 0;

3932 
	gyOff£t
 = 0;

3933 
size_t
 
	gcŞumnCouÁ
 = 
cŞumnReùs
.
size
();

3934 
size_t
 
	gi
 = 0; i < 
	gcŞumnCouÁ
; ++i) {

3935 
IÁReù
 
	gcŞumnReù
 = 
cŞumnReùs
[
i
];

3936 ià(
	gpošt
.
y
(è< 
	gcŞumnReù
.
bÙtom
(è+ 
	gyOff£t
) {

3937 
	goff£t
.
ex·nd
(
xOff£t
, -
yOff£t
);

3941 
	gxOff£t
 +ğ
cŞumnReù
.
width
(è+ 
g­Width
;

3942 
	gyOff£t
 +ğ
cŞumnReù
.
height
();

3946 
	gR’d”Block
::
ÿlcP»fWidths
()

3948 
ASSERT
(
´efWidthsDœty
());

3950 
upd©eFœ¡L‘‹r
();

3952 ià(!
isTabËC–l
(è&& 
¡yË
()->
width
().
isFixed
(è&& styË()->width().
v®ue
() > 0)

3953 
	gm_mšP»fWidth
 = 
m_maxP»fWidth
 = 
ÿlcCÚ‹ÁBoxWidth
(
¡yË
()->
width
().
v®ue
());

3955 
	gm_mšP»fWidth
 = 0;

3956 
	gm_maxP»fWidth
 = 0;

3958 ià(
chd»nIÆše
())

3959 
ÿlcIÆšeP»fWidths
();

3961 
ÿlcBlockP»fWidths
();

3963 
	gm_maxP»fWidth
 = 
max
(
m_mšP»fWidth
, 
m_maxP»fWidth
);

3965 ià(!
¡yË
()->
autoW¿p
(è&& 
chd»nIÆše
()) {

3966 
	gm_mšP»fWidth
 = 
m_maxP»fWidth
;

3969 ià(
Ïy”
(è&&†ay”()->
m¬qu“
(è&&†ay”()->m¬qu“()->
isHÜizÚl
())

3970 
	gm_mšP»fWidth
 = 0;

3973 ià(
isTabËC–l
()) {

3974 
L’gth
 
	gw
 = 
toR’d”TabËC–l
(
this
)->
¡yËOrCŞWidth
();

3975 ià(
	gw
.
isFixed
(è&& w.
v®ue
() > 0)

3976 
	gm_maxP»fWidth
 = 
max
(
m_mšP»fWidth
, 
ÿlcCÚ‹ÁBoxWidth
(
w
.
v®ue
()));

3980 ià(
¡yË
()->
mšWidth
().
isFixed
(è&& styË()->mšWidth().
v®ue
() > 0) {

3981 
	gm_maxP»fWidth
 = 
max
(
m_maxP»fWidth
, 
ÿlcCÚ‹ÁBoxWidth
(
¡yË
()->
mšWidth
().
v®ue
()));

3982 
	gm_mšP»fWidth
 = 
max
(
m_mšP»fWidth
, 
ÿlcCÚ‹ÁBoxWidth
(
¡yË
()->
mšWidth
().
v®ue
()));

3985 ià(
¡yË
()->
maxWidth
().
isFixed
(è&& styË()->maxWidth().
v®ue
(è!ğ
undefšedL’gth
) {

3986 
m_maxP»fWidth
 = 
mš
(m_maxP»fWidth, 
ÿlcCÚ‹ÁBoxWidth
(
¡yË
()->
maxWidth
().
v®ue
()));

3987 
	gm_mšP»fWidth
 = 
mš
(
m_mšP»fWidth
, 
ÿlcCÚ‹ÁBoxWidth
(
¡yË
()->
maxWidth
().
v®ue
()));

3990 
	gtoAdd
 = 0;

3991 
	gtoAdd
 = 
bÜd”Leá
(è+ 
bÜd”Right
(è+ 
·ddšgLeá
(è+ 
·ddšgRight
();

3993 ià(
hasOv”æowCl
(è&& 
¡yË
()->
ov”æowY
(è=ğ
OSCROLL
)

3994 
toAdd
 +ğ
v”tiÿlSüŞlb¬Width
();

3996 
	gm_mšP»fWidth
 +ğ
toAdd
;

3997 
	gm_maxP»fWidth
 +ğ
toAdd
;

3999 
£tP»fWidthsDœty
(
çl£
);

4002 
	sIÆšeMšMaxI‹¿tÜ
 {

4011 
R’d”Objeù
* 
	g·»Á
;

4012 
R’d”Objeù
* 
	gcu¼’t
;

4013 
boŞ
 
	g’dOfIÆše
;

4015 
IÆšeMšMaxI‹¿tÜ
(
R’d”Objeù
* 
p
, 
boŞ
 
’d
 = 
çl£
)

4016 :
·»Á
(
p
), 
cu¼’t
Õ), 
’dOfIÆše
(
’d
) {}

4018 
R’d”Objeù
* 
Ãxt
();

4021 
R’d”Objeù
* 
	gIÆšeMšMaxI‹¿tÜ
::
Ãxt
()

4023 
R’d”Objeù
* 
»suÉ
 = 0;

4024 
boŞ
 
	gŞdEndOfIÆše
 = 
’dOfIÆše
;

4025 
	g’dOfIÆše
 = 
çl£
;

4026 
	gcu¼’t
 || cu¼’ˆ=ğ
·»Á
) {

4027 ià(!
ŞdEndOfIÆše
 &&

4028 (
cu¼’t
 =ğ
·»Á
 ||

4029 (!
cu¼’t
->
isFlßtšg
(è&& !cu¼’t->
isR•Ïûd
(è&& !cu¼’t->
isPos™iÚed
())))

4030 
»suÉ
 = 
cu¼’t
->
fœ¡Chd
();

4031 ià(!
	g»suÉ
) {

4033 ià(!
	gŞdEndOfIÆše
 && 
	gcu¼’t
->
isR’d”IÆše
()) {

4034 
	g»suÉ
 = 
cu¼’t
;

4035 
	g’dOfIÆše
 = 
Œue
;

4039 
	gcu¼’t
 && cu¼’ˆ!ğ
·»Á
) {

4040 
»suÉ
 = 
cu¼’t
->
ÃxtSiblšg
();

4041 ià(
	g»suÉ
) ;

4042 
	gcu¼’t
 = 
cu¼’t
->
·»Á
();

4043 ià(
	gcu¼’t
 && cu¼’ˆ!ğ
·»Á
 && 
cu¼’t
->
isR’d”IÆše
()) {

4044 
»suÉ
 = 
cu¼’t
;

4045 
	g’dOfIÆše
 = 
Œue
;

4051 ià(!
	g»suÉ
)

4054 ià(!
	g»suÉ
->
isPos™iÚed
(è&& (»suÉ->
isText
(è||„esuÉ->
isFlßtšg
(è||„esuÉ->
isR•Ïûd
(è||„esuÉ->
isR’d”IÆše
()))

4057 
	gcu¼’t
 = 
»suÉ
;

4058 
	g»suÉ
 = 0;

4062 
	gcu¼’t
 = 
»suÉ
;

4063  
	gcu¼’t
;

4066 
g‘BPMWidth
(
chdV®ue
, 
L’gth
 
cssUn™
)

4068 ià(
	gcssUn™
.
ty³
(è!ğ
Auto
)

4069  (
cssUn™
.
isFixed
(è? cssUn™.
v®ue
(è: 
chdV®ue
);

4073 
g‘BÜd”PaddšgM¬gš
(cÚ¡ 
R’d”BoxMod–Objeù
* 
chd
, 
boŞ
 
’dOfIÆše
)

4075 
R’d”StyË
* 
	gc¡yË
 = 
chd
->
¡yË
();

4076 
	g»suÉ
 = 0;

4077 
boŞ
 
	gËáSide
 = (
c¡yË
->
dœeùiÚ
(è=ğ
LTR
è? !
’dOfIÆše
 :ƒndOfInline;

4078 
	g»suÉ
 +ğ
g‘BPMWidth
((
ËáSide
 ? 
chd
->
m¬gšLeá
(è: chd->
m¬gšRight
()),

4079 (
ËáSide
 ? 
c¡yË
->
m¬gšLeá
() :

4080 
c¡yË
->
m¬gšRight
()));

4081 
	g»suÉ
 +ğ
g‘BPMWidth
((
ËáSide
 ? 
chd
->
·ddšgLeá
(è: chd->
·ddšgRight
()),

4082 (
ËáSide
 ? 
c¡yË
->
·ddšgLeá
() :

4083 
c¡yË
->
·ddšgRight
()));

4084 
	g»suÉ
 +ğ
ËáSide
 ? 
chd
->
bÜd”Leá
(è: chd->
bÜd”Right
();

4085  
	g»suÉ
;

4088 
šlše
 
¡rT¿šgS·û
(& 
šlšeMax
, & 
šlšeMš
,

4089 
R’d”Objeù
* 
ŒašgS·ûChd
)

4091 ià(
	gŒašgS·ûChd
 &&¿šgS·ûChd->
isText
()) {

4093 
R’d”Text
* 
	gt
 = 
toR’d”Text
(
ŒašgS·ûChd
);

4094 cÚ¡ 
UCh¬
 
	g¥aû
 = ' ';

4095 cÚ¡ 
	gFÚt
& 
	gfÚt
 = 
t
->
¡yË
()->
fÚt
();

4096 
	g¥aûWidth
 = 
fÚt
.
width
(
TextRun
(&
¥aû
, 1));

4097 
	gšlšeMax
 -ğ
¥aûWidth
 + 
fÚt
.
wÜdS·cšg
();

4098 ià(
	gšlšeMš
 > 
	gšlšeMax
)

4099 
	gšlšeMš
 = 
šlšeMax
;

4103 
	gR’d”Block
::
ÿlcIÆšeP»fWidths
()

4105 
šlšeMax
 = 0;

4106 
	gšlšeMš
 = 0;

4108 
	gcw
 = 
cÚššgBlock
()->
cÚ‹ÁWidth
();

4112 
boŞ
 
	g¡rFrÚtS·ûs
 = 
Œue
;

4113 
R’d”Objeù
* 
	gŒašgS·ûChd
 = 0;

4118 
boŞ
 
	g®lowImagesToB»ak
 = !
¡yË
()->
htmlHacks
(è|| !
isTabËC–l
(è|| !¡yË()->
width
().
isIÁršsicOrAuto
();

4120 
boŞ
 
	gautoW¿p
, 
	gŞdAutoW¿p
;

4121 
	gautoW¿p
 = 
ŞdAutoW¿p
 = 
¡yË
()->
autoW¿p
();

4123 
IÆšeMšMaxI‹¿tÜ
 
chdI‹¿tÜ
(
this
);

4124 
boŞ
 
	gaddedTextInd’t
 = 
çl£
;

4125 
R’d”Objeù
* 
	g´evFlßt
 = 0;

4126 
R’d”Objeù
* 
	g´eviousL—f
 = 0;

4127 
R’d”Objeù
* 
	gchd
 = 
chdI‹¿tÜ
.
Ãxt
()) {

4128 
autoW¿p
 = 
chd
->
isR•Ïûd
(è? chd->
·»Á
()->
¡yË
()->autoWrap() :

4129 
chd
->
¡yË
()->
autoW¿p
();

4131 ià(!
	gchd
->
isBR
()) {

4167 
R’d”StyË
* 
	gc¡yË
 = 
chd
->
¡yË
();

4168 
	gchdMš
 = 0;

4169 
	gchdMax
 = 0;

4171 ià(!
	gchd
->
isText
()) {

4173 ià(
	gchd
->
isR’d”IÆše
()) {

4176 
	gbpm
 = 
g‘BÜd”PaddšgM¬gš
(
toR’d”IÆše
(
chd
), 
chdI‹¿tÜ
.
’dOfIÆše
);

4177 
	gchdMš
 +ğ
bpm
;

4178 
	gchdMax
 +ğ
bpm
;

4180 
	gšlšeMš
 +ğ
chdMš
;

4181 
	gšlšeMax
 +ğ
chdMax
;

4183 
	gchd
->
£tP»fWidthsDœty
(
çl£
);

4186 
	gm¬gšs
 = 0;

4187 
L’gth
 
	gËáM¬gš
 = 
c¡yË
->
m¬gšLeá
();

4188 
L’gth
 
	grightM¬gš
 = 
c¡yË
->
m¬gšRight
();

4189 ià(
	gËáM¬gš
.
isFixed
())

4190 
	gm¬gšs
 +ğ
ËáM¬gš
.
v®ue
();

4191 ià(
	grightM¬gš
.
isFixed
())

4192 
	gm¬gšs
 +ğ
rightM¬gš
.
v®ue
();

4193 
	gchdMš
 +ğ
m¬gšs
;

4194 
	gchdMax
 +ğ
m¬gšs
;

4198 ià(!
	gchd
->
isR’d”IÆše
(è&& !chd->
isText
()) {

4202 
	gchdMš
 +ğ
chd
->
mšP»fWidth
();

4203 
	gchdMax
 +ğ
chd
->
maxP»fWidth
();

4205 
boŞ
 
	gş—rP»viousFlßt
;

4206 ià(
	gchd
->
isFlßtšg
()) {

4207 
	gş—rP»viousFlßt
 = (
´evFlßt


4208 && ((
´evFlßt
->
¡yË
()->
æßtšg
(è=ğ
FLEFT
 && (
chd
->¡yË()->
ş—r
(è& 
CLEFT
))

4209 || (
´evFlßt
->
¡yË
()->
æßtšg
(è=ğ
FRIGHT
 && (
chd
->¡yË()->
ş—r
(è& 
CRIGHT
))));

4210 
	g´evFlßt
 = 
chd
;

4212 
	gş—rP»viousFlßt
 = 
çl£
;

4214 
boŞ
 
	gÿnB»akR•ÏûdEËm’t
 = !
chd
->
isImage
(è|| 
®lowImagesToB»ak
;

4215 ià((
	gÿnB»akR•ÏûdEËm’t
 && (
	gautoW¿p
 || 
	gŞdAutoW¿p
)è|| 
	gş—rP»viousFlßt
) {

4216 
	gm_mšP»fWidth
 = 
max
(
šlšeMš
, 
m_mšP»fWidth
);

4217 
	gšlšeMš
 = 0;

4221 ià(
	gş—rP»viousFlßt
) {

4222 
	gm_maxP»fWidth
 = 
max
(
šlšeMax
, 
m_maxP»fWidth
);

4223 
	gšlšeMax
 = 0;

4227 
	gti
 = 0;

4228 ià(!
	gaddedTextInd’t
) {

4229 
	gaddedTextInd’t
 = 
Œue
;

4230 
	gti
 = 
¡yË
()->
‹xtInd’t
().
ÿlcMšV®ue
(
cw
);

4231 
	gchdMš
+=
ti
;

4232 
	gchdMax
+=
ti
;

4236 
	gšlšeMax
 +ğ
chdMax
;

4238 ià(!
	gautoW¿p
 || !
	gÿnB»akR•ÏûdEËm’t
) {

4239 ià(
	gchd
->
isFlßtšg
())

4240 
	gm_mšP»fWidth
 = 
max
(
chdMš
, 
m_mšP»fWidth
);

4242 
	gšlšeMš
 +ğ
chdMš
;

4245 
	gm_mšP»fWidth
 = 
max
(
chdMš
, 
m_mšP»fWidth
);

4248 
	gšlšeMš
 = 0;

4253 ià(!
	gchd
->
isFlßtšg
()) {

4254 
	g¡rFrÚtS·ûs
 = 
çl£
;

4255 
	gŒašgS·ûChd
 = 0;

4257 } ià(
	gchd
->
isText
()) {

4259 
R’d”Text
* 
	gt
 = 
toR’d”Text
(
chd
);

4261 ià(
	gt
->
isWÜdB»ak
()) {

4262 
	gm_mšP»fWidth
 = 
max
(
šlšeMš
, 
m_mšP»fWidth
);

4263 
	gšlšeMš
 = 0;

4272 
boŞ
 
	ghasB»akabËCh¬
, 
	ghasB»ak
;

4273 
	gbegšMš
, 
	g’dMš
;

4274 
boŞ
 
	gbegšWS
, 
	g’dWS
;

4275 
	gbegšMax
, 
	g’dMax
;

4276 
	gt
->
ŒimmedP»fWidths
(
šlšeMax
, 
begšMš
, 
begšWS
, 
’dMš
, 
’dWS
,

4277 
hasB»akabËCh¬
, 
hasB»ak
, 
begšMax
, 
’dMax
,

4278 
chdMš
, 
chdMax
, 
¡rFrÚtS·ûs
);

4281 ià(!
	ghasB»ak
 && 
	gchdMax
 == 0) {

4282 ià(
autoW¿p
 && (
begšWS
 || 
’dWS
)) {

4283 
m_mšP»fWidth
 = 
max
(
šlšeMš
, m_minPrefWidth);

4284 
	gšlšeMš
 = 0;

4289 ià(
	g¡rFrÚtS·ûs
)

4290 
	gŒašgS·ûChd
 = 
chd
;

4292 
	gŒašgS·ûChd
 = 0;

4295 
	gti
 = 0;

4296 ià(!
	gaddedTextInd’t
) {

4297 
	gaddedTextInd’t
 = 
Œue
;

4298 
	gti
 = 
¡yË
()->
‹xtInd’t
().
ÿlcMšV®ue
(
cw
);

4299 
	gchdMš
+=
ti
; 
	gbegšMš
 +=i;

4300 
	gchdMax
+=
ti
; 
	gbegšMax
 +=i;

4306 ià(!
	ghasB»akabËCh¬
) {

4307 
	gšlšeMš
 +ğ
chdMš
;

4311 ià(
	gbegšWS
)

4313 
	gm_mšP»fWidth
 = 
max
(
šlšeMš
, 
m_mšP»fWidth
);

4315 
	gšlšeMš
 +ğ
begšMš
;

4316 
	gm_mšP»fWidth
 = 
max
(
šlšeMš
, 
m_mšP»fWidth
);

4317 
	gchdMš
 -ğ
ti
;

4320 
	gšlšeMš
 = 
chdMš
;

4322 ià(
	g’dWS
) {

4325 
	gm_mšP»fWidth
 = 
max
(
šlšeMš
, 
m_mšP»fWidth
);

4326 
	gšlšeMš
 = 0;

4328 
	gm_mšP»fWidth
 = 
max
(
šlšeMš
, 
m_mšP»fWidth
);

4329 
	gšlšeMš
 = 
’dMš
;

4333 ià(
	ghasB»ak
) {

4334 
	gšlšeMax
 +ğ
begšMax
;

4335 
	gm_maxP»fWidth
 = 
max
(
šlšeMax
, 
m_maxP»fWidth
);

4336 
	gm_maxP»fWidth
 = 
max
(
chdMax
, 
m_maxP»fWidth
);

4337 
	gšlšeMax
 = 
’dMax
;

4339 
	gšlšeMax
 +ğ
chdMax
;

4343 ià(
	gchd
->
isLi¡M¬k”
())

4344 
	g¡rFrÚtS·ûs
 = 
Œue
;

4346 
	gm_mšP»fWidth
 = 
max
(
šlšeMš
, 
m_mšP»fWidth
);

4347 
	gm_maxP»fWidth
 = 
max
(
šlšeMax
, 
m_maxP»fWidth
);

4348 
	gšlšeMš
 = 
šlšeMax
 = 0;

4349 
	g¡rFrÚtS·ûs
 = 
Œue
;

4350 
	gŒašgS·ûChd
 = 0;

4353 
	gŞdAutoW¿p
 = 
autoW¿p
;

4354 ià(!
	gchd
->
isR’d”IÆše
())

4355 
	g´eviousL—f
 = 
chd
;

4358 ià(
¡yË
()->
cŞÏp£Wh™eS·û
())

4359 
¡rT¿šgS·û
(
šlšeMax
, 
šlšeMš
, 
ŒašgS·ûChd
);

4361 
	gm_mšP»fWidth
 = 
max
(
šlšeMš
, 
m_mšP»fWidth
);

4362 
	gm_maxP»fWidth
 = 
max
(
šlšeMax
, 
m_maxP»fWidth
);

4366 
	#BLOCK_MAX_WIDTH
 15000

	)

4368 
	gR’d”Block
::
ÿlcBlockP»fWidths
()

4370 
boŞ
 
now¿p
 = 
¡yË
()->
wh™eS·û
(è=ğ
NOWRAP
;

4372 
R’d”Objeù
 *
	gchd
 = 
fœ¡Chd
();

4373 
	gæßtLeáWidth
 = 0, 
	gæßtRightWidth
 = 0;

4374 
	gchd
) {

4376 ià(
	gchd
->
isPos™iÚed
()) {

4377 
	gchd
 = 
chd
->
ÃxtSiblšg
();

4381 ià(
	gchd
->
isFlßtšg
(è|| (chd->
isBox
(è&& 
toR’d”Box
(
chd
)->
avoidsFlßts
())) {

4382 
	gæßtTÙ®Width
 = 
æßtLeáWidth
 + 
æßtRightWidth
;

4383 ià(
	gchd
->
¡yË
()->
ş—r
(è& 
	gCLEFT
) {

4384 
	gm_maxP»fWidth
 = 
max
(
æßtTÙ®Width
, 
m_maxP»fWidth
);

4385 
	gæßtLeáWidth
 = 0;

4387 ià(
	gchd
->
¡yË
()->
ş—r
(è& 
	gCRIGHT
) {

4388 
	gm_maxP»fWidth
 = 
max
(
æßtTÙ®Width
, 
m_maxP»fWidth
);

4389 
	gæßtRightWidth
 = 0;

4396 
L’gth
 
	gml
 = 
chd
->
¡yË
()->
m¬gšLeá
();

4397 
L’gth
 
	gmr
 = 
chd
->
¡yË
()->
m¬gšRight
();

4398 
	gm¬gš
 = 0, 
	gm¬gšLeá
 = 0, 
	gm¬gšRight
 = 0;

4399 ià(
	gml
.
isFixed
())

4400 
	gm¬gšLeá
 +ğ
ml
.
v®ue
();

4401 ià(
	gmr
.
isFixed
())

4402 
	gm¬gšRight
 +ğ
mr
.
v®ue
();

4403 
	gm¬gš
 = 
m¬gšLeá
 + 
m¬gšRight
;

4405 
	gw
 = 
chd
->
mšP»fWidth
(è+ 
m¬gš
;

4406 
	gm_mšP»fWidth
 = 
max
(
w
, 
m_mšP»fWidth
);

4409 ià(
	gnow¿p
 && !
	gchd
->
isTabË
())

4410 
	gm_maxP»fWidth
 = 
max
(
w
, 
m_maxP»fWidth
);

4412 
	gw
 = 
chd
->
maxP»fWidth
(è+ 
m¬gš
;

4414 ià(!
	gchd
->
isFlßtšg
()) {

4415 ià(
	gchd
->
isBox
(è&& 
toR’d”Box
(
chd
)->
avoidsFlßts
()) {

4419 
	gmaxLeá
 = 
m¬gšLeá
 > 0 ? 
max
(
æßtLeáWidth
, marginLeft) : floatLeftWidth + marginLeft;

4420 
	gmaxRight
 = 
m¬gšRight
 > 0 ? 
max
(
æßtRightWidth
, marginRight) : floatRightWidth + marginRight;

4421 
	gw
 = 
chd
->
maxP»fWidth
(è+ 
maxLeá
 + 
maxRight
;

4422 
	gw
 = 
max
(
w
, 
æßtLeáWidth
 + 
æßtRightWidth
);

4425 
	gm_maxP»fWidth
 = 
max
(
æßtLeáWidth
 + 
æßtRightWidth
, 
m_maxP»fWidth
);

4426 
	gæßtLeáWidth
 = 
æßtRightWidth
 = 0;

4429 ià(
	gchd
->
isFlßtšg
()) {

4430 ià(
¡yË
()->
æßtšg
(è=ğ
FLEFT
)

4431 
æßtLeáWidth
 +ğ
w
;

4433 
	gæßtRightWidth
 +ğ
w
;

4435 
	gm_maxP»fWidth
 = 
max
(
w
, 
m_maxP»fWidth
);

4450 ià(
¡yË
()->
htmlHacks
(è&& 
	gchd
->¡yË()->
width
().
isP”ûÁ
() &&

4451 !
isTabËC–l
(è&& 
	gchd
->
isTabË
(è&& 
	gm_maxP»fWidth
 < 
	gBLOCK_MAX_WIDTH
) {

4452 
R’d”Block
* 
	gcb
 = 
cÚššgBlock
();

4453 !
	gcb
->
isR’d”V›w
(è&& !cb->
isTabËC–l
())

4454 
	gcb
 = 
cb
->
cÚššgBlock
();

4455 ià(!
	gcb
->
isTabËC–l
())

4456 
	gm_maxP»fWidth
 = 
BLOCK_MAX_WIDTH
;

4459 
	gchd
 = 
chd
->
ÃxtSiblšg
();

4463 
	gm_mšP»fWidth
 = 
max
(0, 
m_mšP»fWidth
);

4464 
	gm_maxP»fWidth
 = 
max
(0, 
m_maxP»fWidth
);

4466 
	gm_maxP»fWidth
 = 
max
(
æßtLeáWidth
 + 
æßtRightWidth
, 
m_maxP»fWidth
);

4469 
boŞ
 
	gR’d”Block
::
hasLšeIfEm±y
() const

4471 ià(!
node
())

4472  
çl£
;

4474 ià(
node
()->
isCÚ‹ÁEd™abË
(è&&‚ode()->
roÙEd™abËEËm’t
() ==‚ode())

4475  
Œue
;

4477 ià(
node
()->
isShadowNode
(è&& (node()->
shadowP¬’tNode
()->
hasTagName
(
šputTag
è||‚ode()->shadowP¬’tNode()->hasTagName(
‹x»aTag
)))

4478  
	gŒue
;

4480  
	gçl£
;

4483 
	gR’d”Block
::
lšeHeight
(
boŞ
 
fœ¡Lše
, boŞ 
isRoÙLšeBox
) const

4489 ià(
isR•Ïûd
(è&& !
	gisRoÙLšeBox
)

4490  
height
(è+ 
m¬gšTİ
(è+ 
m¬gšBÙtom
();

4492 ià(
	gfœ¡Lše
 && 
docum’t
()->
u£sFœ¡LšeRuËs
()) {

4493 
R’d”StyË
* 
	gs
 = 
¡yË
(
fœ¡Lše
);

4494 ià(
	gs
 !ğ
¡yË
())

4495  
s
->
compu‹dLšeHeight
();

4498 ià(
	gm_lšeHeight
 == -1)

4499 
m_lšeHeight
 = 
¡yË
()->
compu‹dLšeHeight
();

4501  
	gm_lšeHeight
;

4504 
	gR’d”Block
::
ba£lšePos™iÚ
(
boŞ
 
b
, boŞ 
isRoÙLšeBox
) const

4510 ià(
isR•Ïûd
(è&& !
	gisRoÙLšeBox
) {

4514 ià(
¡yË
()->
hasAµ—¿nû
(è&& !
theme
()->
isCÚŒŞCÚš”
(¡yË()->
­³¬ªû
()))

4515  
theme
()->
ba£lšePos™iÚ
(
this
);

4523 
	gba£lšePos
 = (
Ïy”
(è&& (Ïy”()->
m¬qu“
(è||†ay”()->
v”tiÿlSüŞlb¬
(è||†ay”()->
süŞlYOff£t
(è!ğ0)è? -1 : 
Ï¡LšeBoxBa£lše
();

4524 ià(
	gba£lšePos
 !ğ-1 && 
ba£lšePos
 <ğ
bÜd”Tİ
(è+ 
·ddšgTİ
(è+ 
cÚ‹ÁHeight
())

4525  
m¬gšTİ
(è+ 
ba£lšePos
;

4526  
height
(è+ 
m¬gšTİ
(è+ 
m¬gšBÙtom
();

4528  
	gR’d”Box
::
ba£lšePos™iÚ
(
b
, 
isRoÙLšeBox
);

4531 
	gR’d”Block
::
fœ¡LšeBoxBa£lše
() const

4533 ià(!
isBlockFlow
())

4536 ià(
chd»nIÆše
()) {

4537 ià(
fœ¡LšeBox
())

4538  
fœ¡LšeBox
()->
y
(è+ 
¡yË
(
Œue
)->
fÚt
().
asûÁ
();

4543 
R’d”Box
* 
	gcu¼
 = 
fœ¡ChdBox
(); cu¼; cu¼ = 
cu¼
->
ÃxtSiblšgBox
()) {

4544 ià(!
cu¼
->
isFlßtšgOrPos™iÚed
()) {

4545 
»suÉ
 = 
cu¼
->
fœ¡LšeBoxBa£lše
();

4546 ià(
	g»suÉ
 != -1)

4547  
cu¼
->
y
(è+ 
»suÉ
;

4555 
	gR’d”Block
::
Ï¡LšeBoxBa£lše
() const

4557 ià(!
isBlockFlow
())

4560 ià(
chd»nIÆše
()) {

4561 ià(!
fœ¡LšeBox
(è&& 
hasLšeIfEm±y
())

4562  
	gR’d”Box
::
ba£lšePos™iÚ
(
Œue
,rueè+ 
bÜd”Tİ
(è+ 
·ddšgTİ
();

4563 ià(
Ï¡LšeBox
())

4564  
Ï¡LšeBox
()->
y
(è+ 
¡yË
Öa¡LšeBox(è=ğ
fœ¡LšeBox
())->
fÚt
().
asûÁ
();

4568 
boŞ
 
	ghaveNÜm®FlowChd
 = 
çl£
;

4569 
R’d”Box
* 
	gcu¼
 = 
Ï¡ChdBox
(); cu¼; cu¼ = 
cu¼
->
´eviousSiblšgBox
()) {

4570 ià(!
cu¼
->
isFlßtšgOrPos™iÚed
()) {

4571 
haveNÜm®FlowChd
 = 
Œue
;

4572 
	g»suÉ
 = 
cu¼
->
Ï¡LšeBoxBa£lše
();

4573 ià(
	g»suÉ
 != -1)

4574  
cu¼
->
y
(è+ 
»suÉ
;

4577 ià(!
	ghaveNÜm®FlowChd
 && 
hasLšeIfEm±y
())

4578  
	gR’d”Box
::
ba£lšePos™iÚ
(
Œue
,rueè+ 
bÜd”Tİ
(è+ 
·ddšgTİ
();

4584 
boŞ
 
	gR’d”Block
::
cÚšsNÚZ”oBidiLev–
() const

4586 
RoÙIÆšeBox
* 
roÙ
 = 
fœ¡RoÙBox
(); 
	groÙ
;„oÙ =„oÙ->
ÃxtRoÙBox
()) {

4587 
IÆšeBox
* 
box
 = 
roÙ
->
fœ¡L—fChd
(); 
	gbox
; box = box->
ÃxtL—fChd
()) {

4588 ià(
box
->
bidiLev–
())

4589  
Œue
;

4592  
	gçl£
;

4595 
R’d”Block
* 
	gR’d”Block
::
fœ¡LšeBlock
() const

4597 
R’d”Block
* 
fœ¡LšeBlock
 = 
cÚ¡_ÿ¡
<R’d”Block*>(
this
);

4598 
boŞ
 
	ghasP£udo
 = 
çl£
;

4599 
	gŒue
) {

4600 
	ghasP£udo
 = 
fœ¡LšeBlock
->
¡yË
()->
hasP£udoStyË
(
FIRST_LINE
);

4601 ià(
	ghasP£udo
)

4603 
R’d”Objeù
* 
	g·»ÁBlock
 = 
fœ¡LšeBlock
->
·»Á
();

4604 ià(
	gfœ¡LšeBlock
->
isR•Ïûd
(è|| fœ¡LšeBlock->
isFlßtšg
() ||

4605 !
	g·»ÁBlock
 ||…¬’tBlock->
fœ¡Chd
(è!ğ
fœ¡LšeBlock
 || !
·»ÁBlock
->
isBlockFlow
())

4607 
ASSERT
(
·»ÁBlock
->
isR’d”Block
());

4608 
	gfœ¡LšeBlock
 = 
toR’d”Block
(
·»ÁBlock
);

4611 ià(!
	ghasP£udo
)

4614  
	gfœ¡LšeBlock
;

4617 
	gR’d”Block
::
upd©eFœ¡L‘‹r
()

4619 ià(!
docum’t
()->
u£sFœ¡L‘‹rRuËs
())

4622 ià(
¡yË
()->
¡yËTy³
(è=ğ
FIRST_LETTER
)

4627 
R’d”Objeù
* 
	gfœ¡L‘‹rBlock
 = 
this
;

4628 
boŞ
 
	ghasP£udoStyË
 = 
çl£
;

4629 
	gŒue
) {

4632 
	ghasP£udoStyË
 = 
fœ¡L‘‹rBlock
->
¡yË
()->
hasP£udoStyË
(
FIRST_LETTER
)

4633 && 
fœ¡L‘‹rBlock
->
ÿnHaveChd»n
();

4634 ià(
	ghasP£udoStyË
)

4636 
R’d”Objeù
* 
	g·»ÁBlock
 = 
fœ¡L‘‹rBlock
->
·»Á
();

4637 ià(
	gfœ¡L‘‹rBlock
->
isR•Ïûd
(è|| !
	g·»ÁBlock
 ||…¬’tBlock->
fœ¡Chd
(è!ğ
fœ¡L‘‹rBlock
 ||

4638 !
·»ÁBlock
->
isBlockFlow
())

4640 
	gfœ¡L‘‹rBlock
 = 
·»ÁBlock
;

4643 ià(!
	ghasP£udoStyË
)

4647 
R’d”Objeù
* 
	gcu¼Chd
 = 
fœ¡L‘‹rBlock
->
fœ¡Chd
();

4648 
	gcu¼Chd
 && cu¼Chd->
ÃedsLayout
(è&& ((!cu¼Chd->
isR•Ïûd
(è&& !cu¼Chd->
isR’d”Bu‰Ú
(è&& !cu¼Chd->
isM’uLi¡
()è|| cu¼Chd->
isFlßtšgOrPos™iÚed
()è&& !cu¼Chd->
isText
()) {

4649 ià(
	gcu¼Chd
->
isFlßtšgOrPos™iÚed
()) {

4650 ià(
	gcu¼Chd
->
¡yË
()->
¡yËTy³
(è=ğ
FIRST_LETTER
)

4652 
	gcu¼Chd
 = 
cu¼Chd
->
ÃxtSiblšg
();

4654 
	gcu¼Chd
 = 
cu¼Chd
->
fœ¡Chd
();

4658 
	gcu¼Chd
 && cu¼Chd->
isLi¡M¬k”
())

4659 
	gcu¼Chd
 = 
cu¼Chd
->
ÃxtSiblšg
();

4661 ià(!
	gcu¼Chd
)

4664 
R’d”Objeù
* 
	gfœ¡L‘‹rCÚš”
 = 
cu¼Chd
->
·»Á
();

4668 ià(
	gcu¼Chd
->
¡yË
()->
¡yËTy³
(è=ğ
FIRST_LETTER
) {

4669 
R’d”StyË
* 
p£udo
 = 
fœ¡L‘‹rBlock
->
g‘CachedP£udoStyË
(
FIRST_LETTER
,

4670 
fœ¡L‘‹rCÚš”
->
fœ¡LšeStyË
());

4671 
	gcu¼Chd
->
£tStyË
(
p£udo
);

4672 
R’d”Objeù
* 
	gg’Chd
 = 
cu¼Chd
->
fœ¡Chd
(); g’Chd; g’Chd = 
g’Chd
->
ÃxtSiblšg
()) {

4673 ià(
g’Chd
->
isText
())

4674 
g’Chd
->
£tStyË
(
p£udo
);

4680 ià(
	gcu¼Chd
->
isText
(è&& !cu¼Chd->
isBR
(è&& cu¼Chd->
·»Á
()->
¡yË
()->
¡yËTy³
(è!ğ
FIRST_LETTER
) {

4683 
v›w
()->
di§bËLayoutS‹
();

4685 
R’d”Text
* 
	g‹xtObj
 = 
toR’d”Text
(
cu¼Chd
);

4688 
R’d”StyË
* 
	gp£udoStyË
 = 
fœ¡L‘‹rBlock
->
g‘CachedP£udoStyË
(
FIRST_LETTER
,

4689 
fœ¡L‘‹rCÚš”
->
fœ¡LšeStyË
());

4692 
	gp£udoStyË
->
£tDi¥Ïy
(
p£udoStyË
->
isFlßtšg
(è? 
BLOCK
 : 
INLINE
);

4693 
	gp£udoStyË
->
£tPos™iÚ
(
SticPos™iÚ
);

4695 
R’d”Objeù
* 
	gfœ¡L‘‹r
 = 0;

4696 ià(
	gp£udoStyË
->
di¥Ïy
(è=ğ
INLINE
)

4697 
fœ¡L‘‹r
 = 
Ãw
 (
»nd”A»Ç
()è
R’d”IÆše
(
docum’t
());

4699 
	gfœ¡L‘‹r
 = 
Ãw
 (
»nd”A»Ç
()è
R’d”Block
(
docum’t
());

4700 
	gfœ¡L‘‹r
->
£tStyË
(
p£udoStyË
);

4701 
	gfœ¡L‘‹rCÚš”
->
addChd
(
fœ¡L‘‹r
, 
cu¼Chd
);

4706 
	gRefPŒ
<
	gSŒšgIm¶
> 
	gŞdText
 = 
‹xtObj
->
Üigš®Text
();

4707 
ASSERT
(
ŞdText
);

4709 ià(
	gŞdText
 && oldText->
Ëngth
() > 0) {

4710 
	gËngth
 = 0;

4713 
	gËngth
 < 
	gŞdText
->
Ëngth
(è&& (
isS·ûOrNewlše
((*
ŞdText
)[Ëngth]è|| 
	gUnicode
::
isPunù
((*oldText)[length])))

4714 
Ëngth
++;

4717 
	gËngth
++;

4721 
R’d”TextF¿gm’t
* 
	g»maššgText
 =

4722 
Ãw
 (
»nd”A»Ç
()è
R’d”TextF¿gm’t
(
‹xtObj
->
node
(è?extObj->node(è:extObj->
docum’t
(), 
ŞdText
.
g‘
(), 
Ëngth
, oldText->length() -†ength);

4723 
	g»maššgText
->
£tStyË
(
‹xtObj
->
¡yË
());

4724 ià(
	g»maššgText
->
node
())

4725 
	g»maššgText
->
node
()->
£tR’d””
(
»maššgText
);

4727 
R’d”Objeù
* 
	gÃxtObj
 = 
‹xtObj
->
ÃxtSiblšg
();

4728 
	gfœ¡L‘‹rCÚš”
->
»moveChd
(
‹xtObj
);

4729 
	gfœ¡L‘‹rCÚš”
->
addChd
(
»maššgText
, 
ÃxtObj
);

4730 
	g»maššgText
->
£tFœ¡L‘‹r
(
fœ¡L‘‹r
);

4733 
R’d”TextF¿gm’t
* 
	gË‰”
 =

4734 
Ãw
 (
»nd”A»Ç
()è
R’d”TextF¿gm’t
(
»maššgText
->
node
(è?„emaššgText->node(è:„emaššgText->
docum’t
(), 
ŞdText
.
g‘
(), 0, 
Ëngth
);

4735 
	gRefPŒ
<
	gR’d”StyË
> 
	gÃwStyË
 = 
R’d”StyË
::
ü—‹
();

4736 
	gÃwStyË
->
šh”™From
(
p£udoStyË
);

4737 
	gË‰”
->
£tStyË
(
ÃwStyË
.
»Ëa£
());

4738 
	gfœ¡L‘‹r
->
addChd
(
Ë‰”
);

4740 
	g‹xtObj
->
de¡roy
();

4742 
v›w
()->
’abËLayoutS‹
();

4748 
boŞ
 
shouldCheckLšes
(
R’d”Objeù
* 
obj
)

4750  !
	gobj
->
isFlßtšgOrPos™iÚed
(è&& !obj->
isRunIn
() &&

4751 
	gobj
->
isBlockFlow
(è&& obj->
¡yË
()->
height
().
isAuto
() &&

4752 (!
	gobj
->
isFËxibËBox
(è|| obj->
¡yË
()->
boxOr›Á
(è=ğ
VERTICAL
);

4755 
RoÙIÆšeBox
* 
g‘LšeAtIndex
(
R’d”Block
* 
block
, 
i
, & 
couÁ
)

4757 ià(
	gblock
->
¡yË
()->
visib™y
(è=ğ
VISIBLE
) {

4758 ià(
block
->
chd»nIÆše
()) {

4759 
RoÙIÆšeBox
* 
box
 = 
block
->
fœ¡RoÙBox
(); 
	gbox
; box = box->
ÃxtRoÙBox
()) {

4760 ià(
couÁ
++ =ğ
i
)

4761  
box
;

4765 
R’d”Objeù
* 
	gobj
 = 
block
->
fœ¡Chd
(); obj; obj = 
obj
->
ÃxtSiblšg
()) {

4766 ià(
shouldCheckLšes
(
obj
)) {

4767 
RoÙIÆšeBox
 *
box
 = 
g‘LšeAtIndex
(
toR’d”Block
(
obj
), 
i
, 
couÁ
);

4768 ià(
	gbox
)

4769  
	gbox
;

4777 
g‘HeightFÜLšeCouÁ
(
R’d”Block
* 
block
, 
l
, 
boŞ
 
šşudeBÙtom
, & 
couÁ
)

4779 ià(
	gblock
->
¡yË
()->
visib™y
(è=ğ
VISIBLE
) {

4780 ià(
block
->
chd»nIÆše
()) {

4781 
RoÙIÆšeBox
* 
box
 = 
block
->
fœ¡RoÙBox
(); 
	gbox
; box = box->
ÃxtRoÙBox
()) {

4782 ià(++
couÁ
 =ğ
l
)

4783  
box
->
lšeBÙtom
(è+ (
šşudeBÙtom
 ? (
block
->
bÜd”BÙtom
(è+ block->
·ddšgBÙtom
()) : 0);

4787 
R’d”Box
* 
	gnÜm®FlowChdW™houtLšes
 = 0;

4788 
R’d”Box
* 
	gobj
 = 
block
->
fœ¡ChdBox
(); obj; obj = 
obj
->
ÃxtSiblšgBox
()) {

4789 ià(
shouldCheckLšes
(
obj
)) {

4790 
»suÉ
 = 
g‘HeightFÜLšeCouÁ
(
toR’d”Block
(
obj
), 
l
, 
çl£
, 
couÁ
);

4791 ià(
	g»suÉ
 != -1)

4792  
»suÉ
 + 
obj
->
y
(è+ (
šşudeBÙtom
 ? (
block
->
bÜd”BÙtom
(è+ block->
·ddšgBÙtom
()) : 0);

4794 ià(!
	gobj
->
isFlßtšgOrPos™iÚed
(è&& !obj->
isRunIn
())

4795 
	gnÜm®FlowChdW™houtLšes
 = 
obj
;

4797 ià(
	gnÜm®FlowChdW™houtLšes
 && 
	gl
 == 0)

4798  
nÜm®FlowChdW™houtLšes
->
y
(è+‚Üm®FlowChdW™houtLšes->
height
();

4805 
RoÙIÆšeBox
* 
	gR’d”Block
::
lšeAtIndex
(
i
)

4807 
couÁ
 = 0;

4808  
g‘LšeAtIndex
(
this
, 
i
, 
couÁ
);

4811 
	gR’d”Block
::
lšeCouÁ
()

4813 
couÁ
 = 0;

4814 ià(
¡yË
()->
visib™y
(è=ğ
VISIBLE
) {

4815 ià(
chd»nIÆše
())

4816 
RoÙIÆšeBox
* 
box
 = 
fœ¡RoÙBox
(); 
	gbox
; box = box->
ÃxtRoÙBox
())

4817 
couÁ
++;

4819 
R’d”Objeù
* 
	gobj
 = 
fœ¡Chd
(); obj; obj = 
obj
->
ÃxtSiblšg
())

4820 ià(
shouldCheckLšes
(
obj
))

4821 
couÁ
 +ğ
toR’d”Block
(
obj
)->
lšeCouÁ
();

4823  
	gcouÁ
;

4826 
	gR’d”Block
::
heightFÜLšeCouÁ
(
l
)

4828 
couÁ
 = 0;

4829  
g‘HeightFÜLšeCouÁ
(
this
, 
l
, 
Œue
, 
couÁ
);

4832 
	gR’d”Block
::
adju¡FÜBÜd”F™
(
x
, & 
Ëá
, & 
right
) const

4836 ià(
¡yË
()->
visib™y
(è=ğ
VISIBLE
) {

4837 ià(
chd»nIÆše
()) {

4838 
RoÙIÆšeBox
* 
box
 = 
fœ¡RoÙBox
(); 
	gbox
; box = box->
ÃxtRoÙBox
()) {

4839 ià(
box
->
fœ¡Chd
())

4840 
Ëá
 = 
mš
Öeá, 
x
 + 
box
->
fœ¡Chd
()->x());

4841 ià(
	gbox
->
Ï¡Chd
())

4842 
	gright
 = 
max
(
right
, 
x
 + 
box
->
Ï¡Chd
()->x(è+ box->Ï¡Chd()->
width
());

4846 
R’d”Box
* 
	gobj
 = 
fœ¡ChdBox
(); obj; obj = 
obj
->
ÃxtSiblšgBox
()) {

4847 ià(!
obj
->
isFlßtšgOrPos™iÚed
()) {

4848 ià(
obj
->
isBlockFlow
(è&& !obj->
hasOv”æowCl
())

4849 
toR’d”Block
(
obj
)->
adju¡FÜBÜd”F™
(
x
 + obj->x(), 
Ëá
, 
right
);

4850 ià(
	gobj
->
¡yË
()->
visib™y
(è=ğ
VISIBLE
) {

4852 
Ëá
 = 
mš
Öeá, 
x
 + 
obj
->x());

4853 
	gright
 = 
max
(
right
, 
x
 + 
obj
->x(è+ obj->
width
());

4859 ià(
	gm_æßtšgObjeùs
) {

4860 
FlßtšgObjeù
* 
	gr
;

4861 
	gD•»ÿ‹dPŒLi¡I‹¿tÜ
<
	gFlßtšgObjeù
> 
™
(*
m_æßtšgObjeùs
);

4862 ; (
	gr
 = 
™
.
cu¼’t
()); ++
	g™
) {

4864 ià(
	gr
->
	gm_shouldPašt
) {

4865 
	gæßtLeá
 = 
r
->
m_Ëá
 -„->
m_»nd””
->
x
(è+„->m_»nd””->
m¬gšLeá
();

4866 
	gæßtRight
 = 
æßtLeá
 + 
r
->
m_»nd””
->
width
();

4867 
	gËá
 = 
mš
(
Ëá
, 
æßtLeá
);

4868 
	gright
 = 
max
(
right
, 
æßtRight
);

4875 
	gR’d”Block
::
bÜd”F™Adju¡
(& 
x
, & 
w
) const

4877 ià(
¡yË
()->
bÜd”F™
(è=ğ
BÜd”F™BÜd”
)

4881 
	gËá
 = 
INT_MAX
;

4882 
	gright
 = 
INT_MIN
;

4883 
	gŞdWidth
 = 
w
;

4884 
adju¡FÜBÜd”F™
(0, 
Ëá
, 
right
);

4885 ià(
	gËá
 !ğ
INT_MAX
) {

4886 
Ëá
 -ğ(
bÜd”Leá
(è+ 
·ddšgLeá
());

4887 ià(
	gËá
 > 0) {

4888 
	gx
 +ğ
Ëá
;

4889 
	gw
 -ğ
Ëá
;

4892 ià(
	gright
 !ğ
INT_MIN
) {

4893 
right
 +ğ(
bÜd”Right
(è+ 
·ddšgRight
());

4894 ià(
	gright
 < 
	gŞdWidth
)

4895 
	gw
 -ğ(
ŞdWidth
 - 
right
);

4899 
	gR’d”Block
::
ş—rTrunÿtiÚ
()

4901 ià(
¡yË
()->
visib™y
(è=ğ
VISIBLE
) {

4902 ià(
chd»nIÆše
(è&& 
hasM¬kupTrunÿtiÚ
()) {

4903 
£tHasM¬kupTrunÿtiÚ
(
çl£
);

4904 
RoÙIÆšeBox
* 
	gbox
 = 
fœ¡RoÙBox
(); box; box = 
box
->
ÃxtRoÙBox
())

4905 
box
->
ş—rTrunÿtiÚ
();

4908 
R’d”Objeù
* 
	gobj
 = 
fœ¡Chd
(); obj; obj = 
obj
->
ÃxtSiblšg
())

4909 ià(
shouldCheckLšes
(
obj
))

4910 
toR’d”Block
(
obj
)->
ş—rTrunÿtiÚ
();

4914 
	gR’d”Block
::
£tMaxTİM¬gšs
(
pos
, 
Ãg
)

4916 ià(!
	gm_maxM¬gš
) {

4917 ià(
	gpos
 =ğ
MaxM¬gš
::
tİPosDeçuÉ
(
this
è&& 
Ãg
 =ğMaxM¬gš::
tİNegDeçuÉ
(this))

4919 
	gm_maxM¬gš
 = 
Ãw
 
MaxM¬gš
(
this
);

4921 
	gm_maxM¬gš
->
	gm_tİPos
 = 
pos
;

4922 
	gm_maxM¬gš
->
	gm_tİNeg
 = 
Ãg
;

4925 
	gR’d”Block
::
£tMaxBÙtomM¬gšs
(
pos
, 
Ãg
)

4927 ià(!
	gm_maxM¬gš
) {

4928 ià(
	gpos
 =ğ
MaxM¬gš
::
bÙtomPosDeçuÉ
(
this
è&& 
Ãg
 =ğMaxM¬gš::
bÙtomNegDeçuÉ
(this))

4930 
	gm_maxM¬gš
 = 
Ãw
 
MaxM¬gš
(
this
);

4932 
	gm_maxM¬gš
->
	gm_bÙtomPos
 = 
pos
;

4933 
	gm_maxM¬gš
->
	gm_bÙtomNeg
 = 
Ãg
;

4936 
	gR’d”Block
::
absŞu‹Reùs
(
VeùÜ
<
IÁReù
>& 
»ùs
, 
tx
, 
ty
)

4941 ià(
šlšeCÚtšu©iÚ
()) {

4942 
	g»ùs
.
­³nd
(
IÁReù
(
tx
, 
ty
 - 
cŞÏp£dM¬gšTİ
(),

4943 
width
(), 
height
(è+ 
cŞÏp£dM¬gšTİ
(è+ 
cŞÏp£dM¬gšBÙtom
()));

4944 
šlšeCÚtšu©iÚ
()->
absŞu‹Reùs
(
»ùs
,

4945 
tx
 - 
x
(è+ 
šlšeCÚtšu©iÚ
()->
cÚššgBlock
()->x(),

4946 
ty
 - 
y
(è+ 
šlšeCÚtšu©iÚ
()->
cÚššgBlock
()->y());

4948 
	g»ùs
.
­³nd
(
IÁReù
(
tx
, 
ty
, 
width
(), 
height
()));

4951 
	gR’d”Block
::
absŞu‹Quads
(
VeùÜ
<
FlßtQuad
>& 
quads
)

4956 ià(
šlšeCÚtšu©iÚ
()) {

4957 
FlßtReù
 
loÿlReù
(0, -
cŞÏp£dM¬gšTİ
(),

4958 
width
(), 
height
(è+ 
cŞÏp£dM¬gšTİ
(è+ 
cŞÏp£dM¬gšBÙtom
());

4959 
	gquads
.
­³nd
(
loÿlToAbsŞu‹Quad
(
loÿlReù
));

4960 
šlšeCÚtšu©iÚ
()->
absŞu‹Quads
(
quads
);

4962 
	gquads
.
­³nd
(
R’d”Box
::
loÿlToAbsŞu‹Quad
(
FlßtReù
(0, 0, 
width
(), 
height
())));

4965 
IÁReù
 
	gR’d”Block
::
»ùW™hOušeFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
oušeWidth
)

4967 
IÁReù
 
r
(
R’d”Box
::
»ùW™hOušeFÜR•ašt
(
»·štCÚš”
, 
oušeWidth
));

4968 ià(
šlšeCÚtšu©iÚ
())

4969 
	gr
.
šæ©eY
(
cŞÏp£dM¬gšTİ
());

4970  
	gr
;

4973 
R’d”Objeù
* 
	gR’d”Block
::
hov”Anû¡Ü
() const

4975  
šlšeCÚtšu©iÚ
(è? iÆšeCÚtšu©iÚ(è: 
R’d”Box
::
hov”Anû¡Ü
();

4978 
	gR’d”Block
::
upd©eD¿gS‹
(
boŞ
 
d¿gOn
)

4980 
R’d”Box
::
upd©eD¿gS‹
(
d¿gOn
);

4981 ià(
šlšeCÚtšu©iÚ
())

4982 
šlšeCÚtšu©iÚ
()->
upd©eD¿gS‹
(
d¿gOn
);

4985 
R’d”StyË
* 
	gR’d”Block
::
oušeStyËFÜR•ašt
() const

4987  
šlšeCÚtšu©iÚ
(è? iÆšeCÚtšu©iÚ()->
¡yË
() : style();

4990 
	gR’d”Block
::
chdBeÿmeNÚIÆše
(
R’d”Objeù
*)

4992 
makeChd»nNÚIÆše
();

4993 ià(
isAnÚymousBlock
(è&& 
·»Á
(è&&…¬’t()->
isR’d”Block
())

4994 
toR’d”Block
(
·»Á
())->
»moveLeáov”AnÚymousBlock
(
this
);

4998 
	gR’d”Block
::
upd©eH™Te¡ResuÉ
(
H™Te¡ResuÉ
& 
»suÉ
, cÚ¡ 
IÁPošt
& 
pošt
)

5000 ià(
	g»suÉ
.
šÃrNode
())

5003 
Node
* 
	gn
 = 
node
();

5004 ià(
šlšeCÚtšu©iÚ
())

5008 
	gn
 = 
šlšeCÚtšu©iÚ
()->
node
();

5010 ià(
	gn
) {

5011 
	g»suÉ
.
£tIÂ”Node
(
n
);

5012 ià(!
	g»suÉ
.
šÃrNÚSh¬edNode
())

5013 
	g»suÉ
.
£tIÂ”NÚSh¬edNode
(
n
);

5014 
	g»suÉ
.
£tLoÿlPošt
(
pošt
);

5018 
IÁReù
 
	gR’d”Block
::
loÿlC¬‘Reù
(
IÆšeBox
* 
šlšeBox
, 
ÿ»tOff£t
, * 
exŒaWidthToEndOfLše
)

5021 ià(
fœ¡Chd
())

5022  
	gR’d”Box
::
loÿlC¬‘Reù
(
šlšeBox
, 
ÿ»tOff£t
, 
exŒaWidthToEndOfLše
);

5032 
R’d”StyË
* 
	gcu¼’tStyË
 = 
fœ¡LšeStyË
();

5033 
	gheight
 = 
lšeHeight
(
Œue
);

5035 
	eC¬‘Alignm’t
 { 
	g®ignLeá
, 
	g®ignRight
, 
	g®ignC’‹r
 };

5037 
C¬‘Alignm’t
 
	g®ignm’t
 = 
®ignLeá
;

5039 
	gcu¼’tStyË
->
‹xtAlign
()) {

5040 
	gTAAUTO
:

5041 
JUSTIFY
:

5042 ià(
cu¼’tStyË
->
dœeùiÚ
(è=ğ
RTL
)

5043 
®ignm’t
 = 
®ignRight
;

5045 
	gLEFT
:

5046 
WEBKIT_LEFT
:

5048 
	gCENTER
:

5049 
WEBKIT_CENTER
:

5050 
®ignm’t
 = 
®ignC’‹r
;

5052 
	gRIGHT
:

5053 
WEBKIT_RIGHT
:

5054 
®ignm’t
 = 
®ignRight
;

5058 
	gx
 = 
bÜd”Leá
(è+ 
·ddšgLeá
();

5059 
	gw
 = 
width
();

5061 
	g®ignm’t
) {

5062 
	g®ignLeá
:

5064 
	g®ignC’‹r
:

5065 
x
 = (x + 
w
 - (
bÜd”Right
(è+ 
·ddšgRight
())) / 2;

5067 
	g®ignRight
:

5068 
x
 = 
w
 - (
bÜd”Right
(è+ 
·ddšgRight
()è- 
ÿ»tWidth
;

5072 ià(
	gexŒaWidthToEndOfLše
) {

5073 ià(
isR’d”Block
()) {

5074 *
	gexŒaWidthToEndOfLše
 = 
w
 - (
x
 + 
ÿ»tWidth
);

5080 
	gmyRight
 = 
x
 + 
ÿ»tWidth
;

5082 
FlßtPošt
 
	gabsRightPošt
 = 
loÿlToAbsŞu‹
(FlßtPošt(
myRight
, 0));

5084 
	gcÚš”Right
 = 
cÚššgBlock
()->
x
(è+ 
cÚššgBlockWidthFÜCÚ‹Á
();

5085 
FlßtPošt
 
	gabsCÚš”Pošt
 = 
loÿlToAbsŞu‹
(FlßtPošt(
cÚš”Right
, 0));

5087 *
	gexŒaWidthToEndOfLše
 = 
absCÚš”Pošt
.
x
(è- 
absRightPošt
.x();

5091 
	gy
 = 
·ddšgTİ
(è+ 
bÜd”Tİ
();

5093  
IÁReù
(
x
, 
y
, 
ÿ»tWidth
, 
height
);

5096 
	gR’d”Block
::
addFocusRšgReùs
(
VeùÜ
<
IÁReù
>& 
»ùs
, 
tx
, 
ty
)

5101 ià(
šlšeCÚtšu©iÚ
()) {

5103 
boŞ
 
	gÃxtIÆšeHasLšeBox
 = 
šlšeCÚtšu©iÚ
()->
fœ¡LšeBox
();

5105 
boŞ
 
	g´evIÆšeHasLšeBox
 = 
toR’d”IÆše
(
šlšeCÚtšu©iÚ
()->
node
()->
»nd””
())->
fœ¡LšeBox
();

5106 
	gtİM¬gš
 = 
´evIÆšeHasLšeBox
 ? 
cŞÏp£dM¬gšTİ
() : 0;

5107 
	gbÙtomM¬gš
 = 
ÃxtIÆšeHasLšeBox
 ? 
cŞÏp£dM¬gšBÙtom
() : 0;

5108 
IÁReù
 
»ù
(
tx
, 
ty
 - 
tİM¬gš
, 
width
(), 
height
(è+İM¬gš + 
bÙtomM¬gš
);

5109 ià(!
	g»ù
.
isEm±y
())

5110 
	g»ùs
.
­³nd
(
»ù
);

5111 } ià(
width
(è&& 
height
())

5112 
	g»ùs
.
­³nd
(
IÁReù
(
tx
, 
ty
, 
width
(), 
height
()));

5114 ià(!
hasOv”æowCl
(è&& !
hasCÚŒŞCl
()) {

5115 
RoÙIÆšeBox
* 
	gcu¼
 = 
fœ¡RoÙBox
(); cu¼; cu¼ = 
cu¼
->
ÃxtRoÙBox
()) {

5116 
tİ
 = 
max
(
cu¼
->
lšeTİ
(), cu¼->
y
());

5117 
	gbÙtom
 = 
mš
(
cu¼
->
lšeBÙtom
(), cu¼->
y
(è+ cu¼->
height
());

5118 
IÁReù
 
»ù
(
tx
 + 
cu¼
->
x
(), 
ty
 + 
tİ
, cu¼->
width
(), 
bÙtom
 -op);

5119 ià(!
	g»ù
.
isEm±y
())

5120 
	g»ùs
.
­³nd
(
»ù
);

5123 
R’d”Objeù
* 
	gcu¼
 = 
fœ¡Chd
(); cu¼; cu¼ = 
cu¼
->
ÃxtSiblšg
()) {

5124 ià(!
cu¼
->
isText
(è&& !cu¼->
isLi¡M¬k”
(è&& cu¼->
isBox
()) {

5125 
R’d”Box
* 
box
 = 
toR’d”Box
(
cu¼
);

5126 
FlßtPošt
 
	gpos
;

5128 ià(
	gbox
->
Ïy”
())

5129 
	gpos
 = 
cu¼
->
loÿlToAbsŞu‹
();

5131 
	gpos
 = 
FlßtPošt
(
tx
 + 
box
->
x
(), 
ty
 + box->
y
());

5132 
	gbox
->
addFocusRšgReùs
(
»ùs
, 
pos
.
x
(),…os.
y
());

5137 ià(
šlšeCÚtšu©iÚ
())

5138 
šlšeCÚtšu©iÚ
()->
addFocusRšgReùs
(
»ùs
,

5139 
tx
 - 
x
(è+ 
šlšeCÚtšu©iÚ
()->
cÚššgBlock
()->x(),

5140 
ty
 - 
y
(è+ 
šlšeCÚtšu©iÚ
()->
cÚššgBlock
()->y());

5143 
R’d”Block
* 
	gR’d”Block
::
ü—‹AnÚymousBlock
(
boŞ
 
isFËxibËBox
) const

5145 
RefPŒ
<
R’d”StyË
> 
ÃwStyË
 = R’d”StyË::
ü—‹
();

5146 
	gÃwStyË
->
šh”™From
(
¡yË
());

5148 
R’d”Block
* 
	gÃwBox
 = 0;

5149 ià(
	gisFËxibËBox
) {

5150 
	gÃwStyË
->
£tDi¥Ïy
(
BOX
);

5151 
	gÃwBox
 = 
Ãw
 (
»nd”A»Ç
()è
R’d”FËxibËBox
(
docum’t
() );

5153 
	gÃwStyË
->
£tDi¥Ïy
(
BLOCK
);

5154 
	gÃwBox
 = 
Ãw
 (
»nd”A»Ç
()è
R’d”Block
(
docum’t
() );

5157 
	gÃwBox
->
£tStyË
(
ÃwStyË
.
»Ëa£
());

5158  
	gÃwBox
;

5161 cÚ¡ * 
	gR’d”Block
::
»nd”Name
() const

5163 ià(
isBody
())

5166 ià(
isFlßtšg
())

5168 ià(
isPos™iÚed
())

5170 ià(
isAnÚymousBlock
())

5172 ià(
isAnÚymous
())

5174 ià(
isR–Pos™iÚed
())

5176 ià(
isRunIn
())

	@RenderBlock.h

23 #iâdeà
R’d”Block_h


24 
	#R’d”Block_h


	)

26 
	~"D•»ÿ‹dPŒLi¡.h
"

27 
	~"G­Reùs.h
"

28 
	~"R’d”Box.h
"

29 
	~"R’d”LšeBoxLi¡.h
"

30 
	~"RoÙIÆšeBox.h
"

31 
	~<wtf/Li¡HashS‘.h
>

33 
Çme¥aû
 
	gWebCÜe
 {

35 
şass
 
	gIÆšeI‹¿tÜ
;

36 
şass
 
	gR’d”IÆše
;

38 
	gBidiRun
;

40 
	g‹m¶©e
 <
şass
 
	gI‹¿tÜ
, cÏs 
	gRun
> cÏs 
	gBidiResŞv”
;

41 
	g‹m¶©e
 <
şass
 
	gI‹¿tÜ
> cÏs 
	gMidpoštS‹
;

42 
	gBidiResŞv”
<
	tIÆšeI‹¿tÜ
, 
	tBidiRun
> 
	tIÆšeBidiResŞv”
;

43 
	gMidpoštS‹
<
	tIÆšeI‹¿tÜ
> 
	tLšeMidpoštS‹
;

45 
	eC¬‘Ty³
 { 
	gCursÜC¬‘
, 
	gD¿gC¬‘
 };

47 şas 
	cR’d”Block
 : 
public
 
R’d”Box
 {

48 
public
:

49 
R’d”Block
(
Node
*);

50 
	gvœtu®
 ~
R’d”Block
();

52 cÚ¡ 
R’d”ObjeùChdLi¡
* 
chd»n
(ècÚ¡ {  &
	gm_chd»n
; }

53 
R’d”ObjeùChdLi¡
* 
chd»n
(è{  &
	gm_chd»n
; }

55 
vœtu®
 
de¡roy
();

58 
vœtu®
 
lšeHeight
(
boŞ
 
fœ¡Lše
, boŞ 
isRoÙLšeBox
 = 
çl£
) const;

59 
vœtu®
 
ba£lšePos™iÚ
(
boŞ
 
fœ¡Lše
, boŞ 
isRoÙLšeBox
 = 
çl£
) const;

61 
R’d”LšeBoxLi¡
* 
lšeBoxes
(è{  &
	gm_lšeBoxes
; }

62 cÚ¡ 
R’d”LšeBoxLi¡
* 
lšeBoxes
(ècÚ¡ {  &
	gm_lšeBoxes
; }

64 
IÆšeFlowBox
* 
fœ¡LšeBox
(ècÚ¡ {  
	gm_lšeBoxes
.firstLineBox(); }

65 
IÆšeFlowBox
* 
Ï¡LšeBox
(ècÚ¡ {  
	gm_lšeBoxes
.lastLineBox(); }

67 
d–‘eLšeBoxT»e
();

69 
vœtu®
 
addChd
(
R’d”Objeù
* 
ÃwChd
, R’d”Objeù* 
befÜeChd
 = 0);

70 
vœtu®
 
»moveChd
(
R’d”Objeù
*);

72 
vœtu®
 
ÏyoutBlock
(
boŞ
 
»ÏyoutChd»n
);

74 
š£¹Pos™iÚedObjeù
(
R’d”Box
*);

75 
»movePos™iÚedObjeù
(
R’d”Box
*);

76 
»movePos™iÚedObjeùs
(
R’d”Block
*);

77 
	gLi¡HashS‘
<
	gR’d”Box
*>* 
pos™iÚedObjeùs
(ècÚ¡ {  
	gm_pos™iÚedObjeùs
; }

79 
addP”ûÁHeightDesûndªt
(
R’d”Box
*);

80 
»moveP”ûÁHeightDesûndªt
(
R’d”Box
*);

81 
	gHashS‘
<
	gR’d”Box
*>* 
³rûÁHeightDesûndªts
() const;

83 
RoÙIÆšeBox
* 
ü—‹AndAµ’dRoÙIÆšeBox
();

85 
boŞ
 
g’”©esLšeBoxesFÜIÆšeChd
(
R’d”Objeù
*, boŞ 
isLšeEm±y
 = 
Œue
, boŞ 
´eviousLšeBrokeCËªly
 =rue);

87 
m¬kAÎDesûndªtsW™hFlßtsFÜLayout
(
R’d”Box
* 
æßtToRemove
 = 0, 
boŞ
 
šLayout
 = 
Œue
);

88 
m¬kPos™iÚedObjeùsFÜLayout
();

90 
boŞ
 
cÚšsFlßts
(è{  
	gm_æßtšgObjeùs
 && !m_æßtšgObjeùs->
isEm±y
(); }

91 
boŞ
 
cÚšsFlßt
(
R’d”Objeù
*);

93 
lšeWidth
(
y
, 
boŞ
 
fœ¡Lše
) const;

95 
vœtu®
 
lowe¡Pos™iÚ
(
boŞ
 
šşudeOv”æowIÁ”iÜ
 = 
Œue
, boŞ 
šşudeS–f
 =rue) const;

96 
vœtu®
 
rightmo¡Pos™iÚ
(
boŞ
 
šşudeOv”æowIÁ”iÜ
 = 
Œue
, boŞ 
šşudeS–f
 =rue) const;

97 
vœtu®
 
Ëámo¡Pos™iÚ
(
boŞ
 
šşudeOv”æowIÁ”iÜ
 = 
Œue
, boŞ 
šşudeS–f
 =rue) const;

99 
rightOff£t
(
y
, 
boŞ
 
fœ¡Lše
ècÚ¡ {  
rightR–Off£t
(y,„ightOffset(), firstLine); }

100 
ËáOff£t
(
y
, 
boŞ
 
fœ¡Lše
ècÚ¡ {  
ËáR–Off£t
(y,†eftOffset(), firstLine); }

102 
vœtu®
 
VisibËPos™iÚ
 
pos™iÚFÜPošt
(cÚ¡ 
IÁPošt
&);

105 
vœtu®
 
avaabËWidth
() const;

107 
RoÙIÆšeBox
* 
fœ¡RoÙBox
(ècÚ¡ {  
	g¡©ic_ÿ¡
<
	gRoÙIÆšeBox
*>(
fœ¡LšeBox
()); }

108 
RoÙIÆšeBox
* 
Ï¡RoÙBox
(ècÚ¡ {  
	g¡©ic_ÿ¡
<
	gRoÙIÆšeBox
*>(
Ï¡LšeBox
()); }

110 
boŞ
 
cÚšsNÚZ”oBidiLev–
() const;

112 
vœtu®
 
£tS–eùiÚS‹
(
S–eùiÚS‹
 
s
);

114 
G­Reùs
 
£ËùiÚG­ReùsFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
);

115 
IÁReù
 
flLeáS–eùiÚG­
(
R’d”Objeù
* 
£lObj
, 
xPos
, 
yPos
, 
height
, 
R’d”Block
* 
roÙBlock
,

116 
blockX
, 
blockY
, 
tx
, 
ty
, cÚ¡ 
PaštInfo
*);

117 
IÁReù
 
flRightS–eùiÚG­
(
R’d”Objeù
* 
£lObj
, 
xPos
, 
yPos
, 
height
, 
R’d”Block
* 
roÙBlock
,

118 
blockX
, 
blockY
, 
tx
, 
ty
, cÚ¡ 
PaštInfo
*);

119 
IÁReù
 
flHÜizÚlS–eùiÚG­
(
R’d”Objeù
* 
£lObj
, 
xPos
, 
yPos
, 
width
, 
height
, cÚ¡ 
PaštInfo
*);

121 
g‘HÜizÚlS–eùiÚG­Info
(
S–eùiÚS‹
, 
boŞ
& 
ËáG­
, boŞ& 
rightG­
);

124 
RoÙIÆšeBox
* 
lšeAtIndex
();

125 
lšeCouÁ
();

126 
heightFÜLšeCouÁ
();

127 
ş—rTrunÿtiÚ
();

129 
adju¡ReùFÜCŞumns
(
IÁReù
&) const;

130 
vœtu®
 
adju¡FÜCŞumns
(
IÁSize
&, cÚ¡ 
IÁPošt
&) const;

132 
addCÚtšu©iÚW™hOuše
(
R’d”IÆše
*);

134 
R’d”IÆše
* 
šlšeCÚtšu©iÚ
(ècÚ¡ {  
	gm_šlšeCÚtšu©iÚ
; }

135 
£tIÆšeCÚtšu©iÚ
(
R’d”IÆše
* 
c
è{ 
	gm_šlšeCÚtšu©iÚ
 = c; }

139 
R’d”Block
* 
ü—‹AnÚymousBlock
(
boŞ
 
isFËxibËBox
 = 
çl£
) const;

141 
­³ndRunsFÜObjeù
(
¡¬t
, 
’d
, 
R’d”Objeù
*, 
IÆšeBidiResŞv”
&);

142 
boŞ
 
»quœesLšeBox
(cÚ¡ 
IÆšeI‹¿tÜ
&, boŞ 
isLšeEm±y
 = 
Œue
, boŞ 
´eviousLšeBrokeCËªly
 =rue);

144 
	g´Ùeùed
:

145 
moveChdTo
(
R’d”Objeù
* 
to
, 
R’d”ObjeùChdLi¡
* 
toChdLi¡
, R’d”Objeù* 
chd
);

146 
moveChdTo
(
R’d”Objeù
* 
to
, 
R’d”ObjeùChdLi¡
* 
toChdLi¡
, R’d”Objeù* 
befÜeChd
, R’d”Objeù* 
chd
);

147 
moveAÎChd»nTo
(
R’d”Objeù
* 
to
, 
R’d”ObjeùChdLi¡
* 
toChdLi¡
);

148 
moveAÎChd»nTo
(
R’d”Objeù
* 
to
, 
R’d”ObjeùChdLi¡
* 
toChdLi¡
, R’d”Objeù* 
befÜeChd
);

150 
maxTİPosM¬gš
(ècÚ¡ {  
	gm_maxM¬gš
 ? m_maxM¬gš->
	gm_tİPos
 : 
MaxM¬gš
::
tİPosDeçuÉ
(
this
); }

151 
maxTİNegM¬gš
(ècÚ¡ {  
	gm_maxM¬gš
 ? m_maxM¬gš->
	gm_tİNeg
 : 
MaxM¬gš
::
tİNegDeçuÉ
(
this
); }

152 
maxBÙtomPosM¬gš
(ècÚ¡ {  
	gm_maxM¬gš
 ? m_maxM¬gš->
	gm_bÙtomPos
 : 
MaxM¬gš
::
bÙtomPosDeçuÉ
(
this
); }

153 
maxBÙtomNegM¬gš
(ècÚ¡ {  
	gm_maxM¬gš
 ? m_maxM¬gš->
	gm_bÙtomNeg
 : 
MaxM¬gš
::
bÙtomNegDeçuÉ
(
this
); }

154 
£tMaxTİM¬gšs
(
pos
, 
Ãg
);

155 
£tMaxBÙtomM¬gšs
(
pos
, 
Ãg
);

157 
š™MaxM¬gšV®ues
()

159 ià(
	gm_maxM¬gš
) {

160 
	gm_maxM¬gš
->
	gm_tİPos
 = 
MaxM¬gš
::
tİPosDeçuÉ
(
this
);

161 
	gm_maxM¬gš
->
	gm_tİNeg
 = 
MaxM¬gš
::
tİNegDeçuÉ
(
this
);

162 
	gm_maxM¬gš
->
	gm_bÙtomPos
 = 
MaxM¬gš
::
bÙtomPosDeçuÉ
(
this
);

163 
	gm_maxM¬gš
->
	gm_bÙtomNeg
 = 
MaxM¬gš
::
bÙtomNegDeçuÉ
(
this
);

167 
vœtu®
 
Ïyout
();

169 
ÏyoutPos™iÚedObjeùs
(
boŞ
 
»ÏyoutChd»n
);

171 
vœtu®
 
·št
(
PaštInfo
&, 
tx
, 
ty
);

172 
vœtu®
 
·štObjeù
(
PaštInfo
&, 
tx
, 
ty
);

174 
rightR–Off£t
(
y
, 
fixedOff£t
, 
boŞ
 
­¶yTextInd’t
 = 
Œue
, * 
heightRemaššg
 = 0) const;

175 
ËáR–Off£t
(
y
, 
fixedOff£t
, 
boŞ
 
­¶yTextInd’t
 = 
Œue
, * 
heightRemaššg
 = 0) const;

177 
vœtu®
 
boŞ
 
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, 
x
, 
y
, 
tx
, 
ty
, 
H™Te¡AùiÚ
);

179 
vœtu®
 
ÿlcP»fWidths
();

181 
vœtu®
 
fœ¡LšeBoxBa£lše
() const;

182 
vœtu®
 
Ï¡LšeBoxBa£lše
() const;

184 
vœtu®
 
upd©eFœ¡L‘‹r
();

186 
vœtu®
 
upd©eH™Te¡ResuÉ
(
H™Te¡ResuÉ
&, cÚ¡ 
IÁPošt
&);

193 
¡¬tD–ayUpd©eSüŞlInfo
();

194 
fšishD–ayUpd©eSüŞlInfo
();

196 
vœtu®
 
¡yËWlChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
* 
ÃwStyË
);

197 
vœtu®
 
¡yËDidChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
);

199 
vœtu®
 
boŞ
 
hasLšeIfEm±y
() const;

200 
boŞ
 
ÏyoutOÆyPos™iÚedObjeùs
();

202 
	g´iv©e
:

203 
vœtu®
 
R’d”ObjeùChdLi¡
* 
vœtu®Chd»n
(è{  
chd»n
(); }

204 
vœtu®
 cÚ¡ 
R’d”ObjeùChdLi¡
* 
vœtu®Chd»n
(ècÚ¡ {  
chd»n
(); }

206 
vœtu®
 cÚ¡ * 
»nd”Name
() const;

208 
vœtu®
 
boŞ
 
isR’d”Block
(ècÚ¡ {  
	gŒue
; }

209 
vœtu®
 
boŞ
 
isBlockFlow
(ècÚ¡ {  (!
isIÆše
(è|| 
isR•Ïûd
()è&& !
isTabË
(); }

210 
vœtu®
 
boŞ
 
isIÆšeBlockOrIÆšeTabË
(ècÚ¡ {  
isIÆše
(è&& 
isR•Ïûd
(); }

212 
makeChd»nNÚIÆše
(
R’d”Objeù
* 
š£¹iÚPošt
 = 0);

213 
vœtu®
 
»moveLeáov”AnÚymousBlock
(
R’d”Block
* 
chd
);

215 
vœtu®
 
dœtyLšesFromChªgedChd
(
R’d”Objeù
* 
chd
è{ 
	gm_lšeBoxes
.dœtyLšesFromChªgedChd(
this
, child); }

217 
vœtu®
 
boŞ
 
isS–fCŞÏpsšgBlock
() const;

219 
vœtu®
 
maxTİM¬gš
(
boŞ
 
pos™ive
ècÚ¡ {  
	gpos™ive
 ? 
maxTİPosM¬gš
(è: 
maxTİNegM¬gš
(); }

220 
vœtu®
 
maxBÙtomM¬gš
(
boŞ
 
pos™ive
ècÚ¡ {  
	gpos™ive
 ? 
maxBÙtomPosM¬gš
(è: 
maxBÙtomNegM¬gš
(); }

222 
vœtu®
 
»·štOv”hªgšgFlßts
(
boŞ
 
·štAÎDesûndªts
);

224 
ÏyoutBlockChd»n
(
boŞ
 
»ÏyoutChd»n
, & 
maxFlßtBÙtom
);

225 
ÏyoutIÆšeChd»n
(
boŞ
 
»ÏyoutChd»n
, & 
»·štTİ
, & 
»·štBÙtom
);

227 
vœtu®
 
pos™iÚLi¡M¬k”
() { }

229 
vœtu®
 
bÜd”F™Adju¡
(& 
x
, & 
w
) const;

231 
vœtu®
 
upd©eBefÜeAá”CÚ‹Á
(
P£udoId
);

233 
vœtu®
 
RoÙIÆšeBox
* 
ü—‹RoÙIÆšeBox
();

236 
vœtu®
 
R’d”Objeù
* 
ÏyoutLeg’d
(
boŞ
 ) {  0; }

238 
	sFlßtW™hReù
 {

239 
FlßtW™hReù
(
R’d”Box
* 
f
)

240 : 
objeù
(
f
)

241 , 
»ù
(
IÁReù
(
f
->
x
(è- f->
m¬gšLeá
(), f->
y
(è- f->
m¬gšTİ
(), f->
width
(è+ f->m¬gšLeá(è+ f->
m¬gšRight
(), f->
height
(è+ f->m¬gšTİ(è+ f->
m¬gšBÙtom
()))

242 , 
ev”HadLayout
(
f
->
m_ev”HadLayout
)

246 
R’d”Box
* 
	gobjeù
;

247 
IÁReù
 
	g»ù
;

248 
boŞ
 
	gev”HadLayout
;

252 
bidiReÜd”Lše
(
IÆšeBidiResŞv”
&, cÚ¡ 
IÆšeI‹¿tÜ
& 
’d
, 
boŞ
 
´eviousLšeBrokeCËªly
);

253 
RoÙIÆšeBox
* 
d‘”mšeS¹Pos™iÚ
(
boŞ
& 
fœ¡Lše
, boŞ& 
fuÎLayout
, boŞ& 
´eviousLšeBrokeCËªly
,

254 
IÆšeBidiResŞv”
&, 
VeùÜ
<
FlßtW™hReù
>& 
æßts
, & 
numCËªFlßts
);

255 
RoÙIÆšeBox
* 
d‘”mšeEndPos™iÚ
(RoÙIÆšeBox* 
¡¬tBox
, 
IÆšeI‹¿tÜ
& 
ş—nLšeS¹
,

256 
BidiStus
& 
ş—nLšeBidiStus
,

257 & 
yPos
);

258 
boŞ
 
m©chedEndLše
(cÚ¡ 
IÆšeBidiResŞv”
&, cÚ¡ 
IÆšeI‹¿tÜ
& 
’dLšeS¹
, cÚ¡ 
BidiStus
& 
’dLšeStus
,

259 
RoÙIÆšeBox
*& 
’dLše
, & 
’dYPos
, & 
»·štBÙtom
, & 
»·štTİ
);

261 
skT¿šgWh™e¥aû
(
IÆšeI‹¿tÜ
&, 
boŞ
 
isLšeEm±y
, boŞ 
´eviousLšeBrokeCËªly
);

262 
skL—dšgWh™e¥aû
(
IÆšeBidiResŞv”
&, 
boŞ
 
fœ¡Lše
, boŞ 
isLšeEm±y
, boŞ 
´eviousLšeBrokeCËªly
);

263 
f™B–owFlßts
(
widthToF™
, 
boŞ
 
fœ¡Lše
, & 
avaabËWidth
);

264 
IÆšeI‹¿tÜ
 
fšdNextLšeB»ak
(
IÆšeBidiResŞv”
&, 
boŞ
 
fœ¡Lše
, boŞ& 
isLšeEm±y
, boŞ& 
´eviousLšeBrokeCËªly
, 
ECË¬
* 
ş—r
 = 0);

265 
RoÙIÆšeBox
* 
cÚ¡ruùLše
(
runCouÁ
, 
BidiRun
* 
fœ¡Run
, BidiRun* 
Ï¡Run
, 
boŞ
 
fœ¡Lše
, boŞ 
Ï¡Lše
, 
R’d”Objeù
* 
’dObjeù
);

266 
IÆšeFlowBox
* 
ü—‹LšeBoxes
(
R’d”Objeù
*, 
boŞ
 
fœ¡Lše
);

267 
compu‹HÜizÚlPos™iÚsFÜLše
(
RoÙIÆšeBox
*, 
boŞ
 
fœ¡Lše
, 
BidiRun
* 
fœ¡Run
, BidiRun* 
ŒašgS·ûRun
, boŞ 
»achedEnd
);

268 
compu‹V”tiÿlPos™iÚsFÜLše
(
RoÙIÆšeBox
*, 
BidiRun
*);

269 
d–‘eEÎsisLšeBoxes
();

270 
checkLšesFÜTextOv”æow
();

271 
addOv”æowFromIÆšeChd»n
();

274 
addOv”æowFromBlockChd»n
();

275 
addOv”æowFromFlßts
();

277 
·štFlßts
(
PaštInfo
&, 
tx
, 
ty
, 
boŞ
 
´e£rvePha£
 = 
çl£
);

278 
·štCÚ‹Ás
(
PaštInfo
&, 
tx
, 
ty
);

279 
·štCŞumnCÚ‹Ás
(
PaštInfo
&, 
tx
, 
ty
, 
boŞ
 
·štFlßts
 = 
çl£
);

280 
·štCŞumnRuËs
(
PaštInfo
&, 
tx
, 
ty
);

281 
·štChd»n
(
PaštInfo
&, 
tx
, 
ty
);

282 
·štEÎsisBoxes
(
PaštInfo
&, 
tx
, 
ty
);

283 
·štS–eùiÚ
(
PaštInfo
&, 
tx
, 
ty
);

284 
·štC¬‘
(
PaštInfo
&, 
tx
, 
ty
, 
C¬‘Ty³
);

286 
š£¹FlßtšgObjeù
(
R’d”Box
*);

287 
»moveFlßtšgObjeù
(
R’d”Box
*);

291 
boŞ
 
pos™iÚNewFlßts
();

292 
ş—rFlßts
();

293 
g‘CË¬D–
(
R’d”Box
* 
chd
, 
yPos
);

295 
vœtu®
 
boŞ
 
avoidsFlßts
() const;

297 
boŞ
 
hasOv”hªgšgFlßts
(è{  
·»Á
(è&& !
hasCŞumns
(è&& 
æßtBÙtom
(è> 
height
(); }

298 
addIÁrudšgFlßts
(
R’d”Block
* 
´ev
, 
xoff£t
, 
yoff£t
);

299 
addOv”hªgšgFlßts
(
R’d”Block
* 
chd
, 
xoff£t
, 
yoff£t
, 
boŞ
 
makeChdPaštOth”Flßts
);

301 
ÃxtFlßtBÙtomB–ow
() const;

302 
æßtBÙtom
() const;

303 
šlše
 
ËáBÙtom
();

304 
šlše
 
rightBÙtom
();

306 
rightOff£t
() const;

307 
ËáOff£t
() const;

308 
vœtu®
 
boŞ
 
h™Te¡CŞumns
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, 
x
, 
y
, 
tx
, 
ty
, 
H™Te¡AùiÚ
);

309 
vœtu®
 
boŞ
 
h™Te¡CÚ‹Ás
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, 
x
, 
y
, 
tx
, 
ty
, 
H™Te¡AùiÚ
);

311 
vœtu®
 
boŞ
 
isPoštInOv”æowCÚŒŞ
(
H™Te¡ResuÉ
&, 
x
, 
y
, 
tx
, 
ty
);

313 
ÿlcIÆšeP»fWidths
();

314 
ÿlcBlockP»fWidths
();

318 
vœtu®
 
R’d”Block
* 
fœ¡LšeBlock
() const;

320 
vœtu®
 
IÁReù
 
»ùW™hOušeFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
oušeWidth
);

321 
vœtu®
 
R’d”StyË
* 
oušeStyËFÜR•ašt
() const;

323 
vœtu®
 
R’d”Objeù
* 
hov”Anû¡Ü
() const;

324 
vœtu®
 
upd©eD¿gS‹
(
boŞ
 
d¿gOn
);

325 
vœtu®
 
chdBeÿmeNÚIÆše
(
R’d”Objeù
* 
chd
);

327 
vœtu®
 
IÁReù
 
£ËùiÚReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
boŞ
 )

329  
£ËùiÚG­ReùsFÜR•ašt
(
»·štCÚš”
);

331 
vœtu®
 
boŞ
 
shouldPaštS–eùiÚG­s
() const;

332 
boŞ
 
isS–eùiÚRoÙ
() const;

333 
G­Reùs
 
flS–eùiÚG­s
(
R’d”Block
* 
roÙBlock
, 
blockX
, 
blockY
, 
tx
, 
ty
,

334 & 
Ï¡Tİ
, & 
Ï¡Leá
, & 
Ï¡Right
, cÚ¡ 
PaštInfo
* = 0);

335 
G­Reùs
 
flIÆšeS–eùiÚG­s
(
R’d”Block
* 
roÙBlock
, 
blockX
, 
blockY
, 
tx
, 
ty
,

336 & 
Ï¡Tİ
, & 
Ï¡Leá
, & 
Ï¡Right
, cÚ¡ 
PaštInfo
*);

337 
G­Reùs
 
flBlockS–eùiÚG­s
(
R’d”Block
* 
roÙBlock
, 
blockX
, 
blockY
, 
tx
, 
ty
,

338 & 
Ï¡Tİ
, & 
Ï¡Leá
, & 
Ï¡Right
, cÚ¡ 
PaštInfo
*);

339 
IÁReù
 
flV”tiÿlS–eùiÚG­
(
Ï¡Tİ
, 
Ï¡Leá
, 
Ï¡Right
, 
bÙtomY
, 
R’d”Block
* 
roÙBlock
,

340 
blockX
, 
blockY
, cÚ¡ 
PaštInfo
*);

341 
ËáS–eùiÚOff£t
(
R’d”Block
* 
roÙBlock
, 
y
);

342 
rightS–eùiÚOff£t
(
R’d”Block
* 
roÙBlock
, 
y
);

344 
vœtu®
 
absŞu‹Reùs
(
VeùÜ
<
IÁReù
>&, 
tx
, 
ty
);

345 
vœtu®
 
absŞu‹Quads
(
VeùÜ
<
FlßtQuad
>&);

347 
desœedCŞumnWidth
() const;

348 
desœedCŞumnCouÁ
() const;

349 
	gVeùÜ
<
	gIÁReù
>* 
cŞumnReùs
() const;

350 
£tDesœedCŞumnCouÁAndWidth
(
couÁ
, 
width
);

351 
cŞumnG­
() const;

353 
·štCÚtšu©iÚOušes
(
PaštInfo
&, 
tx
, 
ty
);

355 
vœtu®
 
IÁReù
 
loÿlC¬‘Reù
(
IÆšeBox
*, 
ÿ»tOff£t
, * 
exŒaWidthToEndOfLše
 = 0);

357 
vœtu®
 
addFocusRšgReùs
(
VeùÜ
<
IÁReù
>&, 
tx
, 
ty
);

359 
adju¡PoštToCŞumnCÚ‹Ás
(
IÁPošt
&) const;

360 
adju¡FÜBÜd”F™
(
x
, & 
Ëá
, & 
right
) const;

362 
m¬kLšesDœtyInV”tiÿlRªge
(
tİ
, 
bÙtom
, 
RoÙIÆšeBox
* 
highe¡
 = 0);

364 
ÃwLše
(
ECË¬
);

366 
Pos™iÚ
 
pos™iÚFÜBox
(
IÆšeBox
*, 
boŞ
 
¡¬t
 = 
Œue
) const;

367 
Pos™iÚ
 
pos™iÚFÜR’d””
(
R’d”Objeù
*, 
boŞ
 
¡¬t
 = 
Œue
) const;

368 
VisibËPos™iÚ
 
pos™iÚFÜPoštW™hIÆšeChd»n
(cÚ¡ 
IÁPošt
&);

371 
off£tFÜCÚ‹Ás
(& 
tx
, & 
ty
) const;

373 
ÿlcCŞumnWidth
();

374 
ÏyoutCŞumns
(
’dOfCÚ‹Á
 = -1, 
»que¡edCŞumnHeight
 = -1);

375 
visibËTİOfHighe¡FlßtEx‹ndšgB–ow
(
bÙtom
, 
maxHeight
) const;

377 
boŞ
 
ex·ndsToEnşo£Ov”hªgšgFlßts
() const;

379 
upd©eSüŞlInfoAá”Layout
();

381 
	gFlßtšgObjeù
 : 
NÚcİyabË
 {

382 
	eTy³
 {

383 
FlßtLeá
,

384 
	gFlßtRight


387 
FlßtšgObjeù
(
Ty³
 
ty³
)

388 : 
m_»nd””
(0)

389 , 
m_tİ
(0)

390 , 
m_bÙtom
(0)

391 , 
m_Ëá
(0)

392 , 
m_width
(0)

393 , 
m_ty³
(
ty³
)

394 , 
m_shouldPašt
(
Œue
)

395 , 
m_isDesûndªt
(
çl£
)

399 
Ty³
 
ty³
(è{  
	g¡©ic_ÿ¡
<
	gTy³
>(
	gm_ty³
); }

401 
R’d”Box
* 
	gm_»nd””
;

402 
	gm_tİ
;

403 
	gm_bÙtom
;

404 
	gm_Ëá
;

405 
	gm_width
;

406 
	gm_ty³
 : 1;

407 
boŞ
 
	gm_shouldPašt
 : 1;

408 
boŞ
 
	gm_isDesûndªt
 : 1;

411 şas 
	cM¬gšInfo
 {

413 
boŞ
 
	gm_ÿnCŞÏp£W™hChd»n
 : 1;

414 
boŞ
 
	gm_ÿnCŞÏp£TİW™hChd»n
 : 1;

415 
boŞ
 
	gm_ÿnCŞÏp£BÙtomW™hChd»n
 : 1;

420 
boŞ
 
	gm_quœkCÚš”
 : 1;

426 
boŞ
 
	gm_©TİOfBlock
 : 1;

429 
boŞ
 
	gm_©BÙtomOfBlock
 : 1;

433 
boŞ
 
	gm_tİQuœk
 : 1;

434 
boŞ
 
	gm_bÙtomQuœk
 : 1;

435 
boŞ
 
	gm_d‘”mšedTİQuœk
 : 1;

438 
	gm_posM¬gš
;

439 
	gm_ÃgM¬gš
;

441 
	gpublic
:

442 
M¬gšInfo
(
R’d”Block
* 
b
, 
tİ
, 
bÙtom
);

444 
£tAtTİOfBlock
(
boŞ
 
b
è{ 
	gm_©TİOfBlock
 = b; }

445 
£tAtBÙtomOfBlock
(
boŞ
 
b
è{ 
	gm_©BÙtomOfBlock
 = b; }

446 
ş—rM¬gš
(è{ 
	gm_posM¬gš
 = 
m_ÃgM¬gš
 = 0; }

447 
£tTİQuœk
(
boŞ
 
b
è{ 
	gm_tİQuœk
 = b; }

448 
£tBÙtomQuœk
(
boŞ
 
b
è{ 
	gm_bÙtomQuœk
 = b; }

449 
£tD‘”mšedTİQuœk
(
boŞ
 
b
è{ 
	gm_d‘”mšedTİQuœk
 = b; }

450 
£tPosM¬gš
(
p
è{ 
	gm_posM¬gš
 =…; }

451 
£tNegM¬gš
(
n
è{ 
	gm_ÃgM¬gš
 =‚; }

452 
£tPosM¬gšIfL¬g”
(
p
è{ ià(
	gp
 > 
	gm_posM¬gš
) m_posMargin =…; }

453 
£tNegM¬gšIfL¬g”
(
n
è{ ià(
	gn
 > 
	gm_ÃgM¬gš
) m_negMargin =‚; }

455 
£tM¬gš
(
p
, 
n
è{ 
	gm_posM¬gš
 =…; 
	gm_ÃgM¬gš
 =‚; }

457 
boŞ
 
©TİOfBlock
(ècÚ¡ {  
	gm_©TİOfBlock
; }

458 
boŞ
 
ÿnCŞÏp£W™hTİ
(ècÚ¡ {  
	gm_©TİOfBlock
 && 
	gm_ÿnCŞÏp£TİW™hChd»n
; }

459 
boŞ
 
ÿnCŞÏp£W™hBÙtom
(ècÚ¡ {  
	gm_©BÙtomOfBlock
 && 
	gm_ÿnCŞÏp£BÙtomW™hChd»n
; }

460 
boŞ
 
ÿnCŞÏp£TİW™hChd»n
(ècÚ¡ {  
	gm_ÿnCŞÏp£TİW™hChd»n
; }

461 
boŞ
 
ÿnCŞÏp£BÙtomW™hChd»n
(ècÚ¡ {  
	gm_ÿnCŞÏp£BÙtomW™hChd»n
; }

462 
boŞ
 
quœkCÚš”
(ècÚ¡ {  
	gm_quœkCÚš”
; }

463 
boŞ
 
d‘”mšedTİQuœk
(ècÚ¡ {  
	gm_d‘”mšedTİQuœk
; }

464 
boŞ
 
tİQuœk
(ècÚ¡ {  
	gm_tİQuœk
; }

465 
boŞ
 
bÙtomQuœk
(ècÚ¡ {  
	gm_bÙtomQuœk
; }

466 
posM¬gš
(ècÚ¡ {  
	gm_posM¬gš
; }

467 
ÃgM¬gš
(ècÚ¡ {  
	gm_ÃgM¬gš
; }

468 
m¬gš
(ècÚ¡ {  
	gm_posM¬gš
 - 
	gm_ÃgM¬gš
; }

471 
ÏyoutBlockChd
(
R’d”Box
* 
chd
, 
M¬gšInfo
&, & 
´eviousFlßtBÙtom
, & 
maxFlßtBÙtom
);

472 
adju¡Pos™iÚedBlock
(
R’d”Box
* 
chd
, cÚ¡ 
M¬gšInfo
&);

473 
adju¡FlßtšgBlock
(cÚ¡ 
M¬gšInfo
&);

474 
boŞ
 
hªdËS³cŸlChd
(
R’d”Box
* 
chd
, cÚ¡ 
M¬gšInfo
&);

475 
boŞ
 
hªdËFlßtšgChd
(
R’d”Box
* 
chd
, cÚ¡ 
M¬gšInfo
&);

476 
boŞ
 
hªdËPos™iÚedChd
(
R’d”Box
* 
chd
, cÚ¡ 
M¬gšInfo
&);

477 
boŞ
 
hªdËRunInChd
(
R’d”Box
* 
chd
);

478 
cŞÏp£M¬gšs
(
R’d”Box
* 
chd
, 
M¬gšInfo
&);

479 
ş—rFlßtsIfN“ded
(
R’d”Box
* 
chd
, 
M¬gšInfo
&, 
ŞdTİPosM¬gš
, 
ŞdTİNegM¬gš
, 
yPos
);

480 
e¡im©eV”tiÿlPos™iÚ
(
R’d”Box
* 
chd
, cÚ¡ 
M¬gšInfo
&);

481 
d‘”mšeHÜizÚlPos™iÚ
(
R’d”Box
* 
chd
);

482 
hªdËBÙtomOfBlock
(
tİ
, 
bÙtom
, 
M¬gšInfo
&);

483 
£tCŞÏp£dBÙtomM¬gš
(cÚ¡ 
M¬gšInfo
&);

486 
	gLi¡HashS‘
<
	tR’d”Box
*>::
	tcÚ¡_™”©Ü
 
	tI‹¿tÜ
;

487 
	gD•»ÿ‹dPŒLi¡
<
	gFlßtšgObjeù
>* 
	gm_æßtšgObjeùs
;

488 
	gLi¡HashS‘
<
	gR’d”Box
*>* 
	gm_pos™iÚedObjeùs
;

494 
R’d”IÆše
* 
	gm_šlšeCÚtšu©iÚ
;

497 
	gMaxM¬gš
 : 
NÚcİyabË
 {

498 
MaxM¬gš
(cÚ¡ 
R’d”Block
* 
o
)

499 : 
m_tİPos
(
tİPosDeçuÉ
(
o
))

500 , 
m_tİNeg
(
tİNegDeçuÉ
(
o
))

501 , 
m_bÙtomPos
(
bÙtomPosDeçuÉ
(
o
))

502 , 
m_bÙtomNeg
(
bÙtomNegDeçuÉ
(
o
))

506 
tİPosDeçuÉ
(cÚ¡ 
R’d”Block
* 
o
è{  
	go
->
m¬gšTİ
() > 0 ? o->marginTop() : 0; }

507 
tİNegDeçuÉ
(cÚ¡ 
R’d”Block
* 
o
è{  
	go
->
m¬gšTİ
() < 0 ? -o->marginTop() : 0; }

508 
bÙtomPosDeçuÉ
(cÚ¡ 
R’d”Block
* 
o
è{  
	go
->
m¬gšBÙtom
() > 0 ? o->marginBottom() : 0; }

509 
bÙtomNegDeçuÉ
(cÚ¡ 
R’d”Block
* 
o
è{  
	go
->
m¬gšBÙtom
() < 0 ? -o->marginBottom() : 0; }

511 
	gm_tİPos
;

512 
	gm_tİNeg
;

513 
	gm_bÙtomPos
;

514 
	gm_bÙtomNeg
;

517 
MaxM¬gš
* 
	gm_maxM¬gš
;

519 
R’d”ObjeùChdLi¡
 
	gm_chd»n
;

520 
R’d”LšeBoxLi¡
 
	gm_lšeBoxes
;

522 
mubË
 
	gm_lšeHeight
;

526 
ä›nd
 
şass
 
	gR’d”RubyBa£
;

529 
šlše
 
R’d”Block
* 
	$toR’d”Block
(
R’d”Objeù
* 
objeù
)

531 
	`ASSERT
(!
objeù
 || objeù->
	`isR’d”Block
());

532  
¡©ic_ÿ¡
<
R’d”Block
*>(
objeù
);

533 
	}
}

535 
šlše
 cÚ¡ 
R’d”Block
* 
	$toR’d”Block
(cÚ¡ 
R’d”Objeù
* 
objeù
)

537 
	`ASSERT
(!
objeù
 || objeù->
	`isR’d”Block
());

538  
¡©ic_ÿ¡
<cÚ¡ 
R’d”Block
*>(
objeù
);

539 
	}
}

542 
toR’d”Block
(cÚ¡ 
R’d”Block
*);

	@RenderBlockLineLayout.cpp

23 
	~"cÚfig.h
"

25 
	~"BidiResŞv”.h
"

26 
	~"Ch¬aù”Names.h
"

27 
	~"IÆšeI‹¿tÜ.h
"

28 
	~"IÆšeTextBox.h
"

29 
	~"Loggšg.h
"

30 
	~"R’d”A»Ç.h
"

31 
	~"R’d”IÆše.h
"

32 
	~"R’d”Li¡M¬k”.h
"

33 
	~"R’d”V›w.h
"

34 
	~"T¿šgFlßtsRoÙIÆšeBox.h
"

35 
	~"b»ak_lšes.h
"

36 
	~<wtf/AlwaysIÆše.h
>

37 
	~<wtf/RefCouÁedL—kCouÁ”.h
>

38 
	~<wtf/StdLibExŒas.h
>

39 
	~<wtf/VeùÜ.h
>

41 
usšg
 
Çme¥aû
 
	g¡d
;

42 
usšg
 
Çme¥aû
 
	gWTF
;

43 
usšg
 
Çme¥aû
 
	gUnicode
;

45 
Çme¥aû
 
	gWebCÜe
 {

48 cÚ¡ 
	gcMaxLšeD•th
 = 200;

50 
g‘BÜd”PaddšgM¬gš
(
R’d”BoxMod–Objeù
* 
chd
, 
boŞ
 
’dOfIÆše
)

52 
boŞ
 
	gËáSide
 = (
chd
->
¡yË
()->
dœeùiÚ
(è=ğ
LTR
è? !
’dOfIÆše
 :ƒndOfInline;

53 ià(
	gËáSide
)

54  
	gchd
->
m¬gšLeá
(è+ chd->
·ddšgLeá
(è+ chd->
bÜd”Leá
();

55  
	gchd
->
m¬gšRight
(è+ chd->
·ddšgRight
(è+ chd->
bÜd”Right
();

58 
šlšeWidth
(
R’d”Objeù
* 
chd
, 
boŞ
 
¡¬t
 = 
Œue
, boŞ 
’d
 =rue)

60 
lšeD•th
 = 1;

61 
	gexŒaWidth
 = 0;

62 
R’d”Objeù
* 
	g·»Á
 = 
chd
->
·»Á
();

63 
	g·»Á
->
isIÆše
(è&& !·»Á->
isIÆšeBlockOrIÆšeTabË
(è&& 
	glšeD•th
++ < 
	gcMaxLšeD•th
) {

64 ià(
	g¡¬t
 && !
	gchd
->
´eviousSiblšg
())

65 
	gexŒaWidth
 +ğ
g‘BÜd”PaddšgM¬gš
(
toR’d”BoxMod–Objeù
(
·»Á
), 
çl£
);

66 ià(
	g’d
 && !
	gchd
->
ÃxtSiblšg
())

67 
	gexŒaWidth
 +ğ
g‘BÜd”PaddšgM¬gš
(
toR’d”BoxMod–Objeù
(
·»Á
), 
Œue
);

68 
	gchd
 = 
·»Á
;

69 
	g·»Á
 = 
chd
->
·»Á
();

71  
	gexŒaWidth
;

74 
chİMidpoštsAt
(
LšeMidpoštS‹
& 
lšeMidpoštS‹
, 
R’d”Objeù
* 
obj
, 
pos
)

76 ià(!
	glšeMidpoštS‹
.
	gnumMidpošts
)

78 
IÆšeI‹¿tÜ
* 
	gmidpošts
 = 
lšeMidpoštS‹
.
midpošts
.
d©a
();

79 
	gi
 = 
lšeMidpoštS‹
.
numMidpošts
 - 1; i >= 0; i--) {

80 cÚ¡ 
	gIÆšeI‹¿tÜ
& 
	gpošt
 = 
midpošts
[
i
];

81 ià(
	gpošt
.
	gobj
 =ğ
obj
 && 
pošt
.
pos
 ==…os) {

82 
lšeMidpoštS‹
.
numMidpošts
 = 
i
;

88 
checkMidpošts
(
LšeMidpoštS‹
& 
lšeMidpoštS‹
, 
IÆšeI‹¿tÜ
& 
lB»ak
)

93 ià(
	glB»ak
.
	gobj
 && 
	glšeMidpoštS‹
.
	gnumMidpošts
 && !(lineMidpointState.numMidpoints % 2)) {

94 
IÆšeI‹¿tÜ
* 
	gmidpošts
 = 
lšeMidpoštS‹
.
midpošts
.
d©a
();

95 
	gIÆšeI‹¿tÜ
& 
	g’dpošt
 = 
midpošts
[
lšeMidpoštS‹
.
numMidpošts
 - 2];

96 cÚ¡ 
	gIÆšeI‹¿tÜ
& 
	g¡¬ošt
 = 
midpošts
[
lšeMidpoštS‹
.
numMidpošts
 - 1];

97 
IÆšeI‹¿tÜ
 
	gcu¼pošt
 = 
’dpošt
;

98 !
	gcu¼pošt
.
©End
(è&& cu¼pošˆ!ğ
¡¬ošt
 && 
cu¼pošt
 !ğ
lB»ak
)

99 
cu¼pošt
.
šüem’t
();

100 ià(
	gcu¼pošt
 =ğ
lB»ak
) {

102 
lšeMidpoštS‹
.
numMidpošts
--;

103 ià(
	g’dpošt
.
	gobj
->
¡yË
()->
cŞÏp£Wh™eS·û
()) {

104 ià(
	g’dpošt
.
	gobj
->
isText
()) {

106 
R’d”Text
* 
	g‹xtObj
 = 
toR’d”Text
(
’dpošt
.
obj
);

107 ià(
	g’dpošt
.
	gpos
 + 1 < 
	g‹xtObj
->
‹xtL’gth
()) {

108 ià(
	g‹xtObj
->
ch¬aù”s
()[
’dpošt
.
pos
+1] =ğ
soáHyph’
)

110 } ià(
	g¡¬ošt
.
	gobj
->
isText
()) {

111 
R’d”Text
 *
	g¡¬tText
 = 
toR’d”Text
(
¡¬ošt
.
obj
);

112 ià(
	g¡¬tText
->
‹xtL’gth
(è&& s¹Text->
ch¬aù”s
()[0] =ğ
soáHyph’
)

116 
	g’dpošt
.
	gpos
--;

122 
addMidpošt
(
LšeMidpoštS‹
& 
lšeMidpoštS‹
, cÚ¡ 
IÆšeI‹¿tÜ
& 
midpošt
)

124 ià(
	glšeMidpoštS‹
.
	gmidpošts
.
size
(è<ğ
lšeMidpoštS‹
.
numMidpošts
)

125 
lšeMidpoštS‹
.
midpošts
.
grow
ÖšeMidpoštS‹.
numMidpošts
 + 10);

127 
IÆšeI‹¿tÜ
* 
	gmidpošts
 = 
lšeMidpoštS‹
.
midpošts
.
d©a
();

128 
	gmidpošts
[
lšeMidpoštS‹
.
numMidpošts
++] = 
midpošt
;

131 
	gR’d”Block
::
­³ndRunsFÜObjeù
(
¡¬t
, 
’d
, 
R’d”Objeù
* 
obj
, 
IÆšeBidiResŞv”
& 
»sŞv”
)

133 ià(
	g¡¬t
 > 
	g’d
 || 
	gobj
->
isFlßtšg
() ||

134 (
	gobj
->
isPos™iÚed
(è&& !obj->
¡yË
()->
hasSticX
(è&& !obj->¡yË()->
hasSticY
(è&& !obj->
cÚš”
()->
isR’d”IÆše
()))

137 
	gLšeMidpoštS‹
& 
	glšeMidpoštS‹
 = 
»sŞv”
.
midpoštS‹
();

138 
boŞ
 
	ghaveNextMidpošt
 = (
lšeMidpoštS‹
.
cu¼’tMidpošt
 <†šeMidpoštS‹.
numMidpošts
);

139 
IÆšeI‹¿tÜ
 
	gÃxtMidpošt
;

140 ià(
	ghaveNextMidpošt
)

141 
	gÃxtMidpošt
 = 
lšeMidpoštS‹
.
midpošts
[lšeMidpoštS‹.
cu¼’tMidpošt
];

142 ià(
	glšeMidpoštS‹
.
	gb‘w“nMidpošts
) {

143 ià(!(
	ghaveNextMidpošt
 && 
	gÃxtMidpošt
.
	gobj
 =ğ
obj
))

147 
	glšeMidpoštS‹
.
	gb‘w“nMidpošts
 = 
çl£
;

148 
	g¡¬t
 = 
ÃxtMidpošt
.
pos
;

149 
	glšeMidpoštS‹
.
	gcu¼’tMidpošt
++;

150 ià(
	g¡¬t
 < 
	g’d
)

151  
­³ndRunsFÜObjeù
(
¡¬t
, 
’d
, 
obj
, 
»sŞv”
);

153 ià(!
	ghaveNextMidpošt
 || (
	gobj
 !ğ
ÃxtMidpošt
.
obj
)) {

154 
»sŞv”
.
addRun
(
Ãw
 (
obj
->
»nd”A»Ç
()è
BidiRun
(
¡¬t
, 
’d
, obj,„esŞv”.
cÚ‹xt
(),„esŞv”.
dœ
()));

160 ià(
	g¡©ic_ÿ¡
<>(
	gÃxtMidpošt
.
	gpos
 + 1è<ğ
’d
) {

161 
lšeMidpoštS‹
.
b‘w“nMidpošts
 = 
Œue
;

162 
	glšeMidpoštS‹
.
	gcu¼’tMidpošt
++;

163 ià(
	gÃxtMidpošt
.
	gpos
 !ğ
UINT_MAX
) {

164 ià(
¡©ic_ÿ¡
<>(
ÃxtMidpošt
.
pos
 + 1è> 
¡¬t
)

165 
»sŞv”
.
addRun
(
Ãw
 (
obj
->
»nd”A»Ç
())

166 
BidiRun
(
¡¬t
, 
ÃxtMidpošt
.
pos
 + 1, 
obj
, 
»sŞv”
.
cÚ‹xt
(),„esŞv”.
dœ
()));

167  
­³ndRunsFÜObjeù
(
ÃxtMidpošt
.
pos
 + 1, 
’d
, 
obj
, 
»sŞv”
);

170 
	g»sŞv”
.
addRun
(
Ãw
 (
obj
->
»nd”A»Ç
()è
BidiRun
(
¡¬t
, 
’d
, obj, 
»sŞv”
.
cÚ‹xt
(),„esŞv”.
dœ
()));

174 
šlše
 
IÆšeBox
* 
ü—‹IÆšeBoxFÜR’d””
(
R’d”Objeù
* 
obj
, 
boŞ
 
isRoÙLšeBox
, boŞ 
isOÆyRun
 = 
çl£
)

176 ià(
isRoÙLšeBox
)

177  
toR’d”Block
(
obj
)->
ü—‹AndAµ’dRoÙIÆšeBox
();

179 ià(
	gobj
->
isText
()) {

180 
IÆšeTextBox
* 
	g‹xtBox
 = 
toR’d”Text
(
obj
)->
ü—‹IÆšeTextBox
();

183 ià(
	gobj
->
isBR
())

184 
	g‹xtBox
->
£tIsText
(
isOÆyRun
 || 
obj
->
docum’t
()->
šSŒiùMode
());

185  
	g‹xtBox
;

188 ià(
	gobj
->
isBox
())

189  
toR’d”Box
(
obj
)->
ü—‹IÆšeBox
();

191  
toR’d”IÆše
(
obj
)->
ü—‹AndAµ’dIÆšeFlowBox
();

194 
šlše
 
dœtyLšeBoxesFÜR’d””
(
R’d”Objeù
* 
o
, 
boŞ
 
fuÎLayout
)

196 ià(
	go
->
isText
()) {

197 ià(
	go
->
´efWidthsDœty
(è&& o->
isCouÁ”
())

198 
toR’d”Text
(
o
)->
ÿlcP»fWidths
(0);

199 
toR’d”Text
(
o
)->
dœtyLšeBoxes
(
fuÎLayout
);

201 
toR’d”IÆše
(
o
)->
dœtyLšeBoxes
(
fuÎLayout
);

204 
IÆšeFlowBox
* 
	gR’d”Block
::
ü—‹LšeBoxes
(
R’d”Objeù
* 
obj
, 
boŞ
 
fœ¡Lše
)

208 
	glšeD•th
 = 1;

209 
IÆšeFlowBox
* 
	gchdBox
 = 0;

210 
IÆšeFlowBox
* 
	g·»ÁBox
 = 0;

211 
IÆšeFlowBox
* 
	g»suÉ
 = 0;

213 
ASSERT
(
obj
->
isR’d”IÆše
(è|| obj =ğ
this
);

216 
	g·»ÁBox
 = 
obj
->
isR’d”IÆše
(è? 
toR’d”IÆše
(obj)->
Ï¡LšeBox
(è: 
toR’d”Block
(obj)->lastLineBox();

223 
boŞ
 
	gcÚ¡ruùedNewBox
 = 
çl£
;

224 ià(!
	g·»ÁBox
 ||…¬’tBox->
isCÚ¡ruùed
(è||…¬’tBox->
ÃxtOnLše
()) {

227 
IÆšeBox
* 
	gÃwBox
 = 
ü—‹IÆšeBoxFÜR’d””
(
obj
, obj =ğ
this
);

228 
ASSERT
(
ÃwBox
->
isIÆšeFlowBox
());

229 
	g·»ÁBox
 = 
¡©ic_ÿ¡
<
IÆšeFlowBox
*>(
ÃwBox
);

230 
	g·»ÁBox
->
£tFœ¡LšeStyËB™
(
fœ¡Lše
);

231 
	gcÚ¡ruùedNewBox
 = 
Œue
;

234 ià(!
	g»suÉ
)

235 
	g»suÉ
 = 
·»ÁBox
;

240 ià(
	gchdBox
)

241 
	g·»ÁBox
->
addToLše
(
chdBox
);

243 ià(!
	gcÚ¡ruùedNewBox
 || 
	gobj
 =ğ
this
)

246 
	gchdBox
 = 
·»ÁBox
;

250 
	gobj
 = (++
lšeD•th
 >ğ
cMaxLšeD•th
è? 
this
 : 
obj
->
·»Á
();

252 } 
	gŒue
);

254  
	g»suÉ
;

257 
RoÙIÆšeBox
* 
	gR’d”Block
::
cÚ¡ruùLše
(
runCouÁ
, 
BidiRun
* 
fœ¡Run
, BidiRun* 
Ï¡Run
, 
boŞ
 
fœ¡Lše
, boŞ 
Ï¡Lše
, 
R’d”Objeù
* 
’dObjeù
)

259 
ASSERT
(
fœ¡Run
);

261 
IÆšeFlowBox
* 
	g·»ÁBox
 = 0;

262 
BidiRun
* 
	gr
 = 
fœ¡Run
;„;„ = 
r
->
Ãxt
()) {

264 
boŞ
 
isOÆyRun
 = (
runCouÁ
 == 1);

265 ià(
	grunCouÁ
 =ğ2 && !
r
->
m_objeù
->
isLi¡M¬k”
())

266 
isOÆyRun
 = ((
¡yË
()->
dœeùiÚ
(è=ğ
RTL
è? 
Ï¡Run
 : 
fœ¡Run
)->
m_objeù
->
isLi¡M¬k”
();

268 
IÆšeBox
* 
	gbox
 = 
ü—‹IÆšeBoxFÜR’d””
(
r
->
m_objeù
, 
çl£
, 
isOÆyRun
);

269 
	gr
->
	gm_box
 = 
box
;

271 
ASSERT
(
box
);

272 ià(!
	gbox
)

278 ià(!
	g·»ÁBox
 ||…¬’tBox->
»nd””
(è!ğ
r
->
m_objeù
->
·»Á
())

280 
·»ÁBox
 = 
ü—‹LšeBoxes
(
r
->
m_objeù
->
·»Á
(), 
fœ¡Lše
);

283 
	g·»ÁBox
->
addToLše
(
box
);

285 
boŞ
 
	gvisu®lyOrd”ed
 = 
r
->
m_objeù
->
¡yË
()->
visu®lyOrd”ed
();

286 
	gbox
->
£tBidiLev–
(
visu®lyOrd”ed
 ? 0 : 
r
->
Ëv–
());

288 ià(
	gbox
->
isIÆšeTextBox
()) {

289 
IÆšeTextBox
* 
	g‹xt
 = 
¡©ic_ÿ¡
<IÆšeTextBox*>(
box
);

290 
	g‹xt
->
£tS¹
(
r
->
m_¡¬t
);

291 
	g‹xt
->
£tL’
(
r
->
m_¡İ
 -„->
m_¡¬t
);

292 
	g‹xt
->
	gm_dœOv”ride
 = 
r
->
dœOv”ride
(
visu®lyOrd”ed
);

298 
ASSERT
(
Ï¡LšeBox
(è&& !Ï¡LšeBox()->
isCÚ¡ruùed
());

304 
Ï¡LšeBox
()->
d‘”mšeS·cšgFÜFlowBoxes
(
Ï¡Lše
, 
’dObjeù
);

307 
Ï¡LšeBox
()->
£tCÚ¡ruùed
();

310  
Ï¡RoÙBox
();

313 
	gR’d”Block
::
compu‹HÜizÚlPos™iÚsFÜLše
(
RoÙIÆšeBox
* 
lšeBox
, 
boŞ
 
fœ¡Lše
, 
BidiRun
* 
fœ¡Run
, BidiRun* 
ŒašgS·ûRun
, boŞ 
»achedEnd
)

316 
	gavaabËWidth
 = 
lšeWidth
(
height
(), 
fœ¡Lše
);

317 
	gtÙWidth
 = 
lšeBox
->
g‘FlowS·cšgWidth
();

318 
boŞ
 
	gÃedsWÜdS·cšg
 = 
çl£
;

319 
	gnumS·ûs
 = 0;

320 
ETextAlign
 
	g‹xtAlign
 = 
¡yË
()->
‹xtAlign
();

322 
BidiRun
* 
	gr
 = 
fœ¡Run
;„;„ = 
r
->
Ãxt
()) {

323 ià(!
r
->
m_box
 ||„->
m_objeù
->
isPos™iÚed
(è||„->m_box->
isLšeB»ak
())

327 ià(
	gr
->
	gm_objeù
->
isText
()) {

328 
R’d”Text
* 
	g¹
 = 
toR’d”Text
(
r
->
m_objeù
);

330 ià(
	g‹xtAlign
 =ğ
JUSTIFY
 && 
r
 !ğ
ŒašgS·ûRun
) {

331 cÚ¡ 
UCh¬
* 
ch¬aù”s
 = 
¹
->characters();

332 
	gi
 = 
r
->
m_¡¬t
; i < 
	gr
->
	gm_¡İ
; i++) {

333 
UCh¬
 
	gc
 = 
ch¬aù”s
[
i
];

334 ià(
	gc
 =ğ' ' || 
c
 == '\n' || c == '\t')

335 
numS·ûs
++;

339 ià(
	gËngth
 = 
¹
->
‹xtL’gth
()) {

340 ià(!
r
->
m_¡¬t
 && 
ÃedsWÜdS·cšg
 && 
isS·ûOrNewlše
(
¹
->
ch¬aù”s
()[r->m_start]))

341 
tÙWidth
 +ğ
¹
->
¡yË
(
fœ¡Lše
)->
fÚt
().
wÜdS·cšg
();

342 
	gÃedsWÜdS·cšg
 = !
isS·ûOrNewlše
(
¹
->
ch¬aù”s
()[
r
->
m_¡İ
 - 1]è&&„->m_¡İ =ğ
Ëngth
;

344 
	gHashS‘
<cÚ¡ 
	gSim¶eFÚtD©a
*> 
	gçÎbackFÚts
;

345 
GlyphOv”æow
 
	gglyphOv”æow
;

346 
	gr
->
	gm_box
->
£tWidth
(
¹
->
width
(
r
->
m_¡¬t
,„->
m_¡İ
 -„->m_¡¬t, 
tÙWidth
, 
fœ¡Lše
, &
çÎbackFÚts
, &
glyphOv”æow
));

347 ià(!
	gçÎbackFÚts
.
isEm±y
()

348 #ià
ENABLE
(
SVG
)

349 && !
isSVGText
()

352 
ASSERT
(
r
->
m_box
->
isText
());

353 
	g¡©ic_ÿ¡
<
	gIÆšeTextBox
*>(
	gr
->
	gm_box
)->
£tF®lbackFÚts
(
çÎbackFÚts
);

355 ià((
	gglyphOv”æow
.
	gtİ
 || glyphOv”æow.
	gbÙtom
 || glyphOv”æow.
	gËá
 || glyphOv”æow.
	gright
)

356 #ià
ENABLE
(
SVG
)

357 && !
isSVGText
()

360 
ASSERT
(
r
->
m_box
->
isText
());

361 
	g¡©ic_ÿ¡
<
	gIÆšeTextBox
*>(
	gr
->
	gm_box
)->
£tGlyphOv”æow
(
glyphOv”æow
);

363 } ià(!
	gr
->
	gm_objeù
->
isR’d”IÆše
()) {

364 
R’d”Box
* 
	g»nd”Box
 = 
toR’d”Box
(
r
->
m_objeù
);

365 
	g»nd”Box
->
ÿlcWidth
();

366 
	gr
->
	gm_box
->
£tWidth
(
»nd”Box
->
width
());

367 
	gtÙWidth
 +ğ
»nd”Box
->
m¬gšLeá
(è+„’d”Box->
m¬gšRight
();

370 
	gtÙWidth
 +ğ
r
->
m_box
->
width
();

377 
	gx
 = 
ËáOff£t
(
height
(), 
fœ¡Lše
);

378 
	g‹xtAlign
) {

379 
	gLEFT
:

380 
WEBKIT_LEFT
:

383 ià(
¡yË
()->
dœeùiÚ
(è=ğ
LTR
) {

384 ià(
tÙWidth
 > 
avaabËWidth
 && 
ŒašgS·ûRun
)

385 
ŒašgS·ûRun
->
m_box
->
£tWidth
(
max
(0,¿šgS·ûRun->m_box->
width
(è- 
tÙWidth
 + 
avaabËWidth
));

387 ià(
	gŒašgS·ûRun
)

388 
	gŒašgS·ûRun
->
	gm_box
->
£tWidth
(0);

389 ià(
	gtÙWidth
 > 
	gavaabËWidth
)

390 
	gx
 -ğ(
tÙWidth
 - 
avaabËWidth
);

393 
	gJUSTIFY
:

394 ià(
numS·ûs
 && !
»achedEnd
 && !
lšeBox
->
’dsW™hB»ak
()) {

395 ià(
ŒašgS·ûRun
) {

396 
tÙWidth
 -ğ
ŒašgS·ûRun
->
m_box
->
width
();

397 
	gŒašgS·ûRun
->
	gm_box
->
£tWidth
(0);

402 
	gTAAUTO
:

403 
numS·ûs
 = 0;

405 ià(
¡yË
()->
dœeùiÚ
(è=ğ
LTR
) {

406 ià(
tÙWidth
 > 
avaabËWidth
 && 
ŒašgS·ûRun
)

407 
ŒašgS·ûRun
->
m_box
->
£tWidth
(
max
(0,¿šgS·ûRun->m_box->
width
(è- 
tÙWidth
 + 
avaabËWidth
));

410 
	gRIGHT
:

411 
WEBKIT_RIGHT
:

415 ià(
¡yË
()->
dœeùiÚ
(è=ğ
LTR
) {

416 ià(
ŒašgS·ûRun
) {

417 
tÙWidth
 -ğ
ŒašgS·ûRun
->
m_box
->
width
();

418 
	gŒašgS·ûRun
->
	gm_box
->
£tWidth
(0);

420 ià(
	gtÙWidth
 < 
	gavaabËWidth
)

421 
	gx
 +ğ
avaabËWidth
 - 
tÙWidth
;

423 ià(
	gtÙWidth
 > 
	gavaabËWidth
 && 
	gŒašgS·ûRun
) {

424 
	gŒašgS·ûRun
->
	gm_box
->
£tWidth
(
max
(0, 
ŒašgS·ûRun
->
m_box
->
width
(è- 
tÙWidth
 + 
avaabËWidth
));

425 
	gtÙWidth
 -ğ
ŒašgS·ûRun
->
m_box
->
width
();

427 
	gx
 +ğ
avaabËWidth
 - 
tÙWidth
;

430 
	gCENTER
:

431 
WEBKIT_CENTER
:

432 
ŒašgS·ûWidth
 = 0;

433 ià(
	gŒašgS·ûRun
) {

434 
	gtÙWidth
 -ğ
ŒašgS·ûRun
->
m_box
->
width
();

435 
	gŒašgS·ûWidth
 = 
mš
(
ŒašgS·ûRun
->
m_box
->
width
(), (
avaabËWidth
 - 
tÙWidth
 + 1) / 2);

436 
	gŒašgS·ûRun
->
	gm_box
->
£tWidth
(
max
(0, 
ŒašgS·ûWidth
));

438 ià(
¡yË
()->
dœeùiÚ
(è=ğ
LTR
)

439 
x
 +ğ
max
((
avaabËWidth
 - 
tÙWidth
) / 2, 0);

441 
	gx
 +ğ
tÙWidth
 > 
avaabËWidth
 ? (avaabËWidth -ÙWidthè: (avaabËWidth -ÙWidthè/ 2 - 
ŒašgS·ûWidth
;

445 ià(
	gnumS·ûs
) {

446 
BidiRun
* 
	gr
 = 
fœ¡Run
;„;„ = 
r
->
Ãxt
()) {

447 ià(!
r
->
m_box
 ||„ =ğ
ŒašgS·ûRun
)

450 
	g¥aûAdd
 = 0;

451 ià(
	gr
->
	gm_objeù
->
isText
()) {

452 
	g¥aûs
 = 0;

453 cÚ¡ 
UCh¬
* 
	gch¬aù”s
 = 
toR’d”Text
(
r
->
m_objeù
)->
ch¬aù”s
();

454 
	gi
 = 
r
->
m_¡¬t
; i < 
	gr
->
	gm_¡İ
; i++) {

455 
UCh¬
 
	gc
 = 
ch¬aù”s
[
i
];

456 ià(
	gc
 =ğ' ' || 
c
 == '\n' || c == '\t')

457 
¥aûs
++;

460 
ASSERT
(
¥aûs
 <ğ
numS·ûs
);

463 ià(
	gr
->
	gm_objeù
->
¡yË
()->
cŞÏp£Wh™eS·û
()) {

464 
	g¥aûAdd
 = (
avaabËWidth
 - 
tÙWidth
è* 
¥aûs
 / 
numS·ûs
;

465 
	g¡©ic_ÿ¡
<
	gIÆšeTextBox
*>(
	gr
->
	gm_box
)->
£tS·ûAdd
(
¥aûAdd
);

466 
	gtÙWidth
 +ğ
¥aûAdd
;

468 
	gnumS·ûs
 -ğ
¥aûs
;

469 ià(!
	gnumS·ûs
)

477 
	gÃedsWÜdS·cšg
 = 
çl£
;

478 
	glšeBox
->
¶aûBoxesHÜizÚÎy
(
x
, 
ÃedsWÜdS·cšg
);

481 
	gR’d”Block
::
compu‹V”tiÿlPos™iÚsFÜLše
(
RoÙIÆšeBox
* 
lšeBox
, 
BidiRun
* 
fœ¡Run
)

483 
£tHeight
(
lšeBox
->
v”tiÿÎyAlignBoxes
(
height
()));

484 
	glšeBox
->
£tBlockHeight
(
height
());

487 
BidiRun
* 
	gr
 = 
fœ¡Run
;„;„ = 
r
->
Ãxt
()) {

488 
ASSERT
(
r
->
m_box
);

489 ià(!
	gr
->
	gm_box
)

494 ià(
	gr
->
	gm_objeù
->
isPos™iÚed
())

495 
	gr
->
	gm_box
->
£tY
(
height
());

499 ià(
	gr
->
	gm_objeù
->
isText
())

500 
toR’d”Text
(
r
->
m_objeù
)->
pos™iÚLšeBox
Ô->
m_box
);

501 ià(
	gr
->
	gm_objeù
->
isBox
())

502 
toR’d”Box
(
r
->
m_objeù
)->
pos™iÚLšeBox
Ô->
m_box
);

506 
	glšeBox
->
m¬kDœty
(
çl£
);

510 
	gR’d”Block
::
bidiReÜd”Lše
(
IÆšeBidiResŞv”
& 
»sŞv”
, cÚ¡ 
IÆšeI‹¿tÜ
& 
’d
, 
boŞ
 
´eviousLšeBrokeCËªly
)

512 
	g»sŞv”
.
ü—‹BidiRunsFÜLše
(
’d
, 
¡yË
()->
visu®lyOrd”ed
(), 
´eviousLšeBrokeCËªly
);

515 
šlše
 
boŞ
 
isCŞÏpsibËS·û
(
UCh¬
 
ch¬aù”
, 
R’d”Text
* 
»nd””
)

517 ià(
	gch¬aù”
 =ğ' ' || 
ch¬aù”
 =ğ'\t' || ch¬aù” =ğ
soáHyph’
)

518  
Œue
;

519 ià(
	gch¬aù”
 == '\n')

520  !
»nd””
->
¡yË
()->
´e£rveNewlše
();

521 ià(
	gch¬aù”
 =ğ
noB»akS·û
)

522  
»nd””
->
¡yË
()->
nb¥Mode
(è=ğ
SPACE
;

523  
	gçl£
;

526 
	gR’d”Block
::
ÏyoutIÆšeChd»n
(
boŞ
 
»ÏyoutChd»n
, & 
»·štTİ
, & 
»·štBÙtom
)

528 
boŞ
 
	gu£R•aštBounds
 = 
çl£
;

530 
	gm_ov”æow
.
ş—r
();

532 
£tHeight
(
bÜd”Tİ
(è+ 
·ddšgTİ
());

533 
	gtoAdd
 = 
bÜd”BÙtom
(è+ 
·ddšgBÙtom
(è+ 
hÜizÚlSüŞlb¬Height
();

537 
boŞ
 
	gfuÎLayout
 = !
fœ¡LšeBox
(è|| 
£lfN“dsLayout
(è|| 
»ÏyoutChd»n
;

538 ià(
	gfuÎLayout
)

539 
lšeBoxes
()->
d–‘eLšeBoxes
(
»nd”A»Ç
());

546 
boŞ
 
	ghasTextOv”æow
 = 
¡yË
()->
‹xtOv”æow
(è&& 
hasOv”æowCl
();

549 ià(
	ghasTextOv”æow
)

550 
d–‘eEÎsisLšeBoxes
();

552 ià(
fœ¡Chd
()) {

554 
boŞ
 
	g’dOfIÆše
 = 
çl£
;

555 
R’d”Objeù
* 
	go
 = 
bidiFœ¡
(
this
, 0, 
çl£
);

556 
	gVeùÜ
<
	gFlßtW™hReù
> 
	gæßts
;

557 
boŞ
 
	ghasIÆšeChd
 = 
çl£
;

558 
	go
) {

559 ià(
	go
->
isR•Ïûd
(è|| o->
isFlßtšg
(è|| o->
isPos™iÚed
()) {

560 
R’d”Box
* 
	gbox
 = 
toR’d”Box
(
o
);

562 ià(
	g»ÏyoutChd»n
 || 
	go
->
¡yË
()->
width
().
isP”ûÁ
(è|| o->¡yË()->
height
().isPercent())

563 
	go
->
£tChdN“dsLayout
(
Œue
, 
çl£
);

566 ià(
	g»ÏyoutChd»n
 && (
	go
->
¡yË
()->
·ddšgLeá
().
isP”ûÁ
(è|| o->¡yË()->
·ddšgRight
().isPercent()))

567 
	go
->
£tP»fWidthsDœty
(
Œue
, 
çl£
);

569 ià(
	go
->
isPos™iÚed
())

570 
	go
->
cÚššgBlock
()->
š£¹Pos™iÚedObjeù
(
box
);

572 ià(
	go
->
isFlßtšg
())

573 
	gæßts
.
­³nd
(
FlßtW™hReù
(
box
));

574 ià(
	gfuÎLayout
 || 
	go
->
ÃedsLayout
())

575 
toR’d”Box
(
o
)->
dœtyLšeBoxes
(
fuÎLayout
);

577 
	go
->
ÏyoutIfN“ded
();

579 } ià(
	go
->
isText
(è|| (o->
isR’d”IÆše
(è&& !
	g’dOfIÆše
)) {

580 
	ghasIÆšeChd
 = 
Œue
;

581 ià(
	gfuÎLayout
 || 
	go
->
£lfN“dsLayout
())

582 
dœtyLšeBoxesFÜR’d””
(
o
, 
fuÎLayout
);

583 
	go
->
£tN“dsLayout
(
çl£
);

584 ià(!
	go
->
isText
())

585 
toR’d”IÆše
(
o
)->
šv®id©eV”tiÿlPos™iÚ
();

587 
	go
 = 
bidiNext
(
this
, 
o
, 0, 
çl£
, &
’dOfIÆše
);

591 
IÆšeBidiResŞv”
 
	g»sŞv”
;

592 
	gæßtIndex
;

593 
boŞ
 
	gfœ¡Lše
 = 
Œue
;

594 
boŞ
 
	g´eviousLšeBrokeCËªly
 = 
Œue
;

595 
RoÙIÆšeBox
* 
	g¡¬tLše
 = 
d‘”mšeS¹Pos™iÚ
(
fœ¡Lše
, 
fuÎLayout
, 
´eviousLšeBrokeCËªly
, 
»sŞv”
, 
æßts
, 
æßtIndex
);

597 ià(
	gfuÎLayout
 && 
	ghasIÆšeChd
 && !
£lfN“dsLayout
()) {

598 
£tN“dsLayout
(
Œue
, 
çl£
);

600 
R’d”V›w
* 
	gv
 = 
v›w
();

601 ià(
	gv
 && !v->
došgFuÎR•ašt
(è&& 
hasLay”
()) {

606 
»·štUsšgCÚš”
(
cÚš”FÜR•ašt
(), 
Ïy”
()->
»·štReù
());

610 
FlßtšgObjeù
* 
	gÏ¡Flßt
 = 
m_æßtšgObjeùs
 ? m_æßtšgObjeùs->
Ï¡
() : 0;

612 
	gLšeMidpoštS‹
& 
	glšeMidpoštS‹
 = 
»sŞv”
.
midpoštS‹
();

616 
IÆšeI‹¿tÜ
 
	gş—nLšeS¹
;

617 
BidiStus
 
	gş—nLšeBidiStus
;

618 
	g’dLšeYPos
 = 0;

619 
RoÙIÆšeBox
* 
	g’dLše
 = (
fuÎLayout
 || !
¡¬tLše
) ?

620 0 : 
d‘”mšeEndPos™iÚ
(
¡¬tLše
, 
ş—nLšeS¹
, 
ş—nLšeBidiStus
, 
’dLšeYPos
);

622 ià(
	g¡¬tLše
) {

623 
	gu£R•aštBounds
 = 
Œue
;

624 
	g»·štTİ
 = 
height
();

625 
	g»·štBÙtom
 = 
height
();

626 
R’d”A»Ç
* 
	g¬’a
 = 
»nd”A»Ç
();

627 
RoÙIÆšeBox
* 
	gbox
 = 
¡¬tLše
;

628 
	gbox
) {

629 
	g»·štTİ
 = 
mš
(
»·štTİ
, 
box
->
tİVisibËOv”æow
());

630 
	g»·štBÙtom
 = 
max
(
»·štBÙtom
, 
box
->
bÙtomVisibËOv”æow
());

631 
RoÙIÆšeBox
* 
	gÃxt
 = 
box
->
ÃxtRoÙBox
();

632 
	gbox
->
d–‘eLše
(
¬’a
);

633 
	gbox
 = 
Ãxt
;

637 
IÆšeI‹¿tÜ
 
	g’d
 = 
»sŞv”
.
pos™iÚ
();

639 ià(!
	gfuÎLayout
 && 
Ï¡RoÙBox
(è&&†a¡RoÙBox()->
’dsW™hB»ak
()) {

643 ià(
IÆšeBox
* 
	gÏ¡L—fChd
 = 
Ï¡RoÙBox
()->
Ï¡L—fChd
()) {

644 
R’d”Objeù
* 
Ï¡Objeù
 = 
Ï¡L—fChd
->
»nd””
();

645 ià(!
	gÏ¡Objeù
->
isBR
())

646 
	gÏ¡Objeù
 = 
Ï¡RoÙBox
()->
fœ¡L—fChd
()->
»nd””
();

647 ià(
	gÏ¡Objeù
->
isBR
()) {

648 
ECË¬
 
	gş—r
 = 
Ï¡Objeù
->
¡yË
()->
ş—r
();

649 ià(
	gş—r
 !ğ
CNONE
)

650 
ÃwLše
(
ş—r
);

655 
boŞ
 
	g’dLšeM©ched
 = 
çl£
;

656 
boŞ
 
	gcheckFÜEndLšeM©ch
 = 
’dLše
;

657 
boŞ
 
	gcheckFÜFlßtsFromLa¡Lše
 = 
çl£
;

659 
boŞ
 
	gisLšeEm±y
 = 
Œue
;

661 !
	g’d
.
©End
()) {

663 ià(
	gcheckFÜEndLšeM©ch
 && (
	g’dLšeM©ched
 = 
m©chedEndLše
(
»sŞv”
, 
ş—nLšeS¹
, 
ş—nLšeBidiStus
, 
’dLše
, 
’dLšeYPos
, 
»·štBÙtom
, 
»·štTİ
)))

666 
	glšeMidpoštS‹
.
»£t
();

668 
	gisLšeEm±y
 = 
Œue
;

670 
ECË¬
 
	gş—r
 = 
CNONE
;

671 
	g’d
 = 
fšdNextLšeB»ak
(
»sŞv”
, 
fœ¡Lše
, 
isLšeEm±y
, 
´eviousLšeBrokeCËªly
, &
ş—r
);

672 ià(
	g»sŞv”
.
pos™iÚ
().
©End
()) {

673 
	g»sŞv”
.
d–‘eRuns
();

674 
	gcheckFÜFlßtsFromLa¡Lše
 = 
Œue
;

677 
ASSERT
(
’d
 !ğ
»sŞv”
.
pos™iÚ
());

679 ià(!
	gisLšeEm±y
) {

680 
bidiReÜd”Lše
(
»sŞv”
, 
’d
, 
´eviousLšeBrokeCËªly
);

681 
ASSERT
(
»sŞv”
.
pos™iÚ
(è=ğ
’d
);

683 
BidiRun
* 
	gŒašgS·ûRun
 = 0;

684 ià(!
	g´eviousLšeBrokeCËªly
 && 
	g»sŞv”
.
runCouÁ
(è&&„esŞv”.
logiÿÎyLa¡Run
()->
	gm_objeù
->
¡yË
()->
b»akOÆyAá”Wh™eS·û
()

685 && 
	g»sŞv”
.
logiÿÎyLa¡Run
()->
	gm_objeù
->
¡yË
()->
autoW¿p
()) {

686 
	gŒašgS·ûRun
 = 
»sŞv”
.
logiÿÎyLa¡Run
();

687 
R’d”Objeù
* 
	gÏ¡Objeù
 = 
ŒašgS·ûRun
->
m_objeù
;

688 ià(
	gÏ¡Objeù
->
isText
()) {

689 
R’d”Text
* 
	gÏ¡Text
 = 
toR’d”Text
(
Ï¡Objeù
);

690 cÚ¡ 
UCh¬
* 
	gch¬aù”s
 = 
Ï¡Text
->
ch¬aù”s
();

691 
	gfœ¡S·û
 = 
ŒašgS·ûRun
->
¡İ
();

692 
	gfœ¡S·û
 > 
	gŒašgS·ûRun
->
¡¬t
()) {

693 
UCh¬
 
	gcu¼’t
 = 
ch¬aù”s
[
fœ¡S·û
 - 1];

694 ià(!
isCŞÏpsibËS·û
(
cu¼’t
, 
Ï¡Text
))

696 
	gfœ¡S·û
--;

698 ià(
	gfœ¡S·û
 =ğ
ŒašgS·ûRun
->
¡İ
())

699 
ŒašgS·ûRun
 = 0;

701 
TextDœeùiÚ
 
	gdœeùiÚ
 = 
¡yË
()->
dœeùiÚ
();

702 
boŞ
 
	gshouldReÜd”
 = 
ŒašgS·ûRun
 !ğ(
dœeùiÚ
 =ğ
LTR
 ? 
»sŞv”
.
Ï¡Run
(è:„esŞv”.
fœ¡Run
());

703 ià(
	gfœ¡S·û
 !ğ
ŒašgS·ûRun
->
¡¬t
()) {

704 
BidiCÚ‹xt
* 
ba£CÚ‹xt
 = 
»sŞv”
.
cÚ‹xt
();

705 
BidiCÚ‹xt
* 
	g·»Á
 = 
ba£CÚ‹xt
->
·»Á
())

706 
ba£CÚ‹xt
 = 
·»Á
;

708 
BidiRun
* 
	gÃwT¿šgRun
 = 
Ãw
 (
»nd”A»Ç
()èBidiRun(
fœ¡S·û
, 
ŒašgS·ûRun
->
m_¡İ
,¿šgS·ûRun->
m_objeù
, 
ba£CÚ‹xt
, 
Oth”NeuŒ®
);

709 
	gŒašgS·ûRun
->
	gm_¡İ
 = 
fœ¡S·û
;

710 ià(
	gdœeùiÚ
 =ğ
LTR
)

711 
»sŞv”
.
addRun
(
ÃwT¿šgRun
);

713 
	g»sŞv”
.
´•’dRun
(
ÃwT¿šgRun
);

714 
	gŒašgS·ûRun
 = 
ÃwT¿šgRun
;

715 
	gshouldReÜd”
 = 
çl£
;

717 ià(
	gshouldReÜd”
) {

718 ià(
	gdœeùiÚ
 =ğ
LTR
) {

719 
»sŞv”
.
moveRunToEnd
(
ŒašgS·ûRun
);

720 
	gŒašgS·ûRun
->
	gm_Ëv–
 = 0;

722 
	g»sŞv”
.
moveRunToBegšnšg
(
ŒašgS·ûRun
);

723 
	gŒašgS·ûRun
->
	gm_Ëv–
 = 1;

728 
	gŒašgS·ûRun
 = 0;

735 
RoÙIÆšeBox
* 
	glšeBox
 = 0;

736 ià(
	g»sŞv”
.
runCouÁ
()) {

737 
	glšeBox
 = 
cÚ¡ruùLše
(
»sŞv”
.
runCouÁ
(),„esŞv”.
fœ¡Run
(),„esŞv”.
Ï¡Run
(), 
fœ¡Lše
, !
’d
.
obj
,ƒnd.obj && !’d.
pos
 ?ƒnd.obj : 0);

738 ià(
	glšeBox
) {

739 
	glšeBox
->
£tEndsW™hB»ak
(
´eviousLšeBrokeCËªly
);

742 
compu‹HÜizÚlPos™iÚsFÜLše
(
lšeBox
, 
fœ¡Lše
, 
»sŞv”
.
fœ¡Run
(), 
ŒašgS·ûRun
, 
’d
.
©End
());

745 
compu‹V”tiÿlPos™iÚsFÜLše
(
lšeBox
, 
»sŞv”
.
fœ¡Run
());

746 
	gIÆšeTextBox
::
ş—rGlyphOv”æowAndF®lbackFÚtM­
();

748 #ià
ENABLE
(
SVG
)

750 
	glšeBox
->
compu‹P”Ch¬aù”LayoutInfÜm©iÚ
();

753 #ià
PLATFORM
(
MAC
)

755 ià(
¡yË
()->
highlight
(è!ğ
nuÎAtom
)

756 
lšeBox
->
addHighlightOv”æow
();

761 
	g»sŞv”
.
d–‘eRuns
();

763 ià(
	glšeBox
) {

764 
	glšeBox
->
£tLšeB»akInfo
(
’d
.
obj
,ƒnd.
pos
, 
»sŞv”
.
¡©us
());

765 ià(
	gu£R•aštBounds
) {

766 
	g»·štTİ
 = 
mš
(
»·štTİ
, 
lšeBox
->
tİVisibËOv”æow
());

767 
	g»·štBÙtom
 = 
max
(
»·štBÙtom
, 
lšeBox
->
bÙtomVisibËOv”æow
());

771 
	gfœ¡Lše
 = 
çl£
;

772 
ÃwLše
(
ş—r
);

775 ià(
	gm_æßtšgObjeùs
 && 
Ï¡RoÙBox
()) {

776 ià(
	gÏ¡Flßt
) {

777 
FlßtšgObjeù
* 
	gf
 = 
m_æßtšgObjeùs
->
Ï¡
(); f !ğ
Ï¡Flßt
; f = m_æßtšgObjeùs->
´ev
()) {

779 
m_æßtšgObjeùs
->
Ãxt
();

781 
	gm_æßtšgObjeùs
->
fœ¡
();

782 
FlßtšgObjeù
* 
	gf
 = 
m_æßtšgObjeùs
->
cu¼’t
(); f; f = m_æßtšgObjeùs->
Ãxt
()) {

783 
Ï¡RoÙBox
()->
æßts
().
­³nd
(
f
->
m_»nd””
);

784 
ASSERT
(
f
->
m_»nd””
 =ğ
æßts
[
æßtIndex
].
objeù
);

786 ià(
	gæßts
[
æßtIndex
].
	g»ù
 !ğ
IÁReù
(
f
->
m_Ëá
, f->
m_tİ
, f->
m_width
, f->
m_bÙtom
 - f->m_top))

787 
	gcheckFÜEndLšeM©ch
 = 
çl£
;

788 
	gæßtIndex
++;

790 
	gÏ¡Flßt
 = 
m_æßtšgObjeùs
->
Ï¡
();

793 
	glšeMidpoštS‹
.
»£t
();

794 
	g»sŞv”
.
£tPos™iÚ
(
’d
);

797 ià(
	g’dLše
) {

798 ià(
	g’dLšeM©ched
) {

800 
	gd–
 = 
height
(è- 
’dLšeYPos
;

801 
RoÙIÆšeBox
* 
	glše
 = 
’dLše
;†še;†šğ
lše
->
ÃxtRoÙBox
()) {

802 
lše
->
©chLše
();

803 ià(
	gd–
) {

804 
	g»·štTİ
 = 
mš
(
»·štTİ
, 
lše
->
tİVisibËOv”æow
(è+ mš(
d–
, 0));

805 
	g»·štBÙtom
 = 
max
(
»·štBÙtom
, 
lše
->
bÙtomVisibËOv”æow
(è+ max(
d–
, 0));

806 
	glše
->
adju¡Pos™iÚ
(0, 
d–
);

808 ià(
	gVeùÜ
<
	gR’d”Box
*>* 
	gş—nLšeFlßts
 = 
lše
->
æßtsPŒ
()) {

809 
VeùÜ
<
R’d”Box
*>::
™”©Ü
 
’d
 = 
ş—nLšeFlßts
->end();

810 
	gVeùÜ
<
	gR’d”Box
*>::
™”©Ü
 
f
 = 
ş—nLšeFlßts
->
begš
(); 
	gf
 !ğ
’d
; ++f) {

811 
	gæßtTİ
 = (*
f
)->
y
(è- (*f)->
m¬gšTİ
();

812 
š£¹FlßtšgObjeù
(*
f
);

813 
£tHeight
(
æßtTİ
 + 
d–
);

814 
pos™iÚNewFlßts
();

818 
£tHeight
(
Ï¡RoÙBox
()->
blockHeight
());

821 
RoÙIÆšeBox
* 
	glše
 = 
’dLše
;

822 
R’d”A»Ç
* 
	g¬’a
 = 
»nd”A»Ç
();

823 
	glše
) {

824 
	g»·štTİ
 = 
mš
(
»·štTİ
, 
lše
->
tİVisibËOv”æow
());

825 
	g»·štBÙtom
 = 
max
(
»·štBÙtom
, 
lše
->
bÙtomVisibËOv”æow
());

826 
RoÙIÆšeBox
* 
	gÃxt
 = 
lše
->
ÃxtRoÙBox
();

827 
	glše
->
d–‘eLše
(
¬’a
);

828 
	glše
 = 
Ãxt
;

832 ià(
	gm_æßtšgObjeùs
 && (
	gcheckFÜFlßtsFromLa¡Lše
 || 
pos™iÚNewFlßts
()è&& 
Ï¡RoÙBox
()) {

836 ià(
	gcheckFÜFlßtsFromLa¡Lše
) {

837 
	gbÙtomVisu®Ov”æow
 = 
Ï¡RoÙBox
()->
bÙtomVisu®Ov”æow
();

838 
	gbÙtomLayoutOv”æow
 = 
Ï¡RoÙBox
()->
bÙtomLayoutOv”æow
();

839 
T¿šgFlßtsRoÙIÆšeBox
* 
	gŒašgFlßtsLšeBox
 = 
Ãw
 (
»nd”A»Ç
()èT¿šgFlßtsRoÙIÆšeBox(
this
);

840 
	gm_lšeBoxes
.
­³ndLšeBox
(
ŒašgFlßtsLšeBox
);

841 
	gŒašgFlßtsLšeBox
->
£tCÚ¡ruùed
();

842 
	gŒašgFlßtsLšeBox
->
v”tiÿÎyAlignBoxes
(
height
());

843 
	gŒašgFlßtsLšeBox
->
£tV”tiÿlOv”æowPos™iÚs
(
height
(), 
bÙtomLayoutOv”æow
, height(), 
bÙtomVisu®Ov”æow
, 0);

844 
	gŒašgFlßtsLšeBox
->
£tBlockHeight
(
height
());

846 ià(
	gÏ¡Flßt
) {

847 
FlßtšgObjeù
* 
	gf
 = 
m_æßtšgObjeùs
->
Ï¡
(); f !ğ
Ï¡Flßt
; f = m_æßtšgObjeùs->
´ev
()) {

849 
m_æßtšgObjeùs
->
Ãxt
();

851 
	gm_æßtšgObjeùs
->
fœ¡
();

852 
FlßtšgObjeù
* 
	gf
 = 
m_æßtšgObjeùs
->
cu¼’t
(); f; f = m_æßtšgObjeùs->
Ãxt
())

853 
Ï¡RoÙBox
()->
æßts
().
­³nd
(
f
->
m_»nd””
);

854 
	gÏ¡Flßt
 = 
m_æßtšgObjeùs
->
Ï¡
();

856 
size_t
 
	gæßtCouÁ
 = 
æßts
.
size
();

860 
size_t
 
	gi
 = 0; i < 
	gæßtCouÁ
; ++i) {

861 ià(!
	gæßts
[
i
].
	gev”HadLayout
) {

862 
R’d”Box
* 
	gf
 = 
æßts
[
i
].
objeù
;

863 ià(!
	gf
->
x
(è&& !f->
y
(è&& f->
checkFÜR•aštDuršgLayout
())

864 
	gf
->
»·št
();

870 
£tHeight
(
height
(è+ 
toAdd
);

872 ià(!
fœ¡LšeBox
(è&& 
hasLšeIfEm±y
())

873 
£tHeight
(
height
(è+ 
lšeHeight
(
Œue
,rue));

877 ià(
	ghasTextOv”æow
)

878 
checkLšesFÜTextOv”æow
();

881 
RoÙIÆšeBox
* 
	gR’d”Block
::
d‘”mšeS¹Pos™iÚ
(
boŞ
& 
fœ¡Lše
, boŞ& 
fuÎLayout
, boŞ& 
´eviousLšeBrokeCËªly
,

882 
IÆšeBidiResŞv”
& 
»sŞv”
, 
VeùÜ
<
FlßtW™hReù
>& 
æßts
, & 
numCËªFlßts
)

884 
RoÙIÆšeBox
* 
	gcu¼
 = 0;

885 
RoÙIÆšeBox
* 
	gÏ¡
 = 0;

887 
boŞ
 
	gdœt›dByFlßt
 = 
çl£
;

888 ià(!
	gfuÎLayout
) {

889 
size_t
 
	gæßtIndex
 = 0;

890 
	gcu¼
 = 
fœ¡RoÙBox
(); cu¼ && !cu¼->
isDœty
(); cu¼ = 
cu¼
->
ÃxtRoÙBox
()) {

891 ià(
VeùÜ
<
R’d”Box
*>* 
ş—nLšeFlßts
 = 
cu¼
->
æßtsPŒ
()) {

892 
VeùÜ
<
R’d”Box
*>::
™”©Ü
 
’d
 = 
ş—nLšeFlßts
->end();

893 
	gVeùÜ
<
	gR’d”Box
*>::
™”©Ü
 
o
 = 
ş—nLšeFlßts
->
begš
(); 
	go
 !ğ
’d
; ++o) {

894 
R’d”Box
* 
	gf
 = *
o
;

895 
IÁSize
 
ÃwSize
(
f
->
width
(è+ f->
m¬gšLeá
(è+f->
m¬gšRight
(), f->
height
(è+ f->
m¬gšTİ
(è+ f->
m¬gšBÙtom
());

896 
ASSERT
(
æßtIndex
 < 
æßts
.
size
());

897 ià(
	gæßts
[
æßtIndex
].
	gobjeù
 !ğ
f
) {

900 
fuÎLayout
 = 
Œue
;

903 ià(
	gæßts
[
æßtIndex
].
	g»ù
.
size
(è!ğ
ÃwSize
) {

904 
æßtTİ
 = 
æßts
[
æßtIndex
].
»ù
.
y
();

905 
	gcu¼
->
m¬kDœty
();

906 
m¬kLšesDœtyInV”tiÿlRªge
(
cu¼
->
blockHeight
(), 
æßtTİ
 + 
max
(
æßts
[
æßtIndex
].
»ù
.
height
(), 
ÃwSize
.height()), curr);

907 
	gæßts
[
æßtIndex
].
	g»ù
.
£tSize
(
ÃwSize
);

908 
	gdœt›dByFlßt
 = 
Œue
;

910 
	gæßtIndex
++;

913 ià(
	gdœt›dByFlßt
 || 
	gfuÎLayout
)

917 ià(!
	gcu¼
 && 
	gæßtIndex
 < 
	gæßts
.
size
())

918 
	gfuÎLayout
 = 
Œue
;

921 ià(
	gfuÎLayout
) {

923 ià(
fœ¡RoÙBox
()) {

924 
R’d”A»Ç
* 
	g¬’a
 = 
»nd”A»Ç
();

925 
	gcu¼
 = 
fœ¡RoÙBox
();

926 
	gcu¼
) {

927 
RoÙIÆšeBox
* 
	gÃxt
 = 
cu¼
->
ÃxtRoÙBox
();

928 
	gcu¼
->
d–‘eLše
(
¬’a
);

929 
	gcu¼
 = 
Ãxt
;

931 
ASSERT
(!
fœ¡LšeBox
(è&& !
Ï¡LšeBox
());

934 ià(
	gcu¼
) {

936 ià(
RoÙIÆšeBox
* 
	g´evRoÙBox
 = 
cu¼
->
´evRoÙBox
()) {

938 ià(!
dœt›dByFlßt
 && (!
´evRoÙBox
->
’dsW™hB»ak
(è|| (´evRoÙBox->
lšeB»akObj
()->
isText
(è&&…»vRoÙBox->
lšeB»akPos
(è>ğ
toR’d”Text
Õ»vRoÙBox->lšeB»akObj())->
‹xtL’gth
())))

941 
cu¼
 = 
´evRoÙBox
;

946 ià(
Ï¡RoÙBox
(è&& !Ï¡RoÙBox()->
’dsW™hB»ak
())

947 
	gcu¼
 = 
Ï¡RoÙBox
();

951 
	gÏ¡
 = 
cu¼
 ? cu¼->
´evRoÙBox
(è: 
Ï¡RoÙBox
();

954 
	gnumCËªFlßts
 = 0;

955 ià(!
	gæßts
.
isEm±y
()) {

956 
	g§vedHeight
 = 
height
();

958 
RoÙIÆšeBox
* 
	glše
 = 
fœ¡RoÙBox
();

959 
	glše
 !ğ
cu¼
) {

960 ià(
VeùÜ
<
R’d”Box
*>* 
ş—nLšeFlßts
 = 
lše
->
æßtsPŒ
()) {

961 
VeùÜ
<
R’d”Box
*>::
™”©Ü
 
’d
 = 
ş—nLšeFlßts
->end();

962 
	gVeùÜ
<
	gR’d”Box
*>::
™”©Ü
 
f
 = 
ş—nLšeFlßts
->
begš
(); 
	gf
 !ğ
’d
; ++f) {

963 
š£¹FlßtšgObjeù
(*
f
);

964 
£tHeight
((*
f
)->
y
(è- (*f)->
m¬gšTİ
());

965 
pos™iÚNewFlßts
();

966 
ASSERT
(
æßts
[
numCËªFlßts
].
objeù
 =ğ*
f
);

967 
	gnumCËªFlßts
++;

970 
	glše
 = 
lše
->
ÃxtRoÙBox
();

972 
£tHeight
(
§vedHeight
);

975 
	gfœ¡Lše
 = !
Ï¡
;

976 
	g´eviousLšeBrokeCËªly
 = !
Ï¡
 ||†a¡->
’dsW™hB»ak
();

978 
R’d”Objeù
* 
	g¡¬tObj
;

979 
	gpos
 = 0;

980 ià(
	gÏ¡
) {

981 
£tHeight
(
Ï¡
->
blockHeight
());

982 
	g¡¬tObj
 = 
Ï¡
->
lšeB»akObj
();

983 
	gpos
 = 
Ï¡
->
lšeB»akPos
();

984 
	g»sŞv”
.
£tStus
(
Ï¡
->
lšeB»akBidiStus
());

986 
boŞ
 
	gÉr
 = 
¡yË
()->
dœeùiÚ
(è=ğ
LTR


987 #ià
ENABLE
(
SVG
)

988 || (
¡yË
()->
unicodeBidi
(è=ğ
UBNÜm®
 && 
isSVGText
())

992 
DœeùiÚ
 
	gdœeùiÚ
 = 
Ér
 ? 
LeáToRight
 : 
RightToLeá
;

993 
	g»sŞv”
.
£tLa¡SŒÚgDœ
(
dœeùiÚ
);

994 
	g»sŞv”
.
£tLa¡Dœ
(
dœeùiÚ
);

995 
	g»sŞv”
.
£tEÜDœ
(
dœeùiÚ
);

996 
	g»sŞv”
.
£tCÚ‹xt
(
BidiCÚ‹xt
::
ü—‹
(
Ér
 ? 0 : 1, 
dœeùiÚ
, 
¡yË
()->
unicodeBidi
(è=ğ
Ov”ride
));

998 
	g¡¬tObj
 = 
bidiFœ¡
(
this
, &
»sŞv”
);

1001 
	g»sŞv”
.
£tPos™iÚ
(
IÆšeI‹¿tÜ
(
this
, 
¡¬tObj
, 
pos
));

1003  
	gcu¼
;

1006 
RoÙIÆšeBox
* 
	gR’d”Block
::
d‘”mšeEndPos™iÚ
(RoÙIÆšeBox* 
¡¬tLše
, 
IÆšeI‹¿tÜ
& 
ş—nLšeS¹
, 
BidiStus
& 
ş—nLšeBidiStus
, & 
yPos
)

1008 
RoÙIÆšeBox
* 
	gÏ¡
 = 0;

1009 ià(!
	g¡¬tLše
)

1010 
	gÏ¡
 = 0;

1012 
RoÙIÆšeBox
* 
	gcu¼
 = 
¡¬tLše
->
ÃxtRoÙBox
(); cu¼; cu¼ = 
cu¼
->nextRootBox()) {

1013 ià(
cu¼
->
isDœty
())

1014 
Ï¡
 = 0;

1015 ià(!
	gÏ¡
)

1016 
	gÏ¡
 = 
cu¼
;

1020 ià(!
	gÏ¡
)

1023 
RoÙIÆšeBox
* 
	g´ev
 = 
Ï¡
->
´evRoÙBox
();

1024 
	gş—nLšeS¹
 = 
IÆšeI‹¿tÜ
(
this
, 
´ev
->
lšeB»akObj
(),…»v->
lšeB»akPos
());

1025 
	gş—nLšeBidiStus
 = 
´ev
->
lšeB»akBidiStus
();

1026 
	gyPos
 = 
´ev
->
blockHeight
();

1028 
RoÙIÆšeBox
* 
	glše
 = 
Ï¡
;†še;†šğ
lše
->
ÃxtRoÙBox
())

1029 
lše
->
exŒaùLše
();

1032  
	gÏ¡
;

1035 
boŞ
 
	gR’d”Block
::
m©chedEndLše
(cÚ¡ 
IÆšeBidiResŞv”
& 
»sŞv”
, cÚ¡ 
IÆšeI‹¿tÜ
& 
’dLšeS¹
, cÚ¡ 
BidiStus
& 
’dLšeStus
, 
RoÙIÆšeBox
*& 
’dLše
, & 
’dYPos
, & 
»·štBÙtom
, & 
»·štTİ
)

1037 ià(
	g»sŞv”
.
pos™iÚ
(è=ğ
’dLšeS¹
) {

1038 ià(
»sŞv”
.
¡©us
(è!ğ
’dLšeStus
)

1039  
çl£
;

1041 
	gd–
 = 
height
(è- 
’dYPos
;

1042 ià(!
	gd–
 || !
	gm_æßtšgObjeùs
)

1043  
	gŒue
;

1046 
	gtİ
 = 
mš
(
height
(), 
’dYPos
);

1048 
RoÙIÆšeBox
* 
	gÏ¡Lše
 = 
’dLše
;

1049 
RoÙIÆšeBox
* 
	gÃxtLše
 = 
Ï¡Lše
->
ÃxtRoÙBox
())

1050 
Ï¡Lše
 = 
ÃxtLše
;

1052 
	gbÙtom
 = 
Ï¡Lše
->
blockHeight
(è+ 
abs
(
d–
);

1054 
FlßtšgObjeù
* 
	gf
 = 
m_æßtšgObjeùs
->
fœ¡
(); f; f = m_æßtšgObjeùs->
Ãxt
()) {

1055 ià(
f
->
m_bÙtom
 >ğ
tİ
 && f->m_bÙtom < 
bÙtom
)

1056  
çl£
;

1059  
	gŒue
;

1064 
	gnumLšes
 = 8;

1065 
RoÙIÆšeBox
* 
	glše
 = 
’dLše
;

1066 
	gi
 = 0; i < 
	gnumLšes
 && 
	glše
; i++,†šğ
lše
->
ÃxtRoÙBox
()) {

1067 ià(
lše
->
lšeB»akObj
(è=ğ
»sŞv”
.
pos™iÚ
().
obj
 &&†še->
lšeB»akPos
(è=ğ»sŞv”.pos™iÚ().
pos
) {

1069 ià(
lše
->
lšeB»akBidiStus
(è!ğ
»sŞv”
.
¡©us
())

1070  
çl£
;

1071 
RoÙIÆšeBox
* 
	g»suÉ
 = 
lše
->
ÃxtRoÙBox
();

1074 ià(
	g»suÉ
)

1075 
	g’dYPos
 = 
lše
->
blockHeight
();

1077 
	gd–
 = 
height
(è- 
’dYPos
;

1078 ià(
	gd–
 && 
	gm_æßtšgObjeùs
) {

1080 
	gtİ
 = 
mš
(
height
(), 
’dYPos
);

1082 
RoÙIÆšeBox
* 
	gÏ¡Lše
 = 
’dLše
;

1083 
RoÙIÆšeBox
* 
	gÃxtLše
 = 
Ï¡Lše
->
ÃxtRoÙBox
())

1084 
Ï¡Lše
 = 
ÃxtLše
;

1086 
	gbÙtom
 = 
Ï¡Lše
->
blockHeight
(è+ 
abs
(
d–
);

1088 
FlßtšgObjeù
* 
	gf
 = 
m_æßtšgObjeùs
->
fœ¡
(); f; f = m_æßtšgObjeùs->
Ãxt
()) {

1089 ià(
f
->
m_bÙtom
 >ğ
tİ
 && f->m_bÙtom < 
bÙtom
)

1090  
çl£
;

1095 
RoÙIÆšeBox
* 
	gboxToD–‘e
 = 
’dLše
;

1096 
R’d”A»Ç
* 
	g¬’a
 = 
»nd”A»Ç
();

1097 
	gboxToD–‘e
 && boxToD–‘!ğ
»suÉ
) {

1098 
»·štTİ
 = 
mš
Ô•aštTİ, 
boxToD–‘e
->
tİVisibËOv”æow
());

1099 
	g»·štBÙtom
 = 
max
(
»·štBÙtom
, 
boxToD–‘e
->
bÙtomVisibËOv”æow
());

1100 
RoÙIÆšeBox
* 
	gÃxt
 = 
boxToD–‘e
->
ÃxtRoÙBox
();

1101 
	gboxToD–‘e
->
d–‘eLše
(
¬’a
);

1102 
	gboxToD–‘e
 = 
Ãxt
;

1105 
	g’dLše
 = 
»suÉ
;

1106  
	g»suÉ
;

1110  
	gçl£
;

1113 
šlše
 
boŞ
 
skNÚB»akšgS·û
(cÚ¡ 
IÆšeI‹¿tÜ
& 
™
, boŞ 
isLšeEm±y
, boŞ 
´eviousLšeBrokeCËªly
)

1115 ià(
	g™
.
	gobj
->
¡yË
()->
nb¥Mode
(è!ğ
SPACE
 || 
™
.
cu¼’t
(è!ğ
noB»akS·û
)

1116  
çl£
;

1123 ià(
	gisLšeEm±y
 && 
	g´eviousLšeBrokeCËªly
)

1124  
	gçl£
;

1126  
	gŒue
;

1129 
šlše
 
boŞ
 
shouldCŞÏp£Wh™eS·û
(cÚ¡ 
R’d”StyË
* 
¡yË
, boŞ 
isLšeEm±y
, boŞ 
´eviousLšeBrokeCËªly
)

1131  
	g¡yË
->
cŞÏp£Wh™eS·û
(è|| (¡yË->
wh™eS·û
(è=ğ
PRE_WRAP
 && (!
isLšeEm±y
 || !
´eviousLšeBrokeCËªly
));

1134 
šlše
 
boŞ
 
shouldP»£rveNewlše
(
R’d”Objeù
* 
objeù
)

1136 #ià
ENABLE
(
SVG
)

1137 ià(
	gobjeù
->
isSVGText
())

1138  
	gçl£
;

1141  
	gobjeù
->
¡yË
()->
´e£rveNewlše
();

1144 
boŞ
 
šlšeFlowRequœesLšeBox
(
R’d”IÆše
* 
æow
)

1149  !
	gæow
->
fœ¡Chd
(è&& flow->
hasHÜizÚlBÜd”sPaddšgOrM¬gš
();

1152 
boŞ
 
	gR’d”Block
::
»quœesLšeBox
(cÚ¡ 
IÆšeI‹¿tÜ
& 
™
, boŞ 
isLšeEm±y
, boŞ 
´eviousLšeBrokeCËªly
)

1154 ià(
	g™
.
	gobj
->
isFlßtšgOrPos™iÚed
())

1155  
	gçl£
;

1157 ià(
	g™
.
	gobj
->
isR’d”IÆše
(è&& !
šlšeFlowRequœesLšeBox
(
toR’d”IÆše
(
™
.
obj
)))

1158  
	gçl£
;

1160 ià(!
shouldCŞÏp£Wh™eS·û
(
™
.
obj
->
¡yË
(), 
isLšeEm±y
, 
´eviousLšeBrokeCËªly
è|| 
	g™
.
	gobj
->
isBR
())

1161  
	gŒue
;

1163 
UCh¬
 
	gcu¼’t
 = 
™
.
cu¼’t
();

1164  
	gcu¼’t
 !ğ' ' && 
cu¼’t
 !ğ'\t' && cu¼’ˆ!ğ
soáHyph’
 && (cu¼’ˆ!ğ'\n' || 
shouldP»£rveNewlše
(
™
.
obj
))

1165 && !
skNÚB»akšgS·û
(
™
, 
isLšeEm±y
, 
´eviousLšeBrokeCËªly
);

1168 
boŞ
 
	gR’d”Block
::
g’”©esLšeBoxesFÜIÆšeChd
(
R’d”Objeù
* 
šlšeObj
, boŞ 
isLšeEm±y
, boŞ 
´eviousLšeBrokeCËªly
)

1170 
ASSERT
(
šlšeObj
->
·»Á
(è=ğ
this
);

1172 
IÆšeI‹¿tÜ
 
™
(
this
, 
šlšeObj
, 0);

1173 !
	g™
.
©End
(è&& !
»quœesLšeBox
(
™
, 
isLšeEm±y
, 
´eviousLšeBrokeCËªly
))

1174 
	g™
.
šüem’t
();

1176  !
	g™
.
©End
();

1185 
	gR’d”Block
::
skT¿šgWh™e¥aû
(
IÆšeI‹¿tÜ
& 
™”©Ü
, 
boŞ
 
isLšeEm±y
, boŞ 
´eviousLšeBrokeCËªly
)

1187 !
	g™”©Ü
.
©End
(è&& !
»quœesLšeBox
(
™”©Ü
, 
isLšeEm±y
, 
´eviousLšeBrokeCËªly
)) {

1188 
R’d”Objeù
* 
	gobjeù
 = 
™”©Ü
.
obj
;

1189 ià(
	gobjeù
->
isFlßtšg
()) {

1190 
š£¹FlßtšgObjeù
(
toR’d”Box
(
objeù
));

1191 } ià(
	gobjeù
->
isPos™iÚed
()) {

1194 
R’d”Objeù
* 
	gc
 = 
objeù
->
cÚš”
();

1195 ià(
	gc
->
isR’d”IÆše
()) {

1199 
toR’d”IÆše
(
c
)->
Ïy”
()->
£tSticX
(
¡yË
()->
dœeùiÚ
(è=ğ
LTR
 ? 
ËáOff£t
(
height
(), 
çl£
è: 
rightOff£t
(height(), false));

1200 
toR’d”IÆše
(
c
)->
Ïy”
()->
£tSticY
(
height
());

1203 
R’d”Box
* 
	gbox
 = 
toR’d”Box
(
objeù
);

1204 ià(
	gbox
->
¡yË
()->
hasSticX
()) {

1205 ià(
	gbox
->
¡yË
()->
isOrigš®Di¥ÏyIÆšeTy³
())

1206 
	gbox
->
Ïy”
()->
£tSticX
(
¡yË
()->
dœeùiÚ
(è=ğ
LTR
 ? 
ËáOff£t
(
height
(), 
çl£
è: 
width
(è- 
rightOff£t
(height(), false));

1208 
	gbox
->
Ïy”
()->
£tSticX
(
¡yË
()->
dœeùiÚ
(è=ğ
LTR
 ? 
bÜd”Leá
(è+ 
·ddšgLeá
(è: 
bÜd”Right
(è+ 
·ddšgRight
());

1211 ià(
	gbox
->
¡yË
()->
hasSticY
())

1212 
	gbox
->
Ïy”
()->
£tSticY
(
height
());

1214 
	g™”©Ü
.
šüem’t
();

1218 
	gR’d”Block
::
skL—dšgWh™e¥aû
(
IÆšeBidiResŞv”
& 
»sŞv”
, 
boŞ
 
fœ¡Lše
, boŞ 
isLšeEm±y
, boŞ 
´eviousLšeBrokeCËªly
)

1220 
	gavaabËWidth
 = 
lšeWidth
(
height
(), 
fœ¡Lše
);

1221 !
	g»sŞv”
.
pos™iÚ
().
©End
(è&& !
»quœesLšeBox
(
»sŞv”
.pos™iÚ(), 
isLšeEm±y
, 
´eviousLšeBrokeCËªly
)) {

1222 
R’d”Objeù
* 
	gobjeù
 = 
»sŞv”
.
pos™iÚ
().
obj
;

1223 ià(
	gobjeù
->
isFlßtšg
()) {

1224 
š£¹FlßtšgObjeù
(
toR’d”Box
(
objeù
));

1225 
pos™iÚNewFlßts
();

1226 
	gavaabËWidth
 = 
lšeWidth
(
height
(), 
fœ¡Lše
);

1227 } ià(
	gobjeù
->
isPos™iÚed
()) {

1230 
R’d”Objeù
* 
	gc
 = 
objeù
->
cÚš”
();

1231 ià(
	gc
->
isR’d”IÆše
()) {

1235 
toR’d”IÆše
(
c
)->
Ïy”
()->
£tSticX
(
¡yË
()->
dœeùiÚ
(è=ğ
LTR
 ? 
ËáOff£t
(
height
(), 
fœ¡Lše
è: 
rightOff£t
(height(), firstLine));

1236 
toR’d”IÆše
(
c
)->
Ïy”
()->
£tSticY
(
height
());

1239 
R’d”Box
* 
	gbox
 = 
toR’d”Box
(
objeù
);

1240 ià(
	gbox
->
¡yË
()->
hasSticX
()) {

1241 ià(
	gbox
->
¡yË
()->
isOrigš®Di¥ÏyIÆšeTy³
())

1242 
	gbox
->
Ïy”
()->
£tSticX
(
¡yË
()->
dœeùiÚ
(è=ğ
LTR
 ? 
ËáOff£t
(
height
(), 
fœ¡Lše
è: 
width
(è- 
rightOff£t
(height(), firstLine));

1244 
	gbox
->
Ïy”
()->
£tSticX
(
¡yË
()->
dœeùiÚ
(è=ğ
LTR
 ? 
bÜd”Leá
(è+ 
·ddšgLeá
(è: 
bÜd”Right
(è+ 
·ddšgRight
());

1247 ià(
	gbox
->
¡yË
()->
hasSticY
())

1248 
	gbox
->
Ïy”
()->
£tSticY
(
height
());

1250 
	g»sŞv”
.
šüem’t
();

1252 
	g»sŞv”
.
comm™Ex¶ic™Embeddšg
();

1253  
	gavaabËWidth
;

1258 
boŞ
 
shouldSkWh™e¥aûAá”S¹Objeù
(
R’d”Block
* 
block
, 
R’d”Objeù
* 
o
, 
LšeMidpoštS‹
& 
lšeMidpoštS‹
)

1260 
R’d”Objeù
* 
	gÃxt
 = 
bidiNext
(
block
, 
o
);

1261 ià(
	gÃxt
 && !Ãxt->
isBR
(è&&‚ext->
isText
(è&& 
toR’d”Text
(
Ãxt
)->
‹xtL’gth
() > 0) {

1262 
R’d”Text
* 
	gÃxtText
 = 
toR’d”Text
(
Ãxt
);

1263 
UCh¬
 
	gÃxtCh¬
 = 
ÃxtText
->
ch¬aù”s
()[0];

1264 ià(
	gÃxtText
->
¡yË
()->
isCŞÏpsibËWh™eS·û
(
ÃxtCh¬
)) {

1265 
addMidpošt
(
lšeMidpoštS‹
, 
IÆšeI‹¿tÜ
(0, 
o
, 0));

1266  
	gŒue
;

1270  
	gçl£
;

1273 
	gR’d”Block
::
f™B–owFlßts
(
widthToF™
, 
boŞ
 
fœ¡Lše
, & 
avaabËWidth
)

1275 
ASSERT
(
widthToF™
 > 
avaabËWidth
);

1277 
	gæßtBÙtom
;

1278 
	gÏ¡FlßtBÙtom
 = 
height
();

1279 
	gÃwLšeWidth
 = 
avaabËWidth
;

1280 
	gŒue
) {

1281 
	gæßtBÙtom
 = 
ÃxtFlßtBÙtomB–ow
(
Ï¡FlßtBÙtom
);

1282 ià(!
	gæßtBÙtom
)

1285 
	gÃwLšeWidth
 = 
lšeWidth
(
æßtBÙtom
, 
fœ¡Lše
);

1286 
	gÏ¡FlßtBÙtom
 = 
æßtBÙtom
;

1287 ià(
	gÃwLšeWidth
 >ğ
widthToF™
)

1291 ià(
	gÃwLšeWidth
 > 
	gavaabËWidth
) {

1292 
£tHeight
(
Ï¡FlßtBÙtom
);

1293 
	gavaabËWidth
 = 
ÃwLšeWidth
;

1297 
šlše
 
‹xtWidth
(
R’d”Text
* 
‹xt
, 
äom
, 
Ën
, cÚ¡ 
FÚt
& 
fÚt
, 
xPos
, 
boŞ
 
isFixedP™ch
, boŞ 
cŞÏp£Wh™eS·û
)

1299 ià(
	gisFixedP™ch
 || (!
	gäom
 && 
	gËn
 =ğ
‹xt
->
‹xtL’gth
()))

1300  
‹xt
->
width
(
äom
, 
Ën
, 
fÚt
, 
xPos
);

1301  
	gfÚt
.
width
(
TextRun
(
‹xt
->
ch¬aù”s
(è+ 
äom
, 
Ën
, !
cŞÏp£Wh™eS·û
, 
xPos
));

1304 
IÆšeI‹¿tÜ
 
	gR’d”Block
::
fšdNextLšeB»ak
(
IÆšeBidiResŞv”
& 
»sŞv”
, 
boŞ
 
fœ¡Lše
, boŞ& 
isLšeEm±y
, boŞ& 
´eviousLšeBrokeCËªly
,

1305 
ECË¬
* 
ş—r
)

1307 
ASSERT
(
»sŞv”
.
pos™iÚ
().
block
 =ğ
this
);

1309 
boŞ
 
	g­¶›dS¹Width
 = 
»sŞv”
.
pos™iÚ
().
pos
 > 0;

1310 
	gLšeMidpoštS‹
& 
	glšeMidpoštS‹
 = 
»sŞv”
.
midpoštS‹
();

1312 
	gwidth
 = 
skL—dšgWh™e¥aû
(
»sŞv”
, 
fœ¡Lše
, 
isLšeEm±y
, 
´eviousLšeBrokeCËªly
);

1314 
	gw
 = 0;

1315 
	gtmpW
 = 0;

1317 ià(
	g»sŞv”
.
pos™iÚ
().
©End
())

1318  
	g»sŞv”
.
pos™iÚ
();

1322 
boŞ
 
	gignÜšgS·ûs
 = 
çl£
;

1323 
IÆšeI‹¿tÜ
 
	gignÜeS¹
;

1328 
boŞ
 
	gcu¼’tCh¬aù”IsS·û
 = 
çl£
;

1329 
boŞ
 
	gcu¼’tCh¬aù”IsWS
 = 
çl£
;

1330 
R’d”Objeù
* 
	gŒašgS·ûObjeù
 = 0;

1332 
IÆšeI‹¿tÜ
 
	glB»ak
 = 
»sŞv”
.
pos™iÚ
();

1334 
R’d”Objeù
 *
	go
 = 
»sŞv”
.
pos™iÚ
().
obj
;

1335 
R’d”Objeù
 *
	gÏ¡
 = 
o
;

1336 
	gpos
 = 
»sŞv”
.
pos™iÚ
().
pos
;

1337 
	gÃxtB»akabË
 = 
»sŞv”
.
pos™iÚ
().
ÃxtB»akabËPos™iÚ
;

1338 
boŞ
 
	g©S¹
 = 
Œue
;

1340 
boŞ
 
	g´evLšeBrokeCËªly
 = 
´eviousLšeBrokeCËªly
;

1341 
	g´eviousLšeBrokeCËªly
 = 
çl£
;

1343 
boŞ
 
	gautoW¿pWasEv”TrueOnLše
 = 
çl£
;

1344 
boŞ
 
	gæßtsF™OnLše
 = 
Œue
;

1349 
boŞ
 
	g®lowImagesToB»ak
 = !
¡yË
()->
htmlHacks
(è|| !
isTabËC–l
(è|| !¡yË()->
width
().
isIÁršsicOrAuto
();

1351 
EWh™eS·û
 
	gcu¼WS
 = 
¡yË
()->
wh™eS·û
();

1352 
EWh™eS·û
 
	gÏ¡WS
 = 
cu¼WS
;

1353 
	go
) {

1354 
	gcu¼WS
 = 
o
->
isR•Ïûd
(è? o->
·»Á
()->
¡yË
()->
wh™eS·û
() : o->style()->whiteSpace();

1355 
	gÏ¡WS
 = 
Ï¡
->
isR•Ïûd
(è?†a¡->
·»Á
()->
¡yË
()->
wh™eS·û
() :†ast->style()->whiteSpace();

1357 
boŞ
 
	gautoW¿p
 = 
R’d”StyË
::
autoW¿p
(
cu¼WS
);

1358 
	gautoW¿pWasEv”TrueOnLše
 = 
autoW¿pWasEv”TrueOnLše
 || 
autoW¿p
;

1360 #ià
ENABLE
(
SVG
)

1361 
boŞ
 
	g´e£rveNewlše
 = 
o
->
isSVGText
(è? 
çl£
 : 
R’d”StyË
::
´e£rveNewlše
(
cu¼WS
);

1363 
boŞ
 
	g´e£rveNewlše
 = 
R’d”StyË
::
´e£rveNewlše
(
cu¼WS
);

1366 
boŞ
 
	gcŞÏp£Wh™eS·û
 = 
R’d”StyË
::
cŞÏp£Wh™eS·û
(
cu¼WS
);

1368 ià(
	go
->
isBR
()) {

1369 ià(
	gw
 + 
	gtmpW
 <ğ
width
) {

1370 
lB»ak
.
obj
 = 
o
;

1371 
	glB»ak
.
	gpos
 = 0;

1372 
	glB»ak
.
	gÃxtB»akabËPos™iÚ
 = -1;

1373 
	glB»ak
.
šüem’t
();

1380 ià(
	g´evLšeBrokeCËªly
)

1381 
	gisLšeEm±y
 = 
çl£
;

1382 
	gŒašgS·ûObjeù
 = 0;

1383 
	g´eviousLšeBrokeCËªly
 = 
Œue
;

1385 ià(!
	gisLšeEm±y
 && 
	gş—r
)

1386 *
	gş—r
 = 
o
->
¡yË
()->
ş—r
();

1388 
	g’d
;

1391 ià(
	go
->
isFlßtšgOrPos™iÚed
()) {

1393 ià(
	go
->
isFlßtšg
()) {

1394 
R’d”Box
* 
	gæßtBox
 = 
toR’d”Box
(
o
);

1395 
š£¹FlßtšgObjeù
(
æßtBox
);

1399 ià(
	gæßtsF™OnLše
 && 
	gæßtBox
->
width
(è+ flßtBox->
m¬gšLeá
(è+ flßtBox->
m¬gšRight
(è+ 
	gw
 + 
	gtmpW
 <= width) {

1400 
pos™iÚNewFlßts
();

1401 
	gwidth
 = 
lšeWidth
(
height
(), 
fœ¡Lše
);

1403 
	gæßtsF™OnLše
 = 
çl£
;

1404 } ià(
	go
->
isPos™iÚed
()) {

1407 
R’d”Box
* 
	gbox
 = 
toR’d”Box
(
o
);

1408 
boŞ
 
	gisIÆšeTy³
 = 
box
->
¡yË
()->
isOrigš®Di¥ÏyIÆšeTy³
();

1409 
boŞ
 
	gÃedToS‘SticX
 = 
box
->
¡yË
()->
hasSticX
();

1410 ià(
	gbox
->
¡yË
()->
hasSticX
(è&& !
	gisIÆšeTy³
) {

1411 
	gbox
->
Ïy”
()->
£tSticX
(
o
->
·»Á
()->
¡yË
()->
dœeùiÚ
(è=ğ
LTR
 ?

1412 
bÜd”Leá
(è+ 
·ddšgLeá
() :

1413 
bÜd”Right
(è+ 
·ddšgRight
());

1414 
	gÃedToS‘SticX
 = 
çl£
;

1419 
boŞ
 
	gÃedToS‘SticY
 = 
box
->
¡yË
()->
hasSticY
();

1420 ià(
	gbox
->
¡yË
()->
hasSticY
(è&& 
	gisIÆšeTy³
) {

1421 
	gbox
->
Ïy”
()->
£tSticY
(
height
());

1422 
	gÃedToS‘SticY
 = 
çl£
;

1425 
boŞ
 
	gÃedToC»©eLšeBox
 = 
ÃedToS‘SticX
 || 
ÃedToS‘SticY
;

1426 
R’d”Objeù
* 
	gc
 = 
o
->
cÚš”
();

1427 ià(
	gc
->
isR’d”IÆše
(è&& (!
	gÃedToS‘SticX
 || !
	gÃedToS‘SticY
))

1428 
	gÃedToC»©eLšeBox
 = 
Œue
;

1432 ià(
	gÃedToC»©eLšeBox
) {

1433 
	gŒašgS·ûObjeù
 = 0;

1434 
	gignÜeS¹
.
	gobj
 = 
o
;

1435 
	gignÜeS¹
.
	gpos
 = 0;

1436 ià(
	gignÜšgS·ûs
) {

1437 
addMidpošt
(
lšeMidpoštS‹
, 
ignÜeS¹
);

1438 
addMidpošt
(
lšeMidpoštS‹
, 
ignÜeS¹
);

1443 } ià(
	go
->
isR’d”IÆše
()) {

1445 
ASSERT
(!
o
->
fœ¡Chd
());

1447 
R’d”IÆše
* 
	gæowBox
 = 
toR’d”IÆše
(
o
);

1453 ià(
šlšeFlowRequœesLšeBox
(
æowBox
)) {

1454 
	gisLšeEm±y
 = 
çl£
;

1455 ià(
	gignÜšgS·ûs
) {

1456 
	gŒašgS·ûObjeù
 = 0;

1457 
addMidpošt
(
lšeMidpoštS‹
, 
IÆšeI‹¿tÜ
(0, 
o
, 0));

1458 
addMidpošt
(
lšeMidpoštS‹
, 
IÆšeI‹¿tÜ
(0, 
o
, 0));

1459 } ià(
¡yË
()->
cŞÏp£Wh™eS·û
(è&& 
	g»sŞv”
.
pos™iÚ
().
	gobj
 =ğ
o


1460 && 
shouldSkWh™e¥aûAá”S¹Objeù
(
this
, 
o
, 
lšeMidpoštS‹
)) {

1463 
	gcu¼’tCh¬aù”IsS·û
 = 
Œue
;

1464 
	gcu¼’tCh¬aù”IsWS
 = 
Œue
;

1465 
	gignÜšgS·ûs
 = 
Œue
;

1469 
	gtmpW
 +ğ
æowBox
->
m¬gšLeá
(è+ flowBox->
bÜd”Leá
(è+ flowBox->
·ddšgLeá
() +

1470 
æowBox
->
m¬gšRight
(è+ flowBox->
bÜd”Right
(è+ flowBox->
·ddšgRight
();

1471 } ià(
	go
->
isR•Ïûd
()) {

1472 
R’d”Box
* 
	g»¶aûdBox
 = 
toR’d”Box
(
o
);

1475 ià((
	gautoW¿p
 || 
	gR’d”StyË
::
autoW¿p
(
Ï¡WS
)è&& (!
o
->
isImage
(è|| 
®lowImagesToB»ak
)) {

1476 
w
 +ğ
tmpW
;

1477 
	gtmpW
 = 0;

1478 
	glB»ak
.
	gobj
 = 
o
;

1479 
	glB»ak
.
	gpos
 = 0;

1480 
	glB»ak
.
	gÃxtB»akabËPos™iÚ
 = -1;

1483 ià(
	gignÜšgS·ûs
)

1484 
addMidpošt
(
lšeMidpoštS‹
, 
IÆšeI‹¿tÜ
(0, 
o
, 0));

1486 
	gisLšeEm±y
 = 
çl£
;

1487 
	gignÜšgS·ûs
 = 
çl£
;

1488 
	gcu¼’tCh¬aù”IsS·û
 = 
çl£
;

1489 
	gcu¼’tCh¬aù”IsWS
 = 
çl£
;

1490 
	gŒašgS·ûObjeù
 = 0;

1494 ià(
	go
->
isLi¡M¬k”
()) {

1495 ià(
¡yË
()->
cŞÏp£Wh™eS·û
(è&& 
shouldSkWh™e¥aûAá”S¹Objeù
(
this
, 
o
, 
lšeMidpoštS‹
)) {

1498 
	gcu¼’tCh¬aù”IsS·û
 = 
Œue
;

1499 
	gcu¼’tCh¬aù”IsWS
 = 
Œue
;

1500 
	gignÜšgS·ûs
 = 
Œue
;

1502 ià(
toR’d”Li¡M¬k”
(
o
)->
isInside
())

1503 
	gtmpW
 +ğ
»¶aûdBox
->
width
(è+„•ÏûdBox->
m¬gšLeá
(è+„•ÏûdBox->
m¬gšRight
(è+ 
šlšeWidth
(
o
);

1505 
	gtmpW
 +ğ
»¶aûdBox
->
width
(è+„•ÏûdBox->
m¬gšLeá
(è+„•ÏûdBox->
m¬gšRight
(è+ 
šlšeWidth
(
o
);

1506 } ià(
	go
->
isText
()) {

1507 ià(!
	gpos
)

1508 
	g­¶›dS¹Width
 = 
çl£
;

1510 
R’d”Text
* 
	gt
 = 
toR’d”Text
(
o
);

1512 
	g¡¾’
 = 
t
->
‹xtL’gth
();

1513 
	gËn
 = 
¡¾’
 - 
pos
;

1514 cÚ¡ 
UCh¬
* 
	g¡r
 = 
t
->
ch¬aù”s
();

1516 cÚ¡ 
	gFÚt
& 
	gf
 = 
t
->
¡yË
(
fœ¡Lše
)->
fÚt
();

1517 
boŞ
 
	gisFixedP™ch
 = 
f
.
isFixedP™ch
();

1519 
	gÏ¡S·û
 = 
pos
;

1520 
	gwÜdS·cšg
 = 
o
->
¡yË
()->
wÜdS·cšg
();

1521 
	gÏ¡S·ûWÜdS·cšg
 = 0;

1525 
	gwÜdT¿šgS·ûWidth
 = 
f
.
ty³£‰šgF—tu»s
(è& 
K”nšg
 ? f.
¥aûWidth
(è+ 
wÜdS·cšg
 : 0;

1527 
	gw¿pW
 = 
tmpW
 + 
šlšeWidth
(
o
, !
­¶›dS¹Width
, 
Œue
);

1528 
	gch¬Width
 = 0;

1529 
boŞ
 
	gb»akNBSP
 = 
autoW¿p
 && 
o
->
¡yË
()->
nb¥Mode
(è=ğ
SPACE
;

1532 
boŞ
 
	gb»akWÜds
 = 
o
->
¡yË
()->
b»akWÜds
(è&& ((
autoW¿p
 && !
w
è|| 
cu¼WS
 =ğ
PRE
);

1533 
boŞ
 
	gmidWÜdB»ak
 = 
çl£
;

1534 
boŞ
 
	gb»akAÎ
 = 
o
->
¡yË
()->
wÜdB»ak
(è=ğ
B»akAÎWÜdB»ak
 && 
autoW¿p
;

1536 ià(
	gt
->
isWÜdB»ak
()) {

1537 
	gw
 +ğ
tmpW
;

1538 
	gtmpW
 = 0;

1539 
	glB»ak
.
	gobj
 = 
o
;

1540 
	glB»ak
.
	gpos
 = 0;

1541 
	glB»ak
.
	gÃxtB»akabËPos™iÚ
 = -1;

1542 
ASSERT
(!
Ën
);

1545 
	gËn
) {

1546 
boŞ
 
	g´eviousCh¬aù”IsS·û
 = 
cu¼’tCh¬aù”IsS·û
;

1547 
boŞ
 
	g´eviousCh¬aù”IsWS
 = 
cu¼’tCh¬aù”IsWS
;

1548 
UCh¬
 
	gc
 = 
¡r
[
pos
];

1549 
	gcu¼’tCh¬aù”IsS·û
 = 
c
 =ğ' ' || c =ğ'\t' || (!
´e£rveNewlše
 && (c == '\n'));

1551 ià(!
	gcŞÏp£Wh™eS·û
 || !
	gcu¼’tCh¬aù”IsS·û
)

1552 
	gisLšeEm±y
 = 
çl£
;

1555 ià(
	gc
 =ğ
soáHyph’
) {

1556 ià(!
ignÜšgS·ûs
) {

1558 
IÆšeI‹¿tÜ
 
befÜeSoáHyph’
;

1559 ià(
	gpos
)

1560 
	gbefÜeSoáHyph’
 = 
IÆšeI‹¿tÜ
(0, 
o
, 
pos
 - 1);

1562 
	gbefÜeSoáHyph’
 = 
IÆšeI‹¿tÜ
(0, 
Ï¡
,†a¡->
isText
(è? 
toR’d”Text
Öa¡)->
‹xtL’gth
() - 1 : 0);

1564 ià(
	glšeMidpoštS‹
.
	gnumMidpošts
 &&†šeMidpoštS‹.
	gmidpošts
[
lšeMidpoštS‹
.
numMidpošts
 - 1].
	gobj
 =ğ
o
 &&

1565 
lšeMidpoštS‹
.
midpošts
[lšeMidpoštS‹.
numMidpošts
 - 1].
pos
 ==…os)

1566 
lšeMidpoštS‹
.
numMidpošts
--;

1568 
addMidpošt
(
lšeMidpoštS‹
, 
befÜeSoáHyph’
);

1571 
	gtmpW
 +ğ
‹xtWidth
(
t
, 
Ï¡S·û
, 
pos
 -†a¡S·û, 
f
, 
w
 + 
tmpW
, 
isFixedP™ch
, 
cŞÏp£Wh™eS·û
è+ 
	gÏ¡S·ûWÜdS·cšg
;

1575 ià(
	gautoW¿p
)

1576 
	gtmpW
 +ğ
‹xtWidth
(
t
, 
pos
, 1, 
f
, 
w
 + 
tmpW
, 
isFixedP™ch
, 
cŞÏp£Wh™eS·û
);

1578 
IÆšeI‹¿tÜ
 
aá”SoáHyph’
(0, 
o
, 
pos
);

1579 
	gaá”SoáHyph’
.
šüem’t
();

1580 
addMidpošt
(
lšeMidpoštS‹
, 
aá”SoáHyph’
);

1583 
	gpos
++;

1584 
	gËn
--;

1585 
	gÏ¡S·ûWÜdS·cšg
 = 0;

1586 
	gÏ¡S·û
 = 
pos
;

1590 
boŞ
 
	g­¶yWÜdS·cšg
 = 
çl£
;

1592 
	gcu¼’tCh¬aù”IsWS
 = 
cu¼’tCh¬aù”IsS·û
 || (
b»akNBSP
 && 
c
 =ğ
noB»akS·û
);

1594 ià((
	gb»akAÎ
 || 
	gb»akWÜds
è&& !
	gmidWÜdB»ak
) {

1595 
	gw¿pW
 +ğ
ch¬Width
;

1596 
	gch¬Width
 = 
‹xtWidth
(
t
, 
pos
, 1, 
f
, 
w
 + 
w¿pW
, 
isFixedP™ch
, 
cŞÏp£Wh™eS·û
);

1597 
	gmidWÜdB»ak
 = 
w
 + 
w¿pW
 + 
ch¬Width
 > 
width
;

1600 
boŞ
 
	gb‘w“nWÜds
 = 
c
 =ğ'\n' || (
cu¼WS
 !ğ
PRE
 && !
©S¹
 && 
isB»akabË
(
¡r
, 
pos
, 
¡¾’
, 
ÃxtB»akabË
, 
b»akNBSP
));

1602 ià(
	gb‘w“nWÜds
 || 
	gmidWÜdB»ak
) {

1603 
boŞ
 
	g¡İ³dIgnÜšgS·ûs
 = 
çl£
;

1604 ià(
	gignÜšgS·ûs
) {

1605 ià(!
	gcu¼’tCh¬aù”IsS·û
) {

1608 
	gignÜšgS·ûs
 = 
çl£
;

1609 
	gÏ¡S·ûWÜdS·cšg
 = 0;

1610 
	gÏ¡S·û
 = 
pos
;

1611 
addMidpošt
(
lšeMidpoštS‹
, 
IÆšeI‹¿tÜ
(0, 
o
, 
pos
));

1612 
	g¡İ³dIgnÜšgS·ûs
 = 
Œue
;

1615 
	gpos
++;

1616 
	gËn
--;

1621 
	gadd™iÚ®TmpW
;

1622 ià(
	gwÜdT¿šgS·ûWidth
 && 
	gcu¼’tCh¬aù”IsS·û
)

1623 
	gadd™iÚ®TmpW
 = 
‹xtWidth
(
t
, 
Ï¡S·û
, 
pos
 + 1 -†a¡S·û, 
f
, 
w
 + 
tmpW
, 
isFixedP™ch
, 
cŞÏp£Wh™eS·û
è- 
	gwÜdT¿šgS·ûWidth
 + 
	gÏ¡S·ûWÜdS·cšg
;

1625 
	gadd™iÚ®TmpW
 = 
‹xtWidth
(
t
, 
Ï¡S·û
, 
pos
 -†a¡S·û, 
f
, 
w
 + 
tmpW
, 
isFixedP™ch
, 
cŞÏp£Wh™eS·û
è+ 
	gÏ¡S·ûWÜdS·cšg
;

1626 
	gtmpW
 +ğ
add™iÚ®TmpW
;

1627 ià(!
	g­¶›dS¹Width
) {

1628 
	gtmpW
 +ğ
šlšeWidth
(
o
, 
Œue
, 
çl£
);

1629 
	g­¶›dS¹Width
 = 
Œue
;

1632 
	g­¶yWÜdS·cšg
 = 
wÜdS·cšg
 && 
cu¼’tCh¬aù”IsS·û
 && !
´eviousCh¬aù”IsS·û
;

1634 ià(!
	gw
 && 
	gautoW¿p
 && 
	gtmpW
 > 
	gwidth
)

1635 
f™B–owFlßts
(
tmpW
, 
fœ¡Lše
, 
width
);

1637 ià(
	gautoW¿p
 || 
	gb»akWÜds
) {

1640 
boŞ
 
	glšeWasTooWide
 = 
çl£
;

1641 ià(
	gw
 + 
	gtmpW
 <ğ
width
 && 
cu¼’tCh¬aù”IsWS
 && 
o
->
¡yË
()->
b»akOÆyAá”Wh™eS·û
(è&& !
midWÜdB»ak
) {

1642 
ch¬Width
 = 
‹xtWidth
(
t
, 
pos
, 1, 
f
, 
w
 + 
tmpW
, 
isFixedP™ch
, 
cŞÏp£Wh™eS·û
è+ (
	g­¶yWÜdS·cšg
 ? 
	gwÜdS·cšg
 : 0);

1648 ià(
	gw
 + 
	gtmpW
 + 
	gch¬Width
 > 
	gwidth
) {

1649 
	glšeWasTooWide
 = 
Œue
;

1650 
	glB»ak
.
	gobj
 = 
o
;

1651 
	glB»ak
.
	gpos
 = 
pos
;

1652 
	glB»ak
.
	gÃxtB»akabËPos™iÚ
 = 
ÃxtB»akabË
;

1653 
skT¿šgWh™e¥aû
(
lB»ak
, 
isLšeEm±y
, 
´eviousLšeBrokeCËªly
);

1656 ià(
	glšeWasTooWide
 || 
	gw
 + 
	gtmpW
 > 
	gwidth
) {

1657 ià(
	glB»ak
.
	gobj
 && 
shouldP»£rveNewlše
(
lB»ak
.
obj
è&&†B»ak.obj->
isText
(è&& 
toR’d”Text
ÖB»ak.obj)->
‹xtL’gth
(è&& !toR’d”TextÖB»ak.obj)->
isWÜdB»ak
(è&&oR’d”TextÖB»ak.obj)->
ch¬aù”s
()[lB»ak.
pos
] == '\n') {

1658 ià(!
¡İ³dIgnÜšgS·ûs
 && 
pos
 > 0) {

1660 
addMidpošt
(
lšeMidpoštS‹
, 
IÆšeI‹¿tÜ
(0, 
o
, 
pos
 - 1));

1661 
addMidpošt
(
lšeMidpoštS‹
, 
IÆšeI‹¿tÜ
(0, 
o
, 
pos
));

1663 
	glB»ak
.
šüem’t
();

1664 
	g´eviousLšeBrokeCËªly
 = 
Œue
;

1666 
	g’d
;

1668 ià(!
	gb‘w“nWÜds
 || (
	gmidWÜdB»ak
 && !
	gautoW¿p
))

1669 
	gtmpW
 -ğ
add™iÚ®TmpW
;

1670 ià(
	gpos
 > 0 && 
	g¡r
[
pos
-1] =ğ
soáHyph’
)

1672 
tmpW
 -ğ
‹xtWidth
(
t
, 
pos
 - 1, 1, 
f
, 
w
 +mpW, 
isFixedP™ch
, 
cŞÏp£Wh™eS·û
);

1676 ià(
	gc
 =ğ'\n' && 
´e£rveNewlše
) {

1677 ià(!
¡İ³dIgnÜšgS·ûs
 && 
pos
 > 0) {

1679 
addMidpošt
(
lšeMidpoštS‹
, 
IÆšeI‹¿tÜ
(0, 
o
, 
pos
 - 1));

1680 
addMidpošt
(
lšeMidpoštS‹
, 
IÆšeI‹¿tÜ
(0, 
o
, 
pos
));

1682 
	glB»ak
.
	gobj
 = 
o
;

1683 
	glB»ak
.
	gpos
 = 
pos
;

1684 
	glB»ak
.
	gÃxtB»akabËPos™iÚ
 = 
ÃxtB»akabË
;

1685 
	glB»ak
.
šüem’t
();

1686 
	g´eviousLšeBrokeCËªly
 = 
Œue
;

1687  
	glB»ak
;

1690 ià(
	gautoW¿p
 && 
	gb‘w“nWÜds
) {

1691 
	gw
 +ğ
tmpW
;

1692 
	gw¿pW
 = 0;

1693 
	gtmpW
 = 0;

1694 
	glB»ak
.
	gobj
 = 
o
;

1695 
	glB»ak
.
	gpos
 = 
pos
;

1696 
	glB»ak
.
	gÃxtB»akabËPos™iÚ
 = 
ÃxtB»akabË
;

1699 
	gb»akWÜds
 = 
çl£
;

1702 ià(
	gmidWÜdB»ak
) {

1705 
	glB»ak
.
	gobj
 = 
o
;

1706 
	glB»ak
.
	gpos
 = 
pos
;

1707 
	glB»ak
.
	gÃxtB»akabËPos™iÚ
 = 
ÃxtB»akabË
;

1708 
	gmidWÜdB»ak
 &ğ(
b»akWÜds
 || 
b»akAÎ
);

1711 ià(
	gb‘w“nWÜds
) {

1712 
	gÏ¡S·ûWÜdS·cšg
 = 
­¶yWÜdS·cšg
 ? 
wÜdS·cšg
 : 0;

1713 
	gÏ¡S·û
 = 
pos
;

1716 ià(!
	gignÜšgS·ûs
 && 
	go
->
¡yË
()->
cŞÏp£Wh™eS·û
()) {

1720 ià(
	gcu¼’tCh¬aù”IsS·û
 && 
	g´eviousCh¬aù”IsS·û
) {

1721 
	gignÜšgS·ûs
 = 
Œue
;

1726 
addMidpošt
(
lšeMidpoštS‹
, 
ignÜeS¹
);

1729 } ià(
	gignÜšgS·ûs
) {

1732 
	gignÜšgS·ûs
 = 
çl£
;

1733 
	gÏ¡S·ûWÜdS·cšg
 = 
­¶yWÜdS·cšg
 ? 
wÜdS·cšg
 : 0;

1734 
	gÏ¡S·û
 = 
pos
;

1735 
addMidpošt
(
lšeMidpoštS‹
, 
IÆšeI‹¿tÜ
(0, 
o
, 
pos
));

1738 ià(
	gcu¼’tCh¬aù”IsS·û
 && !
	g´eviousCh¬aù”IsS·û
) {

1739 
	gignÜeS¹
.
	gobj
 = 
o
;

1740 
	gignÜeS¹
.
	gpos
 = 
pos
;

1743 ià(!
	gcu¼’tCh¬aù”IsWS
 && 
	g´eviousCh¬aù”IsWS
) {

1744 ià(
	gautoW¿p
 && 
	go
->
¡yË
()->
b»akOÆyAá”Wh™eS·û
()) {

1745 
	glB»ak
.
	gobj
 = 
o
;

1746 
	glB»ak
.
	gpos
 = 
pos
;

1747 
	glB»ak
.
	gÃxtB»akabËPos™iÚ
 = 
ÃxtB»akabË
;

1751 ià(
	gcŞÏp£Wh™eS·û
 && 
	gcu¼’tCh¬aù”IsS·û
 && !
	gignÜšgS·ûs
)

1752 
	gŒašgS·ûObjeù
 = 
o
;

1753 ià(!
	go
->
¡yË
()->
cŞÏp£Wh™eS·û
(è|| !
	gcu¼’tCh¬aù”IsS·û
)

1754 
	gŒašgS·ûObjeù
 = 0;

1756 
	gpos
++;

1757 
	gËn
--;

1758 
	g©S¹
 = 
çl£
;

1762 ià(!
	gignÜšgS·ûs
)

1763 
	gtmpW
 +ğ
‹xtWidth
(
t
, 
Ï¡S·û
, 
pos
 -†a¡S·û, 
f
, 
w
 + 
tmpW
, 
isFixedP™ch
, 
cŞÏp£Wh™eS·û
è+ 
	gÏ¡S·ûWÜdS·cšg
;

1764 
	gtmpW
 +ğ
šlšeWidth
(
o
, !
­¶›dS¹Width
, 
Œue
);

1766 
ASSERT_NOT_REACHED
();

1768 
R’d”Objeù
* 
	gÃxt
 = 
bidiNext
(
this
, 
o
);

1769 
boŞ
 
	gcheckFÜB»ak
 = 
autoW¿p
;

1770 ià(
	gw
 && w + 
	gtmpW
 > 
	gwidth
 && 
	glB»ak
.
	gobj
 && 
	gcu¼WS
 =ğ
NOWRAP
)

1771 
checkFÜB»ak
 = 
Œue
;

1772 ià(
	gÃxt
 && 
	go
->
isText
(è&&‚ext->isText(è&& !Ãxt->
isBR
()) {

1773 ià(
	gautoW¿p
 || (
	gÃxt
->
¡yË
()->
autoW¿p
())) {

1774 ià(
	gcu¼’tCh¬aù”IsS·û
)

1775 
	gcheckFÜB»ak
 = 
Œue
;

1777 
	gcheckFÜB»ak
 = 
çl£
;

1778 
R’d”Text
* 
	gÃxtText
 = 
toR’d”Text
(
Ãxt
);

1779 ià(
	gÃxtText
->
‹xtL’gth
()) {

1780 
UCh¬
 
	gc
 = 
ÃxtText
->
ch¬aù”s
()[0];

1781 ià(
	gc
 =ğ' ' || 
c
 =ğ'\t' || (ø=ğ'\n' && !
shouldP»£rveNewlše
(
Ãxt
)))

1785 
checkFÜB»ak
 = 
Œue
;

1786 } ià(
	gÃxtText
->
isWÜdB»ak
())

1787 
	gcheckFÜB»ak
 = 
Œue
;

1788 
boŞ
 
	gwlF™OnLše
 = 
w
 + 
tmpW
 <ğ
width
;

1789 ià(!
	gwlF™OnLše
 && !
	gw
) {

1790 
f™B–owFlßts
(
tmpW
, 
fœ¡Lše
, 
width
);

1791 
	gwlF™OnLše
 = 
tmpW
 <ğ
width
;

1793 
boŞ
 
	gÿnPÏûOnLše
 = 
wlF™OnLše
 || !
autoW¿pWasEv”TrueOnLše
;

1794 ià(
	gÿnPÏûOnLše
 && 
	gcheckFÜB»ak
) {

1795 
	gw
 +ğ
tmpW
;

1796 
	gtmpW
 = 0;

1797 
	glB»ak
.
	gobj
 = 
Ãxt
;

1798 
	glB»ak
.
	gpos
 = 0;

1799 
	glB»ak
.
	gÃxtB»akabËPos™iÚ
 = -1;

1805 ià(
	gcheckFÜB»ak
 && (
	gw
 + 
	gtmpW
 > 
	gwidth
)) {

1807 ià(
	gcu¼’tCh¬aù”IsS·û
 && !
	gignÜšgS·ûs
 && 
	go
->
¡yË
()->
cŞÏp£Wh™eS·û
())

1808 
	gŒašgS·ûObjeù
 = 0;

1810 ià(
	gw
)

1811 
	g’d
;

1813 
f™B–owFlßts
(
tmpW
, 
fœ¡Lše
, 
width
);

1818 ià(
	gw
 + 
	gtmpW
 > 
	gwidth
)

1819 
	g’d
;

1822 ià(!
	go
->
isFlßtšgOrPos™iÚed
()) {

1823 
	gÏ¡
 = 
o
;

1824 ià(
	gÏ¡
->
isR•Ïûd
(è&& 
	gautoW¿p
 && (!Ï¡->
isImage
(è|| 
	g®lowImagesToB»ak
è&& (!Ï¡->
isLi¡M¬k”
(è|| 
toR’d”Li¡M¬k”
(
Ï¡
)->
isInside
())) {

1825 
	gw
 +ğ
tmpW
;

1826 
	gtmpW
 = 0;

1827 
	glB»ak
.
	gobj
 = 
Ãxt
;

1828 
	glB»ak
.
	gpos
 = 0;

1829 
	glB»ak
.
	gÃxtB»akabËPos™iÚ
 = -1;

1833 
	go
 = 
Ãxt
;

1834 
	gÃxtB»akabË
 = -1;

1838 ià(!
	gcŞÏp£Wh™eS·û
)

1839 
	gcu¼’tCh¬aù”IsS·û
 = 
çl£
;

1841 
	gpos
 = 0;

1842 
	g©S¹
 = 
çl£
;

1846 ià(
	gw
 + 
	gtmpW
 <ğ
width
 || 
Ï¡WS
 =ğ
NOWRAP
) {

1847 
lB»ak
.
obj
 = 0;

1848 
	glB»ak
.
	gpos
 = 0;

1849 
	glB»ak
.
	gÃxtB»akabËPos™iÚ
 = -1;

1852 
	g’d
:

1853 ià(
lB»ak
 =ğ
»sŞv”
.
pos™iÚ
(è&& (!lB»ak.
obj
 || !lB»ak.obj->
isBR
())) {

1855 ià(
¡yË
()->
wh™eS·û
(è=ğ
PRE
) {

1857 ià(
pos
 != 0) {

1858 
lB»ak
.
obj
 = 
o
;

1859 
	glB»ak
.
	gpos
 = 
pos
 - 1;

1861 
	glB»ak
.
	gobj
 = 
Ï¡
;

1862 
	glB»ak
.
	gpos
 = 
Ï¡
->
isText
(è?†a¡->
Ëngth
() : 0;

1863 
	glB»ak
.
	gÃxtB»akabËPos™iÚ
 = -1;

1865 } ià(
	glB»ak
.
	gobj
) {

1869 
	glB»ak
.
	gobj
 = 
o
;

1870 
	glB»ak
.
	gpos
 = 
pos
;

1871 
	glB»ak
.
	gÃxtB»akabËPos™iÚ
 = -1;

1876 ià(
	glB»ak
 =ğ
»sŞv”
.
pos™iÚ
())

1877 
lB»ak
.
šüem’t
();

1880 
checkMidpošts
(
lšeMidpoštS‹
, 
lB»ak
);

1882 ià(
	gŒašgS·ûObjeù
) {

1886 ià(
	glšeMidpoštS‹
.
	gnumMidpošts
 % 2) {

1887 
IÆšeI‹¿tÜ
* 
	gmidpošts
 = 
lšeMidpoštS‹
.
midpošts
.
d©a
();

1888 
	gmidpošts
[
lšeMidpoštS‹
.
numMidpošts
 - 1].
	gpos
--;

1892 ià(
	glB»ak
.
	gobj
 =ğ0 && 
ŒašgS·ûObjeù
->
isText
()) {

1894 
R’d”Text
* 
‹xt
 = 
toR’d”Text
(
ŒašgS·ûObjeù
);

1895 
	gËngth
 = 
‹xt
->
‹xtL’gth
();

1896 
	gpos
 = 
Ëngth
 >ğ2 ?†’gth - 2 : 
UINT_MAX
;

1897 
IÆšeI‹¿tÜ
 
’dMid
(0, 
ŒašgS·ûObjeù
, 
pos
);

1898 
addMidpošt
(
lšeMidpoštS‹
, 
’dMid
);

1906 ià(
	glB»ak
.
	gpos
 > 0) {

1907 
	glB»ak
.
	gpos
--;

1908 
	glB»ak
.
šüem’t
();

1911 ià(
	glB»ak
.
	gobj
 &&†B»ak.
	gpos
 >ğ2 && 
lB»ak
.
obj
->
isText
()) {

1914 
UCh¬
 
c
 = 
toR’d”Text
(
lB»ak
.
obj
)->
ch¬aù”s
()[lB»ak.
pos
 - 1];

1915 ià(
	gc
 =ğ
soáHyph’
)

1916 
chİMidpoštsAt
(
lšeMidpoštS‹
, 
lB»ak
.
obj
,†B»ak.
pos
 - 2);

1919  
	glB»ak
;

1922 
	gR’d”Block
::
addOv”æowFromIÆšeChd»n
()

1924 
RoÙIÆšeBox
* 
cu¼
 = 
fœ¡RoÙBox
(); 
	gcu¼
; cu¼ = cu¼->
ÃxtRoÙBox
()) {

1925 
addLayoutOv”æow
(
cu¼
->
ÏyoutOv”æowReù
());

1926 ià(!
hasOv”æowCl
())

1927 
addVisu®Ov”æow
(
cu¼
->
visu®Ov”æowReù
());

1931 
	gR’d”Block
::
d–‘eEÎsisLšeBoxes
()

1933 
RoÙIÆšeBox
* 
cu¼
 = 
fœ¡RoÙBox
(); 
	gcu¼
; cu¼ = cu¼->
ÃxtRoÙBox
())

1934 
cu¼
->
ş—rTrunÿtiÚ
();

1937 
	gR’d”Block
::
checkLšesFÜTextOv”æow
()

1941 
TextRun
 
–lsisRun
(&
hÜizÚlEÎsis
, 1);

1942 
DEFINE_STATIC_LOCAL
(
AtomicSŒšg
, 
–lsisSŒ
, (&
hÜizÚlEÎsis
, 1));

1943 cÚ¡ 
	gFÚt
& 
	gfœ¡LšeFÚt
 = 
fœ¡LšeStyË
()->
fÚt
();

1944 cÚ¡ 
	gFÚt
& 
	gfÚt
 = 
¡yË
()->
fÚt
();

1945 
	gfœ¡LšeEÎsisWidth
 = 
fœ¡LšeFÚt
.
width
(
–lsisRun
);

1946 
	g–lsisWidth
 = (
fÚt
 =ğ
fœ¡LšeFÚt
è? 
fœ¡LšeEÎsisWidth
 : fÚt.
width
(
–lsisRun
);

1952 
boŞ
 
	gÉr
 = 
¡yË
()->
dœeùiÚ
(è=ğ
LTR
;

1953 
RoÙIÆšeBox
* 
	gcu¼
 = 
fœ¡RoÙBox
(); cu¼; cu¼ = 
cu¼
->
ÃxtRoÙBox
()) {

1954 
blockRightEdge
 = 
rightOff£t
(
cu¼
->
y
(), cu¼ =ğ
fœ¡RoÙBox
());

1955 
	gblockLeáEdge
 = 
ËáOff£t
(
cu¼
->
y
(), cu¼ =ğ
fœ¡RoÙBox
());

1956 
	glšeBoxEdge
 = 
Ér
 ? 
cu¼
->
x
(è+ cu¼->
width
() : curr->x();

1957 ià((
	gÉr
 && 
	glšeBoxEdge
 > 
	gblockRightEdge
è|| (!É¸&&†šeBoxEdg< 
	gblockLeáEdge
)) {

1962 
	gwidth
 = 
cu¼
 =ğ
fœ¡RoÙBox
(è? 
fœ¡LšeEÎsisWidth
 : 
–lsisWidth
;

1963 
	gblockEdge
 = 
Ér
 ? 
blockRightEdge
 : 
blockLeáEdge
;

1964 ià(
	gcu¼
->
ÿnAccommod©eEÎsis
(
Ér
, 
blockEdge
, 
lšeBoxEdge
, 
width
))

1965 
	gcu¼
->
¶aûEÎsis
(
–lsisSŒ
, 
Ér
, 
blockLeáEdge
, 
blockRightEdge
, 
width
);

	@RenderBox.cpp

25 
	~"cÚfig.h
"

26 
	~"R’d”Box.h
"

28 
	~"CachedImage.h
"

29 
	~"Chrome.h
"

30 
	~"ChromeCl›Á.h
"

31 
	~"Docum’t.h
"

32 
	~"F¿meV›w.h
"

33 
	~"G¿phicsCÚ‹xt.h
"

34 
	~"htmËd™šg.h
"

35 
	~"HTMLEËm’t.h
"

36 
	~"HTMLNames.h
"

37 
	~"ImageBufãr.h
"

38 
	~"FlßtQuad.h
"

39 
	~"F¿me.h
"

40 
	~"Page.h
"

41 
	~"R’d”A»Ç.h
"

42 
	~"R’d”FËxibËBox.h
"

43 
	~"R’d”IÆše.h
"

44 
	~"R’d”Lay”.h
"

45 
	~"R’d”TabËC–l.h
"

46 
	~"R’d”Theme.h
"

47 
	~"R’d”V›w.h
"

48 
	~"T¿nsfÜmS‹.h
"

49 
	~<®gÜ™hm
>

50 
	~<m©h.h
>

52 #ià
ENABLE
(
WML
)

53 
	~"WMLNames.h
"

56 
usšg
 
Çme¥aû
 
	g¡d
;

58 
Çme¥aû
 
	gWebCÜe
 {

60 
usšg
 
Çme¥aû
 
	gHTMLNames
;

63 
	gWTF
::
	tHashM­
<cÚ¡ 
	tR’d”Box
*, > 
	tOv”rideSizeM­
;

64 
Ov”rideSizeM­
* 
	ggOv”rideSizeM­
 = 0;

66 
boŞ
 
	gR’d”Box
::
s_hadOv”æowCl
 = 
çl£
;

68 
	gR’d”Box
::
R’d”Box
(
Node
* 
node
)

69 : 
R’d”BoxMod–Objeù
(
node
)

70 , 
m_m¬gšLeá
(0)

71 , 
m_m¬gšRight
(0)

72 , 
m_m¬gšTİ
(0)

73 , 
m_m¬gšBÙtom
(0)

74 , 
m_mšP»fWidth
(-1)

75 , 
m_maxP»fWidth
(-1)

76 , 
m_šlšeBoxW¿µ”
(0)

78 
£tIsBox
();

81 
	gR’d”Box
::~
R’d”Box
()

85 
R’d”Box
::
de¡roy
()

90 ià(
hasOv”rideSize
())

91 
gOv”rideSizeM­
->
»move
(
this
);

93 ià(
¡yË
(è&& (¡yË()->
height
().
isP”ûÁ
(è|| styË()->
mšHeight
().isP”ûÁ(è|| styË()->
maxHeight
().isPercent()))

94 
	gR’d”Block
::
»moveP”ûÁHeightDesûndªt
(
this
);

96 
	gR’d”BoxMod–Objeù
::
de¡roy
();

99 
	gR’d”Box
::
»moveFlßtšgOrPos™iÚedChdFromBlockLi¡s
()

101 
ASSERT
(
isFlßtšgOrPos™iÚed
());

103 ià(
docum’tBešgDe¡royed
())

106 ià(
isFlßtšg
()) {

107 
R’d”Block
* 
	gou‹rmo¡Block
 = 
cÚššgBlock
();

108 
R’d”Block
* 
	gp
 = 
ou‹rmo¡Block
;… && !p->
isR’d”V›w
();… = 
p
->
cÚššgBlock
()) {

109 ià(
p
->
cÚšsFlßt
(
this
))

110 
ou‹rmo¡Block
 = 
p
;

113 ià(
	gou‹rmo¡Block
)

114 
	gou‹rmo¡Block
->
m¬kAÎDesûndªtsW™hFlßtsFÜLayout
(
this
, 
çl£
);

117 ià(
isPos™iÚed
()) {

118 
R’d”Objeù
* 
	gp
;

119 
	gp
 = 
·»Á
();…;… = 
p
->parent()) {

120 ià(
p
->
isR’d”Block
())

121 
toR’d”Block
(
p
)->
»movePos™iÚedObjeù
(
this
);

126 
	gR’d”Box
::
¡yËWlChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ÃwStyË
)

128 
	gs_hadOv”æowCl
 = 
hasOv”æowCl
();

130 ià(
¡yË
()) {

133 ià(
	gdiff
 >ğ
StyËDifã»nûR•ašt
 && 
node
() &&

134 (
node
()->
hasTagName
(
htmlTag
è||‚ode()->hasTagName(
bodyTag
)))

135 
v›w
()->
»·št
();

139 ià(
	gdiff
 =ğ
StyËDifã»nûLayout
 && 
·»Á
(è&& 
¡yË
()->
pos™iÚ
(è!ğ
ÃwStyË
->position()) {

140 
m¬kCÚššgBlocksFÜLayout
();

141 ià(
¡yË
()->
pos™iÚ
(è=ğ
SticPos™iÚ
)

142 
»·št
();

143 ià(
	gÃwStyË
->
pos™iÚ
(è=ğ
AbsŞu‹Pos™iÚ
 || 
ÃwStyË
->pos™iÚ(è=ğ
FixedPos™iÚ
)

144 
·»Á
()->
£tChdN“dsLayout
(
Œue
);

145 ià(
isFlßtšg
(è&& !
isPos™iÚed
(è&& (
	gÃwStyË
->
pos™iÚ
(è=ğ
AbsŞu‹Pos™iÚ
 || 
ÃwStyË
->pos™iÚ(è=ğ
FixedPos™iÚ
))

146 
»moveFlßtšgOrPos™iÚedChdFromBlockLi¡s
();

149 ià(
F¿meV›w
 *
	gäameV›w
 = 
v›w
()->
äameV›w
()) {

150 
boŞ
 
ÃwStyËIsFixed
 = 
ÃwStyË
 &&‚ewStyË->
pos™iÚ
(è=ğ
FixedPos™iÚ
;

151 
boŞ
 
	gŞdStyËIsFixed
 = 
¡yË
(è&& styË()->
pos™iÚ
(è=ğ
FixedPos™iÚ
;

152 ià(
	gÃwStyËIsFixed
 !ğ
ŞdStyËIsFixed
) {

153 ià(
ÃwStyËIsFixed
)

154 
äameV›w
->
addFixedObjeù
();

156 
	gäameV›w
->
»moveFixedObjeù
();

160 
	gR’d”BoxMod–Objeù
::
¡yËWlChªge
(
diff
, 
ÃwStyË
);

163 
	gR’d”Box
::
¡yËDidChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
)

165 
	gR’d”BoxMod–Objeù
::
¡yËDidChªge
(
diff
, 
ŞdStyË
);

167 ià(
ÃedsLayout
(è&& 
	gŞdStyË
 && (ŞdStyË->
height
().
isP”ûÁ
(è|| oldStyË->
mšHeight
().isP”ûÁ(è|| oldStyË->
maxHeight
().isPercent()))

168 
	gR’d”Block
::
»moveP”ûÁHeightDesûndªt
(
this
);

172 ià(
hasOv”æowCl
(è&& 
	gŞdStyË
 && 
¡yË
(è&& oldStyË->
efãùiveZoom
() != style()->effectiveZoom()) {

173 
Ëá
 = 
süŞlLeá
();

174 ià(
	gËá
) {

175 
	gËá
 = (
Ëá
 / 
ŞdStyË
->
efãùiveZoom
()è* 
¡yË
()->effectiveZoom();

176 
£tSüŞlLeá
(
Ëá
);

178 
	gtİ
 = 
süŞlTİ
();

179 ià(
	gtİ
) {

180 
	gtİ
 = (
tİ
 / 
ŞdStyË
->
efãùiveZoom
()è* 
¡yË
()->effectiveZoom();

181 
£tSüŞlTİ
(
tİ
);

186 ià(
isBody
())

187 
docum’t
()->
£tTextCŞÜ
(
¡yË
()->
cŞÜ
());

190 
	gR’d”Box
::
upd©eBoxMod–InfoFromStyË
()

192 
R’d”BoxMod–Objeù
::
upd©eBoxMod–InfoFromStyË
();

194 
boŞ
 
	gisRoÙObjeù
 = 
isRoÙ
();

195 
boŞ
 
	gisV›wObjeù
 = 
isR’d”V›w
();

198 ià(
	gisRoÙObjeù
 || 
	gisV›wObjeù
)

199 
£tHasBoxDecÜ©iÚs
(
Œue
);

201 
£tPos™iÚed
(
¡yË
()->
pos™iÚ
(è=ğ
AbsŞu‹Pos™iÚ
 || styË()->pos™iÚ(è=ğ
FixedPos™iÚ
);

202 
£tFlßtšg
(!
isPos™iÚed
(è&& 
¡yË
()->
isFlßtšg
());

205 ià(
¡yË
()->
ov”æowX
(è!ğ
OVISIBLE
 && !
isRoÙObjeù
 && (
isR’d”Block
(è|| 
isTabËRow
(è|| 
isTabËSeùiÚ
())) {

206 
boŞ
 
boxHasOv”æowCl
 = 
Œue
;

207 ià(
isBody
()) {

212 ià(
docum’t
()->
docum’tEËm’t
()->
hasTagName
(
htmlTag
) &&

213 
docum’t
()->
body
(è=ğ
node
() &&

214 
docum’t
()->
docum’tEËm’t
()->
»nd””
()->
¡yË
()->
ov”æowX
(è=ğ
OVISIBLE
)

215 
boxHasOv”æowCl
 = 
çl£
;

220 ià(
	gboxHasOv”æowCl
) {

221 ià(!
	gs_hadOv”æowCl
)

223 
»·št
();

224 
£tHasOv”æowCl
();

228 
£tHasT¿nsfÜm
(
¡yË
()->
hasT¿nsfÜmR–©edPrİ”ty
());

229 
£tHasReæeùiÚ
(
¡yË
()->
boxReæeù
());

232 
	gR’d”Box
::
Ïyout
()

234 
ASSERT
(
ÃedsLayout
());

236 
R’d”Objeù
* 
	gchd
 = 
fœ¡Chd
();

237 ià(!
	gchd
) {

238 
£tN“dsLayout
(
çl£
);

242 
LayoutS‹Mašš”
 
¡©ePush”
(
v›w
(), 
this
, 
IÁSize
(
x
(), 
y
()));

243 
	gchd
) {

244 
	gchd
->
ÏyoutIfN“ded
();

245 
ASSERT
(!
chd
->
ÃedsLayout
());

246 
	gchd
 = 
chd
->
ÃxtSiblšg
();

248 
	g¡©ePush”
.
pİ
();

249 
£tN“dsLayout
(
çl£
);

254 
	gR’d”Box
::
ş›ÁWidth
() const

256  
width
(è- 
bÜd”Leá
(è- 
bÜd”Right
(è- 
v”tiÿlSüŞlb¬Width
();

259 
	gR’d”Box
::
ş›ÁHeight
() const

261  
height
(è- 
bÜd”Tİ
(è- 
bÜd”BÙtom
(è- 
hÜizÚlSüŞlb¬Height
();

264 
	gR’d”Box
::
süŞlWidth
() const

266 ià(
hasOv”æowCl
())

267  
Ïy”
()->
süŞlWidth
();

269 ià(
¡yË
()->
dœeùiÚ
(è=ğ
LTR
)

270  
max
(
ş›ÁWidth
(), 
rightmo¡Pos™iÚ
(
Œue
, 
çl£
è- 
bÜd”Leá
());

271  
ş›ÁWidth
(è- 
mš
(0, 
Ëámo¡Pos™iÚ
(
Œue
, 
çl£
è- 
bÜd”Leá
());

274 
	gR’d”Box
::
süŞlHeight
() const

276 ià(
hasOv”æowCl
())

277  
Ïy”
()->
süŞlHeight
();

279  
max
(
ş›ÁHeight
(), 
lowe¡Pos™iÚ
(
Œue
, 
çl£
è- 
bÜd”Tİ
());

282 
	gR’d”Box
::
süŞlLeá
() const

284  
hasOv”æowCl
(è? 
Ïy”
()->
süŞlXOff£t
() : 0;

287 
	gR’d”Box
::
süŞlTİ
() const

289  
hasOv”æowCl
(è? 
Ïy”
()->
süŞlYOff£t
() : 0;

292 
	gR’d”Box
::
£tSüŞlLeá
(
ÃwLeá
)

294 ià(
hasOv”æowCl
())

295 
Ïy”
()->
süŞlToXOff£t
(
ÃwLeá
);

298 
	gR’d”Box
::
£tSüŞlTİ
(
ÃwTİ
)

300 ià(
hasOv”æowCl
())

301 
Ïy”
()->
süŞlToYOff£t
(
ÃwTİ
);

304 
	gR’d”Box
::
absŞu‹Reùs
(
VeùÜ
<
IÁReù
>& 
»ùs
, 
tx
, 
ty
)

306 
	g»ùs
.
­³nd
(
IÁReù
(
tx
, 
ty
, 
width
(), 
height
()));

309 
	gR’d”Box
::
absŞu‹Quads
(
VeùÜ
<
FlßtQuad
>& 
quads
)

311 
quads
.
­³nd
(
loÿlToAbsŞu‹Quad
(
FlßtReù
(0, 0, 
width
(), 
height
())));

314 
IÁReù
 
	gR’d”Box
::
absŞu‹CÚ‹ÁBox
() const

316 
IÁReù
 
»ù
 = 
cÚ‹ÁBoxReù
();

317 
FlßtPošt
 
	gabsPos
 = 
loÿlToAbsŞu‹
(FloatPoint());

318 
	g»ù
.
move
(
absPos
.
x
(),‡bsPos.
y
());

319  
	g»ù
;

322 
FlßtQuad
 
	gR’d”Box
::
absŞu‹CÚ‹ÁQuad
() const

324 
IÁReù
 
»ù
 = 
cÚ‹ÁBoxReù
();

325  
loÿlToAbsŞu‹Quad
(
FlßtReù
(
»ù
));

328 
IÁReù
 
	gR’d”Box
::
oušeBoundsFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
IÁPošt
* 
ÿchedOff£tToR•aštCÚš”
) const

330 
IÁReù
 
	gbox
 = 
bÜd”BoundšgBox
();

331 
adju¡ReùFÜOušeAndShadow
(
box
);

333 
FlßtQuad
 
	gcÚš”R–©iveQuad
 = 
FlßtReù
(
box
);

334 ià(
	gÿchedOff£tToR•aštCÚš”
)

335 
	gcÚš”R–©iveQuad
.
move
(
ÿchedOff£tToR•aštCÚš”
->
x
(), cachedOff£tToR•aštCÚš”->
y
());

337 
	gcÚš”R–©iveQuad
 = 
loÿlToCÚš”Quad
(
cÚš”R–©iveQuad
, 
»·štCÚš”
);

339 
	gbox
 = 
cÚš”R–©iveQuad
.
’şosšgBoundšgBox
();

343 
	gbox
.
move
(
v›w
()->
ÏyoutD–
());

345  
	gbox
;

348 
	gR’d”Box
::
addFocusRšgReùs
(
VeùÜ
<
IÁReù
>& 
»ùs
, 
tx
, 
ty
)

350 ià(
width
(è&& 
height
())

351 
	g»ùs
.
­³nd
(
IÁReù
(
tx
, 
ty
, 
width
(), 
height
()));

354 
IÁReù
 
	gR’d”Box
::
»æeùiÚBox
() const

356 
IÁReù
 
»suÉ
;

357 ià(!
¡yË
()->
boxReæeù
())

358  
	g»suÉ
;

359 
IÁReù
 
	gbox
 = 
bÜd”BoxReù
();

360 
	g»suÉ
 = 
box
;

361 
¡yË
()->
boxReæeù
()->
dœeùiÚ
()) {

362 
	gReæeùiÚB–ow
:

363 
»suÉ
.
move
(0, 
box
.
height
(è+ 
»æeùiÚOff£t
());

365 
	gReæeùiÚAbove
:

366 
»suÉ
.
move
(0, -
box
.
height
(è- 
»æeùiÚOff£t
());

368 
	gReæeùiÚLeá
:

369 
»suÉ
.
move
(-
box
.
width
(è- 
»æeùiÚOff£t
(), 0);

371 
	gReæeùiÚRight
:

372 
»suÉ
.
move
(
box
.
width
(è+ 
»æeùiÚOff£t
(), 0);

375  
	g»suÉ
;

378 
	gR’d”Box
::
»æeùiÚOff£t
() const

380 ià(!
¡yË
()->
boxReæeù
())

382 ià(
¡yË
()->
boxReæeù
()->
dœeùiÚ
(è=ğ
ReæeùiÚLeá
 || styË()->boxReæeù()->dœeùiÚ(è=ğ
ReæeùiÚRight
)

383  
¡yË
()->
boxReæeù
()->
off£t
().
ÿlcV®ue
(
bÜd”BoxReù
().
width
());

384  
¡yË
()->
boxReæeù
()->
off£t
().
ÿlcV®ue
(
bÜd”BoxReù
().
height
());

387 
IÁReù
 
	gR’d”Box
::
»æeùedReù
(cÚ¡ IÁReù& 
r
) const

389 ià(!
¡yË
()->
boxReæeù
())

390  
IÁReù
();

392 
IÁReù
 
	gbox
 = 
bÜd”BoxReù
();

393 
IÁReù
 
	g»suÉ
 = 
r
;

394 
¡yË
()->
boxReæeù
()->
dœeùiÚ
()) {

395 
	gReæeùiÚB–ow
:

396 
»suÉ
.
£tY
(
box
.
bÙtom
(è+ 
»æeùiÚOff£t
(è+ (box.bÙtom(è- 
r
.bottom()));

398 
	gReæeùiÚAbove
:

399 
»suÉ
.
£tY
(
box
.
y
(è- 
»æeùiÚOff£t
(è- box.
height
(è+ (box.
bÙtom
(è- 
r
.bottom()));

401 
	gReæeùiÚLeá
:

402 
»suÉ
.
£tX
(
box
.
x
(è- 
»æeùiÚOff£t
(è- box.
width
(è+ (box.
right
(è- 
r
.right()));

404 
	gReæeùiÚRight
:

405 
»suÉ
.
£tX
(
box
.
right
(è+ 
»æeùiÚOff£t
(è+ (box.right(è- 
r
.right()));

408  
	g»suÉ
;

411 
	gR’d”Box
::
v”tiÿlSüŞlb¬Width
() const

413  
šşudeV”tiÿlSüŞlb¬Size
(è? 
Ïy”
()->
v”tiÿlSüŞlb¬Width
() : 0;

416 
	gR’d”Box
::
hÜizÚlSüŞlb¬Height
() const

418  
šşudeHÜizÚlSüŞlb¬Size
(è? 
Ïy”
()->
hÜizÚlSüŞlb¬Height
() : 0;

421 
boŞ
 
	gR’d”Box
::
süŞl
(
SüŞlDœeùiÚ
 
dœeùiÚ
, 
SüŞlG¿nuÏr™y
 
g¿nuÏr™y
, 
muÉl›r
, 
Node
** 
¡İNode
)

423 
R’d”Lay”
* 
	gl
 = 
Ïy”
();

424 ià(
	gl
 &&†->
süŞl
(
dœeùiÚ
, 
g¿nuÏr™y
, 
muÉl›r
)) {

425 ià(
	g¡İNode
)

426 *
	g¡İNode
 = 
node
();

427  
	gŒue
;

430 ià(
	g¡İNode
 && *¡İNod&& *¡İNod=ğ
node
())

431  
Œue
;

433 
R’d”Block
* 
	gb
 = 
cÚššgBlock
();

434 ià(
	gb
 && !b->
isR’d”V›w
())

435  
	gb
->
süŞl
(
dœeùiÚ
, 
g¿nuÏr™y
, 
muÉl›r
, 
¡İNode
);

436  
	gçl£
;

439 
boŞ
 
	gR’d”Box
::
ÿnBeSüŞËdAndHasSüŞÏbËA»a
() const

441  
ÿnBeProg¿m©iÿÎySüŞËd
(
çl£
è&& (
süŞlHeight
(è!ğ
ş›ÁHeight
(è|| 
süŞlWidth
(è!ğ
ş›ÁWidth
());

444 
boŞ
 
	gR’d”Box
::
ÿnBeProg¿m©iÿÎySüŞËd
(bool) const

446  (
hasOv”æowCl
(è&& (
süŞlsOv”æow
(è|| (
node
(è&&‚ode()->
isCÚ‹ÁEd™abË
()))è|| (node(è&&‚ode()->
isDocum’tNode
());

449 
	gR’d”Box
::
autosüŞl
()

451 ià(
Ïy”
())

452 
Ïy”
()->
autosüŞl
();

455 
	gR’d”Box
::
·nSüŞl
(cÚ¡ 
IÁPošt
& 
sourû
)

457 ià(
Ïy”
())

458 
Ïy”
()->
·nSüŞlFromPošt
(
sourû
);

461 
	gR’d”Box
::
mšP»fWidth
() const

463 ià(
´efWidthsDœty
())

464 
cÚ¡_ÿ¡
<
R’d”Box
*>(
this
)->
ÿlcP»fWidths
();

466  
	gm_mšP»fWidth
;

469 
	gR’d”Box
::
maxP»fWidth
() const

471 ià(
´efWidthsDœty
())

472 
cÚ¡_ÿ¡
<
R’d”Box
*>(
this
)->
ÿlcP»fWidths
();

474  
	gm_maxP»fWidth
;

477 
	gR’d”Box
::
ov”rideSize
() const

479 ià(!
hasOv”rideSize
())

481  
	ggOv”rideSizeM­
->
g‘
(
this
);

484 
	gR’d”Box
::
£tOv”rideSize
(
s
)

486 ià(
s
 == -1) {

487 ià(
hasOv”rideSize
()) {

488 
£tHasOv”rideSize
(
çl£
);

489 
	ggOv”rideSizeM­
->
»move
(
this
);

492 ià(!
	ggOv”rideSizeM­
)

493 
	ggOv”rideSizeM­
 = 
Ãw
 
Ov”rideSizeM­
();

494 
£tHasOv”rideSize
(
Œue
);

495 
	ggOv”rideSizeM­
->
£t
(
this
, 
s
);

499 
	gR’d”Box
::
ov”rideWidth
() const

501  
hasOv”rideSize
(è? 
ov”rideSize
(è: 
width
();

504 
	gR’d”Box
::
ov”rideHeight
() const

506  
hasOv”rideSize
(è? 
ov”rideSize
(è: 
height
();

509 
	gR’d”Box
::
ÿlcBÜd”BoxWidth
(
width
) const

511 
bÜd”sPlusPaddšg
 = 
bÜd”Leá
(è+ 
bÜd”Right
(è+ 
·ddšgLeá
(è+ 
·ddšgRight
();

512 ià(
¡yË
()->
boxSizšg
(è=ğ
CONTENT_BOX
)

513  
width
 + 
bÜd”sPlusPaddšg
;

514  
max
(
width
, 
bÜd”sPlusPaddšg
);

517 
	gR’d”Box
::
ÿlcBÜd”BoxHeight
(
height
) const

519 
bÜd”sPlusPaddšg
 = 
bÜd”Tİ
(è+ 
bÜd”BÙtom
(è+ 
·ddšgTİ
(è+ 
·ddšgBÙtom
();

520 ià(
¡yË
()->
boxSizšg
(è=ğ
CONTENT_BOX
)

521  
height
 + 
bÜd”sPlusPaddšg
;

522  
max
(
height
, 
bÜd”sPlusPaddšg
);

525 
	gR’d”Box
::
ÿlcCÚ‹ÁBoxWidth
(
width
) const

527 ià(
¡yË
()->
boxSizšg
(è=ğ
BORDER_BOX
)

528 
width
 -ğ(
bÜd”Leá
(è+ 
bÜd”Right
(è+ 
·ddšgLeá
(è+ 
·ddšgRight
());

529  
max
(0, 
width
);

532 
	gR’d”Box
::
ÿlcCÚ‹ÁBoxHeight
(
height
) const

534 ià(
¡yË
()->
boxSizšg
(è=ğ
BORDER_BOX
)

535 
height
 -ğ(
bÜd”Tİ
(è+ 
bÜd”BÙtom
(è+ 
·ddšgTİ
(è+ 
·ddšgBÙtom
());

536  
max
(0, 
height
);

540 
boŞ
 
	gR’d”Box
::
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
& 
»que¡
, 
H™Te¡ResuÉ
& 
»suÉ
, 
xPos
, 
yPos
, 
tx
, 
ty
, 
H™Te¡AùiÚ
 
aùiÚ
)

542 
	gtx
 +ğ
x
();

543 
	gty
 +ğ
y
();

546 
R’d”Objeù
* 
	gchd
 = 
Ï¡Chd
(); chd; chd = 
chd
->
´eviousSiblšg
()) {

547 ià(!
chd
->
hasLay”
(è&& chd->
nodeAtPošt
(
»que¡
, 
»suÉ
, 
xPos
, 
yPos
, 
tx
, 
ty
, 
aùiÚ
)) {

548 
upd©eH™Te¡ResuÉ
(
»suÉ
, 
IÁPošt
(
xPos
 - 
tx
, 
yPos
 - 
ty
));

549  
	gŒue
;

555 ià(
visibËToH™Te¡šg
(è&& 
	gaùiÚ
 =ğ
H™Te¡FÜeground
 && 
IÁReù
(
tx
, 
ty
, 
width
(), 
height
()).
cÚšs
(
xPos
, 
yPos
)) {

556 
upd©eH™Te¡ResuÉ
(
»suÉ
, 
IÁPošt
(
xPos
 - 
tx
, 
yPos
 - 
ty
));

557  
	gŒue
;

560  
	gçl£
;

565 
	gR’d”Box
::
·št
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

567 
	gtx
 +ğ
x
();

568 
	gty
 +ğ
y
();

571 
PaštInfo
 
chdInfo
(
·štInfo
);

572 
	gchdInfo
.
	g·štšgRoÙ
 = 
·štšgRoÙFÜChd»n
(
·štInfo
);

573 
R’d”Objeù
* 
	gchd
 = 
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
())

574 
chd
->
·št
(
chdInfo
, 
tx
, 
ty
);

577 
	gR’d”Box
::
·štRoÙBoxDecÜ©iÚs
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

579 cÚ¡ 
FlLay”
* 
	gbgLay”
 = 
¡yË
()->
backgroundLay”s
();

580 
CŞÜ
 
	gbgCŞÜ
 = 
¡yË
()->
backgroundCŞÜ
();

581 
R’d”Objeù
* 
	gbodyObjeù
 = 0;

582 ià(!
¡yË
()->
hasBackground
(è&& 
node
(è&&‚ode()->
hasTagName
(
HTMLNames
::
htmlTag
)) {

587 
HTMLEËm’t
* 
body
 = 
docum’t
()->body();

588 
	gbodyObjeù
 = (
body
 && body->
hasLoÿlName
(
bodyTag
)è? body->
»nd””
() : 0;

589 ià(
	gbodyObjeù
) {

590 
	gbgLay”
 = 
bodyObjeù
->
¡yË
()->
backgroundLay”s
();

591 
	gbgCŞÜ
 = 
bodyObjeù
->
¡yË
()->
backgroundCŞÜ
();

595 
	gw
 = 
width
();

596 
	gh
 = 
height
();

598 
	grw
;

599 
	grh
;

600 ià(
v›w
()->
äameV›w
()) {

601 
	grw
 = 
v›w
()->
äameV›w
()->
cÚ‹ÁsWidth
();

602 
	grh
 = 
v›w
()->
äameV›w
()->
cÚ‹ÁsHeight
();

604 
	grw
 = 
v›w
()->
width
();

605 
	grh
 = 
v›w
()->
height
();

611 
	gbx
 = 
tx
 - 
m¬gšLeá
();

612 
	gby
 = 
ty
 - 
m¬gšTİ
();

613 
	gbw
 = 
max
(
w
 + 
m¬gšLeá
(è+ 
m¬gšRight
(è+ 
bÜd”Leá
(è+ 
bÜd”Right
(), 
rw
);

614 
	gbh
 = 
max
(
h
 + 
m¬gšTİ
(è+ 
m¬gšBÙtom
(è+ 
bÜd”Tİ
(è+ 
bÜd”BÙtom
(), 
rh
);

616 
·štFlLay”s
(
·štInfo
, 
bgCŞÜ
, 
bgLay”
, 
bx
, 
by
, 
bw
, 
bh
, 
Compos™eSourûOv”
, 
bodyObjeù
);

618 ià(
¡yË
()->
hasBÜd”
(è&& styË()->
di¥Ïy
(è!ğ
INLINE
)

619 
·štBÜd”
(
·štInfo
.
cÚ‹xt
, 
tx
, 
ty
, 
w
, 
h
, 
¡yË
());

622 
	gR’d”Box
::
·štBoxDecÜ©iÚs
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

624 ià(!
shouldPaštW™hšRoÙ
(
·štInfo
))

627 ià(
isRoÙ
()) {

628 
·štRoÙBoxDecÜ©iÚs
(
·štInfo
, 
tx
, 
ty
);

632 
	gw
 = 
width
();

633 
	gh
 = 
height
();

637 
bÜd”F™Adju¡
(
tx
, 
w
);

641 
·štBoxShadow
(
·štInfo
.
cÚ‹xt
, 
tx
, 
ty
, 
w
, 
h
, 
¡yË
(), 
NÜm®
);

645 
boŞ
 
	gthemePaš‹d
 = 
¡yË
()->
hasAµ—¿nû
(è&& !
theme
()->
·št
(
this
, 
·štInfo
, 
IÁReù
(
tx
, 
ty
, 
w
, 
h
));

646 ià(!
	gthemePaš‹d
) {

650 ià(!
isBody
(è|| 
docum’t
()->
docum’tEËm’t
()->
»nd””
()->
¡yË
()->
hasBackground
())

651 
·štFlLay”s
(
·štInfo
, 
¡yË
()->
backgroundCŞÜ
(), styË()->
backgroundLay”s
(), 
tx
, 
ty
, 
w
, 
h
);

652 ià(
¡yË
()->
hasAµ—¿nû
())

653 
theme
()->
·štDecÜ©iÚs
(
this
, 
·štInfo
, 
IÁReù
(
tx
, 
ty
, 
w
, 
h
));

655 
·štBoxShadow
(
·štInfo
.
cÚ‹xt
, 
tx
, 
ty
, 
w
, 
h
, 
¡yË
(), 
In£t
);

658 ià((!
¡yË
()->
hasAµ—¿nû
(è|| (!
	gthemePaš‹d
 && 
theme
()->
·štBÜd”OÆy
(
this
, 
·štInfo
, 
IÁReù
(
tx
, 
ty
, 
w
, 
h
)))è&& styË()->
hasBÜd”
())

659 
·štBÜd”
(
·štInfo
.
cÚ‹xt
, 
tx
, 
ty
, 
w
, 
h
, 
¡yË
());

662 
	gR’d”Box
::
·štMask
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

664 ià(!
shouldPaštW™hšRoÙ
(
·štInfo
è|| 
¡yË
()->
visib™y
(è!ğ
VISIBLE
 ||…aštInfo.
pha£
 !ğ
PaštPha£Mask
)

667 
	gw
 = 
width
();

668 
	gh
 = 
height
();

672 
bÜd”F™Adju¡
(
tx
, 
w
);

674 
·štMaskImages
(
·štInfo
, 
tx
, 
ty
, 
w
, 
h
);

677 
	gR’d”Box
::
·štMaskImages
(cÚ¡ 
PaštInfo
& 
·štInfo
, 
tx
, 
ty
, 
w
, 
h
)

680 
boŞ
 
	gpushT¿n¥¬’cyLay”
 = 
çl£
;

681 
boŞ
 
	gcompos™edMask
 = 
hasLay”
(è&& 
Ïy”
()->
hasCompos™edMask
();

682 
Compos™eO³¿tÜ
 
	gcompos™eOp
 = 
Compos™eSourûOv”
;

684 
boŞ
 
	g®lMaskImagesLßded
 = 
Œue
;

686 ià(!
	gcompos™edMask
) {

687 
StyËImage
* 
	gmaskBoxImage
 = 
¡yË
()->
maskBoxImage
().
image
();

688 cÚ¡ 
FlLay”
* 
	gmaskLay”s
 = 
¡yË
()->
maskLay”s
();

691 ià(
	gmaskBoxImage
)

692 
	g®lMaskImagesLßded
 &ğ
maskBoxImage
->
isLßded
();

694 ià(
	gmaskLay”s
)

695 
	g®lMaskImagesLßded
 &ğ
maskLay”s
->
imagesA»Lßded
();

698 ià(!
	g®lMaskImagesLßded
)

699 
	gpushT¿n¥¬’cyLay”
 = 
Œue
;

701 ià(
	gmaskBoxImage
 && 
	gmaskLay”s
->
hasImage
()) {

703 
	gpushT¿n¥¬’cyLay”
 = 
Œue
;

712 cÚ¡ 
FlLay”
* 
	gflLay”
 = 
maskLay”s
->
Ãxt
(); flLay”; flLay” = 
flLay”
->next()) {

713 ià(
flLay”
->
hasImage
(è&& flLay”->
image
()->
ÿnR’d”
(
¡yË
()->
efãùiveZoom
())) {

714 
pushT¿n¥¬’cyLay”
 = 
Œue
;

721 
	gcompos™eOp
 = 
Compos™eDe¡š©iÚIn
;

722 ià(
	gpushT¿n¥¬’cyLay”
) {

723 
	g·štInfo
.
	gcÚ‹xt
->
£tCompos™eO³¿tiÚ
(
Compos™eDe¡š©iÚIn
);

724 
	g·štInfo
.
	gcÚ‹xt
->
begšT¿n¥¬’cyLay”
(1.0f);

725 
	gcompos™eOp
 = 
Compos™eSourûOv”
;

729 ià(
	g®lMaskImagesLßded
) {

730 
·štFlLay”s
(
·štInfo
, 
CŞÜ
(), 
¡yË
()->
maskLay”s
(), 
tx
, 
ty
, 
w
, 
h
, 
compos™eOp
);

731 
·štNšeP›ûImage
(
·štInfo
.
cÚ‹xt
, 
tx
, 
ty
, 
w
, 
h
, 
¡yË
(), styË()->
maskBoxImage
(), 
compos™eOp
);

734 ià(
	gpushT¿n¥¬’cyLay”
)

735 
	g·štInfo
.
	gcÚ‹xt
->
’dT¿n¥¬’cyLay”
();

738 
IÁReù
 
	gR’d”Box
::
maskClReù
()

740 
IÁReù
 
bbox
 = 
bÜd”BoxReù
();

741 ià(
¡yË
()->
maskBoxImage
().
image
())

742  
	gbbox
;

744 
IÁReù
 
	g»suÉ
;

745 cÚ¡ 
FlLay”
* 
	gmaskLay”
 = 
¡yË
()->
maskLay”s
(); maskLay”; maskLay” = 
maskLay”
->
Ãxt
()) {

746 ià(
maskLay”
->
image
()) {

747 
IÁReù
 
maskReù
;

748 
IÁPošt
 
	gpha£
;

749 
IÁSize
 
	gteSize
;

750 
ÿlcuÏ‹BackgroundImageGeom‘ry
(
maskLay”
, 
bbox
.
x
(), bbox.
y
(), bbox.
width
(), bbox.
height
(), 
maskReù
, 
pha£
, 
teSize
);

751 
	g»suÉ
.
un™e
(
maskReù
);

754  
	g»suÉ
;

757 
	gR’d”Box
::
·štFlLay”s
(cÚ¡ 
PaštInfo
& 
·štInfo
, cÚ¡ 
CŞÜ
& 
c
, cÚ¡ 
FlLay”
* 
flLay”
, 
tx
, 
ty
, 
width
, 
height
, 
Compos™eO³¿tÜ
 
İ
, 
R’d”Objeù
* 
backgroundObjeù
)

759 ià(!
	gflLay”
)

762 
·štFlLay”s
(
·štInfo
, 
c
, 
flLay”
->
Ãxt
(), 
tx
, 
ty
, 
width
, 
height
, 
İ
, 
backgroundObjeù
);

763 
·štFlLay”
(
·štInfo
, 
c
, 
flLay”
, 
tx
, 
ty
, 
width
, 
height
, 
İ
, 
backgroundObjeù
);

766 
	gR’d”Box
::
·štFlLay”
(cÚ¡ 
PaštInfo
& 
·štInfo
, cÚ¡ 
CŞÜ
& 
c
, cÚ¡ 
FlLay”
* 
flLay”
, 
tx
, 
ty
, 
width
, 
height
, 
Compos™eO³¿tÜ
 
İ
, 
R’d”Objeù
* 
backgroundObjeù
)

768 
·štFlLay”Ex‹nded
(
·štInfo
, 
c
, 
flLay”
, 
tx
, 
ty
, 
width
, 
height
, 0, 
İ
, 
backgroundObjeù
);

771 
	gR’d”Box
::
imageChªged
(
W¿µedImagePŒ
 
image
, cÚ¡ 
IÁReù
*)

773 ià(!
·»Á
())

776 ià((
¡yË
()->
bÜd”Image
().
image
(è&& styË()->bÜd”Image().image()->
d©a
() == image) ||

777 (
¡yË
()->
maskBoxImage
().
image
(è&& styË()->maskBoxImage().image()->
d©a
() == image)) {

778 
»·št
();

782 
boŞ
 
	gdidFuÎR•ašt
 = 
»·štLay”ReùsFÜImage
(
image
, 
¡yË
()->
backgroundLay”s
(), 
Œue
);

783 ià(!
	gdidFuÎR•ašt
)

784 
»·štLay”ReùsFÜImage
(
image
, 
¡yË
()->
maskLay”s
(), 
çl£
);

787 
boŞ
 
	gR’d”Box
::
»·štLay”ReùsFÜImage
(
W¿µedImagePŒ
 
image
, cÚ¡ 
FlLay”
* 
Ïy”s
, boŞ 
d¿wšgBackground
)

789 
IÁReù
 
	g»nd””Reù
;

790 
R’d”Box
* 
	gÏy”R’d””
 = 0;

792 cÚ¡ 
FlLay”
* 
	gcurLay”
 = 
Ïy”s
; curLay”; curLay” = 
curLay”
->
Ãxt
()) {

793 ià(
curLay”
->
image
(è&& imag=ğcurLay”->image()->
d©a
(è&& curLay”->image()->
ÿnR’d”
(
¡yË
()->
efãùiveZoom
())) {

796 ià(!
Ïy”R’d””
) {

797 
boŞ
 
d¿wšgRoÙBackground
 = 
d¿wšgBackground
 && (
isRoÙ
(è|| (
isBody
(è&& !
docum’t
()->
docum’tEËm’t
()->
»nd””
()->
¡yË
()->
hasBackground
()));

798 ià(
	gd¿wšgRoÙBackground
) {

799 
	gÏy”R’d””
 = 
v›w
();

801 
	grw
;

802 
	grh
;

804 ià(
F¿meV›w
* 
	gäameV›w
 = 
toR’d”V›w
(
Ïy”R’d””
)->
äameV›w
()) {

805 
rw
 = 
äameV›w
->
cÚ‹ÁsWidth
();

806 
	grh
 = 
äameV›w
->
cÚ‹ÁsHeight
();

808 
	grw
 = 
Ïy”R’d””
->
width
();

809 
	grh
 = 
Ïy”R’d””
->
height
();

811 
	g»nd””Reù
 = 
IÁReù
(-
Ïy”R’d””
->
m¬gšLeá
(),

812 -
Ïy”R’d””
->
m¬gšTİ
(),

813 
max
(
Ïy”R’d””
->
width
(è+†ay”R’d””->
m¬gšLeá
(è+†ay”R’d””->
m¬gšRight
(è+†ay”R’d””->
bÜd”Leá
(è+†ay”R’d””->
bÜd”Right
(), 
rw
),

814 
max
(
Ïy”R’d””
->
height
(è+†ay”R’d””->
m¬gšTİ
(è+†ay”R’d””->
m¬gšBÙtom
(è+†ay”R’d””->
bÜd”Tİ
(è+†ay”R’d””->
bÜd”BÙtom
(), 
rh
));

816 
	gÏy”R’d””
 = 
this
;

817 
	g»nd””Reù
 = 
bÜd”BoxReù
();

821 
IÁReù
 
	g»·štReù
;

822 
IÁPošt
 
	gpha£
;

823 
IÁSize
 
	gteSize
;

824 
	gÏy”R’d””
->
ÿlcuÏ‹BackgroundImageGeom‘ry
(
curLay”
, 
»nd””Reù
.
x
(),„’d””Reù.
y
(),„’d””Reù.
width
(),„’d””Reù.
height
(), 
»·štReù
, 
pha£
, 
teSize
);

825 
	gÏy”R’d””
->
»·štReùªgË
(
»·štReù
);

826 ià(
	g»·štReù
 =ğ
»nd””Reù
)

827  
Œue
;

830  
	gçl£
;

833 #ià
PLATFORM
(
MAC
)

835 
	gR’d”Box
::
·štCu¡omHighlight
(
tx
, 
ty
, cÚ¡ 
AtomicSŒšg
& 
ty³
, 
boŞ
 
behšdText
)

837 
F¿me
* 
	gäame
 = 
docum’t
()->
äame
();

838 ià(!
	gäame
)

840 
Page
* 
	g·ge
 = 
äame
->
·ge
();

841 ià(!
	g·ge
)

844 
IÆšeBox
* 
	gboxW¿p
 = 
šlšeBoxW¿µ”
();

845 
RoÙIÆšeBox
* 
	gr
 = 
boxW¿p
 ? boxW¿p->
roÙ
() : 0;

846 ià(
	gr
) {

847 
FlßtReù
 
roÙReù
(
tx
 + 
r
->
x
(), 
ty
 +„->
£ËùiÚTİ
(),„->
width
(),„->
£ËùiÚHeight
());

848 
FlßtReù
 
imageReù
(
tx
 + 
x
(), 
roÙReù
.
y
(), 
width
(),„oÙReù.
height
());

849 
	g·ge
->
chrome
()->
ş›Á
()->
·štCu¡omHighlight
(
node
(), 
ty³
, 
imageReù
, 
roÙReù
, 
behšdText
, 
çl£
);

851 
FlßtReù
 
imageReù
(
tx
 + 
x
(), 
ty
 + 
y
(), 
width
(), 
height
());

852 
	g·ge
->
chrome
()->
ş›Á
()->
·štCu¡omHighlight
(
node
(), 
ty³
, 
imageReù
, imageReù, 
behšdText
, 
çl£
);

858 
boŞ
 
	gR’d”Box
::
pushCÚ‹ÁsCl
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

860 ià(
	g·štInfo
.
	gpha£
 =ğ
PaštPha£BlockBackground
 || 
·štInfo
.
pha£
 =ğ
PaštPha£S–fOuše
 ||…aštInfo.pha£ =ğ
PaštPha£Mask
)

861  
çl£
;

863 
boŞ
 
	gisCÚŒŞCl
 = 
hasCÚŒŞCl
();

864 
boŞ
 
	gisOv”æowCl
 = 
hasOv”æowCl
(è&& !
Ïy”
()->
isS–fPaštšgLay”
();

866 ià(!
	gisCÚŒŞCl
 && !
	gisOv”æowCl
)

867  
	gçl£
;

869 ià(
	g·štInfo
.
	gpha£
 =ğ
PaštPha£Ouše
)

870 
·štInfo
.
pha£
 = 
PaštPha£ChdOušes
;

871 ià(
	g·štInfo
.
	gpha£
 =ğ
PaštPha£ChdBlockBackground
) {

872 
·štInfo
.
pha£
 = 
PaštPha£BlockBackground
;

873 
·štObjeù
(
·štInfo
, 
tx
, 
ty
);

874 
	g·štInfo
.
	gpha£
 = 
PaštPha£ChdBlockBackgrounds
;

876 
IÁReù
 
şReù
(
isCÚŒŞCl
 ? 
cÚŒŞClReù
(
tx
, 
ty
è: 
ov”æowClReù
(tx,y));

877 
	g·štInfo
.
	gcÚ‹xt
->
§ve
();

878 ià(
¡yË
()->
hasBÜd”Radius
()) {

879 
IÁSize
 
	gtİLeá
, 
	gtİRight
, 
	gbÙtomLeá
, 
	gbÙtomRight
;

880 
IÁReù
 
	gbÜd”Reù
 = IÁReù(
tx
, 
ty
, 
width
(), 
height
());

881 
¡yË
()->
g‘BÜd”RadiiFÜReù
(
bÜd”Reù
, 
tİLeá
, 
tİRight
, 
bÙtomLeá
, 
bÙtomRight
);

883 
	g·štInfo
.
	gcÚ‹xt
->
addRoundedReùCl
(
bÜd”Reù
, 
tİLeá
, 
tİRight
, 
bÙtomLeá
, 
bÙtomRight
);

886 
	g·štInfo
.
	gcÚ‹xt
->
ş
(
şReù
);

887  
	gŒue
;

890 
	gR’d”Box
::
pİCÚ‹ÁsCl
(
PaštInfo
& 
·štInfo
, 
PaštPha£
 
Üigš®Pha£
, 
tx
, 
ty
)

892 
ASSERT
(
hasCÚŒŞCl
(è|| (
hasOv”æowCl
(è&& !
Ïy”
()->
isS–fPaštšgLay”
()));

894 
	g·štInfo
.
	gcÚ‹xt
->
»¡Üe
();

895 ià(
	gÜigš®Pha£
 =ğ
PaštPha£Ouše
) {

896 
·štInfo
.
pha£
 = 
PaštPha£S–fOuše
;

897 
·štObjeù
(
·štInfo
, 
tx
, 
ty
);

898 
	g·štInfo
.
	gpha£
 = 
Üigš®Pha£
;

899 } ià(
	gÜigš®Pha£
 =ğ
PaštPha£ChdBlockBackground
)

900 
·štInfo
.
pha£
 = 
Üigš®Pha£
;

903 
IÁReù
 
	gR’d”Box
::
ov”æowClReù
(
tx
, 
ty
)

908 
	gbLeá
 = 
bÜd”Leá
();

909 
	gbTİ
 = 
bÜd”Tİ
();

911 
	gşX
 = 
tx
 + 
bLeá
;

912 
	gşY
 = 
ty
 + 
bTİ
;

913 
	gşWidth
 = 
width
(è- 
bLeá
 - 
bÜd”Right
();

914 
	gşHeight
 = 
height
(è- 
bTİ
 - 
bÜd”BÙtom
();

917 ià(
Ïy”
()) {

918 
	gşWidth
 -ğ
Ïy”
()->
v”tiÿlSüŞlb¬Width
();

919 
	gşHeight
 -ğ
Ïy”
()->
hÜizÚlSüŞlb¬Height
();

922  
IÁReù
(
şX
, 
şY
, 
şWidth
, 
şHeight
);

925 
IÁReù
 
	gR’d”Box
::
şReù
(
tx
, 
ty
)

927 
	gşX
 = 
tx
;

928 
	gşY
 = 
ty
;

929 
	gşWidth
 = 
width
();

930 
	gşHeight
 = 
height
();

932 ià(!
¡yË
()->
şLeá
().
isAuto
()) {

933 
	gc
 = 
¡yË
()->
şLeá
().
ÿlcV®ue
(
width
());

934 
	gşX
 +ğ
c
;

935 
	gşWidth
 -ğ
c
;

938 ià(!
¡yË
()->
şRight
().
isAuto
())

939 
	gşWidth
 -ğ
width
(è- 
¡yË
()->
şRight
().
ÿlcV®ue
(width());

941 ià(!
¡yË
()->
şTİ
().
isAuto
()) {

942 
	gc
 = 
¡yË
()->
şTİ
().
ÿlcV®ue
(
height
());

943 
	gşY
 +ğ
c
;

944 
	gşHeight
 -ğ
c
;

947 ià(!
¡yË
()->
şBÙtom
().
isAuto
())

948 
	gşHeight
 -ğ
height
(è- 
¡yË
()->
şBÙtom
().
ÿlcV®ue
(height());

950  
IÁReù
(
şX
, 
şY
, 
şWidth
, 
şHeight
);

953 
	gR’d”Box
::
cÚššgBlockWidthFÜCÚ‹Á
() const

955 
R’d”Block
* 
cb
 = 
cÚššgBlock
();

956 ià(
shrškToAvoidFlßts
())

957  
	gcb
->
lšeWidth
(
y
(), 
çl£
);

958  
	gcb
->
avaabËWidth
();

961 
	gR’d”Box
::
m­LoÿlToCÚš”
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
boŞ
 
fixed
, boŞ 
u£T¿nsfÜms
, 
T¿nsfÜmS‹
& 
ŒªsfÜmS‹
) const

963 ià(
	g»·štCÚš”
 =ğ
this
)

966 ià(
R’d”V›w
* 
	gv
 = 
v›w
()) {

967 ià(
v
->
ÏyoutS‹EÇbËd
(è&& !
»·štCÚš”
) {

968 
LayoutS‹
* 
ÏyoutS‹
 = 
v
->layoutState();

969 
IÁSize
 
	goff£t
 = 
ÏyoutS‹
->
m_off£t
;

970 
	goff£t
.
ex·nd
(
x
(), 
y
());

971 ià(
¡yË
()->
pos™iÚ
(è=ğ
R–©ivePos™iÚ
 && 
Ïy”
())

972 
off£t
 +ğ
Ïy”
()->
»ÏtivePos™iÚOff£t
();

973 
	gŒªsfÜmS‹
.
move
(
off£t
);

978 
boŞ
 
	gcÚš”Sk³d
;

979 
R’d”Objeù
* 
	go
 = 
cÚš”
(
»·štCÚš”
, &
cÚš”Sk³d
);

980 ià(!
	go
)

983 
boŞ
 
	gisFixedPos
 = 
¡yË
()->
pos™iÚ
(è=ğ
FixedPos™iÚ
;

984 
boŞ
 
	ghasT¿nsfÜm
 = 
hasLay”
(è&& 
Ïy”
()->
ŒªsfÜm
();

985 ià(
	ghasT¿nsfÜm
) {

988 
	gfixed
 &ğ
isFixedPos
;

990 
	gfixed
 |ğ
isFixedPos
;

992 
IÁSize
 
	gcÚš”Off£t
 = 
off£tFromCÚš”
(
o
, 
roundedIÁPošt
(
ŒªsfÜmS‹
.
m­³dPošt
()));

994 
boŞ
 
	g´e£rve3D
 = 
u£T¿nsfÜms
 && (
o
->
¡yË
()->
´e£rves3D
() || style()->preserves3D());

995 ià(
	gu£T¿nsfÜms
 && 
shouldU£T¿nsfÜmFromCÚš”
(
o
)) {

996 
T¿nsfÜm©iÚM©rix
 
	gt
;

997 
g‘T¿nsfÜmFromCÚš”
(
o
, 
cÚš”Off£t
, 
t
);

998 
	gŒªsfÜmS‹
.
­¶yT¿nsfÜm
(
t
, 
´e£rve3D
 ? 
T¿nsfÜmS‹
::
AccumuÏ‹T¿nsfÜm
 : T¿nsfÜmS‹::
FÏ‰’T¿nsfÜm
);

1000 
	gŒªsfÜmS‹
.
move
(
cÚš”Off£t
.
width
(), cÚš”Off£t.
height
(), 
´e£rve3D
 ? 
T¿nsfÜmS‹
::
AccumuÏ‹T¿nsfÜm
 : T¿nsfÜmS‹::
FÏ‰’T¿nsfÜm
);

1002 ià(
	gcÚš”Sk³d
) {

1005 
IÁSize
 
	gcÚš”Off£t
 = 
»·štCÚš”
->
off£tFromAnû¡ÜCÚš”
(
o
);

1006 
	gŒªsfÜmS‹
.
move
(-
cÚš”Off£t
.
width
(), -cÚš”Off£t.
height
(), 
´e£rve3D
 ? 
T¿nsfÜmS‹
::
AccumuÏ‹T¿nsfÜm
 : T¿nsfÜmS‹::
FÏ‰’T¿nsfÜm
);

1010 
	go
->
m­LoÿlToCÚš”
(
»·štCÚš”
, 
fixed
, 
u£T¿nsfÜms
, 
ŒªsfÜmS‹
);

1013 
	gR’d”Box
::
m­AbsŞu‹ToLoÿlPošt
(
boŞ
 
fixed
, boŞ 
u£T¿nsfÜms
, 
T¿nsfÜmS‹
& 
ŒªsfÜmS‹
) const

1016 
ASSERT
(!
v›w
(è|| !v›w()->
ÏyoutS‹EÇbËd
());

1018 
boŞ
 
	gisFixedPos
 = 
¡yË
()->
pos™iÚ
(è=ğ
FixedPos™iÚ
;

1019 
boŞ
 
	ghasT¿nsfÜm
 = 
hasLay”
(è&& 
Ïy”
()->
ŒªsfÜm
();

1020 ià(
	ghasT¿nsfÜm
) {

1023 
	gfixed
 &ğ
isFixedPos
;

1025 
	gfixed
 |ğ
isFixedPos
;

1027 
R’d”Objeù
* 
	go
 = 
cÚš”
();

1028 ià(!
	go
)

1031 
	go
->
m­AbsŞu‹ToLoÿlPošt
(
fixed
, 
u£T¿nsfÜms
, 
ŒªsfÜmS‹
);

1033 
IÁSize
 
	gcÚš”Off£t
 = 
off£tFromCÚš”
(
o
, 
IÁPošt
());

1035 
boŞ
 
	g´e£rve3D
 = 
u£T¿nsfÜms
 && (
o
->
¡yË
()->
´e£rves3D
() || style()->preserves3D());

1036 ià(
	gu£T¿nsfÜms
 && 
shouldU£T¿nsfÜmFromCÚš”
(
o
)) {

1037 
T¿nsfÜm©iÚM©rix
 
	gt
;

1038 
g‘T¿nsfÜmFromCÚš”
(
o
, 
cÚš”Off£t
, 
t
);

1039 
	gŒªsfÜmS‹
.
­¶yT¿nsfÜm
(
t
, 
´e£rve3D
 ? 
T¿nsfÜmS‹
::
AccumuÏ‹T¿nsfÜm
 : T¿nsfÜmS‹::
FÏ‰’T¿nsfÜm
);

1041 
	gŒªsfÜmS‹
.
move
(-
cÚš”Off£t
.
width
(), -cÚš”Off£t.
height
(), 
´e£rve3D
 ? 
T¿nsfÜmS‹
::
AccumuÏ‹T¿nsfÜm
 : T¿nsfÜmS‹::
FÏ‰’T¿nsfÜm
);

1044 
IÁSize
 
	gR’d”Box
::
off£tFromCÚš”
(
R’d”Objeù
* 
o
, cÚ¡ 
IÁPošt
& 
pošt
) const

1046 
ASSERT
(
o
 =ğ
cÚš”
());

1048 
IÁSize
 
	goff£t
;

1049 ià(
isR–Pos™iÚed
())

1050 
	goff£t
 +ğ
»ÏtivePos™iÚOff£t
();

1052 ià(!
isIÆše
(è|| 
isR•Ïûd
()) {

1053 ià(
¡yË
()->
pos™iÚ
(è!ğ
AbsŞu‹Pos™iÚ
 && styË()->pos™iÚ(è!ğ
FixedPos™iÚ
)

1054 
o
->
adju¡FÜCŞumns
(
off£t
, 
IÁPošt
(
pošt
.
x
(è+ x(),…ošt.
y
() + y()));

1055 
	goff£t
.
ex·nd
(
x
(), 
y
());

1058 ià(
	go
->
hasOv”æowCl
())

1059 
	goff£t
 -ğ
toR’d”Box
(
o
)->
Ïy”
()->
süŞËdCÚ‹ÁOff£t
();

1061 ià(
¡yË
()->
pos™iÚ
(è=ğ
AbsŞu‹Pos™iÚ
 && 
o
->
isR–Pos™iÚed
(è&& o->
isR’d”IÆše
())

1062 
off£t
 +ğ
toR’d”IÆše
(
o
)->
»ÏtivePos™iÚedIÆšeOff£t
(
this
);

1064  
	goff£t
;

1067 
IÆšeBox
* 
	gR’d”Box
::
ü—‹IÆšeBox
()

1069  
Ãw
 (
»nd”A»Ç
()è
IÆšeBox
(
this
);

1072 
	gR’d”Box
::
dœtyLšeBoxes
(
boŞ
 
fuÎLayout
)

1074 ià(
m_šlšeBoxW¿µ”
) {

1075 ià(
fuÎLayout
) {

1076 
m_šlšeBoxW¿µ”
->
de¡roy
(
»nd”A»Ç
());

1077 
	gm_šlšeBoxW¿µ”
 = 0;

1079 
	gm_šlšeBoxW¿µ”
->
dœtyLšeBoxes
();

1083 
	gR’d”Box
::
pos™iÚLšeBox
(
IÆšeBox
* 
box
)

1085 ià(
isPos™iÚed
()) {

1087 
boŞ
 
wasIÆše
 = 
¡yË
()->
isOrigš®Di¥ÏyIÆšeTy³
();

1088 ià(
	gwasIÆše
 && 
¡yË
()->
hasSticX
()) {

1092 
Ïy”
()->
£tSticX
(
box
->
x
());

1093 
£tChdN“dsLayout
(
Œue
, 
çl£
);

1094 } ià(!
	gwasIÆše
 && 
¡yË
()->
hasSticY
()) {

1099 
Ïy”
()->
£tSticY
(
box
->
y
());

1100 
£tChdN“dsLayout
(
Œue
, 
çl£
);

1104 
	gbox
->
»move
();

1105 
	gbox
->
de¡roy
(
»nd”A»Ç
());

1106 } ià(
isR•Ïûd
()) {

1107 
£tLoÿtiÚ
(
box
->
x
(), box->
y
());

1108 
	gm_šlšeBoxW¿µ”
 = 
box
;

1112 
	gR’d”Box
::
d–‘eLšeBoxW¿µ”
()

1114 ià(
m_šlšeBoxW¿µ”
) {

1115 ià(!
docum’tBešgDe¡royed
())

1116 
m_šlšeBoxW¿µ”
->
»move
();

1117 
	gm_šlšeBoxW¿µ”
->
de¡roy
(
»nd”A»Ç
());

1118 
	gm_šlšeBoxW¿µ”
 = 0;

1122 
IÁReù
 
	gR’d”Box
::
ş³dOv”æowReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
)

1124 ià(
¡yË
()->
visib™y
(è!ğ
VISIBLE
 && !
’şosšgLay”
()->
hasVisibËCÚ‹Á
())

1125  
IÁReù
();

1127 
IÁReù
 
	gr
 = 
visibËOv”æowReù
();

1129 
R’d”V›w
* 
	gv
 = 
v›w
();

1130 ià(
	gv
) {

1133 
	gr
.
move
(
v
->
ÏyoutD–
());

1136 ià(
¡yË
()) {

1137 ià(
¡yË
()->
hasAµ—¿nû
())

1139 
theme
()->
adju¡R•aštReù
(
this
, 
r
);

1143 ià(
	gv
) {

1144 
ASSERT
(
¡yË
()->
oušeSize
(è<ğ
v
->
maxim®OušeSize
());

1145 
	gr
.
šæ©e
(
v
->
maxim®OušeSize
());

1148 
compu‹ReùFÜR•ašt
(
»·štCÚš”
, 
r
);

1149  
	gr
;

1152 
	gR’d”Box
::
compu‹ReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
IÁReù
& 
»ù
, 
boŞ
 
fixed
)

1154 ià(
R’d”V›w
* 
	gv
 = 
v›w
()) {

1156 ià(
v
->
ÏyoutS‹EÇbËd
(è&& !
»·štCÚš”
) {

1157 
LayoutS‹
* 
ÏyoutS‹
 = 
v
->layoutState();

1159 ià(
Ïy”
(è&&†ay”()->
ŒªsfÜm
())

1160 
	g»ù
 = 
Ïy”
()->
ŒªsfÜm
()->
m­Reù
(
»ù
);

1162 ià(
¡yË
()->
pos™iÚ
(è=ğ
R–©ivePos™iÚ
 && 
Ïy”
())

1163 
»ù
.
move
(
Ïy”
()->
»ÏtivePos™iÚOff£t
());

1165 
	g»ù
.
move
(
x
(), 
y
());

1166 
	g»ù
.
move
(
ÏyoutS‹
->
m_off£t
);

1167 ià(
	gÏyoutS‹
->
	gm_ş³d
)

1168 
	g»ù
.
š‹r£ù
(
ÏyoutS‹
->
m_şReù
);

1173 ià(
hasReæeùiÚ
())

1174 
	g»ù
.
un™e
(
»æeùedReù
(
»ù
));

1176 ià(
	g»·štCÚš”
 =ğ
this
)

1179 
boŞ
 
	gcÚš”Sk³d
;

1180 
R’d”Objeù
* 
	go
 = 
cÚš”
(
»·štCÚš”
, &
cÚš”Sk³d
);

1181 ià(!
	go
)

1184 
IÁPošt
 
	gtİLeá
 = 
»ù
.
loÿtiÚ
();

1185 
	gtİLeá
.
move
(
x
(), 
y
());

1187 ià(
¡yË
()->
pos™iÚ
(è=ğ
FixedPos™iÚ
)

1188 
fixed
 = 
Œue
;

1190 ià(
	go
->
isBlockFlow
(è&& 
¡yË
()->
pos™iÚ
(è!ğ
AbsŞu‹Pos™iÚ
 && styË()->pos™iÚ(è!ğ
FixedPos™iÚ
) {

1191 
R’d”Block
* 
cb
 = 
toR’d”Block
(
o
);

1192 ià(
	gcb
->
hasCŞumns
()) {

1193 
IÁReù
 
»·štReù
(
tİLeá
, 
»ù
.
size
());

1194 
	gcb
->
adju¡ReùFÜCŞumns
(
»·štReù
);

1195 
	gtİLeá
 = 
»·štReù
.
loÿtiÚ
();

1196 
	g»ù
 = 
»·štReù
;

1202 ià(
Ïy”
(è&&†ay”()->
ŒªsfÜm
()) {

1203 
	gfixed
 = 
çl£
;

1204 
	g»ù
 = 
Ïy”
()->
ŒªsfÜm
()->
m­Reù
(
»ù
);

1206 
	gtİLeá
 = 
»ù
.
loÿtiÚ
();

1207 
	gtİLeá
.
move
(
x
(), 
y
());

1210 ià(
¡yË
()->
pos™iÚ
(è=ğ
AbsŞu‹Pos™iÚ
 && 
o
->
isR–Pos™iÚed
(è&& o->
isR’d”IÆše
())

1211 
tİLeá
 +ğ
toR’d”IÆše
(
o
)->
»ÏtivePos™iÚedIÆšeOff£t
(
this
);

1212 ià(
¡yË
()->
pos™iÚ
(è=ğ
R–©ivePos™iÚ
 && 
Ïy”
()) {

1217 
tİLeá
 +ğ
Ïy”
()->
»ÏtivePos™iÚOff£t
();

1222 ià(
	go
->
hasOv”æowCl
()) {

1223 
R’d”Box
* 
	gcÚš”Box
 = 
toR’d”Box
(
o
);

1228 
	gtİLeá
 -ğ
cÚš”Box
->
Ïy”
()->
süŞËdCÚ‹ÁOff£t
();

1230 
IÁReù
 
»·štReù
(
tİLeá
, 
»ù
.
size
());

1231 
IÁReù
 
boxReù
(0, 0, 
cÚš”Box
->
Ïy”
()->
width
(), cÚš”Box->Ïy”()->
height
());

1232 
	g»ù
 = 
š‹r£ùiÚ
(
»·štReù
, 
boxReù
);

1233 ià(
	g»ù
.
isEm±y
())

1236 
	g»ù
.
£tLoÿtiÚ
(
tİLeá
);

1238 ià(
	gcÚš”Sk³d
) {

1240 
IÁSize
 
	gcÚš”Off£t
 = 
»·štCÚš”
->
off£tFromAnû¡ÜCÚš”
(
o
);

1241 
	g»ù
.
move
(-
cÚš”Off£t
);

1245 
	go
->
compu‹ReùFÜR•ašt
(
»·štCÚš”
, 
»ù
, 
fixed
);

1248 
	gR’d”Box
::
»·štDuršgLayoutIfMoved
(cÚ¡ 
IÁReù
& 
»ù
)

1250 
ÃwX
 = 
x
();

1251 
	gÃwY
 = 
y
();

1252 
	gÃwWidth
 = 
width
();

1253 
	gÃwHeight
 = 
height
();

1254 ià(
	g»ù
.
x
(è!ğ
ÃwX
 || 
»ù
.
y
(è!ğ
ÃwY
) {

1257 
m_äameReù
 = 
»ù
;

1258 
»·št
();

1259 
»·štOv”hªgšgFlßts
(
Œue
);

1260 
	gm_äameReù
 = 
IÁReù
(
ÃwX
, 
ÃwY
, 
ÃwWidth
, 
ÃwHeight
);

1261 
»·št
();

1262 
»·štOv”hªgšgFlßts
(
Œue
);

1266 
	gR’d”Box
::
ÿlcWidth
()

1268 ià(
isPos™iÚed
()) {

1269 
ÿlcAbsŞu‹HÜizÚl
();

1274 ià(
node
(è&& 
v›w
()->
äameV›w
(è&& v›w()->äameV›w()->
ÏyoutRoÙ
(
Œue
è=ğ
this
)

1279 ià(
hasOv”rideSize
(è&& 
·»Á
()->
¡yË
()->
boxOr›Á
(è=ğ
HORIZONTAL


1280 && 
·»Á
()->
isFËxibËBox
(è&&…¬’t()->
isFËxšgChd»n
()) {

1281 
£tWidth
(
ov”rideSize
());

1285 
boŞ
 
	gšV”tiÿlBox
 = 
·»Á
()->
isFËxibËBox
(è&& (·»Á()->
¡yË
()->
boxOr›Á
(è=ğ
VERTICAL
);

1286 
boŞ
 
	g¡»tchšg
 = (
·»Á
()->
¡yË
()->
boxAlign
(è=ğ
BSTRETCH
);

1287 
boŞ
 
	gŒ—tAsR•Ïûd
 = 
shouldC®cuÏ‹SizeAsR•Ïûd
(è&& (!
šV”tiÿlBox
 || !
¡»tchšg
);

1289 
L’gth
 
	gw
 = (
Œ—tAsR•Ïûd
è? L’gth(
ÿlcR•ÏûdWidth
(), 
Fixed
è: 
¡yË
()->
width
();

1291 
R’d”Block
* 
	gcb
 = 
cÚššgBlock
();

1292 
	gcÚš”Width
 = 
max
(0, 
cÚššgBlockWidthFÜCÚ‹Á
());

1294 
L’gth
 
	gm¬gšLeá
 = 
¡yË
()->
m¬gšLeá
();

1295 
L’gth
 
	gm¬gšRight
 = 
¡yË
()->
m¬gšRight
();

1297 ià(
isIÆše
(è&& !
isIÆšeBlockOrIÆšeTabË
()) {

1299 
	gm_m¬gšLeá
 = 
m¬gšLeá
.
ÿlcMšV®ue
(
cÚš”Width
);

1300 
	gm_m¬gšRight
 = 
m¬gšRight
.
ÿlcMšV®ue
(
cÚš”Width
);

1301 ià(
	gŒ—tAsR•Ïûd
)

1302 
£tWidth
(
max
(
w
.
v®ue
(è+ 
bÜd”Leá
(è+ 
bÜd”Right
(è+ 
·ddšgLeá
(è+ 
·ddšgRight
(), 
mšP»fWidth
()));

1308 ià(
	gŒ—tAsR•Ïûd
)

1309 
£tWidth
(
w
.
v®ue
(è+ 
bÜd”Leá
(è+ 
bÜd”Right
(è+ 
·ddšgLeá
(è+ 
·ddšgRight
());

1312 
£tWidth
(
ÿlcWidthUsšg
(
Width
, 
cÚš”Width
));

1315 ià(!
¡yË
()->
maxWidth
().
isUndefšed
()) {

1316 
	gmaxW
 = 
ÿlcWidthUsšg
(
MaxWidth
, 
cÚš”Width
);

1317 ià(
width
(è> 
	gmaxW
) {

1318 
£tWidth
(
maxW
);

1319 
	gw
 = 
¡yË
()->
maxWidth
();

1324 
	gmšW
 = 
ÿlcWidthUsšg
(
MšWidth
, 
cÚš”Width
);

1325 ià(
width
(è< 
	gmšW
) {

1326 
£tWidth
(
mšW
);

1327 
	gw
 = 
¡yË
()->
mšWidth
();

1331 ià(
¡»tchesToMšIÁršsicWidth
()) {

1332 
£tWidth
(
max
(
width
(), 
mšP»fWidth
()));

1333 
	gw
 = 
L’gth
(
width
(), 
Fixed
);

1337 ià(
	gw
.
isAuto
()) {

1338 
	gm_m¬gšLeá
 = 
m¬gšLeá
.
ÿlcMšV®ue
(
cÚš”Width
);

1339 
	gm_m¬gšRight
 = 
m¬gšRight
.
ÿlcMšV®ue
(
cÚš”Width
);

1341 
	gm_m¬gšLeá
 = 0;

1342 
	gm_m¬gšRight
 = 0;

1343 
ÿlcHÜizÚlM¬gšs
(
m¬gšLeá
, 
m¬gšRight
, 
cÚš”Width
);

1346 ià(
	gcÚš”Width
 && cÚš”Width !ğ(
width
(è+ 
m_m¬gšLeá
 + 
m_m¬gšRight
)

1347 && !
isFlßtšg
(è&& !
isIÆše
(è&& !
cb
->
isFËxibËBox
()) {

1348 ià(
cb
->
¡yË
()->
dœeùiÚ
(è=ğ
LTR
)

1349 
m_m¬gšRight
 = 
cÚš”Width
 - 
width
(è- 
m_m¬gšLeá
;

1351 
	gm_m¬gšLeá
 = 
cÚš”Width
 - 
width
(è- 
m_m¬gšRight
;

1355 
	gR’d”Box
::
ÿlcWidthUsšg
(
WidthTy³
 
widthTy³
, 
cw
)

1357 
	gwidthResuÉ
 = 
width
();

1358 
L’gth
 
	gw
;

1359 ià(
	gwidthTy³
 =ğ
Width
)

1360 
w
 = 
¡yË
()->
width
();

1361 ià(
	gwidthTy³
 =ğ
MšWidth
)

1362 
w
 = 
¡yË
()->
mšWidth
();

1364 
	gw
 = 
¡yË
()->
maxWidth
();

1366 ià(
	gw
.
isIÁršsicOrAuto
()) {

1367 
	gm¬gšLeá
 = 
¡yË
()->
m¬gšLeá
().
ÿlcMšV®ue
(
cw
);

1368 
	gm¬gšRight
 = 
¡yË
()->
m¬gšRight
().
ÿlcMšV®ue
(
cw
);

1369 ià(
	gcw
)

1370 
	gwidthResuÉ
 = 
cw
 - 
m¬gšLeá
 - 
m¬gšRight
;

1372 ià(
sizesToIÁršsicWidth
(
widthTy³
)) {

1373 
	gwidthResuÉ
 = 
max
(
widthResuÉ
, 
mšP»fWidth
());

1374 
	gwidthResuÉ
 = 
mš
(
widthResuÉ
, 
maxP»fWidth
());

1377 
	gwidthResuÉ
 = 
ÿlcBÜd”BoxWidth
(
w
.
ÿlcV®ue
(
cw
));

1379  
	gwidthResuÉ
;

1382 
boŞ
 
	gR’d”Box
::
sizesToIÁršsicWidth
(
WidthTy³
 
widthTy³
) const

1386 ià(
isFlßtšg
(è|| (
isIÆšeBlockOrIÆšeTabË
(è&& !
isHTMLM¬qu“
()))

1387  
Œue
;

1391 
L’gth
 
	gwidth
 = (
widthTy³
 =ğ
MaxWidth
è? 
¡yË
()->
maxWidth
(è: styË()->
width
();

1392 ià(
	gwidth
.
ty³
(è=ğ
IÁršsic
)

1393  
Œue
;

1397 ià(
·»Á
()->
¡yË
()->
ov”æowX
(è=ğ
OMARQUEE
) {

1398 
EM¬qu“DœeùiÚ
 
dœ
 = 
·»Á
()->
¡yË
()->
m¬qu“DœeùiÚ
();

1399 ià(
	gdœ
 =ğ
MAUTO
 || 
dœ
 =ğ
MFORWARD
 || dœ =ğ
MBACKWARD
 || dœ =ğ
MLEFT
 || dœ =ğ
MRIGHT
)

1400  
Œue
;

1405 ià(
·»Á
()->
isFËxibËBox
()

1406 && (
·»Á
()->
¡yË
()->
boxOr›Á
(è=ğ
HORIZONTAL
 ||…¬’t()->¡yË()->
boxAlign
(è!ğ
BSTRETCH
))

1407  
Œue
;

1409  
	gçl£
;

1412 
	gR’d”Box
::
ÿlcHÜizÚlM¬gšs
(cÚ¡ 
L’gth
& 
m¬gšLeá
, cÚ¡ L’gth& 
m¬gšRight
, 
cÚš”Width
)

1414 ià(
isFlßtšg
(è|| 
isIÆše
()) {

1416 
	gm_m¬gšLeá
 = 
m¬gšLeá
.
ÿlcMšV®ue
(
cÚš”Width
);

1417 
	gm_m¬gšRight
 = 
m¬gšRight
.
ÿlcMšV®ue
(
cÚš”Width
);

1422 ià((
	gm¬gšLeá
.
isAuto
(è&& 
	gm¬gšRight
.isAuto(è&& 
width
(è< 
	gcÚš”Width
)

1423 || (!
	gm¬gšLeá
.
isAuto
(è&& !
	gm¬gšRight
.isAuto(è&& 
cÚššgBlock
()->
¡yË
()->
‹xtAlign
(è=ğ
WEBKIT_CENTER
)) {

1424 
m_m¬gšLeá
 = 
max
(0, (
cÚš”Width
 - 
width
()) / 2);

1425 
	gm_m¬gšRight
 = 
cÚš”Width
 - 
width
(è- 
m_m¬gšLeá
;

1426 } ià((
	gm¬gšRight
.
isAuto
(è&& 
width
(è< 
	gcÚš”Width
)

1427 || (!
	gm¬gšLeá
.
isAuto
(è&& 
cÚššgBlock
()->
¡yË
()->
dœeùiÚ
(è=ğ
RTL
 && cÚššgBlock()->¡yË()->
‹xtAlign
(è=ğ
WEBKIT_LEFT
)) {

1428 
m_m¬gšLeá
 = 
m¬gšLeá
.
ÿlcV®ue
(
cÚš”Width
);

1429 
	gm_m¬gšRight
 = 
cÚš”Width
 - 
width
(è- 
m_m¬gšLeá
;

1430 } ià((
	gm¬gšLeá
.
isAuto
(è&& 
width
(è< 
	gcÚš”Width
)

1431 || (!
	gm¬gšRight
.
isAuto
(è&& 
cÚššgBlock
()->
¡yË
()->
dœeùiÚ
(è=ğ
LTR
 && cÚššgBlock()->¡yË()->
‹xtAlign
(è=ğ
WEBKIT_RIGHT
)) {

1432 
m_m¬gšRight
 = 
m¬gšRight
.
ÿlcV®ue
(
cÚš”Width
);

1433 
	gm_m¬gšLeá
 = 
cÚš”Width
 - 
width
(è- 
m_m¬gšRight
;

1436 
	gm_m¬gšLeá
 = 
m¬gšLeá
.
ÿlcMšV®ue
(
cÚš”Width
);

1437 
	gm_m¬gšRight
 = 
m¬gšRight
.
ÿlcMšV®ue
(
cÚš”Width
);

1441 
	gR’d”Box
::
ÿlcHeight
()

1444 ià(
isTabËC–l
(è|| (
isIÆše
(è&& !
isR•Ïûd
()))

1447 
L’gth
 
	gh
;

1448 ià(
isPos™iÚed
())

1449 
ÿlcAbsŞu‹V”tiÿl
();

1451 
ÿlcV”tiÿlM¬gšs
();

1454 ià(
isTabË
())

1457 
boŞ
 
	gšHÜizÚlBox
 = 
·»Á
()->
isFËxibËBox
(è&&…¬’t()->
¡yË
()->
boxOr›Á
(è=ğ
HORIZONTAL
;

1458 
boŞ
 
	g¡»tchšg
 = 
·»Á
()->
¡yË
()->
boxAlign
(è=ğ
BSTRETCH
;

1459 
boŞ
 
	gŒ—tAsR•Ïûd
 = 
shouldC®cuÏ‹SizeAsR•Ïûd
(è&& (!
šHÜizÚlBox
 || !
¡»tchšg
);

1460 
boŞ
 
	gcheckMšMaxHeight
 = 
çl£
;

1464 ià(
hasOv”rideSize
(è&& 
·»Á
()->
isFËxibËBox
(è&&…¬’t()->
¡yË
()->
boxOr›Á
(è=ğ
VERTICAL


1465 && 
·»Á
()->
isFËxšgChd»n
())

1466 
h
 = 
L’gth
(
ov”rideSize
(è- 
bÜd”Tİ
(è- 
bÜd”BÙtom
(è- 
·ddšgTİ
(è- 
·ddšgBÙtom
(), 
Fixed
);

1467 ià(
	gŒ—tAsR•Ïûd
)

1468 
	gh
 = 
L’gth
(
ÿlcR•ÏûdHeight
(), 
Fixed
);

1470 
	gh
 = 
¡yË
()->
height
();

1471 
	gcheckMšMaxHeight
 = 
Œue
;

1475 ià(
	gh
.
isAuto
(è&& 
·»Á
()->
isFËxibËBox
(è&&…¬’t()->
¡yË
()->
boxOr›Á
(è=ğ
HORIZONTAL


1476 && 
·»Á
()->
isSŒ‘chšgChd»n
()) {

1477 
h
 = 
L’gth
(
·»ÁBox
()->
cÚ‹ÁHeight
(è- 
m¬gšTİ
(è- 
m¬gšBÙtom
() -

1478 
bÜd”Tİ
(è- 
·ddšgTİ
(è- 
bÜd”BÙtom
(è- 
·ddšgBÙtom
(), 
Fixed
);

1479 
	gcheckMšMaxHeight
 = 
çl£
;

1482 
	gheightResuÉ
;

1483 ià(
	gcheckMšMaxHeight
) {

1484 
	gheightResuÉ
 = 
ÿlcHeightUsšg
(
¡yË
()->
height
());

1485 ià(
	gheightResuÉ
 == -1)

1486 
heightResuÉ
 = 
height
();

1487 
	gmšH
 = 
ÿlcHeightUsšg
(
¡yË
()->
mšHeight
());

1488 
	gmaxH
 = 
¡yË
()->
maxHeight
().
isUndefšed
(è? 
heightResuÉ
 : 
ÿlcHeightUsšg
(style()->maxHeight());

1489 ià(
	gmaxH
 == -1)

1490 
maxH
 = 
heightResuÉ
;

1491 
	gheightResuÉ
 = 
mš
(
maxH
, 
heightResuÉ
);

1492 
	gheightResuÉ
 = 
max
(
mšH
, 
heightResuÉ
);

1497 
	gheightResuÉ
 = 
h
.
v®ue
(è+ 
bÜd”Tİ
(è+ 
bÜd”BÙtom
(è+ 
·ddšgTİ
(è+ 
·ddšgBÙtom
();

1500 
£tHeight
(
heightResuÉ
);

1508 
boŞ
 
	g´štšgN“dsBa£Height
 = 
docum’t
()->
´štšg
(è&& 
h
.
isP”ûÁ
()

1509 && (
isRoÙ
(è|| (
isBody
(è&& 
docum’t
()->
docum’tEËm’t
()->
»nd””
()->
¡yË
()->
height
().
isP”ûÁ
()));

1510 ià(
¡»tchesToV›wHeight
(è|| 
	g´štšgN“dsBa£Height
) {

1511 
	gm¬gšs
 = 
cŞÏp£dM¬gšTİ
(è+ 
cŞÏp£dM¬gšBÙtom
();

1512 
	gvisHeight
 = 
docum’t
()->
´štšg
(è? 
v›w
()->
äameV›w
()->
visibËHeight
(è: v›w()->
v›wHeight
();

1513 ià(
isRoÙ
())

1514 
£tHeight
(
max
(
height
(), 
visHeight
 - 
m¬gšs
));

1516 
	gm¬gšsBÜd”sPaddšg
 = 
m¬gšs
 + 
·»ÁBox
()->
m¬gšTİ
(è+…¬’tBox()->
m¬gšBÙtom
()

1517 + 
·»ÁBox
()->
bÜd”Tİ
(è+…¬’tBox()->
bÜd”BÙtom
()

1518 + 
·»ÁBox
()->
·ddšgTİ
(è+…¬’tBox()->
·ddšgBÙtom
();

1519 
£tHeight
(
max
(
height
(), 
visHeight
 - 
m¬gšsBÜd”sPaddšg
));

1524 
	gR’d”Box
::
ÿlcHeightUsšg
(cÚ¡ 
L’gth
& 
h
)

1526 
height
 = -1;

1527 ià(!
	gh
.
isAuto
()) {

1528 ià(
	gh
.
isFixed
())

1529 
	gheight
 = 
h
.
v®ue
();

1530 ià(
	gh
.
isP”ûÁ
())

1531 
	gheight
 = 
ÿlcP”ûÁageHeight
(
h
);

1532 ià(
	gheight
 != -1) {

1533 
height
 = 
ÿlcBÜd”BoxHeight
(height);

1534  
	gheight
;

1537  
	gheight
;

1540 
	gR’d”Box
::
ÿlcP”ûÁageHeight
(cÚ¡ 
L’gth
& 
height
)

1542 
»suÉ
 = -1;

1543 
boŞ
 
	gsk³dAutoHeightCÚššgBlock
 = 
çl£
;

1544 
R’d”Block
* 
	gcb
 = 
cÚššgBlock
();

1545 ià(
¡yË
()->
htmlHacks
()) {

1550 !
	gcb
->
isR’d”V›w
(è&& !cb->
isBody
(è&& !cb->
isTabËC–l
(è&& !cb->
isPos™iÚed
(è&& cb->
¡yË
()->
height
().
isAuto
()) {

1551 
	gsk³dAutoHeightCÚššgBlock
 = 
Œue
;

1552 
	gcb
 = 
cb
->
cÚššgBlock
();

1553 
	gcb
->
addP”ûÁHeightDesûndªt
(
this
);

1559 
boŞ
 
	gisPos™iÚedW™hS³cif›dHeight
 = 
cb
->
isPos™iÚed
(è&& (!cb->
¡yË
()->
height
().
isAuto
(è|| (!cb->¡yË()->
tİ
().isAuto(è&& !cb->¡yË()->
bÙtom
().isAuto()));

1561 
boŞ
 
	gšşudeBÜd”Paddšg
 = 
isTabË
();

1566 ià(
	gcb
->
isTabËC–l
()) {

1567 ià(!
	gsk³dAutoHeightCÚššgBlock
) {

1568 
	g»suÉ
 = 
cb
->
ov”rideSize
();

1569 ià(
	g»suÉ
 == -1) {

1577 
R’d”TabËC–l
* 
ûÎ
 = 
toR’d”TabËC–l
(
cb
);

1578 ià(
süŞlsOv”æowY
(è&& (!
	gûÎ
->
¡yË
()->
height
().
isAuto
(è|| !ûÎ->
bË
()->style()->height().isAuto()))

1582 
	gšşudeBÜd”Paddšg
 = 
Œue
;

1587 ià(
	gcb
->
¡yË
()->
height
().
isFixed
())

1588 
	g»suÉ
 = 
cb
->
ÿlcCÚ‹ÁBoxHeight
(cb->
¡yË
()->
height
().
v®ue
());

1589 ià(
	gcb
->
¡yË
()->
height
().
isP”ûÁ
(è&& !
	gisPos™iÚedW™hS³cif›dHeight
) {

1591 
	g»suÉ
 = 
cb
->
ÿlcP”ûÁageHeight
(cb->
¡yË
()->
height
());

1592 ià(
	g»suÉ
 != -1)

1593 
»suÉ
 = 
cb
->
ÿlcCÚ‹ÁBoxHeight
(result);

1594 } ià(
	gcb
->
isR’d”V›w
(è|| (cb->
isBody
(è&& 
¡yË
()->
htmlHacks
()è|| 
	gisPos™iÚedW™hS³cif›dHeight
) {

1597 
	gŞdHeight
 = 
cb
->
height
();

1598 
	gcb
->
ÿlcHeight
();

1599 
	g»suÉ
 = 
cb
->
cÚ‹ÁHeight
();

1600 
	gcb
->
£tHeight
(
ŞdHeight
);

1601 } ià(
	gcb
->
isRoÙ
(è&& 
isPos™iÚed
())

1604 
	g»suÉ
 = 
cb
->
ÿlcCÚ‹ÁBoxHeight
(cb->
avaabËHeight
());

1606 ià(
	g»suÉ
 != -1) {

1607 
»suÉ
 = 
height
.
ÿlcV®ue
(result);

1608 ià(
	gšşudeBÜd”Paddšg
) {

1612 
	g»suÉ
 -ğ(
bÜd”Tİ
(è+ 
·ddšgTİ
(è+ 
bÜd”BÙtom
(è+ 
·ddšgBÙtom
());

1613 
	g»suÉ
 = 
max
(0, 
»suÉ
);

1616  
	g»suÉ
;

1619 
	gR’d”Box
::
ÿlcR•ÏûdWidth
(
boŞ
 
šşudeMaxWidth
) const

1621 
width
 = 
ÿlcR•ÏûdWidthUsšg
(
¡yË
()->width());

1622 
	gmšW
 = 
ÿlcR•ÏûdWidthUsšg
(
¡yË
()->
mšWidth
());

1623 
	gmaxW
 = !
šşudeMaxWidth
 || 
¡yË
()->
maxWidth
().
isUndefšed
(è? 
width
 : 
ÿlcR•ÏûdWidthUsšg
(style()->maxWidth());

1625  
max
(
mšW
, 
mš
(
width
, 
maxW
));

1628 
	gR’d”Box
::
ÿlcR•ÏûdWidthUsšg
(
L’gth
 
width
) const

1630 
width
.
ty³
()) {

1631 
Fixed
:

1632  
ÿlcCÚ‹ÁBoxWidth
(
width
.
v®ue
());

1633 
	gP”ûÁ
: {

1634 cÚ¡ 
cw
 = 
isPos™iÚed
(è? 
cÚššgBlockWidthFÜPos™iÚed
(
toR’d”BoxMod–Objeù
(
cÚš”
())è: 
cÚššgBlockWidthFÜCÚ‹Á
();

1635 ià(
	gcw
 > 0)

1636  
ÿlcCÚ‹ÁBoxWidth
(
width
.
ÿlcMšV®ue
(
cw
));

1640  
šŒšsicSize
().
width
();

1644 
	gR’d”Box
::
ÿlcR•ÏûdHeight
() const

1646 
height
 = 
ÿlcR•ÏûdHeightUsšg
(
¡yË
()->height());

1647 
	gmšH
 = 
ÿlcR•ÏûdHeightUsšg
(
¡yË
()->
mšHeight
());

1648 
	gmaxH
 = 
¡yË
()->
maxHeight
().
isUndefšed
(è? 
height
 : 
ÿlcR•ÏûdHeightUsšg
(style()->maxHeight());

1650  
max
(
mšH
, 
mš
(
height
, 
maxH
));

1653 
	gR’d”Box
::
ÿlcR•ÏûdHeightUsšg
(
L’gth
 
height
) const

1655 
height
.
ty³
()) {

1656 
Fixed
:

1657  
ÿlcCÚ‹ÁBoxHeight
(
height
.
v®ue
());

1658 
	gP”ûÁ
:

1660 
R’d”Objeù
* 
cb
 = 
isPos™iÚed
(è? 
cÚš”
(è: 
cÚššgBlock
();

1661 
	gcb
->
isAnÚymous
()) {

1662 
	gcb
 = 
cb
->
cÚššgBlock
();

1663 
toR’d”Block
(
cb
)->
addP”ûÁHeightDesûndªt
(
cÚ¡_ÿ¡
<
R’d”Box
*>(
this
));

1666 ià(
	gcb
->
isPos™iÚed
(è&& cb->
¡yË
()->
height
().
isAuto
(è&& !(cb->¡yË()->
tİ
().isAuto(è|| cb->¡yË()->
bÙtom
().isAuto())) {

1667 
ASSERT
(
cb
->
isR’d”Block
());

1668 
R’d”Block
* 
	gblock
 = 
toR’d”Block
(
cb
);

1669 
	gŞdHeight
 = 
block
->
height
();

1670 
	gblock
->
ÿlcHeight
();

1671 
	gÃwHeight
 = 
block
->
ÿlcCÚ‹ÁBoxHeight
(block->
cÚ‹ÁHeight
());

1672 
	gblock
->
£tHeight
(
ŞdHeight
);

1673  
ÿlcCÚ‹ÁBoxHeight
(
height
.
ÿlcV®ue
(
ÃwHeight
));

1676 
	gavaabËHeight
 = 
isPos™iÚed
(è? 
cÚššgBlockHeightFÜPos™iÚed
(
toR’d”BoxMod–Objeù
(
cb
)è: 
toR’d”Box
(cb)->
avaabËHeight
();

1681 ià(
	gcb
->
isTabËC–l
(è&& (cb->
¡yË
()->
height
().
isAuto
(è|| cb->¡yË()->height().
isP”ûÁ
())) {

1684 
	gavaabËHeight
 = 
max
(
avaabËHeight
, 
šŒšsicSize
().
height
());

1685  
	gheight
.
ÿlcV®ue
(
avaabËHeight
 - (
bÜd”Tİ
(è+ 
bÜd”BÙtom
()

1686 + 
·ddšgTİ
(è+ 
·ddšgBÙtom
()));

1689  
ÿlcCÚ‹ÁBoxHeight
(
height
.
ÿlcV®ue
(
avaabËHeight
));

1692  
šŒšsicSize
().
height
();

1696 
	gR’d”Box
::
avaabËHeight
() const

1698  
avaabËHeightUsšg
(
¡yË
()->
height
());

1701 
	gR’d”Box
::
avaabËHeightUsšg
(cÚ¡ 
L’gth
& 
h
) const

1703 ià(
h
.
isFixed
())

1704  
ÿlcCÚ‹ÁBoxHeight
(
h
.
v®ue
());

1706 ià(
isR’d”V›w
())

1707  
toR’d”V›w
(
this
)->
äameV›w
()->
visibËHeight
();

1712 ià(
isTabËC–l
(è&& (
	gh
.
isAuto
(è|| h.
isP”ûÁ
()))

1713  
ov”rideSize
(è- (
bÜd”Leá
(è+ 
bÜd”Right
(è+ 
·ddšgLeá
(è+ 
·ddšgRight
());

1715 ià(
	gh
.
isP”ûÁ
())

1716  
ÿlcCÚ‹ÁBoxHeight
(
h
.
ÿlcV®ue
(
cÚššgBlock
()->
avaabËHeight
()));

1718 ià(
isR’d”Block
(è&& 
isPos™iÚed
(è&& 
¡yË
()->
height
().
isAuto
(è&& !(¡yË()->
tİ
().isAuto(è|| styË()->
bÙtom
().isAuto())) {

1719 
R’d”Block
* 
	gblock
 = 
cÚ¡_ÿ¡
<R’d”Block*>(
toR’d”Block
(
this
));

1720 
	gŞdHeight
 = 
block
->
height
();

1721 
	gblock
->
ÿlcHeight
();

1722 
	gÃwHeight
 = 
block
->
ÿlcCÚ‹ÁBoxHeight
(block->
cÚ‹ÁHeight
());

1723 
	gblock
->
£tHeight
(
ŞdHeight
);

1724  
ÿlcCÚ‹ÁBoxHeight
(
ÃwHeight
);

1727  
cÚššgBlock
()->
avaabËHeight
();

1730 
	gR’d”Box
::
ÿlcV”tiÿlM¬gšs
()

1732 ià(
isTabËC–l
()) {

1733 
m_m¬gšTİ
 = 0;

1734 
	gm_m¬gšBÙtom
 = 0;

1740 
	gcw
 = 
cÚššgBlock
()->
cÚ‹ÁWidth
();

1742 
	gm_m¬gšTİ
 = 
¡yË
()->
m¬gšTİ
().
ÿlcMšV®ue
(
cw
);

1743 
	gm_m¬gšBÙtom
 = 
¡yË
()->
m¬gšBÙtom
().
ÿlcMšV®ue
(
cw
);

1746 
	gR’d”Box
::
cÚššgBlockWidthFÜPos™iÚed
(cÚ¡ 
R’d”BoxMod–Objeù
* 
cÚššgBlock
) const

1748 ià(
cÚššgBlock
->
isBox
()) {

1749 cÚ¡ 
R’d”Box
* 
cÚššgBlockBox
 = 
toR’d”Box
(
cÚššgBlock
);

1750  
	gcÚššgBlockBox
->
width
(è- cÚššgBlockBox->
bÜd”Leá
(è- cÚššgBlockBox->
bÜd”Right
(è- cÚššgBlockBox->
v”tiÿlSüŞlb¬Width
();

1753 
ASSERT
(
cÚššgBlock
->
isR’d”IÆše
(è&& cÚššgBlock->
isR–Pos™iÚed
());

1755 cÚ¡ 
R’d”IÆše
* 
	gæow
 = 
toR’d”IÆše
(
cÚššgBlock
);

1756 
IÆšeFlowBox
* 
	gfœ¡
 = 
æow
->
fœ¡LšeBox
();

1757 
IÆšeFlowBox
* 
	gÏ¡
 = 
æow
->
Ï¡LšeBox
();

1760 ià(!
	gfœ¡
 || !
	gÏ¡
)

1763 
	gäomLeá
;

1764 
	gäomRight
;

1765 ià(
	gcÚššgBlock
->
¡yË
()->
dœeùiÚ
(è=ğ
LTR
) {

1766 
äomLeá
 = 
fœ¡
->
x
(è+ fœ¡->
bÜd”Leá
();

1767 
	gäomRight
 = 
Ï¡
->
x
(è+†a¡->
width
(è-†a¡->
bÜd”Right
();

1769 
	gäomRight
 = 
fœ¡
->
x
(è+ fœ¡->
width
(è- fœ¡->
bÜd”Right
();

1770 
	gäomLeá
 = 
Ï¡
->
x
(è+†a¡->
bÜd”Leá
();

1773  
max
(0, (
äomRight
 - 
äomLeá
));

1776 
	gR’d”Box
::
cÚššgBlockHeightFÜPos™iÚed
(cÚ¡ 
R’d”BoxMod–Objeù
* 
cÚššgBlock
) const

1778 
heightResuÉ
 = 0;

1779 ià(
	gcÚššgBlock
->
isBox
())

1780 
	gheightResuÉ
 = 
toR’d”Box
(
cÚššgBlock
)->
height
();

1781 ià(
	gcÚššgBlock
->
isR’d”IÆše
()) {

1782 
ASSERT
(
cÚššgBlock
->
isR–Pos™iÚed
());

1783 
	gheightResuÉ
 = 
toR’d”IÆše
(
cÚššgBlock
)->
lšesBoundšgBox
().
height
();

1785  
	gheightResuÉ
 - 
	gcÚššgBlock
->
bÜd”Tİ
(è- cÚššgBlock->
bÜd”BÙtom
();

1788 
	gR’d”Box
::
ÿlcAbsŞu‹HÜizÚl
()

1790 ià(
isR•Ïûd
()) {

1791 
ÿlcAbsŞu‹HÜizÚlR•Ïûd
();

1822 cÚ¡ 
R’d”BoxMod–Objeù
* 
	gcÚš”Block
 = 
toR’d”BoxMod–Objeù
(
cÚš”
());

1824 cÚ¡ 
	gcÚš”Width
 = 
cÚššgBlockWidthFÜPos™iÚed
(
cÚš”Block
);

1828 
TextDœeùiÚ
 
	gcÚš”DœeùiÚ
 = (
¡yË
()->
htmlHacks
()è? 
·»Á
()->¡yË()->
dœeùiÚ
(è: 
cÚš”Block
->style()->direction();

1830 cÚ¡ 
	gbÜd”sPlusPaddšg
 = 
bÜd”Leá
(è+ 
bÜd”Right
(è+ 
·ddšgLeá
(è+ 
·ddšgRight
();

1831 cÚ¡ 
L’gth
 
	gm¬gšLeá
 = 
¡yË
()->
m¬gšLeá
();

1832 cÚ¡ 
L’gth
 
	gm¬gšRight
 = 
¡yË
()->
m¬gšRight
();

1833 
L’gth
 
	gËá
 = 
¡yË
()->
Ëá
();

1834 
L’gth
 
	gright
 = 
¡yË
()->
right
();

1862 ià(
	gËá
.
isAuto
(è&& 
	gright
.isAuto()) {

1863 ià(
	gcÚš”DœeùiÚ
 =ğ
LTR
) {

1865 
¡©icPos™iÚ
 = 
Ïy”
()->
¡©icX
(è- 
cÚš”Block
->
bÜd”Leá
();

1866 
R’d”Objeù
* 
	gpo
 = 
·»Á
();…Ø&&…Ø!ğ
cÚš”Block
;…Øğ
po
->parent()) {

1867 ià(
po
->
isBox
())

1868 
¡©icPos™iÚ
 +ğ
toR’d”Box
(
po
)->
x
();

1870 
	gËá
.
£tV®ue
(
Fixed
, 
¡©icPos™iÚ
);

1872 
R’d”Objeù
* 
	gpo
 = 
·»Á
();

1874 
	g¡©icPos™iÚ
 = 
Ïy”
()->
¡©icX
(è+ 
cÚš”Width
 + 
cÚš”Block
->
bÜd”Right
();

1875 ià(
	gpo
->
isBox
())

1876 
	g¡©icPos™iÚ
 -ğ
toR’d”Box
(
po
)->
width
();

1877 ; 
	gpo
 &&…Ø!ğ
cÚš”Block
;…Øğ
po
->
·»Á
()) {

1878 ià(
po
->
isBox
())

1879 
¡©icPos™iÚ
 -ğ
toR’d”Box
(
po
)->
x
();

1881 
	gright
.
£tV®ue
(
Fixed
, 
¡©icPos™iÚ
);

1886 
	gwidthResuÉ
;

1887 
	gxResuÉ
;

1888 
ÿlcAbsŞu‹HÜizÚlV®ues
(
¡yË
()->
width
(), 
cÚš”Block
, 
cÚš”DœeùiÚ
,

1889 
cÚš”Width
, 
bÜd”sPlusPaddšg
,

1890 
Ëá
, 
right
, 
m¬gšLeá
, 
m¬gšRight
,

1891 
widthResuÉ
, 
m_m¬gšLeá
, 
m_m¬gšRight
, 
xResuÉ
);

1892 
£tWidth
(
widthResuÉ
);

1893 
£tX
(
xResuÉ
);

1896 ià(!
¡yË
()->
maxWidth
().
isUndefšed
()) {

1897 
	gmaxWidth
;

1898 
	gmaxM¬gšLeá
;

1899 
	gmaxM¬gšRight
;

1900 
	gmaxXPos
;

1902 
ÿlcAbsŞu‹HÜizÚlV®ues
(
¡yË
()->
maxWidth
(), 
cÚš”Block
, 
cÚš”DœeùiÚ
,

1903 
cÚš”Width
, 
bÜd”sPlusPaddšg
,

1904 
Ëá
, 
right
, 
m¬gšLeá
, 
m¬gšRight
,

1905 
maxWidth
, 
maxM¬gšLeá
, 
maxM¬gšRight
, 
maxXPos
);

1907 ià(
width
(è> 
	gmaxWidth
) {

1908 
£tWidth
(
maxWidth
);

1909 
	gm_m¬gšLeá
 = 
maxM¬gšLeá
;

1910 
	gm_m¬gšRight
 = 
maxM¬gšRight
;

1911 
	gm_äameReù
.
£tX
(
maxXPos
);

1916 ià(!
¡yË
()->
mšWidth
().
isZ”o
()) {

1917 
	gmšWidth
;

1918 
	gmšM¬gšLeá
;

1919 
	gmšM¬gšRight
;

1920 
	gmšXPos
;

1922 
ÿlcAbsŞu‹HÜizÚlV®ues
(
¡yË
()->
mšWidth
(), 
cÚš”Block
, 
cÚš”DœeùiÚ
,

1923 
cÚš”Width
, 
bÜd”sPlusPaddšg
,

1924 
Ëá
, 
right
, 
m¬gšLeá
, 
m¬gšRight
,

1925 
mšWidth
, 
mšM¬gšLeá
, 
mšM¬gšRight
, 
mšXPos
);

1927 ià(
width
(è< 
	gmšWidth
) {

1928 
£tWidth
(
mšWidth
);

1929 
	gm_m¬gšLeá
 = 
mšM¬gšLeá
;

1930 
	gm_m¬gšRight
 = 
mšM¬gšRight
;

1931 
	gm_äameReù
.
£tX
(
mšXPos
);

1935 ià(
¡»tchesToMšIÁršsicWidth
(è&& 
width
(è< 
mšP»fWidth
(è- 
	gbÜd”sPlusPaddšg
) {

1936 
ÿlcAbsŞu‹HÜizÚlV®ues
(
L’gth
(
mšP»fWidth
(è- 
bÜd”sPlusPaddšg
, 
Fixed
), 
cÚš”Block
, 
cÚš”DœeùiÚ
,

1937 
cÚš”Width
, 
bÜd”sPlusPaddšg
,

1938 
Ëá
, 
right
, 
m¬gšLeá
, 
m¬gšRight
,

1939 
widthResuÉ
, 
m_m¬gšLeá
, 
m_m¬gšRight
, 
xResuÉ
);

1940 
£tWidth
(
widthResuÉ
);

1941 
£tX
(
xResuÉ
);

1945 
£tWidth
(
width
(è+ 
bÜd”sPlusPaddšg
);

1948 
	gR’d”Box
::
ÿlcAbsŞu‹HÜizÚlV®ues
(
L’gth
 
width
, cÚ¡ 
R’d”BoxMod–Objeù
* 
cÚš”Block
, 
TextDœeùiÚ
 
cÚš”DœeùiÚ
,

1949 cÚ¡ 
cÚš”Width
, cÚ¡ 
bÜd”sPlusPaddšg
,

1950 cÚ¡ 
L’gth
 
Ëá
, cÚ¡ L’gth 
right
, cÚ¡ L’gth 
m¬gšLeá
, cÚ¡ L’gth 
m¬gšRight
,

1951 & 
widthV®ue
, & 
m¬gšLeáV®ue
, & 
m¬gšRightV®ue
, & 
xPos
)

1955 
ASSERT
(!(
Ëá
.
isAuto
(è&& 
right
.isAuto()));

1957 
	gËáV®ue
 = 0;

1959 
boŞ
 
	gwidthIsAuto
 = 
width
.
isIÁršsicOrAuto
();

1960 
boŞ
 
	gËáIsAuto
 = 
Ëá
.
isAuto
();

1961 
boŞ
 
	grightIsAuto
 = 
right
.
isAuto
();

1963 ià(!
	gËáIsAuto
 && !
	gwidthIsAuto
 && !
	grightIsAuto
) {

1979 
	gËáV®ue
 = 
Ëá
.
ÿlcV®ue
(
cÚš”Width
);

1980 
	gwidthV®ue
 = 
ÿlcCÚ‹ÁBoxWidth
(
width
.
ÿlcV®ue
(
cÚš”Width
));

1982 cÚ¡ 
	gavaabËS·û
 = 
cÚš”Width
 - (
ËáV®ue
 + 
widthV®ue
 + 
right
.
ÿlcV®ue
(cÚš”Widthè+ 
bÜd”sPlusPaddšg
);

1985 ià(
	gm¬gšLeá
.
isAuto
(è&& 
	gm¬gšRight
.isAuto()) {

1987 ià(
	gavaabËS·û
 >= 0) {

1988 
m¬gšLeáV®ue
 = 
avaabËS·û
 / 2;

1989 
	gm¬gšRightV®ue
 = 
avaabËS·û
 - 
m¬gšLeáV®ue
;

1992 ià(
	gcÚš”DœeùiÚ
 =ğ
LTR
) {

1993 
m¬gšLeáV®ue
 = 0;

1994 
	gm¬gšRightV®ue
 = 
avaabËS·û
;

1996 
	gm¬gšLeáV®ue
 = 
avaabËS·û
;

1997 
	gm¬gšRightV®ue
 = 0;

2000 } ià(
	gm¬gšLeá
.
isAuto
()) {

2002 
	gm¬gšRightV®ue
 = 
m¬gšRight
.
ÿlcV®ue
(
cÚš”Width
);

2003 
	gm¬gšLeáV®ue
 = 
avaabËS·û
 - 
m¬gšRightV®ue
;

2004 } ià(
	gm¬gšRight
.
isAuto
()) {

2006 
	gm¬gšLeáV®ue
 = 
m¬gšLeá
.
ÿlcV®ue
(
cÚš”Width
);

2007 
	gm¬gšRightV®ue
 = 
avaabËS·û
 - 
m¬gšLeáV®ue
;

2010 
	gm¬gšLeáV®ue
 = 
m¬gšLeá
.
ÿlcV®ue
(
cÚš”Width
);

2011 
	gm¬gšRightV®ue
 = 
m¬gšRight
.
ÿlcV®ue
(
cÚš”Width
);

2014 ià(
	gcÚš”DœeùiÚ
 =ğ
RTL
)

2015 
ËáV®ue
 = (
avaabËS·û
 +†eáV®ueè- 
m¬gšLeáV®ue
 - 
m¬gšRightV®ue
;

2060 
	gm¬gšLeáV®ue
 = 
m¬gšLeá
.
ÿlcMšV®ue
(
cÚš”Width
);

2061 
	gm¬gšRightV®ue
 = 
m¬gšRight
.
ÿlcMšV®ue
(
cÚš”Width
);

2063 cÚ¡ 
	gavaabËS·û
 = 
cÚš”Width
 - (
m¬gšLeáV®ue
 + 
m¬gšRightV®ue
 + 
bÜd”sPlusPaddšg
);

2067 ià(
	gËáIsAuto
 && 
	gwidthIsAuto
 && !
	grightIsAuto
) {

2069 
	grightV®ue
 = 
right
.
ÿlcV®ue
(
cÚš”Width
);

2072 
	g´eã¼edWidth
 = 
maxP»fWidth
(è- 
bÜd”sPlusPaddšg
;

2073 
	g´eã¼edMšWidth
 = 
mšP»fWidth
(è- 
bÜd”sPlusPaddšg
;

2074 
	gavaabËWidth
 = 
avaabËS·û
 - 
rightV®ue
;

2075 
	gwidthV®ue
 = 
mš
(
max
(
´eã¼edMšWidth
, 
avaabËWidth
), 
´eã¼edWidth
);

2076 
	gËáV®ue
 = 
avaabËS·û
 - (
widthV®ue
 + 
rightV®ue
);

2077 } ià(!
	gËáIsAuto
 && 
	gwidthIsAuto
 && 
	grightIsAuto
) {

2079 
	gËáV®ue
 = 
Ëá
.
ÿlcV®ue
(
cÚš”Width
);

2082 
	g´eã¼edWidth
 = 
maxP»fWidth
(è- 
bÜd”sPlusPaddšg
;

2083 
	g´eã¼edMšWidth
 = 
mšP»fWidth
(è- 
bÜd”sPlusPaddšg
;

2084 
	gavaabËWidth
 = 
avaabËS·û
 - 
ËáV®ue
;

2085 
	gwidthV®ue
 = 
mš
(
max
(
´eã¼edMšWidth
, 
avaabËWidth
), 
´eã¼edWidth
);

2086 } ià(
	gËáIsAuto
 && !
	gwidth
.
isAuto
(è&& !
	grightIsAuto
) {

2088 
	gwidthV®ue
 = 
ÿlcCÚ‹ÁBoxWidth
(
width
.
ÿlcV®ue
(
cÚš”Width
));

2089 
	gËáV®ue
 = 
avaabËS·û
 - (
widthV®ue
 + 
right
.
ÿlcV®ue
(
cÚš”Width
));

2090 } ià(!
	gËáIsAuto
 && 
	gwidthIsAuto
 && !
	grightIsAuto
) {

2092 
	gËáV®ue
 = 
Ëá
.
ÿlcV®ue
(
cÚš”Width
);

2093 
	gwidthV®ue
 = 
avaabËS·û
 - (
ËáV®ue
 + 
right
.
ÿlcV®ue
(
cÚš”Width
));

2094 } ià(!
	gËáIsAuto
&& !
	gwidthIsAuto
 && 
	grightIsAuto
) {

2096 
	gËáV®ue
 = 
Ëá
.
ÿlcV®ue
(
cÚš”Width
);

2097 
	gwidthV®ue
 = 
ÿlcCÚ‹ÁBoxWidth
(
width
.
ÿlcV®ue
(
cÚš”Width
));

2107 ià(
	gcÚš”Block
->
isR’d”IÆše
(è&& cÚš”Block->
¡yË
()->
dœeùiÚ
(è=ğ
RTL
) {

2108 cÚ¡ 
R’d”IÆše
* 
æow
 = 
toR’d”IÆše
(
cÚš”Block
);

2109 
IÆšeFlowBox
* 
	gfœ¡Lše
 = 
æow
->
fœ¡LšeBox
();

2110 
IÆšeFlowBox
* 
	gÏ¡Lše
 = 
æow
->
Ï¡LšeBox
();

2111 ià(
	gfœ¡Lše
 && 
	gÏ¡Lše
 && fœ¡Lš!ğ
Ï¡Lše
) {

2112 
xPos
 = 
ËáV®ue
 + 
m¬gšLeáV®ue
 + 
Ï¡Lše
->
bÜd”Leá
(è+ (Ï¡Lše->
x
(è- 
fœ¡Lše
->x());

2117 
	gxPos
 = 
ËáV®ue
 + 
m¬gšLeáV®ue
 + 
cÚš”Block
->
bÜd”Leá
();

2120 
	gR’d”Box
::
ÿlcAbsŞu‹V”tiÿl
()

2122 ià(
isR•Ïûd
()) {

2123 
ÿlcAbsŞu‹V”tiÿlR•Ïûd
();

2135 cÚ¡ 
R’d”BoxMod–Objeù
* 
	gcÚš”Block
 = 
toR’d”BoxMod–Objeù
(
cÚš”
());

2137 cÚ¡ 
	gcÚš”Height
 = 
cÚššgBlockHeightFÜPos™iÚed
(
cÚš”Block
);

2139 cÚ¡ 
	gbÜd”sPlusPaddšg
 = 
bÜd”Tİ
(è+ 
bÜd”BÙtom
(è+ 
·ddšgTİ
(è+ 
·ddšgBÙtom
();

2140 cÚ¡ 
L’gth
 
	gm¬gšTİ
 = 
¡yË
()->
m¬gšTİ
();

2141 cÚ¡ 
L’gth
 
	gm¬gšBÙtom
 = 
¡yË
()->
m¬gšBÙtom
();

2142 
L’gth
 
	gtİ
 = 
¡yË
()->
tİ
();

2143 
L’gth
 
	gbÙtom
 = 
¡yË
()->
bÙtom
();

2164 ià(
	gtİ
.
isAuto
(è&& 
	gbÙtom
.isAuto()) {

2166 
	g¡©icTİ
 = 
Ïy”
()->
¡©icY
(è- 
cÚš”Block
->
bÜd”Tİ
();

2167 
R’d”Objeù
* 
	gpo
 = 
·»Á
();…Ø&&…Ø!ğ
cÚš”Block
;…Øğ
po
->parent()) {

2168 ià(
po
->
isBox
(è&& !po->
isTabËRow
())

2169 
¡©icTİ
 +ğ
toR’d”Box
(
po
)->
y
();

2171 
	gtİ
.
£tV®ue
(
Fixed
, 
¡©icTİ
);

2175 
	gh
;

2176 
	gy
;

2179 
ÿlcAbsŞu‹V”tiÿlV®ues
(
¡yË
()->
height
(), 
cÚš”Block
, 
cÚš”Height
, 
bÜd”sPlusPaddšg
,

2180 
tİ
, 
bÙtom
, 
m¬gšTİ
, 
m¬gšBÙtom
,

2181 
h
, 
m_m¬gšTİ
, 
m_m¬gšBÙtom
, 
y
);

2182 
£tY
(
y
);

2188 ià(!
¡yË
()->
maxHeight
().
isUndefšed
()) {

2189 
	gmaxHeight
;

2190 
	gmaxM¬gšTİ
;

2191 
	gmaxM¬gšBÙtom
;

2192 
	gmaxYPos
;

2194 
ÿlcAbsŞu‹V”tiÿlV®ues
(
¡yË
()->
maxHeight
(), 
cÚš”Block
, 
cÚš”Height
, 
bÜd”sPlusPaddšg
,

2195 
tİ
, 
bÙtom
, 
m¬gšTİ
, 
m¬gšBÙtom
,

2196 
maxHeight
, 
maxM¬gšTİ
, 
maxM¬gšBÙtom
, 
maxYPos
);

2198 ià(
	gh
 > 
	gmaxHeight
) {

2199 
	gh
 = 
maxHeight
;

2200 
	gm_m¬gšTİ
 = 
maxM¬gšTİ
;

2201 
	gm_m¬gšBÙtom
 = 
maxM¬gšBÙtom
;

2202 
	gm_äameReù
.
£tY
(
maxYPos
);

2207 ià(!
¡yË
()->
mšHeight
().
isZ”o
()) {

2208 
	gmšHeight
;

2209 
	gmšM¬gšTİ
;

2210 
	gmšM¬gšBÙtom
;

2211 
	gmšYPos
;

2213 
ÿlcAbsŞu‹V”tiÿlV®ues
(
¡yË
()->
mšHeight
(), 
cÚš”Block
, 
cÚš”Height
, 
bÜd”sPlusPaddšg
,

2214 
tİ
, 
bÙtom
, 
m¬gšTİ
, 
m¬gšBÙtom
,

2215 
mšHeight
, 
mšM¬gšTİ
, 
mšM¬gšBÙtom
, 
mšYPos
);

2217 ià(
	gh
 < 
	gmšHeight
) {

2218 
	gh
 = 
mšHeight
;

2219 
	gm_m¬gšTİ
 = 
mšM¬gšTİ
;

2220 
	gm_m¬gšBÙtom
 = 
mšM¬gšBÙtom
;

2221 
	gm_äameReù
.
£tY
(
mšYPos
);

2226 
£tHeight
(
h
 + 
bÜd”sPlusPaddšg
);

2229 
	gR’d”Box
::
ÿlcAbsŞu‹V”tiÿlV®ues
(
L’gth
 
h
, cÚ¡ 
R’d”BoxMod–Objeù
* 
cÚš”Block
,

2230 cÚ¡ 
cÚš”Height
, cÚ¡ 
bÜd”sPlusPaddšg
,

2231 cÚ¡ 
L’gth
 
tİ
, cÚ¡ L’gth 
bÙtom
, cÚ¡ L’gth 
m¬gšTİ
, cÚ¡ L’gth 
m¬gšBÙtom
,

2232 & 
heightV®ue
, & 
m¬gšTİV®ue
, & 
m¬gšBÙtomV®ue
, & 
yPos
)

2236 
ASSERT
(!(
tİ
.
isAuto
(è&& 
bÙtom
.isAuto()));

2238 
	gcÚ‹ÁHeight
 = 
height
(è- 
bÜd”sPlusPaddšg
;

2240 
	gtİV®ue
 = 0;

2242 
boŞ
 
	gheightIsAuto
 = 
h
.
isAuto
();

2243 
boŞ
 
	gtİIsAuto
 = 
tİ
.
isAuto
();

2244 
boŞ
 
	gbÙtomIsAuto
 = 
bÙtom
.
isAuto
();

2247 ià(
isTabË
()) {

2248 
	gh
.
£tV®ue
(
Fixed
, 
cÚ‹ÁHeight
);

2249 
	gheightIsAuto
 = 
çl£
;

2252 ià(!
	gtİIsAuto
 && !
	gheightIsAuto
 && !
	gbÙtomIsAuto
) {

2264 
	gheightV®ue
 = 
ÿlcCÚ‹ÁBoxHeight
(
h
.
ÿlcV®ue
(
cÚš”Height
));

2265 
	gtİV®ue
 = 
tİ
.
ÿlcV®ue
(
cÚš”Height
);

2267 cÚ¡ 
	gavaabËS·û
 = 
cÚš”Height
 - (
tİV®ue
 + 
heightV®ue
 + 
bÙtom
.
ÿlcV®ue
(cÚš”Heightè+ 
bÜd”sPlusPaddšg
);

2270 ià(
	gm¬gšTİ
.
isAuto
(è&& 
	gm¬gšBÙtom
.isAuto()) {

2273 
	gm¬gšTİV®ue
 = 
avaabËS·û
 / 2;

2274 
	gm¬gšBÙtomV®ue
 = 
avaabËS·û
 - 
m¬gšTİV®ue
;

2275 } ià(
	gm¬gšTİ
.
isAuto
()) {

2277 
	gm¬gšBÙtomV®ue
 = 
m¬gšBÙtom
.
ÿlcV®ue
(
cÚš”Height
);

2278 
	gm¬gšTİV®ue
 = 
avaabËS·û
 - 
m¬gšBÙtomV®ue
;

2279 } ià(
	gm¬gšBÙtom
.
isAuto
()) {

2281 
	gm¬gšTİV®ue
 = 
m¬gšTİ
.
ÿlcV®ue
(
cÚš”Height
);

2282 
	gm¬gšBÙtomV®ue
 = 
avaabËS·û
 - 
m¬gšTİV®ue
;

2285 
	gm¬gšTİV®ue
 = 
m¬gšTİ
.
ÿlcV®ue
(
cÚš”Height
);

2286 
	gm¬gšBÙtomV®ue
 = 
m¬gšBÙtom
.
ÿlcV®ue
(
cÚš”Height
);

2315 
	gm¬gšTİV®ue
 = 
m¬gšTİ
.
ÿlcMšV®ue
(
cÚš”Height
);

2316 
	gm¬gšBÙtomV®ue
 = 
m¬gšBÙtom
.
ÿlcMšV®ue
(
cÚš”Height
);

2318 cÚ¡ 
	gavaabËS·û
 = 
cÚš”Height
 - (
m¬gšTİV®ue
 + 
m¬gšBÙtomV®ue
 + 
bÜd”sPlusPaddšg
);

2321 ià(
	gtİIsAuto
 && 
	gheightIsAuto
 && !
	gbÙtomIsAuto
) {

2323 
	gheightV®ue
 = 
cÚ‹ÁHeight
;

2324 
	gtİV®ue
 = 
avaabËS·û
 - (
heightV®ue
 + 
bÙtom
.
ÿlcV®ue
(
cÚš”Height
));

2325 } ià(!
	gtİIsAuto
 && 
	gheightIsAuto
 && 
	gbÙtomIsAuto
) {

2327 
	gtİV®ue
 = 
tİ
.
ÿlcV®ue
(
cÚš”Height
);

2328 
	gheightV®ue
 = 
cÚ‹ÁHeight
;

2329 } ià(
	gtİIsAuto
 && !
	gheightIsAuto
 && !
	gbÙtomIsAuto
) {

2331 
	gheightV®ue
 = 
ÿlcCÚ‹ÁBoxHeight
(
h
.
ÿlcV®ue
(
cÚš”Height
));

2332 
	gtİV®ue
 = 
avaabËS·û
 - (
heightV®ue
 + 
bÙtom
.
ÿlcV®ue
(
cÚš”Height
));

2333 } ià(!
	gtİIsAuto
 && 
	gheightIsAuto
 && !
	gbÙtomIsAuto
) {

2335 
	gtİV®ue
 = 
tİ
.
ÿlcV®ue
(
cÚš”Height
);

2336 
	gheightV®ue
 = 
max
(0, 
avaabËS·û
 - (
tİV®ue
 + 
bÙtom
.
ÿlcV®ue
(
cÚš”Height
)));

2337 } ià(!
	gtİIsAuto
 && !
	gheightIsAuto
 && 
	gbÙtomIsAuto
) {

2339 
	gheightV®ue
 = 
ÿlcCÚ‹ÁBoxHeight
(
h
.
ÿlcV®ue
(
cÚš”Height
));

2340 
	gtİV®ue
 = 
tİ
.
ÿlcV®ue
(
cÚš”Height
);

2345 
	gyPos
 = 
tİV®ue
 + 
m¬gšTİV®ue
 + 
cÚš”Block
->
bÜd”Tİ
();

2348 
	gR’d”Box
::
ÿlcAbsŞu‹HÜizÚlR•Ïûd
()

2358 cÚ¡ 
R’d”BoxMod–Objeù
* 
cÚš”Block
 = 
toR’d”BoxMod–Objeù
(
cÚš”
());

2360 cÚ¡ 
	gcÚš”Width
 = 
cÚššgBlockWidthFÜPos™iÚed
(
cÚš”Block
);

2364 
TextDœeùiÚ
 
	gcÚš”DœeùiÚ
 = (
¡yË
()->
htmlHacks
()è? 
·»Á
()->¡yË()->
dœeùiÚ
(è: 
cÚš”Block
->style()->direction();

2367 
L’gth
 
	gËá
 = 
¡yË
()->
Ëá
();

2368 
L’gth
 
	gright
 = 
¡yË
()->
right
();

2369 
L’gth
 
	gm¬gšLeá
 = 
¡yË
()->
m¬gšLeá
();

2370 
L’gth
 
	gm¬gšRight
 = 
¡yË
()->
m¬gšRight
();

2380 
£tWidth
(
ÿlcR•ÏûdWidth
(è+ 
bÜd”Leá
(è+ 
bÜd”Right
(è+ 
·ddšgLeá
(è+ 
·ddšgRight
());

2381 cÚ¡ 
	gavaabËS·û
 = 
cÚš”Width
 - 
width
();

2389 ià(
	gËá
.
isAuto
(è&& 
	gright
.isAuto()) {

2391 ià(
	gcÚš”DœeùiÚ
 =ğ
LTR
) {

2393 
¡©icPos™iÚ
 = 
Ïy”
()->
¡©icX
(è- 
cÚš”Block
->
bÜd”Leá
();

2394 
R’d”Objeù
* 
	gpo
 = 
·»Á
();…Ø&&…Ø!ğ
cÚš”Block
;…Øğ
po
->parent()) {

2395 ià(
po
->
isBox
())

2396 
¡©icPos™iÚ
 +ğ
toR’d”Box
(
po
)->
x
();

2398 
	gËá
.
£tV®ue
(
Fixed
, 
¡©icPos™iÚ
);

2400 
R’d”Objeù
* 
	gpo
 = 
·»Á
();

2402 
	g¡©icPos™iÚ
 = 
Ïy”
()->
¡©icX
(è+ 
cÚš”Width
 + 
cÚš”Block
->
bÜd”Right
();

2403  ; 
	gpo
 &&…Ø!ğ
cÚš”Block
;…Øğ
po
->
·»Á
()) {

2404 ià(
po
->
isBox
())

2405 
¡©icPos™iÚ
 +ğ
toR’d”Box
(
po
)->
x
();

2407 
	gright
.
£tV®ue
(
Fixed
, 
¡©icPos™iÚ
);

2415 ià(
	gËá
.
isAuto
(è|| 
	gright
.isAuto()) {

2416 ià(
	gm¬gšLeá
.
isAuto
())

2417 
	gm¬gšLeá
.
£tV®ue
(
Fixed
, 0);

2418 ià(
	gm¬gšRight
.
isAuto
())

2419 
	gm¬gšRight
.
£tV®ue
(
Fixed
, 0);

2430 
	gËáV®ue
 = 0;

2431 
	grightV®ue
 = 0;

2433 ià(
	gm¬gšLeá
.
isAuto
(è&& 
	gm¬gšRight
.isAuto()) {

2435 
ASSERT
(!(
Ëá
.
isAuto
(è&& 
right
.isAuto()));

2437 
	gËáV®ue
 = 
Ëá
.
ÿlcV®ue
(
cÚš”Width
);

2438 
	grightV®ue
 = 
right
.
ÿlcV®ue
(
cÚš”Width
);

2440 
	gdifã»nû
 = 
avaabËS·û
 - (
ËáV®ue
 + 
rightV®ue
);

2441 ià(
	gdifã»nû
 > 0) {

2442 
	gm_m¬gšLeá
 = 
difã»nû
 / 2;

2443 
	gm_m¬gšRight
 = 
difã»nû
 - 
m_m¬gšLeá
;

2446 ià(
	gcÚš”DœeùiÚ
 =ğ
LTR
) {

2447 
m_m¬gšLeá
 = 0;

2448 
	gm_m¬gšRight
 = 
difã»nû
;

2450 
	gm_m¬gšLeá
 = 
difã»nû
;

2451 
	gm_m¬gšRight
 = 0;

2459 } ià(
	gËá
.
isAuto
()) {

2460 
	gm_m¬gšLeá
 = 
m¬gšLeá
.
ÿlcV®ue
(
cÚš”Width
);

2461 
	gm_m¬gšRight
 = 
m¬gšRight
.
ÿlcV®ue
(
cÚš”Width
);

2462 
	grightV®ue
 = 
right
.
ÿlcV®ue
(
cÚš”Width
);

2465 
	gËáV®ue
 = 
avaabËS·û
 - (
rightV®ue
 + 
m_m¬gšLeá
 + 
m_m¬gšRight
);

2466 } ià(
	gright
.
isAuto
()) {

2467 
	gm_m¬gšLeá
 = 
m¬gšLeá
.
ÿlcV®ue
(
cÚš”Width
);

2468 
	gm_m¬gšRight
 = 
m¬gšRight
.
ÿlcV®ue
(
cÚš”Width
);

2469 
	gËáV®ue
 = 
Ëá
.
ÿlcV®ue
(
cÚš”Width
);

2472 
	grightV®ue
 = 
avaabËS·û
 - (
ËáV®ue
 + 
m_m¬gšLeá
 + 
m_m¬gšRight
);

2473 } ià(
	gm¬gšLeá
.
isAuto
()) {

2474 
	gm_m¬gšRight
 = 
m¬gšRight
.
ÿlcV®ue
(
cÚš”Width
);

2475 
	gËáV®ue
 = 
Ëá
.
ÿlcV®ue
(
cÚš”Width
);

2476 
	grightV®ue
 = 
right
.
ÿlcV®ue
(
cÚš”Width
);

2479 
	gm_m¬gšLeá
 = 
avaabËS·û
 - (
ËáV®ue
 + 
rightV®ue
 + 
m_m¬gšRight
);

2480 } ià(
	gm¬gšRight
.
isAuto
()) {

2481 
	gm_m¬gšLeá
 = 
m¬gšLeá
.
ÿlcV®ue
(
cÚš”Width
);

2482 
	gËáV®ue
 = 
Ëá
.
ÿlcV®ue
(
cÚš”Width
);

2483 
	grightV®ue
 = 
right
.
ÿlcV®ue
(
cÚš”Width
);

2486 
	gm_m¬gšRight
 = 
avaabËS·û
 - (
ËáV®ue
 + 
rightV®ue
 + 
m_m¬gšLeá
);

2489 
	gm_m¬gšLeá
 = 
m¬gšLeá
.
ÿlcV®ue
(
cÚš”Width
);

2490 
	gm_m¬gšRight
 = 
m¬gšRight
.
ÿlcV®ue
(
cÚš”Width
);

2491 
	grightV®ue
 = 
right
.
ÿlcV®ue
(
cÚš”Width
);

2492 
	gËáV®ue
 = 
Ëá
.
ÿlcV®ue
(
cÚš”Width
);

2503 
	gtÙ®Width
 = 
width
(è+ 
ËáV®ue
 + 
rightV®ue
 + 
m_m¬gšLeá
 + 
m_m¬gšRight
;

2504 ià(
	gtÙ®Width
 > 
	gcÚš”Width
 && (
	gcÚš”DœeùiÚ
 =ğ
RTL
))

2505 
ËáV®ue
 = 
cÚš”Width
 - (
tÙ®Width
 -†eftValue);

2513 ià(
	gcÚš”Block
->
isR’d”IÆše
(è&& cÚš”Block->
¡yË
()->
dœeùiÚ
(è=ğ
RTL
) {

2514 cÚ¡ 
R’d”IÆše
* 
æow
 = 
toR’d”IÆše
(
cÚš”Block
);

2515 
IÆšeFlowBox
* 
	gfœ¡Lše
 = 
æow
->
fœ¡LšeBox
();

2516 
IÆšeFlowBox
* 
	gÏ¡Lše
 = 
æow
->
Ï¡LšeBox
();

2517 ià(
	gfœ¡Lše
 && 
	gÏ¡Lše
 && fœ¡Lš!ğ
Ï¡Lše
) {

2518 
m_äameReù
.
£tX
(
ËáV®ue
 + 
m_m¬gšLeá
 + 
Ï¡Lše
->
bÜd”Leá
(è+ (Ï¡Lše->
x
(è- 
fœ¡Lše
->x()));

2523 
	gm_äameReù
.
£tX
(
ËáV®ue
 + 
m_m¬gšLeá
 + 
cÚš”Block
->
bÜd”Leá
());

2526 
	gR’d”Box
::
ÿlcAbsŞu‹V”tiÿlR•Ïûd
()

2535 cÚ¡ 
R’d”BoxMod–Objeù
* 
cÚš”Block
 = 
toR’d”BoxMod–Objeù
(
cÚš”
());

2537 cÚ¡ 
	gcÚš”Height
 = 
cÚššgBlockHeightFÜPos™iÚed
(
cÚš”Block
);

2540 
L’gth
 
	gtİ
 = 
¡yË
()->
tİ
();

2541 
L’gth
 
	gbÙtom
 = 
¡yË
()->
bÙtom
();

2542 
L’gth
 
	gm¬gšTİ
 = 
¡yË
()->
m¬gšTİ
();

2543 
L’gth
 
	gm¬gšBÙtom
 = 
¡yË
()->
m¬gšBÙtom
();

2553 
£tHeight
(
ÿlcR•ÏûdHeight
(è+ 
bÜd”Tİ
(è+ 
bÜd”BÙtom
(è+ 
·ddšgTİ
(è+ 
·ddšgBÙtom
());

2554 cÚ¡ 
	gavaabËS·û
 = 
cÚš”Height
 - 
height
();

2561 ià(
	gtİ
.
isAuto
(è&& 
	gbÙtom
.isAuto()) {

2563 
	g¡©icTİ
 = 
Ïy”
()->
¡©icY
(è- 
cÚš”Block
->
bÜd”Tİ
();

2564 
R’d”Objeù
* 
	gpo
 = 
·»Á
();…Ø&&…Ø!ğ
cÚš”Block
;…Øğ
po
->parent()) {

2565 ià(
po
->
isBox
(è&& !po->
isTabËRow
())

2566 
¡©icTİ
 +ğ
toR’d”Box
(
po
)->
y
();

2568 
	gtİ
.
£tV®ue
(
Fixed
, 
¡©icTİ
);

2577 ià(
	gtİ
.
isAuto
(è|| 
	gbÙtom
.isAuto()) {

2578 ià(
	gm¬gšTİ
.
isAuto
())

2579 
	gm¬gšTİ
.
£tV®ue
(
Fixed
, 0);

2580 ià(
	gm¬gšBÙtom
.
isAuto
())

2581 
	gm¬gšBÙtom
.
£tV®ue
(
Fixed
, 0);

2589 
	gtİV®ue
 = 0;

2590 
	gbÙtomV®ue
 = 0;

2592 ià(
	gm¬gšTİ
.
isAuto
(è&& 
	gm¬gšBÙtom
.isAuto()) {

2594 
ASSERT
(!(
tİ
.
isAuto
(è|| 
bÙtom
.isAuto()));

2596 
	gtİV®ue
 = 
tİ
.
ÿlcV®ue
(
cÚš”Height
);

2597 
	gbÙtomV®ue
 = 
bÙtom
.
ÿlcV®ue
(
cÚš”Height
);

2599 
	gdifã»nû
 = 
avaabËS·û
 - (
tİV®ue
 + 
bÙtomV®ue
);

2601 
	gm_m¬gšTİ
 = 
difã»nû
 / 2;

2602 
	gm_m¬gšBÙtom
 = 
difã»nû
 - 
m_m¬gšTİ
;

2608 } ià(
	gtİ
.
isAuto
()) {

2609 
	gm_m¬gšTİ
 = 
m¬gšTİ
.
ÿlcV®ue
(
cÚš”Height
);

2610 
	gm_m¬gšBÙtom
 = 
m¬gšBÙtom
.
ÿlcV®ue
(
cÚš”Height
);

2611 
	gbÙtomV®ue
 = 
bÙtom
.
ÿlcV®ue
(
cÚš”Height
);

2614 
	gtİV®ue
 = 
avaabËS·û
 - (
bÙtomV®ue
 + 
m_m¬gšTİ
 + 
m_m¬gšBÙtom
);

2615 } ià(
	gbÙtom
.
isAuto
()) {

2616 
	gm_m¬gšTİ
 = 
m¬gšTİ
.
ÿlcV®ue
(
cÚš”Height
);

2617 
	gm_m¬gšBÙtom
 = 
m¬gšBÙtom
.
ÿlcV®ue
(
cÚš”Height
);

2618 
	gtİV®ue
 = 
tİ
.
ÿlcV®ue
(
cÚš”Height
);

2623 } ià(
	gm¬gšTİ
.
isAuto
()) {

2624 
	gm_m¬gšBÙtom
 = 
m¬gšBÙtom
.
ÿlcV®ue
(
cÚš”Height
);

2625 
	gtİV®ue
 = 
tİ
.
ÿlcV®ue
(
cÚš”Height
);

2626 
	gbÙtomV®ue
 = 
bÙtom
.
ÿlcV®ue
(
cÚš”Height
);

2629 
	gm_m¬gšTİ
 = 
avaabËS·û
 - (
tİV®ue
 + 
bÙtomV®ue
 + 
m_m¬gšBÙtom
);

2630 } ià(
	gm¬gšBÙtom
.
isAuto
()) {

2631 
	gm_m¬gšTİ
 = 
m¬gšTİ
.
ÿlcV®ue
(
cÚš”Height
);

2632 
	gtİV®ue
 = 
tİ
.
ÿlcV®ue
(
cÚš”Height
);

2633 
	gbÙtomV®ue
 = 
bÙtom
.
ÿlcV®ue
(
cÚš”Height
);

2636 
	gm_m¬gšBÙtom
 = 
avaabËS·û
 - (
tİV®ue
 + 
bÙtomV®ue
 + 
m_m¬gšTİ
);

2639 
	gm_m¬gšTİ
 = 
m¬gšTİ
.
ÿlcV®ue
(
cÚš”Height
);

2640 
	gm_m¬gšBÙtom
 = 
m¬gšBÙtom
.
ÿlcV®ue
(
cÚš”Height
);

2641 
	gtİV®ue
 = 
tİ
.
ÿlcV®ue
(
cÚš”Height
);

2655 
	gm_äameReù
.
£tY
(
tİV®ue
 + 
m_m¬gšTİ
 + 
cÚš”Block
->
bÜd”Tİ
());

2658 
IÁReù
 
	gR’d”Box
::
loÿlC¬‘Reù
(
IÆšeBox
* 
box
, 
ÿ»tOff£t
, * 
exŒaWidthToEndOfLše
)

2666 
IÁReù
 
»ù
(
x
(), 
y
(), 
ÿ»tWidth
, 
height
());

2667 
TextDœeùiÚ
 
	gdœeùiÚ
 = 
box
 ? box->
dœeùiÚ
(è: 
¡yË
()->direction();

2669 ià((!
	gÿ»tOff£t
è^ (
	gdœeùiÚ
 =ğ
LTR
))

2670 
»ù
.
move
(
IÁSize
(
width
(è- 
ÿ»tWidth
, 0));

2672 ià(
	gbox
) {

2673 
RoÙIÆšeBox
* 
	groÙBox
 = 
box
->
roÙ
();

2674 
	gtİ
 = 
roÙBox
->
lšeTİ
();

2675 
	g»ù
.
£tY
(
tİ
);

2676 
	g»ù
.
£tHeight
(
roÙBox
->
lšeBÙtom
(è- 
tİ
);

2687 
	gfÚtHeight
 = 
¡yË
()->
fÚt
().
height
();

2688 ià(
	gfÚtHeight
 > 
	g»ù
.
height
(è|| (!
isR•Ïûd
(è&& !
isTabË
()))

2689 
	g»ù
.
£tHeight
(
fÚtHeight
);

2691 ià(
	gexŒaWidthToEndOfLše
)

2692 *
	gexŒaWidthToEndOfLše
 = 
x
(è+ 
width
(è- 
»ù
.
right
();

2695 
	g»ù
.
move
(-
x
(), -
y
());

2696  
	g»ù
;

2699 
	gR’d”Box
::
lowe¡Pos™iÚ
(
boŞ
 , boŞ 
šşudeS–f
) const

2701 ià(!
	gšşudeS–f
 || !
width
())

2703 
	gbÙtom
 = 
height
();

2704 ià(
isR–Pos™iÚed
())

2705 
	gbÙtom
 +ğ
»ÏtivePos™iÚOff£tY
();

2706  
	gbÙtom
;

2709 
	gR’d”Box
::
rightmo¡Pos™iÚ
(
boŞ
 , boŞ 
šşudeS–f
) const

2711 ià(!
	gšşudeS–f
 || !
height
())

2713 
	gright
 = 
width
();

2714 ià(
isR–Pos™iÚed
())

2715 
	gright
 +ğ
»ÏtivePos™iÚOff£tX
();

2716  
	gright
;

2719 
	gR’d”Box
::
Ëámo¡Pos™iÚ
(
boŞ
 , boŞ 
šşudeS–f
) const

2721 ià(!
	gšşudeS–f
 || !
height
())

2722  
width
();

2723 
	gËá
 = 0;

2724 ià(
isR–Pos™iÚed
())

2725 
	gËá
 +ğ
»ÏtivePos™iÚOff£tX
();

2726  
	gËá
;

2729 
VisibËPos™iÚ
 
	gR’d”Box
::
pos™iÚFÜPošt
(cÚ¡ 
IÁPošt
& 
pošt
)

2732 ià(!
fœ¡Chd
())

2733  
ü—‹VisibËPos™iÚ
(
node
(è? 
fœ¡D“pEd™šgPos™iÚFÜNode
Òode()è: 
Pos™iÚ
(0, 0));

2735 
	gxPos
 = 
pošt
.
x
();

2736 
	gyPos
 = 
pošt
.
y
();

2738 ià(
isTabË
(è&& 
node
()) {

2739 
	gright
 = 
cÚ‹ÁWidth
(è+ 
bÜd”Right
(è+ 
·ddšgRight
(è+ 
bÜd”Leá
(è+ 
·ddšgLeá
();

2740 
	gbÙtom
 = 
cÚ‹ÁHeight
(è+ 
bÜd”Tİ
(è+ 
·ddšgTİ
(è+ 
bÜd”BÙtom
(è+ 
·ddšgBÙtom
();

2742 ià(
	gxPos
 < 0 || xPo > 
	gright
 || 
	gyPos
 < 0 || yPo > 
	gbÙtom
) {

2743 ià(
	gxPos
 <ğ
right
 / 2)

2744  
ü—‹VisibËPos™iÚ
(
fœ¡D“pEd™šgPos™iÚFÜNode
(
node
()));

2745  
ü—‹VisibËPos™iÚ
(
Ï¡D“pEd™šgPos™iÚFÜNode
(
node
()));

2750 
	gmšDi¡
 = 
INT_MAX
;

2751 
R’d”Box
* 
	gşo£¡R’d””
 = 0;

2752 
	gÃwX
 = 
xPos
;

2753 
	gÃwY
 = 
yPos
;

2754 ià(
isTabËRow
()) {

2755 
	gÃwX
 +ğ
x
();

2756 
	gÃwY
 +ğ
y
();

2758 
R’d”Objeù
* 
	g»nd”Objeù
 = 
fœ¡Chd
();„’d”Objeù;„’d”Objeù = 
»nd”Objeù
->
ÃxtSiblšg
()) {

2759 ià((!
»nd”Objeù
->
fœ¡Chd
(è&& !»nd”Objeù->
isIÆše
(è&& !»nd”Objeù->
isBlockFlow
() )

2760 || 
»nd”Objeù
->
¡yË
()->
visib™y
(è!ğ
VISIBLE
)

2763 ià(!
	g»nd”Objeù
->
isBox
())

2766 
R’d”Box
* 
	g»nd””
 = 
toR’d”Box
(
»nd”Objeù
);

2768 
	gtİ
 = 
»nd””
->
bÜd”Tİ
(è+„’d””->
·ddšgTİ
(è+ (
isTabËRow
(è? 0 :„’d””->
y
());

2769 
	gbÙtom
 = 
tİ
 + 
»nd””
->
cÚ‹ÁHeight
();

2770 
	gËá
 = 
»nd””
->
bÜd”Leá
(è+„’d””->
·ddšgLeá
(è+ (
isTabËRow
(è? 0 :„’d””->
x
());

2771 
	gright
 = 
Ëá
 + 
»nd””
->
cÚ‹ÁWidth
();

2773 ià(
	gxPos
 <ğ
right
 && 
xPos
 >ğ
Ëá
 && 
yPos
 <ğ
tİ
 && yPo >ğ
bÙtom
) {

2774 ià(
»nd””
->
isTabËRow
())

2775  
»nd””
->
pos™iÚFÜCoÜdš©es
(
xPos
 + 
ÃwX
 -„’d””->
x
(), 
yPos
 + 
ÃwY
 -„’d””->
y
());

2776  
	g»nd””
->
pos™iÚFÜCoÜdš©es
(
xPos
 - 
»nd””
->
x
(), 
yPos
 -„’d””->
y
());

2781 
IÁPošt
 
	gcmp
;

2782 ià(
	gxPos
 > 
	gright
) {

2783 ià(
	gyPos
 < 
	gtİ
)

2784 
	gcmp
 = 
IÁPošt
(
right
, 
tİ
);

2785 ià(
	gyPos
 > 
	gbÙtom
)

2786 
	gcmp
 = 
IÁPošt
(
right
, 
bÙtom
);

2788 
	gcmp
 = 
IÁPošt
(
right
, 
yPos
);

2789 } ià(
	gxPos
 < 
	gËá
) {

2790 ià(
	gyPos
 < 
	gtİ
)

2791 
	gcmp
 = 
IÁPošt
(
Ëá
, 
tİ
);

2792 ià(
	gyPos
 > 
	gbÙtom
)

2793 
	gcmp
 = 
IÁPošt
(
Ëá
, 
bÙtom
);

2795 
	gcmp
 = 
IÁPošt
(
Ëá
, 
yPos
);

2797 ià(
	gyPos
 < 
	gtİ
)

2798 
	gcmp
 = 
IÁPošt
(
xPos
, 
tİ
);

2800 
	gcmp
 = 
IÁPošt
(
xPos
, 
bÙtom
);

2803 
	gx1mšusx2
 = 
cmp
.
x
(è- 
xPos
;

2804 
	gy1mšusy2
 = 
cmp
.
y
(è- 
yPos
;

2806 
	gdi¡
 = 
x1mšusx2
 * x1mšusx2 + 
y1mšusy2
 * y1minusy2;

2807 ià(
	gdi¡
 < 
	gmšDi¡
) {

2808 
	gşo£¡R’d””
 = 
»nd””
;

2809 
	gmšDi¡
 = 
di¡
;

2813 ià(
	gşo£¡R’d””
)

2814  
	gşo£¡R’d””
->
pos™iÚFÜCoÜdš©es
(
ÃwX
 - 
şo£¡R’d””
->
x
(), 
ÃwY
 - clo£¡R’d””->
y
());

2816  
ü—‹VisibËPos™iÚ
(
fœ¡D“pEd™šgPos™iÚFÜNode
(
node
()));

2819 
boŞ
 
	gR’d”Box
::
shrškToAvoidFlßts
() const

2824 ià((
isIÆše
(è&& !
isHTMLM¬qu“
()è|| !
avoidsFlßts
())

2825  
çl£
;

2828  
¡yË
()->
width
().
isAuto
();

2831 
boŞ
 
	gR’d”Box
::
avoidsFlßts
() const

2833  
isR•Ïûd
(è|| 
hasOv”æowCl
(è|| 
isHR
();

2836 
	gR’d”Box
::
addShadowOv”æow
()

2838 
shadowLeá
;

2839 
	gshadowRight
;

2840 
	gshadowTİ
;

2841 
	gshadowBÙtom
;

2842 
¡yË
()->
g‘BoxShadowEx‹Á
(
shadowTİ
, 
shadowRight
, 
shadowBÙtom
, 
shadowLeá
);

2843 
IÁReù
 
	gbÜd”Box
 = 
bÜd”BoxReù
();

2844 
	gov”æowLeá
 = 
bÜd”Box
.
x
(è+ 
shadowLeá
;

2845 
	gov”æowRight
 = 
bÜd”Box
.
right
(è+ 
shadowRight
;

2846 
	gov”æowTİ
 = 
bÜd”Box
.
y
(è+ 
shadowTİ
;

2847 
	gov”æowBÙtom
 = 
bÜd”Box
.
bÙtom
(è+ 
shadowBÙtom
;

2848 
addVisu®Ov”æow
(
IÁReù
(
ov”æowLeá
, 
ov”æowTİ
, 
ov”æowRight
 - ov”æowLeá, 
ov”æowBÙtom
 - overflowTop));

2851 
	gR’d”Box
::
addOv”æowFromChd
(
R’d”Box
* 
chd
, cÚ¡ 
IÁSize
& 
d–
)

2855 ià(
	gchd
->
hasS–fPaštšgLay”
())

2860 
IÁReù
 
	gchdLayoutOv”æowReù
 = 
chd
->
hasOv”æowCl
(è? chd->
bÜd”BoxReù
(è: chd->
ÏyoutOv”æowReù
();

2861 
	gchdLayoutOv”æowReù
.
move
(
d–
);

2862 
addLayoutOv”æow
(
chdLayoutOv”æowReù
);

2867 ià(
hasOv”æowCl
())

2869 
IÁReù
 
	gchdVisu®Ov”æowReù
 = 
chd
->
visu®Ov”æowReù
();

2870 
	gchdVisu®Ov”æowReù
.
move
(
d–
);

2871 
addVisu®Ov”æow
(
chdVisu®Ov”æowReù
);

2874 
	gR’d”Box
::
addLayoutOv”æow
(cÚ¡ 
IÁReù
& 
»ù
)

2876 
IÁReù
 
bÜd”Box
 = 
bÜd”BoxReù
();

2877 ià(
	gbÜd”Box
.
cÚšs
(
»ù
))

2880 ià(!
	gm_ov”æow
)

2881 
	gm_ov”æow
.
£t
(
Ãw
 
R’d”Ov”æow
(
bÜd”Box
));

2882 
	gm_ov”æow
->
addLayoutOv”æow
(
»ù
);

2884 #iâdeà
NDEBUG


2885 #ifdeà
PRINT_OVERFLOW


2886 
showR’d”Objeù
();

2891 
	gR’d”Box
::
addVisu®Ov”æow
(cÚ¡ 
IÁReù
& 
»ù
)

2893 
IÁReù
 
bÜd”Box
 = 
bÜd”BoxReù
();

2894 ià(
	gbÜd”Box
.
cÚšs
(
»ù
))

2897 #iâdeà
NDEBUG


2898 #ifdeà
PRINT_OVERFLOW


2899 
showR’d”Objeù
();

2902 ià(!
	gm_ov”æow
)

2903 
	gm_ov”æow
.
£t
(
Ãw
 
R’d”Ov”æow
(
bÜd”Box
));

2905 
	gm_ov”æow
->
addVisu®Ov”æow
(
»ù
);

2908 
	gR’d”Box
::
ş—rLayoutOv”æow
()

2910 ià(!
m_ov”æow
)

2913 ià(
visu®Ov”æowReù
(è=ğ
bÜd”BoxReù
()) {

2914 
m_ov”æow
.
ş—r
();

2918 
	gm_ov”æow
->
»£tLayoutOv”æow
(
bÜd”BoxReù
());

2921 #ià
ENABLE
(
SVG
)

2923 
AffšeT¿nsfÜm
 
	gR’d”Box
::
loÿlT¿nsfÜm
() const

2925  
AffšeT¿nsfÜm
(1, 0, 0, 1, 
x
(), 
y
());

	@RenderBox.h

23 #iâdeà
R’d”Box_h


24 
	#R’d”Box_h


	)

26 
	~"R’d”BoxMod–Objeù.h
"

27 
	~"R’d”Ov”æow.h
"

28 
	~"SüŞlTy³s.h
"

30 
Çme¥aû
 
	gWebCÜe
 {

32 
	eWidthTy³
 { 
	gWidth
, 
	gMšWidth
, 
	gMaxWidth
 };

34 şas 
	cR’d”Box
 : 
public
 
R’d”BoxMod–Objeù
 {

35 
public
:

36 
R’d”Box
(
Node
*);

37 
	gvœtu®
 ~
R’d”Box
();

40 
R’d”Box
* 
fœ¡ChdBox
() const;

41 
R’d”Box
* 
Ï¡ChdBox
() const;

43 
x
(ècÚ¡ {  
	gm_äameReù
.x(); }

44 
y
(ècÚ¡ {  
	gm_äameReù
.y(); }

45 
width
(ècÚ¡ {  
	gm_äameReù
.width(); }

46 
height
(ècÚ¡ {  
	gm_äameReù
.height(); }

48 
£tX
(
x
è{ 
	gm_äameReù
.setX(x); }

49 
£tY
(
y
è{ 
	gm_äameReù
.setY(y); }

50 
£tWidth
(
width
è{ 
	gm_äameReù
.setWidth(width); }

51 
£tHeight
(
height
è{ 
	gm_äameReù
.setHeight(height); }

53 
IÁPošt
 
loÿtiÚ
(ècÚ¡ {  
	gm_äameReù
.location(); }

54 
IÁSize
 
size
(ècÚ¡ {  
	gm_äameReù
.size(); }

56 
£tLoÿtiÚ
(cÚ¡ 
IÁPošt
& 
loÿtiÚ
è{ 
	gm_äameReù
.setLocation(location); }

57 
£tLoÿtiÚ
(
x
, 
y
è{ s‘LoÿtiÚ(
IÁPošt
(x, y)); }

59 
£tSize
(cÚ¡ 
IÁSize
& 
size
è{ 
	gm_äameReù
.setSize(size); }

60 
move
(
dx
, 
dy
è{ 
	gm_äameReù
.move(dx, dy); }

62 
IÁReù
 
äameReù
(ècÚ¡ {  
	gm_äameReù
; }

63 
£tF¿meReù
(cÚ¡ 
IÁReù
& 
»ù
è{ 
	gm_äameReù
 =„ect; }

65 
IÁReù
 
bÜd”BoxReù
(ècÚ¡ {  IÁReù(0, 0, 
width
(), 
height
()); }

66 
vœtu®
 
IÁReù
 
bÜd”BoundšgBox
(ècÚ¡ {  
bÜd”BoxReù
(); }

69 
IÁReù
 
cÚ‹ÁBoxReù
(ècÚ¡ {  IÁReù(
bÜd”Leá
(è+ 
·ddšgLeá
(), 
bÜd”Tİ
(è+ 
·ddšgTİ
(), 
cÚ‹ÁWidth
(), 
cÚ‹ÁHeight
()); }

71 
IÁReù
 
absŞu‹CÚ‹ÁBox
() const;

73 
FlßtQuad
 
absŞu‹CÚ‹ÁQuad
() const;

76 
vœtu®
 
IÁReù
 
oušeBoundsFÜR•ašt
(
R’d”BoxMod–Objeù
* , 
IÁPošt
* 
ÿchedOff£tToR•aštCÚš”
) const;

77 
vœtu®
 
addFocusRšgReùs
(
VeùÜ
<
IÁReù
>&, 
tx
, 
ty
);

80 
R’d”Box
* 
´eviousSiblšgBox
() const;

81 
R’d”Box
* 
ÃxtSiblšgBox
() const;

82 
R’d”Box
* 
·»ÁBox
() const;

84 
IÁReù
 
visibËOv”æowReù
(ècÚ¡ {  
hasOv”æowCl
(è? 
visu®Ov”æowReù
(è: (
m_ov”æow
 ? m_ov”æow->visibËOv”æowReù(è: 
bÜd”BoxReù
()); }

85 
tİVisibËOv”æow
(ècÚ¡ {  
hasOv”æowCl
(è? 
tİVisu®Ov”æow
(è: 
¡d
::
mš
(
tİLayoutOv”æow
(),opVisualOverflow()); }

86 
bÙtomVisibËOv”æow
(ècÚ¡ {  
hasOv”æowCl
(è? 
bÙtomVisu®Ov”æow
(è: 
¡d
::
max
(
bÙtomLayoutOv”æow
(), bottomVisualOverflow()); }

87 
ËáVisibËOv”æow
(ècÚ¡ {  
hasOv”æowCl
(è? 
ËáVisu®Ov”æow
(è: 
¡d
::
mš
(
ËáLayoutOv”æow
(),†eftVisualOverflow()); }

88 
rightVisibËOv”æow
(ècÚ¡ {  
hasOv”æowCl
(è? 
rightVisu®Ov”æow
(è: 
¡d
::
max
(
rightLayoutOv”æow
(),„ightVisualOverflow()); }

90 
IÁReù
 
ÏyoutOv”æowReù
(ècÚ¡ {  
	gm_ov”æow
 ? m_ov”æow->ÏyoutOv”æowReù(è: 
bÜd”BoxReù
(); }

91 
tİLayoutOv”æow
(ècÚ¡ {  
	gm_ov”æow
? m_overflow->topLayoutOverflow() : 0; }

92 
bÙtomLayoutOv”æow
(ècÚ¡ {  
	gm_ov”æow
 ? m_ov”æow->bÙtomLayoutOv”æow(è: 
height
(); }

93 
ËáLayoutOv”æow
(ècÚ¡ {  
	gm_ov”æow
 ? m_overflow->leftLayoutOverflow() : 0; }

94 
rightLayoutOv”æow
(ècÚ¡ {  
	gm_ov”æow
 ? m_ov”æow->rightLayoutOv”æow(è: 
width
(); }

96 
IÁReù
 
visu®Ov”æowReù
(ècÚ¡ {  
	gm_ov”æow
 ? m_ov”æow->visu®Ov”æowReù(è: 
bÜd”BoxReù
(); }

97 
tİVisu®Ov”æow
(ècÚ¡ {  
	gm_ov”æow
? m_overflow->topVisualOverflow() : 0; }

98 
bÙtomVisu®Ov”æow
(ècÚ¡ {  
	gm_ov”æow
 ? m_ov”æow->bÙtomVisu®Ov”æow(è: 
height
(); }

99 
ËáVisu®Ov”æow
(ècÚ¡ {  
	gm_ov”æow
 ? m_overflow->leftVisualOverflow() : 0; }

100 
rightVisu®Ov”æow
(ècÚ¡ {  
	gm_ov”æow
 ? m_ov”æow->rightVisu®Ov”æow(è: 
width
(); }

102 
addLayoutOv”æow
(cÚ¡ 
IÁReù
&);

103 
addVisu®Ov”æow
(cÚ¡ 
IÁReù
&);

105 
addShadowOv”æow
();

106 
addOv”æowFromChd
(
R’d”Box
* 
chd
è{‡ddOv”æowFromChd(chd, 
IÁSize
(chd->
x
(), chd->
y
())); }

107 
addOv”æowFromChd
(
R’d”Box
* 
chd
, cÚ¡ 
IÁSize
& 
d–
);

108 
ş—rLayoutOv”æow
();

110 
cÚ‹ÁWidth
(ècÚ¡ {  
ş›ÁWidth
(è- 
·ddšgLeá
(è- 
·ddšgRight
(); }

111 
cÚ‹ÁHeight
(ècÚ¡ {  
ş›ÁHeight
(è- 
·ddšgTİ
(è- 
·ddšgBÙtom
(); }

115 
vœtu®
 
off£tWidth
(ècÚ¡ {  
width
(); }

116 
vœtu®
 
off£tHeight
(ècÚ¡ {  
height
(); }

120 
ş›ÁLeá
(ècÚ¡ {  
bÜd”Leá
(); }

121 
ş›ÁTİ
(ècÚ¡ {  
bÜd”Tİ
(); }

122 
ş›ÁWidth
() const;

123 
ş›ÁHeight
() const;

130 
vœtu®
 
süŞlLeá
() const;

131 
vœtu®
 
süŞlTİ
() const;

132 
vœtu®
 
süŞlWidth
() const;

133 
vœtu®
 
süŞlHeight
() const;

134 
vœtu®
 
£tSüŞlLeá
();

135 
vœtu®
 
£tSüŞlTİ
();

137 
vœtu®
 
m¬gšTİ
(ècÚ¡ {  
	gm_m¬gšTİ
; }

138 
vœtu®
 
m¬gšBÙtom
(ècÚ¡ {  
	gm_m¬gšBÙtom
; }

139 
vœtu®
 
m¬gšLeá
(ècÚ¡ {  
	gm_m¬gšLeá
; }

140 
vœtu®
 
m¬gšRight
(ècÚ¡ {  
	gm_m¬gšRight
; }

148 
vœtu®
 
boŞ
 
isS–fCŞÏpsšgBlock
(ècÚ¡ {  
	gçl£
; }

149 
cŞÏp£dM¬gšTİ
(ècÚ¡ {  
maxTİM¬gš
(
Œue
è- maxTİM¬gš(
çl£
); }

150 
cŞÏp£dM¬gšBÙtom
(ècÚ¡ {  
maxBÙtomM¬gš
(
Œue
è- maxBÙtomM¬gš(
çl£
); }

151 
vœtu®
 
maxTİM¬gš
(
boŞ
 
pos™ive
ècÚ¡ {  
	gpos™ive
 ? 
	g¡d
::
max
(0, 
m¬gšTİ
()è: -
¡d
::
mš
(0, marginTop()); }

152 
vœtu®
 
maxBÙtomM¬gš
(
boŞ
 
pos™ive
ècÚ¡ {  
	gpos™ive
 ? 
	g¡d
::
max
(0, 
m¬gšBÙtom
()è: -
¡d
::
mš
(0, marginBottom()); }

154 
vœtu®
 
absŞu‹Reùs
(
VeùÜ
<
IÁReù
>&, 
tx
, 
ty
);

155 
vœtu®
 
absŞu‹Quads
(
VeùÜ
<
FlßtQuad
>&);

157 
IÁReù
 
»æeùiÚBox
() const;

158 
»æeùiÚOff£t
() const;

160 
IÁReù
 
»æeùedReù
(const IntRect&) const;

162 
vœtu®
 
Ïyout
();

163 
vœtu®
 
·št
(
PaštInfo
&, 
tx
, 
ty
);

164 
vœtu®
 
boŞ
 
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, 
x
, 
y
, 
tx
, 
ty
, 
H™Te¡AùiÚ
);

166 
vœtu®
 
de¡roy
();

168 
vœtu®
 
mšP»fWidth
() const;

169 
vœtu®
 
maxP»fWidth
() const;

171 
ov”rideSize
() const;

172 
ov”rideWidth
() const;

173 
ov”rideHeight
() const;

174 
vœtu®
 
£tOv”rideSize
();

176 
vœtu®
 
IÁSize
 
off£tFromCÚš”
(
R’d”Objeù
*, cÚ¡ 
IÁPošt
&) const;

178 
ÿlcBÜd”BoxWidth
(
width
) const;

179 
ÿlcBÜd”BoxHeight
(
height
) const;

180 
ÿlcCÚ‹ÁBoxWidth
(
width
) const;

181 
ÿlcCÚ‹ÁBoxHeight
(
height
) const;

183 
vœtu®
 
bÜd”F™Adju¡
(& , & ) const { }

189 
ÿlcHÜizÚlM¬gšs
(cÚ¡ 
L’gth
& 
m¬gšLeá
, cÚ¡ L’gth& 
m¬gšRight
, 
cÚš”Width
);

191 
pos™iÚLšeBox
(
IÆšeBox
*);

193 
vœtu®
 
IÆšeBox
* 
ü—‹IÆšeBox
();

194 
dœtyLšeBoxes
(
boŞ
 
fuÎLayout
);

199 
IÆšeBox
* 
šlšeBoxW¿µ”
(ècÚ¡ {  
	gm_šlšeBoxW¿µ”
; }

200 
£tIÆšeBoxW¿µ”
(
IÆšeBox
* 
boxW¿µ”
è{ 
	gm_šlšeBoxW¿µ”
 = boxWrapper; }

201 
d–‘eLšeBoxW¿µ”
();

203 
vœtu®
 
lowe¡Pos™iÚ
(
boŞ
 
šşudeOv”æowIÁ”iÜ
 = 
Œue
, boŞ 
šşudeS–f
 =rue) const;

204 
vœtu®
 
rightmo¡Pos™iÚ
(
boŞ
 
šşudeOv”æowIÁ”iÜ
 = 
Œue
, boŞ 
šşudeS–f
 =rue) const;

205 
vœtu®
 
Ëámo¡Pos™iÚ
(
boŞ
 
šşudeOv”æowIÁ”iÜ
 = 
Œue
, boŞ 
šşudeS–f
 =rue) const;

207 
vœtu®
 
IÁReù
 
ş³dOv”æowReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
);

208 
vœtu®
 
compu‹ReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
IÁReù
&, 
boŞ
 
fixed
 = 
çl£
);

210 
vœtu®
 
»·štDuršgLayoutIfMoved
(cÚ¡ 
IÁReù
&);

212 
vœtu®
 
cÚššgBlockWidthFÜCÚ‹Á
() const;

214 
vœtu®
 
ÿlcWidth
();

215 
vœtu®
 
ÿlcHeight
();

217 
boŞ
 
¡»tchesToV›wHeight
() const

219  
¡yË
()->
htmlHacks
(è&& styË()->
height
().
isAuto
(è&& !
isFlßtšgOrPos™iÚed
(è&& (
isRoÙ
(è|| 
isBody
());

222 
vœtu®
 
IÁSize
 
šŒšsicSize
() const {  IntSize(); }

226 
boŞ
 
sizesToIÁršsicWidth
(
WidthTy³
) const;

227 
vœtu®
 
boŞ
 
¡»tchesToMšIÁršsicWidth
(ècÚ¡ {  
	gçl£
; }

229 
ÿlcWidthUsšg
(
WidthTy³
, 
cÚš”Width
);

230 
ÿlcHeightUsšg
(cÚ¡ 
L’gth
& 
height
);

231 
ÿlcR•ÏûdWidthUsšg
(
L’gth
 
width
) const;

232 
ÿlcR•ÏûdHeightUsšg
(
L’gth
 
height
) const;

234 
vœtu®
 
ÿlcR•ÏûdWidth
(
boŞ
 
šşudeMaxWidth
 = 
Œue
) const;

235 
vœtu®
 
ÿlcR•ÏûdHeight
() const;

237 
ÿlcP”ûÁageHeight
(cÚ¡ 
L’gth
& 
height
);

240 
vœtu®
 
avaabËWidth
(ècÚ¡ {  
cÚ‹ÁWidth
(); }

241 
vœtu®
 
avaabËHeight
() const;

242 
avaabËHeightUsšg
(cÚ¡ 
L’gth
&) const;

244 
ÿlcV”tiÿlM¬gšs
();

246 
vœtu®
 
v”tiÿlSüŞlb¬Width
() const;

247 
hÜizÚlSüŞlb¬Height
() const;

248 
vœtu®
 
boŞ
 
süŞl
(
SüŞlDœeùiÚ
, 
SüŞlG¿nuÏr™y
, 
muÉl›r
 = 1.0f, 
Node
** 
¡İNode
 = 0);

249 
boŞ
 
ÿnBeSüŞËdAndHasSüŞÏbËA»a
() const;

250 
vœtu®
 
boŞ
 
ÿnBeProg¿m©iÿÎySüŞËd
(bool) const;

251 
vœtu®
 
autosüŞl
();

252 
vœtu®
 
¡İAutosüŞl
() { }

253 
vœtu®
 
·nSüŞl
(cÚ¡ 
IÁPošt
&);

254 
boŞ
 
hasAutoV”tiÿlSüŞlb¬
(ècÚ¡ {  
hasOv”æowCl
(è&& (
¡yË
()->
ov”æowY
(è=ğ
OAUTO
 || styË()->ov”æowY(è=ğ
OOVERLAY
); }

255 
boŞ
 
hasAutoHÜizÚlSüŞlb¬
(ècÚ¡ {  
hasOv”æowCl
(è&& (
¡yË
()->
ov”æowX
(è=ğ
OAUTO
 || styË()->ov”æowX(è=ğ
OOVERLAY
); }

256 
boŞ
 
süŞlsOv”æow
(ècÚ¡ {  
süŞlsOv”æowX
(è|| 
süŞlsOv”æowY
(); }

257 
boŞ
 
süŞlsOv”æowX
(ècÚ¡ {  
hasOv”æowCl
(è&& (
¡yË
()->
ov”æowX
(è=ğ
OSCROLL
 || 
hasAutoHÜizÚlSüŞlb¬
()); }

258 
boŞ
 
süŞlsOv”æowY
(ècÚ¡ {  
hasOv”æowCl
(è&& (
¡yË
()->
ov”æowY
(è=ğ
OSCROLL
 || 
hasAutoV”tiÿlSüŞlb¬
()); }

260 
vœtu®
 
IÁReù
 
loÿlC¬‘Reù
(
IÆšeBox
*, 
ÿ»tOff£t
, * 
exŒaWidthToEndOfLše
 = 0);

262 
vœtu®
 
IÁReù
 
ov”æowClReù
(
tx
, 
ty
);

263 
IÁReù
 
şReù
(
tx
, 
ty
);

264 
vœtu®
 
boŞ
 
hasCÚŒŞCl
(ècÚ¡ {  
	gçl£
; }

265 
vœtu®
 
IÁReù
 
cÚŒŞClReù
(, ) const {  IntRect(); }

266 
boŞ
 
pushCÚ‹ÁsCl
(
PaštInfo
&, 
tx
, 
ty
);

267 
pİCÚ‹ÁsCl
(
PaštInfo
&, 
PaštPha£
 
Üigš®Pha£
, 
tx
, 
ty
);

269 
vœtu®
 
·štObjeù
(
PaštInfo
&, , è{ 
ASSERT_NOT_REACHED
(); }

270 
vœtu®
 
·štBoxDecÜ©iÚs
(
PaštInfo
&, 
tx
, 
ty
);

271 
vœtu®
 
·štMask
(
PaštInfo
&, 
tx
, 
ty
);

272 
vœtu®
 
imageChªged
(
W¿µedImagePŒ
, cÚ¡ 
IÁReù
* = 0);

276 
ŒyLayoutDošgPos™iÚedMovem’tOÆy
()

278 
	gŞdWidth
 = 
width
();

279 
ÿlcWidth
();

281 ià(
	gŞdWidth
 !ğ
width
())

283 
ÿlcHeight
();

284 
£tN“dsLayout
(
çl£
);

287 
IÁReù
 
maskClReù
();

289 
vœtu®
 
VisibËPos™iÚ
 
pos™iÚFÜPošt
(cÚ¡ 
IÁPošt
&);

291 
»moveFlßtšgOrPos™iÚedChdFromBlockLi¡s
();

293 
vœtu®
 
fœ¡LšeBoxBa£lše
() const {  -1; }

294 
vœtu®
 
Ï¡LšeBoxBa£lše
() const {  -1; }

296 
boŞ
 
shrškToAvoidFlßts
() const;

297 
vœtu®
 
boŞ
 
avoidsFlßts
() const;

299 #ià
ENABLE
(
SVG
)

300 
vœtu®
 
AffšeT¿nsfÜm
 
loÿlT¿nsfÜm
() const;

303 
	g´Ùeùed
:

304 
vœtu®
 
¡yËWlChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
* 
ÃwStyË
);

305 
vœtu®
 
¡yËDidChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
);

306 
vœtu®
 
upd©eBoxMod–InfoFromStyË
();

308 
·štFlLay”
(cÚ¡ 
PaštInfo
&, cÚ¡ 
CŞÜ
&, cÚ¡ 
FlLay”
*, 
tx
, 
ty
, 
width
, 
height
, 
Compos™eO³¿tÜ
 
İ
, 
R’d”Objeù
* 
backgroundObjeù
);

309 
·štFlLay”s
(cÚ¡ 
PaštInfo
&, cÚ¡ 
CŞÜ
&, cÚ¡ 
FlLay”
*, 
tx
, 
ty
, 
width
, 
height
, 
Compos™eO³¿tÜ
 = 
Compos™eSourûOv”
, 
R’d”Objeù
* 
backgroundObjeù
 = 0);

311 
·štMaskImages
(cÚ¡ 
PaštInfo
&, 
tx
, 
ty
, 
width
, 
height
);

313 #ià
PLATFORM
(
MAC
)

314 
·štCu¡omHighlight
(
tx
, 
ty
, cÚ¡ 
AtomicSŒšg
& 
ty³
, 
boŞ
 
behšdText
);

317 
ÿlcAbsŞu‹HÜizÚl
();

319 
vœtu®
 
boŞ
 
shouldC®cuÏ‹SizeAsR•Ïûd
(ècÚ¡ {  
isR•Ïûd
(è&& !
isIÆšeBlockOrIÆšeTabË
(); }

321 
vœtu®
 
m­LoÿlToCÚš”
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
boŞ
 
fixed
, boŞ 
u£T¿nsfÜms
, 
T¿nsfÜmS‹
&) const;

322 
vœtu®
 
m­AbsŞu‹ToLoÿlPošt
(
boŞ
 
fixed
, boŞ 
u£T¿nsfÜms
, 
T¿nsfÜmS‹
&) const;

324 
	g´iv©e
:

325 
boŞ
 
šşudeV”tiÿlSüŞlb¬Size
(ècÚ¡ {  
hasOv”æowCl
(è&& (
¡yË
()->
ov”æowY
(è=ğ
OSCROLL
 || styË()->ov”æowY(è=ğ
OAUTO
); }

326 
boŞ
 
šşudeHÜizÚlSüŞlb¬Size
(ècÚ¡ {  
hasOv”æowCl
(è&& (
¡yË
()->
ov”æowX
(è=ğ
OSCROLL
 || styË()->ov”æowX(è=ğ
OAUTO
); }

328 
·štRoÙBoxDecÜ©iÚs
(
PaštInfo
&, 
tx
, 
ty
);

330 
boŞ
 
»·štLay”ReùsFÜImage
(
W¿µedImagePŒ
 
image
, cÚ¡ 
FlLay”
* 
Ïy”s
, boŞ 
d¿wšgBackground
);

332 
cÚššgBlockWidthFÜPos™iÚed
(cÚ¡ 
R’d”BoxMod–Objeù
* 
cÚššgBlock
) const;

333 
cÚššgBlockHeightFÜPos™iÚed
(cÚ¡ 
R’d”BoxMod–Objeù
* 
cÚššgBlock
) const;

335 
ÿlcAbsŞu‹V”tiÿl
();

336 
ÿlcAbsŞu‹HÜizÚlV®ues
(
L’gth
 
width
, cÚ¡ 
R’d”BoxMod–Objeù
* 
cb
, 
TextDœeùiÚ
 
cÚš”DœeùiÚ
,

337 
cÚš”Width
, 
bÜd”sPlusPaddšg
,

338 
L’gth
 
Ëá
, L’gth 
right
, L’gth 
m¬gšLeá
, L’gth 
m¬gšRight
,

339 & 
widthV®ue
, & 
m¬gšLeáV®ue
, & 
m¬gšRightV®ue
, & 
xPos
);

340 
ÿlcAbsŞu‹V”tiÿlV®ues
(
L’gth
 
height
, cÚ¡ 
R’d”BoxMod–Objeù
* 
cb
,

341 
cÚš”Height
, 
bÜd”sPlusPaddšg
,

342 
L’gth
 
tİ
, L’gth 
bÙtom
, L’gth 
m¬gšTİ
, L’gth 
m¬gšBÙtom
,

343 & 
heightV®ue
, & 
m¬gšTİV®ue
, & 
m¬gšBÙtomV®ue
, & 
yPos
);

345 
ÿlcAbsŞu‹V”tiÿlR•Ïûd
();

346 
ÿlcAbsŞu‹HÜizÚlR•Ïûd
();

351 
vœtu®
 
ÿlcP»fWidths
(è{ 
£tP»fWidthsDœty
(
çl£
); }

353 
	g´iv©e
:

355 
IÁReù
 
m_äameReù
;

357 
	g´Ùeùed
:

358 
m_m¬gšLeá
;

359 
	gm_m¬gšRight
;

360 
	gm_m¬gšTİ
;

361 
	gm_m¬gšBÙtom
;

364 
	gm_mšP»fWidth
;

367 
	gm_maxP»fWidth
;

370 
IÆšeBox
* 
	gm_šlšeBoxW¿µ”
;

373 
	gOwnPŒ
<
	gR’d”Ov”æow
> 
	gm_ov”æow
;

375 
	g´iv©e
:

377 
boŞ
 
s_hadOv”æowCl
;

380 
šlše
 
R’d”Box
* 
	$toR’d”Box
(
R’d”Objeù
* 
objeù
)

382 
	`ASSERT
(!
objeù
 || objeù->
	`isBox
());

383  
¡©ic_ÿ¡
<
R’d”Box
*>(
objeù
);

384 
	}
}

386 
šlše
 cÚ¡ 
R’d”Box
* 
	$toR’d”Box
(cÚ¡ 
R’d”Objeù
* 
objeù
)

388 
	`ASSERT
(!
objeù
 || objeù->
	`isBox
());

389  
¡©ic_ÿ¡
<cÚ¡ 
R’d”Box
*>(
objeù
);

390 
	}
}

393 
toR’d”Box
(cÚ¡ 
R’d”Box
*);

395 
šlše
 
R’d”Box
* 
	gR’d”Box
::
	$´eviousSiblšgBox
() const

397  
	`toR’d”Box
(
	`´eviousSiblšg
());

398 
	}
}

400 
šlše
 
R’d”Box
* 
	gR’d”Box
::
	$ÃxtSiblšgBox
() const

402  
	`toR’d”Box
(
	`ÃxtSiblšg
());

403 
	}
}

405 
šlše
 
R’d”Box
* 
	gR’d”Box
::
	$·»ÁBox
() const

407  
	`toR’d”Box
(
	`·»Á
());

408 
	}
}

410 
šlše
 
R’d”Box
* 
	gR’d”Box
::
	$fœ¡ChdBox
() const

412  
	`toR’d”Box
(
	`fœ¡Chd
());

413 
	}
}

415 
šlše
 
R’d”Box
* 
	gR’d”Box
::
	$Ï¡ChdBox
() const

417  
	`toR’d”Box
(
	`Ï¡Chd
());

418 
	}
}

	@RenderBoxModelObject.cpp

25 
	~"cÚfig.h
"

26 
	~"R’d”BoxMod–Objeù.h
"

28 
	~"G¿phicsCÚ‹xt.h
"

29 
	~"HTMLEËm’t.h
"

30 
	~"HTMLNames.h
"

31 
	~"ImageBufãr.h
"

32 
	~"R’d”Block.h
"

33 
	~"R’d”IÆše.h
"

34 
	~"R’d”Lay”.h
"

35 
	~"R’d”V›w.h
"

36 
	~<wtf/Cu¼’tTime.h
>

38 
usšg
 
Çme¥aû
 
	g¡d
;

40 
Çme¥aû
 
	gWebCÜe
 {

42 
usšg
 
Çme¥aû
 
	gHTMLNames
;

44 
boŞ
 
	gR’d”BoxMod–Objeù
::
s_wasFlßtšg
 = 
çl£
;

45 
boŞ
 
	gR’d”BoxMod–Objeù
::
s_hadLay”
 = 
çl£
;

46 
boŞ
 
	gR’d”BoxMod–Objeù
::
s_Ïy”WasS–fPaštšg
 = 
çl£
;

48 cÚ¡ 
	gcIÁ”pŞ©iÚCutoff
 = 800. * 800.;

49 cÚ¡ 
	gcLowQu®™yTimeTh»shŞd
 = 0.500;

51 şas 
	cR’d”BoxMod–SÿËD©a
 : 
public
 
NÚcİyabË
 {

52 
public
:

53 
R’d”BoxMod–SÿËD©a
(
R’d”BoxMod–Objeù
* 
objeù
, cÚ¡ 
IÁSize
& 
size
, cÚ¡ 
AffšeT¿nsfÜm
& 
ŒªsfÜm
, 
time
, 
boŞ
 
lowQu®™ySÿË
)

54 : 
m_size
(
size
)

55 , 
m_ŒªsfÜm
(
ŒªsfÜm
)

56 , 
m_Ï¡PaštTime
(
time
)

57 , 
m_lowQu®™ySÿË
(
lowQu®™ySÿË
)

58 , 
m_highQu®™yR•aštTim”
(
objeù
, &
R’d”BoxMod–Objeù
::
highQu®™yR•aštTim”Fœed
)

62 ~
R’d”BoxMod–SÿËD©a
()

64 
m_highQu®™yR•aštTim”
.
¡İ
();

67 
	gTim”
<
	gR’d”BoxMod–Objeù
>& 
hiqhQu®™yR•aštTim”
(è{  
	gm_highQu®™yR•aštTim”
; }

69 cÚ¡ 
	gIÁSize
& 
size
(ècÚ¡ {  
	gm_size
; }

70 
£tSize
(cÚ¡ 
IÁSize
& 
s
è{ 
	gm_size
 = s; }

71 
Ï¡PaštTime
(ècÚ¡ {  
	gm_Ï¡PaštTime
; }

72 
£tLa¡PaštTime
(
t
è{ 
	gm_Ï¡PaštTime
 =; }

73 
boŞ
 
u£LowQu®™ySÿË
(ècÚ¡ {  
	gm_lowQu®™ySÿË
; }

74 cÚ¡ 
	gAffšeT¿nsfÜm
& 
ŒªsfÜm
(ècÚ¡ {  
	gm_ŒªsfÜm
; }

75 
£tT¿nsfÜm
(cÚ¡ 
AffšeT¿nsfÜm
& 
ŒªsfÜm
è{ 
	gm_ŒªsfÜm
 =ransform; }

76 
£tU£LowQu®™ySÿË
(
boŞ
 
b
)

78 
	gm_highQu®™yR•aštTim”
.
¡İ
();

79 
	gm_lowQu®™ySÿË
 = 
b
;

80 ià(
	gb
)

81 
	gm_highQu®™yR•aštTim”
.
¡¬tOÃShÙ
(
cLowQu®™yTimeTh»shŞd
);

84 
	g´iv©e
:

85 
IÁSize
 
m_size
;

86 
AffšeT¿nsfÜm
 
	gm_ŒªsfÜm
;

87 
	gm_Ï¡PaštTime
;

88 
boŞ
 
	gm_lowQu®™ySÿË
;

89 
	gTim”
<
	gR’d”BoxMod–Objeù
> 
	gm_highQu®™yR•aštTim”
;

92 şas 
	cR’d”BoxMod–SÿËOb£rv”
 {

93 
	gpublic
:

94 
boŞ
 
shouldPaštBackgroundAtLowQu®™y
(
G¿phicsCÚ‹xt
*, 
R’d”BoxMod–Objeù
*, 
Image
*, cÚ¡ 
IÁSize
&);

96 
boxMod–ObjeùDe¡royed
(
R’d”BoxMod–Objeù
* 
objeù
)

98 ià(
	ggBoxMod–Objeùs
) {

99 
R’d”BoxMod–SÿËD©a
* 
	gd©a
 = 
gBoxMod–Objeùs
->
ke
(
objeù
);

100 
d–‘e
 
	gd©a
;

101 ià(!
	ggBoxMod–Objeùs
->
size
()) {

102 
d–‘e
 
	ggBoxMod–Objeùs
;

103 
	ggBoxMod–Objeùs
 = 0;

108 
highQu®™yR•aštTim”Fœed
(
R’d”BoxMod–Objeù
* 
objeù
)

110 
	gR’d”BoxMod–SÿËOb£rv”
::
boxMod–ObjeùDe¡royed
(
objeù
);

111 
	gobjeù
->
»·št
();

114 
	gHashM­
<
	gR’d”BoxMod–Objeù
*, 
	gR’d”BoxMod–SÿËD©a
*>* 
	ggBoxMod–Objeùs
;

117 
boŞ
 
	gR’d”BoxMod–SÿËOb£rv”
::
	$shouldPaštBackgroundAtLowQu®™y
(
G¿phicsCÚ‹xt
* 
cÚ‹xt
, 
R’d”BoxMod–Objeù
* 
objeù
, 
Image
* 
image
, cÚ¡ 
IÁSize
& 
size
)

121 ià(!
image
 || !image->
	`isB™m­Image
())

122  
çl£
;

126 
IÁSize
 
	`imageSize
(
image
->
	`width
(), image->
	`height
());

129 
R’d”BoxMod–SÿËD©a
* 
d©a
 = 0;

130 ià(
gBoxMod–Objeùs
)

131 
d©a
 = 
gBoxMod–Objeùs
->
	`g‘
(
objeù
);

133 cÚ¡ 
AffšeT¿nsfÜm
& 
cu¼’tT¿nsfÜm
 = 
cÚ‹xt
->
	`g‘CTM
();

134 
boŞ
 
cÚ‹xtIsSÿËd
 = !
cu¼’tT¿nsfÜm
.
	`isId’t™yOrT¿n¦©iÚOrFl³d
();

135 ià(!
cÚ‹xtIsSÿËd
 && 
imageSize
 =ğ
size
) {

137 ià(
d©a
) {

138 
gBoxMod–Objeùs
->
	`»move
(
objeù
);

139 
d–‘e
 
d©a
;

141  
çl£
;

145 ià(
objeù
->
	`docum’t
()->
	`·ge
()->
	`šLowQu®™yImageIÁ”pŞ©iÚMode
()) {

146 
tÙ®Pix–s
 = 
¡©ic_ÿ¡
<>(
image
->
	`width
()è* stic_ÿ¡<>(image->
	`height
());

147 ià(
tÙ®Pix–s
 > 
cIÁ”pŞ©iÚCutoff
)

148  
Œue
;

153 ià(!
d©a
) {

154 
d©a
 = 
Ãw
 
	`R’d”BoxMod–SÿËD©a
(
objeù
, 
size
, 
cu¼’tT¿nsfÜm
, 
	`cu¼’tTime
(), 
çl£
);

155 ià(!
gBoxMod–Objeùs
)

156 
gBoxMod–Objeùs
 = 
Ãw
 
HashM­
<
R’d”BoxMod–Objeù
*, 
R’d”BoxMod–SÿËD©a
*>;

157 
gBoxMod–Objeùs
->
	`£t
(
objeù
, 
d©a
);

158  
çl£
;

161 cÚ¡ 
AffšeT¿nsfÜm
& 
Œ
 = 
d©a
->
	`ŒªsfÜm
();

162 
boŞ
 
sÿËUnchªged
 = 
Œ
.
	`a
(è=ğ
cu¼’tT¿nsfÜm
.a(è&&r.
	`b
(è=ğcu¼’tT¿nsfÜm.b(è&&r.
	`c
(è=ğcu¼’tT¿nsfÜm.c(è&&r.
	`d
() == currentTransform.d();

164 ià((!
cÚ‹xtIsSÿËd
 || 
sÿËUnchªged
è&& 
d©a
->
	`size
(è=ğ
size
)

165  
d©a
->
	`u£LowQu®™ySÿË
();

169 
ÃwTime
 = 
	`cu¼’tTime
();

170 
d©a
->
	`£tU£LowQu®™ySÿË
(
ÃwTime
 - d©a->
	`Ï¡PaštTime
(è< 
cLowQu®™yTimeTh»shŞd
);

171 
d©a
->
	`£tLa¡PaštTime
(
ÃwTime
);

172 
d©a
->
	`£tT¿nsfÜm
(
cu¼’tT¿nsfÜm
);

173 
d©a
->
	`£tSize
(
size
);

174  
d©a
->
	`u£LowQu®™ySÿË
();

175 
	}
}

177 
	gHashM­
<
	gR’d”BoxMod–Objeù
*, 
	gR’d”BoxMod–SÿËD©a
*>* 
	gR’d”BoxMod–SÿËOb£rv”
::
gBoxMod–Objeùs
 = 0;

179 
	gR’d”BoxMod–Objeù
::
highQu®™yR•aštTim”Fœed
(
Tim”
<
R’d”BoxMod–Objeù
>*)

181 
R’d”BoxMod–SÿËOb£rv”
::
highQu®™yR•aštTim”Fœed
(
this
);

184 
	gR’d”BoxMod–Objeù
::
	$R’d”BoxMod–Objeù
(
Node
* 
node
)

185 : 
	`R’d”Objeù
(
node
)

186 , 
	$m_Ïy”
(0)

188 
	}
}

190 
	gR’d”BoxMod–Objeù
::~
	$R’d”BoxMod–Objeù
()

193 
	`ASSERT
(!
	`hasLay”
());

194 
	`ASSERT
(!
m_Ïy”
);

195 
R’d”BoxMod–SÿËOb£rv”
::
	`boxMod–ObjeùDe¡royed
(
this
);

196 
	}
}

198 
	gR’d”BoxMod–Objeù
::
	$de¡royLay”
()

200 
	`ASSERT
(!
	`hasLay”
());

201 
	`ASSERT
(
m_Ïy”
);

202 
m_Ïy”
->
	`de¡roy
(
	`»nd”A»Ç
());

203 
m_Ïy”
 = 0;

204 
	}
}

206 
	gR’d”BoxMod–Objeù
::
	$de¡roy
()

209 ià(
m_Ïy”
)

210 
m_Ïy”
->
	`ş—rClReùs
();

213 
R’d”Objeù
::
	`de¡roy
();

214 
	}
}

216 
boŞ
 
	gR’d”BoxMod–Objeù
::
	$hasS–fPaštšgLay”
() const

218  
m_Ïy”
 && m_Ïy”->
	`isS–fPaštšgLay”
();

219 
	}
}

221 
	gR’d”BoxMod–Objeù
::
	$¡yËWlChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ÃwStyË
)

223 
s_wasFlßtšg
 = 
	`isFlßtšg
();

224 
s_hadLay”
 = 
	`hasLay”
();

225 ià(
s_hadLay”
)

226 
s_Ïy”WasS–fPaštšg
 = 
	`Ïy”
()->
	`isS–fPaštšgLay”
();

230 ià(
	`¡yË
(è&& 
ÃwStyË
) {

231 ià(
	`·»Á
()) {

234 ià(
diff
 =ğ
StyËDifã»nûR•aštLay”
) {

235 
	`Ïy”
()->
	`»·štInşudšgDesûndªts
();

236 ià(!(
	`¡yË
()->
	`ş
(è=ğ
ÃwStyË
->clip()))

237 
	`Ïy”
()->
	`ş—rClReùsInşudšgDesûndªts
();

238 } ià(
diff
 =ğ
StyËDifã»nûR•ašt
 || 
ÃwStyË
->
	`oušeSize
(è< 
	`¡yË
()->outlineSize())

239 
	`»·št
();

242 ià(
diff
 =ğ
StyËDifã»nûLayout
) {

245 ià(
	`hasLay”
()) {

246 ià(
	`¡yË
()->
	`pos™iÚ
(è!ğ
ÃwStyË
->position() ||

247 
	`¡yË
()->
	`zIndex
(è!ğ
ÃwStyË
->zIndex() ||

248 
	`¡yË
()->
	`hasAutoZIndex
(è!ğ
ÃwStyË
->hasAutoZIndex() ||

249 !(
	`¡yË
()->
	`ş
(è=ğ
ÃwStyË
->clip()) ||

250 
	`¡yË
()->
	`hasCl
(è!ğ
ÃwStyË
->hasClip() ||

251 
	`¡yË
()->
	`İac™y
(è!ğ
ÃwStyË
->opacity() ||

252 
	`¡yË
()->
	`ŒªsfÜm
(è!ğ
ÃwStyË
->transform())

253 
	`Ïy”
()->
	`»·štInşudšgDesûndªts
();

254 } ià(
ÃwStyË
->
	`hasT¿nsfÜm
(è||‚ewStyË->
	`İac™y
() < 1) {

257 
	`»·št
();

261 ià(
	`hasLay”
(è&& (
	`¡yË
()->
	`hasAutoZIndex
(è!ğ
ÃwStyË
->hasAutoZIndex() ||

262 
	`¡yË
()->
	`zIndex
(è!ğ
ÃwStyË
->zIndex() ||

263 
	`¡yË
()->
	`visib™y
(è!ğ
ÃwStyË
->visibility())) {

264 
	`Ïy”
()->
	`dœtySckšgCÚ‹xtZOrd”Li¡s
();

265 ià(
	`¡yË
()->
	`hasAutoZIndex
(è!ğ
ÃwStyË
->hasAutoZIndex(è|| styË()->
	`visib™y
() !=‚ewStyle->visibility())

266 
	`Ïy”
()->
	`dœtyZOrd”Li¡s
();

270 
R’d”Objeù
::
	`¡yËWlChªge
(
diff
, 
ÃwStyË
);

271 
	}
}

273 
	gR’d”BoxMod–Objeù
::
	$¡yËDidChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
)

275 
R’d”Objeù
::
	`¡yËDidChªge
(
diff
, 
ŞdStyË
);

276 
	`upd©eBoxMod–InfoFromStyË
();

278 ià(
	`»quœesLay”
()) {

279 ià(!
	`Ïy”
()) {

280 ià(
s_wasFlßtšg
 && 
	`isFlßtšg
())

281 
	`£tChdN“dsLayout
(
Œue
);

282 
m_Ïy”
 = 
	`Ãw
 (
	`»nd”A»Ç
()è
	`R’d”Lay”
(
this
);

283 
	`£tHasLay”
(
Œue
);

284 
m_Ïy”
->
	`š£¹OÆyThisLay”
();

285 ià(
	`·»Á
(è&& !
	`ÃedsLayout
(è&& 
	`cÚššgBlock
())

286 
m_Ïy”
->
	`upd©eLay”Pos™iÚs
();

288 } ià(
	`Ïy”
(è&&†ay”()->
	`·»Á
()) {

289 
	`£tHasT¿nsfÜm
(
çl£
);

290 
	`£tHasReæeùiÚ
(
çl£
);

291 
m_Ïy”
->
	`»moveOÆyThisLay”
();

292 ià(
s_wasFlßtšg
 && 
	`isFlßtšg
())

293 
	`£tChdN“dsLayout
(
Œue
);

296 ià(
	`Ïy”
()) {

297 
	`Ïy”
()->
	`¡yËChªged
(
diff
, 
ŞdStyË
);

298 ià(
s_hadLay”
 && 
	`Ïy”
()->
	`isS–fPaštšgLay”
(è!ğ
s_Ïy”WasS–fPaštšg
)

299 
	`£tChdN“dsLayout
(
Œue
);

301 
	}
}

303 
	gR’d”BoxMod–Objeù
::
	$upd©eBoxMod–InfoFromStyË
()

307 
	`£tHasBoxDecÜ©iÚs
(
	`¡yË
()->
	`hasBÜd”
(è|| styË()->
	`hasBackground
(è|| styË()->
	`hasAµ—¿nû
(è|| styË()->
	`boxShadow
());

308 
	`£tIÆše
(
	`¡yË
()->
	`isDi¥ÏyIÆšeTy³
());

309 
	`£tR–Pos™iÚed
(
	`¡yË
()->
	`pos™iÚ
(è=ğ
R–©ivePos™iÚ
);

310 
	}
}

312 
	gR’d”BoxMod–Objeù
::
	$»ÏtivePos™iÚOff£tX
() const

318 ià(!
	`¡yË
()->
	`Ëá
().
	`isAuto
()) {

319 
R’d”Block
* 
cb
 = 
	`cÚššgBlock
();

320 ià(!
	`¡yË
()->
	`right
().
	`isAuto
(è&& 
	`cÚššgBlock
()->¡yË()->
	`dœeùiÚ
(è=ğ
RTL
)

321  -
	`¡yË
()->
	`right
().
	`ÿlcV®ue
(
cb
->
	`avaabËWidth
());

322  
	`¡yË
()->
	`Ëá
().
	`ÿlcV®ue
(
cb
->
	`avaabËWidth
());

324 ià(!
	`¡yË
()->
	`right
().
	`isAuto
()) {

325 
R’d”Block
* 
cb
 = 
	`cÚššgBlock
();

326  -
	`¡yË
()->
	`right
().
	`ÿlcV®ue
(
cb
->
	`avaabËWidth
());

329 
	}
}

331 
	gR’d”BoxMod–Objeù
::
	$»ÏtivePos™iÚOff£tY
() const

333 ià(!
	`¡yË
()->
	`tİ
().
	`isAuto
())

334  
	`¡yË
()->
	`tİ
().
	`ÿlcV®ue
(
	`cÚššgBlock
()->
	`avaabËHeight
());

335 ià(!
	`¡yË
()->
	`bÙtom
().
	`isAuto
())

336  -
	`¡yË
()->
	`bÙtom
().
	`ÿlcV®ue
(
	`cÚššgBlock
()->
	`avaabËHeight
());

339 
	}
}

341 
	gR’d”BoxMod–Objeù
::
	$off£tLeá
() const

345 ià(
	`isBody
())

348 
R’d”BoxMod–Objeù
* 
off£tP¬
 = 
	`off£tP¬’t
();

349 
xPos
 = (
	`isBox
(è? 
	`toR’d”Box
(
this
)->
	`x
() : 0);

354 ià(
off£tP¬
) {

355 ià(
off£tP¬
->
	`isBox
(è&& !off£tP¬->
	`isBody
())

356 
xPos
 -ğ
	`toR’d”Box
(
off£tP¬
)->
	`bÜd”Leá
();

357 ià(!
	`isPos™iÚed
()) {

358 ià(
	`isR–Pos™iÚed
())

359 
xPos
 +ğ
	`»ÏtivePos™iÚOff£tX
();

360 
R’d”Objeù
* 
cu¼
 = 
	`·»Á
();

361 
cu¼
 && cu¼ !ğ
off£tP¬
) {

363 ià(
cu¼
->
	`isBox
(è&& !cu¼->
	`isTabËRow
())

364 
xPos
 +ğ
	`toR’d”Box
(
cu¼
)->
	`x
();

365 
cu¼
 = cu¼->
	`·»Á
();

367 ià(
off£tP¬
->
	`isBox
(è&& off£tP¬->
	`isBody
(è&& !off£tP¬->
	`isR–Pos™iÚed
(è&& !off£tP¬->
	`isPos™iÚed
())

368 
xPos
 +ğ
	`toR’d”Box
(
off£tP¬
)->
	`x
();

372  
xPos
;

373 
	}
}

375 
	gR’d”BoxMod–Objeù
::
	$off£tTİ
() const

379 ià(
	`isBody
())

382 
R’d”BoxMod–Objeù
* 
off£tP¬
 = 
	`off£tP¬’t
();

383 
yPos
 = (
	`isBox
(è? 
	`toR’d”Box
(
this
)->
	`y
() : 0);

388 ià(
off£tP¬
) {

389 ià(
off£tP¬
->
	`isBox
(è&& !off£tP¬->
	`isBody
())

390 
yPos
 -ğ
	`toR’d”Box
(
off£tP¬
)->
	`bÜd”Tİ
();

391 ià(!
	`isPos™iÚed
()) {

392 ià(
	`isR–Pos™iÚed
())

393 
yPos
 +ğ
	`»ÏtivePos™iÚOff£tY
();

394 
R’d”Objeù
* 
cu¼
 = 
	`·»Á
();

395 
cu¼
 && cu¼ !ğ
off£tP¬
) {

397 ià(
cu¼
->
	`isBox
(è&& !cu¼->
	`isTabËRow
())

398 
yPos
 +ğ
	`toR’d”Box
(
cu¼
)->
	`y
();

399 
cu¼
 = cu¼->
	`·»Á
();

401 ià(
off£tP¬
->
	`isBox
(è&& off£tP¬->
	`isBody
(è&& !off£tP¬->
	`isR–Pos™iÚed
(è&& !off£tP¬->
	`isPos™iÚed
())

402 
yPos
 +ğ
	`toR’d”Box
(
off£tP¬
)->
	`y
();

405  
yPos
;

406 
	}
}

408 
	gR’d”BoxMod–Objeù
::
	$·ddšgTİ
(
boŞ
) const

410 
w
 = 0;

411 
L’gth
 
·ddšg
 = 
	`¡yË
()->
	`·ddšgTİ
();

412 ià(
·ddšg
.
	`isP”ûÁ
())

413 
w
 = 
	`cÚššgBlock
()->
	`avaabËWidth
();

414  
·ddšg
.
	`ÿlcMšV®ue
(
w
);

415 
	}
}

417 
	gR’d”BoxMod–Objeù
::
	$·ddšgBÙtom
(
boŞ
) const

419 
w
 = 0;

420 
L’gth
 
·ddšg
 = 
	`¡yË
()->
	`·ddšgBÙtom
();

421 ià(
·ddšg
.
	`isP”ûÁ
())

422 
w
 = 
	`cÚššgBlock
()->
	`avaabËWidth
();

423  
·ddšg
.
	`ÿlcMšV®ue
(
w
);

424 
	}
}

426 
	gR’d”BoxMod–Objeù
::
	$·ddšgLeá
(
boŞ
) const

428 
w
 = 0;

429 
L’gth
 
·ddšg
 = 
	`¡yË
()->
	`·ddšgLeá
();

430 ià(
·ddšg
.
	`isP”ûÁ
())

431 
w
 = 
	`cÚššgBlock
()->
	`avaabËWidth
();

432  
·ddšg
.
	`ÿlcMšV®ue
(
w
);

433 
	}
}

435 
	gR’d”BoxMod–Objeù
::
	$·ddšgRight
(
boŞ
) const

437 
w
 = 0;

438 
L’gth
 
·ddšg
 = 
	`¡yË
()->
	`·ddšgRight
();

439 ià(
·ddšg
.
	`isP”ûÁ
())

440 
w
 = 
	`cÚššgBlock
()->
	`avaabËWidth
();

441  
·ddšg
.
	`ÿlcMšV®ue
(
w
);

442 
	}
}

445 
	gR’d”BoxMod–Objeù
::
	$·štFlLay”Ex‹nded
(cÚ¡ 
PaštInfo
& 
·štInfo
, cÚ¡ 
CŞÜ
& 
c
, cÚ¡ 
FlLay”
* 
bgLay”
, 
tx
, 
ty
, 
w
, 
h
, 
IÆšeFlowBox
* 
box
, 
Compos™eO³¿tÜ
 
İ
, 
R’d”Objeù
* 
backgroundObjeù
)

447 
G¿phicsCÚ‹xt
* 
cÚ‹xt
 = 
·štInfo
.context;

448 ià(
cÚ‹xt
->
	`·štšgDi§bËd
())

451 
boŞ
 
šşudeLeáEdge
 = 
box
 ? box->
	`šşudeLeáEdge
(è: 
Œue
;

452 
boŞ
 
šşudeRightEdge
 = 
box
 ? box->
	`šşudeRightEdge
(è: 
Œue
;

453 
bLeá
 = 
šşudeLeáEdge
 ? 
	`bÜd”Leá
() : 0;

454 
bRight
 = 
šşudeRightEdge
 ? 
	`bÜd”Right
() : 0;

455 
pLeá
 = 
šşudeLeáEdge
 ? 
	`·ddšgLeá
() : 0;

456 
pRight
 = 
šşudeRightEdge
 ? 
	`·ddšgRight
() : 0;

458 
boŞ
 
ş³dToBÜd”Radius
 = 
çl£
;

459 ià(
	`¡yË
()->
	`hasBÜd”Radius
(è&& (
šşudeLeáEdge
 || 
šşudeRightEdge
)) {

460 
IÁReù
 
	`bÜd”Reù
(
tx
, 
ty
, 
w
, 
h
);

462 ià(
bÜd”Reù
.
	`isEm±y
())

465 
cÚ‹xt
->
	`§ve
();

467 
IÁSize
 
tİLeá
, 
tİRight
, 
bÙtomLeá
, 
bÙtomRight
;

468 
	`¡yË
()->
	`g‘BÜd”RadiiFÜReù
(
bÜd”Reù
, 
tİLeá
, 
tİRight
, 
bÙtomLeá
, 
bÙtomRight
);

470 
cÚ‹xt
->
	`addRoundedReùCl
(
bÜd”Reù
, 
šşudeLeáEdge
 ? 
tİLeá
 : 
	`IÁSize
(),

471 
šşudeRightEdge
 ? 
tİRight
 : 
	`IÁSize
(),

472 
šşudeLeáEdge
 ? 
bÙtomLeá
 : 
	`IÁSize
(),

473 
šşudeRightEdge
 ? 
bÙtomRight
 : 
	`IÁSize
());

474 
ş³dToBÜd”Radius
 = 
Œue
;

477 
boŞ
 
ş³dW™hLoÿlSüŞlšg
 = 
	`hasOv”æowCl
(è&& 
bgLay”
->
	`©chm’t
(è=ğ
LoÿlBackgroundA‰achm’t
;

478 ià(
ş³dW™hLoÿlSüŞlšg
) {

480 
cÚ‹xt
->
	`§ve
();

481 
cÚ‹xt
->
	`ş
(
	`toR’d”Box
(
this
)->
	`ov”æowClReù
(
tx
, 
ty
));

484 
IÁSize
 
off£t
 = 
	`Ïy”
()->
	`süŞËdCÚ‹ÁOff£t
();

485 
tx
 -ğ
off£t
.
	`width
();

486 
ty
 -ğ
off£t
.
	`height
();

487 
w
 = 
bLeá
 + 
	`Ïy”
()->
	`süŞlWidth
(è+ 
bRight
;

488 
h
 = 
	`bÜd”Tİ
(è+ 
	`Ïy”
()->
	`süŞlHeight
(è+ 
	`bÜd”BÙtom
();

491 ià(
bgLay”
->
	`ş
(è=ğ
PaddšgFlBox
 || bgLay”->ş(è=ğ
CÚ‹ÁFlBox
) {

493 
boŞ
 
šşudePaddšg
 = 
bgLay”
->
	`ş
(è=ğ
CÚ‹ÁFlBox
;

494 
x
 = 
tx
 + 
bLeá
 + (
šşudePaddšg
 ? 
pLeá
 : 0);

495 
y
 = 
ty
 + 
	`bÜd”Tİ
(è+ (
šşudePaddšg
 ? 
	`·ddšgTİ
() : 0);

496 
width
 = 
w
 - 
bLeá
 - 
bRight
 - (
šşudePaddšg
 ? 
pLeá
 + 
pRight
 : 0);

497 
height
 = 
h
 - 
	`bÜd”Tİ
(è- 
	`bÜd”BÙtom
(è- (
šşudePaddšg
 ? 
	`·ddšgTİ
(è+ 
	`·ddšgBÙtom
() : 0);

498 
cÚ‹xt
->
	`§ve
();

499 
cÚ‹xt
->
	`ş
(
	`IÁReù
(
x
, 
y
, 
width
, 
height
));

500 } ià(
bgLay”
->
	`ş
(è=ğ
TextFlBox
) {

504 
IÁReù
 
	`maskReù
(
tx
, 
ty
, 
w
, 
h
);

505 
maskReù
.
	`š‹r£ù
(
·štInfo
.
»ù
);

508 
OwnPŒ
<
ImageBufãr
> 
maskImage
 = ImageBufãr::
	`ü—‹
(
maskReù
.
	`size
());

509 ià(!
maskImage
)

512 
G¿phicsCÚ‹xt
* 
maskImageCÚ‹xt
 = 
maskImage
->
	`cÚ‹xt
();

513 
maskImageCÚ‹xt
->
	`Œª¦©e
(-
maskReù
.
	`x
(), -maskReù.
	`y
());

517 
PaštInfo
 
	`šfo
(
maskImageCÚ‹xt
, 
maskReù
, 
PaštPha£TextCl
, 
Œue
, 0, 0);

518 ià(
box
)

519 
box
->
	`·št
(
šfo
, 
tx
 - box->
	`x
(), 
ty
 - box->
	`y
());

521 
x
 = 
	`isBox
(è? 
	`toR’d”Box
(
this
)->
	`x
() : 0;

522 
y
 = 
	`isBox
(è? 
	`toR’d”Box
(
this
)->
	`y
() : 0;

523 
	`·št
(
šfo
, 
tx
 - 
x
, 
ty
 - 
y
);

527 
cÚ‹xt
->
	`§ve
();

528 
cÚ‹xt
->
	`şToImageBufãr
(
maskReù
, 
maskImage
.
	`g‘
());

531 
StyËImage
* 
bg
 = 
bgLay”
->
	`image
();

532 
boŞ
 
shouldPaštBackgroundImage
 = 
bg
 && bg->
	`ÿnR’d”
(
	`¡yË
()->
	`efãùiveZoom
());

533 
CŞÜ
 
bgCŞÜ
 = 
c
;

541 ià(
	`¡yË
()->
	`fÜûBackgroundsToWh™e
()) {

543 
boŞ
 
shouldPaštBackgroundCŞÜ
 = !
bgLay”
->
	`Ãxt
(è&& 
bgCŞÜ
.
	`isV®id
(è&& bgCŞÜ.
	`®pha
() > 0;

544 ià(
shouldPaštBackgroundImage
 || 
shouldPaštBackgroundCŞÜ
) {

545 
bgCŞÜ
 = 
CŞÜ
::
wh™e
;

546 
shouldPaštBackgroundImage
 = 
çl£
;

550 
boŞ
 
isRoÙ
 = 
this
->
	`isRoÙ
();

554 
boŞ
 
isO·queRoÙ
 = 
çl£
;

555 ià(
isRoÙ
) {

556 
isO·queRoÙ
 = 
Œue
;

557 ià(!
bgLay”
->
	`Ãxt
(è&& !(
bgCŞÜ
.
	`isV®id
(è&& bgCŞÜ.
	`®pha
(è=ğ255è&& 
	`v›w
()->
	`äameV›w
()) {

558 
EËm’t
* 
owÃrEËm’t
 = 
	`docum’t
()->
	`owÃrEËm’t
();

559 ià(
owÃrEËm’t
) {

560 ià(!
owÃrEËm’t
->
	`hasTagName
(
äameTag
)) {

565 
HTMLEËm’t
* 
body
 = 
	`docum’t
()->
	`body
();

566 ià(
body
) {

568 
isO·queRoÙ
 = 
body
->
	`hasLoÿlName
(
äame£tTag
);

572 
isO·queRoÙ
 = !
	`v›w
()->
	`äameV›w
()->
	`isT¿n¥¬’t
();

574 
	`v›w
()->
	`äameV›w
()->
	`£tCÚ‹ÁIsO·que
(
isO·queRoÙ
);

578 ià(!
bgLay”
->
	`Ãxt
()) {

579 
IÁReù
 
	`»ù
(
tx
, 
ty
, 
w
, 
h
);

580 
»ù
.
	`š‹r£ù
(
·štInfo
.rect);

582 ià(
isO·queRoÙ
) {

583 
CŞÜ
 
ba£CŞÜ
 = 
	`v›w
()->
	`äameV›w
()->
	`ba£BackgroundCŞÜ
();

584 ià(
ba£CŞÜ
.
	`®pha
() > 0) {

585 
cÚ‹xt
->
	`§ve
();

586 
cÚ‹xt
->
	`£tCompos™eO³¿tiÚ
(
Compos™eCİy
);

587 
cÚ‹xt
->
	`flReù
(
»ù
, 
ba£CŞÜ
, 
	`¡yË
()->
	`cŞÜS·û
());

588 
cÚ‹xt
->
	`»¡Üe
();

590 
cÚ‹xt
->
	`ş—rReù
(
»ù
);

593 ià(
bgCŞÜ
.
	`isV®id
(è&& bgCŞÜ.
	`®pha
() > 0)

594 
cÚ‹xt
->
	`flReù
(
»ù
, 
bgCŞÜ
, 
	`¡yË
()->
	`cŞÜS·û
());

598 ià(
shouldPaštBackgroundImage
) {

599 
IÁReù
 
de¡Reù
;

600 
IÁPošt
 
pha£
;

601 
IÁSize
 
teSize
;

603 
	`ÿlcuÏ‹BackgroundImageGeom‘ry
(
bgLay”
, 
tx
, 
ty
, 
w
, 
h
, 
de¡Reù
, 
pha£
, 
teSize
);

604 
IÁPošt
 
de¡Origš
 = 
de¡Reù
.
	`loÿtiÚ
();

605 
de¡Reù
.
	`š‹r£ù
(
·štInfo
.
»ù
);

606 ià(!
de¡Reù
.
	`isEm±y
()) {

607 
pha£
 +ğ
de¡Reù
.
	`loÿtiÚ
(è- 
de¡Origš
;

608 
Compos™eO³¿tÜ
 
compos™eOp
 = 
İ
 =ğ
Compos™eSourûOv”
 ? 
bgLay”
->
	`compos™e
() : op;

609 
R’d”Objeù
* 
ş›ÁFÜBackgroundImage
 = 
backgroundObjeù
 ? backgroundObjeù : 
this
;

610 
Image
* 
image
 = 
bg
->
	`image
(
ş›ÁFÜBackgroundImage
, 
teSize
);

611 
boŞ
 
u£LowQu®™ySÿlšg
 = 
R’d”BoxMod–SÿËOb£rv”
::
	`shouldPaštBackgroundAtLowQu®™y
(
cÚ‹xt
, 
this
, 
image
, 
teSize
);

612 
cÚ‹xt
->
	`d¿wTedImage
(
image
, 
	`¡yË
()->
	`cŞÜS·û
(), 
de¡Reù
, 
pha£
, 
teSize
, 
compos™eOp
, 
u£LowQu®™ySÿlšg
);

616 ià(
bgLay”
->
	`ş
(è!ğ
BÜd”FlBox
)

618 
cÚ‹xt
->
	`»¡Üe
();

620 ià(
ş³dToBÜd”Radius
)

622 
cÚ‹xt
->
	`»¡Üe
();

624 ià(
ş³dW™hLoÿlSüŞlšg
)

625 
cÚ‹xt
->
	`»¡Üe
();

626 
	}
}

628 
IÁSize
 
	gR’d”BoxMod–Objeù
::
	$ÿlcuÏ‹FlTeSize
(cÚ¡ 
FlLay”
* 
flLay”
, 
IÁSize
 
pos™iÚšgA»aSize
) const

630 
StyËImage
* 
image
 = 
flLay”
->
	`image
();

631 
image
->
	`£tImageCÚš”Size
(
pos™iÚšgA»aSize
);

633 
EFlSizeTy³
 
ty³
 = 
flLay”
->
	`size
().type;

635 
ty³
) {

636 
SizeL’gth
: {

637 
w
 = 
pos™iÚšgA»aSize
.
	`width
();

638 
h
 = 
pos™iÚšgA»aSize
.
	`height
();

640 
L’gth
 
Ïy”Width
 = 
flLay”
->
	`size
().
size
.
	`width
();

641 
L’gth
 
Ïy”Height
 = 
flLay”
->
	`size
().
size
.
	`height
();

643 ià(
Ïy”Width
.
	`isFixed
())

644 
w
 = 
Ïy”Width
.
	`v®ue
();

645 ià(
Ïy”Width
.
	`isP”ûÁ
())

646 
w
 = 
Ïy”Width
.
	`ÿlcV®ue
(
pos™iÚšgA»aSize
.
	`width
());

648 ià(
Ïy”Height
.
	`isFixed
())

649 
h
 = 
Ïy”Height
.
	`v®ue
();

650 ià(
Ïy”Height
.
	`isP”ûÁ
())

651 
h
 = 
Ïy”Height
.
	`ÿlcV®ue
(
pos™iÚšgA»aSize
.
	`height
());

655 ià(
Ïy”Width
.
	`isAuto
(è&& !
Ïy”Height
.isAuto()) {

656 
IÁSize
 
imageIÁršsicSize
 = 
image
->
	`imageSize
(
this
, 
	`¡yË
()->
	`efãùiveZoom
());

657 ià(
imageIÁršsicSize
.
	`height
())

658 
w
 = 
imageIÁršsicSize
.
	`width
(è* 
h
 / imageIÁršsicSize.
	`height
();

659 } ià(!
Ïy”Width
.
	`isAuto
(è&& 
Ïy”Height
.isAuto()) {

660 
IÁSize
 
imageIÁršsicSize
 = 
image
->
	`imageSize
(
this
, 
	`¡yË
()->
	`efãùiveZoom
());

661 ià(
imageIÁršsicSize
.
	`width
())

662 
h
 = 
imageIÁršsicSize
.
	`height
(è* 
w
 / imageIÁršsicSize.
	`width
();

663 } ià(
Ïy”Width
.
	`isAuto
(è&& 
Ïy”Height
.isAuto()) {

665 
IÁSize
 
imageIÁršsicSize
 = 
image
->
	`imageSize
(
this
, 
	`¡yË
()->
	`efãùiveZoom
());

666 
w
 = 
imageIÁršsicSize
.
	`width
();

667 
h
 = 
imageIÁršsicSize
.
	`height
();

670  
	`IÁSize
(
	`max
(1, 
w
), max(1, 
h
));

672 
CÚš
:

673 
Cov”
: {

674 
IÁSize
 
imageIÁršsicSize
 = 
image
->
	`imageSize
(
this
, 1);

675 
hÜizÚlSÿËFaùÜ
 = 
imageIÁršsicSize
.
	`width
()

676 ? 
¡©ic_ÿ¡
<>(
pos™iÚšgA»aSize
.
	`width
()è/ 
imageIÁršsicSize
.width() : 1;

677 
v”tiÿlSÿËFaùÜ
 = 
imageIÁršsicSize
.
	`height
()

678 ? 
¡©ic_ÿ¡
<>(
pos™iÚšgA»aSize
.
	`height
()è/ 
imageIÁršsicSize
.height() : 1;

679 
sÿËFaùÜ
 = 
ty³
 =ğ
CÚš
 ? 
	`mš
(
hÜizÚlSÿËFaùÜ
, 
v”tiÿlSÿËFaùÜ
è: 
	`max
(horizontalScaleFactor, verticalScaleFactor);

680  
	`IÁSize
(
max
<>(1, 
imageIÁršsicSize
.
	`width
(è* 
sÿËFaùÜ
), max<>(1, imageIÁršsicSize.
	`height
() * scaleFactor));

682 
SizeNÚe
:

686  
image
->
	`imageSize
(
this
, 
	`¡yË
()->
	`efãùiveZoom
());

687 
	}
}

689 
	gR’d”BoxMod–Objeù
::
	$ÿlcuÏ‹BackgroundImageGeom‘ry
(cÚ¡ 
FlLay”
* 
flLay”
, 
tx
, 
ty
, 
w
, 
h
,

690 
IÁReù
& 
de¡Reù
, 
IÁPošt
& 
pha£
, 
IÁSize
& 
teSize
)

692 
Ëá
 = 0;

693 
tİ
 = 0;

694 
IÁSize
 
pos™iÚšgA»aSize
;

698 
boŞ
 
fixedA‰achm’t
 = 
flLay”
->
	`©chm’t
(è=ğ
FixedBackgroundA‰achm’t
;

700 #ià
	`ENABLE
(
FAST_MOBILE_SCROLLING
)

701 ià(
	`v›w
()->
	`äameV›w
(è&& v›w()->äameV›w()->
	`ÿnBl™OnSüŞl
()) {

706 
fixedA‰achm’t
 = 
çl£
;

710 ià(!
fixedA‰achm’t
) {

711 
de¡Reù
 = 
	`IÁReù
(
tx
, 
ty
, 
w
, 
h
);

713 
right
 = 0;

714 
bÙtom
 = 0;

716 ià(
flLay”
->
	`Üigš
(è!ğ
BÜd”FlBox
) {

717 
Ëá
 = 
	`bÜd”Leá
();

718 
right
 = 
	`bÜd”Right
();

719 
tİ
 = 
	`bÜd”Tİ
();

720 
bÙtom
 = 
	`bÜd”BÙtom
();

721 ià(
flLay”
->
	`Üigš
(è=ğ
CÚ‹ÁFlBox
) {

722 
Ëá
 +ğ
	`·ddšgLeá
();

723 
right
 +ğ
	`·ddšgRight
();

724 
tİ
 +ğ
	`·ddšgTİ
();

725 
bÙtom
 +ğ
	`·ddšgBÙtom
();

732 ià(
	`isRoÙ
()) {

733 
pos™iÚšgA»aSize
 = 
	`IÁSize
(
	`toR’d”Box
(
this
)->
	`width
(è- 
Ëá
 - 
right
,oR’d”BoxÑhis)->
	`height
(è- 
tİ
 - 
bÙtom
);

734 
Ëá
 +ğ
	`m¬gšLeá
();

735 
tİ
 +ğ
	`m¬gšTİ
();

737 
pos™iÚšgA»aSize
 = 
	`IÁSize
(
w
 - 
Ëá
 - 
right
, 
h
 - 
tİ
 - 
bÙtom
);

739 
de¡Reù
 = 
	`v›wReù
();

740 
pos™iÚšgA»aSize
 = 
de¡Reù
.
	`size
();

743 
teSize
 = 
	`ÿlcuÏ‹FlTeSize
(
flLay”
, 
pos™iÚšgA»aSize
);

745 
EFlR•—t
 
backgroundR•—tX
 = 
flLay”
->
	`»³©X
();

746 
EFlR•—t
 
backgroundR•—tY
 = 
flLay”
->
	`»³©Y
();

748 
xPos™iÚ
 = 
flLay”
->
	`xPos™iÚ
().
	`ÿlcMšV®ue
(
pos™iÚšgA»aSize
.
	`width
(è- 
teSize
.width(), 
Œue
);

749 ià(
backgroundR•—tX
 =ğ
R•—tFl
)

750 
pha£
.
	`£tX
(
teSize
.
	`width
(è?eSize.width(è- (
xPos™iÚ
 + 
Ëá
) %ileSize.width() : 0);

752 
de¡Reù
.
	`move
(
	`max
(
xPos™iÚ
 + 
Ëá
, 0), 0);

753 
pha£
.
	`£tX
(-
	`mš
(
xPos™iÚ
 + 
Ëá
, 0));

754 
de¡Reù
.
	`£tWidth
(
teSize
.
	`width
(è+ 
	`mš
(
xPos™iÚ
 + 
Ëá
, 0));

757 
yPos™iÚ
 = 
flLay”
->
	`yPos™iÚ
().
	`ÿlcMšV®ue
(
pos™iÚšgA»aSize
.
	`height
(è- 
teSize
.height(), 
Œue
);

758 ià(
backgroundR•—tY
 =ğ
R•—tFl
)

759 
pha£
.
	`£tY
(
teSize
.
	`height
(è?eSize.height(è- (
yPos™iÚ
 + 
tİ
) %ileSize.height() : 0);

761 
de¡Reù
.
	`move
(0, 
	`max
(
yPos™iÚ
 + 
tİ
, 0));

762 
pha£
.
	`£tY
(-
	`mš
(
yPos™iÚ
 + 
tİ
, 0));

763 
de¡Reù
.
	`£tHeight
(
teSize
.
	`height
(è+ 
	`mš
(
yPos™iÚ
 + 
tİ
, 0));

766 ià(
fixedA‰achm’t
)

767 
pha£
.
	`move
(
	`max
(
tx
 - 
de¡Reù
.
	`x
(), 0), max(
ty
 - de¡Reù.
	`y
(), 0));

769 
de¡Reù
.
	`š‹r£ù
(
	`IÁReù
(
tx
, 
ty
, 
w
, 
h
));

770 
	}
}

772 
	gR’d”BoxMod–Objeù
::
	$v”tiÿlPos™iÚ
(
boŞ
 
fœ¡Lše
) const

775 
	`ASSERT
(
	`isIÆše
());

776 ià(!
	`isIÆše
())

779 
vpos
 = 0;

780 
EV”tiÿlAlign
 
va
 = 
	`¡yË
()->
	`v”tiÿlAlign
();

781 ià(
va
 =ğ
TOP
)

782 
vpos
 = 
Pos™iÚTİ
;

783 ià(
va
 =ğ
BOTTOM
)

784 
vpos
 = 
Pos™iÚBÙtom
;

786 
boŞ
 
checkP¬’t
 = 
	`·»Á
()->
	`isR’d”IÆše
(è&&…¬’t()->
	`¡yË
()->
	`v”tiÿlAlign
(è!ğ
TOP
 &&…¬’t()->¡yË()->v”tiÿlAlign(è!ğ
BOTTOM
;

787 
vpos
 = 
checkP¬’t
 ? 
	`toR’d”IÆše
(
	`·»Á
())->
	`v”tiÿlPos™iÚFromCache
(
fœ¡Lše
) : 0;

789 ià(
va
 =ğ
BASELINE
)

790  
vpos
;

792 cÚ¡ 
FÚt
& 
f
 = 
	`·»Á
()->
	`¡yË
(
fœ¡Lše
)->
	`fÚt
();

793 
fÚtsize
 = 
f
.
	`pix–Size
();

795 ià(
va
 =ğ
SUB
)

796 
vpos
 +ğ
fÚtsize
 / 5 + 1;

797 ià(
va
 =ğ
SUPER
)

798 
vpos
 -ğ
fÚtsize
 / 3 + 1;

799 ià(
va
 =ğ
TEXT_TOP
)

800 
vpos
 +ğ
	`ba£lšePos™iÚ
(
fœ¡Lše
è- 
f
.
	`asûÁ
();

801 ià(
va
 =ğ
MIDDLE
)

802 
vpos
 +ğ-
¡©ic_ÿ¡
<>(
f
.
	`xHeight
(è/ 2è- 
	`lšeHeight
(
fœ¡Lše
è/ 2 + 
	`ba£lšePos™iÚ
(firstLine);

803 ià(
va
 =ğ
TEXT_BOTTOM
) {

804 
vpos
 +ğ
f
.
	`desûÁ
();

806 ià(!
	`isR•Ïûd
(è|| 
	`¡yË
()->
	`di¥Ïy
(è=ğ
INLINE_BLOCK
)

807 
vpos
 -ğ(
	`lšeHeight
(
fœ¡Lše
è- 
	`ba£lšePos™iÚ
(firstLine));

808 } ià(
va
 =ğ
BASELINE_MIDDLE
)

809 
vpos
 +ğ-
	`lšeHeight
(
fœ¡Lše
è/ 2 + 
	`ba£lšePos™iÚ
(firstLine);

810 ià(
va
 =ğ
LENGTH
)

811 
vpos
 -ğ
	`¡yË
()->
	`v”tiÿlAlignL’gth
().
	`ÿlcV®ue
(
	`lšeHeight
(
fœ¡Lše
));

814  
vpos
;

815 
	}
}

817 
boŞ
 
	gR’d”BoxMod–Objeù
::
	$·štNšeP›ûImage
(
G¿phicsCÚ‹xt
* 
g¿phicsCÚ‹xt
, 
tx
, 
ty
, 
w
, 
h
, cÚ¡ 
R’d”StyË
* 
¡yË
,

818 cÚ¡ 
NšeP›ûImage
& 
nšeP›ûImage
, 
Compos™eO³¿tÜ
 
İ
)

820 
StyËImage
* 
¡yËImage
 = 
nšeP›ûImage
.
	`image
();

821 ià(!
¡yËImage
)

822  
çl£
;

824 ià(!
¡yËImage
->
	`isLßded
())

825  
Œue
;

827 ià(!
¡yËImage
->
	`ÿnR’d”
(
¡yË
->
	`efãùiveZoom
()))

828  
çl£
;

832 
¡yËImage
->
	`£tImageCÚš”Size
(
	`IÁSize
(
w
, 
h
));

833 
IÁSize
 
imageSize
 = 
¡yËImage
->
	`imageSize
(
this
, 1.0f);

834 
imageWidth
 = 
imageSize
.
	`width
();

835 
imageHeight
 = 
imageSize
.
	`height
();

837 
tİSliû
 = 
	`mš
(
imageHeight
, 
nšeP›ûImage
.
	`¦iûs
().
	`tİ
().
	`ÿlcV®ue
(imageHeight));

838 
bÙtomSliû
 = 
	`mš
(
imageHeight
, 
nšeP›ûImage
.
	`¦iûs
().
	`bÙtom
().
	`ÿlcV®ue
(imageHeight));

839 
ËáSliû
 = 
	`mš
(
imageWidth
, 
nšeP›ûImage
.
	`¦iûs
().
	`Ëá
().
	`ÿlcV®ue
(imageWidth));

840 
rightSliû
 = 
	`mš
(
imageWidth
, 
nšeP›ûImage
.
	`¦iûs
().
	`right
().
	`ÿlcV®ue
(imageWidth));

842 
ENšeP›ûImageRuË
 
hRuË
 = 
nšeP›ûImage
.
	`hÜizÚlRuË
();

843 
ENšeP›ûImageRuË
 
vRuË
 = 
nšeP›ûImage
.
	`v”tiÿlRuË
();

845 
boŞ
 
f™ToBÜd”
 = 
¡yË
->
	`bÜd”Image
(è=ğ
nšeP›ûImage
;

847 
ËáWidth
 = 
f™ToBÜd”
 ? 
¡yË
->
	`bÜd”LeáWidth
(è: 
ËáSliû
;

848 
tİWidth
 = 
f™ToBÜd”
 ? 
¡yË
->
	`bÜd”TİWidth
(è: 
tİSliû
;

849 
rightWidth
 = 
f™ToBÜd”
 ? 
¡yË
->
	`bÜd”RightWidth
(è: 
rightSliû
;

850 
bÙtomWidth
 = 
f™ToBÜd”
 ? 
¡yË
->
	`bÜd”BÙtomWidth
(è: 
bÙtomSliû
;

852 
boŞ
 
d¿wLeá
 = 
ËáSliû
 > 0 && 
ËáWidth
 > 0;

853 
boŞ
 
d¿wTİ
 = 
tİSliû
 > 0 && 
tİWidth
 > 0;

854 
boŞ
 
d¿wRight
 = 
rightSliû
 > 0 && 
rightWidth
 > 0;

855 
boŞ
 
d¿wBÙtom
 = 
bÙtomSliû
 > 0 && 
bÙtomWidth
 > 0;

856 
boŞ
 
d¿wMiddË
 = (
imageWidth
 - 
ËáSliû
 - 
rightSliû
è> 0 && (
w
 - 
ËáWidth
 - 
rightWidth
) > 0 &&

857 (
imageHeight
 - 
tİSliû
 - 
bÙtomSliû
è> 0 && (
h
 - 
tİWidth
 - 
bÙtomWidth
) > 0;

859 
Image
* 
image
 = 
¡yËImage
->
	`image
(
this
, 
imageSize
);

860 
CŞÜS·û
 
cŞÜS·û
 = 
¡yË
->
	`cŞÜS·û
();

862 ià(
d¿wLeá
) {

867 ià(
d¿wTİ
)

868 
g¿phicsCÚ‹xt
->
	`d¿wImage
(
image
, 
cŞÜS·û
, 
	`IÁReù
(
tx
, 
ty
, 
ËáWidth
, 
tİWidth
),

869 
	`IÁReù
(0, 0, 
ËáSliû
, 
tİSliû
), 
İ
);

873 ià(
d¿wBÙtom
)

874 
g¿phicsCÚ‹xt
->
	`d¿wImage
(
image
, 
cŞÜS·û
, 
	`IÁReù
(
tx
, 
ty
 + 
h
 - 
bÙtomWidth
, 
ËáWidth
, bottomWidth),

875 
	`IÁReù
(0, 
imageHeight
 - 
bÙtomSliû
, 
ËáSliû
, bÙtomSliû), 
İ
);

879 
g¿phicsCÚ‹xt
->
	`d¿wTedImage
(
image
, 
cŞÜS·û
, 
	`IÁReù
(
tx
, 
ty
 + 
tİWidth
, 
ËáWidth
,

880 
h
 - 
tİWidth
 - 
bÙtomWidth
),

881 
	`IÁReù
(0, 
tİSliû
, 
ËáSliû
, 
imageHeight
 -İSliû - 
bÙtomSliû
),

882 
Image
::
SŒ‘chTe
, (Image::
TeRuË
)
vRuË
, 
İ
);

885 ià(
d¿wRight
) {

889 ià(
d¿wTİ
)

890 
g¿phicsCÚ‹xt
->
	`d¿wImage
(
image
, 
cŞÜS·û
, 
	`IÁReù
(
tx
 + 
w
 - 
rightWidth
, 
ty
,„ightWidth, 
tİWidth
),

891 
	`IÁReù
(
imageWidth
 - 
rightSliû
, 0,„ightSliû, 
tİSliû
), 
İ
);

895 ià(
d¿wBÙtom
)

896 
g¿phicsCÚ‹xt
->
	`d¿wImage
(
image
, 
cŞÜS·û
, 
	`IÁReù
(
tx
 + 
w
 - 
rightWidth
, 
ty
 + 
h
 - 
bÙtomWidth
,„ightWidth, bottomWidth),

897 
	`IÁReù
(
imageWidth
 - 
rightSliû
, 
imageHeight
 - 
bÙtomSliû
,„ightSliû, bÙtomSliû), 
İ
);

900 
g¿phicsCÚ‹xt
->
	`d¿wTedImage
(
image
, 
cŞÜS·û
, 
	`IÁReù
(
tx
 + 
w
 - 
rightWidth
, 
ty
 + 
tİWidth
,„ightWidth,

901 
h
 - 
tİWidth
 - 
bÙtomWidth
),

902 
	`IÁReù
(
imageWidth
 - 
rightSliû
, 
tİSliû
,„ightSliû, 
imageHeight
 -İSliû - 
bÙtomSliû
),

903 
Image
::
SŒ‘chTe
, (Image::
TeRuË
)
vRuË
, 
İ
);

907 ià(
d¿wTİ
)

908 
g¿phicsCÚ‹xt
->
	`d¿wTedImage
(
image
, 
cŞÜS·û
, 
	`IÁReù
(
tx
 + 
ËáWidth
, 
ty
, 
w
 -†eáWidth - 
rightWidth
, 
tİWidth
),

909 
	`IÁReù
(
ËáSliû
, 0, 
imageWidth
 - 
rightSliû
 -†eáSliû, 
tİSliû
),

910 (
Image
::
TeRuË
)
hRuË
, Image::
SŒ‘chTe
, 
İ
);

913 ià(
d¿wBÙtom
)

914 
g¿phicsCÚ‹xt
->
	`d¿wTedImage
(
image
, 
cŞÜS·û
, 
	`IÁReù
(
tx
 + 
ËáWidth
, 
ty
 + 
h
 - 
bÙtomWidth
,

915 
w
 - 
ËáWidth
 - 
rightWidth
, 
bÙtomWidth
),

916 
	`IÁReù
(
ËáSliû
, 
imageHeight
 - 
bÙtomSliû
, 
imageWidth
 - 
rightSliû
 -†eftSlice, bottomSlice),

917 (
Image
::
TeRuË
)
hRuË
, Image::
SŒ‘chTe
, 
İ
);

920 ià(
d¿wMiddË
)

921 
g¿phicsCÚ‹xt
->
	`d¿wTedImage
(
image
, 
cŞÜS·û
, 
	`IÁReù
(
tx
 + 
ËáWidth
, 
ty
 + 
tİWidth
, 
w
 -†eáWidth - 
rightWidth
,

922 
h
 - 
tİWidth
 - 
bÙtomWidth
),

923 
	`IÁReù
(
ËáSliû
, 
tİSliû
, 
imageWidth
 - 
rightSliû
 -†eáSliû, 
imageHeight
 -İSliû - 
bÙtomSliû
),

924 (
Image
::
TeRuË
)
hRuË
, (Image::TeRuË)
vRuË
, 
İ
);

926  
Œue
;

927 
	}
}

929 
	gR’d”BoxMod–Objeù
::
	$·štBÜd”
(
G¿phicsCÚ‹xt
* 
g¿phicsCÚ‹xt
, 
tx
, 
ty
, 
w
, 
h
,

930 cÚ¡ 
R’d”StyË
* 
¡yË
, 
boŞ
 
begš
, boŞ 
’d
)

932 ià(
	`·štNšeP›ûImage
(
g¿phicsCÚ‹xt
, 
tx
, 
ty
, 
w
, 
h
, 
¡yË
, styË->
	`bÜd”Image
()))

935 cÚ¡ 
CŞÜ
& 
tİCŞÜ
 = 
¡yË
->
	`vis™edD•’d’tCŞÜ
(
CSSPrİ”tyBÜd”TİCŞÜ
);

936 cÚ¡ 
CŞÜ
& 
bÙtomCŞÜ
 = 
¡yË
->
	`vis™edD•’d’tCŞÜ
(
CSSPrİ”tyBÜd”BÙtomCŞÜ
);

937 cÚ¡ 
CŞÜ
& 
ËáCŞÜ
 = 
¡yË
->
	`vis™edD•’d’tCŞÜ
(
CSSPrİ”tyBÜd”LeáCŞÜ
);

938 cÚ¡ 
CŞÜ
& 
rightCŞÜ
 = 
¡yË
->
	`vis™edD•’d’tCŞÜ
(
CSSPrİ”tyBÜd”RightCŞÜ
);

940 
boŞ
 
tİT¿n¥¬’t
 = 
¡yË
->
	`bÜd”TİIsT¿n¥¬’t
();

941 
boŞ
 
bÙtomT¿n¥¬’t
 = 
¡yË
->
	`bÜd”BÙtomIsT¿n¥¬’t
();

942 
boŞ
 
rightT¿n¥¬’t
 = 
¡yË
->
	`bÜd”RightIsT¿n¥¬’t
();

943 
boŞ
 
ËáT¿n¥¬’t
 = 
¡yË
->
	`bÜd”LeáIsT¿n¥¬’t
();

945 
EBÜd”StyË
 
tİStyË
 = 
¡yË
->
	`bÜd”TİStyË
();

946 
EBÜd”StyË
 
bÙtomStyË
 = 
¡yË
->
	`bÜd”BÙtomStyË
();

947 
EBÜd”StyË
 
ËáStyË
 = 
¡yË
->
	`bÜd”LeáStyË
();

948 
EBÜd”StyË
 
rightStyË
 = 
¡yË
->
	`bÜd”RightStyË
();

950 
boŞ
 
»nd”Tİ
 = 
tİStyË
 > 
BHIDDEN
 && !
tİT¿n¥¬’t
;

951 
boŞ
 
»nd”Leá
 = 
ËáStyË
 > 
BHIDDEN
 && 
begš
 && !
ËáT¿n¥¬’t
;

952 
boŞ
 
»nd”Right
 = 
rightStyË
 > 
BHIDDEN
 && 
’d
 && !
rightT¿n¥¬’t
;

953 
boŞ
 
»nd”BÙtom
 = 
bÙtomStyË
 > 
BHIDDEN
 && !
bÙtomT¿n¥¬’t
;

955 
boŞ
 
»nd”Radii
 = 
çl£
;

956 
IÁSize
 
tİLeá
, 
tİRight
, 
bÙtomLeá
, 
bÙtomRight
;

958 ià(
¡yË
->
	`hasBÜd”Radius
()) {

959 
IÁReù
 
bÜd”Reù
 = 
	`IÁReù
(
tx
, 
ty
, 
w
, 
h
);

961 
IÁSize
 
tİLeáRadius
, 
tİRightRadius
, 
bÙtomLeáRadius
, 
bÙtomRightRadius
;

962 
¡yË
->
	`g‘BÜd”RadiiFÜReù
(
bÜd”Reù
, 
tİLeáRadius
, 
tİRightRadius
, 
bÙtomLeáRadius
, 
bÙtomRightRadius
);

964 ià(
begš
) {

965 
tİLeá
 = 
tİLeáRadius
;

966 
bÙtomLeá
 = 
bÙtomLeáRadius
;

968 ià(
’d
) {

969 
tİRight
 = 
tİRightRadius
;

970 
bÙtomRight
 = 
bÙtomRightRadius
;

973 
»nd”Radii
 = 
Œue
;

976 
g¿phicsCÚ‹xt
->
	`§ve
();

977 
g¿phicsCÚ‹xt
->
	`addRoundedReùCl
(
bÜd”Reù
, 
tİLeá
, 
tİRight
, 
bÙtomLeá
, 
bÙtomRight
);

980 
fœ¡AngËS¹
, 
£cÚdAngËS¹
, 
fœ¡AngËS·n
, 
£cÚdAngËS·n
;

981 
thickÃss
;

982 
boŞ
 
uµ”LeáBÜd”StyËsM©ch
 = 
»nd”Leá
 && (
tİStyË
 =ğ
ËáStyË
è&& (
tİCŞÜ
 =ğ
ËáCŞÜ
);

983 
boŞ
 
uµ”RightBÜd”StyËsM©ch
 = 
»nd”Right
 && (
tİStyË
 =ğ
rightStyË
è&& (
tİCŞÜ
 =ğ
rightCŞÜ
è&& (tİStyË !ğ
OUTSET
è&& (tİStyË !ğ
RIDGE
è&& (tİStyË !ğ
INSET
è&& (tİStyË !ğ
GROOVE
);

984 
boŞ
 
low”LeáBÜd”StyËsM©ch
 = 
»nd”Leá
 && (
bÙtomStyË
 =ğ
ËáStyË
è&& (
bÙtomCŞÜ
 =ğ
ËáCŞÜ
è&& (bÙtomStyË !ğ
OUTSET
è&& (bÙtomStyË !ğ
RIDGE
è&& (bÙtomStyË !ğ
INSET
è&& (bÙtomStyË !ğ
GROOVE
);

985 
boŞ
 
low”RightBÜd”StyËsM©ch
 = 
»nd”Right
 && (
bÙtomStyË
 =ğ
rightStyË
è&& (
bÙtomCŞÜ
 =ğ
rightCŞÜ
);

987 ià(
»nd”Tİ
) {

988 
boŞ
 
ignÜe_Ëá
 = (
»nd”Radii
 && 
tİLeá
.
	`width
() > 0) ||

989 (
tİCŞÜ
 =ğ
ËáCŞÜ
 && 
tİT¿n¥¬’t
 =ğ
ËáT¿n¥¬’t
 && 
tİStyË
 >ğ
OUTSET
 &&

990 (
ËáStyË
 =ğ
DOTTED
 ||†eáStyË =ğ
DASHED
 ||†eáStyË =ğ
SOLID
 ||†eáStyË =ğ
OUTSET
));

992 
boŞ
 
ignÜe_right
 = (
»nd”Radii
 && 
tİRight
.
	`width
() > 0) ||

993 (
tİCŞÜ
 =ğ
rightCŞÜ
 && 
tİT¿n¥¬’t
 =ğ
rightT¿n¥¬’t
 && 
tİStyË
 >ğ
OUTSET
 &&

994 (
rightStyË
 =ğ
DOTTED
 ||„ightStyË =ğ
DASHED
 ||„ightStyË =ğ
SOLID
 ||„ightStyË =ğ
INSET
));

996 
x
 = 
tx
;

997 
x2
 = 
tx
 + 
w
;

998 ià(
»nd”Radii
) {

999 
x
 +ğ
tİLeá
.
	`width
();

1000 
x2
 -ğ
tİRight
.
	`width
();

1003 
	`d¿wLšeFÜBoxSide
(
g¿phicsCÚ‹xt
, 
x
, 
ty
, 
x2
,y + 
¡yË
->
	`bÜd”TİWidth
(), 
BSTİ
, 
tİCŞÜ
, 
tİStyË
,

1004 
ignÜe_Ëá
 ? 0 : 
¡yË
->
	`bÜd”LeáWidth
(), 
ignÜe_right
 ? 0 : styË->
	`bÜd”RightWidth
());

1006 ià(
»nd”Radii
) {

1007 
ËáY
 = 
ty
;

1012 
thickÃss
 = 
¡yË
->
	`bÜd”TİWidth
() * 2;

1014 ià(
tİLeá
.
	`width
()) {

1015 
ËáX
 = 
tx
;

1017 
boŞ
 
­¶yLeáIÂ”Cl
 = (
¡yË
->
	`bÜd”LeáWidth
(è< 
tİLeá
.
	`width
())

1018 && (
¡yË
->
	`bÜd”TİWidth
(è< 
tİLeá
.
	`height
())

1019 && (
tİStyË
 !ğ
DOUBLE
 || 
¡yË
->
	`bÜd”TİWidth
() > 6);

1020 ià(
­¶yLeáIÂ”Cl
) {

1021 
g¿phicsCÚ‹xt
->
	`§ve
();

1022 
g¿phicsCÚ‹xt
->
	`addIÂ”RoundedReùCl
(
	`IÁReù
(
ËáX
, 
ËáY
, 
tİLeá
.
	`width
(è* 2,İLeá.
	`height
() * 2),

1023 
¡yË
->
	`bÜd”TİWidth
());

1026 
fœ¡AngËS¹
 = 90;

1027 
fœ¡AngËS·n
 = 
uµ”LeáBÜd”StyËsM©ch
 ? 90 : 45;

1030 
	`d¿wArcFÜBoxSide
(
g¿phicsCÚ‹xt
, 
ËáX
, 
ËáY
, 
thickÃss
, 
tİLeá
, 
fœ¡AngËS¹
, 
fœ¡AngËS·n
,

1031 
BSTİ
, 
tİCŞÜ
, 
tİStyË
, 
Œue
);

1032 ià(
­¶yLeáIÂ”Cl
)

1033 
g¿phicsCÚ‹xt
->
	`»¡Üe
();

1036 ià(
tİRight
.
	`width
()) {

1037 
rightX
 = 
tx
 + 
w
 - 
tİRight
.
	`width
() * 2;

1038 
boŞ
 
­¶yRightIÂ”Cl
 = (
¡yË
->
	`bÜd”RightWidth
(è< 
tİRight
.
	`width
())

1039 && (
¡yË
->
	`bÜd”TİWidth
(è< 
tİRight
.
	`height
())

1040 && (
tİStyË
 !ğ
DOUBLE
 || 
¡yË
->
	`bÜd”TİWidth
() > 6);

1041 ià(
­¶yRightIÂ”Cl
) {

1042 
g¿phicsCÚ‹xt
->
	`§ve
();

1043 
g¿phicsCÚ‹xt
->
	`addIÂ”RoundedReùCl
(
	`IÁReù
(
rightX
, 
ËáY
, 
tİRight
.
	`width
(è* 2,İRight.
	`height
() * 2),

1044 
¡yË
->
	`bÜd”TİWidth
());

1047 ià(
uµ”RightBÜd”StyËsM©ch
) {

1048 
£cÚdAngËS¹
 = 0;

1049 
£cÚdAngËS·n
 = 90;

1051 
£cÚdAngËS¹
 = 45;

1052 
£cÚdAngËS·n
 = 45;

1056 
	`d¿wArcFÜBoxSide
(
g¿phicsCÚ‹xt
, 
rightX
, 
ËáY
, 
thickÃss
, 
tİRight
, 
£cÚdAngËS¹
, 
£cÚdAngËS·n
,

1057 
BSTİ
, 
tİCŞÜ
, 
tİStyË
, 
çl£
);

1058 ià(
­¶yRightIÂ”Cl
)

1059 
g¿phicsCÚ‹xt
->
	`»¡Üe
();

1064 ià(
»nd”BÙtom
) {

1065 
boŞ
 
ignÜe_Ëá
 = (
»nd”Radii
 && 
bÙtomLeá
.
	`width
() > 0) ||

1066 (
bÙtomCŞÜ
 =ğ
ËáCŞÜ
 && 
bÙtomT¿n¥¬’t
 =ğ
ËáT¿n¥¬’t
 && 
bÙtomStyË
 >ğ
OUTSET
 &&

1067 (
ËáStyË
 =ğ
DOTTED
 ||†eáStyË =ğ
DASHED
 ||†eáStyË =ğ
SOLID
 ||†eáStyË =ğ
OUTSET
));

1069 
boŞ
 
ignÜe_right
 = (
»nd”Radii
 && 
bÙtomRight
.
	`width
() > 0) ||

1070 (
bÙtomCŞÜ
 =ğ
rightCŞÜ
 && 
bÙtomT¿n¥¬’t
 =ğ
rightT¿n¥¬’t
 && 
bÙtomStyË
 >ğ
OUTSET
 &&

1071 (
rightStyË
 =ğ
DOTTED
 ||„ightStyË =ğ
DASHED
 ||„ightStyË =ğ
SOLID
 ||„ightStyË =ğ
INSET
));

1073 
x
 = 
tx
;

1074 
x2
 = 
tx
 + 
w
;

1075 ià(
»nd”Radii
) {

1076 
x
 +ğ
bÙtomLeá
.
	`width
();

1077 
x2
 -ğ
bÙtomRight
.
	`width
();

1080 
	`d¿wLšeFÜBoxSide
(
g¿phicsCÚ‹xt
, 
x
, 
ty
 + 
h
 - 
¡yË
->
	`bÜd”BÙtomWidth
(), 
x2
,y + h, 
BSBÙtom
, 
bÙtomCŞÜ
, 
bÙtomStyË
,

1081 
ignÜe_Ëá
 ? 0 : 
¡yË
->
	`bÜd”LeáWidth
(), 
ignÜe_right
 ? 0 : styË->
	`bÜd”RightWidth
());

1083 ià(
»nd”Radii
) {

1084 
thickÃss
 = 
¡yË
->
	`bÜd”BÙtomWidth
() * 2;

1086 ià(
bÙtomLeá
.
	`width
()) {

1087 
ËáX
 = 
tx
;

1088 
ËáY
 = 
ty
 + 
h
 - 
bÙtomLeá
.
	`height
() * 2;

1089 
boŞ
 
­¶yLeáIÂ”Cl
 = (
¡yË
->
	`bÜd”LeáWidth
(è< 
bÙtomLeá
.
	`width
())

1090 && (
¡yË
->
	`bÜd”BÙtomWidth
(è< 
bÙtomLeá
.
	`height
())

1091 && (
bÙtomStyË
 !ğ
DOUBLE
 || 
¡yË
->
	`bÜd”BÙtomWidth
() > 6);

1092 ià(
­¶yLeáIÂ”Cl
) {

1093 
g¿phicsCÚ‹xt
->
	`§ve
();

1094 
g¿phicsCÚ‹xt
->
	`addIÂ”RoundedReùCl
(
	`IÁReù
(
ËáX
, 
ËáY
, 
bÙtomLeá
.
	`width
(è* 2, bÙtomLeá.
	`height
() * 2),

1095 
¡yË
->
	`bÜd”BÙtomWidth
());

1098 ià(
low”LeáBÜd”StyËsM©ch
) {

1099 
fœ¡AngËS¹
 = 180;

1100 
fœ¡AngËS·n
 = 90;

1102 
fœ¡AngËS¹
 = 225;

1103 
fœ¡AngËS·n
 = 45;

1107 
	`d¿wArcFÜBoxSide
(
g¿phicsCÚ‹xt
, 
ËáX
, 
ËáY
, 
thickÃss
, 
bÙtomLeá
, 
fœ¡AngËS¹
, 
fœ¡AngËS·n
,

1108 
BSBÙtom
, 
bÙtomCŞÜ
, 
bÙtomStyË
, 
Œue
);

1109 ià(
­¶yLeáIÂ”Cl
)

1110 
g¿phicsCÚ‹xt
->
	`»¡Üe
();

1113 ià(
bÙtomRight
.
	`width
()) {

1114 
rightY
 = 
ty
 + 
h
 - 
bÙtomRight
.
	`height
() * 2;

1115 
rightX
 = 
tx
 + 
w
 - 
bÙtomRight
.
	`width
() * 2;

1116 
boŞ
 
­¶yRightIÂ”Cl
 = (
¡yË
->
	`bÜd”RightWidth
(è< 
bÙtomRight
.
	`width
())

1117 && (
¡yË
->
	`bÜd”BÙtomWidth
(è< 
bÙtomRight
.
	`height
())

1118 && (
bÙtomStyË
 !ğ
DOUBLE
 || 
¡yË
->
	`bÜd”BÙtomWidth
() > 6);

1119 ià(
­¶yRightIÂ”Cl
) {

1120 
g¿phicsCÚ‹xt
->
	`§ve
();

1121 
g¿phicsCÚ‹xt
->
	`addIÂ”RoundedReùCl
(
	`IÁReù
(
rightX
, 
rightY
, 
bÙtomRight
.
	`width
(è* 2, bÙtomRight.
	`height
() * 2),

1122 
¡yË
->
	`bÜd”BÙtomWidth
());

1125 
£cÚdAngËS¹
 = 270;

1126 
£cÚdAngËS·n
 = 
low”RightBÜd”StyËsM©ch
 ? 90 : 45;

1129 
	`d¿wArcFÜBoxSide
(
g¿phicsCÚ‹xt
, 
rightX
, 
rightY
, 
thickÃss
, 
bÙtomRight
, 
£cÚdAngËS¹
, 
£cÚdAngËS·n
,

1130 
BSBÙtom
, 
bÙtomCŞÜ
, 
bÙtomStyË
, 
çl£
);

1131 ià(
­¶yRightIÂ”Cl
)

1132 
g¿phicsCÚ‹xt
->
	`»¡Üe
();

1137 ià(
»nd”Leá
) {

1138 
boŞ
 
ignÜe_tİ
 = (
»nd”Radii
 && 
tİLeá
.
	`height
() > 0) ||

1139 (
tİCŞÜ
 =ğ
ËáCŞÜ
 && 
tİT¿n¥¬’t
 =ğ
ËáT¿n¥¬’t
 && 
ËáStyË
 >ğ
OUTSET
 &&

1140 (
tİStyË
 =ğ
DOTTED
 ||İStyË =ğ
DASHED
 ||İStyË =ğ
SOLID
 ||İStyË =ğ
OUTSET
));

1142 
boŞ
 
ignÜe_bÙtom
 = (
»nd”Radii
 && 
bÙtomLeá
.
	`height
() > 0) ||

1143 (
bÙtomCŞÜ
 =ğ
ËáCŞÜ
 && 
bÙtomT¿n¥¬’t
 =ğ
ËáT¿n¥¬’t
 && 
ËáStyË
 >ğ
OUTSET
 &&

1144 (
bÙtomStyË
 =ğ
DOTTED
 || bÙtomStyË =ğ
DASHED
 || bÙtomStyË =ğ
SOLID
 || bÙtomStyË =ğ
INSET
));

1146 
y
 = 
ty
;

1147 
y2
 = 
ty
 + 
h
;

1148 ià(
»nd”Radii
) {

1149 
y
 +ğ
tİLeá
.
	`height
();

1150 
y2
 -ğ
bÙtomLeá
.
	`height
();

1153 
	`d¿wLšeFÜBoxSide
(
g¿phicsCÚ‹xt
, 
tx
, 
y
,x + 
¡yË
->
	`bÜd”LeáWidth
(), 
y2
, 
BSLeá
, 
ËáCŞÜ
, 
ËáStyË
,

1154 
ignÜe_tİ
 ? 0 : 
¡yË
->
	`bÜd”TİWidth
(), 
ignÜe_bÙtom
 ? 0 : styË->
	`bÜd”BÙtomWidth
());

1156 ià(
»nd”Radii
 && (!
uµ”LeáBÜd”StyËsM©ch
 || !
low”LeáBÜd”StyËsM©ch
)) {

1157 
tİX
 = 
tx
;

1158 
thickÃss
 = 
¡yË
->
	`bÜd”LeáWidth
() * 2;

1160 ià(!
uµ”LeáBÜd”StyËsM©ch
 && 
tİLeá
.
	`width
()) {

1161 
tİY
 = 
ty
;

1162 
boŞ
 
­¶yTİIÂ”Cl
 = (
¡yË
->
	`bÜd”LeáWidth
(è< 
tİLeá
.
	`width
())

1163 && (
¡yË
->
	`bÜd”TİWidth
(è< 
tİLeá
.
	`height
())

1164 && (
ËáStyË
 !ğ
DOUBLE
 || 
¡yË
->
	`bÜd”LeáWidth
() > 6);

1165 ià(
­¶yTİIÂ”Cl
) {

1166 
g¿phicsCÚ‹xt
->
	`§ve
();

1167 
g¿phicsCÚ‹xt
->
	`addIÂ”RoundedReùCl
(
	`IÁReù
(
tİX
, 
tİY
, 
tİLeá
.
	`width
(è* 2,İLeá.
	`height
() * 2),

1168 
¡yË
->
	`bÜd”LeáWidth
());

1171 
fœ¡AngËS¹
 = 135;

1172 
fœ¡AngËS·n
 = 45;

1175 
	`d¿wArcFÜBoxSide
(
g¿phicsCÚ‹xt
, 
tİX
, 
tİY
, 
thickÃss
, 
tİLeá
, 
fœ¡AngËS¹
, 
fœ¡AngËS·n
,

1176 
BSLeá
, 
ËáCŞÜ
, 
ËáStyË
, 
Œue
);

1177 ià(
­¶yTİIÂ”Cl
)

1178 
g¿phicsCÚ‹xt
->
	`»¡Üe
();

1181 ià(!
low”LeáBÜd”StyËsM©ch
 && 
bÙtomLeá
.
	`width
()) {

1182 
bÙtomY
 = 
ty
 + 
h
 - 
bÙtomLeá
.
	`height
() * 2;

1183 
boŞ
 
­¶yBÙtomIÂ”Cl
 = (
¡yË
->
	`bÜd”LeáWidth
(è< 
bÙtomLeá
.
	`width
())

1184 && (
¡yË
->
	`bÜd”BÙtomWidth
(è< 
bÙtomLeá
.
	`height
())

1185 && (
ËáStyË
 !ğ
DOUBLE
 || 
¡yË
->
	`bÜd”LeáWidth
() > 6);

1186 ià(
­¶yBÙtomIÂ”Cl
) {

1187 
g¿phicsCÚ‹xt
->
	`§ve
();

1188 
g¿phicsCÚ‹xt
->
	`addIÂ”RoundedReùCl
(
	`IÁReù
(
tİX
, 
bÙtomY
, 
bÙtomLeá
.
	`width
(è* 2, bÙtomLeá.
	`height
() * 2),

1189 
¡yË
->
	`bÜd”LeáWidth
());

1192 
£cÚdAngËS¹
 = 180;

1193 
£cÚdAngËS·n
 = 45;

1196 
	`d¿wArcFÜBoxSide
(
g¿phicsCÚ‹xt
, 
tİX
, 
bÙtomY
, 
thickÃss
, 
bÙtomLeá
, 
£cÚdAngËS¹
, 
£cÚdAngËS·n
,

1197 
BSLeá
, 
ËáCŞÜ
, 
ËáStyË
, 
çl£
);

1198 ià(
­¶yBÙtomIÂ”Cl
)

1199 
g¿phicsCÚ‹xt
->
	`»¡Üe
();

1204 ià(
»nd”Right
) {

1205 
boŞ
 
ignÜe_tİ
 = (
»nd”Radii
 && 
tİRight
.
	`height
() > 0) ||

1206 ((
tİCŞÜ
 =ğ
rightCŞÜ
è&& (
tİT¿n¥¬’t
 =ğ
rightT¿n¥¬’t
) &&

1207 (
rightStyË
 >ğ
DOTTED
 ||„ightStyË =ğ
INSET
) &&

1208 (
tİStyË
 =ğ
DOTTED
 ||İStyË =ğ
DASHED
 ||İStyË =ğ
SOLID
 ||İStyË =ğ
OUTSET
));

1210 
boŞ
 
ignÜe_bÙtom
 = (
»nd”Radii
 && 
bÙtomRight
.
	`height
() > 0) ||

1211 ((
bÙtomCŞÜ
 =ğ
rightCŞÜ
è&& (
bÙtomT¿n¥¬’t
 =ğ
rightT¿n¥¬’t
) &&

1212 (
rightStyË
 >ğ
DOTTED
 ||„ightStyË =ğ
INSET
) &&

1213 (
bÙtomStyË
 =ğ
DOTTED
 || bÙtomStyË =ğ
DASHED
 || bÙtomStyË =ğ
SOLID
 || bÙtomStyË =ğ
INSET
));

1215 
y
 = 
ty
;

1216 
y2
 = 
ty
 + 
h
;

1217 ià(
»nd”Radii
) {

1218 
y
 +ğ
tİRight
.
	`height
();

1219 
y2
 -ğ
bÙtomRight
.
	`height
();

1222 
	`d¿wLšeFÜBoxSide
(
g¿phicsCÚ‹xt
, 
tx
 + 
w
 - 
¡yË
->
	`bÜd”RightWidth
(), 
y
,x + w, 
y2
, 
BSRight
, 
rightCŞÜ
, 
rightStyË
,

1223 
ignÜe_tİ
 ? 0 : 
¡yË
->
	`bÜd”TİWidth
(), 
ignÜe_bÙtom
 ? 0 : styË->
	`bÜd”BÙtomWidth
());

1225 ià(
»nd”Radii
 && (!
uµ”RightBÜd”StyËsM©ch
 || !
low”RightBÜd”StyËsM©ch
)) {

1226 
thickÃss
 = 
¡yË
->
	`bÜd”RightWidth
() * 2;

1228 ià(!
uµ”RightBÜd”StyËsM©ch
 && 
tİRight
.
	`width
()) {

1229 
tİX
 = 
tx
 + 
w
 - 
tİRight
.
	`width
() * 2;

1230 
tİY
 = 
ty
;

1231 
boŞ
 
­¶yTİIÂ”Cl
 = (
¡yË
->
	`bÜd”RightWidth
(è< 
tİRight
.
	`width
())

1232 && (
¡yË
->
	`bÜd”TİWidth
(è< 
tİRight
.
	`height
())

1233 && (
rightStyË
 !ğ
DOUBLE
 || 
¡yË
->
	`bÜd”RightWidth
() > 6);

1234 ià(
­¶yTİIÂ”Cl
) {

1235 
g¿phicsCÚ‹xt
->
	`§ve
();

1236 
g¿phicsCÚ‹xt
->
	`addIÂ”RoundedReùCl
(
	`IÁReù
(
tİX
, 
tİY
, 
tİRight
.
	`width
(è* 2,İRight.
	`height
() * 2),

1237 
¡yË
->
	`bÜd”RightWidth
());

1240 
fœ¡AngËS¹
 = 0;

1241 
fœ¡AngËS·n
 = 45;

1244 
	`d¿wArcFÜBoxSide
(
g¿phicsCÚ‹xt
, 
tİX
, 
tİY
, 
thickÃss
, 
tİRight
, 
fœ¡AngËS¹
, 
fœ¡AngËS·n
,

1245 
BSRight
, 
rightCŞÜ
, 
rightStyË
, 
Œue
);

1246 ià(
­¶yTİIÂ”Cl
)

1247 
g¿phicsCÚ‹xt
->
	`»¡Üe
();

1250 ià(!
low”RightBÜd”StyËsM©ch
 && 
bÙtomRight
.
	`width
()) {

1251 
bÙtomX
 = 
tx
 + 
w
 - 
bÙtomRight
.
	`width
() * 2;

1252 
bÙtomY
 = 
ty
 + 
h
 - 
bÙtomRight
.
	`height
() * 2;

1253 
boŞ
 
­¶yBÙtomIÂ”Cl
 = (
¡yË
->
	`bÜd”RightWidth
(è< 
bÙtomRight
.
	`width
())

1254 && (
¡yË
->
	`bÜd”BÙtomWidth
(è< 
bÙtomRight
.
	`height
())

1255 && (
rightStyË
 !ğ
DOUBLE
 || 
¡yË
->
	`bÜd”RightWidth
() > 6);

1256 ià(
­¶yBÙtomIÂ”Cl
) {

1257 
g¿phicsCÚ‹xt
->
	`§ve
();

1258 
g¿phicsCÚ‹xt
->
	`addIÂ”RoundedReùCl
(
	`IÁReù
(
bÙtomX
, 
bÙtomY
, 
bÙtomRight
.
	`width
(è* 2, bÙtomRight.
	`height
() * 2),

1259 
¡yË
->
	`bÜd”RightWidth
());

1262 
£cÚdAngËS¹
 = 315;

1263 
£cÚdAngËS·n
 = 45;

1266 
	`d¿wArcFÜBoxSide
(
g¿phicsCÚ‹xt
, 
bÙtomX
, 
bÙtomY
, 
thickÃss
, 
bÙtomRight
, 
£cÚdAngËS¹
, 
£cÚdAngËS·n
,

1267 
BSRight
, 
rightCŞÜ
, 
rightStyË
, 
çl£
);

1268 ià(
­¶yBÙtomIÂ”Cl
)

1269 
g¿phicsCÚ‹xt
->
	`»¡Üe
();

1274 ià(
»nd”Radii
)

1275 
g¿phicsCÚ‹xt
->
	`»¡Üe
();

1276 
	}
}

1278 
	gR’d”BoxMod–Objeù
::
	$·štBoxShadow
(
G¿phicsCÚ‹xt
* 
cÚ‹xt
, 
tx
, 
ty
, 
w
, 
h
, cÚ¡ 
R’d”StyË
* 
s
, 
ShadowStyË
 
shadowStyË
, 
boŞ
 
begš
, boŞ 
’d
)

1282 ià(
cÚ‹xt
->
	`·štšgDi§bËd
())

1285 
IÁReù
 
	`»ù
(
tx
, 
ty
, 
w
, 
h
);

1286 
IÁSize
 
tİLeá
;

1287 
IÁSize
 
tİRight
;

1288 
IÁSize
 
bÙtomLeá
;

1289 
IÁSize
 
bÙtomRight
;

1291 
boŞ
 
hasBÜd”Radius
 = 
s
->
	`hasBÜd”Radius
();

1292 ià(
hasBÜd”Radius
 && (
begš
 || 
’d
)) {

1293 
IÁSize
 
tİLeáRadius
, 
tİRightRadius
, 
bÙtomLeáRadius
, 
bÙtomRightRadius
;

1294 
s
->
	`g‘BÜd”RadiiFÜReù
(
»ù
, 
tİLeáRadius
, 
tİRightRadius
, 
bÙtomLeáRadius
, 
bÙtomRightRadius
);

1296 ià(
begš
) {

1297 ià(
shadowStyË
 =ğ
In£t
) {

1298 
tİLeáRadius
.
	`ex·nd
(-
	`bÜd”Leá
(), -
	`bÜd”Tİ
());

1299 
tİLeáRadius
.
	`şampNeg©iveToZ”o
();

1300 
bÙtomLeáRadius
.
	`ex·nd
(-
	`bÜd”Leá
(), -
	`bÜd”BÙtom
());

1301 
bÙtomLeáRadius
.
	`şampNeg©iveToZ”o
();

1303 
tİLeá
 = 
tİLeáRadius
;

1304 
bÙtomLeá
 = 
bÙtomLeáRadius
;

1306 ià(
’d
) {

1307 ià(
shadowStyË
 =ğ
In£t
) {

1308 
tİRightRadius
.
	`ex·nd
(-
	`bÜd”Right
(), -
	`bÜd”Tİ
());

1309 
tİRightRadius
.
	`şampNeg©iveToZ”o
();

1310 
bÙtomRightRadius
.
	`ex·nd
(-
	`bÜd”Right
(), -
	`bÜd”BÙtom
());

1311 
bÙtomRightRadius
.
	`şampNeg©iveToZ”o
();

1313 
tİRight
 = 
tİRightRadius
;

1314 
bÙtomRight
 = 
bÙtomRightRadius
;

1318 ià(
shadowStyË
 =ğ
In£t
) {

1319 
»ù
.
	`move
(
begš
 ? 
	`bÜd”Leá
(è: 0, 
	`bÜd”Tİ
());

1320 
»ù
.
	`£tWidth
Ôeù.
	`width
(è- (
begš
 ? 
	`bÜd”Leá
(è: 0è- (
’d
 ? 
	`bÜd”Right
() : 0));

1321 
»ù
.
	`£tHeight
Ôeù.
	`height
(è- 
	`bÜd”Tİ
(è- 
	`bÜd”BÙtom
());

1324 
boŞ
 
hasO·queBackground
 = 
s
->
	`backgroundCŞÜ
().
	`isV®id
(è&& s->backgroundCŞÜ().
	`®pha
() == 255;

1325 cÚ¡ 
ShadowD©a
* 
shadow
 = 
s
->
	`boxShadow
(); shadow; shadow = shadow->
	`Ãxt
()) {

1326 ià(
shadow
->
	`¡yË
(è!ğ
shadowStyË
)

1329 
IÁSize
 
	`shadowOff£t
(
shadow
->
	`x
(), shadow->
	`y
());

1330 
shadowBlur
 = 
shadow
->
	`blur
();

1331 
shadowS´—d
 = 
shadow
->
	`¥»ad
();

1332 cÚ¡ 
CŞÜ
& 
shadowCŞÜ
 = 
shadow
->
	`cŞÜ
();

1334 ià(
shadow
->
	`¡yË
(è=ğ
NÜm®
) {

1335 
IÁReù
 
	`flReù
(
»ù
);

1336 
flReù
.
	`šæ©e
(
shadowS´—d
);

1337 ià(
flReù
.
	`isEm±y
())

1340 
IÁReù
 
	`shadowReù
(
»ù
);

1341 
shadowReù
.
	`šæ©e
(
shadowBlur
 + 
shadowS´—d
);

1342 
shadowReù
.
	`move
(
shadowOff£t
);

1344 
cÚ‹xt
->
	`§ve
();

1345 
cÚ‹xt
->
	`ş
(
shadowReù
);

1349 
IÁSize
 
	`exŒaOff£t
(
w
 + 
	`max
(0, 
shadowOff£t
.
	`width
()è+ 
shadowBlur
 + 2 * 
shadowS´—d
 + 1, 0);

1350 
shadowOff£t
 -ğ
exŒaOff£t
;

1351 
flReù
.
	`move
(
exŒaOff£t
);

1353 
cÚ‹xt
->
	`£tShadow
(
shadowOff£t
, 
shadowBlur
, 
shadowCŞÜ
, 
s
->
	`cŞÜS·û
());

1354 ià(
hasBÜd”Radius
) {

1355 
IÁReù
 
»ùToClOut
 = 
»ù
;

1356 
IÁSize
 
tİLeáToClOut
 = 
tİLeá
;

1357 
IÁSize
 
tİRightToClOut
 = 
tİRight
;

1358 
IÁSize
 
bÙtomLeáToClOut
 = 
bÙtomLeá
;

1359 
IÁSize
 
bÙtomRightToClOut
 = 
bÙtomRight
;

1361 ià(
shadowS´—d
 < 0) {

1362 
tİLeá
.
	`ex·nd
(
shadowS´—d
, shadowSpread);

1363 
tİLeá
.
	`şampNeg©iveToZ”o
();

1365 
tİRight
.
	`ex·nd
(
shadowS´—d
, shadowSpread);

1366 
tİRight
.
	`şampNeg©iveToZ”o
();

1368 
bÙtomLeá
.
	`ex·nd
(
shadowS´—d
, shadowSpread);

1369 
bÙtomLeá
.
	`şampNeg©iveToZ”o
();

1371 
bÙtomRight
.
	`ex·nd
(
shadowS´—d
, shadowSpread);

1372 
bÙtomRight
.
	`şampNeg©iveToZ”o
();

1378 ià(
hasO·queBackground
) {

1379 
»ùToClOut
.
	`šæ©e
(-1);

1381 
tİLeáToClOut
.
	`ex·nd
(-1, -1);

1382 
tİLeáToClOut
.
	`şampNeg©iveToZ”o
();

1384 
tİRightToClOut
.
	`ex·nd
(-1, -1);

1385 
tİRightToClOut
.
	`şampNeg©iveToZ”o
();

1387 
bÙtomLeáToClOut
.
	`ex·nd
(-1, -1);

1388 
bÙtomLeáToClOut
.
	`şampNeg©iveToZ”o
();

1390 
bÙtomRightToClOut
.
	`ex·nd
(-1, -1);

1391 
bÙtomRightToClOut
.
	`şampNeg©iveToZ”o
();

1394 ià(!
»ùToClOut
.
	`isEm±y
())

1395 
cÚ‹xt
->
	`şOutRoundedReù
(
»ùToClOut
, 
tİLeáToClOut
, 
tİRightToClOut
, 
bÙtomLeáToClOut
, 
bÙtomRightToClOut
);

1396 
cÚ‹xt
->
	`flRoundedReù
(
flReù
, 
tİLeá
, 
tİRight
, 
bÙtomLeá
, 
bÙtomRight
, 
CŞÜ
::
bÏck
, 
s
->
	`cŞÜS·û
());

1398 
IÁReù
 
»ùToClOut
 = 
»ù
;

1404 ià(
hasO·queBackground
) {

1405 
AffšeT¿nsfÜm
 
cu¼’tT¿nsfÜm©iÚ
 = 
cÚ‹xt
->
	`g‘CTM
();

1406 ià(
cu¼’tT¿nsfÜm©iÚ
.
	`a
(è!ğ1 || (cu¼’tT¿nsfÜm©iÚ.
	`d
() != 1 && currentTransformation.d() != -1)

1407 || 
cu¼’tT¿nsfÜm©iÚ
.
	`b
(è|| cu¼’tT¿nsfÜm©iÚ.
	`c
())

1408 
»ùToClOut
.
	`šæ©e
(-1);

1411 ià(!
»ùToClOut
.
	`isEm±y
())

1412 
cÚ‹xt
->
	`şOut
(
»ùToClOut
);

1413 
cÚ‹xt
->
	`flReù
(
flReù
, 
CŞÜ
::
bÏck
, 
s
->
	`cŞÜS·û
());

1416 
cÚ‹xt
->
	`»¡Üe
();

1419 
IÁReù
 
	`hŞeReù
(
»ù
);

1420 
hŞeReù
.
	`šæ©e
(-
shadowS´—d
);

1422 ià(
hŞeReù
.
	`isEm±y
()) {

1423 ià(
hasBÜd”Radius
)

1424 
cÚ‹xt
->
	`flRoundedReù
(
»ù
, 
tİLeá
, 
tİRight
, 
bÙtomLeá
, 
bÙtomRight
, 
shadowCŞÜ
, 
s
->
	`cŞÜS·û
());

1426 
cÚ‹xt
->
	`flReù
(
»ù
, 
shadowCŞÜ
, 
s
->
	`cŞÜS·û
());

1429 ià(!
begš
) {

1430 
hŞeReù
.
	`move
(-
	`max
(
shadowOff£t
.
	`width
(), 0è- 
shadowBlur
, 0);

1431 
hŞeReù
.
	`£tWidth
(hŞeReù.
	`width
(è+ 
	`max
(
shadowOff£t
.width(), 0è+ 
shadowBlur
);

1433 ià(!
’d
)

1434 
hŞeReù
.
	`£tWidth
(hŞeReù.
	`width
(è- 
	`mš
(
shadowOff£t
.width(), 0è+ 
shadowBlur
);

1436 
CŞÜ
 
	`flCŞÜ
(
shadowCŞÜ
.
	`»d
(), shadowCŞÜ.
	`g»’
(), shadowCŞÜ.
	`blue
(), 255);

1438 
IÁReù
 
	`ou‹rReù
(
»ù
);

1439 
ou‹rReù
.
	`šæ©eX
(
w
 - 2 * 
shadowS´—d
);

1440 
ou‹rReù
.
	`šæ©eY
(
h
 - 2 * 
shadowS´—d
);

1442 
cÚ‹xt
->
	`§ve
();

1444 ià(
hasBÜd”Radius
)

1445 
cÚ‹xt
->
	`ş
(
P©h
::
	`ü—‹RoundedReùªgË
(
»ù
, 
tİLeá
, 
tİRight
, 
bÙtomLeá
, 
bÙtomRight
));

1447 
cÚ‹xt
->
	`ş
(
»ù
);

1449 
IÁSize
 
	`exŒaOff£t
(2 * 
w
 + 
	`max
(0, 
shadowOff£t
.
	`width
()è+ 
shadowBlur
 - 2 * 
shadowS´—d
 + 1, 0);

1450 
cÚ‹xt
->
	`Œª¦©e
(
exŒaOff£t
.
	`width
(),ƒxŒaOff£t.
	`height
());

1451 
shadowOff£t
 -ğ
exŒaOff£t
;

1453 
cÚ‹xt
->
	`begšP©h
();

1454 
cÚ‹xt
->
	`addP©h
(
P©h
::
	`ü—‹ReùªgË
(
ou‹rReù
));

1456 ià(
hasBÜd”Radius
) {

1457 ià(
shadowS´—d
 > 0) {

1458 
tİLeá
.
	`ex·nd
(-
shadowS´—d
, -shadowSpread);

1459 
tİLeá
.
	`şampNeg©iveToZ”o
();

1461 
tİRight
.
	`ex·nd
(-
shadowS´—d
, -shadowSpread);

1462 
tİRight
.
	`şampNeg©iveToZ”o
();

1464 
bÙtomLeá
.
	`ex·nd
(-
shadowS´—d
, -shadowSpread);

1465 
bÙtomLeá
.
	`şampNeg©iveToZ”o
();

1467 
bÙtomRight
.
	`ex·nd
(-
shadowS´—d
, -shadowSpread);

1468 
bÙtomRight
.
	`şampNeg©iveToZ”o
();

1470 
cÚ‹xt
->
	`addP©h
(
P©h
::
	`ü—‹RoundedReùªgË
(
hŞeReù
, 
tİLeá
, 
tİRight
, 
bÙtomLeá
, 
bÙtomRight
));

1472 
cÚ‹xt
->
	`addP©h
(
P©h
::
	`ü—‹ReùªgË
(
hŞeReù
));

1474 
cÚ‹xt
->
	`£tFlRuË
(
RULE_EVENODD
);

1475 
cÚ‹xt
->
	`£tFlCŞÜ
(
flCŞÜ
, 
s
->
	`cŞÜS·û
());

1476 
cÚ‹xt
->
	`£tShadow
(
shadowOff£t
, 
shadowBlur
, 
shadowCŞÜ
, 
s
->
	`cŞÜS·û
());

1477 
cÚ‹xt
->
	`flP©h
();

1479 
cÚ‹xt
->
	`»¡Üe
();

1482 
	}
}

1484 
	gR’d”BoxMod–Objeù
::
	$cÚššgBlockWidthFÜCÚ‹Á
() const

1486  
	`cÚššgBlock
()->
	`avaabËWidth
();

1487 
	}
}

	@RenderBoxModelObject.h

23 #iâdeà
R’d”BoxMod–Objeù_h


24 
	#R’d”BoxMod–Objeù_h


	)

26 
	~"R’d”Objeù.h
"

28 
Çme¥aû
 
	gWebCÜe
 {

31 cÚ¡ 
	gPos™iÚTİ
 = -0x7fffffff;

32 cÚ¡ 
	gPos™iÚBÙtom
 = 0x7fffffff;

33 cÚ¡ 
	gPos™iÚUndefšed
 = 0x80000000;

38 şas 
	cR’d”BoxMod–Objeù
 : 
public
 
R’d”Objeù
 {

39 
public
:

40 
R’d”BoxMod–Objeù
(
Node
*);

41 
	gvœtu®
 ~
R’d”BoxMod–Objeù
();

43 
vœtu®
 
de¡roy
();

45 
»ÏtivePos™iÚOff£tX
() const;

46 
»ÏtivePos™iÚOff£tY
() const;

47 
IÁSize
 
»ÏtivePos™iÚOff£t
(ècÚ¡ {  IÁSize(
»ÏtivePos™iÚOff£tX
(), 
»ÏtivePos™iÚOff£tY
()); }

51 
vœtu®
 
off£tLeá
() const;

52 
vœtu®
 
off£tTİ
() const;

53 
vœtu®
 
off£tWidth
() const = 0;

54 
vœtu®
 
off£tHeight
() const = 0;

56 
vœtu®
 
¡yËWlChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
* 
ÃwStyË
);

57 
vœtu®
 
¡yËDidChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
);

58 
vœtu®
 
upd©eBoxMod–InfoFromStyË
();

60 
boŞ
 
hasS–fPaštšgLay”
() const;

61 
R’d”Lay”
* 
Ïy”
(ècÚ¡ {  
	gm_Ïy”
; }

62 
vœtu®
 
boŞ
 
»quœesLay”
(ècÚ¡ {  
isRoÙ
(è|| 
isPos™iÚed
(è|| 
isR–Pos™iÚed
(è|| 
isT¿n¥¬’t
(è|| 
hasOv”æowCl
(è|| 
hasT¿nsfÜm
(è|| 
hasMask
(è|| 
hasReæeùiÚ
(); }

65 
vœtu®
 
IÁReù
 
bÜd”BoundšgBox
() const = 0;

68 
vœtu®
 
·ddšgTİ
(
boŞ
 
šşudeIÁršsicPaddšg
 = 
Œue
) const;

69 
vœtu®
 
·ddšgBÙtom
(
boŞ
 
šşudeIÁršsicPaddšg
 = 
Œue
) const;

70 
vœtu®
 
·ddšgLeá
(
boŞ
 
šşudeIÁršsicPaddšg
 = 
Œue
) const;

71 
vœtu®
 
·ddšgRight
(
boŞ
 
šşudeIÁršsicPaddšg
 = 
Œue
) const;

73 
vœtu®
 
bÜd”Tİ
(ècÚ¡ {  
¡yË
()->
bÜd”TİWidth
(); }

74 
vœtu®
 
bÜd”BÙtom
(ècÚ¡ {  
¡yË
()->
bÜd”BÙtomWidth
(); }

75 
vœtu®
 
bÜd”Leá
(ècÚ¡ {  
¡yË
()->
bÜd”LeáWidth
(); }

76 
vœtu®
 
bÜd”Right
(ècÚ¡ {  
¡yË
()->
bÜd”RightWidth
(); }

78 
vœtu®
 
m¬gšTİ
() const = 0;

79 
vœtu®
 
m¬gšBÙtom
() const = 0;

80 
vœtu®
 
m¬gšLeá
() const = 0;

81 
vœtu®
 
m¬gšRight
() const = 0;

83 
boŞ
 
hasHÜizÚlBÜd”sPaddšgOrM¬gš
(ècÚ¡ {  
hasHÜizÚlBÜd”sOrPaddšg
(è|| 
m¬gšLeá
(è!ğ0 || 
m¬gšRight
() != 0; }

84 
boŞ
 
hasHÜizÚlBÜd”sOrPaddšg
(ècÚ¡ {  
bÜd”Leá
(è!ğ0 || 
bÜd”Right
(è!ğ0 || 
·ddšgLeá
(è!ğ0 || 
·ddšgRight
() != 0; }

86 
vœtu®
 
cÚššgBlockWidthFÜCÚ‹Á
() const;

88 
vœtu®
 
chdBeÿmeNÚIÆše
(
R’d”Objeù
* ) { }

90 
·štBÜd”
(
G¿phicsCÚ‹xt
*, 
tx
, 
ty
, 
w
, 
h
, cÚ¡ 
R’d”StyË
*, 
boŞ
 
begš
 = 
Œue
, boŞ 
’d
 =rue);

91 
boŞ
 
·štNšeP›ûImage
(
G¿phicsCÚ‹xt
*, 
tx
, 
ty
, 
w
, 
h
, cÚ¡ 
R’d”StyË
*, cÚ¡ 
NšeP›ûImage
&, 
Compos™eO³¿tÜ
 = 
Compos™eSourûOv”
);

92 
·štBoxShadow
(
G¿phicsCÚ‹xt
*, 
tx
, 
ty
, 
w
, 
h
, cÚ¡ 
R’d”StyË
*, 
ShadowStyË
, 
boŞ
 
begš
 = 
Œue
, boŞ 
’d
 =rue);

93 
·štFlLay”Ex‹nded
(cÚ¡ 
PaštInfo
&, cÚ¡ 
CŞÜ
&, cÚ¡ 
FlLay”
*, 
tx
, 
ty
, 
width
, 
height
, 
IÆšeFlowBox
* = 0, 
Compos™eO³¿tÜ
 = 
Compos™eSourûOv”
, 
R’d”Objeù
* 
backgroundObjeù
 = 0);

96 
v”tiÿlPos™iÚ
(
boŞ
 
fœ¡Lše
) const;

99 
de¡royLay”
();

101 
highQu®™yR•aštTim”Fœed
(
Tim”
<
R’d”BoxMod–Objeù
>*);

103 
	g´Ùeùed
:

104 
ÿlcuÏ‹BackgroundImageGeom‘ry
(cÚ¡ 
FlLay”
*, 
tx
, 
ty
, 
w
, 
h
, 
IÁReù
& 
de¡Reù
, 
IÁPošt
& 
pha£
, 
IÁSize
& 
teSize
);

106 
	g´iv©e
:

107 
vœtu®
 
boŞ
 
isBoxMod–Objeù
(ècÚ¡ {  
Œue
; }

109 
IÁSize
 
ÿlcuÏ‹FlTeSize
(cÚ¡ 
FlLay”
*, IÁSiz
sÿËdSize
) const;

111 
ä›nd
 
şass
 
	gR’d”V›w
;

113 
R’d”Lay”
* 
	gm_Ïy”
;

116 
boŞ
 
	gs_wasFlßtšg
;

117 
boŞ
 
	gs_hadLay”
;

118 
boŞ
 
	gs_Ïy”WasS–fPaštšg
;

121 
šlše
 
R’d”BoxMod–Objeù
* 
	$toR’d”BoxMod–Objeù
(
R’d”Objeù
* 
objeù
)

123 
	`ASSERT
(!
objeù
 || objeù->
	`isBoxMod–Objeù
());

124  
¡©ic_ÿ¡
<
R’d”BoxMod–Objeù
*>(
objeù
);

125 
	}
}

127 
šlše
 cÚ¡ 
R’d”BoxMod–Objeù
* 
	$toR’d”BoxMod–Objeù
(cÚ¡ 
R’d”Objeù
* 
objeù
)

129 
	`ASSERT
(!
objeù
 || objeù->
	`isBoxMod–Objeù
());

130  
¡©ic_ÿ¡
<cÚ¡ 
R’d”BoxMod–Objeù
*>(
objeù
);

131 
	}
}

134 
toR’d”BoxMod–Objeù
(cÚ¡ 
R’d”BoxMod–Objeù
*);

	@RenderButton.cpp

21 
	~"cÚfig.h
"

22 
	~"R’d”Bu‰Ú.h
"

24 
	~"Docum’t.h
"

25 
	~"G¿phicsCÚ‹xt.h
"

26 
	~"HTMLIÅutEËm’t.h
"

27 
	~"HTMLNames.h
"

28 
	~"R’d”TextF¿gm’t.h
"

29 
	~"R’d”Theme.h
"

31 #ià
ENABLE
(
WML
)

32 
	~"WMLDoEËm’t.h
"

33 
	~"WMLNames.h
"

36 
Çme¥aû
 
	gWebCÜe
 {

38 
usšg
 
Çme¥aû
 
	gHTMLNames
;

40 
	gR’d”Bu‰Ú
::
R’d”Bu‰Ú
(
Node
* 
node
)

41 : 
R’d”FËxibËBox
(
node
)

42 , 
m_bu‰ÚText
(0)

43 , 
m_šÃr
(0)

44 , 
m_deçuÉ
(
çl£
)

48 
	gR’d”Bu‰Ú
::
addChd
(
R’d”Objeù
* 
ÃwChd
, R’d”Objeù* 
befÜeChd
)

50 ià(!
	gm_šÃr
) {

52 
ASSERT
(!
fœ¡Chd
());

53 
boŞ
 
	gisFËxibËBox
 = 
¡yË
()->
di¥Ïy
(è=ğ
BOX
 || styË()->di¥Ïy(è=ğ
INLINE_BOX
;

54 
	gm_šÃr
 = 
ü—‹AnÚymousBlock
(
isFËxibËBox
);

55 
£tupIÂ”StyË
(
m_šÃr
->
¡yË
());

56 
	gR’d”FËxibËBox
::
addChd
(
m_šÃr
);

59 
	gm_šÃr
->
addChd
(
ÃwChd
, 
befÜeChd
);

62 
	gR’d”Bu‰Ú
::
»moveChd
(
R’d”Objeù
* 
ŞdChd
)

64 ià(
ŞdChd
 =ğ
m_šÃr
 || !m_inner) {

65 
R’d”FËxibËBox
::
»moveChd
(
ŞdChd
);

66 
	gm_šÃr
 = 0;

68 
	gm_šÃr
->
»moveChd
(
ŞdChd
);

71 
	gR’d”Bu‰Ú
::
¡yËWlChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ÃwStyË
)

73 ià(
	gm_šÃr
) {

78 
	gm_šÃr
->
¡yË
()->
£tBoxFËx
(0);

80 
	gR’d”Block
::
¡yËWlChªge
(
diff
, 
ÃwStyË
);

83 
	gR’d”Bu‰Ú
::
¡yËDidChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
)

85 
	gR’d”Block
::
¡yËDidChªge
(
diff
, 
ŞdStyË
);

87 ià(
	gm_bu‰ÚText
)

88 
	gm_bu‰ÚText
->
£tStyË
(
¡yË
());

89 ià(
	gm_šÃr
)

90 
£tupIÂ”StyË
(
m_šÃr
->
¡yË
());

91 
£tR•Ïûd
(
isIÆše
());

93 ià(!
	gm_deçuÉ
 && 
theme
()->
isDeçuÉ
(
this
)) {

94 ià(!
	gm_tim”
)

95 
	gm_tim”
.
£t
(
Ãw
 
Tim”
<
R’d”Bu‰Ú
>(
this
, &R’d”Bu‰Ú::
tim”Fœed
));

96 
	gm_tim”
->
¡¬tR•—tšg
(0.03);

97 
	gm_deçuÉ
 = 
Œue
;

98 } ià(
	gm_deçuÉ
 && !
theme
()->
isDeçuÉ
(
this
)) {

99 
	gm_deçuÉ
 = 
çl£
;

100 
	gm_tim”
.
ş—r
();

104 
	gR’d”Bu‰Ú
::
£tupIÂ”StyË
(
R’d”StyË
* 
šÃrStyË
)

106 
ASSERT
(
šÃrStyË
->
»fCouÁ
() == 1);

109 
	gšÃrStyË
->
£tBoxFËx
(1.0f);

110 
	gšÃrStyË
->
£tBoxOr›Á
(
¡yË
()->
boxOr›Á
());

112 
	gšÃrStyË
->
£tPaddšgTİ
(
L’gth
(
theme
()->
bu‰ÚIÁ”ÇlPaddšgTİ
(), 
Fixed
));

113 
	gšÃrStyË
->
£tPaddšgRight
(
L’gth
(
theme
()->
bu‰ÚIÁ”ÇlPaddšgRight
(), 
Fixed
));

114 
	gšÃrStyË
->
£tPaddšgBÙtom
(
L’gth
(
theme
()->
bu‰ÚIÁ”ÇlPaddšgBÙtom
(), 
Fixed
));

115 
	gšÃrStyË
->
£tPaddšgLeá
(
L’gth
(
theme
()->
bu‰ÚIÁ”ÇlPaddšgLeá
(), 
Fixed
));

118 
	gR’d”Bu‰Ú
::
upd©eFromEËm’t
()

121 ià(
node
()->
hasTagName
(
šputTag
)) {

122 
HTMLIÅutEËm’t
* 
šput
 = 
¡©ic_ÿ¡
<HTMLIÅutEËm’t*>(
node
());

123 
SŒšg
 
	gv®ue
 = 
šput
->
v®ueW™hDeçuÉ
();

124 
£tText
(
v®ue
);

128 #ià
ENABLE
(
WML
)

129 ià(
node
()->
hasTagName
(
WMLNames
::
doTag
)) {

130 
WMLDoEËm’t
* 
doEËm’t
 = 
¡©ic_ÿ¡
<WMLDoEËm’t*>(
node
());

132 
SŒšg
 
	gv®ue
 = 
doEËm’t
->
Ïb–
();

133 ià(
	gv®ue
.
isEm±y
())

134 
	gv®ue
 = 
doEËm’t
->
Çme
();

136 
£tText
(
v®ue
);

141 
boŞ
 
	gR’d”Bu‰Ú
::
ÿnHaveChd»n
() const

146  !
node
()->
hasTagName
(
šputTag
);

149 
	gR’d”Bu‰Ú
::
£tText
(cÚ¡ 
SŒšg
& 
¡r
)

151 ià(
¡r
.
isEm±y
()) {

152 ià(
m_bu‰ÚText
) {

153 
m_bu‰ÚText
->
de¡roy
();

154 
	gm_bu‰ÚText
 = 0;

157 ià(
	gm_bu‰ÚText
)

158 
	gm_bu‰ÚText
->
£tText
(
¡r
.
im¶
());

160 
	gm_bu‰ÚText
 = 
Ãw
 (
»nd”A»Ç
()è
R’d”TextF¿gm’t
(
docum’t
(), 
¡r
.
im¶
());

161 
	gm_bu‰ÚText
->
£tStyË
(
¡yË
());

162 
addChd
(
m_bu‰ÚText
);

167 
SŒšg
 
	gR’d”Bu‰Ú
::
‹xt
() const

169  
m_bu‰ÚText
 ? m_bu‰ÚText->
‹xt
() : 0;

172 
	gR’d”Bu‰Ú
::
upd©eBefÜeAá”CÚ‹Á
(
P£udoId
 
ty³
)

174 ià(
m_šÃr
)

175 
m_šÃr
->
chd»n
()->
upd©eBefÜeAá”CÚ‹Á
(m_šÃr, 
ty³
, 
this
);

177 
chd»n
()->
upd©eBefÜeAá”CÚ‹Á
(
this
, 
ty³
);

180 
IÁReù
 
	gR’d”Bu‰Ú
::
cÚŒŞClReù
(
tx
, 
ty
) const

183  
IÁReù
(
tx
 + 
bÜd”Leá
(), 
ty
 + 
bÜd”Tİ
(), 
width
(è- bÜd”Leá(è- 
bÜd”Right
(), 
height
(è- bÜd”Tİ(è- 
bÜd”BÙtom
());

186 
	gR’d”Bu‰Ú
::
tim”Fœed
(
Tim”
<
R’d”Bu‰Ú
>*)

192 ià(
docum’t
()->
šPageCache
())

195 
»·št
();

	@RenderButton.h

21 #iâdeà
R’d”Bu‰Ú_h


22 
	#R’d”Bu‰Ú_h


	)

24 
	~"R’d”FËxibËBox.h
"

25 
	~"Tim”.h
"

26 
	~<wtf/OwnPŒ.h
>

28 
Çme¥aû
 
	gWebCÜe
 {

30 
şass
 
	gR’d”TextF¿gm’t
;

35 şas 
	cR’d”Bu‰Ú
 : 
public
 
R’d”FËxibËBox
 {

36 
public
:

37 
R’d”Bu‰Ú
(
Node
*);

39 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderButton"; }

40 
vœtu®
 
boŞ
 
isR’d”Bu‰Ú
(ècÚ¡ {  
	gŒue
; }

42 
vœtu®
 
addChd
(
R’d”Objeù
* 
ÃwChd
, R’d”Objeù *
befÜeChd
 = 0);

43 
vœtu®
 
»moveChd
(
R’d”Objeù
*);

44 
vœtu®
 
»moveLeáov”AnÚymousBlock
(
R’d”Block
*) { }

45 
vœtu®
 
boŞ
 
ü—‹sAnÚymousW¿µ”
(ècÚ¡ {  
	gŒue
; }

47 
£tupIÂ”StyË
(
R’d”StyË
*);

48 
vœtu®
 
upd©eFromEËm’t
();

50 
vœtu®
 
upd©eBefÜeAá”CÚ‹Á
(
P£udoId
);

52 
vœtu®
 
boŞ
 
hasCÚŒŞCl
(ècÚ¡ {  
	gŒue
; }

53 
vœtu®
 
IÁReù
 
cÚŒŞClReù
(, ) const;

55 
£tText
(cÚ¡ 
SŒšg
&);

56 
SŒšg
 
‹xt
() const;

58 
vœtu®
 
boŞ
 
ÿnHaveChd»n
() const;

60 
	g´Ùeùed
:

61 
vœtu®
 
¡yËWlChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
* 
ÃwStyË
);

62 
vœtu®
 
¡yËDidChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
);

64 
vœtu®
 
boŞ
 
hasLšeIfEm±y
(ècÚ¡ {  
	gŒue
; }

66 
tim”Fœed
(
Tim”
<
R’d”Bu‰Ú
>*);

68 
R’d”TextF¿gm’t
* 
	gm_bu‰ÚText
;

69 
R’d”Block
* 
	gm_šÃr
;

71 
	gOwnPŒ
<
	gTim”
<
	gR’d”Bu‰Ú
> > 
	gm_tim”
;

72 
boŞ
 
	gm_deçuÉ
;

75 
šlše
 
R’d”Bu‰Ú
* 
	$toR’d”Bu‰Ú
(
R’d”Objeù
* 
objeù
)

77 
	`ASSERT
(!
objeù
 || objeù->
	`isR’d”Bu‰Ú
());

78  
¡©ic_ÿ¡
<
R’d”Bu‰Ú
*>(
objeù
);

79 
	}
}

81 
šlše
 cÚ¡ 
R’d”Bu‰Ú
* 
	$toR’d”Bu‰Ú
(cÚ¡ 
R’d”Objeù
* 
objeù
)

83 
	`ASSERT
(!
objeù
 || objeù->
	`isR’d”Bu‰Ú
());

84  
¡©ic_ÿ¡
<cÚ¡ 
R’d”Bu‰Ú
*>(
objeù
);

85 
	}
}

88 
toR’d”Bu‰Ú
(cÚ¡ 
R’d”Bu‰Ú
*);

	@RenderCounter.cpp

22 
	~"cÚfig.h
"

23 
	~"R’d”CouÁ”.h
"

25 
	~"CouÁ”Node.h
"

26 
	~"Docum’t.h
"

27 
	~"HTMLNames.h
"

28 
	~"HTMLOLi¡EËm’t.h
"

29 
	~"R’d”Li¡I‹m.h
"

30 
	~"R’d”Li¡M¬k”.h
"

31 
	~"R’d”StyË.h
"

32 
	~<wtf/StdLibExŒas.h
>

34 
Çme¥aû
 
	gWebCÜe
 {

36 
usšg
 
Çme¥aû
 
	gHTMLNames
;

38 
	gHashM­
<
	tRefPŒ
<
	tAtomicSŒšgIm¶
>, 
	tCouÁ”Node
*> 
	tCouÁ”M­
;

39 
	gHashM­
<cÚ¡ 
	tR’d”Objeù
*, 
	tCouÁ”M­
*> 
	tCouÁ”M­s
;

41 
CouÁ”Node
* 
makeCouÁ”Node
(
R’d”Objeù
*, cÚ¡ 
AtomicSŒšg
& 
id’tif›r
, 
boŞ
 
®waysC»©eCouÁ”
);

43 
	gCouÁ”M­s
& 
couÁ”M­s
()

45 
DEFINE_STATIC_LOCAL
(
CouÁ”M­s
, 
¡©icCouÁ”M­s
, ());

46  
	g¡©icCouÁ”M­s
;

49 
šlše
 
R’d”Objeù
* 
´eviousSiblšgOrP¬’t
(R’d”Objeù* 
objeù
)

51 ià(
R’d”Objeù
* 
	gsiblšg
 = 
objeù
->
´eviousSiblšg
())

52  
siblšg
;

53  
	gobjeù
->
·»Á
();

56 
boŞ
 
¶ªCouÁ”
(
R’d”Objeù
* 
objeù
, cÚ¡ 
AtomicSŒšg
& 
id’tif›r
, boŞ& 
isRe£t
, & 
v®ue
)

58 
ASSERT
(
objeù
);

62 ià(
	gobjeù
->
isText
(è&& !objeù->
isBR
())

63  
	gçl£
;

65 
R’d”StyË
* 
	g¡yË
 = 
objeù
->
¡yË
();

66 
ASSERT
(
¡yË
);

68 ià(cÚ¡ 
CouÁ”DœeùiveM­
* 
	gdœeùivesM­
 = 
¡yË
->
couÁ”Dœeùives
()) {

69 
CouÁ”Dœeùives
 
dœeùives
 = 
dœeùivesM­
->
g‘
(
id’tif›r
.
im¶
());

70 ià(
	gdœeùives
.
	gm_»£t
) {

71 
	gv®ue
 = 
dœeùives
.
m_»£tV®ue
;

72 ià(
	gdœeùives
.
	gm_šüem’t
)

73 
	gv®ue
 +ğ
dœeùives
.
m_šüem’tV®ue
;

74 
	gisRe£t
 = 
Œue
;

75  
	gŒue
;

77 ià(
	gdœeùives
.
	gm_šüem’t
) {

78 
	gv®ue
 = 
dœeùives
.
m_šüem’tV®ue
;

79 
	gisRe£t
 = 
çl£
;

80  
	gŒue
;

84 ià(
	gid’tif›r
 == "list-item") {

85 ià(
objeù
->
isLi¡I‹m
()) {

86 ià(
toR’d”Li¡I‹m
(
objeù
)->
hasEx¶ic™V®ue
()) {

87 
v®ue
 = 
toR’d”Li¡I‹m
(
objeù
)->
ex¶ic™V®ue
();

88 
	gisRe£t
 = 
Œue
;

89  
	gŒue
;

91 
	gv®ue
 = 1;

92 
	gisRe£t
 = 
çl£
;

93  
	gŒue
;

95 ià(
Node
* 
	ge
 = 
objeù
->
node
()) {

96 ià(
e
->
hasTagName
(
ŞTag
)) {

97 
v®ue
 = 
¡©ic_ÿ¡
<
HTMLOLi¡EËm’t
*>(
e
)->
¡¬t
();

98 
	gisRe£t
 = 
Œue
;

99  
	gŒue
;

101 ià(
	ge
->
hasTagName
(
ulTag
è||ƒ->hasTagName(
m’uTag
è||ƒ->hasTagName(
dœTag
)) {

102 
	gv®ue
 = 0;

103 
	gisRe£t
 = 
Œue
;

104  
	gŒue
;

109  
	gçl£
;

128 
boŞ
 
fšdPÏûFÜCouÁ”
(
R’d”Objeù
* 
couÁ”OwÃr
, cÚ¡ 
AtomicSŒšg
& 
id’tif›r
, boŞ 
isRe£t
, 
CouÁ”Node
*& 
·»Á
, CouÁ”Node*& 
´eviousSiblšg
)

132 
R’d”Objeù
* 
	g£¬chEndR’d””
 = 
´eviousSiblšgOrP¬’t
(
couÁ”OwÃr
);

136 
R’d”Objeù
* 
	gcu¼’tR’d””
 = 
couÁ”OwÃr
->
´eviousInP»Ord”
();

137 
	g´eviousSiblšg
 = 0;

138 
	gcu¼’tR’d””
) {

139 
CouÁ”Node
* 
	gcu¼’tCouÁ”
 = 
makeCouÁ”Node
(
cu¼’tR’d””
, 
id’tif›r
, 
çl£
);

140 ià(
	g£¬chEndR’d””
 =ğ
cu¼’tR’d””
) {

142 ià(
cu¼’tCouÁ”
) {

144 ià(
´eviousSiblšg
) {

145 ià(
cu¼’tCouÁ”
->
aùsAsRe£t
()) {

147 ià(
isRe£t
 && 
cu¼’tR’d””
->
·»Á
(è=ğ
couÁ”OwÃr
->parent()) {

151 
·»Á
 = 
cu¼’tCouÁ”
->parent();

152 
	g´eviousSiblšg
 = 
·»Á
 ? 
cu¼’tCouÁ”
 : 0;

153  
	g·»Á
;

157 
	g·»Á
 = 
cu¼’tCouÁ”
;

158 
ASSERT
(
´eviousSiblšg
->
·»Á
(è=ğ
cu¼’tCouÁ”
);

159  
	gŒue
;

162 ià(!
	gisRe£t
 || 
	gcu¼’tR’d””
->
·»Á
(è!ğ
couÁ”OwÃr
->parent()) {

165 
ASSERT
(
cu¼’tCouÁ”
->
·»Á
(è=ğ
´eviousSiblšg
->parent());

166 
	g·»Á
 = 
cu¼’tCouÁ”
->
·»Á
();

167  
	gŒue
;

174 ià(
	gcu¼’tCouÁ”
->
aùsAsRe£t
()) {

175 ià(
	gisRe£t
 && 
	gcu¼’tR’d””
->
·»Á
(è=ğ
couÁ”OwÃr
->parent()) {

176 
·»Á
 = 
cu¼’tCouÁ”
->parent();

177 
	g´eviousSiblšg
 = 
cu¼’tCouÁ”
;

178  
	g·»Á
;

180 
	g·»Á
 = 
cu¼’tCouÁ”
;

181  
	gŒue
;

183 ià(!
	gisRe£t
 || 
	gcu¼’tR’d””
->
·»Á
(è!ğ
couÁ”OwÃr
->parent()) {

184 
·»Á
 = 
cu¼’tCouÁ”
->parent();

185 
	g´eviousSiblšg
 = 
cu¼’tCouÁ”
;

186  
	gŒue
;

188 
	g´eviousSiblšg
 = 
cu¼’tCouÁ”
;

195 
	g£¬chEndR’d””
 = 
´eviousSiblšgOrP¬’t
(
cu¼’tR’d””
);

199 ià(
	gcu¼’tCouÁ”
) {

201 ià(
	g´eviousSiblšg
) {

204 ià(
	gcu¼’tCouÁ”
->
aùsAsRe£t
()) {

205 
	g´eviousSiblšg
 = 
cu¼’tCouÁ”
;

208 
	gcu¼’tR’d””
 = 
cu¼’tR’d””
->
·»Á
();

212 
	g´eviousSiblšg
 = 
cu¼’tCouÁ”
;

213 
	gcu¼’tR’d””
 = 
´eviousSiblšgOrP¬’t
(
cu¼’tR’d””
);

221 ià(
	g´eviousSiblšg
)

222 
	gcu¼’tR’d””
 = 
´eviousSiblšgOrP¬’t
(
cu¼’tR’d””
);

224 
	gcu¼’tR’d””
 = 
cu¼’tR’d””
->
´eviousInP»Ord”
();

226  
	gçl£
;

229 
CouÁ”Node
* 
makeCouÁ”Node
(
R’d”Objeù
* 
objeù
, cÚ¡ 
AtomicSŒšg
& 
id’tif›r
, 
boŞ
 
®waysC»©eCouÁ”
)

231 
ASSERT
(
objeù
);

233 ià(
	gobjeù
->
	gm_hasCouÁ”NodeM­
)

234 ià(
CouÁ”M­
* 
	gnodeM­
 = 
couÁ”M­s
().
g‘
(
objeù
))

235 ià(
CouÁ”Node
* 
node
 = 
nodeM­
->
g‘
(
id’tif›r
.
im¶
()))

236  
node
;

238 
boŞ
 
	gisRe£t
 = 
çl£
;

239 
	gv®ue
 = 0;

240 ià(!
¶ªCouÁ”
(
objeù
, 
id’tif›r
, 
isRe£t
, 
v®ue
è&& !
	g®waysC»©eCouÁ”
)

243 
CouÁ”Node
* 
	gÃwP¬’t
 = 0;

244 
CouÁ”Node
* 
	gÃwP»viousSiblšg
 = 0;

245 
CouÁ”Node
* 
	gÃwNode
 = 
Ãw
 CouÁ”Node(
objeù
, 
isRe£t
, 
v®ue
);

246 ià(
fšdPÏûFÜCouÁ”
(
objeù
, 
id’tif›r
, 
isRe£t
, 
ÃwP¬’t
, 
ÃwP»viousSiblšg
))

247 
	gÃwP¬’t
->
š£¹Aá”
(
ÃwNode
, 
ÃwP»viousSiblšg
, 
id’tif›r
);

248 
CouÁ”M­
* 
	gnodeM­
;

249 ià(
	gobjeù
->
	gm_hasCouÁ”NodeM­
)

250 
	gnodeM­
 = 
couÁ”M­s
().
g‘
(
objeù
);

252 
	gnodeM­
 = 
Ãw
 
CouÁ”M­
;

253 
couÁ”M­s
().
£t
(
objeù
, 
nodeM­
);

254 
	gobjeù
->
	gm_hasCouÁ”NodeM­
 = 
Œue
;

256 
	gnodeM­
->
£t
(
id’tif›r
.
im¶
(), 
ÃwNode
);

257 ià(
	gÃwNode
->
·»Á
(è|| !
	gobjeù
->
ÃxtInP»Ord”
(
objeù
->parent()))

258  
	gÃwNode
;

261 
	gCouÁ”M­s
& 
	gm­s
 = 
couÁ”M­s
();

262 
R’d”Objeù
* 
	g¡ayW™hš
 = 
objeù
->
·»Á
();

263 
R’d”Objeù
* 
	gcu¼’tR’d””
 = 
objeù
->
ÃxtInP»Ord”
(
¡ayW™hš
); cu¼’tR’d””; cu¼’tR’d”” = 
cu¼’tR’d””
->nextInPreOrder(stayWithin)) {

264 ià(!
cu¼’tR’d””
->
m_hasCouÁ”NodeM­
)

266 
CouÁ”Node
* 
	gcu¼’tCouÁ”
 = 
m­s
.
g‘
(
cu¼’tR’d””
)->g‘(
id’tif›r
.
im¶
());

267 ià(!
	gcu¼’tCouÁ”
)

269 ià(
	gcu¼’tCouÁ”
->
·»Á
()) {

270 
ASSERT
(
ÃwNode
->
fœ¡Chd
());

271 ià(
	gcu¼’tR’d””
->
Ï¡Chd
())

272 
	gcu¼’tR’d””
 = 
cu¼’tR’d””
->
Ï¡Chd
();

275 ià(
	g¡ayW™hš
 !ğ
cu¼’tR’d””
->
·»Á
(è|| !
cu¼’tCouÁ”
->
hasRe£tTy³
())

276 
ÃwNode
->
š£¹Aá”
(
cu¼’tCouÁ”
,‚ewNode->
Ï¡Chd
(), 
id’tif›r
);

277 ià(
	gcu¼’tR’d””
->
Ï¡Chd
())

278 
	gcu¼’tR’d””
 = 
cu¼’tR’d””
->
Ï¡Chd
();

280  
	gÃwNode
;

283 
	gR’d”CouÁ”
::
R’d”CouÁ”
(
Docum’t
* 
node
, cÚ¡ 
CouÁ”CÚ‹Á
& 
couÁ”
)

284 : 
R’d”Text
(
node
, 
SŒšgIm¶
::
em±y
())

285 , 
m_couÁ”
(
couÁ”
)

286 , 
m_couÁ”Node
(0)

290 cÚ¡ * 
	gR’d”CouÁ”
::
»nd”Name
() const

295 
boŞ
 
	gR’d”CouÁ”
::
isCouÁ”
() const

297  
Œue
;

300 
	gPassRefPŒ
<
	gSŒšgIm¶
> 
	gR’d”CouÁ”
::
Üigš®Text
() const

302 ià(!
·»Á
())

305 ià(!
	gm_couÁ”Node
)

306 
	gm_couÁ”Node
 = 
makeCouÁ”Node
(
·»Á
(), 
m_couÁ”
.
id’tif›r
(), 
Œue
);

308 
CouÁ”Node
* 
	gchd
 = 
m_couÁ”Node
;

309 
	gv®ue
 = 
chd
->
aùsAsRe£t
(è? chd->
v®ue
(è: chd->
couÁInP¬’t
();

311 
SŒšg
 
	g‹xt
 = 
li¡M¬k”Text
(
m_couÁ”
.
li¡StyË
(), 
v®ue
);

313 ià(!
	gm_couÁ”
.
£·¿tÜ
().
isNuÎ
()) {

314 ià(!
	gchd
->
aùsAsRe£t
())

315 
	gchd
 = 
chd
->
·»Á
();

316 
CouÁ”Node
* 
	g·»Á
 = 
chd
->
·»Á
()) {

317 
‹xt
 = 
li¡M¬k”Text
(
m_couÁ”
.
li¡StyË
(), 
chd
->
couÁInP¬’t
())

318 + 
	gm_couÁ”
.
£·¿tÜ
(è+ 
	g‹xt
;

319 
	gchd
 = 
·»Á
;

323  
	g‹xt
.
im¶
();

326 
	gR’d”CouÁ”
::
ÿlcP»fWidths
(
Ëad
)

328 
£tTextIÁ”Çl
(
Üigš®Text
());

329 
	gR’d”Text
::
ÿlcP»fWidths
(
Ëad
);

332 
	gR’d”CouÁ”
::
šv®id©e
(cÚ¡ 
AtomicSŒšg
& 
id’tif›r
)

334 ià(
m_couÁ”
.
id’tif›r
() != identifier)

336 
	gm_couÁ”Node
 = 0;

337 
£tN“dsLayoutAndP»fWidthsReÿlc
();

340 
de¡royCouÁ”NodeW™houtM­Remov®
(cÚ¡ 
AtomicSŒšg
& 
id’tif›r
, 
CouÁ”Node
* 
node
)

342 
CouÁ”Node
* 
	g´evious
;

343 
CouÁ”Node
* 
	gchd
 = 
node
->
Ï¡Desûndªt
(); chd && chd !ğnode; chd = 
´evious
) {

344 
´evious
 = 
chd
->
´eviousInP»Ord”
();

345 
	gchd
->
·»Á
()->
»moveChd
(
chd
, 
id’tif›r
);

346 
ASSERT
(
couÁ”M­s
().
g‘
(
chd
->
»nd””
())->g‘(
id’tif›r
.
im¶
()) == child);

347 
couÁ”M­s
().
g‘
(
chd
->
»nd””
())->
»move
(
id’tif›r
.
im¶
());

348 ià(!
	gchd
->
»nd””
()->
docum’tBešgDe¡royed
()) {

349 
R’d”ObjeùChdLi¡
* 
	gchd»n
 = 
chd
->
»nd””
()->
vœtu®Chd»n
();

350 ià(
	gchd»n
)

351 
	gchd»n
->
šv®id©eCouÁ”s
(
chd
->
»nd””
(), 
id’tif›r
);

353 
d–‘e
 
	gchd
;

355 
R’d”Objeù
* 
	g»nd””
 = 
node
->
»nd””
();

356 ià(!
	g»nd””
->
docum’tBešgDe¡royed
()) {

357 ià(
R’d”ObjeùChdLi¡
* 
	gchd»n
 = 
»nd””
->
vœtu®Chd»n
())

358 
chd»n
->
šv®id©eCouÁ”s
(
»nd””
, 
id’tif›r
);

360 ià(
CouÁ”Node
* 
	g·»Á
 = 
node
->
·»Á
())

361 
·»Á
->
»moveChd
(
node
, 
id’tif›r
);

362 
d–‘e
 
	gnode
;

365 
	gR’d”CouÁ”
::
de¡royCouÁ”Nodes
(
R’d”Objeù
* 
»nd””
)

367 
CouÁ”M­s
& 
m­s
 = 
couÁ”M­s
();

368 
	gCouÁ”M­s
::
™”©Ü
 
m­sI‹¿tÜ
 = 
m­s
.
fšd
(
»nd””
);

369 ià(
	gm­sI‹¿tÜ
 =ğ
m­s
.
’d
())

371 
CouÁ”M­
* 
	gm­
 = 
m­sI‹¿tÜ
->
£cÚd
;

372 
	gCouÁ”M­
::
cÚ¡_™”©Ü
 
’d
 = 
m­
->end();

373 
	gCouÁ”M­
::
cÚ¡_™”©Ü
 
™
 = 
m­
->
begš
(); 
	g™
 !ğ
’d
; ++it) {

374 
AtomicSŒšg
 
id’tif›r
(
™
->
fœ¡
.
g‘
());

375 
de¡royCouÁ”NodeW™houtM­Remov®
(
id’tif›r
, 
™
->
£cÚd
);

377 
	gm­s
.
»move
(
m­sI‹¿tÜ
);

378 
d–‘e
 
	gm­
;

379 
	g»nd””
->
	gm_hasCouÁ”NodeM­
 = 
çl£
;

382 
	gR’d”CouÁ”
::
de¡royCouÁ”Node
(
R’d”Objeù
* 
»nd””
, cÚ¡ 
AtomicSŒšg
& 
id’tif›r
)

384 
CouÁ”M­
* 
	gm­
 = 
couÁ”M­s
().
g‘
(
»nd””
);

385 ià(!
	gm­
)

387 
	gCouÁ”M­
::
™”©Ü
 
m­I‹¿tÜ
 = 
m­
->
fšd
(
id’tif›r
.
im¶
());

388 ià(
	gm­I‹¿tÜ
 =ğ
m­
->
’d
())

390 
de¡royCouÁ”NodeW™houtM­Remov®
(
id’tif›r
, 
m­I‹¿tÜ
->
£cÚd
);

391 
	gm­
->
»move
(
m­I‹¿tÜ
);

405 
upd©eCouÁ”s
(
R’d”Objeù
* 
»nd””
)

407 
ASSERT
(
»nd””
->
¡yË
());

408 cÚ¡ 
CouÁ”DœeùiveM­
* 
	gdœeùiveM­
 = 
»nd””
->
¡yË
()->
couÁ”Dœeùives
();

409 ià(!
	gdœeùiveM­
)

411 
	gCouÁ”DœeùiveM­
::
cÚ¡_™”©Ü
 
’d
 = 
dœeùiveM­
->end();

412 ià(!
	g»nd””
->
	gm_hasCouÁ”NodeM­
) {

413 
	gCouÁ”DœeùiveM­
::
cÚ¡_™”©Ü
 
™
 = 
dœeùiveM­
->
begš
(); 
	g™
 !ğ
’d
; ++it)

414 
makeCouÁ”Node
(
»nd””
, 
AtomicSŒšg
(
™
->
fœ¡
.
g‘
()), 
çl£
);

417 
CouÁ”M­
* 
	gcouÁ”M­
 = 
couÁ”M­s
().
g‘
(
»nd””
);

418 
ASSERT
(
couÁ”M­
);

419 
	gCouÁ”DœeùiveM­
::
cÚ¡_™”©Ü
 
™
 = 
dœeùiveM­
->
begš
(); 
	g™
 !ğ
’d
; ++it) {

420 
CouÁ”Node
* 
	gnode
 = 
couÁ”M­
->
g‘
(
™
->
fœ¡
.get());

421 ià(!
	gnode
) {

422 
makeCouÁ”Node
(
»nd””
, 
AtomicSŒšg
(
™
->
fœ¡
.
g‘
()), 
çl£
);

425 
CouÁ”Node
* 
	gÃwP¬’t
 = 0;

426 
CouÁ”Node
* 
	gÃwP»viousSiblšg
;

427 
fšdPÏûFÜCouÁ”
(
»nd””
, 
AtomicSŒšg
(
™
->
fœ¡
.
g‘
()), 
node
->
hasRe£tTy³
(), 
ÃwP¬’t
, 
ÃwP»viousSiblšg
);

428 
CouÁ”Node
* 
	g·»Á
 = 
node
->
·»Á
();

429 ià(
	gÃwP¬’t
 =ğ
·»Á
 && 
ÃwP»viousSiblšg
 =ğ
node
->
´eviousSiblšg
())

431 ià(
	g·»Á
)

432 
	g·»Á
->
»moveChd
(
node
, 
™
->
fœ¡
.
g‘
());

433 ià(
	gÃwP¬’t
)

434 
	gÃwP¬’t
->
š£¹Aá”
(
node
, 
ÃwP»viousSiblšg
, 
™
->
fœ¡
.
g‘
());

438 
	gR’d”CouÁ”
::
»nd””SubŒ“A‰ached
(
R’d”Objeù
* 
»nd””
)

440 
R’d”Objeù
* 
desûndªt
 = 
»nd””
; 
	gdesûndªt
; desûndªˆğdesûndªt->
ÃxtInP»Ord”
(renderer))

441 
upd©eCouÁ”s
(
desûndªt
);

444 
	gR’d”CouÁ”
::
»nd””StyËChªged
(
R’d”Objeù
* 
»nd””
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
, cÚ¡ R’d”StyË* 
ÃwStyË
)

446 cÚ¡ 
CouÁ”DœeùiveM­
* 
	gÃwCouÁ”Dœeùives
;

447 cÚ¡ 
CouÁ”DœeùiveM­
* 
	gŞdCouÁ”Dœeùives
;

448 ià(
	gŞdStyË
 && (
	gŞdCouÁ”Dœeùives
 = 
ŞdStyË
->
couÁ”Dœeùives
())) {

449 ià(
ÃwStyË
 && (
ÃwCouÁ”Dœeùives
 =‚ewStyË->
couÁ”Dœeùives
())) {

450 
CouÁ”DœeùiveM­
::
cÚ¡_™”©Ü
 
ÃwM­End
 = 
ÃwCouÁ”Dœeùives
->
’d
();

451 
	gCouÁ”DœeùiveM­
::
cÚ¡_™”©Ü
 
ŞdM­End
 = 
ŞdCouÁ”Dœeùives
->
’d
();

452 
	gCouÁ”DœeùiveM­
::
cÚ¡_™”©Ü
 
™
 = 
ÃwCouÁ”Dœeùives
->
begš
(); 
	g™
 !ğ
ÃwM­End
; ++it) {

453 
	gCouÁ”DœeùiveM­
::
cÚ¡_™”©Ü
 
ŞdM­It
 = 
ŞdCouÁ”Dœeùives
->
fšd
(
™
->
fœ¡
);

454 ià(
	gŞdM­It
 !ğ
ŞdM­End
) {

455 ià(
ŞdM­It
->
£cÚd
 =ğ
™
->second)

457 
	gR’d”CouÁ”
::
de¡royCouÁ”Node
(
»nd””
, 
™
->
fœ¡
.
g‘
());

462 
makeCouÁ”Node
(
»nd””
, 
™
->
fœ¡
.
g‘
(), 
çl£
);

465 
	gCouÁ”DœeùiveM­
::
cÚ¡_™”©Ü
 
™
 = 
ŞdCouÁ”Dœeùives
->
begš
(); 
	g™
 !=
ŞdM­End
; ++it) {

466 ià(!
	gÃwCouÁ”Dœeùives
->
cÚšs
(
™
->
fœ¡
))

467 
	gR’d”CouÁ”
::
de¡royCouÁ”Node
(
»nd””
, 
™
->
fœ¡
.
g‘
());

470 ià(
	g»nd””
->
	gm_hasCouÁ”NodeM­
)

471 
	gR’d”CouÁ”
::
de¡royCouÁ”Nodes
(
»nd””
);

473 } ià(
	gÃwStyË
 && (
	gÃwCouÁ”Dœeùives
 = 
ÃwStyË
->
couÁ”Dœeùives
())) {

474 
CouÁ”DœeùiveM­
::
cÚ¡_™”©Ü
 
ÃwM­End
 = 
ÃwCouÁ”Dœeùives
->
’d
();

475 
	gCouÁ”DœeùiveM­
::
cÚ¡_™”©Ü
 
™
 = 
ÃwCouÁ”Dœeùives
->
begš
(); 
	g™
 !ğ
ÃwM­End
; ++it) {

479 
makeCouÁ”Node
(
»nd””
, 
™
->
fœ¡
.
g‘
(), 
çl£
);

	@RenderCounter.h

22 #iâdeà
R’d”CouÁ”_h


23 
	#R’d”CouÁ”_h


	)

25 
	~"CouÁ”CÚ‹Á.h
"

26 
	~"R’d”Text.h
"

28 
Çme¥aû
 
	gWebCÜe
 {

30 
şass
 
	gCouÁ”Node
;

32 şas 
	cR’d”CouÁ”
 : 
public
 
R’d”Text
 {

33 
public
:

34 
R’d”CouÁ”
(
Docum’t
*, cÚ¡ 
CouÁ”CÚ‹Á
&);

40 
šv®id©e
(cÚ¡ 
AtomicSŒšg
& 
id’tif›r
);

42 
de¡royCouÁ”Nodes
(
R’d”Objeù
*);

43 
de¡royCouÁ”Node
(
R’d”Objeù
*, cÚ¡ 
AtomicSŒšg
& 
id’tif›r
);

44 
»nd””SubŒ“A‰ached
(
R’d”Objeù
*);

45 
»nd””StyËChªged
(
R’d”Objeù
*, cÚ¡ 
R’d”StyË
* 
ŞdStyË
, cÚ¡ R’d”StyË* 
ÃwStyË
);

47 
	g´iv©e
:

48 
vœtu®
 cÚ¡ * 
»nd”Name
() const;

49 
vœtu®
 
boŞ
 
isCouÁ”
() const;

50 
vœtu®
 
	gPassRefPŒ
<
	gSŒšgIm¶
> 
Üigš®Text
() const;

52 
vœtu®
 
ÿlcP»fWidths
(
ËadWidth
);

54 
CouÁ”CÚ‹Á
 
	gm_couÁ”
;

55 
mubË
 
CouÁ”Node
* 
	gm_couÁ”Node
;

58 
šlše
 
R’d”CouÁ”
* 
	$toR’d”CouÁ”
(
R’d”Objeù
* 
objeù
)

60 
	`ASSERT
(!
objeù
 || objeù->
	`isCouÁ”
());

61  
¡©ic_ÿ¡
<
R’d”CouÁ”
*>(
objeù
);

62 
	}
}

65 
toR’d”CouÁ”
(cÚ¡ 
R’d”CouÁ”
*);

	@RenderDataGrid.cpp

26 
	~"cÚfig.h
"

28 #ià
ENABLE
(
DATAGRID
)

30 
	~"R’d”D©aGrid.h
"

32 
	~"CSSStyËS–eùÜ.h
"

33 
	~"FocusCÚŒŞËr.h
"

34 
	~"F¿me.h
"

35 
	~"G¿phicsCÚ‹xt.h
"

36 
	~"Page.h
"

37 
	~"R’d”V›w.h
"

38 
	~"SüŞlb¬.h
"

40 
usšg
 
	g¡d
::
mš
;

42 
Çme¥aû
 
	gWebCÜe
 {

44 cÚ¡ 
	gcDeçuÉWidth
 = 300;

46 
	gR’d”D©aGrid
::
R’d”D©aGrid
(
EËm’t
* 
–t
)

47 : 
R’d”Block
(
–t
)

51 
R’d”D©aGrid
::~RenderDataGrid()

55 
R’d”D©aGrid
::
¡yËDidChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
)

57 
	gR’d”Block
::
¡yËDidChªge
(
diff
, 
ŞdStyË
);

58 
»ÿlcStyËFÜCŞumns
();

61 
	gR’d”D©aGrid
::
»ÿlcStyËFÜCŞumns
()

63 
D©aGridCŞumnLi¡
* 
cŞumns
 = 
gridEËm’t
()->columns();

64 
	gËngth
 = 
cŞumns
->
Ëngth
();

65 
	gi
 = 0; i < 
	gËngth
; ++i)

66 
»ÿlcStyËFÜCŞumn
(
cŞumns
->
™em
(
i
));

69 
	gR’d”D©aGrid
::
»ÿlcStyËFÜCŞumn
(
D©aGridCŞumn
* 
cŞumn
)

71 ià(!
cŞumn
->
cŞumnStyË
())

72 
cŞumn
->
£tCŞumnStyË
(
docum’t
()->
¡yËS–eùÜ
()->
p£udoStyËFÜD©aGridCŞumn
(cŞumn, 
¡yË
()));

73 ià(!
	gcŞumn
->
h—d”StyË
())

74 
	gcŞumn
->
£tH—d”StyË
(
docum’t
()->
¡yËS–eùÜ
()->
p£udoStyËFÜD©aGridCŞumnH—d”
(
cŞumn
, 
¡yË
()));

77 
R’d”StyË
* 
	gR’d”D©aGrid
::
cŞumnStyË
(
D©aGridCŞumn
* 
cŞumn
)

79 ià(!
cŞumn
->
cŞumnStyË
())

80 
»ÿlcStyËFÜCŞumn
(
cŞumn
);

81  
	gcŞumn
->
cŞumnStyË
();

84 
R’d”StyË
* 
	gR’d”D©aGrid
::
h—d”StyË
(
D©aGridCŞumn
* 
cŞumn
)

86 ià(!
cŞumn
->
h—d”StyË
())

87 
»ÿlcStyËFÜCŞumn
(
cŞumn
);

88  
	gcŞumn
->
h—d”StyË
();

91 
	gR’d”D©aGrid
::
ÿlcP»fWidths
()

93 
m_mšP»fWidth
 = 0;

94 
	gm_maxP»fWidth
 = 0;

96 ià(
¡yË
()->
width
().
isFixed
(è&& styË()->width().
v®ue
() > 0)

97 
	gm_mšP»fWidth
 = 
m_maxP»fWidth
 = 
ÿlcCÚ‹ÁBoxWidth
(
¡yË
()->
width
().
v®ue
());

99 
	gm_maxP»fWidth
 = 
ÿlcCÚ‹ÁBoxWidth
(
cDeçuÉWidth
);

101 ià(
¡yË
()->
mšWidth
().
isFixed
(è&& styË()->mšWidth().
v®ue
() > 0) {

102 
	gm_maxP»fWidth
 = 
max
(
m_maxP»fWidth
, 
ÿlcCÚ‹ÁBoxWidth
(
¡yË
()->
mšWidth
().
v®ue
()));

103 
	gm_mšP»fWidth
 = 
max
(
m_mšP»fWidth
, 
ÿlcCÚ‹ÁBoxWidth
(
¡yË
()->
mšWidth
().
v®ue
()));

104 } ià(
¡yË
()->
width
().
isP”ûÁ
(è|| (¡yË()->width().
isAuto
(è&& styË()->
height
().isPercent()))

105 
	gm_mšP»fWidth
 = 0;

107 
	gm_mšP»fWidth
 = 
m_maxP»fWidth
;

109 ià(
¡yË
()->
maxWidth
().
isFixed
(è&& styË()->maxWidth().
v®ue
(è!ğ
undefšedL’gth
) {

110 
m_maxP»fWidth
 = 
mš
(m_maxP»fWidth, 
ÿlcCÚ‹ÁBoxWidth
(
¡yË
()->
maxWidth
().
v®ue
()));

111 
	gm_mšP»fWidth
 = 
mš
(
m_mšP»fWidth
, 
ÿlcCÚ‹ÁBoxWidth
(
¡yË
()->
maxWidth
().
v®ue
()));

114 
	gtoAdd
 = 
·ddšgLeá
(è+ 
·ddšgRight
(è+ 
bÜd”Leá
(è+ 
bÜd”Right
();

115 
	gm_mšP»fWidth
 +ğ
toAdd
;

116 
	gm_maxP»fWidth
 +ğ
toAdd
;

118 
£tP»fWidthsDœty
(
çl£
);

121 
	gR’d”D©aGrid
::
Ïyout
()

123 
R’d”Block
::
Ïyout
();

124 
ÏyoutCŞumns
();

127 
	gR’d”D©aGrid
::
ÏyoutCŞumns
()

132 
R’d”D©aGrid
::
·štObjeù
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

134 ià(
¡yË
()->
visib™y
(è!ğ
VISIBLE
)

138 
	gR’d”Block
::
·štObjeù
(
·štInfo
, 
tx
, 
ty
);

140 ià(
	g·štInfo
.
	gpha£
 !ğ
PaštPha£FÜeground
)

144 
·štCŞumnH—d”s
(
·štInfo
, 
tx
, 
ty
);

147 
	gR’d”D©aGrid
::
·štCŞumnH—d”s
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

149 
D©aGridCŞumnLi¡
* 
	gcŞumns
 = 
gridEËm’t
()->
cŞumns
();

150 
	gËngth
 = 
cŞumns
->
Ëngth
();

151 
	gi
 = 0; i < 
	gËngth
; ++i) {

152 
D©aGridCŞumn
* 
	gcŞumn
 = 
cŞumns
->
™em
(
i
);

153 
R’d”StyË
* 
	gcŞumnStyË
 = 
h—d”StyË
(
cŞumn
);

156 ià(!
	gcŞumnStyË
 || cŞumnStyË->
di¥Ïy
(è=ğ
NONE
 || 
cŞumnStyË
->
visib™y
(è!ğ
VISIBLE
)

160 
IÁReù
 
cŞumnReù
(
cŞumn
->
»ù
());

161 
	gcŞumnReù
.
move
(
tx
, 
ty
);

162 ià(
	gcŞumnReù
.
š‹r£ùs
(
·štInfo
.
»ù
))

163 
·štCŞumnH—d”
(
cŞumn
, 
·štInfo
, 
tx
, 
ty
);

167 
	gR’d”D©aGrid
::
·štCŞumnH—d”
(
D©aGridCŞumn
*, 
PaštInfo
&, , )

173 
	gR’d”D©aGrid
::
v®ueChªged
(
SüŞlb¬
*)

178 
R’d”D©aGrid
::
šv®id©eSüŞlb¬Reù
(
SüŞlb¬
*, cÚ¡ 
IÁReù
&)

183 
boŞ
 
	gR’d”D©aGrid
::
isAùive
() const

185 
Page
* 
·ge
 = 
docum’t
()->
äame
()->page();

186  
	g·ge
 &&…age->
focusCÚŒŞËr
()->
isAùive
();

190 
IÁReù
 
	gR’d”D©aGrid
::
cÚv”tFromSüŞlb¬ToCÚššgV›w
(cÚ¡ 
SüŞlb¬
* 
süŞlb¬
, cÚ¡ IÁReù& 
süŞlb¬Reù
) const

192 
R’d”V›w
* 
	gv›w
 = 
this
->
v›w
();

193 ià(!
	gv›w
)

194  
	gsüŞlb¬Reù
;

196 
IÁReù
 
	g»ù
 = 
süŞlb¬Reù
;

198 
	gsüŞlb¬Leá
 = 
width
(è- 
bÜd”Right
(è- 
süŞlb¬
->width();

199 
	gsüŞlb¬Tİ
 = 
bÜd”Tİ
();

200 
	g»ù
.
move
(
süŞlb¬Leá
, 
süŞlb¬Tİ
);

202  
	gv›w
->
äameV›w
()->
cÚv”tFromR’d””
(
this
, 
»ù
);

205 
IÁReù
 
	gR’d”D©aGrid
::
cÚv”tFromCÚššgV›wToSüŞlb¬
(cÚ¡ 
SüŞlb¬
* 
süŞlb¬
, cÚ¡ IÁReù& 
·»ÁReù
) const

207 
R’d”V›w
* 
	gv›w
 = 
this
->
v›w
();

208 ià(!
	gv›w
)

209  
	g·»ÁReù
;

211 
IÁReù
 
	g»ù
 = 
v›w
->
äameV›w
()->
cÚv”tToR’d””
(
this
, 
·»ÁReù
);

213 
	gsüŞlb¬Leá
 = 
width
(è- 
bÜd”Right
(è- 
süŞlb¬
->width();

214 
	gsüŞlb¬Tİ
 = 
bÜd”Tİ
();

215 
	g»ù
.
move
(-
süŞlb¬Leá
, -
süŞlb¬Tİ
);

216  
	g»ù
;

219 
IÁPošt
 
	gR’d”D©aGrid
::
cÚv”tFromSüŞlb¬ToCÚššgV›w
(cÚ¡ 
SüŞlb¬
* 
süŞlb¬
, cÚ¡ IÁPošt& 
süŞlb¬Pošt
) const

221 
R’d”V›w
* 
	gv›w
 = 
this
->
v›w
();

222 ià(!
	gv›w
)

223  
	gsüŞlb¬Pošt
;

225 
IÁPošt
 
	gpošt
 = 
süŞlb¬Pošt
;

227 
	gsüŞlb¬Leá
 = 
width
(è- 
bÜd”Right
(è- 
süŞlb¬
->width();

228 
	gsüŞlb¬Tİ
 = 
bÜd”Tİ
();

229 
	gpošt
.
move
(
süŞlb¬Leá
, 
süŞlb¬Tİ
);

231  
	gv›w
->
äameV›w
()->
cÚv”tFromR’d””
(
this
, 
pošt
);

234 
IÁPošt
 
	gR’d”D©aGrid
::
cÚv”tFromCÚššgV›wToSüŞlb¬
(cÚ¡ 
SüŞlb¬
* 
süŞlb¬
, cÚ¡ IÁPošt& 
·»ÁPošt
) const

236 
R’d”V›w
* 
	gv›w
 = 
this
->
v›w
();

237 ià(!
	gv›w
)

238  
	g·»ÁPošt
;

240 
IÁPošt
 
	gpošt
 = 
v›w
->
äameV›w
()->
cÚv”tToR’d””
(
this
, 
·»ÁPošt
);

242 
	gsüŞlb¬Leá
 = 
width
(è- 
bÜd”Right
(è- 
süŞlb¬
->width();

243 
	gsüŞlb¬Tİ
 = 
bÜd”Tİ
();

244 
	gpošt
.
move
(-
süŞlb¬Leá
, -
süŞlb¬Tİ
);

245  
	gpošt
;

	@RenderDataGrid.h

26 #iâdeà
R’d”D©aGrid_h


27 
	#R’d”D©aGrid_h


	)

29 #ià
ENABLE
(
DATAGRID
)

31 
	~"HTMLD©aGridEËm’t.h
"

32 
	~"R’d”Block.h
"

33 
	~"SüŞlb¬Cl›Á.h
"

34 
	~"StyËImage.h
"

35 
	~<wtf/RefPŒ.h
>

36 
	~<wtf/VeùÜ.h
>

38 
Çme¥aû
 
	gWebCÜe
 {

40 
şass
 
	gR’d”D©aGrid
 : 
public
 
R’d”Block
, 
´iv©e
 
	gSüŞlb¬Cl›Á
 {

41 
	gpublic
:

42 
R’d”D©aGrid
(
EËm’t
*);

43 ~
R’d”D©aGrid
();

45 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderDataGrid"; }

46 
vœtu®
 
boŞ
 
ÿnHaveChd»n
(ècÚ¡ {  
	gçl£
; }

47 
vœtu®
 
ÿlcP»fWidths
();

48 
vœtu®
 
Ïyout
();

49 
vœtu®
 
·štObjeù
(
PaštInfo
&, 
tx
, 
ty
);

51 
cŞumnsChªged
();

53 
	g´iv©e
:

54 
vœtu®
 
¡yËDidChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
);

56 
R’d”StyË
* 
cŞumnStyË
(
D©aGridCŞumn
*);

57 
R’d”StyË
* 
h—d”StyË
(
D©aGridCŞumn
*);

58 
»ÿlcStyËFÜCŞumns
();

59 
»ÿlcStyËFÜCŞumn
(
D©aGridCŞumn
*);

61 
ÏyoutCŞumns
();

62 
·štCŞumnH—d”s
(
PaštInfo
&, 
tx
, 
ty
);

63 
·štCŞumnH—d”
(
D©aGridCŞumn
*, 
PaštInfo
&, 
tx
, 
ty
);

65 
HTMLD©aGridEËm’t
* 
gridEËm’t
(ècÚ¡ {  
	g¡©ic_ÿ¡
<
	gHTMLD©aGridEËm’t
*>(
node
()); }

68 
vœtu®
 
v®ueChªged
(
SüŞlb¬
*);

69 
vœtu®
 
šv®id©eSüŞlb¬Reù
(
SüŞlb¬
*, cÚ¡ 
IÁReù
&);

70 
vœtu®
 
boŞ
 
isAùive
() const;

71 
vœtu®
 
boŞ
 
süŞlb¬CÜÃrP»£Á
(ècÚ¡ {  
	gçl£
; }

72 
vœtu®
 
IÁReù
 
cÚv”tFromSüŞlb¬ToCÚššgV›w
(cÚ¡ 
SüŞlb¬
*, const IntRect&) const;

73 
vœtu®
 
IÁReù
 
cÚv”tFromCÚššgV›wToSüŞlb¬
(cÚ¡ 
SüŞlb¬
*, const IntRect&) const;

74 
vœtu®
 
IÁPošt
 
cÚv”tFromSüŞlb¬ToCÚššgV›w
(cÚ¡ 
SüŞlb¬
*, const IntPoint&) const;

75 
vœtu®
 
IÁPošt
 
cÚv”tFromCÚššgV›wToSüŞlb¬
(cÚ¡ 
SüŞlb¬
*, const IntPoint&) const;

77 
	gRefPŒ
<
	gSüŞlb¬
> 
	gm_vB¬
;

	@RenderEmbeddedObject.cpp

24 
	~"cÚfig.h
"

25 
	~"R’d”EmbeddedObjeù.h
"

27 
	~"CSSV®ueKeywÜds.h
"

28 
	~"FÚt.h
"

29 
	~"FÚtS–eùÜ.h
"

30 
	~"F¿me.h
"

31 
	~"F¿meLßd”Cl›Á.h
"

32 
	~"G¿phicsCÚ‹xt.h
"

33 
	~"HTMLEmbedEËm’t.h
"

34 
	~"HTMLIF¿meEËm’t.h
"

35 
	~"HTMLNames.h
"

36 
	~"HTMLObjeùEËm’t.h
"

37 
	~"HTMLP¬amEËm’t.h
"

38 
	~"LoÿlizedSŒšgs.h
"

39 
	~"MIMETy³Regi¡ry.h
"

40 
	~"Page.h
"

41 
	~"P©h.h
"

42 
	~"PlugšWidg‘.h
"

43 
	~"R’d”Theme.h
"

44 
	~"R’d”V›w.h
"

45 
	~"R’d”Widg‘PrÙeùÜ.h
"

46 
	~"S‘tšgs.h
"

47 
	~"Text.h
"

49 #ià
ENABLE
(
PLUGIN_PROXY_FOR_VIDEO
)

50 
	~"HTMLVideoEËm’t.h
"

53 #ià
USE
(
ACCELERATED_COMPOSITING
)

54 
	~"PlugšWidg‘.h
"

57 
Çme¥aû
 
	gWebCÜe
 {

59 
usšg
 
Çme¥aû
 
	gHTMLNames
;

61 cÚ¡ 
	g»¶aûm’tTextRoundedReùHeight
 = 18;

62 cÚ¡ 
	g»¶aûm’tTextRoundedReùLeáRightTextM¬gš
 = 6;

63 cÚ¡ 
	g»¶aûm’tTextRoundedReùO·c™y
 = 0.20f;

64 cÚ¡ 
	g»¶aûm’tTextRoundedReùRadius
 = 5;

65 cÚ¡ 
	g»¶aûm’tTextTextO·c™y
 = 0.55f;

67 
	gR’d”EmbeddedObjeù
::
R’d”EmbeddedObjeù
(
EËm’t
* 
–em’t
)

68 : 
R’d”P¬tObjeù
(
–em’t
)

70 
v›w
()->
äameV›w
()->
£tIsVisu®lyNÚEm±y
();

73 
	gR’d”EmbeddedObjeù
::~
R’d”EmbeddedObjeù
()

75 ià(
äameV›w
())

76 
äameV›w
()->
»moveWidg‘ToUpd©e
(
this
);

79 #ià
USE
(
ACCELERATED_COMPOSITING
)

80 
boŞ
 
	gR’d”EmbeddedObjeù
::
»quœesLay”
() const

82 ià(
R’d”P¬tObjeù
::
»quœesLay”
())

83  
Œue
;

85  
®lowsAcûË¿‹dCompos™šg
();

88 
boŞ
 
	gR’d”EmbeddedObjeù
::
®lowsAcûË¿‹dCompos™šg
() const

90  
widg‘
(è&& widg‘()->
isPlugšWidg‘
(è&& 
¡©ic_ÿ¡
<
PlugšWidg‘
*>(widg‘())->
¶©fÜmLay”
();

94 
boŞ
 
isURLAÎowed
(
Docum’t
* 
doc
, cÚ¡ 
SŒšg
& 
u¾
)

96 ià(
	gdoc
->
äame
()->
·ge
()->
äameCouÁ
() >= 200)

97  
çl£
;

101 
KURL
 
	gcom¶‘eURL
 = 
doc
->
com¶‘eURL
(
u¾
);

102 
boŞ
 
	gfoundS–fReã»nû
 = 
çl£
;

103 
F¿me
* 
	gäame
 = 
doc
->
äame
(); f¿me; f¿mğäame->
Œ“
()->
·»Á
()) {

104 ià(
equ®IgnÜšgF¿gm’tId’tif›r
(
äame
->
lßd”
()->
u¾
(), 
com¶‘eURL
)) {

105 ià(
foundS–fReã»nû
)

106  
çl£
;

107 
	gfoundS–fReã»nû
 = 
Œue
;

110  
	gŒue
;

113 
	gHashM­
<
	tSŒšg
, SŒšg, 
	tCa£FŞdšgHash
> 
	tCÏssIdToTy³M­
;

115 
CÏssIdToTy³M­
* 
ü—‹CÏssIdToTy³M­
()

117 
CÏssIdToTy³M­
* 
	gm­
 = 
Ãw
 ClassIdToTypeMap;

118 
	gm­
->
add
("clsid:D27CDB6E-AE6D-11CF-96B8-444553540000", "application/x-shockwave-flash");

119 
	gm­
->
add
("clsid:CFCDAA03-8BE4-11CF-B84B-0020AFBBCCFA", "audio/x-pn-realaudio-plugin");

120 
	gm­
->
add
("clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B", "video/quicktime");

121 
	gm­
->
add
("clsid:166B1BCA-3F9C-11CF-8075-444553540000", "application/x-director");

122 
	gm­
->
add
("clsid:6BF52A52-394A-11D3-B153-00C04F79FAA6", "application/x-mplayer2");

123 
	gm­
->
add
("clsid:22D6F312-B0F6-11D0-94AB-0080C74C7E95", "application/x-mplayer2");

124  
	gm­
;

127 
SŒšg
 
£rviûTy³FÜCÏssId
(cÚ¡ SŒšg& 
şassId
)

131 ià(
	gşassId
.
isEm±y
())

132  
SŒšg
();

134 
CÏssIdToTy³M­
* 
	gm­
 = 
ü—‹CÏssIdToTy³M­
();

135  
	gm­
->
g‘
(
şassId
);

138 
m­D©aP¬amToSrc
(
VeùÜ
<
SŒšg
>* 
·¿mNames
, VeùÜ<SŒšg>* 
·¿mV®ues
)

142 
	g¤cIndex
 = -1, 
	gd©aIndex
 = -1;

143 
	gi
 = 0; i < 
	g·¿mNames
->
size
(); ++i) {

144 ià(
equ®IgnÜšgCa£
((*
·¿mNames
)[
i
], "src"))

145 
	g¤cIndex
 = 
i
;

146 ià(
equ®IgnÜšgCa£
((*
·¿mNames
)[
i
], "data"))

147 
	gd©aIndex
 = 
i
;

150 ià(
	g¤cIndex
 =ğ-1 && 
d©aIndex
 != -1) {

151 
·¿mNames
->
­³nd
("src");

152 
	g·¿mV®ues
->
­³nd
((*
·¿mV®ues
)[
d©aIndex
]);

156 
	gR’d”EmbeddedObjeù
::
upd©eWidg‘
(
boŞ
 
ÚlyC»©eNÚN‘sÿ³Plugšs
)

158 ià(!
m_»¶aûm’tText
.
isNuÎ
(è|| !
node
())

161 
SŒšg
 
	gu¾
;

162 
SŒšg
 
	g£rviûTy³
;

163 
	gVeùÜ
<
	gSŒšg
> 
	g·¿mNames
;

164 
	gVeùÜ
<
	gSŒšg
> 
	g·¿mV®ues
;

165 
F¿me
* 
	gäame
 = 
äameV›w
()->
äame
();

171 
R’d”Widg‘PrÙeùÜ
 
´ÙeùÜ
(
this
);

173 ià(
node
()->
hasTagName
(
objeùTag
)) {

174 
HTMLObjeùEËm’t
* 
	gobjeùEËm’t
 = 
¡©ic_ÿ¡
<HTMLObjeùEËm’t*>(
node
());

176 
	gobjeùEËm’t
->
£tN“dWidg‘Upd©e
(
çl£
);

177 ià(!
	gobjeùEËm’t
->
isFšishedP¬sšgChd»n
())

181 
HTMLEmbedEËm’t
* 
	gembed
 = 0;

182 
Node
* 
	gchd
 = 
objeùEËm’t
->
fœ¡Chd
(); child; ) {

183 ià(
	gchd
->
hasTagName
(
embedTag
)) {

184 
	gembed
 = 
¡©ic_ÿ¡
<
HTMLEmbedEËm’t
*>(
chd
);

188 ià(
	gchd
->
hasTagName
(
objeùTag
))

189 
	gchd
 = 
chd
->
ÃxtSiblšg
();

191 
	gchd
 = 
chd
->
Œav”£NextNode
(
objeùEËm’t
);

195 
HTMLEËm’t
* 
	gembedOrObjeù
;

196 ià(
	gembed
) {

197 
	gembedOrObjeù
 = 
embed
;

198 
	gu¾
 = 
embed
->
u¾
();

199 
	g£rviûTy³
 = 
embed
->
£rviûTy³
();

201 
	gembedOrObjeù
 = 
objeùEËm’t
;

204 ià(
	gu¾
.
isEm±y
())

205 
	gu¾
 = 
objeùEËm’t
->
u¾
();

206 ià(
	g£rviûTy³
.
isEm±y
())

207 
	g£rviûTy³
 = 
objeùEËm’t
->
£rviûTy³
();

209 
	gHashS‘
<
	gSŒšgIm¶
*, 
	gCa£FŞdšgHash
> 
	guniqueP¬amNames
;

214 
Node
* 
	gchd
 = 
objeùEËm’t
->
fœ¡Chd
();

215 
	gchd
 && (
	gu¾
.
isEm±y
(è|| 
	g£rviûTy³
.isEm±y(è|| !
	gembed
)) {

216 ià(
	gchd
->
hasTagName
(
·¿mTag
)) {

217 
HTMLP¬amEËm’t
* 
	gp
 = 
¡©ic_ÿ¡
<HTMLP¬amEËm’t*>(
chd
);

218 
SŒšg
 
	gÇme
 = 
p
->
Çme
();

219 ià(
	gu¾
.
isEm±y
(è&& (
equ®IgnÜšgCa£
(
Çme
, "src") ||ƒqualIgnoringCase(name, "movie") ||ƒqualIgnoringCase(name, "code") ||ƒqualIgnoringCase(name, "url")))

220 
	gu¾
 = 
p
->
v®ue
();

221 ià(
	g£rviûTy³
.
isEm±y
(è&& 
equ®IgnÜšgCa£
(
Çme
, "type")) {

222 
	g£rviûTy³
 = 
p
->
v®ue
();

223 
	gpos
 = 
£rviûTy³
.
fšd
(";");

224 ià(
	gpos
 != -1)

225 
£rviûTy³
 = s”viûTy³.
Ëá
(
pos
);

227 ià(!
	gembed
 && !
	gÇme
.
isEm±y
()) {

228 
	guniqueP¬amNames
.
add
(
Çme
.
im¶
());

229 
	g·¿mNames
.
­³nd
(
p
->
Çme
());

230 
	g·¿mV®ues
.
­³nd
(
p
->
v®ue
());

233 
	gchd
 = 
chd
->
ÃxtSiblšg
();

241 
SŒšg
 
	gcodeba£
;

242 ià(!
	gembed
 && 
	gMIMETy³Regi¡ry
::
isJavaAµËtMIMETy³
(
£rviûTy³
)) {

243 
codeba£
 = "codebase";

244 
	guniqueP¬amNames
.
add
(
codeba£
.
im¶
());

248 
NamedNodeM­
* 
	g©Œibu‹s
 = 
embedOrObjeù
->
©Œibu‹s
();

249 ià(
	g©Œibu‹s
) {

250 
	gi
 = 0; i < 
	g©Œibu‹s
->
Ëngth
(); ++i) {

251 
A‰ribu‹
* 
	g™
 = 
©Œibu‹s
->
©Œibu‹I‹m
(
i
);

252 cÚ¡ 
	gAtomicSŒšg
& 
	gÇme
 = 
™
->
Çme
().
loÿlName
();

253 ià(
	gembed
 || !
	guniqueP¬amNames
.
cÚšs
(
Çme
.
im¶
())) {

254 
	g·¿mNames
.
­³nd
(
Çme
.
¡ršg
());

255 
	g·¿mV®ues
.
­³nd
(
™
->
v®ue
().
¡ršg
());

260 
m­D©aP¬amToSrc
(&
·¿mNames
, &
·¿mV®ues
);

263 ià(
	g£rviûTy³
.
isEm±y
())

264 
	g£rviûTy³
 = 
£rviûTy³FÜCÏssId
(
objeùEËm’t
->
şassId
());

266 ià(!
isURLAÎowed
(
docum’t
(), 
u¾
))

270 
	gm_hasF®lbackCÚ‹Á
 = 
çl£
;

271 
Node
* 
	gchd
 = 
objeùEËm’t
->
fœ¡Chd
(); chd && !
	gm_hasF®lbackCÚ‹Á
; chd = 
chd
->
ÃxtSiblšg
()) {

272 ià((!
chd
->
isTextNode
(è&& !chd->
hasTagName
(
embedTag
è&& !chd->hasTagName(
·¿mTag
))

273 || (
chd
->
isTextNode
(è&& !
¡©ic_ÿ¡
<
Text
*>(chd)->
cÚšsOÆyWh™e¥aû
()))

274 
m_hasF®lbackCÚ‹Á
 = 
Œue
;

277 ià(
	gÚlyC»©eNÚN‘sÿ³Plugšs
) {

278 
KURL
 
	gcom¶‘edURL
;

279 ià(!
	gu¾
.
isEm±y
())

280 
	gcom¶‘edURL
 = 
äame
->
lßd”
()->
com¶‘eURL
(
u¾
);

282 ià(
	gäame
->
lßd”
()->
ş›Á
()->
objeùCÚ‹ÁTy³
(
com¶‘edURL
, 
£rviûTy³
è=ğ
ObjeùCÚ‹ÁN‘sÿ³Plugš
)

286 
boŞ
 
	gsucûss
 = 
objeùEËm’t
->
di¥©chBefÜeLßdEv’t
(
u¾
è&& 
äame
->
lßd”
()->
»que¡Objeù
(
this
, u¾, objeùEËm’t->
g‘A‰ribu‹
(
ÇmeA‰r
), 
£rviûTy³
, 
·¿mNames
, 
·¿mV®ues
);

287 ià(!
	gsucûss
 && 
	gm_hasF®lbackCÚ‹Á
)

288 
	gobjeùEËm’t
->
»nd”F®lbackCÚ‹Á
();

290 } ià(
node
()->
hasTagName
(
embedTag
)) {

291 
HTMLEmbedEËm’t
* 
	gembedEËm’t
 = 
¡©ic_ÿ¡
<HTMLEmbedEËm’t*>(
node
());

292 
	gembedEËm’t
->
£tN“dWidg‘Upd©e
(
çl£
);

293 
	gu¾
 = 
embedEËm’t
->
u¾
();

294 
	g£rviûTy³
 = 
embedEËm’t
->
£rviûTy³
();

296 ià(
	gu¾
.
isEm±y
(è&& 
	g£rviûTy³
.isEmpty())

298 ià(!
isURLAÎowed
(
docum’t
(), 
u¾
))

302 
NamedNodeM­
* 
	g©Œibu‹s
 = 
embedEËm’t
->
©Œibu‹s
();

303 ià(
	g©Œibu‹s
) {

304 
	gi
 = 0; i < 
	g©Œibu‹s
->
Ëngth
(); ++i) {

305 
A‰ribu‹
* 
	g™
 = 
©Œibu‹s
->
©Œibu‹I‹m
(
i
);

306 
	g·¿mNames
.
­³nd
(
™
->
Çme
().
loÿlName
().
¡ršg
());

307 
	g·¿mV®ues
.
­³nd
(
™
->
v®ue
().
¡ršg
());

311 ià(
	gÚlyC»©eNÚN‘sÿ³Plugšs
) {

312 
KURL
 
	gcom¶‘edURL
;

313 ià(!
	gu¾
.
isEm±y
())

314 
	gcom¶‘edURL
 = 
äame
->
lßd”
()->
com¶‘eURL
(
u¾
);

316 ià(
	gäame
->
lßd”
()->
ş›Á
()->
objeùCÚ‹ÁTy³
(
com¶‘edURL
, 
£rviûTy³
è=ğ
ObjeùCÚ‹ÁN‘sÿ³Plugš
)

320 ià(
	gembedEËm’t
->
di¥©chBefÜeLßdEv’t
(
u¾
))

321 
	gäame
->
lßd”
()->
»que¡Objeù
(
this
, 
u¾
, 
embedEËm’t
->
g‘A‰ribu‹
(
ÇmeA‰r
), 
£rviûTy³
, 
·¿mNames
, 
·¿mV®ues
);

323 #ià
ENABLE
(
PLUGIN_PROXY_FOR_VIDEO
)

324 ià(
node
()->
hasTagName
(
videoTag
è||‚ode()->hasTagName(
audioTag
)) {

325 
HTMLMedŸEËm’t
* 
	gmedŸEËm’t
 = 
¡©ic_ÿ¡
<HTMLMedŸEËm’t*>(
node
());

326 
KURL
 
	gku¾
;

328 
	gmedŸEËm’t
->
g‘PlugšProxyP¬ams
(
ku¾
, 
·¿mNames
, 
·¿mV®ues
);

329 
	gmedŸEËm’t
->
£tN“dWidg‘Upd©e
(
çl£
);

330 
	gäame
->
lßd”
()->
lßdMedŸPÏy”ProxyPlugš
(
node
(), 
ku¾
, 
·¿mNames
, 
·¿mV®ues
);

335 
	gR’d”EmbeddedObjeù
::
£tShowsMissšgPlugšIndiÿtÜ
()

337 
m_»¶aûm’tText
 = 
missšgPlugšText
();

340 
	gR’d”EmbeddedObjeù
::
£tShowsC¿shedPlugšIndiÿtÜ
()

342 
m_»¶aûm’tText
 = 
üashedPlugšText
();

345 
	gR’d”EmbeddedObjeù
::
·št
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

347 ià(!
	gm_»¶aûm’tText
.
isNuÎ
()) {

348 
	gR’d”R•Ïûd
::
·št
(
·štInfo
, 
tx
, 
ty
);

352 
	gR’d”P¬tObjeù
::
·št
(
·štInfo
, 
tx
, 
ty
);

355 
	gR’d”EmbeddedObjeù
::
·štR•Ïûd
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

357 ià(!
	gm_»¶aûm’tText
)

360 ià(
	g·štInfo
.
	gpha£
 =ğ
PaštPha£S–eùiÚ
)

363 
G¿phicsCÚ‹xt
* 
	gcÚ‹xt
 = 
·štInfo
.
cÚ‹xt
;

364 ià(
	gcÚ‹xt
->
·štšgDi§bËd
())

367 
FlßtReù
 
	g¶ugšReù
 = 
cÚ‹ÁBoxReù
();

368 
	g¶ugšReù
.
move
(
tx
, 
ty
);

370 
FÚtDesütiÚ
 
	gfÚtDesütiÚ
;

371 
	gR’d”Theme
::
deçuÉTheme
()->
sy¡emFÚt
(
CSSV®ueWebk™Sm®lCÚŒŞ
, 
fÚtDesütiÚ
);

372 
	gfÚtDesütiÚ
.
£tWeight
(
FÚtWeightBŞd
);

373 
S‘tšgs
* 
	g£‰šgs
 = 
docum’t
()->
£‰šgs
();

374 
ASSERT
(
£‰šgs
);

375 ià(!
	g£‰šgs
)

377 
	gfÚtDesütiÚ
.
£tR’d”šgMode
(
£‰šgs
->
fÚtR’d”šgMode
());

378 
	gfÚtDesütiÚ
.
£tCompu‹dSize
(
fÚtDesütiÚ
.
¥ecif›dSize
());

379 
FÚt
 
fÚt
(
fÚtDesütiÚ
, 0, 0);

380 
	gfÚt
.
upd©e
(0);

382 
TextRun
 
run
(
m_»¶aûm’tText
.
ch¬aù”s
(), m_»¶aûm’tText.
Ëngth
());

383 
	grun
.
di§bËRoundšgHacks
();

384 
	g‹xtWidth
 = 
fÚt
.
æßtWidth
(
run
);

386 
FlßtReù
 
	g»¶aûm’tTextReù
;

387 
	g»¶aûm’tTextReù
.
£tSize
(
FlßtSize
(
‹xtWidth
 + 
»¶aûm’tTextRoundedReùLeáRightTextM¬gš
 * 2, 
»¶aûm’tTextRoundedReùHeight
));

388 
	g»¶aûm’tTextReù
.
£tLoÿtiÚ
(
FlßtPošt
((
¶ugšReù
.
size
().
width
(è/ 2 - 
»¶aûm’tTextReù
.size().width(è/ 2è+…lugšReù.
loÿtiÚ
().
x
(),

389 (
¶ugšReù
.
size
().
height
(è/ 2 - 
»¶aûm’tTextReù
.size().height(è/ 2è+…lugšReù.
loÿtiÚ
().
y
()));

391 
P©h
 
	g·th
 = P©h::
ü—‹RoundedReùªgË
(
»¶aûm’tTextReù
, 
FlßtSize
(
»¶aûm’tTextRoundedReùRadius
,„eplacementTextRoundedRectRadius));

392 
	gcÚ‹xt
->
§ve
();

393 
	gcÚ‹xt
->
ş
(
¶ugšReù
);

394 
	gcÚ‹xt
->
begšP©h
();

395 
	gcÚ‹xt
->
addP©h
(
·th
);

396 
	gcÚ‹xt
->
£tAÍha
(
»¶aûm’tTextRoundedReùO·c™y
);

397 
	gcÚ‹xt
->
£tFlCŞÜ
(
CŞÜ
::
wh™e
, 
¡yË
()->
cŞÜS·û
());

398 
	gcÚ‹xt
->
flP©h
();

400 
FlßtPošt
 
Ïb–Pošt
(
roundf
(
»¶aûm’tTextReù
.
loÿtiÚ
().
x
(è+ (»¶aûm’tTextReù.
size
().
width
(è- 
‹xtWidth
) / 2),

401 
roundf
(
»¶aûm’tTextReù
.
loÿtiÚ
().
y
()+ (»¶aûm’tTextReù.
size
().
height
(è- 
fÚt
.height()è/ 2 + fÚt.
asûÁ
()));

402 
	gcÚ‹xt
->
£tAÍha
(
»¶aûm’tTextTextO·c™y
);

403 
	gcÚ‹xt
->
£tFlCŞÜ
(
CŞÜ
::
bÏck
, 
¡yË
()->
cŞÜS·û
());

404 
	gcÚ‹xt
->
d¿wBidiText
(
fÚt
, 
run
, 
Ïb–Pošt
);

405 
	gcÚ‹xt
->
»¡Üe
();

408 
	gR’d”EmbeddedObjeù
::
Ïyout
()

410 
ASSERT
(
ÃedsLayout
());

412 
ÿlcWidth
();

413 
ÿlcHeight
();

415 
	gR’d”P¬t
::
Ïyout
();

417 
	gm_ov”æow
.
ş—r
();

418 
addShadowOv”æow
();

420 ià(!
widg‘
(è&& 
äameV›w
())

421 
äameV›w
()->
addWidg‘ToUpd©e
(
this
);

423 
£tN“dsLayout
(
çl£
);

	@RenderEmbeddedObject.h

23 #iâdeà
R’d”EmbeddedObjeù_h


24 
	#R’d”EmbeddedObjeù_h


	)

26 
	~"R’d”P¬tObjeù.h
"

28 
Çme¥aû
 
	gWebCÜe
 {

31 şas 
	cR’d”EmbeddedObjeù
 : 
public
 
R’d”P¬tObjeù
 {

32 
public
:

33 
R’d”EmbeddedObjeù
(
EËm’t
*);

34 
	gvœtu®
 ~
R’d”EmbeddedObjeù
();

36 
upd©eWidg‘
(
boŞ
 
ÚlyC»©eNÚN‘sÿ³Plugšs
);

37 
£tShowsMissšgPlugšIndiÿtÜ
();

38 
£tShowsC¿shedPlugšIndiÿtÜ
();

39 #ià
USE
(
ACCELERATED_COMPOSITING
)

40 
vœtu®
 
boŞ
 
®lowsAcûË¿‹dCompos™šg
() const;

43 
	g´iv©e
:

44 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderEmbeddedObject"; }

45 
vœtu®
 
boŞ
 
isEmbeddedObjeù
(ècÚ¡ {  
	gŒue
; }

47 
vœtu®
 
·štR•Ïûd
(
PaštInfo
&, , );

48 
vœtu®
 
·št
(
PaštInfo
& 
·štInfo
, , );

50 #ià
USE
(
ACCELERATED_COMPOSITING
)

51 
vœtu®
 
boŞ
 
»quœesLay”
() const;

54 
vœtu®
 
Ïyout
();

55 
SŒšg
 
	gm_»¶aûm’tText
;

58 
šlše
 
R’d”EmbeddedObjeù
* 
	$toR’d”EmbeddedObjeù
(
R’d”Objeù
* 
objeù
)

60 
	`ASSERT
(!
objeù
 || !
	`¡rcmp
(objeù->
	`»nd”Name
(), "RenderEmbeddedObject"));

61  
¡©ic_ÿ¡
<
R’d”EmbeddedObjeù
*>(
objeù
);

62 
	}
}

65 
toR’d”EmbeddedObjeù
(cÚ¡ 
R’d”EmbeddedObjeù
*);

	@RenderFieldset.cpp

24 
	~"cÚfig.h
"

25 
	~"R’d”F›ld£t.h
"

27 
	~"CSSPrİ”tyNames.h
"

28 
	~"HTMLNames.h
"

29 
	~"G¿phicsCÚ‹xt.h
"

31 #ià
ENABLE
(
WML
)

32 
	~"WMLNames.h
"

35 
usšg
 
	g¡d
::
mš
;

36 
usšg
 
	g¡d
::
max
;

38 
Çme¥aû
 
	gWebCÜe
 {

40 
usšg
 
Çme¥aû
 
	gHTMLNames
;

42 
	gR’d”F›ld£t
::
R’d”F›ld£t
(
Node
* 
–em’t
)

43 : 
R’d”Block
(
–em’t
)

47 
R’d”F›ld£t
::
ÿlcP»fWidths
()

49 
R’d”Block
::
ÿlcP»fWidths
();

50 ià(
R’d”Box
* 
	gËg’d
 = 
fšdLeg’d
()) {

51 
Ëg’dMšWidth
 = 
Ëg’d
->
mšP»fWidth
();

53 
L’gth
 
	gËg’dM¬gšLeá
 = 
Ëg’d
->
¡yË
()->
m¬gšLeá
();

54 
L’gth
 
	gËg’dM¬gšRight
 = 
Ëg’d
->
¡yË
()->
m¬gšLeá
();

56 ià(
	gËg’dM¬gšLeá
.
isFixed
())

57 
	gËg’dMšWidth
 +ğ
Ëg’dM¬gšLeá
.
v®ue
();

59 ià(
	gËg’dM¬gšRight
.
isFixed
())

60 
	gËg’dMšWidth
 +ğ
Ëg’dM¬gšRight
.
v®ue
();

62 
	gm_mšP»fWidth
 = 
max
(
m_mšP»fWidth
, 
Ëg’dMšWidth
 + 
·ddšgLeá
(è+ 
·ddšgRight
(è+ 
bÜd”Leá
(è+ 
bÜd”Right
());

66 
R’d”Objeù
* 
	gR’d”F›ld£t
::
ÏyoutLeg’d
(
boŞ
 
»ÏyoutChd»n
)

68 
R’d”Box
* 
Ëg’d
 = 
fšdLeg’d
();

69 ià(
	gËg’d
) {

70 ià(
	g»ÏyoutChd»n
)

71 
	gËg’d
->
£tN“dsLayout
(
Œue
);

72 
	gËg’d
->
ÏyoutIfN“ded
();

74 
	gxPos
;

75 ià(
¡yË
()->
dœeùiÚ
(è=ğ
RTL
) {

76 
Ëg’d
->
¡yË
()->
‹xtAlign
()) {

77 
LEFT
:

78 
xPos
 = 
bÜd”Leá
(è+ 
·ddšgLeá
();

80 
	gCENTER
:

81 
xPos
 = (
width
(è- 
Ëg’d
->width()) / 2;

84 
xPos
 = 
width
(è- 
·ddšgRight
(è- 
bÜd”Right
(è- 
Ëg’d
->width(è-†eg’d->
m¬gšRight
();

87 
	gËg’d
->
¡yË
()->
‹xtAlign
()) {

88 
	gRIGHT
:

89 
xPos
 = 
width
(è- 
·ddšgRight
(è- 
bÜd”Right
(è- 
Ëg’d
->width();

91 
	gCENTER
:

92 
xPos
 = (
width
(è- 
Ëg’d
->width()) / 2;

95 
xPos
 = 
bÜd”Leá
(è+ 
·ddšgLeá
(è+ 
Ëg’d
->
m¬gšLeá
();

98 
	gb
 = 
bÜd”Tİ
();

99 
	gh
 = 
Ëg’d
->
height
();

100 
	gËg’d
->
£tLoÿtiÚ
(
xPos
, 
max
((
b
-
h
)/2, 0));

101 
£tHeight
(
max
(
b
, 
h
è+ 
·ddšgTİ
());

103  
	gËg’d
;

106 
R’d”Box
* 
	gR’d”F›ld£t
::
fšdLeg’d
() const

108 
R’d”Objeù
* 
Ëg’d
 = 
fœ¡Chd
(); 
	gËg’d
;†eg’d =†eg’d->
ÃxtSiblšg
()) {

109 ià(!
Ëg’d
->
isFlßtšgOrPos™iÚed
(è&&†eg’d->
node
() &&

110 (
Ëg’d
->
node
()->
hasTagName
(
Ëg’dTag
)

111 #ià
ENABLE
(
WML
)

112 || 
Ëg’d
->
node
()->
hasTagName
(
WMLNames
::
š£¹edLeg’dTag
)

116  
toR’d”Box
(
Ëg’d
);

121 
	gR’d”F›ld£t
::
·štBoxDecÜ©iÚs
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

123 ià(!
shouldPaštW™hšRoÙ
(
·štInfo
))

126 
	gw
 = 
width
();

127 
	gh
 = 
height
();

128 
R’d”Box
* 
	gËg’d
 = 
fšdLeg’d
();

129 ià(!
	gËg’d
)

130  
	gR’d”Block
::
·štBoxDecÜ©iÚs
(
·štInfo
, 
tx
, 
ty
);

132 
	gyOff
 = (
Ëg’d
->
y
(è> 0è? 0 : (Ëg’d->
height
(è- 
bÜd”Tİ
()) / 2;

133 
	gËg’dBÙtom
 = 
ty
 + 
Ëg’d
->
y
(è+†eg’d->
height
();

134 
	gh
 -ğ
yOff
;

135 
	gty
 +ğ
yOff
;

137 
·štBoxShadow
(
·štInfo
.
cÚ‹xt
, 
tx
, 
ty
, 
w
, 
h
, 
¡yË
(), 
NÜm®
);

139 
·štFlLay”s
(
·štInfo
, 
¡yË
()->
backgroundCŞÜ
(), styË()->
backgroundLay”s
(), 
tx
, 
ty
, 
w
, 
h
);

140 
·štBoxShadow
(
·štInfo
.
cÚ‹xt
, 
tx
, 
ty
, 
w
, 
h
, 
¡yË
(), 
In£t
);

142 ià(!
¡yË
()->
hasBÜd”
())

146 ià(!
¡yË
()->
hasBÜd”Radius
())

147  
·štBÜd”MšusLeg’d
(
·štInfo
.
cÚ‹xt
, 
tx
, 
ty
, 
w
, 
h
, 
¡yË
(), 
Ëg’d
->
x
(),†eg’d->
width
(), 
Ëg’dBÙtom
);

151 
G¿phicsCÚ‹xt
* 
	gg¿phicsCÚ‹xt
 = 
·štInfo
.
cÚ‹xt
;

152 
	gg¿phicsCÚ‹xt
->
§ve
();

154 
	gşTİ
 = 
ty
;

155 
	gşHeight
 = 
max
(
¡©ic_ÿ¡
<>(
¡yË
()->
bÜd”TİWidth
()), 
Ëg’d
->
height
());

157 
	gg¿phicsCÚ‹xt
->
şOut
(
IÁReù
(
tx
 + 
Ëg’d
->
x
(), 
şTİ
,

158 
Ëg’d
->
width
(), 
şHeight
));

159 
·štBÜd”
(
·štInfo
.
cÚ‹xt
, 
tx
, 
ty
, 
w
, 
h
, 
¡yË
(), 
Œue
,rue);

161 
	gg¿phicsCÚ‹xt
->
»¡Üe
();

164 
	gR’d”F›ld£t
::
·štMask
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

166 ià(
¡yË
()->
visib™y
(è!ğ
VISIBLE
 || 
·štInfo
.
pha£
 !ğ
PaštPha£Mask
)

169 
	gw
 = 
width
();

170 
	gh
 = 
height
();

171 
R’d”Box
* 
	gËg’d
 = 
fšdLeg’d
();

172 ià(!
	gËg’d
)

173  
	gR’d”Block
::
·štMask
(
·štInfo
, 
tx
, 
ty
);

175 
	gyOff
 = (
Ëg’d
->
y
(è> 0è? 0 : (Ëg’d->
height
(è- 
bÜd”Tİ
()) / 2;

176 
	gh
 -ğ
yOff
;

177 
	gty
 +ğ
yOff
;

179 
·štMaskImages
(
·štInfo
, 
tx
, 
ty
, 
w
, 
h
);

182 
	gR’d”F›ld£t
::
·štBÜd”MšusLeg’d
(
G¿phicsCÚ‹xt
* 
g¿phicsCÚ‹xt
, 
tx
, 
ty
, 
w
, 
h
,

183 cÚ¡ 
R’d”StyË
* 
¡yË
, 
lx
, 
lw
, 
lb
)

185 cÚ¡ 
	gCŞÜ
& 
	gtc
 = 
¡yË
->
vis™edD•’d’tCŞÜ
(
CSSPrİ”tyBÜd”TİCŞÜ
);

186 cÚ¡ 
	gCŞÜ
& 
	gbc
 = 
¡yË
->
vis™edD•’d’tCŞÜ
(
CSSPrİ”tyBÜd”BÙtomCŞÜ
);

188 
EBÜd”StyË
 
	gts
 = 
¡yË
->
bÜd”TİStyË
();

189 
EBÜd”StyË
 
	gbs
 = 
¡yË
->
bÜd”BÙtomStyË
();

190 
EBÜd”StyË
 
	gls
 = 
¡yË
->
bÜd”LeáStyË
();

191 
EBÜd”StyË
 
	grs
 = 
¡yË
->
bÜd”RightStyË
();

193 
boŞ
 
	g»nd”_t
 = 
ts
 > 
BHIDDEN
;

194 
boŞ
 
	g»nd”_l
 = 
ls
 > 
BHIDDEN
;

195 
boŞ
 
	g»nd”_r
 = 
rs
 > 
BHIDDEN
;

196 
boŞ
 
	g»nd”_b
 = 
bs
 > 
BHIDDEN
;

198 
	gbÜd”LeáWidth
 = 
¡yË
->
bÜd”LeáWidth
();

199 
	gbÜd”RightWidth
 = 
¡yË
->
bÜd”RightWidth
();

201 ià(
	g»nd”_t
) {

202 ià(
	glx
 >ğ
bÜd”LeáWidth
)

203 
d¿wLšeFÜBoxSide
(
g¿phicsCÚ‹xt
, 
tx
, 
ty
,x + 
mš
(
lx
, 
w
),y + 
¡yË
->
bÜd”TİWidth
(), 
BSTİ
, 
tc
, 
ts
,

204 (
»nd”_l
 && (
ls
 =ğ
DOTTED
 ||† =ğ
DASHED
 ||† =ğ
DOUBLE
è? 
bÜd”LeáWidth
 : 0),

205 (
lx
 >ğ
w
 && 
»nd”_r
 && (
rs
 =ğ
DOTTED
 ||„ =ğ
DASHED
 ||„ =ğ
DOUBLE
è? 
bÜd”RightWidth
 : 0));

206 ià(
	glx
 + 
	glw
 <ğ
w
 - 
bÜd”RightWidth
)

207 
d¿wLšeFÜBoxSide
(
g¿phicsCÚ‹xt
, 
tx
 + 
max
(0, 
lx
 + 
lw
), 
ty
,x + 
w
,y + 
¡yË
->
bÜd”TİWidth
(), 
BSTİ
, 
tc
, 
ts
,

208 (
lx
 + 
lw
 <ğ0 && 
»nd”_l
 && (
ls
 =ğ
DOTTED
 ||† =ğ
DASHED
 ||† =ğ
DOUBLE
è? 
bÜd”LeáWidth
 : 0),

209 (
»nd”_r
 && (
rs
 =ğ
DOTTED
 ||„ =ğ
DASHED
 ||„ =ğ
DOUBLE
è? 
bÜd”RightWidth
 : 0));

212 ià(
	g»nd”_b
)

213 
d¿wLšeFÜBoxSide
(
g¿phicsCÚ‹xt
, 
tx
, 
ty
 + 
h
 - 
¡yË
->
bÜd”BÙtomWidth
(),x + 
w
,y + h, 
BSBÙtom
, 
bc
, 
bs
,

214 (
»nd”_l
 && (
ls
 =ğ
DOTTED
 ||† =ğ
DASHED
 ||† =ğ
DOUBLE
è? 
¡yË
->
bÜd”LeáWidth
() : 0),

215 (
»nd”_r
 && (
rs
 =ğ
DOTTED
 ||„ =ğ
DASHED
 ||„ =ğ
DOUBLE
è? 
¡yË
->
bÜd”RightWidth
() : 0));

217 ià(
	g»nd”_l
) {

218 cÚ¡ 
	gCŞÜ
& 
	glc
 = 
¡yË
->
vis™edD•’d’tCŞÜ
(
CSSPrİ”tyBÜd”LeáCŞÜ
);

219 
	g¡¬tY
 = 
ty
;

221 
boŞ
 
	gignÜe_tİ
 =

222 (
tc
 =ğ
lc
) &&

223 (
ls
 >ğ
OUTSET
) &&

224 (
ts
 =ğ
DOTTED
 || =ğ
DASHED
 || =ğ
SOLID
 || =ğ
OUTSET
);

226 
boŞ
 
	gignÜe_bÙtom
 =

227 (
bc
 =ğ
lc
) &&

228 (
ls
 >ğ
OUTSET
) &&

229 (
bs
 =ğ
DOTTED
 || b =ğ
DASHED
 || b =ğ
SOLID
 || b =ğ
INSET
);

231 ià(
	glx
 < 
	gbÜd”LeáWidth
 &&†x + 
	glw
 > 0) {

233 
	gignÜe_tİ
 = 
Œue
;

234 
	g¡¬tY
 = 
lb
;

237 
d¿wLšeFÜBoxSide
(
g¿phicsCÚ‹xt
, 
tx
, 
¡¬tY
,x + 
bÜd”LeáWidth
, 
ty
 + 
h
, 
BSLeá
, 
lc
, 
ls
,

238 
ignÜe_tİ
 ? 0 : 
¡yË
->
bÜd”TİWidth
(), 
ignÜe_bÙtom
 ? 0 : styË->
bÜd”BÙtomWidth
());

241 ià(
	g»nd”_r
) {

242 cÚ¡ 
	gCŞÜ
& 
	grc
 = 
¡yË
->
vis™edD•’d’tCŞÜ
(
CSSPrİ”tyBÜd”RightCŞÜ
);

243 
	g¡¬tY
 = 
ty
;

245 
boŞ
 
	gignÜe_tİ
 =

246 (
tc
 =ğ
rc
) &&

247 (
rs
 >ğ
DOTTED
 ||„ =ğ
INSET
) &&

248 (
ts
 =ğ
DOTTED
 || =ğ
DASHED
 || =ğ
SOLID
 || =ğ
OUTSET
);

250 
boŞ
 
	gignÜe_bÙtom
 =

251 (
bc
 =ğ
rc
) &&

252 (
rs
 >ğ
DOTTED
 ||„ =ğ
INSET
) &&

253 (
bs
 =ğ
DOTTED
 || b =ğ
DASHED
 || b =ğ
SOLID
 || b =ğ
INSET
);

255 ià(
	glx
 < 
	gw
 &&†x + 
	glw
 > w - 
	gbÜd”RightWidth
) {

257 
	gignÜe_tİ
 = 
Œue
;

258 
	g¡¬tY
 = 
lb
;

261 
d¿wLšeFÜBoxSide
(
g¿phicsCÚ‹xt
, 
tx
 + 
w
 - 
bÜd”RightWidth
, 
¡¬tY
,x + w, 
ty
 + 
h
, 
BSRight
, 
rc
, 
rs
,

262 
ignÜe_tİ
 ? 0 : 
¡yË
->
bÜd”TİWidth
(), 
ignÜe_bÙtom
 ? 0 : styË->
bÜd”BÙtomWidth
());

266 
	gR’d”F›ld£t
::
¡yËDidChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
)

268 
	gR’d”Block
::
¡yËDidChªge
(
diff
, 
ŞdStyË
);

274 ià(
isIÆše
())

275 
£tR•Ïûd
(
Œue
);

	@RenderFieldset.h

24 #iâdeà
R’d”F›ld£t_h


25 
	#R’d”F›ld£t_h


	)

27 
	~"R’d”Block.h
"

29 
Çme¥aû
 
	gWebCÜe
 {

31 şas 
	cR’d”F›ld£t
 : 
public
 
R’d”Block
 {

32 
public
:

33 
R’d”F›ld£t
(
Node
*);

35 
R’d”Box
* 
fšdLeg’d
() const;

37 
	g´iv©e
:

38 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderFieldSet"; }

39 
vœtu®
 
boŞ
 
isF›ld£t
(ècÚ¡ {  
	gŒue
; }

41 
vœtu®
 
R’d”Objeù
* 
ÏyoutLeg’d
(
boŞ
 
»ÏyoutChd»n
);

43 
vœtu®
 
ÿlcP»fWidths
();

44 
vœtu®
 
boŞ
 
avoidsFlßts
(ècÚ¡ {  
	gŒue
; }

45 
vœtu®
 
boŞ
 
¡»tchesToMšIÁršsicWidth
(ècÚ¡ {  
	gŒue
; }

47 
vœtu®
 
¡yËDidChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
);

49 
vœtu®
 
·štBoxDecÜ©iÚs
(
PaštInfo
&, 
tx
, 
ty
);

50 
vœtu®
 
·štMask
(
PaštInfo
&, 
tx
, 
ty
);

52 
·štBÜd”MšusLeg’d
(
G¿phicsCÚ‹xt
*, 
tx
, 
ty
, 
w
, 
h
, cÚ¡ 
R’d”StyË
*, 
lx
, 
lw
, 
lb
);

55 
šlše
 
R’d”F›ld£t
* 
	$toR’d”F›ld£t
(
R’d”Objeù
* 
objeù
)

57 
	`ASSERT
(!
objeù
 || objeù->
	`isF›ld£t
());

58  
¡©ic_ÿ¡
<
R’d”F›ld£t
*>(
objeù
);

59 
	}
}

62 
toR’d”F›ld£t
(cÚ¡ 
R’d”F›ld£t
*);

	@RenderFileUploadControl.cpp

21 
	~"cÚfig.h
"

22 
	~"R’d”FeU¶ßdCÚŒŞ.h
"

24 
	~"Chrome.h
"

25 
	~"FeLi¡.h
"

26 
	~"F¿me.h
"

27 
	~"F¿meV›w.h
"

28 
	~"G¿phicsCÚ‹xt.h
"

29 
	~"HTMLIÅutEËm’t.h
"

30 
	~"HTMLNames.h
"

31 
	~"IcÚ.h
"

32 
	~"LoÿlizedSŒšgs.h
"

33 
	~"Page.h
"

34 
	~"R’d”Bu‰Ú.h
"

35 
	~"R’d”Text.h
"

36 
	~"R’d”Theme.h
"

37 
	~"R’d”V›w.h
"

38 
	~<m©h.h
>

40 
usšg
 
Çme¥aû
 
	g¡d
;

42 
Çme¥aû
 
	gWebCÜe
 {

44 
usšg
 
Çme¥aû
 
	gHTMLNames
;

46 cÚ¡ 
	gaá”Bu‰ÚS·cšg
 = 4;

47 cÚ¡ 
	gicÚHeight
 = 16;

48 cÚ¡ 
	gicÚWidth
 = 16;

49 cÚ¡ 
	gicÚF’ameS·cšg
 = 2;

50 cÚ¡ 
	gdeçuÉWidthNumCh¬s
 = 34;

51 cÚ¡ 
	gbu‰ÚShadowHeight
 = 2;

53 şas 
	cHTMLFeU¶ßdIÂ”Bu‰ÚEËm’t
 : 
public
 
HTMLIÅutEËm’t
 {

54 
public
:

55 
HTMLFeU¶ßdIÂ”Bu‰ÚEËm’t
(
Docum’t
*, 
Node
* 
shadowP¬’t
);

57 
vœtu®
 
boŞ
 
isShadowNode
(ècÚ¡ {  
	gŒue
; }

58 
vœtu®
 
Node
* 
shadowP¬’tNode
(è{  
	gm_shadowP¬’t
; }

60 
	g´iv©e
:

61 
Node
* 
m_shadowP¬’t
;

64 
	gR’d”FeU¶ßdCÚŒŞ
::
	$R’d”FeU¶ßdCÚŒŞ
(
HTMLIÅutEËm’t
* 
šput
)

65 : 
	`R’d”Block
(
šput
)

66 , 
	$m_bu‰Ú
(0)

68 
FeLi¡
* 
li¡
 = 
šput
->
	`fes
();

69 
VeùÜ
<
SŒšg
> 
f’ames
;

70 
Ëngth
 = 
li¡
 ?†i¡->
	`Ëngth
() : 0;

71 
i
 = 0; i < 
Ëngth
; ++i)

72 
f’ames
.
	`­³nd
(
li¡
->
	`™em
(
i
)->
	`·th
());

73 
m_feChoo£r
 = 
FeChoo£r
::
	`ü—‹
(
this
, 
f’ames
);

74 
	}
}

76 
	gR’d”FeU¶ßdCÚŒŞ
::~
	$R’d”FeU¶ßdCÚŒŞ
()

78 ià(
m_bu‰Ú
)

79 
m_bu‰Ú
->
	`d‘ach
();

80 
m_feChoo£r
->
	`discÚÃùCl›Á
();

81 
	}
}

83 
	gR’d”FeU¶ßdCÚŒŞ
::
	$¡yËDidChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
)

85 
R’d”Block
::
	`¡yËDidChªge
(
diff
, 
ŞdStyË
);

86 ià(
m_bu‰Ú
)

87 
m_bu‰Ú
->
	`»nd””
()->
	`£tStyË
(
	`ü—‹Bu‰ÚStyË
(
	`¡yË
()));

89 
	`£tR•Ïûd
(
	`isIÆše
());

90 
	}
}

92 
	gR’d”FeU¶ßdCÚŒŞ
::
	$v®ueChªged
()

95 
RefPŒ
<
FeChoo£r
> 
feChoo£r
 = 
m_feChoo£r
;

97 
HTMLIÅutEËm’t
* 
šputEËm’t
 = 
¡©ic_ÿ¡
<HTMLIÅutEËm’t*>(
	`node
());

98 
šputEËm’t
->
	`£tFeLi¡FromR’d””
(
feChoo£r
->
	`f’ames
());

99 
šputEËm’t
->
	`di¥©chFÜmCÚŒŞChªgeEv’t
();

102 ià(!
feChoo£r
->
	`discÚÃùed
())

103 
	`»·št
();

104 
	}
}

106 
boŞ
 
	gR’d”FeU¶ßdCÚŒŞ
::
	$®lowsMuÉËFes
()

108 
HTMLIÅutEËm’t
* 
šput
 = 
¡©ic_ÿ¡
<HTMLIÅutEËm’t*>(
	`node
());

109  !
šput
->
	`g‘A‰ribu‹
(
muÉËA‰r
).
	`isNuÎ
();

110 
	}
}

112 
SŒšg
 
	gR’d”FeU¶ßdCÚŒŞ
::
	$acû±Ty³s
()

114  
¡©ic_ÿ¡
<
HTMLIÅutEËm’t
*>(
	`node
())->
	`acû±
();

115 
	}
}

117 
	gR’d”FeU¶ßdCÚŒŞ
::
choo£IcÚFÜFes
(
FeChoo£r
* 
choo£r
, cÚ¡ 
VeùÜ
<
SŒšg
>& 
f’ames
)

119 ià(
Chrome
* 
	gchromePoš‹r
 = 
chrome
())

120 
chromePoš‹r
->
choo£IcÚFÜFes
(
f’ames
, 
choo£r
);

123 
	gR’d”FeU¶ßdCÚŒŞ
::
	$şick
()

125 ià(
Chrome
* 
chromePoš‹r
 = 
	`chrome
())

126 
chromePoš‹r
->
	`runO³nPª–
(
	`node
()->
	`docum’t
()->
	`äame
(), 
m_feChoo£r
);

127 
	}
}

129 
Chrome
* 
	gR’d”FeU¶ßdCÚŒŞ
::
	$chrome
() const

131 
F¿me
* 
äame
 = 
	`node
()->
	`docum’t
()->
	`äame
();

132 ià(!
äame
)

134 
Page
* 
·ge
 = 
äame
->
	`·ge
();

135 ià(!
·ge
)

137  
·ge
->
	`chrome
();

138 
	}
}

140 
	gR’d”FeU¶ßdCÚŒŞ
::
	$upd©eFromEËm’t
()

142 
HTMLIÅutEËm’t
* 
šputEËm’t
 = 
¡©ic_ÿ¡
<HTMLIÅutEËm’t*>(
	`node
());

143 
	`ASSERT
(
šputEËm’t
->
	`šputTy³
(è=ğ
HTMLIÅutEËm’t
::
FILE
);

145 ià(!
m_bu‰Ú
) {

146 
m_bu‰Ú
 = 
Ãw
 
	`HTMLFeU¶ßdIÂ”Bu‰ÚEËm’t
(
	`docum’t
(), 
šputEËm’t
);

147 
m_bu‰Ú
->
	`£tIÅutTy³
("button");

148 
m_bu‰Ú
->
	`£tV®ue
(
	`feBu‰ÚChoo£FeLab–
());

149 
RefPŒ
<
R’d”StyË
> 
bu‰ÚStyË
 = 
	`ü—‹Bu‰ÚStyË
(
	`¡yË
());

150 
R’d”Objeù
* 
»nd””
 = 
m_bu‰Ú
->
	`ü—‹R’d””
(
	`»nd”A»Ç
(), 
bu‰ÚStyË
.
	`g‘
());

151 
m_bu‰Ú
->
	`£tR’d””
(
»nd””
);

152 
»nd””
->
	`£tStyË
(
bu‰ÚStyË
.
	`»Ëa£
());

153 
»nd””
->
	`upd©eFromEËm’t
();

154 
m_bu‰Ú
->
	`£tA‰ached
();

155 
m_bu‰Ú
->
	`£tInDocum’t
(
Œue
);

157 
	`addChd
(
»nd””
);

160 
m_bu‰Ú
->
	`£tDi§bËd
(!
	`theme
()->
	`isEÇbËd
(
this
));

164 
FeLi¡
* 
fes
 = 
šputEËm’t
->
	`fes
();

165 
	`ASSERT
(
fes
);

166 ià(
fes
 && fes->
	`isEm±y
(è&& !
m_feChoo£r
->
	`f’ames
().isEmpty()) {

167 
m_feChoo£r
->
	`ş—r
();

168 
	`»·št
();

170 
	}
}

172 
	gR’d”FeU¶ßdCÚŒŞ
::
	$maxF’ameWidth
() const

174  
	`max
(0, 
	`cÚ‹ÁWidth
(è- 
m_bu‰Ú
->
	`»nd”Box
()->
	`width
(è- 
aá”Bu‰ÚS·cšg


175 - (
m_feChoo£r
->
	`icÚ
(è? 
icÚWidth
 + 
icÚF’ameS·cšg
 : 0));

176 
	}
}

178 
	gPassRefPŒ
<
	gR’d”StyË
> 
	gR’d”FeU¶ßdCÚŒŞ
::
	$ü—‹Bu‰ÚStyË
(cÚ¡ 
R’d”StyË
* 
·»ÁStyË
) const

180 
RefPŒ
<
R’d”StyË
> 
¡yË
 = 
	`g‘CachedP£udoStyË
(
FILE_UPLOAD_BUTTON
);

181 ià(!
¡yË
) {

182 
¡yË
 = 
R’d”StyË
::
	`ü—‹
();

183 ià(
·»ÁStyË
)

184 
¡yË
->
	`šh”™From
(
·»ÁStyË
);

189 
¡yË
->
	`£tWh™eS·û
(
NOWRAP
);

191  
¡yË
.
	`»Ëa£
();

192 
	}
}

194 
	gR’d”FeU¶ßdCÚŒŞ
::
	$·štObjeù
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

196 ià(
	`¡yË
()->
	`visib™y
(è!ğ
VISIBLE
)

198 
	`ASSERT
(
m_feChoo£r
);

201 ià(
·štInfo
.
pha£
 =ğ
PaštPha£FÜeground
 ||…aštInfo.pha£ =ğ
PaštPha£ChdBlockBackgrounds
) {

202 
IÁReù
 
	`şReù
(
tx
 + 
	`bÜd”Leá
(), 
ty
 + 
	`bÜd”Tİ
(),

203 
	`width
(è- 
	`bÜd”Leá
(è- 
	`bÜd”Right
(), 
	`height
(è- 
	`bÜd”BÙtom
(è- 
	`bÜd”Tİ
(è+ 
bu‰ÚShadowHeight
);

204 ià(
şReù
.
	`isEm±y
())

206 
·štInfo
.
cÚ‹xt
->
	`§ve
();

207 
·štInfo
.
cÚ‹xt
->
	`ş
(
şReù
);

210 ià(
·štInfo
.
pha£
 =ğ
PaštPha£FÜeground
) {

211 cÚ¡ 
SŒšg
& 
di¥ÏyedF’ame
 = 
	`feTextV®ue
();

212 
Ëngth
 = 
di¥ÏyedF’ame
.
	`Ëngth
();

213 cÚ¡ 
UCh¬
* 
¡ršg
 = 
di¥ÏyedF’ame
.
	`ch¬aù”s
();

214 
TextRun
 
	`‹xtRun
(
¡ršg
, 
Ëngth
, 
çl£
, 0, 0, 
	`¡yË
()->
	`dœeùiÚ
(è=ğ
RTL
, styË()->
	`unicodeBidi
(è=ğ
Ov”ride
);

217 
cÚ‹ÁLeá
 = 
tx
 + 
	`bÜd”Leá
(è+ 
	`·ddšgLeá
();

218 
bu‰ÚAndIcÚWidth
 = 
m_bu‰Ú
->
	`»nd”Box
()->
	`width
(è+ 
aá”Bu‰ÚS·cšg


219 + (
m_feChoo£r
->
	`icÚ
(è? 
icÚWidth
 + 
icÚF’ameS·cšg
 : 0);

220 
‹xtX
;

221 ià(
	`¡yË
()->
	`dœeùiÚ
(è=ğ
LTR
)

222 
‹xtX
 = 
cÚ‹ÁLeá
 + 
bu‰ÚAndIcÚWidth
;

224 
‹xtX
 = 
cÚ‹ÁLeá
 + 
	`cÚ‹ÁWidth
(è- 
bu‰ÚAndIcÚWidth
 - 
	`¡yË
()->
	`fÚt
().
	`width
(
‹xtRun
);

226 
R’d”Bu‰Ú
* 
bu‰ÚR’d””
 = 
	`toR’d”Bu‰Ú
(
m_bu‰Ú
->
	`»nd””
());

227 
‹xtY
 = 
bu‰ÚR’d””
->
	`absŞu‹BoundšgBoxReù
().
	`y
()

228 + 
bu‰ÚR’d””
->
	`m¬gšTİ
(è+ bu‰ÚR’d””->
	`bÜd”Tİ
(è+ bu‰ÚR’d””->
	`·ddšgTİ
()

229 + 
bu‰ÚR’d””
->
	`ba£lšePos™iÚ
(
Œue
, 
çl£
);

231 
·štInfo
.
cÚ‹xt
->
	`£tFlCŞÜ
(
	`¡yË
()->
	`cŞÜ
(), styË()->
	`cŞÜS·û
());

234 
·štInfo
.
cÚ‹xt
->
	`d¿wBidiText
(
	`¡yË
()->
	`fÚt
(), 
‹xtRun
, 
	`IÁPošt
(
‹xtX
, 
‹xtY
));

236 ià(
m_feChoo£r
->
	`icÚ
()) {

238 
icÚY
 = 
ty
 + 
	`bÜd”Tİ
(è+ 
	`·ddšgTİ
(è+ (
	`cÚ‹ÁHeight
(è- 
icÚHeight
) / 2;

239 
icÚX
;

240 ià(
	`¡yË
()->
	`dœeùiÚ
(è=ğ
LTR
)

241 
icÚX
 = 
cÚ‹ÁLeá
 + 
m_bu‰Ú
->
	`»nd”Box
()->
	`width
(è+ 
aá”Bu‰ÚS·cšg
;

243 
icÚX
 = 
cÚ‹ÁLeá
 + 
	`cÚ‹ÁWidth
(è- 
m_bu‰Ú
->
	`»nd”Box
()->
	`width
(è- 
aá”Bu‰ÚS·cšg
 - 
icÚWidth
;

246 
m_feChoo£r
->
	`icÚ
()->
	`·št
(
·štInfo
.
cÚ‹xt
, 
	`IÁReù
(
icÚX
, 
icÚY
, 
icÚWidth
, 
icÚHeight
));

251 
R’d”Block
::
	`·štObjeù
(
·štInfo
, 
tx
, 
ty
);

254 ià(
·štInfo
.
pha£
 =ğ
PaštPha£FÜeground
 ||…aštInfo.pha£ =ğ
PaštPha£ChdBlockBackgrounds
)

255 
·štInfo
.
cÚ‹xt
->
	`»¡Üe
();

256 
	}
}

258 
	gR’d”FeU¶ßdCÚŒŞ
::
	$ÿlcP»fWidths
()

260 
	`ASSERT
(
	`´efWidthsDœty
());

262 
m_mšP»fWidth
 = 0;

263 
m_maxP»fWidth
 = 0;

265 ià(
	`¡yË
()->
	`width
().
	`isFixed
(è&& styË()->width().
	`v®ue
() > 0)

266 
m_mšP»fWidth
 = 
m_maxP»fWidth
 = 
	`ÿlcCÚ‹ÁBoxWidth
(
	`¡yË
()->
	`width
().
	`v®ue
());

270 cÚ¡ 
UCh¬
 
ch
 = '0';

271 
ch¬Width
 = 
	`¡yË
()->
	`fÚt
().
	`æßtWidth
(
	`TextRun
(&
ch
, 1, 
çl£
, 0, 0, false, false, false));

272 
m_maxP»fWidth
 = ()
	`ûf
(
ch¬Width
 * 
deçuÉWidthNumCh¬s
);

275 ià(
	`¡yË
()->
	`mšWidth
().
	`isFixed
(è&& styË()->mšWidth().
	`v®ue
() > 0) {

276 
m_maxP»fWidth
 = 
	`max
(m_maxP»fWidth, 
	`ÿlcCÚ‹ÁBoxWidth
(
	`¡yË
()->
	`mšWidth
().
	`v®ue
()));

277 
m_mšP»fWidth
 = 
	`max
(m_mšP»fWidth, 
	`ÿlcCÚ‹ÁBoxWidth
(
	`¡yË
()->
	`mšWidth
().
	`v®ue
()));

278 } ià(
	`¡yË
()->
	`width
().
	`isP”ûÁ
(è|| (¡yË()->width().
	`isAuto
(è&& styË()->
	`height
().isPercent()))

279 
m_mšP»fWidth
 = 0;

281 
m_mšP»fWidth
 = 
m_maxP»fWidth
;

283 ià(
	`¡yË
()->
	`maxWidth
().
	`isFixed
(è&& styË()->maxWidth().
	`v®ue
(è!ğ
undefšedL’gth
) {

284 
m_maxP»fWidth
 = 
	`mš
(m_maxP»fWidth, 
	`ÿlcCÚ‹ÁBoxWidth
(
	`¡yË
()->
	`maxWidth
().
	`v®ue
()));

285 
m_mšP»fWidth
 = 
	`mš
(m_mšP»fWidth, 
	`ÿlcCÚ‹ÁBoxWidth
(
	`¡yË
()->
	`maxWidth
().
	`v®ue
()));

288 
toAdd
 = 
	`·ddšgLeá
(è+ 
	`·ddšgRight
(è+ 
	`bÜd”Leá
(è+ 
	`bÜd”Right
();

289 
m_mšP»fWidth
 +ğ
toAdd
;

290 
m_maxP»fWidth
 +ğ
toAdd
;

292 
	`£tP»fWidthsDœty
(
çl£
);

293 
	}
}

295 
	gR’d”FeU¶ßdCÚŒŞ
::
»ûiveDrİ³dFes
(cÚ¡ 
VeùÜ
<
SŒšg
>& 
·ths
)

297 ià(
®lowsMuÉËFes
())

298 
m_feChoo£r
->
choo£Fes
(
·ths
);

300 
	gm_feChoo£r
->
choo£Fe
(
·ths
[0]);

303 
SŒšg
 
	gR’d”FeU¶ßdCÚŒŞ
::
	$bu‰ÚV®ue
()

305 ià(!
m_bu‰Ú
)

306  
	`SŒšg
();

308  
m_bu‰Ú
->
	`v®ue
();

309 
	}
}

311 
SŒšg
 
	gR’d”FeU¶ßdCÚŒŞ
::
	$feTextV®ue
() const

313  
m_feChoo£r
->
	`ba£ÇmeFÜWidth
(
	`¡yË
()->
	`fÚt
(), 
	`maxF’ameWidth
());

314 
	}
}

316 
	gHTMLFeU¶ßdIÂ”Bu‰ÚEËm’t
::
	$HTMLFeU¶ßdIÂ”Bu‰ÚEËm’t
(
Docum’t
* 
doc
, 
Node
* 
shadowP¬’t
)

317 : 
	`HTMLIÅutEËm’t
(
šputTag
, 
doc
)

318 , 
	$m_shadowP¬’t
(
shadowP¬’t
)

320 
	}
}

	@RenderFileUploadControl.h

21 #iâdeà
R’d”FeU¶ßdCÚŒŞ_h


22 
	#R’d”FeU¶ßdCÚŒŞ_h


	)

24 
	~"FeChoo£r.h
"

25 
	~"R’d”Block.h
"

27 
Çme¥aû
 
	gWebCÜe
 {

29 
şass
 
	gChrome
;

30 
şass
 
	gHTMLIÅutEËm’t
;

36 
şass
 
	gR’d”FeU¶ßdCÚŒŞ
 : 
public
 
R’d”Block
, 
´iv©e
 
	gFeChoo£rCl›Á
 {

37 
	gpublic
:

38 
R’d”FeU¶ßdCÚŒŞ
(
HTMLIÅutEËm’t
*);

39 
	gvœtu®
 ~
R’d”FeU¶ßdCÚŒŞ
();

41 
vœtu®
 
boŞ
 
isFeU¶ßdCÚŒŞ
(ècÚ¡ {  
	gŒue
; }

43 
şick
();

45 
»ûiveDrİ³dFes
(cÚ¡ 
VeùÜ
<
SŒšg
>&);

47 
SŒšg
 
bu‰ÚV®ue
();

48 
SŒšg
 
feTextV®ue
() const;

50 
	g´iv©e
:

51 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderFileUploadControl"; }

53 
vœtu®
 
upd©eFromEËm’t
();

54 
vœtu®
 
ÿlcP»fWidths
();

55 
vœtu®
 
·štObjeù
(
PaštInfo
&, 
tx
, 
ty
);

57 
vœtu®
 
¡yËDidChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
);

60 
v®ueChªged
();

61 
»·št
(è{ 
	gR’d”Block
::repaint(); }

62 
boŞ
 
®lowsMuÉËFes
();

63 
SŒšg
 
acû±Ty³s
();

64 
choo£IcÚFÜFes
(
FeChoo£r
*, cÚ¡ 
VeùÜ
<
SŒšg
>&);

66 
Chrome
* 
chrome
() const;

67 
maxF’ameWidth
() const;

68 
	gPassRefPŒ
<
	gR’d”StyË
> 
ü—‹Bu‰ÚStyË
(cÚ¡ 
R’d”StyË
* 
·»ÁStyË
) const;

70 
	gRefPŒ
<
	gHTMLIÅutEËm’t
> 
	gm_bu‰Ú
;

71 
	gRefPŒ
<
	gFeChoo£r
> 
	gm_feChoo£r
;

74 
šlše
 
R’d”FeU¶ßdCÚŒŞ
* 
toR’d”FeU¶ßdCÚŒŞ
(
R’d”Objeù
* 
objeù
)

76 
ASSERT
(!
objeù
 || objeù->
isFeU¶ßdCÚŒŞ
());

77  
	g¡©ic_ÿ¡
<
	gR’d”FeU¶ßdCÚŒŞ
*>(
	gobjeù
);

80 
šlše
 cÚ¡ 
R’d”FeU¶ßdCÚŒŞ
* 
toR’d”FeU¶ßdCÚŒŞ
(cÚ¡ 
R’d”Objeù
* 
objeù
)

82 
ASSERT
(!
objeù
 || objeù->
isFeU¶ßdCÚŒŞ
());

83  
	g¡©ic_ÿ¡
<cÚ¡ 
	gR’d”FeU¶ßdCÚŒŞ
*>(
	gobjeù
);

87 
toR’d”FeU¶ßdCÚŒŞ
(cÚ¡ 
R’d”FeU¶ßdCÚŒŞ
*);

	@RenderFlexibleBox.cpp

25 
	~"cÚfig.h
"

26 
	~"R’d”FËxibËBox.h
"

28 
	~"Ch¬aù”Names.h
"

29 
	~"R’d”Lay”.h
"

30 
	~"R’d”V›w.h
"

31 
	~<wtf/StdLibExŒas.h
>

33 
usšg
 
Çme¥aû
 
	g¡d
;

35 
Çme¥aû
 
	gWebCÜe
 {

37 şas 
	cFËxBoxI‹¿tÜ
 {

38 
	gpublic
:

39 
FËxBoxI‹¿tÜ
(
R’d”FËxibËBox
* 
·»Á
)

41 
box
 = 
·»Á
;

42 ià(
	gbox
->
¡yË
()->
boxOr›Á
(è=ğ
HORIZONTAL
 && 
box
->¡yË()->
dœeùiÚ
(è=ğ
RTL
)

43 
fÜw¬d
 = 
box
->
¡yË
()->
boxDœeùiÚ
(è!ğ
BNORMAL
;

45 
	gfÜw¬d
 = 
box
->
¡yË
()->
boxDœeùiÚ
(è=ğ
BNORMAL
;

46 
	gÏ¡Ordš®
 = 1;

47 ià(!
	gfÜw¬d
) {

49 
R’d”Box
* 
	gchd
 = 
box
->
fœ¡ChdBox
();

50 
	gchd
) {

51 ià(
	gchd
->
¡yË
()->
boxOrdš®Group
(è> 
	gÏ¡Ordš®
)

52 
	gÏ¡Ordš®
 = 
chd
->
¡yË
()->
boxOrdš®Group
();

53 
	gchd
 = 
chd
->
ÃxtSiblšgBox
();

57 
»£t
();

60 
»£t
()

62 
	gcu¼’t
 = 0;

63 
	gcu¼’tOrdš®
 = 
fÜw¬d
 ? 0 : 
Ï¡Ordš®
+1;

66 
R’d”Box
* 
fœ¡
()

68 
»£t
();

69  
Ãxt
();

72 
R’d”Box
* 
Ãxt
()

75 ià(!
	gcu¼’t
) {

76 ià(
	gfÜw¬d
) {

77 
	gcu¼’tOrdš®
++;

78 ià(
	gcu¼’tOrdš®
 > 
	gÏ¡Ordš®
)

80 
	gcu¼’t
 = 
box
->
fœ¡ChdBox
();

82 
	gcu¼’tOrdš®
--;

83 ià(
	gcu¼’tOrdš®
 == 0)

85 
	gcu¼’t
 = 
box
->
Ï¡ChdBox
();

89 
	gcu¼’t
 = 
fÜw¬d
 ? 
cu¼’t
->
ÃxtSiblšgBox
(è: cu¼’t->
´eviousSiblšgBox
();

90 ià(
	gcu¼’t
 && cu¼’t->
¡yË
()->
boxOrdš®Group
(è> 
	gÏ¡Ordš®
)

91 
	gÏ¡Ordš®
 = 
cu¼’t
->
¡yË
()->
boxOrdš®Group
();

92 } !
	gcu¼’t
 || cu¼’t->
¡yË
()->
boxOrdš®Group
(è!ğ
cu¼’tOrdš®
 ||

93 
cu¼’t
->
¡yË
()->
visib™y
(è=ğ
COLLAPSE
);

94  
	gcu¼’t
;

97 
	g´iv©e
:

98 
R’d”FËxibËBox
* 
box
;

99 
R’d”Box
* 
	gcu¼’t
;

100 
boŞ
 
	gfÜw¬d
;

101 
	gcu¼’tOrdš®
;

102 
	gÏ¡Ordš®
;

105 
	gR’d”FËxibËBox
::
	$R’d”FËxibËBox
(
Node
* 
node
)

106 :
	$R’d”Block
(
node
)

108 
	`£tChd»nIÆše
(
çl£
);

109 
m_æexšgChd»n
 = 
m_¡»tchšgChd»n
 = 
çl£
;

110 
	}
}

112 
	gR’d”FËxibËBox
::~
	$R’d”FËxibËBox
()

114 
	}
}

116 
R’d”FËxibËBox
::
	$ÿlcHÜizÚlP»fWidths
()

118 
R’d”Box
* 
chd
 = 
	`fœ¡ChdBox
(); chd; chd = chd->
	`ÃxtSiblšgBox
()) {

120 ià(
chd
->
	`isPos™iÚed
(è|| chd->
	`¡yË
()->
	`visib™y
(è=ğ
COLLAPSE
)

126 
L’gth
 
ml
 = 
chd
->
	`¡yË
()->
	`m¬gšLeá
();

127 
L’gth
 
mr
 = 
chd
->
	`¡yË
()->
	`m¬gšRight
();

128 
m¬gš
 = 0, 
m¬gšLeá
 = 0, 
m¬gšRight
 = 0;

129 ià(
ml
.
	`isFixed
())

130 
m¬gšLeá
 +ğ
ml
.
	`v®ue
();

131 ià(
mr
.
	`isFixed
())

132 
m¬gšRight
 +ğ
mr
.
	`v®ue
();

133 
m¬gš
 = 
m¬gšLeá
 + 
m¬gšRight
;

135 
m_mšP»fWidth
 +ğ
chd
->
	`mšP»fWidth
(è+ 
m¬gš
;

136 
m_maxP»fWidth
 +ğ
chd
->
	`maxP»fWidth
(è+ 
m¬gš
;

138 
	}
}

140 
	gR’d”FËxibËBox
::
	$ÿlcV”tiÿlP»fWidths
()

142 
R’d”Box
* 
chd
 = 
	`fœ¡ChdBox
(); chd; chd = chd->
	`ÃxtSiblšgBox
()) {

144 ià(
chd
->
	`isPos™iÚed
(è|| chd->
	`¡yË
()->
	`visib™y
(è=ğ
COLLAPSE
)

150 
L’gth
 
ml
 = 
chd
->
	`¡yË
()->
	`m¬gšLeá
();

151 
L’gth
 
mr
 = 
chd
->
	`¡yË
()->
	`m¬gšRight
();

152 
m¬gš
 = 0;

153 ià(
ml
.
	`isFixed
())

154 
m¬gš
 +ğ
ml
.
	`v®ue
();

155 ià(
mr
.
	`isFixed
())

156 
m¬gš
 +ğ
mr
.
	`v®ue
();

158 
w
 = 
chd
->
	`mšP»fWidth
(è+ 
m¬gš
;

159 
m_mšP»fWidth
 = 
	`max
(
w
, m_minPrefWidth);

161 
w
 = 
chd
->
	`maxP»fWidth
(è+ 
m¬gš
;

162 
m_maxP»fWidth
 = 
	`max
(
w
, m_maxPrefWidth);

164 
	}
}

166 
	gR’d”FËxibËBox
::
	$ÿlcP»fWidths
()

168 
	`ASSERT
(
	`´efWidthsDœty
());

170 ià(
	`¡yË
()->
	`width
().
	`isFixed
(è&& styË()->width().
	`v®ue
() > 0)

171 
m_mšP»fWidth
 = 
m_maxP»fWidth
 = 
	`ÿlcCÚ‹ÁBoxWidth
(
	`¡yË
()->
	`width
().
	`v®ue
());

173 
m_mšP»fWidth
 = 
m_maxP»fWidth
 = 0;

175 ià(
	`hasMuÉËLšes
(è|| 
	`isV”tiÿl
())

176 
	`ÿlcV”tiÿlP»fWidths
();

178 
	`ÿlcHÜizÚlP»fWidths
();

180 
m_maxP»fWidth
 = 
	`max
(
m_mšP»fWidth
, m_maxPrefWidth);

183 ià(
	`¡yË
()->
	`mšWidth
().
	`isFixed
(è&& styË()->mšWidth().
	`v®ue
() > 0) {

184 
m_maxP»fWidth
 = 
	`max
(m_maxP»fWidth, 
	`ÿlcCÚ‹ÁBoxWidth
(
	`¡yË
()->
	`mšWidth
().
	`v®ue
()));

185 
m_mšP»fWidth
 = 
	`max
(m_mšP»fWidth, 
	`ÿlcCÚ‹ÁBoxWidth
(
	`¡yË
()->
	`mšWidth
().
	`v®ue
()));

188 ià(
	`¡yË
()->
	`maxWidth
().
	`isFixed
(è&& styË()->maxWidth().
	`v®ue
(è!ğ
undefšedL’gth
) {

189 
m_maxP»fWidth
 = 
	`mš
(m_maxP»fWidth, 
	`ÿlcCÚ‹ÁBoxWidth
(
	`¡yË
()->
	`maxWidth
().
	`v®ue
()));

190 
m_mšP»fWidth
 = 
	`mš
(m_mšP»fWidth, 
	`ÿlcCÚ‹ÁBoxWidth
(
	`¡yË
()->
	`maxWidth
().
	`v®ue
()));

193 
toAdd
 = 
	`bÜd”Leá
(è+ 
	`bÜd”Right
(è+ 
	`·ddšgLeá
(è+ 
	`·ddšgRight
();

195 ià(
	`hasOv”æowCl
(è&& 
	`¡yË
()->
	`ov”æowY
(è=ğ
OSCROLL
)

196 
toAdd
 +ğ
	`v”tiÿlSüŞlb¬Width
();

198 
m_mšP»fWidth
 +ğ
toAdd
;

199 
m_maxP»fWidth
 +ğ
toAdd
;

201 
	`£tP»fWidthsDœty
(
çl£
);

202 
	}
}

204 
	gR’d”FËxibËBox
::
	$ÏyoutBlock
(
boŞ
 
»ÏyoutChd»n
)

206 
	`ASSERT
(
	`ÃedsLayout
());

208 ià(!
»ÏyoutChd»n
 && 
	`ÏyoutOÆyPos™iÚedObjeùs
())

211 
LayoutR•aš‹r
 
	`»·š‹r
(*
this
, 
	`checkFÜR•aštDuršgLayout
());

212 
LayoutS‹Mašš”
 
	`¡©ePush”
(
	`v›w
(), 
this
, 
	`IÁSize
(
	`x
(), 
	`y
()), 
	`hasT¿nsfÜm
(è|| 
	`hasReæeùiÚ
());

214 
´eviousWidth
 = 
	`width
();

215 
´eviousHeight
 = 
	`height
();

217 
	`ÿlcWidth
();

218 
	`ÿlcHeight
();

220 
m_ov”æow
.
	`ş—r
();

222 ià(
´eviousWidth
 !ğ
	`width
(è|| 
´eviousHeight
 !ğ
	`height
() ||

223 (
	`·»Á
()->
	`isFËxibËBox
(è&&…¬’t()->
	`¡yË
()->
	`boxOr›Á
(è=ğ
HORIZONTAL
 &&

224 
	`·»Á
()->
	`¡yË
()->
	`boxAlign
(è=ğ
BSTRETCH
))

225 
»ÏyoutChd»n
 = 
Œue
;

227 
	`£tHeight
(0);

229 
m_æexšgChd»n
 = 
m_¡»tchšgChd»n
 = 
çl£
;

231 
	`š™MaxM¬gšV®ues
();

234 ià(
	`süŞlsOv”æow
()) {

235 ià(
	`¡yË
()->
	`ov”æowX
(è=ğ
OSCROLL
)

236 
	`Ïy”
()->
	`£tHasHÜizÚlSüŞlb¬
(
Œue
);

237 ià(
	`¡yË
()->
	`ov”æowY
(è=ğ
OSCROLL
)

238 
	`Ïy”
()->
	`£tHasV”tiÿlSüŞlb¬
(
Œue
);

241 ià(
	`isHÜizÚl
())

242 
	`ÏyoutHÜizÚlBox
(
»ÏyoutChd»n
);

244 
	`ÏyoutV”tiÿlBox
(
»ÏyoutChd»n
);

246 
	`ÿlcHeight
();

248 ià(
´eviousHeight
 !ğ
	`height
())

249 
»ÏyoutChd»n
 = 
Œue
;

251 
	`ÏyoutPos™iÚedObjeùs
(
»ÏyoutChd»n
 || 
	`isRoÙ
());

253 ià(!
	`isFlßtšgOrPos™iÚed
(è&& 
	`height
() == 0) {

261 
pos
 = 
	`maxTİPosM¬gš
();

262 
Ãg
 = 
	`maxTİNegM¬gš
();

263 ià(
	`maxBÙtomPosM¬gš
(è> 
pos
)

264 
pos
 = 
	`maxBÙtomPosM¬gš
();

265 ià(
	`maxBÙtomNegM¬gš
(è> 
Ãg
)

266 
Ãg
 = 
	`maxBÙtomNegM¬gš
();

267 
	`£tMaxTİM¬gšs
(
pos
, 
Ãg
);

268 
	`£tMaxBÙtomM¬gšs
(0, 0);

272 
FËxBoxI‹¿tÜ
 
	`™”©Ü
(
this
);

273 
R’d”Box
* 
chd
 = 
™”©Ü
.
	`fœ¡
(); chd; chd = i‹¿tÜ.
	`Ãxt
())

274 
	`addOv”æowFromChd
(
chd
);

277 
	`addShadowOv”æow
();

279 
¡©ePush”
.
	`pİ
();

283 ià(
	`hasOv”æowCl
())

284 
	`Ïy”
()->
	`upd©eSüŞlInfoAá”Layout
();

287 
»·š‹r
.
	`»·štAá”Layout
();

289 
	`£tN“dsLayout
(
çl£
);

290 
	}
}

293 
	$g©h”FËxChd»nInfo
(
FËxBoxI‹¿tÜ
& 
™”©Ü
, 
boŞ
 
»ÏyoutChd»n
, & 
highe¡FËxGroup
, & 
lowe¡FËxGroup
, boŞ& 
haveFËx
)

295 
R’d”Box
* 
chd
 = 
™”©Ü
.
	`fœ¡
();

296 
chd
) {

298 ià(!
chd
->
	`isPos™iÚed
(è&& chd->
	`¡yË
()->
	`boxFËx
() > 0.0f) {

301 
chd
->
	`£tOv”rideSize
(-1);

302 ià(!
»ÏyoutChd»n
)

303 
chd
->
	`£tChdN“dsLayout
(
Œue
, 
çl£
);

304 
haveFËx
 = 
Œue
;

305 
æexGroup
 = 
chd
->
	`¡yË
()->
	`boxFËxGroup
();

306 ià(
lowe¡FËxGroup
 == 0)

307 
lowe¡FËxGroup
 = 
æexGroup
;

308 ià(
æexGroup
 < 
lowe¡FËxGroup
)

309 
lowe¡FËxGroup
 = 
æexGroup
;

310 ià(
æexGroup
 > 
highe¡FËxGroup
)

311 
highe¡FËxGroup
 = 
æexGroup
;

313 
chd
 = 
™”©Ü
.
	`Ãxt
();

315 
	}
}

317 
	gR’d”FËxibËBox
::
	$ÏyoutHÜizÚlBox
(
boŞ
 
»ÏyoutChd»n
)

319 
toAdd
 = 
	`bÜd”BÙtom
(è+ 
	`·ddšgBÙtom
(è+ 
	`hÜizÚlSüŞlb¬Height
();

320 
yPos
 = 
	`bÜd”Tİ
(è+ 
	`·ddšgTİ
();

321 
xPos
 = 
	`bÜd”Leá
(è+ 
	`·ddšgLeá
();

322 
boŞ
 
heightS³cif›d
 = 
çl£
;

323 
ŞdHeight
 = 0;

325 
»maššgS·û
 = 0;

328 
FËxBoxI‹¿tÜ
 
	`™”©Ü
(
this
);

329 
highe¡FËxGroup
 = 0;

330 
lowe¡FËxGroup
 = 0;

331 
boŞ
 
haveFËx
 = 
çl£
;

332 
	`g©h”FËxChd»nInfo
(
™”©Ü
, 
»ÏyoutChd»n
, 
highe¡FËxGroup
, 
lowe¡FËxGroup
, 
haveFËx
);

334 
R’d”Box
* 
chd
;

336 
R’d”Block
::
	`¡¬tD–ayUpd©eSüŞlInfo
();

342 
	`£tHeight
(
yPos
);

344 
xPos
 = 
	`bÜd”Leá
(è+ 
	`·ddšgLeá
();

349 
maxAsûÁ
 = 0, 
maxDesûÁ
 = 0;

350 
chd
 = 
™”©Ü
.
	`fœ¡
();

351 
chd
) {

353 ià(
»ÏyoutChd»n
 || (
chd
->
	`isR•Ïûd
(è&& (chd->
	`¡yË
()->
	`width
().
	`isP”ûÁ
(è|| chd->¡yË()->
	`height
().isPercent())))

354 
chd
->
	`£tChdN“dsLayout
(
Œue
, 
çl£
);

356 ià(
chd
->
	`isPos™iÚed
()) {

357 
chd
 = 
™”©Ü
.
	`Ãxt
();

362 
chd
->
	`ÿlcV”tiÿlM¬gšs
();

365 
chd
->
	`ÏyoutIfN“ded
();

368 ià(
	`¡yË
()->
	`boxAlign
(è=ğ
BBASELINE
) {

369 
asûÁ
 = 
chd
->
	`fœ¡LšeBoxBa£lše
();

370 ià(
asûÁ
 == -1)

371 
asûÁ
 = 
chd
->
	`height
(è+ chd->
	`m¬gšBÙtom
();

372 
asûÁ
 +ğ
chd
->
	`m¬gšTİ
();

373 
desûÁ
 = (
chd
->
	`m¬gšTİ
(è+ chd->
	`height
(è+ chd->
	`m¬gšBÙtom
()è- 
asûÁ
;

376 
maxAsûÁ
 = 
	`max
(maxAsûÁ, 
asûÁ
);

379 
maxDesûÁ
 = 
	`max
(maxDesûÁ, 
desûÁ
);

382 
	`£tHeight
(
	`max
(
yPos
 + 
maxAsûÁ
 + 
maxDesûÁ
, 
	`height
()));

385 
	`£tHeight
(
	`max
(
	`height
(), 
yPos
 + 
chd
->
	`m¬gšTİ
(è+ chd->height(è+ chd->
	`m¬gšBÙtom
()));

387 
chd
 = 
™”©Ü
.
	`Ãxt
();

390 ià(!
™”©Ü
.
	`fœ¡
(è&& 
	`hasLšeIfEm±y
())

391 
	`£tHeight
(
	`height
(è+ 
	`lšeHeight
(
Œue
,rue));

393 
	`£tHeight
(
	`height
(è+ 
toAdd
);

395 
ŞdHeight
 = 
	`height
();

396 
	`ÿlcHeight
();

398 
»ÏyoutChd»n
 = 
çl£
;

399 ià(
ŞdHeight
 !ğ
	`height
())

400 
heightS³cif›d
 = 
Œue
;

403 
m_¡»tchšgChd»n
 = (
	`¡yË
()->
	`boxAlign
(è=ğ
BSTRETCH
);

404 
chd
 = 
™”©Ü
.
	`fœ¡
();

405 
chd
) {

406 ià(
chd
->
	`isPos™iÚed
()) {

407 
chd
->
	`cÚššgBlock
()->
	`š£¹Pos™iÚedObjeù
(child);

408 ià(
chd
->
	`¡yË
()->
	`hasSticX
()) {

409 ià(
	`¡yË
()->
	`dœeùiÚ
(è=ğ
LTR
)

410 
chd
->
	`Ïy”
()->
	`£tSticX
(
xPos
);

411 
chd
->
	`Ïy”
()->
	`£tSticX
(
	`width
(è- 
xPos
);

413 ià(
chd
->
	`¡yË
()->
	`hasSticY
()) {

414 
R’d”Lay”
* 
chdLay”
 = 
chd
->
	`Ïy”
();

415 ià(
chdLay”
->
	`¡©icY
(è!ğ
yPos
) {

416 
chd
->
	`Ïy”
()->
	`£tSticY
(
yPos
);

417 
chd
->
	`£tChdN“dsLayout
(
Œue
, 
çl£
);

420 
chd
 = 
™”©Ü
.
	`Ãxt
();

427 
ŞdChdHeight
 = 
chd
->
	`height
();

428 
chd
->
	`ÿlcHeight
();

429 ià(
ŞdChdHeight
 !ğ
chd
->
	`height
())

430 
chd
->
	`£tChdN“dsLayout
(
Œue
, 
çl£
);

431 
chd
->
	`ÏyoutIfN“ded
();

434 
xPos
 +ğ
chd
->
	`m¬gšLeá
();

435 
chdY
 = 
yPos
;

436 
	`¡yË
()->
	`boxAlign
()) {

437 
BCENTER
:

438 
chdY
 +ğ
chd
->
	`m¬gšTİ
(è+ 
	`max
(0, (
	`cÚ‹ÁHeight
(è- (chd->
	`height
(è+ chd->m¬gšTİ(è+ chd->
	`m¬gšBÙtom
()))/2);

440 
BBASELINE
: {

441 
asûÁ
 = 
chd
->
	`fœ¡LšeBoxBa£lše
();

442 ià(
asûÁ
 == -1)

443 
asûÁ
 = 
chd
->
	`height
(è+ chd->
	`m¬gšBÙtom
();

444 
asûÁ
 +ğ
chd
->
	`m¬gšTİ
();

445 
chdY
 +ğ
chd
->
	`m¬gšTİ
(è+ (
maxAsûÁ
 - 
asûÁ
);

448 
BEND
:

449 
chdY
 +ğ
	`cÚ‹ÁHeight
(è- 
chd
->
	`m¬gšBÙtom
(è- chd->
	`height
();

452 
chdY
 +ğ
chd
->
	`m¬gšTİ
();

456 
	`¶aûChd
(
chd
, 
xPos
, 
chdY
);

458 
xPos
 +ğ
chd
->
	`width
(è+ chd->
	`m¬gšRight
();

460 
chd
 = 
™”©Ü
.
	`Ãxt
();

463 
»maššgS·û
 = 
	`bÜd”Leá
(è+ 
	`·ddšgLeá
(è+ 
	`cÚ‹ÁWidth
(è- 
xPos
;

465 
m_¡»tchšgChd»n
 = 
çl£
;

466 ià(
m_æexšgChd»n
)

467 
haveFËx
 = 
çl£
;

468 ià(
haveFËx
) {

470 ià(!
»maššgS·û
)

476 
boŞ
 
ex·ndšg
 = 
»maššgS·û
 > 0;

477 
¡¬t
 = 
ex·ndšg
 ? 
lowe¡FËxGroup
 : 
highe¡FËxGroup
;

478 
’d
 = 
ex·ndšg
? 
highe¡FËxGroup
 : 
lowe¡FËxGroup
;

479 
i
 = 
¡¬t
; i <ğ
’d
 && 
»maššgS·û
; i++) {

481 
groupRemaššgS·û
 = 
»maššgS·û
;

487 
groupRemaššgS·ûAtBegšnšg
 = 
groupRemaššgS·û
;

488 
tÙ®FËx
 = 0.0f;

489 
chd
 = 
™”©Ü
.
	`fœ¡
();

490 
chd
) {

491 ià(
	`®lowedChdFËx
(
chd
, 
ex·ndšg
, 
i
))

492 
tÙ®FËx
 +ğ
chd
->
	`¡yË
()->
	`boxFËx
();

493 
chd
 = 
™”©Ü
.
	`Ãxt
();

495 
chd
 = 
™”©Ü
.
	`fœ¡
();

496 
¥aûAvaabËThisPass
 = 
groupRemaššgS·û
;

497 
chd
) {

498 
®lowedFËx
 = 
	`®lowedChdFËx
(
chd
, 
ex·ndšg
, 
i
);

499 ià(
®lowedFËx
) {

500 
´ojeùedFËx
 = (
®lowedFËx
 =ğ
INT_MAX
è?‡ÎowedFËx : ()×ÎowedFËx * (
tÙ®FËx
 / 
chd
->
	`¡yË
()->
	`boxFËx
()));

501 
¥aûAvaabËThisPass
 = 
ex·ndšg
 ? 
	`mš
(¥aûAvaabËThisPass, 
´ojeùedFËx
è: 
	`max
(spaceAvailableThisPass,…rojectedFlex);

503 
chd
 = 
™”©Ü
.
	`Ãxt
();

507 ià(!
¥aûAvaabËThisPass
 || 
tÙ®FËx
 == 0.0f) {

509 
groupRemaššgS·û
 = 0;

514 
chd
 = 
™”©Ü
.
	`fœ¡
();

515 
chd
 && 
¥aûAvaabËThisPass
 && 
tÙ®FËx
) {

516 ià(
	`®lowedChdFËx
(
chd
, 
ex·ndšg
, 
i
)) {

517 
¥aûAdd
 = ()(
¥aûAvaabËThisPass
 * (
chd
->
	`¡yË
()->
	`boxFËx
()/
tÙ®FËx
));

518 ià(
¥aûAdd
) {

519 
chd
->
	`£tOv”rideSize
(chd->
	`ov”rideWidth
(è+ 
¥aûAdd
);

520 
m_æexšgChd»n
 = 
Œue
;

521 
»ÏyoutChd»n
 = 
Œue
;

524 
¥aûAvaabËThisPass
 -ğ
¥aûAdd
;

525 
»maššgS·û
 -ğ
¥aûAdd
;

526 
groupRemaššgS·û
 -ğ
¥aûAdd
;

528 
tÙ®FËx
 -ğ
chd
->
	`¡yË
()->
	`boxFËx
();

530 
chd
 = 
™”©Ü
.
	`Ãxt
();

532 ià(
groupRemaššgS·û
 =ğ
groupRemaššgS·ûAtBegšnšg
) {

534 
chd
 = 
™”©Ü
.
	`fœ¡
();

535 
¥aûAdd
 = 
groupRemaššgS·û
 > 0 ? 1 : -1;

536 
chd
 && 
groupRemaššgS·û
) {

537 ià(
	`®lowedChdFËx
(
chd
, 
ex·ndšg
, 
i
)) {

538 
chd
->
	`£tOv”rideSize
(chd->
	`ov”rideWidth
(è+ 
¥aûAdd
);

539 
m_æexšgChd»n
 = 
Œue
;

540 
»ÏyoutChd»n
 = 
Œue
;

541 
»maššgS·û
 -ğ
¥aûAdd
;

542 
groupRemaššgS·û
 -ğ
¥aûAdd
;

544 
chd
 = 
™”©Ü
.
	`Ãxt
();

547 } 
groupRemaššgS·û
);

551 ià(
haveFËx
 && !
m_æexšgChd»n
)

552 
haveFËx
 = 
çl£
;

554 } 
haveFËx
);

556 
m_æexšgChd»n
 = 
çl£
;

558 
R’d”Block
::
	`fšishD–ayUpd©eSüŞlInfo
();

560 ià(
»maššgS·û
 > 0 && ((
	`¡yË
()->
	`dœeùiÚ
(è=ğ
LTR
 && styË()->
	`boxPack
(è!ğ
BSTART
) ||

561 (
	`¡yË
()->
	`dœeùiÚ
(è=ğ
RTL
 && styË()->
	`boxPack
(è!ğ
BEND
))) {

563 
off£t
 = 0;

564 ià(
	`¡yË
()->
	`boxPack
(è=ğ
BJUSTIFY
) {

566 
tÙ®Chd»n
 = 0;

567 
chd
 = 
™”©Ü
.
	`fœ¡
();

568 
chd
) {

569 ià(
chd
->
	`isPos™iÚed
()) {

570 
chd
 = 
™”©Ü
.
	`Ãxt
();

573 
tÙ®Chd»n
++;

574 
chd
 = 
™”©Ü
.
	`Ãxt
();

579 ià(
tÙ®Chd»n
 > 1) {

580 
tÙ®Chd»n
--;

581 
boŞ
 
fœ¡Chd
 = 
Œue
;

582 
chd
 = 
™”©Ü
.
	`fœ¡
();

583 
chd
) {

584 ià(
chd
->
	`isPos™iÚed
()) {

585 
chd
 = 
™”©Ü
.
	`Ãxt
();

589 ià(
fœ¡Chd
) {

590 
fœ¡Chd
 = 
çl£
;

591 
chd
 = 
™”©Ü
.
	`Ãxt
();

595 
off£t
 +ğ
»maššgS·û
/
tÙ®Chd»n
;

596 
»maššgS·û
 -ğÔemaššgS·û/
tÙ®Chd»n
);

597 
tÙ®Chd»n
--;

599 
	`¶aûChd
(
chd
, chd->
	`x
()+
off£t
, chd->
	`y
());

600 
chd
 = 
™”©Ü
.
	`Ãxt
();

604 ià(
	`¡yË
()->
	`boxPack
(è=ğ
BCENTER
)

605 
off£t
 +ğ
»maššgS·û
/2;

607 
off£t
 +ğ
»maššgS·û
;

608 
chd
 = 
™”©Ü
.
	`fœ¡
();

609 
chd
) {

610 ià(
chd
->
	`isPos™iÚed
()) {

611 
chd
 = 
™”©Ü
.
	`Ãxt
();

614 
	`¶aûChd
(
chd
, chd->
	`x
()+
off£t
, chd->
	`y
());

615 
chd
 = 
™”©Ü
.
	`Ãxt
();

622 ià(
heightS³cif›d
)

623 
	`£tHeight
(
ŞdHeight
);

624 
	}
}

626 
	gR’d”FËxibËBox
::
	$ÏyoutV”tiÿlBox
(
boŞ
 
»ÏyoutChd»n
)

628 
xPos
 = 
	`bÜd”Leá
(è+ 
	`·ddšgLeá
();

629 
yPos
 = 
	`bÜd”Tİ
(è+ 
	`·ddšgTİ
();

630 ià(
	`¡yË
()->
	`dœeùiÚ
(è=ğ
RTL
)

631 
xPos
 = 
	`width
(è- 
	`·ddšgRight
(è- 
	`bÜd”Right
();

632 
toAdd
 = 
	`bÜd”BÙtom
(è+ 
	`·ddšgBÙtom
(è+ 
	`hÜizÚlSüŞlb¬Height
();

633 
boŞ
 
heightS³cif›d
 = 
çl£
;

634 
ŞdHeight
 = 0;

636 
»maššgS·û
 = 0;

638 
FËxBoxI‹¿tÜ
 
	`™”©Ü
(
this
);

639 
highe¡FËxGroup
 = 0;

640 
lowe¡FËxGroup
 = 0;

641 
boŞ
 
haveFËx
 = 
çl£
;

642 
	`g©h”FËxChd»nInfo
(
™”©Ü
, 
»ÏyoutChd»n
, 
highe¡FËxGroup
, 
lowe¡FËxGroup
, 
haveFËx
);

644 
R’d”Box
* 
chd
;

648 
boŞ
 
haveLšeCÏmp
 = !
	`¡yË
()->
	`lšeCÏmp
().
	`isNÚe
();

649 ià(
haveLšeCÏmp
) {

650 
maxLšeCouÁ
 = 0;

651 
chd
 = 
™”©Ü
.
	`fœ¡
();

652 
chd
) {

653 ià(!
chd
->
	`isPos™iÚed
()) {

654 ià(
»ÏyoutChd»n
 || (
chd
->
	`isR•Ïûd
(è&& (chd->
	`¡yË
()->
	`width
().
	`isP”ûÁ
(è|| chd->¡yË()->
	`height
().isPercent())) ||

655 (
chd
->
	`¡yË
()->
	`height
().
	`isAuto
(è&& chd->
	`isBlockFlow
(è&& !chd->
	`ÃedsLayout
())) {

656 
chd
->
	`£tChdN“dsLayout
(
Œue
, 
çl£
);

659 ià(
chd
->
	`isR’d”Block
()) {

660 
	`toR’d”Block
(
chd
)->
	`m¬kPos™iÚedObjeùsFÜLayout
();

661 
	`toR’d”Block
(
chd
)->
	`ş—rTrunÿtiÚ
();

664 
chd
->
	`ÏyoutIfN“ded
();

665 ià(
chd
->
	`¡yË
()->
	`height
().
	`isAuto
(è&& chd->
	`isBlockFlow
())

666 
maxLšeCouÁ
 = 
	`max
(maxLšeCouÁ, 
	`toR’d”Block
(
chd
)->
	`lšeCouÁ
());

668 
chd
 = 
™”©Ü
.
	`Ãxt
();

673 
LšeCÏmpV®ue
 
lšeCÏmp
 = 
	`¡yË
()->
	`lšeCÏmp
();

674 
numVisibËLšes
 = 
lšeCÏmp
.
	`isP”ûÁage
(è? 
	`max
(1, (
maxLšeCouÁ
 + 1è*†šeCÏmp.
	`v®ue
() / 100) :†ineClamp.value();

675 ià(
numVisibËLšes
 < 
maxLšeCouÁ
) {

676 
chd
 = 
™”©Ü
.
	`fœ¡
(); chd; chd = i‹¿tÜ.
	`Ãxt
()) {

677 ià(
chd
->
	`isPos™iÚed
(è|| !chd->
	`¡yË
()->
	`height
().
	`isAuto
(è|| !chd->
	`isBlockFlow
())

680 
R’d”Block
* 
blockChd
 = 
	`toR’d”Block
(
chd
);

681 
lšeCouÁ
 = 
blockChd
->
	`lšeCouÁ
();

682 ià(
lšeCouÁ
 <ğ
numVisibËLšes
)

685 
ÃwHeight
 = 
blockChd
->
	`heightFÜLšeCouÁ
(
numVisibËLšes
);

686 ià(
ÃwHeight
 =ğ
chd
->
	`height
())

689 
chd
->
	`£tChdN“dsLayout
(
Œue
, 
çl£
);

690 
chd
->
	`£tOv”rideSize
(
ÃwHeight
);

691 
m_æexšgChd»n
 = 
Œue
;

692 
chd
->
	`ÏyoutIfN“ded
();

693 
m_æexšgChd»n
 = 
çl£
;

694 
chd
->
	`£tOv”rideSize
(-1);

697 ià(
	`¡yË
()->
	`dœeùiÚ
(è!ğ
LTR
)

701 
RoÙIÆšeBox
* 
Ï¡Lše
 = 
blockChd
->
	`lšeAtIndex
(
lšeCouÁ
-1);

702 ià(!
Ï¡Lše
)

705 
RoÙIÆšeBox
* 
Ï¡VisibËLše
 = 
blockChd
->
	`lšeAtIndex
(
numVisibËLšes
-1);

706 ià(!
Ï¡VisibËLše
)

709 cÚ¡ 
UCh¬
 
–lsisAndS·û
[2] = { 
hÜizÚlEÎsis
, ' ' };

710 
	`DEFINE_STATIC_LOCAL
(
AtomicSŒšg
, 
–lsisAndS·ûSŒ
, (
–lsisAndS·û
, 2));

711 
	`DEFINE_STATIC_LOCAL
(
AtomicSŒšg
, 
–lsisSŒ
, (&
hÜizÚlEÎsis
, 1));

712 cÚ¡ 
FÚt
& 
fÚt
 = 
	`¡yË
(
numVisibËLšes
 =ğ1)->
	`fÚt
();

715 
tÙ®Width
;

716 
IÆšeBox
* 
ªchÜBox
 = 
Ï¡Lše
->
	`Ï¡Chd
();

717 ià(
ªchÜBox
 &&‡nchÜBox->
	`»nd””
()->
	`node
(è&&‡nchÜBox->»nd””()->node()->
	`isLšk
())

718 
tÙ®Width
 = 
ªchÜBox
->
	`width
(è+ 
fÚt
.width(
	`TextRun
(
–lsisAndS·û
, 2));

720 
ªchÜBox
 = 0;

721 
tÙ®Width
 = 
fÚt
.
	`width
(
	`TextRun
(&
hÜizÚlEÎsis
, 1));

725 
R’d”Block
* 
de¡Block
 = 
	`toR’d”Block
(
Ï¡VisibËLše
->
	`»nd””
());

726 
R’d”Block
* 
¤cBlock
 = 
	`toR’d”Block
(
Ï¡Lše
->
	`»nd””
());

729 ià(
¤cBlock
->
	`¡yË
()->
	`dœeùiÚ
(è!ğ
LTR
)

731 ià(
de¡Block
->
	`¡yË
()->
	`dœeùiÚ
(è!ğ
LTR
)

733 
Ér
 = 
Œue
;

735 
blockRightEdge
 = 
de¡Block
->
	`rightOff£t
(
Ï¡VisibËLše
->
	`y
(), 
çl£
);

736 
blockLeáEdge
 = 
de¡Block
->
	`ËáOff£t
(
Ï¡VisibËLše
->
	`y
(), 
çl£
);

738 
blockEdge
 = 
Ér
 ? 
blockRightEdge
 : 
blockLeáEdge
;

739 ià(!
Ï¡VisibËLše
->
	`ÿnAccommod©eEÎsis
(
Ér
, 
blockEdge
,

740 
Ï¡VisibËLše
->
	`x
(è+†a¡VisibËLše->
	`width
(),

741 
tÙ®Width
))

745 
Ï¡VisibËLše
->
	`¶aûEÎsis
(
ªchÜBox
 ? 
–lsisAndS·ûSŒ
 : 
–lsisSŒ
, 
Ér
, 
blockLeáEdge
, 
blockRightEdge
, 
tÙ®Width
,‡nchorBox);

746 
de¡Block
->
	`£tHasM¬kupTrunÿtiÚ
(
Œue
);

751 
R’d”Block
::
	`¡¬tD–ayUpd©eSüŞlInfo
();

758 
	`£tHeight
(
	`bÜd”Tİ
(è+ 
	`·ddšgTİ
());

759 
mšHeight
 = 
	`height
(è+ 
toAdd
;

761 
chd
 = 
™”©Ü
.
	`fœ¡
();

762 
chd
) {

764 ià(!
haveLšeCÏmp
 && (
»ÏyoutChd»n
 || (
chd
->
	`isR•Ïûd
(è&& (chd->
	`¡yË
()->
	`width
().
	`isP”ûÁ
(è|| chd->¡yË()->
	`height
().isPercent()))))

765 
chd
->
	`£tChdN“dsLayout
(
Œue
, 
çl£
);

767 ià(
chd
->
	`isPos™iÚed
()) {

768 
chd
->
	`cÚššgBlock
()->
	`š£¹Pos™iÚedObjeù
(child);

769 ià(
chd
->
	`¡yË
()->
	`hasSticX
()) {

770 ià(
	`¡yË
()->
	`dœeùiÚ
(è=ğ
LTR
)

771 
chd
->
	`Ïy”
()->
	`£tSticX
(
	`bÜd”Leá
()+
	`·ddšgLeá
());

773 
chd
->
	`Ïy”
()->
	`£tSticX
(
	`bÜd”Right
()+
	`·ddšgRight
());

775 ià(
chd
->
	`¡yË
()->
	`hasSticY
()) {

776 
R’d”Lay”
* 
chdLay”
 = 
chd
->
	`Ïy”
();

777 ià(
chdLay”
->
	`¡©icY
(è!ğ
	`height
()) {

778 
chd
->
	`Ïy”
()->
	`£tSticY
(
	`height
());

779 
chd
->
	`£tChdN“dsLayout
(
Œue
, 
çl£
);

782 
chd
 = 
™”©Ü
.
	`Ãxt
();

787 
chd
->
	`ÿlcV”tiÿlM¬gšs
();

790 
	`£tHeight
(
	`height
(è+ 
chd
->
	`m¬gšTİ
());

793 
chd
->
	`ÏyoutIfN“ded
();

796 
chdX
 = 
	`bÜd”Leá
(è+ 
	`·ddšgLeá
();

797 
	`¡yË
()->
	`boxAlign
()) {

798 
BCENTER
:

799 
BBASELINE
:

800 
chdX
 +ğ
chd
->
	`m¬gšLeá
(è+ 
	`max
(0, (
	`cÚ‹ÁWidth
(è- (chd->
	`width
(è+ chd->m¬gšLeá(è+ chd->
	`m¬gšRight
()))/2);

802 
BEND
:

803 ià(
	`¡yË
()->
	`dœeùiÚ
(è=ğ
RTL
)

804 
chdX
 +ğ
chd
->
	`m¬gšLeá
();

806 
chdX
 +ğ
	`cÚ‹ÁWidth
(è- 
chd
->
	`m¬gšRight
(è- chd->
	`width
();

809 ià(
	`¡yË
()->
	`dœeùiÚ
(è=ğ
LTR
)

810 
chdX
 +ğ
chd
->
	`m¬gšLeá
();

812 
chdX
 +ğ
	`cÚ‹ÁWidth
(è- 
chd
->
	`m¬gšRight
(è- chd->
	`width
();

817 
	`¶aûChd
(
chd
, 
chdX
, 
	`height
());

818 
	`£tHeight
(
	`height
(è+ 
chd
->height(è+ chd->
	`m¬gšBÙtom
());

820 
chd
 = 
™”©Ü
.
	`Ãxt
();

823 
yPos
 = 
	`height
();

825 ià(!
™”©Ü
.
	`fœ¡
(è&& 
	`hasLšeIfEm±y
())

826 
	`£tHeight
(
	`height
(è+ 
	`lšeHeight
(
Œue
,rue));

828 
	`£tHeight
(
	`height
(è+ 
toAdd
);

832 ià(
	`height
(è< 
mšHeight
)

833 
	`£tHeight
(
mšHeight
);

836 
ŞdHeight
 = 
	`height
();

837 
	`ÿlcHeight
();

838 ià(
ŞdHeight
 !ğ
	`height
())

839 
heightS³cif›d
 = 
Œue
;

841 
»maššgS·û
 = 
	`bÜd”Tİ
(è+ 
	`·ddšgTİ
(è+ 
	`cÚ‹ÁHeight
(è- 
yPos
;

843 ià(
m_æexšgChd»n
)

844 
haveFËx
 = 
çl£
;

845 ià(
haveFËx
) {

847 ià(!
»maššgS·û
)

853 
boŞ
 
ex·ndšg
 = 
»maššgS·û
 > 0;

854 
¡¬t
 = 
ex·ndšg
 ? 
lowe¡FËxGroup
 : 
highe¡FËxGroup
;

855 
’d
 = 
ex·ndšg
? 
highe¡FËxGroup
 : 
lowe¡FËxGroup
;

856 
i
 = 
¡¬t
; i <ğ
’d
 && 
»maššgS·û
; i++) {

858 
groupRemaššgS·û
 = 
»maššgS·û
;

864 
groupRemaššgS·ûAtBegšnšg
 = 
groupRemaššgS·û
;

865 
tÙ®FËx
 = 0.0f;

866 
chd
 = 
™”©Ü
.
	`fœ¡
();

867 
chd
) {

868 ià(
	`®lowedChdFËx
(
chd
, 
ex·ndšg
, 
i
))

869 
tÙ®FËx
 +ğ
chd
->
	`¡yË
()->
	`boxFËx
();

870 
chd
 = 
™”©Ü
.
	`Ãxt
();

872 
chd
 = 
™”©Ü
.
	`fœ¡
();

873 
¥aûAvaabËThisPass
 = 
groupRemaššgS·û
;

874 
chd
) {

875 
®lowedFËx
 = 
	`®lowedChdFËx
(
chd
, 
ex·ndšg
, 
i
);

876 ià(
®lowedFËx
) {

877 
´ojeùedFËx
 = (
®lowedFËx
 =ğ
INT_MAX
è?‡ÎowedFËx : ()×ÎowedFËx * (
tÙ®FËx
 / 
chd
->
	`¡yË
()->
	`boxFËx
()));

878 
¥aûAvaabËThisPass
 = 
ex·ndšg
 ? 
	`mš
(¥aûAvaabËThisPass, 
´ojeùedFËx
è: 
	`max
(spaceAvailableThisPass,…rojectedFlex);

880 
chd
 = 
™”©Ü
.
	`Ãxt
();

884 ià(!
¥aûAvaabËThisPass
 || 
tÙ®FËx
 == 0.0f) {

886 
groupRemaššgS·û
 = 0;

891 
chd
 = 
™”©Ü
.
	`fœ¡
();

892 
chd
 && 
¥aûAvaabËThisPass
 && 
tÙ®FËx
) {

893 ià(
	`®lowedChdFËx
(
chd
, 
ex·ndšg
, 
i
)) {

894 
¥aûAdd
 = ()(
¥aûAvaabËThisPass
 * (
chd
->
	`¡yË
()->
	`boxFËx
()/
tÙ®FËx
));

895 ià(
¥aûAdd
) {

896 
chd
->
	`£tOv”rideSize
(chd->
	`ov”rideHeight
(è+ 
¥aûAdd
);

897 
m_æexšgChd»n
 = 
Œue
;

898 
»ÏyoutChd»n
 = 
Œue
;

901 
¥aûAvaabËThisPass
 -ğ
¥aûAdd
;

902 
»maššgS·û
 -ğ
¥aûAdd
;

903 
groupRemaššgS·û
 -ğ
¥aûAdd
;

905 
tÙ®FËx
 -ğ
chd
->
	`¡yË
()->
	`boxFËx
();

907 
chd
 = 
™”©Ü
.
	`Ãxt
();

909 ià(
groupRemaššgS·û
 =ğ
groupRemaššgS·ûAtBegšnšg
) {

911 
chd
 = 
™”©Ü
.
	`fœ¡
();

912 
¥aûAdd
 = 
groupRemaššgS·û
 > 0 ? 1 : -1;

913 
chd
 && 
groupRemaššgS·û
) {

914 ià(
	`®lowedChdFËx
(
chd
, 
ex·ndšg
, 
i
)) {

915 
chd
->
	`£tOv”rideSize
(chd->
	`ov”rideHeight
(è+ 
¥aûAdd
);

916 
m_æexšgChd»n
 = 
Œue
;

917 
»ÏyoutChd»n
 = 
Œue
;

918 
»maššgS·û
 -ğ
¥aûAdd
;

919 
groupRemaššgS·û
 -ğ
¥aûAdd
;

921 
chd
 = 
™”©Ü
.
	`Ãxt
();

924 } 
groupRemaššgS·û
);

928 ià(
haveFËx
 && !
m_æexšgChd»n
)

929 
haveFËx
 = 
çl£
;

931 } 
haveFËx
);

933 
R’d”Block
::
	`fšishD–ayUpd©eSüŞlInfo
();

935 ià(
	`¡yË
()->
	`boxPack
(è!ğ
BSTART
 && 
»maššgS·û
 > 0) {

937 
off£t
 = 0;

938 ià(
	`¡yË
()->
	`boxPack
(è=ğ
BJUSTIFY
) {

940 
tÙ®Chd»n
 = 0;

941 
chd
 = 
™”©Ü
.
	`fœ¡
();

942 
chd
) {

943 ià(
chd
->
	`isPos™iÚed
()) {

944 
chd
 = 
™”©Ü
.
	`Ãxt
();

947 
tÙ®Chd»n
++;

948 
chd
 = 
™”©Ü
.
	`Ãxt
();

953 ià(
tÙ®Chd»n
 > 1) {

954 
tÙ®Chd»n
--;

955 
boŞ
 
fœ¡Chd
 = 
Œue
;

956 
chd
 = 
™”©Ü
.
	`fœ¡
();

957 
chd
) {

958 ià(
chd
->
	`isPos™iÚed
()) {

959 
chd
 = 
™”©Ü
.
	`Ãxt
();

963 ià(
fœ¡Chd
) {

964 
fœ¡Chd
 = 
çl£
;

965 
chd
 = 
™”©Ü
.
	`Ãxt
();

969 
off£t
 +ğ
»maššgS·û
/
tÙ®Chd»n
;

970 
»maššgS·û
 -ğÔemaššgS·û/
tÙ®Chd»n
);

971 
tÙ®Chd»n
--;

972 
	`¶aûChd
(
chd
, chd->
	`x
(), chd->
	`y
()+
off£t
);

973 
chd
 = 
™”©Ü
.
	`Ãxt
();

977 ià(
	`¡yË
()->
	`boxPack
(è=ğ
BCENTER
)

978 
off£t
 +ğ
»maššgS·û
/2;

980 
off£t
 +ğ
»maššgS·û
;

981 
chd
 = 
™”©Ü
.
	`fœ¡
();

982 
chd
) {

983 ià(
chd
->
	`isPos™iÚed
()) {

984 
chd
 = 
™”©Ü
.
	`Ãxt
();

987 
	`¶aûChd
(
chd
, chd->
	`x
(), chd->
	`y
()+
off£t
);

988 
chd
 = 
™”©Ü
.
	`Ãxt
();

995 ià(
heightS³cif›d
)

996 
	`£tHeight
(
ŞdHeight
);

997 
	}
}

999 
	gR’d”FËxibËBox
::
	$¶aûChd
(
R’d”Box
* 
chd
, 
x
, 
y
)

1001 
IÁReù
 
	`ŞdReù
(
chd
->
	`x
(), chd->
	`y
(è, chd->
	`width
(), chd->
	`height
());

1004 
chd
->
	`£tLoÿtiÚ
(
x
, 
y
);

1009 ià(!
	`£lfN“dsLayout
(è&& 
chd
->
	`checkFÜR•aštDuršgLayout
())

1010 
chd
->
	`»·štDuršgLayoutIfMoved
(
ŞdReù
);

1011 
	}
}

1013 
	gR’d”FËxibËBox
::
	$®lowedChdFËx
(
R’d”Box
* 
chd
, 
boŞ
 
ex·ndšg
, 
group
)

1015 ià(
chd
->
	`isPos™iÚed
(è|| chd->
	`¡yË
()->
	`boxFËx
(è=ğ0.0à|| chd->¡yË()->
	`boxFËxGroup
(è!ğ
group
)

1018 ià(
ex·ndšg
) {

1019 ià(
	`isHÜizÚl
()) {

1021 
maxW
 = 
INT_MAX
;

1022 
w
 = 
chd
->
	`ov”rideWidth
(è- (chd->
	`bÜd”Leá
(è+ chd->
	`bÜd”Right
(è+ chd->
	`·ddšgLeá
(è+ chd->
	`·ddšgRight
());

1023 ià(!
chd
->
	`¡yË
()->
	`maxWidth
().
	`isUndefšed
() &&

1024 
chd
->
	`¡yË
()->
	`maxWidth
().
	`isFixed
())

1025 
maxW
 = 
chd
->
	`¡yË
()->
	`maxWidth
().
	`v®ue
();

1026 ià(
chd
->
	`¡yË
()->
	`maxWidth
().
	`ty³
(è=ğ
IÁršsic
)

1027 
maxW
 = 
chd
->
	`maxP»fWidth
();

1028 ià(
chd
->
	`¡yË
()->
	`maxWidth
().
	`ty³
(è=ğ
MšIÁršsic
)

1029 
maxW
 = 
chd
->
	`mšP»fWidth
();

1030 ià(
maxW
 =ğ
INT_MAX
)

1031  
maxW
;

1032  
	`max
(0, 
maxW
 - 
w
);

1035 
maxH
 = 
INT_MAX
;

1036 
h
 = 
chd
->
	`ov”rideHeight
(è- (chd->
	`bÜd”Tİ
(è+ chd->
	`bÜd”BÙtom
(è+ chd->
	`·ddšgTİ
(è+ chd->
	`·ddšgBÙtom
());

1037 ià(!
chd
->
	`¡yË
()->
	`maxHeight
().
	`isUndefšed
() &&

1038 
chd
->
	`¡yË
()->
	`maxHeight
().
	`isFixed
())

1039 
maxH
 = 
chd
->
	`¡yË
()->
	`maxHeight
().
	`v®ue
();

1040 ià(
maxH
 =ğ
INT_MAX
)

1041  
maxH
;

1042  
	`max
(0, 
maxH
 - 
h
);

1047 ià(
	`isHÜizÚl
()) {

1048 
mšW
 = 
chd
->
	`mšP»fWidth
();

1049 
w
 = 
chd
->
	`ov”rideWidth
(è- (chd->
	`bÜd”Leá
(è+ chd->
	`bÜd”Right
(è+ chd->
	`·ddšgLeá
(è+ chd->
	`·ddšgRight
());

1050 ià(
chd
->
	`¡yË
()->
	`mšWidth
().
	`isFixed
())

1051 
mšW
 = 
chd
->
	`¡yË
()->
	`mšWidth
().
	`v®ue
();

1052 ià(
chd
->
	`¡yË
()->
	`mšWidth
().
	`ty³
(è=ğ
IÁršsic
)

1053 
mšW
 = 
chd
->
	`maxP»fWidth
();

1054 ià(
chd
->
	`¡yË
()->
	`mšWidth
().
	`ty³
(è=ğ
MšIÁršsic
)

1055 
mšW
 = 
chd
->
	`mšP»fWidth
();

1057 
®lowedShrškage
 = 
	`mš
(0, 
mšW
 - 
w
);

1058  
®lowedShrškage
;

1060 ià(
chd
->
	`¡yË
()->
	`mšHeight
().
	`isFixed
()) {

1061 
mšH
 = 
chd
->
	`¡yË
()->
	`mšHeight
().
	`v®ue
();

1062 
h
 = 
chd
->
	`ov”rideHeight
(è- (chd->
	`bÜd”Leá
(è+ chd->
	`bÜd”Right
(è+ chd->
	`·ddšgLeá
(è+ chd->
	`·ddšgRight
());

1063 
®lowedShrškage
 = 
	`mš
(0, 
mšH
 - 
h
);

1064  
®lowedShrškage
;

1069 
	}
}

1071 cÚ¡ *
	gR’d”FËxibËBox
::
	$»nd”Name
() const

1073 ià(
	`isFlßtšg
())

1075 ià(
	`isPos™iÚed
())

1077 ià(
	`isAnÚymous
())

1079 ià(
	`isR–Pos™iÚed
())

1082 
	}
}

	@RenderFlexibleBox.h

23 #iâdeà
R’d”FËxibËBox_h


24 
	#R’d”FËxibËBox_h


	)

26 
	~"R’d”Block.h
"

28 
Çme¥aû
 
	gWebCÜe
 {

30 şas 
	cR’d”FËxibËBox
 : 
public
 
R’d”Block
 {

31 
public
:

32 
R’d”FËxibËBox
(
Node
*);

33 
	gvœtu®
 ~
R’d”FËxibËBox
();

35 
vœtu®
 cÚ¡ * 
»nd”Name
() const;

37 
vœtu®
 
ÿlcP»fWidths
();

38 
ÿlcHÜizÚlP»fWidths
();

39 
ÿlcV”tiÿlP»fWidths
();

41 
vœtu®
 
ÏyoutBlock
(
boŞ
 
»ÏyoutChd»n
);

42 
ÏyoutHÜizÚlBox
(
boŞ
 
»ÏyoutChd»n
);

43 
ÏyoutV”tiÿlBox
(
boŞ
 
»ÏyoutChd»n
);

45 
vœtu®
 
boŞ
 
avoidsFlßts
(ècÚ¡ {  
	gŒue
; }

47 
vœtu®
 
boŞ
 
isFËxibËBox
(ècÚ¡ {  
	gŒue
; }

48 
vœtu®
 
boŞ
 
isFËxšgChd»n
(ècÚ¡ {  
	gm_æexšgChd»n
; }

49 
vœtu®
 
boŞ
 
isSŒ‘chšgChd»n
(ècÚ¡ {  
	gm_¡»tchšgChd»n
; }

51 
¶aûChd
(
R’d”Box
* 
chd
, 
x
, 
y
);

53 
	g´Ùeùed
:

54 
®lowedChdFËx
(
R’d”Box
* 
chd
, 
boŞ
 
ex·ndšg
, 
group
);

56 
boŞ
 
hasMuÉËLšes
(ècÚ¡ {  
¡yË
()->
boxLšes
(è=ğ
MULTIPLE
; }

57 
boŞ
 
isV”tiÿl
(ècÚ¡ {  
¡yË
()->
boxOr›Á
(è=ğ
VERTICAL
; }

58 
boŞ
 
isHÜizÚl
(ècÚ¡ {  
¡yË
()->
boxOr›Á
(è=ğ
HORIZONTAL
; }

60 
boŞ
 
	gm_æexšgChd»n
 : 1;

61 
boŞ
 
	gm_¡»tchšgChd»n
 : 1;

	@RenderForeignObject.cpp

23 
	~"cÚfig.h
"

25 #ià
ENABLE
(
SVG
è&& ENABLE(
SVG_FOREIGN_OBJECT
)

26 
	~"R’d”FÜeignObjeù.h
"

28 
	~"G¿phicsCÚ‹xt.h
"

29 
	~"R’d”V›w.h
"

30 
	~"SVGFÜeignObjeùEËm’t.h
"

31 
	~"SVGR’d”SuµÜt.h
"

32 
	~"SVGSVGEËm’t.h
"

33 
	~"T¿nsfÜmS‹.h
"

35 
Çme¥aû
 
	gWebCÜe
 {

37 
	gR’d”FÜeignObjeù
::
R’d”FÜeignObjeù
(
SVGFÜeignObjeùEËm’t
* 
node
)

38 : 
R’d”SVGBlock
(
node
)

39 , 
m_ÃedsT¿nsfÜmUpd©e
(
Œue
)

43 
	gR’d”FÜeignObjeù
::
·št
(
PaštInfo
& 
·štInfo
, , )

45 ià(
	g·štInfo
.
	gcÚ‹xt
->
·štšgDi§bËd
())

48 
PaštInfo
 
chdPaštInfo
(
·štInfo
);

49 
	gchdPaštInfo
.
	gcÚ‹xt
->
§ve
();

51 
­¶yT¿nsfÜmToPaštInfo
(
chdPaštInfo
, 
loÿlT¿nsfÜm
());

53 ià(
	gSVGR’d”Ba£
::
isOv”æowHidd’
(
this
))

54 
chdPaštInfo
.
cÚ‹xt
->
ş
(
m_v›wpÜt
);

56 
	gİac™y
 = 
¡yË
()->
İac™y
();

57 ià(
	gİac™y
 < 1.0f)

58 
	gchdPaštInfo
.
	gcÚ‹xt
->
begšT¿n¥¬’cyLay”
(
İac™y
);

60 
	gR’d”Block
::
·št
(
chdPaštInfo
, 0, 0);

62 ià(
	gİac™y
 < 1.0f)

63 
	gchdPaštInfo
.
	gcÚ‹xt
->
’dT¿n¥¬’cyLay”
();

65 
	gchdPaštInfo
.
	gcÚ‹xt
->
»¡Üe
();

68 
IÁReù
 
	gR’d”FÜeignObjeù
::
ş³dOv”æowReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
)

70  
SVGR’d”Ba£
::
ş³dOv”æowReùFÜR•ašt
(
this
, 
»·štCÚš”
);

73 
	gR’d”FÜeignObjeù
::
compu‹ReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
IÁReù
& 
»·štReù
, 
boŞ
 
fixed
)

75 
	gSVGR’d”Ba£
::
compu‹ReùFÜR•ašt
(
this
, 
»·štCÚš”
, 
»·štReù
, 
fixed
);

78 cÚ¡ 
	gAffšeT¿nsfÜm
& 
	gR’d”FÜeignObjeù
::
loÿlToP¬’tT¿nsfÜm
() const

80 
m_loÿlToP¬’tT¿nsfÜm
 = 
loÿlT¿nsfÜm
();

81 
	gm_loÿlToP¬’tT¿nsfÜm
.
Œª¦©e
(
m_v›wpÜt
.
x
(), m_v›wpÜt.
y
());

82  
	gm_loÿlToP¬’tT¿nsfÜm
;

85 
	gR’d”FÜeignObjeù
::
ÿlcWidth
()

88 
£tWidth
(
¡©ic_ÿ¡
<>(
roundf
(
m_v›wpÜt
.
width
())));

91 
	gR’d”FÜeignObjeù
::
ÿlcHeight
()

94 
£tHeight
(
¡©ic_ÿ¡
<>(
roundf
(
m_v›wpÜt
.
height
())));

97 
	gR’d”FÜeignObjeù
::
Ïyout
()

99 
ASSERT
(
ÃedsLayout
());

100 
ASSERT
(!
v›w
()->
ÏyoutS‹EÇbËd
());

102 
LayoutR•aš‹r
 
»·š‹r
(*
this
, 
checkFÜR•aštDuršgLayout
());

103 
SVGFÜeignObjeùEËm’t
* 
	gfÜeign
 = 
¡©ic_ÿ¡
<SVGFÜeignObjeùEËm’t*>(
node
());

105 ià(
	gm_ÃedsT¿nsfÜmUpd©e
) {

106 
	gm_loÿlT¿nsfÜm
 = 
fÜeign
->
ªim©edLoÿlT¿nsfÜm
();

107 
	gm_ÃedsT¿nsfÜmUpd©e
 = 
çl£
;

111 
FlßtPošt
 
v›wpÜtLoÿtiÚ
(
fÜeign
->
x
().
v®ue
(fÜeign), fÜeign->
y
().value(foreign));

112 
	gm_v›wpÜt
 = 
FlßtReù
(
v›wpÜtLoÿtiÚ
, 
FlßtSize
(
fÜeign
->
width
().
v®ue
(fÜeign), fÜeign->
height
().value(foreign)));

119 
£tLoÿtiÚ
(
roundedIÁPošt
(
v›wpÜtLoÿtiÚ
));

120 
	gR’d”Block
::
Ïyout
();

122 
	g»·š‹r
.
»·štAá”Layout
();

123 
£tN“dsLayout
(
çl£
);

126 
boŞ
 
	gR’d”FÜeignObjeù
::
nodeAtFlßtPošt
(cÚ¡ 
H™Te¡Reque¡
& 
»que¡
, 
H™Te¡ResuÉ
& 
»suÉ
, cÚ¡ 
FlßtPošt
& 
poštInP¬’t
, 
H™Te¡AùiÚ
 
h™Te¡AùiÚ
)

128 
FlßtPošt
 
	gloÿlPošt
 = 
loÿlT¿nsfÜm
().
šv”£
().
m­Pošt
(
poštInP¬’t
);

131 ià(
	gSVGR’d”Ba£
::
isOv”æowHidd’
(
this
è&& !
m_v›wpÜt
.
cÚšs
(
loÿlPošt
))

132  
çl£
;

134 
IÁPošt
 
	groundedLoÿlPošt
 = 
roundedIÁPošt
(
loÿlPošt
);

135  
	gR’d”Block
::
nodeAtPošt
(
»que¡
, 
»suÉ
, 
roundedLoÿlPošt
.
x
(),„oundedLoÿlPošt.
y
(), 0, 0, 
h™Te¡AùiÚ
);

138 
boŞ
 
	gR’d”FÜeignObjeù
::
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, , , , , 
H™Te¡AùiÚ
)

140 
ASSERT_NOT_REACHED
();

141  
	gçl£
;

144 
	gR’d”FÜeignObjeù
::
m­LoÿlToCÚš”
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
boŞ
 
fixed
, boŞ 
u£T¿nsfÜms
, 
T¿nsfÜmS‹
& 
ŒªsfÜmS‹
) const

147 ià(!
	gu£T¿nsfÜms
)

148 
	gu£T¿nsfÜms
 = 
Œue
;

149 
	gSVGR’d”Ba£
::
m­LoÿlToCÚš”
(
this
, 
»·štCÚš”
, 
fixed
, 
u£T¿nsfÜms
, 
ŒªsfÜmS‹
);

	@RenderForeignObject.h

22 #iâdeà
R’d”FÜeignObjeù_h


23 
	#R’d”FÜeignObjeù_h


	)

25 #ià
ENABLE
(
SVG
è&& ENABLE(
SVG_FOREIGN_OBJECT
)

26 
	~"AffšeT¿nsfÜm.h
"

27 
	~"FlßtPošt.h
"

28 
	~"R’d”SVGBlock.h
"

30 
Çme¥aû
 
	gWebCÜe
 {

32 
şass
 
	gSVGFÜeignObjeùEËm’t
;

34 şas 
	cR’d”FÜeignObjeù
 : 
public
 
R’d”SVGBlock
 {

35 
public
:

36 
R’d”FÜeignObjeù
(
SVGFÜeignObjeùEËm’t
*);

38 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderForeignObject"; }

40 
vœtu®
 
·št
(
PaštInfo
&, 
·»ÁX
, 
·»ÁY
);

42 
vœtu®
 
IÁReù
 
ş³dOv”æowReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
);

43 
vœtu®
 
compu‹ReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
IÁReù
&, 
boŞ
 
fixed
 = 
çl£
);

45 
vœtu®
 
boŞ
 
»quœesLay”
(ècÚ¡ {  
	gçl£
; }

46 
vœtu®
 
Ïyout
();

48 
vœtu®
 
FlßtReù
 
objeùBoundšgBox
(ècÚ¡ {  
	gm_v›wpÜt
; }

49 
vœtu®
 
FlßtReù
 
¡rokeBoundšgBox
(ècÚ¡ {  
	gm_v›wpÜt
; }

50 
vœtu®
 
FlßtReù
 
»·štReùInLoÿlCoÜdš©es
(ècÚ¡ {  
	gm_v›wpÜt
; }

52 
vœtu®
 
boŞ
 
nodeAtFlßtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, cÚ¡ 
FlßtPošt
& 
poštInP¬’t
, 
H™Te¡AùiÚ
);

53 
vœtu®
 
boŞ
 
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, 
x
, 
y
, 
tx
, 
ty
, 
H™Te¡AùiÚ
);

54 
vœtu®
 
boŞ
 
isSVGFÜeignObjeù
(ècÚ¡ {  
	gŒue
; }

56 
vœtu®
 
m­LoÿlToCÚš”
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
boŞ
 
fixed
 , boŞ 
u£T¿nsfÜms
, 
T¿nsfÜmS‹
& 
ŒªsfÜmS‹
) const;

57 
vœtu®
 
£tN“dsT¿nsfÜmUpd©e
(è{ 
	gm_ÃedsT¿nsfÜmUpd©e
 = 
Œue
; }

59 
	g´iv©e
:

60 
vœtu®
 
ÿlcWidth
();

61 
vœtu®
 
ÿlcHeight
();

63 
vœtu®
 cÚ¡ 
	gAffšeT¿nsfÜm
& 
loÿlToP¬’tT¿nsfÜm
() const;

64 
vœtu®
 
AffšeT¿nsfÜm
 
loÿlT¿nsfÜm
(ècÚ¡ {  
	gm_loÿlT¿nsfÜm
; }

66 
boŞ
 
	gm_ÃedsT¿nsfÜmUpd©e
 : 1;

67 
FlßtReù
 
	gm_v›wpÜt
;

68 
AffšeT¿nsfÜm
 
	gm_loÿlT¿nsfÜm
;

69 
mubË
 
AffšeT¿nsfÜm
 
	gm_loÿlToP¬’tT¿nsfÜm
;

	@RenderFrame.cpp

24 
	~"cÚfig.h
"

25 
	~"R’d”F¿me.h
"

27 
	~"F¿meV›w.h
"

28 
	~"HTMLF¿meEËm’t.h
"

29 
	~"R’d”V›w.h
"

31 
Çme¥aû
 
	gWebCÜe
 {

33 
	gR’d”F¿me
::
R’d”F¿me
(
HTMLF¿meEËm’t
* 
äame
)

34 : 
R’d”P¬t
(
äame
)

36 
£tIÆše
(
çl£
);

39 
F¿meEdgeInfo
 
	gR’d”F¿me
::
edgeInfo
() const

41 
HTMLF¿meEËm’t
* 
–em’t
 = 
¡©ic_ÿ¡
<HTMLF¿meEËm’t*>(
node
());

42  
F¿meEdgeInfo
(
–em’t
->
noResize
(),ƒËm’t->
hasF¿meBÜd”
());

45 
	gR’d”F¿me
::
v›wCË¬ed
()

47 
HTMLF¿meEËm’t
* 
–em’t
 = 
¡©ic_ÿ¡
<HTMLF¿meEËm’t*>(
node
());

48 ià(!
	g–em’t
 || !
widg‘
(è|| !widg‘()->
isF¿meV›w
())

51 
F¿meV›w
* 
	gv›w
 = 
¡©ic_ÿ¡
<F¿meV›w*>(
widg‘
());

53 
	gm¬gšw
 = 
–em’t
->
g‘M¬gšWidth
();

54 
	gm¬gšh
 = 
–em’t
->
g‘M¬gšHeight
();

56 ià(
	gm¬gšw
 != -1)

57 
v›w
->
£tM¬gšWidth
(
m¬gšw
);

58 ià(
	gm¬gšh
 != -1)

59 
v›w
->
£tM¬gšHeight
(
m¬gšh
);

	@RenderFrame.h

23 #iâdeà
R’d”F¿me_h


24 
	#R’d”F¿me_h


	)

26 
	~"R’d”P¬t.h
"

27 
	~"R’d”F¿meS‘.h
"

29 
Çme¥aû
 
	gWebCÜe
 {

31 
şass
 
	gHTMLF¿meEËm’t
;

33 şas 
	cR’d”F¿me
 : 
public
 
R’d”P¬t
 {

34 
public
:

35 
R’d”F¿me
(
HTMLF¿meEËm’t
*);

37 
F¿meEdgeInfo
 
edgeInfo
() const;

39 
	g´iv©e
:

40 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderFrame"; }

41 
vœtu®
 
boŞ
 
isF¿me
(ècÚ¡ {  
	gŒue
; }

43 
vœtu®
 
v›wCË¬ed
();

46 
šlše
 
R’d”F¿me
* 
	$toR’d”F¿me
(
R’d”Objeù
* 
objeù
)

48 
	`ASSERT
(!
objeù
 || objeù->
	`isF¿me
());

49  
¡©ic_ÿ¡
<
R’d”F¿me
*>(
objeù
);

50 
	}
}

53 
toR’d”F¿me
(cÚ¡ 
R’d”F¿me
*);

	@RenderFrameSet.cpp

24 
	~"cÚfig.h
"

25 
	~"R’d”F¿meS‘.h
"

27 
	~"Docum’t.h
"

28 
	~"Ev’tHªdËr.h
"

29 
	~"Ev’tNames.h
"

30 
	~"F¿me.h
"

31 
	~"F¿meV›w.h
"

32 
	~"G¿phicsCÚ‹xt.h
"

33 
	~"HTMLF¿meS‘EËm’t.h
"

34 
	~"H™Te¡Reque¡.h
"

35 
	~"H™Te¡ResuÉ.h
"

36 
	~"Mou£Ev’t.h
"

37 
	~"R’d”F¿me.h
"

38 
	~"R’d”V›w.h
"

39 
	~"S‘tšgs.h
"

41 
Çme¥aû
 
	gWebCÜe
 {

43 
	gR’d”F¿meS‘
::
R’d”F¿meS‘
(
HTMLF¿meS‘EËm’t
* 
äameS‘
)

44 : 
R’d”Box
(
äameS‘
)

45 , 
m_isResizšg
(
çl£
)

46 , 
m_isChdResizšg
(
çl£
)

48 
£tIÆše
(
çl£
);

51 
	gR’d”F¿meS‘
::~
R’d”F¿meS‘
()

55 
R’d”F¿meS‘
::
GridAxis
::GridAxis()

56 : 
m_¥l™BešgResized
(
noS¶™
)

60 
šlše
 
HTMLF¿meS‘EËm’t
* 
R’d”F¿meS‘
::
äameS‘
() const

62  
¡©ic_ÿ¡
<
HTMLF¿meS‘EËm’t
*>(
node
());

65 
CŞÜ
 
bÜd”S¹EdgeCŞÜ
()

67  
CŞÜ
(170, 170, 170);

70 
CŞÜ
 
bÜd”EndEdgeCŞÜ
()

72  
	gCŞÜ
::
bÏck
;

75 
CŞÜ
 
bÜd”FlCŞÜ
()

77  
CŞÜ
(208, 208, 208);

80 
	gR’d”F¿meS‘
::
·štCŞumnBÜd”
(cÚ¡ 
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
bÜd”Reù
)

82 ià(!
	g·štInfo
.
	g»ù
.
š‹r£ùs
(
bÜd”Reù
))

88 
G¿phicsCÚ‹xt
* 
	gcÚ‹xt
 = 
·štInfo
.
cÚ‹xt
;

89 
CŞÜS·û
 
	gcŞÜS·û
 = 
¡yË
()->
cŞÜS·û
();

90 
	gcÚ‹xt
->
flReù
(
bÜd”Reù
, 
äameS‘
()->
hasBÜd”CŞÜ
(è? 
¡yË
()->
bÜd”LeáCŞÜ
(è: 
bÜd”FlCŞÜ
(), 
cŞÜS·û
);

94 ià(
	gbÜd”Reù
.
width
() >= 3) {

95 
cÚ‹xt
->
flReù
(
IÁReù
(
bÜd”Reù
.
tİLeá
(), 
IÁSize
(1, 
height
())), 
bÜd”S¹EdgeCŞÜ
(), 
cŞÜS·û
);

96 
	gcÚ‹xt
->
flReù
(
IÁReù
(
bÜd”Reù
.
tİRight
(), 
IÁSize
(1, 
height
())), 
bÜd”EndEdgeCŞÜ
(), 
cŞÜS·û
);

100 
	gR’d”F¿meS‘
::
·štRowBÜd”
(cÚ¡ 
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
bÜd”Reù
)

102 ià(!
	g·štInfo
.
	g»ù
.
š‹r£ùs
(
bÜd”Reù
))

108 
G¿phicsCÚ‹xt
* 
	gcÚ‹xt
 = 
·štInfo
.
cÚ‹xt
;

109 
CŞÜS·û
 
	gcŞÜS·û
 = 
¡yË
()->
cŞÜS·û
();

110 
	gcÚ‹xt
->
flReù
(
bÜd”Reù
, 
äameS‘
()->
hasBÜd”CŞÜ
(è? 
¡yË
()->
bÜd”LeáCŞÜ
(è: 
bÜd”FlCŞÜ
(), 
cŞÜS·û
);

114 ià(
	gbÜd”Reù
.
height
() >= 3) {

115 
cÚ‹xt
->
flReù
(
IÁReù
(
bÜd”Reù
.
tİLeá
(), 
IÁSize
(
width
(), 1)), 
bÜd”S¹EdgeCŞÜ
(), 
cŞÜS·û
);

116 
	gcÚ‹xt
->
flReù
(
IÁReù
(
bÜd”Reù
.
bÙtomLeá
(), 
IÁSize
(
width
(), 1)), 
bÜd”EndEdgeCŞÜ
(), 
cŞÜS·û
);

120 
	gR’d”F¿meS‘
::
·št
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

122 ià(
	g·štInfo
.
	gpha£
 !ğ
PaštPha£FÜeground
)

125 
R’d”Objeù
* 
	gchd
 = 
fœ¡Chd
();

126 ià(!
	gchd
)

130 
	gtx
 +ğ
x
();

131 
	gty
 +ğ
y
();

133 
	grows
 = 
äameS‘
()->
tÙ®Rows
();

134 
	gcŞs
 = 
äameS‘
()->
tÙ®CŞs
();

135 
	gbÜd”ThickÃss
 = 
äameS‘
()->
bÜd”
();

137 
	gyPos
 = 0;

138 
	gr
 = 0;„ < 
	grows
;„++) {

139 
	gxPos
 = 0;

140 
	gc
 = 0; c < 
	gcŞs
; c++) {

141 
	gchd
->
·št
(
·štInfo
, 
tx
, 
ty
);

142 
	gxPos
 +ğ
m_cŞs
.
m_sizes
[
c
];

143 ià(
	gbÜd”ThickÃss
 && 
	gm_cŞs
.
	gm_®lowBÜd”
[
c
 + 1]) {

144 
·štCŞumnBÜd”
(
·štInfo
, 
IÁReù
(
tx
 + 
xPos
, 
ty
 + 
yPos
, 
bÜd”ThickÃss
, 
height
()));

145 
	gxPos
 +ğ
bÜd”ThickÃss
;

147 
	gchd
 = 
chd
->
ÃxtSiblšg
();

148 ià(!
	gchd
)

151 
	gyPos
 +ğ
m_rows
.
m_sizes
[
r
];

152 ià(
	gbÜd”ThickÃss
 && 
	gm_rows
.
	gm_®lowBÜd”
[
r
 + 1]) {

153 
·štRowBÜd”
(
·štInfo
, 
IÁReù
(
tx
, 
ty
 + 
yPos
, 
width
(), 
bÜd”ThickÃss
));

154 
	gyPos
 +ğ
bÜd”ThickÃss
;

159 
boŞ
 
	gR’d”F¿meS‘
::
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
& 
»que¡
, 
H™Te¡ResuÉ
& 
»suÉ
,

160 
x
, 
y
, 
tx
, 
ty
, 
H™Te¡AùiÚ
 
aùiÚ
)

162 ià(
	gaùiÚ
 !ğ
H™Te¡FÜeground
)

163  
çl£
;

165 
boŞ
 
	gšside
 = 
R’d”Box
::
nodeAtPošt
(
»que¡
, 
»suÉ
, 
x
, 
y
, 
tx
, 
ty
, 
aùiÚ
)

166 || 
	gm_isResizšg
;

168 ià(
	gšside
 && 
äameS‘
()->
noResize
()

169 && !
	g»que¡
.
»adOÆy
(è&& !
	g»suÉ
.
šÃrNode
()) {

170 
	g»suÉ
.
£tIÂ”Node
(
node
());

171 
	g»suÉ
.
£tIÂ”NÚSh¬edNode
(
node
());

174  
	gšside
 || 
	gm_isChdResizšg
;

177 
	gR’d”F¿meS‘
::
GridAxis
::
»size
(
size
)

179 
m_sizes
.
»size
(
size
);

180 
	gm_d–s
.
»size
(
size
);

181 
	gm_d–s
.
fl
(0);

186 
	gm_´ev’tResize
.
»size
(
size
 + 1);

187 
	gm_®lowBÜd”
.
»size
(
size
 + 1);

190 
	gR’d”F¿meS‘
::
ÏyOutAxis
(
GridAxis
& 
axis
, cÚ¡ 
L’gth
* 
grid
, 
avaabËL’
)

192 
	gavaabËL’
 = 
max
(
avaabËL’
, 0);

194 * 
	ggridLayout
 = 
axis
.
m_sizes
.
d©a
();

196 ià(!
	ggrid
) {

197 
	ggridLayout
[0] = 
avaabËL’
;

201 
	ggridL’
 = 
axis
.
m_sizes
.
size
();

202 
ASSERT
(
gridL’
);

204 
	gtÙ®R–©ive
 = 0;

205 
	gtÙ®Fixed
 = 0;

206 
	gtÙ®P”ûÁ
 = 0;

207 
	gcouÁR–©ive
 = 0;

208 
	gcouÁFixed
 = 0;

209 
	gcouÁP”ûÁ
 = 0;

213 
	gi
 = 0; i < 
	ggridL’
; ++i) {

216 ià(
	ggrid
[
i
].
isFixed
()) {

217 
	ggridLayout
[
i
] = 
max
(
grid
[i].
v®ue
(), 0);

218 
	gtÙ®Fixed
 +ğ
gridLayout
[
i
];

219 
	gcouÁFixed
++;

224 ià(
	ggrid
[
i
].
isP”ûÁ
()) {

225 
	ggridLayout
[
i
] = 
max
(
grid
[i].
ÿlcV®ue
(
avaabËL’
), 0);

226 
	gtÙ®P”ûÁ
 +ğ
gridLayout
[
i
];

227 
	gcouÁP”ûÁ
++;

232 ià(
	ggrid
[
i
].
isR–©ive
()) {

233 
	gtÙ®R–©ive
 +ğ
max
(
grid
[
i
].
v®ue
(), 1);

234 
	gcouÁR–©ive
++;

238 
	g»maššgL’
 = 
avaabËL’
;

242 ià(
	gtÙ®Fixed
 > 
	g»maššgL’
) {

243 
	g»maššgFixed
 = 
»maššgL’
;

245 
	gi
 = 0; i < 
	ggridL’
; ++i) {

246 ià(
	ggrid
[
i
].
isFixed
()) {

247 
	ggridLayout
[
i
] = (
gridLayout
[i] * 
»maššgFixed
è/ 
tÙ®Fixed
;

248 
	g»maššgL’
 -ğ
gridLayout
[
i
];

252 
	g»maššgL’
 -ğ
tÙ®Fixed
;

258 ià(
	gtÙ®P”ûÁ
 > 
	g»maššgL’
) {

259 
	g»maššgP”ûÁ
 = 
»maššgL’
;

261 
	gi
 = 0; i < 
	ggridL’
; ++i) {

262 ià(
	ggrid
[
i
].
isP”ûÁ
()) {

263 
	ggridLayout
[
i
] = (
gridLayout
[i] * 
»maššgP”ûÁ
è/ 
tÙ®P”ûÁ
;

264 
	g»maššgL’
 -ğ
gridLayout
[
i
];

268 
	g»maššgL’
 -ğ
tÙ®P”ûÁ
;

272 ià(
	gcouÁR–©ive
) {

273 
	gÏ¡R–©ive
 = 0;

274 
	g»maššgR–©ive
 = 
»maššgL’
;

276 
	gi
 = 0; i < 
	ggridL’
; ++i) {

277 ià(
	ggrid
[
i
].
isR–©ive
()) {

278 
	ggridLayout
[
i
] = (
max
(
grid
[i].
v®ue
(), 1è* 
	g»maššgR–©ive
è/ 
	gtÙ®R–©ive
;

279 
	g»maššgL’
 -ğ
gridLayout
[
i
];

280 
	gÏ¡R–©ive
 = 
i
;

288 ià(
	g»maššgL’
) {

289 
	ggridLayout
[
Ï¡R–©ive
] +ğ
»maššgL’
;

290 
	g»maššgL’
 = 0;

296 ià(
	g»maššgL’
) {

301 ià(
	gcouÁP”ûÁ
 && 
	gtÙ®P”ûÁ
) {

302 
	g»maššgP”ûÁ
 = 
»maššgL’
;

303 
	gchªgeP”ûÁ
 = 0;

305 
	gi
 = 0; i < 
	ggridL’
; ++i) {

306 ià(
	ggrid
[
i
].
isP”ûÁ
()) {

307 
	gchªgeP”ûÁ
 = (
»maššgP”ûÁ
 * 
gridLayout
[
i
]è/ 
tÙ®P”ûÁ
;

308 
	ggridLayout
[
i
] +ğ
chªgeP”ûÁ
;

309 
	g»maššgL’
 -ğ
chªgeP”ûÁ
;

312 } ià(
	gtÙ®Fixed
) {

316 
	g»maššgFixed
 = 
»maššgL’
;

317 
	gchªgeFixed
 = 0;

319 
	gi
 = 0; i < 
	ggridL’
; ++i) {

320 ià(
	ggrid
[
i
].
isFixed
()) {

321 
	gchªgeFixed
 = (
»maššgFixed
 * 
gridLayout
[
i
]è/ 
tÙ®Fixed
;

322 
	ggridLayout
[
i
] +ğ
chªgeFixed
;

323 
	g»maššgL’
 -ğ
chªgeFixed
;

333 ià(
	g»maššgL’
 && 
	gcouÁP”ûÁ
) {

334 
	g»maššgP”ûÁ
 = 
»maššgL’
;

335 
	gchªgeP”ûÁ
 = 0;

337 
	gi
 = 0; i < 
	ggridL’
; ++i) {

338 ià(
	ggrid
[
i
].
isP”ûÁ
()) {

339 
	gchªgeP”ûÁ
 = 
»maššgP”ûÁ
 / 
couÁP”ûÁ
;

340 
	ggridLayout
[
i
] +ğ
chªgeP”ûÁ
;

341 
	g»maššgL’
 -ğ
chªgeP”ûÁ
;

348 ià(
	g»maššgL’
 && 
	gcouÁFixed
) {

349 
	g»maššgFixed
 = 
»maššgL’
;

350 
	gchªgeFixed
 = 0;

352 
	gi
 = 0; i < 
	ggridL’
; ++i) {

353 ià(
	ggrid
[
i
].
isFixed
()) {

354 
	gchªgeFixed
 = 
»maššgFixed
 / 
couÁFixed
;

355 
	ggridLayout
[
i
] +ğ
chªgeFixed
;

356 
	g»maššgL’
 -ğ
chªgeFixed
;

363 ià(
	g»maššgL’
)

364 
	ggridLayout
[
gridL’
 - 1] +ğ
»maššgL’
;

367 
boŞ
 
	gwÜked
 = 
Œue
;

368 * 
	ggridD–
 = 
axis
.
m_d–s
.
d©a
();

369 
	gi
 = 0; i < 
	ggridL’
; ++i) {

370 ià(
	ggridLayout
[
i
] && gridLayout[i] + 
	ggridD–
[i] <= 0)

371 
wÜked
 = 
çl£
;

372 
	ggridLayout
[
i
] +ğ
gridD–
[i];

375 ià(!
	gwÜked
) {

376 
	gi
 = 0; i < 
	ggridL’
; ++i)

377 
	ggridLayout
[
i
] -ğ
gridD–
[i];

378 
	gaxis
.
	gm_d–s
.
fl
(0);

382 
	gR’d”F¿meS‘
::
flFromEdgeInfo
(cÚ¡ 
F¿meEdgeInfo
& 
edgeInfo
, 
r
, 
c
)

384 ià(
	gedgeInfo
.
®lowBÜd”
(
LeáF¿meEdge
))

385 
	gm_cŞs
.
	gm_®lowBÜd”
[
c
] = 
Œue
;

386 ià(
	gedgeInfo
.
®lowBÜd”
(
RightF¿meEdge
))

387 
	gm_cŞs
.
	gm_®lowBÜd”
[
c
 + 1] = 
Œue
;

388 ià(
	gedgeInfo
.
´ev’tResize
(
LeáF¿meEdge
))

389 
	gm_cŞs
.
	gm_´ev’tResize
[
c
] = 
Œue
;

390 ià(
	gedgeInfo
.
´ev’tResize
(
RightF¿meEdge
))

391 
	gm_cŞs
.
	gm_´ev’tResize
[
c
 + 1] = 
Œue
;

393 ià(
	gedgeInfo
.
®lowBÜd”
(
TİF¿meEdge
))

394 
	gm_rows
.
	gm_®lowBÜd”
[
r
] = 
Œue
;

395 ià(
	gedgeInfo
.
®lowBÜd”
(
BÙtomF¿meEdge
))

396 
	gm_rows
.
	gm_®lowBÜd”
[
r
 + 1] = 
Œue
;

397 ià(
	gedgeInfo
.
´ev’tResize
(
TİF¿meEdge
))

398 
	gm_rows
.
	gm_´ev’tResize
[
r
] = 
Œue
;

399 ià(
	gedgeInfo
.
´ev’tResize
(
BÙtomF¿meEdge
))

400 
	gm_rows
.
	gm_´ev’tResize
[
r
 + 1] = 
Œue
;

403 
	gR’d”F¿meS‘
::
compu‹EdgeInfo
()

405 
m_rows
.
m_´ev’tResize
.
fl
(
äameS‘
()->
noResize
());

406 
	gm_rows
.
	gm_®lowBÜd”
.
fl
(
çl£
);

407 
	gm_cŞs
.
	gm_´ev’tResize
.
fl
(
äameS‘
()->
noResize
());

408 
	gm_cŞs
.
	gm_®lowBÜd”
.
fl
(
çl£
);

410 
R’d”Objeù
* 
	gchd
 = 
fœ¡Chd
();

411 ià(!
	gchd
)

414 
	grows
 = 
äameS‘
()->
tÙ®Rows
();

415 
	gcŞs
 = 
äameS‘
()->
tÙ®CŞs
();

416 
	gr
 = 0;„ < 
	grows
; ++r) {

417 
	gc
 = 0; c < 
	gcŞs
; ++c) {

418 
F¿meEdgeInfo
 
	gedgeInfo
;

419 ià(
	gchd
->
isF¿meS‘
())

420 
	gedgeInfo
 = 
toR’d”F¿meS‘
(
chd
)->
edgeInfo
();

422 
	gedgeInfo
 = 
toR’d”F¿me
(
chd
)->
edgeInfo
();

423 
flFromEdgeInfo
(
edgeInfo
, 
r
, 
c
);

424 
	gchd
 = 
chd
->
ÃxtSiblšg
();

425 ià(!
	gchd
)

431 
F¿meEdgeInfo
 
	gR’d”F¿meS‘
::
edgeInfo
() const

433 
F¿meEdgeInfo
 
»suÉ
(
äameS‘
()->
noResize
(), 
Œue
);

435 
	grows
 = 
äameS‘
()->
tÙ®Rows
();

436 
	gcŞs
 = 
äameS‘
()->
tÙ®CŞs
();

437 ià(
	grows
 && 
	gcŞs
) {

438 
	g»suÉ
.
£tP»v’tResize
(
LeáF¿meEdge
, 
m_cŞs
.
m_´ev’tResize
[0]);

439 
	g»suÉ
.
£tAÎowBÜd”
(
LeáF¿meEdge
, 
m_cŞs
.
m_®lowBÜd”
[0]);

440 
	g»suÉ
.
£tP»v’tResize
(
RightF¿meEdge
, 
m_cŞs
.
m_´ev’tResize
[
cŞs
]);

441 
	g»suÉ
.
£tAÎowBÜd”
(
RightF¿meEdge
, 
m_cŞs
.
m_®lowBÜd”
[
cŞs
]);

442 
	g»suÉ
.
£tP»v’tResize
(
TİF¿meEdge
, 
m_rows
.
m_´ev’tResize
[0]);

443 
	g»suÉ
.
£tAÎowBÜd”
(
TİF¿meEdge
, 
m_rows
.
m_®lowBÜd”
[0]);

444 
	g»suÉ
.
£tP»v’tResize
(
BÙtomF¿meEdge
, 
m_rows
.
m_´ev’tResize
[
rows
]);

445 
	g»suÉ
.
£tAÎowBÜd”
(
BÙtomF¿meEdge
, 
m_rows
.
m_®lowBÜd”
[
rows
]);

448  
	g»suÉ
;

451 
	gR’d”F¿meS‘
::
Ïyout
()

453 
ASSERT
(
ÃedsLayout
());

455 
boŞ
 
	gdoFuÎR•ašt
 = 
£lfN“dsLayout
(è&& 
checkFÜR•aštDuršgLayout
();

456 
IÁReù
 
	gŞdBounds
;

457 ià(
	gdoFuÎR•ašt
)

458 
	gŞdBounds
 = 
absŞu‹Cl³dOv”æowReù
();

460 ià(!
·»Á
()->
isF¿meS‘
(è&& !
docum’t
()->
´štšg
()) {

461 
£tWidth
(
v›w
()->
v›wWidth
());

462 
£tHeight
(
v›w
()->
v›wHeight
());

465 
size_t
 
	gcŞs
 = 
äameS‘
()->
tÙ®CŞs
();

466 
size_t
 
	grows
 = 
äameS‘
()->
tÙ®Rows
();

468 ià(
	gm_rows
.
	gm_sizes
.
size
(è!ğ
rows
 || 
m_cŞs
.
m_sizes
.size(è!ğ
cŞs
) {

469 
m_rows
.
»size
(
rows
);

470 
	gm_cŞs
.
»size
(
cŞs
);

473 
	gbÜd”ThickÃss
 = 
äameS‘
()->
bÜd”
();

474 
ÏyOutAxis
(
m_rows
, 
äameS‘
()->
rowL’gths
(), 
height
(è- (
rows
 - 1è* 
bÜd”ThickÃss
);

475 
ÏyOutAxis
(
m_cŞs
, 
äameS‘
()->
cŞL’gths
(), 
width
(è- (
cŞs
 - 1è* 
bÜd”ThickÃss
);

477 ià(
æ©‹nF¿meS‘
())

478 
pos™iÚF¿mesW™hFÏ‰’šg
();

480 
pos™iÚF¿mes
();

482 
	gR’d”Box
::
Ïyout
();

484 
compu‹EdgeInfo
();

486 ià(
	gdoFuÎR•ašt
) {

487 
v›w
()->
»·štV›wReùªgË
(
ŞdBounds
);

488 
IÁReù
 
	gÃwBounds
 = 
absŞu‹Cl³dOv”æowReù
();

489 ià(
	gÃwBounds
 !ğ
ŞdBounds
)

490 
v›w
()->
»·štV›wReùªgË
(
ÃwBounds
);

493 
£tN“dsLayout
(
çl£
);

496 
	gR’d”F¿meS‘
::
pos™iÚF¿mes
()

498 
R’d”Box
* 
chd
 = 
fœ¡ChdBox
();

499 ià(!
	gchd
)

502 
	grows
 = 
äameS‘
()->
tÙ®Rows
();

503 
	gcŞs
 = 
äameS‘
()->
tÙ®CŞs
();

505 
	gyPos
 = 0;

506 
	gbÜd”ThickÃss
 = 
äameS‘
()->
bÜd”
();

507 
	gr
 = 0;„ < 
	grows
;„++) {

508 
	gxPos
 = 0;

509 
	gheight
 = 
m_rows
.
m_sizes
[
r
];

510 
	gc
 = 0; c < 
	gcŞs
; c++) {

511 
	gchd
->
£tLoÿtiÚ
(
xPos
, 
yPos
);

512 
	gwidth
 = 
m_cŞs
.
m_sizes
[
c
];

515 ià(
	gwidth
 !ğ
chd
->
width
(è|| 
height
 != child->height()) {

516 
chd
->
£tWidth
(
width
);

517 
	gchd
->
£tHeight
(
height
);

518 
	gchd
->
£tN“dsLayout
(
Œue
);

519 
	gchd
->
Ïyout
();

522 
	gxPos
 +ğ
width
 + 
bÜd”ThickÃss
;

524 
	gchd
 = 
chd
->
ÃxtSiblšgBox
();

525 ià(!
	gchd
)

528 
	gyPos
 +ğ
height
 + 
bÜd”ThickÃss
;

532 ; 
	gchd
; chd = 
chd
->
ÃxtSiblšgBox
()) {

533 
chd
->
£tWidth
(0);

534 
	gchd
->
£tHeight
(0);

535 
	gchd
->
£tN“dsLayout
(
çl£
);

539 
	gR’d”F¿meS‘
::
pos™iÚF¿mesW™hFÏ‰’šg
()

541 
R’d”Box
* 
chd
 = 
fœ¡ChdBox
();

542 ià(!
	gchd
)

545 
	grows
 = 
äameS‘
()->
tÙ®Rows
();

546 
	gcŞs
 = 
äameS‘
()->
tÙ®CŞs
();

548 
	gbÜd”ThickÃss
 = 
äameS‘
()->
bÜd”
();

549 
boŞ
 
	g»·štN“ded
 = 
çl£
;

552 
boŞ
 
	gout
 = 
çl£
;

553 
	gr
 = 0;„ < 
	grows
 && !
	gout
;„++) {

554 
	gexŒa
 = 0;

555 
	gheight
 = 
m_rows
.
m_sizes
[
r
];

557 
	gc
 = 0; c < 
	gcŞs
; c++) {

558 
IÁReù
 
	gŞdF¿meReù
 = 
chd
->
äameReù
();

560 
	gwidth
 = 
m_cŞs
.
m_sizes
[
c
];

562 
boŞ
 
	gfixedWidth
 = 
äameS‘
()->
cŞL’gths
(è&& f¿meS‘()->cŞL’gths()[
c
].
isFixed
();

563 
boŞ
 
	gfixedHeight
 = 
äameS‘
()->
rowL’gths
(è&& f¿meS‘()->rowL’gths()[
r
].
isFixed
();

566 ià(!
	gfixedWidth
)

567 
	gchd
->
£tWidth
(
width
 ? width + 
exŒa
 / (
cŞs
 - 
c
) : 0);

569 
	gchd
->
£tWidth
(
width
);

570 
	gchd
->
£tHeight
(
height
);

572 
	gchd
->
£tN“dsLayout
(
Œue
);

574 ià(
	gchd
->
isF¿meS‘
())

575 
toR’d”F¿meS‘
(
chd
)->
Ïyout
();

577 
toR’d”F¿me
(
chd
)->
ÏyoutW™hFÏ‰’šg
(
fixedWidth
, 
fixedHeight
);

579 ià(
	gchd
->
height
(è> 
	gm_rows
.
	gm_sizes
[
r
])

580 
	gm_rows
.
	gm_sizes
[
r
] = 
chd
->
height
();

581 ià(
	gchd
->
width
(è> 
	gm_cŞs
.
	gm_sizes
[
c
])

582 
	gm_cŞs
.
	gm_sizes
[
c
] = 
chd
->
width
();

584 ià(
	gchd
->
äameReù
(è!ğ
ŞdF¿meReù
)

585 
»·štN“ded
 = 
Œue
;

588 
	gexŒa
 +ğ
width
 - 
m_cŞs
.
m_sizes
[
c
];

590 
	gchd
 = 
chd
->
ÃxtSiblšgBox
();

591 ià(!
	gchd
) {

592 
	gout
 = 
Œue
;

598 
	gxPos
 = 0;

599 
	gyPos
 = 0;

600 
	gout
 = 
çl£
;

601 
	gchd
 = 
fœ¡ChdBox
();

602 
	gr
 = 0;„ < 
	grows
 && !
	gout
;„++) {

603 
	gxPos
 = 0;

604 
	gc
 = 0; c < 
	gcŞs
; c++) {

606 
IÁReù
 
	gŞdReù
 = 
chd
->
äameReù
();

608 
	gchd
->
£tLoÿtiÚ
(
xPos
, 
yPos
);

609 
	gchd
->
£tHeight
(
m_rows
.
m_sizes
[
r
]);

610 
	gchd
->
£tWidth
(
m_cŞs
.
m_sizes
[
c
]);

612 ià(
	gchd
->
äameReù
(è!ğ
ŞdReù
) {

613 
»·štN“ded
 = 
Œue
;

616 
	gchd
->
£tN“dsLayout
(
Œue
);

617 ià(
	gchd
->
isF¿meS‘
())

618 
toR’d”F¿meS‘
(
chd
)->
Ïyout
();

620 
toR’d”F¿me
(
chd
)->
ÏyoutW™hFÏ‰’šg
(
Œue
,rue);

623 
	gxPos
 +ğ
m_cŞs
.
m_sizes
[
c
] + 
bÜd”ThickÃss
;

624 
	gchd
 = 
chd
->
ÃxtSiblšgBox
();

625 ià(!
	gchd
) {

626 
	gout
 = 
Œue
;

630 
	gyPos
 +ğ
m_rows
.
m_sizes
[
r
] + 
bÜd”ThickÃss
;

633 
£tWidth
(
xPos
 - 
bÜd”ThickÃss
);

634 
£tHeight
(
yPos
 - 
bÜd”ThickÃss
);

636 ià(
	g»·štN“ded
)

637 
»·št
();

640 ; 
	gchd
; chd = 
chd
->
ÃxtSiblšgBox
()) {

641 
chd
->
£tWidth
(0);

642 
	gchd
->
£tHeight
(0);

643 
	gchd
->
£tN“dsLayout
(
çl£
);

647 
boŞ
 
	gR’d”F¿meS‘
::
æ©‹nF¿meS‘
() const

649  
docum’t
()->
äame
(è&& docum’t()->äame()->
£‰šgs
()->
äameFÏ‰’šgEÇbËd
();

652 
	gR’d”F¿meS‘
::
¡¬tResizšg
(
GridAxis
& 
axis
, 
pos™iÚ
)

654 
	g¥l™
 = 
h™Te¡S¶™
(
axis
, 
pos™iÚ
);

655 ià(
	g¥l™
 =ğ
noS¶™
 || !
axis
.
m_®lowBÜd”
[
¥l™
] ||‡xis.
m_´ev’tResize
[split]) {

656 
axis
.
m_¥l™BešgResized
 = 
noS¶™
;

659 
	gaxis
.
	gm_¥l™BešgResized
 = 
¥l™
;

660 
	gaxis
.
	gm_¥l™ResizeOff£t
 = 
pos™iÚ
 - 
¥l™Pos™iÚ
(
axis
, 
¥l™
);

663 
	gR’d”F¿meS‘
::
cÚtšueResizšg
(
GridAxis
& 
axis
, 
pos™iÚ
)

665 ià(
ÃedsLayout
())

667 ià(
	gaxis
.
	gm_¥l™BešgResized
 =ğ
noS¶™
)

669 
	gcu¼’tS¶™Pos™iÚ
 = 
¥l™Pos™iÚ
(
axis
,‡xis.
m_¥l™BešgResized
);

670 
	gd–
 = (
pos™iÚ
 - 
cu¼’tS¶™Pos™iÚ
è- 
axis
.
m_¥l™ResizeOff£t
;

671 ià(
	gd–
 == 0)

673 
	gaxis
.
	gm_d–s
[
axis
.
m_¥l™BešgResized
 - 1] +ğ
d–
;

674 
	gaxis
.
	gm_d–s
[
axis
.
m_¥l™BešgResized
] -ğ
d–
;

675 
£tN“dsLayout
(
Œue
);

678 
boŞ
 
	gR’d”F¿meS‘
::
u£rResize
(
Mou£Ev’t
* 
evt
)

680 ià(
æ©‹nF¿meS‘
())

681  
çl£
;

683 ià(!
	gm_isResizšg
) {

684 ià(
ÃedsLayout
())

685  
	gçl£
;

686 ià(
	gevt
->
ty³
(è=ğ
ev’tNames
().
mou£downEv’t
 && 
evt
->
bu‰Ú
(è=ğ
LeáBu‰Ú
) {

687 
FlßtPošt
 
pos
 = 
loÿlToAbsŞu‹
();

688 
¡¬tResizšg
(
m_cŞs
, 
evt
->
absŞu‹LoÿtiÚ
().
x
(è- 
pos
.x());

689 
¡¬tResizšg
(
m_rows
, 
evt
->
absŞu‹LoÿtiÚ
().
y
(è- 
pos
.y());

690 ià(
	gm_cŞs
.
	gm_¥l™BešgResized
 !ğ
noS¶™
 || 
m_rows
.
m_¥l™BešgResized
 !=‚oSplit) {

691 
£tIsResizšg
(
Œue
);

692  
	gŒue
;

696 ià(
	gevt
->
ty³
(è=ğ
ev’tNames
().
mou£moveEv’t
 || (
evt
->ty³(è=ğev’tNames().
mou£upEv’t
 &&ƒvt->
bu‰Ú
(è=ğ
LeáBu‰Ú
)) {

697 
FlßtPošt
 
pos
 = 
loÿlToAbsŞu‹
();

698 
cÚtšueResizšg
(
m_cŞs
, 
evt
->
absŞu‹LoÿtiÚ
().
x
(è- 
pos
.x());

699 
cÚtšueResizšg
(
m_rows
, 
evt
->
absŞu‹LoÿtiÚ
().
y
(è- 
pos
.y());

700 ià(
	gevt
->
ty³
(è=ğ
ev’tNames
().
mou£upEv’t
 && 
evt
->
bu‰Ú
(è=ğ
LeáBu‰Ú
) {

701 
£tIsResizšg
(
çl£
);

702  
	gŒue
;

707  
	gçl£
;

710 
	gR’d”F¿meS‘
::
£tIsResizšg
(
boŞ
 
isResizšg
)

712 
m_isResizšg
 = 
isResizšg
;

713 
R’d”Objeù
* 
	gªû¡Ü
 = 
·»Á
();‡nû¡Ü;‡nû¡Ü = 
ªû¡Ü
->parent()) {

714 ià(
ªû¡Ü
->
isF¿meS‘
())

715 
toR’d”F¿meS‘
(
ªû¡Ü
)->
m_isChdResizšg
 = 
isResizšg
;

717 ià(
F¿me
* 
	gäame
 = 
docum’t
()->
äame
())

718 
äame
->
ev’tHªdËr
()->
£tResizšgF¿meS‘
(
isResizšg
 ? 
äameS‘
() : 0);

721 
boŞ
 
	gR’d”F¿meS‘
::
isResizšgRow
() const

723  
m_isResizšg
 && 
m_rows
.
m_¥l™BešgResized
 !ğ
noS¶™
;

726 
boŞ
 
	gR’d”F¿meS‘
::
isResizšgCŞumn
() const

728  
m_isResizšg
 && 
m_cŞs
.
m_¥l™BešgResized
 !ğ
noS¶™
;

731 
boŞ
 
	gR’d”F¿meS‘
::
ÿnResizeRow
(cÚ¡ 
IÁPošt
& 
p
) const

733 
r
 = 
h™Te¡S¶™
(
m_rows
, 
p
.
y
());

734  
	gr
 !ğ
noS¶™
 && 
m_rows
.
m_®lowBÜd”
[
r
] && !m_rows.
m_´ev’tResize
[r];

737 
boŞ
 
	gR’d”F¿meS‘
::
ÿnResizeCŞumn
(cÚ¡ 
IÁPošt
& 
p
) const

739 
c
 = 
h™Te¡S¶™
(
m_cŞs
, 
p
.
x
());

740  
	gc
 !ğ
noS¶™
 && 
m_cŞs
.
m_®lowBÜd”
[
c
] && !m_cŞs.
m_´ev’tResize
[c];

743 
	gR’d”F¿meS‘
::
¥l™Pos™iÚ
(cÚ¡ 
GridAxis
& 
axis
, 
¥l™
) const

745 ià(
ÃedsLayout
())

748 
	gbÜd”ThickÃss
 = 
äameS‘
()->
bÜd”
();

750 
	gsize
 = 
axis
.
m_sizes
.
size
();

751 ià(!
	gsize
)

754 
	gpos™iÚ
 = 0;

755 
	gi
 = 0; i < 
	g¥l™
 && i < 
	gsize
; ++i)

756 
	gpos™iÚ
 +ğ
axis
.
m_sizes
[
i
] + 
bÜd”ThickÃss
;

757  
	gpos™iÚ
 - 
	gbÜd”ThickÃss
;

760 
	gR’d”F¿meS‘
::
h™Te¡S¶™
(cÚ¡ 
GridAxis
& 
axis
, 
pos™iÚ
) const

762 ià(
ÃedsLayout
())

763  
	gnoS¶™
;

765 
	gbÜd”ThickÃss
 = 
äameS‘
()->
bÜd”
();

766 ià(
	gbÜd”ThickÃss
 <= 0)

767  
noS¶™
;

769 
size_t
 
	gsize
 = 
axis
.
m_sizes
.
size
();

770 ià(!
	gsize
)

771  
	gnoS¶™
;

773 
	g¥l™Pos™iÚ
 = 
axis
.
m_sizes
[0];

774 
size_t
 
	gi
 = 1; i < 
	gsize
; ++i) {

775 ià(
	gpos™iÚ
 >ğ
¥l™Pos™iÚ
 && 
pos™iÚ
 < s¶™Pos™iÚ + 
bÜd”ThickÃss
)

776  
i
;

777 
	g¥l™Pos™iÚ
 +ğ
bÜd”ThickÃss
 + 
axis
.
m_sizes
[
i
];

779  
	gnoS¶™
;

782 
boŞ
 
	gR’d”F¿meS‘
::
isChdAÎowed
(
R’d”Objeù
* 
chd
, 
R’d”StyË
*) const

784  
	gchd
->
isF¿me
(è|| chd->
isF¿meS‘
();

	@RenderFrameSet.h

23 #iâdeà
R’d”F¿meS‘_h


24 
	#R’d”F¿meS‘_h


	)

26 
	~"R’d”Box.h
"

28 
Çme¥aû
 
	gWebCÜe
 {

30 
şass
 
	gHTMLF¿meS‘EËm’t
;

31 
şass
 
	gMou£Ev’t
;

33 
	eF¿meEdge
 { 
	gLeáF¿meEdge
, 
	gRightF¿meEdge
, 
	gTİF¿meEdge
, 
	gBÙtomF¿meEdge
 };

35 
	sF¿meEdgeInfo
 {

36 
F¿meEdgeInfo
(
boŞ
 
´ev’tResize
 = 
çl£
, boŞ 
®lowBÜd”
 = 
Œue
)

37 : 
m_´ev’tResize
(4)

38 , 
m_®lowBÜd”
(4)

40 
	gm_´ev’tResize
.
fl
(
´ev’tResize
);

41 
	gm_®lowBÜd”
.
fl
(
®lowBÜd”
);

44 
boŞ
 
´ev’tResize
(
F¿meEdge
 
edge
ècÚ¡ {  
	gm_´ev’tResize
[edge]; }

45 
boŞ
 
®lowBÜd”
(
F¿meEdge
 
edge
ècÚ¡ {  
	gm_®lowBÜd”
[edge]; }

47 
£tP»v’tResize
(
F¿meEdge
 
edge
, 
boŞ
 
´ev’tResize
è{ 
	gm_´ev’tResize
[edge] =…reventResize; }

48 
£tAÎowBÜd”
(
F¿meEdge
 
edge
, 
boŞ
 
®lowBÜd”
è{ 
	gm_®lowBÜd”
[edge] =‡llowBorder; }

50 
	g´iv©e
:

51 
VeùÜ
<
boŞ
> 
m_´ev’tResize
;

52 
	gVeùÜ
<
	gboŞ
> 
	gm_®lowBÜd”
;

55 şas 
	cR’d”F¿meS‘
 : 
public
 
R’d”Box
 {

56 
public
:

57 
R’d”F¿meS‘
(
HTMLF¿meS‘EËm’t
*);

58 
	gvœtu®
 ~
R’d”F¿meS‘
();

60 cÚ¡ 
R’d”ObjeùChdLi¡
* 
chd»n
(ècÚ¡ {  &
	gm_chd»n
; }

61 
R’d”ObjeùChdLi¡
* 
chd»n
(è{  &
	gm_chd»n
; }

63 
F¿meEdgeInfo
 
edgeInfo
() const;

65 
boŞ
 
u£rResize
(
Mou£Ev’t
*);

67 
boŞ
 
isResizšgRow
() const;

68 
boŞ
 
isResizšgCŞumn
() const;

70 
boŞ
 
ÿnResizeRow
(cÚ¡ 
IÁPošt
&) const;

71 
boŞ
 
ÿnResizeCŞumn
(cÚ¡ 
IÁPošt
&) const;

73 
	g´iv©e
:

74 cÚ¡ 
noS¶™
 = -1;

76 şas 
	cGridAxis
 : 
public
 
NÚcİyabË
 {

77 
public
:

78 
GridAxis
();

79 
»size
();

80 
	gVeùÜ
<> 
	gm_sizes
;

81 
	gVeùÜ
<> 
	gm_d–s
;

82 
	gVeùÜ
<
	gboŞ
> 
	gm_´ev’tResize
;

83 
	gVeùÜ
<
	gboŞ
> 
	gm_®lowBÜd”
;

84 
	gm_¥l™BešgResized
;

85 
	gm_¥l™ResizeOff£t
;

88 
vœtu®
 
R’d”ObjeùChdLi¡
* 
vœtu®Chd»n
(è{  
chd»n
(); }

89 
vœtu®
 cÚ¡ 
R’d”ObjeùChdLi¡
* 
vœtu®Chd»n
(ècÚ¡ {  
chd»n
(); }

91 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderFrameSet"; }

92 
vœtu®
 
boŞ
 
isF¿meS‘
(ècÚ¡ {  
	gŒue
; }

94 
vœtu®
 
Ïyout
();

95 
vœtu®
 
boŞ
 
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, 
x
, 
y
, 
tx
, 
ty
, 
H™Te¡AùiÚ
);

96 
vœtu®
 
·št
(
PaštInfo
&, 
tx
, 
ty
);

97 
vœtu®
 
boŞ
 
isChdAÎowed
(
R’d”Objeù
*, 
R’d”StyË
*) const;

99 
šlše
 
HTMLF¿meS‘EËm’t
* 
äameS‘
() const;

101 
boŞ
 
æ©‹nF¿meS‘
() const;

103 
£tIsResizšg
(
boŞ
);

105 
ÏyOutAxis
(
GridAxis
&, cÚ¡ 
L’gth
*, 
avaabËS·û
);

106 
compu‹EdgeInfo
();

107 
flFromEdgeInfo
(cÚ¡ 
F¿meEdgeInfo
& 
edgeInfo
, 
r
, 
c
);

108 
pos™iÚF¿mes
();

109 
pos™iÚF¿mesW™hFÏ‰’šg
();

111 
¥l™Pos™iÚ
(cÚ¡ 
GridAxis
&, 
¥l™
) const;

112 
h™Te¡S¶™
(cÚ¡ 
GridAxis
&, 
pos™iÚ
) const;

114 
¡¬tResizšg
(
GridAxis
&, 
pos™iÚ
);

115 
cÚtšueResizšg
(
GridAxis
&, 
pos™iÚ
);

117 
·štRowBÜd”
(cÚ¡ 
PaštInfo
&, cÚ¡ 
IÁReù
&);

118 
·štCŞumnBÜd”
(cÚ¡ 
PaštInfo
&, cÚ¡ 
IÁReù
&);

120 
R’d”ObjeùChdLi¡
 
	gm_chd»n
;

122 
GridAxis
 
	gm_rows
;

123 
GridAxis
 
	gm_cŞs
;

125 
boŞ
 
	gm_isResizšg
;

126 
boŞ
 
	gm_isChdResizšg
;

130 
šlše
 
R’d”F¿meS‘
* 
	$toR’d”F¿meS‘
(
R’d”Objeù
* 
objeù
)

132 
	`ASSERT
(!
objeù
 || objeù->
	`isF¿meS‘
());

133  
¡©ic_ÿ¡
<
R’d”F¿meS‘
*>(
objeù
);

134 
	}
}

137 
toR’d”F¿meS‘
(cÚ¡ 
R’d”F¿meS‘
*);

	@RenderHTMLCanvas.cpp

26 
	~"cÚfig.h
"

27 
	~"R’d”HTMLCªvas.h
"

29 
	~"Docum’t.h
"

30 
	~"G¿phicsCÚ‹xt.h
"

31 
	~"HTMLCªvasEËm’t.h
"

32 
	~"HTMLNames.h
"

33 
	~"R’d”V›w.h
"

34 
	~"F¿meV›w.h
"

36 
Çme¥aû
 
	gWebCÜe
 {

38 
usšg
 
Çme¥aû
 
	gHTMLNames
;

40 
	gR’d”HTMLCªvas
::
R’d”HTMLCªvas
(
HTMLCªvasEËm’t
* 
–em’t
)

41 : 
R’d”R•Ïûd
(
–em’t
,ƒËm’t->
size
())

43 
v›w
()->
äameV›w
()->
£tIsVisu®lyNÚEm±y
();

46 
boŞ
 
	gR’d”HTMLCªvas
::
»quœesLay”
() const

48 ià(
R’d”R•Ïûd
::
»quœesLay”
())

49  
Œue
;

51 #ià
ENABLE
(3D
_CANVAS
)

52 
HTMLCªvasEËm’t
* 
	gÿnvas
 = 
¡©ic_ÿ¡
<HTMLCªvasEËm’t*>(
node
());

53  
	gÿnvas
 && cªvas->
is3D
();

55  
	gçl£
;

59 
	gR’d”HTMLCªvas
::
·štR•Ïûd
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

61 
IÁReù
 
	g»ù
 = 
cÚ‹ÁBoxReù
();

62 
	g»ù
.
move
(
tx
, 
ty
);

63 
	g¡©ic_ÿ¡
<
	gHTMLCªvasEËm’t
*>(
node
())->
·št
(
·štInfo
.
cÚ‹xt
, 
»ù
);

66 
	gR’d”HTMLCªvas
::
ÿnvasSizeChªged
()

68 
IÁSize
 
ÿnvasSize
 = 
¡©ic_ÿ¡
<
HTMLCªvasEËm’t
*>(
node
())->
size
();

69 
IÁSize
 
zoomedSize
(
ÿnvasSize
.
width
(è* 
¡yË
()->
efãùiveZoom
(), cªvasSize.
height
() * style()->effectiveZoom());

71 ià(
	gzoomedSize
 =ğ
šŒšsicSize
())

74 
£tIÁršsicSize
(
zoomedSize
);

76 ià(!
·»Á
())

79 ià(!
´efWidthsDœty
())

80 
£tP»fWidthsDœty
(
Œue
);

82 
IÁSize
 
	gŞdSize
 = 
size
();

83 
ÿlcWidth
();

84 
ÿlcHeight
();

85 ià(
	gŞdSize
 =ğ
size
())

88 ià(!
£lfN“dsLayout
())

89 
£tN“dsLayout
(
Œue
);

	@RenderHTMLCanvas.h

26 #iâdeà
R’d”HTMLCªvas_h


27 
	#R’d”HTMLCªvas_h


	)

29 
	~"R’d”R•Ïûd.h
"

31 
Çme¥aû
 
	gWebCÜe
 {

33 
şass
 
	gHTMLCªvasEËm’t
;

35 şas 
	cR’d”HTMLCªvas
 : 
public
 
R’d”R•Ïûd
 {

36 
public
:

37 
R’d”HTMLCªvas
(
HTMLCªvasEËm’t
*);

39 
vœtu®
 
boŞ
 
isCªvas
(ècÚ¡ {  
	gŒue
; }

40 
vœtu®
 
boŞ
 
»quœesLay”
() const;

42 
ÿnvasSizeChªged
();

44 
	g´iv©e
:

45 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderHTMLCanvas"; }

46 
vœtu®
 
·štR•Ïûd
(
PaštInfo
&, 
tx
, 
ty
);

47 
vœtu®
 
šŒšsicSizeChªged
(è{ 
ÿnvasSizeChªged
(); }

50 
šlše
 
R’d”HTMLCªvas
* 
	$toR’d”HTMLCªvas
(
R’d”Objeù
* 
objeù
)

52 
	`ASSERT
(!
objeù
 || !
	`¡rcmp
(objeù->
	`»nd”Name
(), "RenderHTMLCanvas"));

53  
¡©ic_ÿ¡
<
R’d”HTMLCªvas
*>(
objeù
);

54 
	}
}

57 
toR’d”HTMLCªvas
(cÚ¡ 
R’d”HTMLCªvas
*);

	@RenderImage.cpp

26 
	~"cÚfig.h
"

27 
	~"R’d”Image.h
"

29 
	~"F¿me.h
"

30 
	~"G¿phicsCÚ‹xt.h
"

31 
	~"HTMLA»aEËm’t.h
"

32 
	~"HTMLCŞËùiÚ.h
"

33 
	~"HTMLImageEËm’t.h
"

34 
	~"HTMLIÅutEËm’t.h
"

35 
	~"HTMLM­EËm’t.h
"

36 
	~"HTMLNames.h
"

37 
	~"H™Te¡ResuÉ.h
"

38 
	~"Page.h
"

39 
	~"R’d”Theme.h
"

40 
	~"R’d”V›w.h
"

41 
	~"S–eùiÚCÚŒŞËr.h
"

42 
	~<wtf/Cu¼’tTime.h
>

43 
	~<wtf/Unu£dP¬am.h
>

45 #ià
ENABLE
(
WML
)

46 
	~"WMLImageEËm’t.h
"

47 
	~"WMLNames.h
"

50 
usšg
 
Çme¥aû
 
	g¡d
;

52 
Çme¥aû
 
	gWebCÜe
 {

54 cÚ¡ 
	gcIÁ”pŞ©iÚCutoff
 = 800. * 800.;

55 cÚ¡ 
	gcLowQu®™yTimeTh»shŞd
 = 0.050;

57 şas 
	cR’d”ImageSÿËD©a
 : 
public
 
NÚcİyabË
 {

58 
public
:

59 
R’d”ImageSÿËD©a
(
R’d”Image
* 
image
, cÚ¡ 
IÁSize
& 
size
, 
time
, 
boŞ
 
lowQu®™ySÿË
)

60 : 
m_size
(
size
)

61 , 
m_time
(
time
)

62 , 
m_lowQu®™ySÿË
(
lowQu®™ySÿË
)

63 , 
m_highQu®™yR•aštTim”
(
image
, &
R’d”Image
::
highQu®™yR•aštTim”Fœed
)

67 ~
R’d”ImageSÿËD©a
()

69 
m_highQu®™yR•aštTim”
.
¡İ
();

72 cÚ¡ 
	gIÁSize
& 
size
(ècÚ¡ {  
	gm_size
; }

73 
time
(ècÚ¡ {  
	gm_time
; }

74 
boŞ
 
u£LowQu®™ySÿË
(ècÚ¡ {  
	gm_lowQu®™ySÿË
; }

75 
	gTim”
<
	gR’d”Image
>& 
hiqhQu®™yR•aštTim”
(è{  
	gm_highQu®™yR•aštTim”
; }

77 
£tSize
(cÚ¡ 
IÁSize
& 
s
è{ 
	gm_size
 = s; }

78 
£tTime
(
t
è{ 
	gm_time
 =; }

79 
£tU£LowQu®™ySÿË
(
boŞ
 
b
)

81 
	gm_highQu®™yR•aštTim”
.
¡İ
();

82 
	gm_lowQu®™ySÿË
 = 
b
;

83 ià(
	gb
)

84 
	gm_highQu®™yR•aštTim”
.
¡¬tOÃShÙ
(
cLowQu®™yTimeTh»shŞd
);

87 
	g´iv©e
:

88 
IÁSize
 
m_size
;

89 
	gm_time
;

90 
boŞ
 
	gm_lowQu®™ySÿË
;

91 
	gTim”
<
	gR’d”Image
> 
	gm_highQu®™yR•aštTim”
;

94 şas 
	cR’d”ImageSÿËOb£rv”
 {

95 
	gpublic
:

96 
boŞ
 
shouldImagePaštAtLowQu®™y
(
R’d”Image
*, cÚ¡ 
IÁSize
&);

98 
imageDe¡royed
(
R’d”Image
* 
image
)

100 ià(
	ggImages
) {

101 
R’d”ImageSÿËD©a
* 
	gd©a
 = 
gImages
->
ke
(
image
);

102 
d–‘e
 
	gd©a
;

103 ià(
	ggImages
->
size
() == 0) {

104 
d–‘e
 
gImages
;

105 
	ggImages
 = 0;

110 
highQu®™yR•aštTim”Fœed
(
R’d”Image
* 
image
)

112 
	gR’d”ImageSÿËOb£rv”
::
imageDe¡royed
(
image
);

113 
	gimage
->
»·št
();

116 
	gHashM­
<
	gR’d”Image
*, 
	gR’d”ImageSÿËD©a
*>* 
	ggImages
;

119 
boŞ
 
	gR’d”ImageSÿËOb£rv”
::
	$shouldImagePaštAtLowQu®™y
(
R’d”Image
* 
image
, cÚ¡ 
IÁSize
& 
size
)

123 ià(!
image
->
	`image
(è|| !image->image()->
	`isB™m­Image
())

124  
çl£
;

128 
IÁSize
 
	`imageSize
(
image
->
	`image
()->
	`width
(), image->image()->
	`height
());

131 
R’d”ImageSÿËD©a
* 
d©a
 = 0;

132 ià(
gImages
)

133 
d©a
 = 
gImages
->
	`g‘
(
image
);

135 ià(
imageSize
 =ğ
size
) {

137 ià(
d©a
) {

138 
gImages
->
	`»move
(
image
);

139 
d–‘e
 
d©a
;

141  
çl£
;

145 ià(
image
->
	`docum’t
()->
	`·ge
()->
	`šLowQu®™yImageIÁ”pŞ©iÚMode
()) {

146 
tÙ®Pix–s
 = 
¡©ic_ÿ¡
<>(
image
->
	`image
()->
	`width
()è* stic_ÿ¡<>(image->image()->
	`height
());

147 ià(
tÙ®Pix–s
 > 
cIÁ”pŞ©iÚCutoff
)

148  
Œue
;

153 ià(!
d©a
) {

154 
d©a
 = 
Ãw
 
	`R’d”ImageSÿËD©a
(
image
, 
size
, 
	`cu¼’tTime
(), 
çl£
);

155 ià(!
gImages
)

156 
gImages
 = 
Ãw
 
HashM­
<
R’d”Image
*, 
R’d”ImageSÿËD©a
*>;

157 
gImages
->
	`£t
(
image
, 
d©a
);

158  
çl£
;

162 ià(
d©a
->
	`size
(è=ğ
size
)

163  
d©a
->
	`u£LowQu®™ySÿË
();

167 
ÃwTime
 = 
	`cu¼’tTime
();

168 
d©a
->
	`£tU£LowQu®™ySÿË
(
ÃwTime
 - d©a->
	`time
(è< 
cLowQu®™yTimeTh»shŞd
);

169 
d©a
->
	`£tTime
(
ÃwTime
);

170 
d©a
->
	`£tSize
(
size
);

171  
d©a
->
	`u£LowQu®™ySÿË
();

172 
	}
}

174 
	gHashM­
<
	gR’d”Image
*, 
	gR’d”ImageSÿËD©a
*>* 
	gR’d”ImageSÿËOb£rv”
::
gImages
 = 0;

176 
	gR’d”Image
::
highQu®™yR•aštTim”Fœed
(
Tim”
<
R’d”Image
>*)

178 
R’d”ImageSÿËOb£rv”
::
highQu®™yR•aštTim”Fœed
(
this
);

181 
usšg
 
Çme¥aû
 
	gHTMLNames
;

183 
	gR’d”Image
::
	$R’d”Image
(
Node
* 
node
)

184 : 
	`R’d”R•Ïûd
(
node
, 
	`IÁSize
(0, 0))

185 , 
	$m_ÿchedImage
(0)

187 
	`upd©eAÉText
();

189 
	`v›w
()->
	`äameV›w
()->
	`£tIsVisu®lyNÚEm±y
();

190 
	}
}

192 
	gR’d”Image
::~
	$R’d”Image
()

194 ià(
m_ÿchedImage
)

195 
m_ÿchedImage
->
	`»moveCl›Á
(
this
);

196 
R’d”ImageSÿËOb£rv”
::
	`imageDe¡royed
(
this
);

197 
	}
}

199 
	gR’d”Image
::
	$£tCachedImage
(
CachedImage
* 
ÃwImage
)

201 ià(
m_ÿchedImage
 =ğ
ÃwImage
)

203 ià(
m_ÿchedImage
)

204 
m_ÿchedImage
->
	`»moveCl›Á
(
this
);

205 
m_ÿchedImage
 = 
ÃwImage
;

206 ià(
m_ÿchedImage
) {

207 
m_ÿchedImage
->
	`addCl›Á
(
this
);

208 ià(
m_ÿchedImage
->
	`”rÜOccu¼ed
())

209 
	`imageChªged
(
m_ÿchedImage
.
	`g‘
());

211 
	}
}

214 cÚ¡ 
	g·ddšgWidth
 = 4;

215 cÚ¡ 
	g·ddšgHeight
 = 4;

219 cÚ¡ 
	gmaxAÉTextWidth
 = 1024;

220 cÚ¡ 
	gmaxAÉTextHeight
 = 256;

224 
boŞ
 
	gR’d”Image
::
	$£tImageSizeFÜAÉText
(
CachedImage
* 
ÃwImage
 )

226 
imageWidth
 = 0;

227 
imageHeight
 = 0;

230 ià(!
m_®tText
.
	`isEm±y
(è|| 
ÃwImage
) {

231 
imageWidth
 = 
·ddšgWidth
;

232 
imageHeight
 = 
·ddšgHeight
;

235 ià(
ÃwImage
 &&‚ewImage->
	`image
()) {

238 
imageWidth
 +ğ
ÃwImage
->
	`image
()->
	`width
(è* 
	`¡yË
()->
	`efãùiveZoom
();

239 
imageHeight
 +ğ
ÃwImage
->
	`image
()->
	`height
(è* 
	`¡yË
()->
	`efãùiveZoom
();

243 ià(!
m_®tText
.
	`isEm±y
()) {

244 cÚ¡ 
FÚt
& 
fÚt
 = 
	`¡yË
()->
	`fÚt
();

245 
imageWidth
 = 
	`max
(imageWidth, 
	`mš
(
fÚt
.
	`width
(
	`TextRun
(
m_®tText
.
	`ch¬aù”s
(), m_®tText.
	`Ëngth
())), 
maxAÉTextWidth
));

246 
imageHeight
 = 
	`max
(imageHeight, 
	`mš
(
fÚt
.
	`height
(), 
maxAÉTextHeight
));

249 
IÁSize
 
imageSize
 = 
	`IÁSize
(
imageWidth
, 
imageHeight
);

250 ià(
imageSize
 =ğ
	`šŒšsicSize
())

251  
çl£
;

253 
	`£tIÁršsicSize
(
imageSize
);

254  
Œue
;

255 
	}
}

257 
	gR’d”Image
::
	$imageChªged
(
W¿µedImagePŒ
 
ÃwImage
, cÚ¡ 
IÁReù
* 
»ù
)

259 ià(
	`docum’tBešgDe¡royed
())

262 ià(
	`hasBoxDecÜ©iÚs
(è|| 
	`hasMask
())

263 
R’d”R•Ïûd
::
	`imageChªged
(
ÃwImage
, 
»ù
);

265 ià(
ÃwImage
 !ğ
	`imagePŒ
() || !newImage)

268 
boŞ
 
imageSizeChªged
 = 
çl£
;

271 ià(
	`”rÜOccu¼ed
())

272 
imageSizeChªged
 = 
	`£tImageSizeFÜAÉText
(
m_ÿchedImage
.
	`g‘
());

274 
boŞ
 
shouldR•ašt
 = 
Œue
;

277 ià(
	`imageSize
(
	`¡yË
()->
	`efãùiveZoom
()è!ğ
	`šŒšsicSize
(è|| 
imageSizeChªged
) {

278 ià(!
	`”rÜOccu¼ed
())

279 
	`£tIÁršsicSize
(
	`imageSize
(
	`¡yË
()->
	`efãùiveZoom
()));

284 ià(
	`cÚššgBlock
()) {

286 
Şdwidth
 = 
	`width
();

287 
Şdheight
 = 
	`height
();

288 ià(!
	`´efWidthsDœty
())

289 
	`£tP»fWidthsDœty
(
Œue
);

290 
	`ÿlcWidth
();

291 
	`ÿlcHeight
();

293 ià(
imageSizeChªged
 || 
	`width
(è!ğ
Şdwidth
 || 
	`height
(è!ğ
Şdheight
) {

294 
shouldR•ašt
 = 
çl£
;

295 ià(!
	`£lfN“dsLayout
())

296 
	`£tN“dsLayout
(
Œue
);

299 
	`£tWidth
(
Şdwidth
);

300 
	`£tHeight
(
Şdheight
);

304 ià(
shouldR•ašt
) {

305 
IÁReù
 
»·štReù
;

306 ià(
»ù
) {

309 
»·štReù
 = 
	`’şosšgIÁReù
(
	`m­Reù
(*
»ù
, 
	`FlßtReù
(
	`FlßtPošt
(), 
	`imageSize
(1.0f)), 
	`cÚ‹ÁBoxReù
()));

311 
»·štReù
.
	`š‹r£ù
(
	`cÚ‹ÁBoxReù
());

313 
»·štReù
 = 
	`cÚ‹ÁBoxReù
();

315 
	`»·štReùªgË
(
»·štReù
);

317 #ià
	`USE
(
ACCELERATED_COMPOSITING
)

318 ià(
	`hasLay”
()) {

320 
	`Ïy”
()->
	`»nd””CÚ‹ÁChªged
();

324 
	}
}

326 
	gR’d”Image
::
	$nÙifyFšished
(
CachedResourû
* 
ÃwImage
)

328 ià(
	`docum’tBešgDe¡royed
())

331 #ià
	`USE
(
ACCELERATED_COMPOSITING
)

332 ià((
ÃwImage
 =ğ
m_ÿchedImage
è&& 
	`hasLay”
()) {

335 
	`Ïy”
()->
	`»nd””CÚ‹ÁChªged
();

338 
	`UNUSED_PARAM
(
ÃwImage
);

340 
	}
}

342 
	gR’d”Image
::
	$»£tAnim©iÚ
()

344 ià(
m_ÿchedImage
) {

345 
	`image
()->
	`»£tAnim©iÚ
();

346 ià(!
	`ÃedsLayout
())

347 
	`»·št
();

349 
	}
}

351 
	gR’d”Image
::
	$·štR•Ïûd
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

353 
cWidth
 = 
	`cÚ‹ÁWidth
();

354 
cHeight
 = 
	`cÚ‹ÁHeight
();

355 
ËáBÜd”
 = 
	`bÜd”Leá
();

356 
tİBÜd”
 = 
	`bÜd”Tİ
();

357 
ËáPad
 = 
	`·ddšgLeá
();

358 
tİPad
 = 
	`·ddšgTİ
();

360 ià(
	`docum’t
()->
	`´štšg
(è&& !
	`v›w
()->
	`´štImages
())

363 
G¿phicsCÚ‹xt
* 
cÚ‹xt
 = 
·štInfo
.context;

365 ià(!
	`hasImage
(è|| 
	`”rÜOccu¼ed
()) {

366 ià(
·štInfo
.
pha£
 =ğ
PaštPha£S–eùiÚ
)

369 ià(
cWidth
 > 2 && 
cHeight
 > 2) {

371 
cÚ‹xt
->
	`£tSŒokeStyË
(
SŞidSŒoke
);

372 
cÚ‹xt
->
	`£tSŒokeCŞÜ
(
CŞÜ
::
lightG¿y
, 
	`¡yË
()->
	`cŞÜS·û
());

373 
cÚ‹xt
->
	`£tFlCŞÜ
(
CŞÜ
::
Œª¥¬’t
, 
	`¡yË
()->
	`cŞÜS·û
());

374 
cÚ‹xt
->
	`d¿wReù
(
	`IÁReù
(
tx
 + 
ËáBÜd”
 + 
ËáPad
, 
ty
 + 
tİBÜd”
 + 
tİPad
, 
cWidth
, 
cHeight
));

376 
boŞ
 
”rÜPiùu»D¿wn
 = 
çl£
;

377 
imageX
 = 0;

378 
imageY
 = 0;

381 
u§bËWidth
 = 
cWidth
 - 2;

382 
u§bËHeight
 = 
cHeight
 - 2;

384 ià(
	`”rÜOccu¼ed
(è&& !
	`image
()->
	`isNuÎ
(è&& (
u§bËWidth
 >ğimage()->
	`width
()è&& (
u§bËHeight
 >ğimage()->
	`height
())) {

386 
ûÁ”X
 = (
u§bËWidth
 - 
	`image
()->
	`width
()) / 2;

387 ià(
ûÁ”X
 < 0)

388 
ûÁ”X
 = 0;

389 
ûÁ”Y
 = (
u§bËHeight
 - 
	`image
()->
	`height
()) / 2;

390 ià(
ûÁ”Y
 < 0)

391 
ûÁ”Y
 = 0;

392 
imageX
 = 
ËáBÜd”
 + 
ËáPad
 + 
ûÁ”X
 + 1;

393 
imageY
 = 
tİBÜd”
 + 
tİPad
 + 
ûÁ”Y
 + 1;

394 
cÚ‹xt
->
	`d¿wImage
(
	`image
(), 
	`¡yË
()->
	`cŞÜS·û
(), 
	`IÁPošt
(
tx
 + 
imageX
, 
ty
 + 
imageY
));

395 
”rÜPiùu»D¿wn
 = 
Œue
;

398 ià(!
m_®tText
.
	`isEm±y
()) {

399 
SŒšg
 
‹xt
 = 
	`docum’t
()->
	`di¥ÏySŒšgModif›dByEncodšg
(
m_®tText
);

400 
cÚ‹xt
->
	`£tFlCŞÜ
(
	`¡yË
()->
	`cŞÜ
(), styË()->
	`cŞÜS·û
());

401 
ax
 = 
tx
 + 
ËáBÜd”
 + 
ËáPad
;

402 
ay
 = 
ty
 + 
tİBÜd”
 + 
tİPad
;

403 cÚ¡ 
FÚt
& 
fÚt
 = 
	`¡yË
()->
	`fÚt
();

404 
asûÁ
 = 
fÚt
.
	`asûÁ
();

408 
TextRun
 
	`‹xtRun
(
‹xt
.
	`ch¬aù”s
(),ext.
	`Ëngth
());

409 
‹xtWidth
 = 
fÚt
.
	`width
(
‹xtRun
);

410 ià(
”rÜPiùu»D¿wn
) {

411 ià(
u§bËWidth
 >ğ
‹xtWidth
 && 
fÚt
.
	`height
(è<ğ
imageY
)

412 
cÚ‹xt
->
	`d¿wText
(
	`¡yË
()->
	`fÚt
(), 
‹xtRun
, 
	`IÁPošt
(
ax
, 
ay
 + 
asûÁ
));

413 } ià(
u§bËWidth
 >ğ
‹xtWidth
 && 
cHeight
 >ğ
fÚt
.
	`height
())

414 
cÚ‹xt
->
	`d¿wText
(
	`¡yË
()->
	`fÚt
(), 
‹xtRun
, 
	`IÁPošt
(
ax
, 
ay
 + 
asûÁ
));

417 } ià(
	`hasImage
(è&& 
cWidth
 > 0 && 
cHeight
 > 0) {

418 
Image
* 
img
 = 
	`image
(
cWidth
, 
cHeight
);

419 ià(!
img
 || img->
	`isNuÎ
())

422 #ià
	`PLATFORM
(
MAC
)

423 ià(
	`¡yË
()->
	`highlight
(è!ğ
nuÎAtom
 && !
·štInfo
.
cÚ‹xt
->
	`·štšgDi§bËd
())

424 
	`·štCu¡omHighlight
(
tx
 - 
	`x
(), 
ty
 - 
	`y
(), 
	`¡yË
()->
	`highlight
(), 
Œue
);

427 
IÁSize
 
	`cÚ‹ÁSize
(
cWidth
, 
cHeight
);

428 
IÁReù
 
	`»ù
(
	`IÁPošt
(
tx
 + 
ËáBÜd”
 + 
ËáPad
, 
ty
 + 
tİBÜd”
 + 
tİPad
), 
cÚ‹ÁSize
);

429 
	`·štIÁoReù
(
cÚ‹xt
, 
»ù
);

431 
	}
}

433 
	gR’d”Image
::
	$·št
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

435 
R’d”R•Ïûd
::
	`·št
(
·štInfo
, 
tx
, 
ty
);

437 ià(
·štInfo
.
pha£
 =ğ
PaštPha£Ouše
)

438 
	`·štFocusRšgs
(
·štInfo
, 
	`¡yË
());

439 
	}
}

441 
	gR’d”Image
::
	$·štFocusRšgs
(
PaštInfo
& 
·štInfo
, cÚ¡ 
R’d”StyË
* 
¡yË
)

444 ià(
	`docum’t
()->
	`´štšg
(è|| !docum’t()->
	`äame
()->
	`£ËùiÚ
()->
	`isFocu£dAndAùive
())

447 ià(
·štInfo
.
cÚ‹xt
->
	`·štšgDi§bËd
(è&& !·štInfo.cÚ‹xt->
	`upd©šgCÚŒŞTšts
())

450 
HTMLM­EËm’t
* 
m­EËm’t
 = 
	`imageM­
();

451 ià(!
m­EËm’t
)

454 
Docum’t
* 
docum’t
 = 
m­EËm’t
->
	`docum’t
();

455 ià(!
docum’t
)

458 
Node
* 
focu£dNode
 = 
docum’t
->
	`focu£dNode
();

459 ià(!
focu£dNode
)

462 
RefPŒ
<
HTMLCŞËùiÚ
> 
¬—s
 = 
m­EËm’t
->
	`¬—s
();

463 
numA»as
 = 
¬—s
->
	`Ëngth
();

466 
k
 = 0; k < 
numA»as
; ++k) {

467 
HTMLA»aEËm’t
* 
¬—EËm’t
 = 
¡©ic_ÿ¡
<HTMLA»aEËm’t*>(
¬—s
->
	`™em
(
k
));

468 ià(
focu£dNode
 !ğ
¬—EËm’t
)

471 
VeùÜ
<
P©h
> 
focusRšgP©hs
;

472 
focusRšgP©hs
.
	`­³nd
(
¬—EËm’t
->
	`g‘P©h
(
this
));

473 
·štInfo
.
cÚ‹xt
->
	`d¿wFocusRšg
(
focusRšgP©hs
, 
¡yË
->
	`oušeWidth
(), styË->
	`oušeOff£t
(), styË->
	`vis™edD•’d’tCŞÜ
(
CSSPrİ”tyOušeCŞÜ
));

476 
	}
}

478 
	gR’d”Image
::
	$·štIÁoReù
(
G¿phicsCÚ‹xt
* 
cÚ‹xt
, cÚ¡ 
IÁReù
& 
»ù
)

480 ià(!
	`hasImage
(è|| 
	`”rÜOccu¼ed
(è|| 
»ù
.
	`width
(è<ğ0 ||„eù.
	`height
() <= 0)

483 
Image
* 
img
 = 
	`image
(
»ù
.
	`width
(),„eù.
	`height
());

484 ià(!
img
 || img->
	`isNuÎ
())

487 
HTMLImageEËm’t
* 
imageEÉ
 = (
	`node
(è&&‚ode()->
	`hasTagName
(
imgTag
)è? 
¡©ic_ÿ¡
<HTMLImageElement*>(node()) : 0;

488 
Compos™eO³¿tÜ
 
compos™eO³¿tÜ
 = 
imageEÉ
 ? imageEÉ->
	`compos™eO³¿tÜ
(è: 
Compos™eSourûOv”
;

489 
boŞ
 
u£LowQu®™ySÿlšg
 = 
R’d”ImageSÿËOb£rv”
::
	`shouldImagePaštAtLowQu®™y
(
this
, 
»ù
.
	`size
());

490 
cÚ‹xt
->
	`d¿wImage
(
	`image
(
»ù
.
	`width
(),„eù.
	`height
()), 
	`¡yË
()->
	`cŞÜS·û
(),„eù, 
compos™eO³¿tÜ
, 
u£LowQu®™ySÿlšg
);

491 
	}
}

493 
	gR’d”Image
::
	$mšimumR•ÏûdHeight
() const

495  
	`”rÜOccu¼ed
(è? 
	`šŒšsicSize
().
	`height
() : 0;

496 
	}
}

498 
HTMLM­EËm’t
* 
	gR’d”Image
::
	$imageM­
() const

500 
HTMLImageEËm’t
* 
i
 = 
	`node
(è&&‚ode()->
	`hasTagName
(
imgTag
è? 
¡©ic_ÿ¡
<HTMLImageElement*>(node()) : 0;

501  
i
 ? i->
	`docum’t
()->
	`g‘ImageM­
(i->
	`g‘A‰ribu‹
(
u£m­A‰r
)) : 0;

502 
	}
}

504 
boŞ
 
	gR’d”Image
::
	$nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
& 
»que¡
, 
H™Te¡ResuÉ
& 
»suÉ
, 
x
, 
y
, 
tx
, 
ty
, 
H™Te¡AùiÚ
 
h™Te¡AùiÚ
)

506 
H™Te¡ResuÉ
 
	`‹mpResuÉ
(
»suÉ
.
	`pošt
());

507 
boŞ
 
šside
 = 
R’d”R•Ïûd
::
	`nodeAtPošt
(
»que¡
, 
‹mpResuÉ
, 
x
, 
y
, 
tx
, 
ty
, 
h™Te¡AùiÚ
);

509 ià(
šside
 && 
	`node
()) {

510 ià(
HTMLM­EËm’t
* 
m­
 = 
	`imageM­
()) {

511 
IÁReù
 
cÚ‹ÁBox
 = 
	`cÚ‹ÁBoxReù
();

512 
zoom
 = 
	`¡yË
()->
	`efãùiveZoom
();

513 
m­X
 = 
	`Ìoundf
((
x
 - 
tx
 - 
this
->
	`x
(è- 
cÚ‹ÁBox
.x()è/ 
zoom
);

514 
m­Y
 = 
	`Ìoundf
((
y
 - 
ty
 - 
this
->
	`y
(è- 
cÚ‹ÁBox
.y()è/ 
zoom
);

515 ià(
m­
->
	`m­Mou£Ev’t
(
m­X
, 
m­Y
, 
cÚ‹ÁBox
.
	`size
(), 
‹mpResuÉ
))

516 
‹mpResuÉ
.
	`£tIÂ”NÚSh¬edNode
(
	`node
());

520 ià(
šside
)

521 
»suÉ
 = 
‹mpResuÉ
;

522  
šside
;

523 
	}
}

525 
	gR’d”Image
::
	$upd©eAÉText
()

527 ià(!
	`node
())

530 ià(
	`node
()->
	`hasTagName
(
šputTag
))

531 
m_®tText
 = 
¡©ic_ÿ¡
<
HTMLIÅutEËm’t
*>(
	`node
())->
	`®tText
();

532 ià(
	`node
()->
	`hasTagName
(
imgTag
))

533 
m_®tText
 = 
¡©ic_ÿ¡
<
HTMLImageEËm’t
*>(
	`node
())->
	`®tText
();

534 #ià
	`ENABLE
(
WML
)

535 ià(
	`node
()->
	`hasTagName
(
WMLNames
::
imgTag
))

536 
m_®tText
 = 
¡©ic_ÿ¡
<
WMLImageEËm’t
*>(
	`node
())->
	`®tText
();

538 
	}
}

540 
boŞ
 
	gR’d”Image
::
	$isWidthS³cif›d
() const

542 
	`¡yË
()->
	`width
().
	`ty³
()) {

543 
Fixed
:

544 
P”ûÁ
:

545  
Œue
;

546 
Auto
:

547 
R–©ive
:

548 
Stic
:

549 
IÁršsic
:

550 
MšIÁršsic
:

551  
çl£
;

553 
	`ASSERT
(
çl£
);

554  
çl£
;

555 
	}
}

557 
boŞ
 
	gR’d”Image
::
	$isHeightS³cif›d
() const

559 
	`¡yË
()->
	`height
().
	`ty³
()) {

560 
Fixed
:

561 
P”ûÁ
:

562  
Œue
;

563 
Auto
:

564 
R–©ive
:

565 
Stic
:

566 
IÁršsic
:

567 
MšIÁršsic
:

568  
çl£
;

570 
	`ASSERT
(
çl£
);

571  
çl£
;

572 
	}
}

574 
	gR’d”Image
::
	$ÿlcR•ÏûdWidth
(
boŞ
 
šşudeMaxWidth
) const

576 ià(
	`imageHasR–©iveWidth
())

577 ià(
R’d”Objeù
* 
cb
 = 
	`isPos™iÚed
(è? 
	`cÚš”
(è: 
	`cÚššgBlock
()) {

578 ià(
cb
->
	`isBox
())

579 
	`£tImageCÚš”Size
(
	`IÁSize
(
	`toR’d”Box
(
cb
)->
	`avaabËWidth
(),oR’d”Box(cb)->
	`avaabËHeight
()));

582 
width
;

583 ià(
	`isWidthS³cif›d
())

584 
width
 = 
	`ÿlcR•ÏûdWidthUsšg
(
	`¡yË
()->
	`width
());

585 ià(
	`u£sImageCÚš”Size
())

586 
width
 = 
	`imageSize
(
	`¡yË
()->
	`efãùiveZoom
()).
	`width
();

587 ià(
	`imageHasR–©iveWidth
())

588 
width
 = 0;

590 
width
 = 
	`ÿlcA¥eùR©ioWidth
();

592 
mšW
 = 
	`ÿlcR•ÏûdWidthUsšg
(
	`¡yË
()->
	`mšWidth
());

593 
maxW
 = !
šşudeMaxWidth
 || 
	`¡yË
()->
	`maxWidth
().
	`isUndefšed
(è? 
width
 : 
	`ÿlcR•ÏûdWidthUsšg
(style()->maxWidth());

595  
	`max
(
mšW
, 
	`mš
(
width
, 
maxW
));

596 
	}
}

598 
	gR’d”Image
::
	$ÿlcR•ÏûdHeight
() const

600 
height
;

601 ià(
	`isHeightS³cif›d
())

602 
height
 = 
	`ÿlcR•ÏûdHeightUsšg
(
	`¡yË
()->
	`height
());

603 ià(
	`u£sImageCÚš”Size
())

604 
height
 = 
	`imageSize
(
	`¡yË
()->
	`efãùiveZoom
()).
	`height
();

605 ià(
	`imageHasR–©iveHeight
())

606 
height
 = 0;

608 
height
 = 
	`ÿlcA¥eùR©ioHeight
();

610 
mšH
 = 
	`ÿlcR•ÏûdHeightUsšg
(
	`¡yË
()->
	`mšHeight
());

611 
maxH
 = 
	`¡yË
()->
	`maxHeight
().
	`isUndefšed
(è? 
height
 : 
	`ÿlcR•ÏûdHeightUsšg
(style()->maxHeight());

613  
	`max
(
mšH
, 
	`mš
(
height
, 
maxH
));

614 
	}
}

616 
	gR’d”Image
::
	$ÿlcA¥eùR©ioWidth
() const

618 
IÁSize
 
size
 = 
	`šŒšsicSize
();

619 ià(!
size
.
	`height
())

621 ià(!
	`hasImage
(è|| 
	`”rÜOccu¼ed
())

622  
size
.
	`width
();

623  
R’d”R•Ïûd
::
	`ÿlcR•ÏûdHeight
(è* 
size
.
	`width
(è/ size.
	`height
();

624 
	}
}

626 
	gR’d”Image
::
	$ÿlcA¥eùR©ioHeight
() const

628 
IÁSize
 
size
 = 
	`šŒšsicSize
();

629 ià(!
size
.
	`width
())

631 ià(!
	`hasImage
(è|| 
	`”rÜOccu¼ed
())

632  
size
.
	`height
();

633  
R’d”R•Ïûd
::
	`ÿlcR•ÏûdWidth
(è* 
size
.
	`height
(è/ size.
	`width
();

634 
	}
}

636 
	gR’d”Image
::
	$ÿlcP»fWidths
()

638 
	`ASSERT
(
	`´efWidthsDœty
());

640 
·ddšgAndBÜd”s
 = 
	`·ddšgLeá
(è+ 
	`·ddšgRight
(è+ 
	`bÜd”Leá
(è+ 
	`bÜd”Right
();

641 
m_maxP»fWidth
 = 
	`ÿlcR•ÏûdWidth
(
çl£
è+ 
·ddšgAndBÜd”s
;

643 ià(
	`¡yË
()->
	`maxWidth
().
	`isFixed
(è&& styË()->maxWidth().
	`v®ue
(è!ğ
undefšedL’gth
)

644 
m_maxP»fWidth
 = 
	`mš
(m_maxP»fWidth, 
	`¡yË
()->
	`maxWidth
().
	`v®ue
(è+ (¡yË()->
	`boxSizšg
(è=ğ
CONTENT_BOX
 ? 
·ddšgAndBÜd”s
 : 0));

646 ià(
	`¡yË
()->
	`width
().
	`isP”ûÁ
(è|| styË()->
	`height
().isPercent() ||

647 
	`¡yË
()->
	`maxWidth
().
	`isP”ûÁ
(è|| styË()->
	`maxHeight
().isPercent() ||

648 
	`¡yË
()->
	`mšWidth
().
	`isP”ûÁ
(è|| styË()->
	`mšHeight
().isPercent())

649 
m_mšP»fWidth
 = 0;

651 
m_mšP»fWidth
 = 
m_maxP»fWidth
;

653 
	`£tP»fWidthsDœty
(
çl£
);

654 
	}
}

656 
Image
* 
	gR’d”Image
::
	$nuÎImage
()

658  
Image
::
	`nuÎImage
();

659 
	}
}

	@RenderImage.h

25 #iâdeà
R’d”Image_h


26 
	#R’d”Image_h


	)

28 
	~"R’d”R•Ïûd.h
"

30 
Çme¥aû
 
	gWebCÜe
 {

32 
şass
 
	gHTMLM­EËm’t
;

34 şas 
	cR’d”Image
 : 
public
 
R’d”R•Ïûd
 {

35 
public
:

36 
R’d”Image
(
Node
*);

37 
	gvœtu®
 ~
R’d”Image
();

39 
boŞ
 
£tImageSizeFÜAÉText
(
CachedImage
* 
ÃwImage
 = 0);

41 
upd©eAÉText
();

43 
£tCachedImage
(
CachedImage
*);

44 
CachedImage
* 
ÿchedImage
(ècÚ¡ {  
	gm_ÿchedImage
.
g‘
(); }

46 
HTMLM­EËm’t
* 
imageM­
() const;

48 
»£tAnim©iÚ
();

50 
vœtu®
 
boŞ
 
hasImage
(ècÚ¡ {  
	gm_ÿchedImage
; }

52 
highQu®™yR•aštTim”Fœed
(
Tim”
<
R’d”Image
>*);

54 
	g´Ùeùed
:

55 
vœtu®
 
Image
* 
image
(ğ0, ğ0è{  
m_ÿchedImage
 ? m_ÿchedImage->image(è: 
nuÎImage
(); }

56 
vœtu®
 
boŞ
 
”rÜOccu¼ed
(ècÚ¡ {  
	gm_ÿchedImage
 && m_cachedImage->errorOccurred(); }

58 
vœtu®
 
imageChªged
(
W¿µedImagePŒ
, cÚ¡ 
IÁReù
* = 0);

60 
vœtu®
 
·štIÁoReù
(
G¿phicsCÚ‹xt
*, cÚ¡ 
IÁReù
&);

61 
·štFocusRšgs
(
PaštInfo
&, cÚ¡ 
R’d”StyË
*);

62 
vœtu®
 
·št
(
PaštInfo
&, 
tx
, 
ty
);

64 
boŞ
 
isWidthS³cif›d
() const;

65 
boŞ
 
isHeightS³cif›d
() const;

67 
vœtu®
 
šŒšsicSizeChªged
(è{ 
imageChªged
(
imagePŒ
()); }

69 
	g´iv©e
:

70 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderImage"; }

72 
vœtu®
 
boŞ
 
isImage
(ècÚ¡ {  
	gŒue
; }

73 
vœtu®
 
boŞ
 
isR’d”Image
(ècÚ¡ {  
	gŒue
; }

75 
vœtu®
 
·štR•Ïûd
(
PaštInfo
&, 
tx
, 
ty
);

77 
vœtu®
 
mšimumR•ÏûdHeight
() const;

79 
vœtu®
 
nÙifyFšished
(
CachedResourû
*);

80 
vœtu®
 
boŞ
 
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, 
x
, 
y
, 
tx
, 
ty
, 
H™Te¡AùiÚ
);

82 
vœtu®
 
ÿlcR•ÏûdWidth
(
boŞ
 
šşudeMaxWidth
 = 
Œue
) const;

83 
vœtu®
 
ÿlcR•ÏûdHeight
() const;

85 
vœtu®
 
ÿlcP»fWidths
();

87 
vœtu®
 
boŞ
 
u£sImageCÚš”Size
(ècÚ¡ {  
	gm_ÿchedImage
 ? m_ÿchedImage->u£sImageCÚš”Size(è: 
çl£
; }

88 
vœtu®
 
£tImageCÚš”Size
(cÚ¡ 
IÁSize
& 
size
ècÚ¡ { ià(
	gm_ÿchedImage
) m_cachedImage->setImageContainerSize(size); }

89 
vœtu®
 
boŞ
 
imageHasR–©iveWidth
(ècÚ¡ {  
	gm_ÿchedImage
 ? m_ÿchedImage->imageHasR–©iveWidth(è: 
çl£
; }

90 
vœtu®
 
boŞ
 
imageHasR–©iveHeight
(ècÚ¡ {  
	gm_ÿchedImage
 ? m_ÿchedImage->imageHasR–©iveHeight(è: 
çl£
; }

91 
vœtu®
 
IÁSize
 
imageSize
(
muÉl›r
ècÚ¡ {  
	gm_ÿchedImage
 ? m_cachedImage->imageSize(multiplier) : IntSize(); }

92 
vœtu®
 
W¿µedImagePŒ
 
imagePŒ
(ècÚ¡ {  
	gm_ÿchedImage
.
g‘
(); }

94 
ÿlcA¥eùR©ioWidth
() const;

95 
ÿlcA¥eùR©ioHeight
() const;

97 
	g´Ùeùed
:

99 
CachedResourûHªdË
<
CachedImage
> 
m_ÿchedImage
;

101 
	g´iv©e
:

103 
SŒšg
 
m_®tText
;

105 
Image
* 
nuÎImage
();

107 
ä›nd
 
şass
 
	gR’d”ImageSÿËOb£rv”
;

110 
šlše
 
R’d”Image
* 
	$toR’d”Image
(
R’d”Objeù
* 
objeù
)

112 
	`ASSERT
(!
objeù
 || objeù->
	`isR’d”Image
());

113  
¡©ic_ÿ¡
<
R’d”Image
*>(
objeù
);

114 
	}
}

116 
šlše
 cÚ¡ 
R’d”Image
* 
	$toR’d”Image
(cÚ¡ 
R’d”Objeù
* 
objeù
)

118 
	`ASSERT
(!
objeù
 || objeù->
	`isR’d”Image
());

119  
¡©ic_ÿ¡
<cÚ¡ 
R’d”Image
*>(
objeù
);

120 
	}
}

123 
toR’d”Image
(cÚ¡ 
R’d”Image
*);

	@RenderImageGeneratedContent.cpp

26 
	~"cÚfig.h
"

27 
	~"R’d”ImageG’”©edCÚ‹Á.h
"

29 
	~"R’d”Block.h
"

30 
	~"R’d”StyË.h
"

31 
	~"StyËCachedImage.h
"

33 
Çme¥aû
 
	gWebCÜe
 {

35 
	gR’d”ImageG’”©edCÚ‹Á
::
R’d”ImageG’”©edCÚ‹Á
(
Node
* 
n
)

36 : 
R’d”Image
(
n
)

39 
R’d”ImageG’”©edCÚ‹Á
::~RenderImageGeneratedContent()

41 
m_ÿchedImage
 = 0;

42 
	gm_¡yËImage
->
»moveCl›Á
(
this
);

45 
	gR’d”ImageG’”©edCÚ‹Á
::
£tStyËImage
(
StyËImage
* 
image
)

47 ià(
image
->
isCachedImage
())

48 
m_ÿchedImage
 = 
¡©ic_ÿ¡
<
StyËCachedImage
*>(
image
)->
ÿchedImage
();

49 
	gm_¡yËImage
 = 
image
;

50 
	gm_¡yËImage
->
addCl›Á
(
this
);

	@RenderImageGeneratedContent.h

26 #iâdeà
R’d”ImageG’”©edCÚ‹Á_h


27 
	#R’d”ImageG’”©edCÚ‹Á_h


	)

29 
	~"R’d”Image.h
"

30 
	~"StyËImage.h
"

31 
	~<wtf/RefPŒ.h
>

33 
Çme¥aû
 
	gWebCÜe
 {

35 
şass
 
	gStyËImage
;

37 şas 
	cR’d”ImageG’”©edCÚ‹Á
 : 
public
 
R’d”Image
 {

38 
public
:

39 
R’d”ImageG’”©edCÚ‹Á
(
Node
*);

40 
	gvœtu®
 ~
R’d”ImageG’”©edCÚ‹Á
();

42 
£tStyËImage
(
StyËImage
*);

44 
vœtu®
 
boŞ
 
hasImage
(ècÚ¡ {  
	gŒue
; }

46 
	g´Ùeùed
:

47 
vœtu®
 
Image
* 
image
(
w
 = 0, 
h
 = 0è{  
m_¡yËImage
->image(
this
, 
IÁSize
(w, h)); }

48 
vœtu®
 
boŞ
 
”rÜOccu¼ed
(ècÚ¡ {  
	gm_¡yËImage
->errorOccurred(); }

49 
vœtu®
 
boŞ
 
u£sImageCÚš”Size
(ècÚ¡ {  
	gm_¡yËImage
->usesImageContainerSize(); }

50 
vœtu®
 
£tImageCÚš”Size
(cÚ¡ 
IÁSize
& 
size
ècÚ¡ { 
	gm_¡yËImage
->setImageContainerSize(size); }

51 
vœtu®
 
boŞ
 
imageHasR–©iveWidth
(ècÚ¡ {  
	gm_¡yËImage
->imageHasRelativeWidth(); }

52 
vœtu®
 
boŞ
 
imageHasR–©iveHeight
(ècÚ¡ {  
	gm_¡yËImage
->imageHasRelativeHeight(); }

53 
vœtu®
 
IÁSize
 
imageSize
(
muÉl›r
ècÚ¡ {  
	gm_¡yËImage
->imageSize(
this
, multiplier); }

56 
vœtu®
 
W¿µedImagePŒ
 
imagePŒ
(ècÚ¡ {  
	gm_¡yËImage
 ? m_¡yËImage->
d©a
() : 0; }

58 
	g´iv©e
:

59 
RefPŒ
<
StyËImage
> 
m_¡yËImage
;

	@RenderInline.cpp

23 
	~"cÚfig.h
"

24 
	~"R’d”IÆše.h
"

26 
	~"Chrome.h
"

27 
	~"FlßtQuad.h
"

28 
	~"G¿phicsCÚ‹xt.h
"

29 
	~"H™Te¡ResuÉ.h
"

30 
	~"Page.h
"

31 
	~"R’d”A»Ç.h
"

32 
	~"R’d”Block.h
"

33 
	~"R’d”V›w.h
"

34 
	~"T¿nsfÜmS‹.h
"

35 
	~"VisibËPos™iÚ.h
"

37 #ià
ENABLE
(
DASHBOARD_SUPPORT
)

38 
	~"F¿me.h
"

41 
usšg
 
Çme¥aû
 
	g¡d
;

43 
Çme¥aû
 
	gWebCÜe
 {

45 
	gR’d”IÆše
::
R’d”IÆše
(
Node
* 
node
)

46 : 
R’d”BoxMod–Objeù
(
node
)

47 , 
m_cÚtšu©iÚ
(0)

48 , 
m_lšeHeight
(-1)

49 , 
m_v”tiÿlPos™iÚ
(
Pos™iÚUndefšed
)

51 
£tChd»nIÆše
(
Œue
);

54 
	gR’d”IÆše
::
de¡roy
()

58 
chd»n
()->
de¡royLeáov”Chd»n
();

63 ià(
	gm_cÚtšu©iÚ
) {

64 
	gm_cÚtšu©iÚ
->
de¡roy
();

65 
	gm_cÚtšu©iÚ
 = 0;

68 ià(!
docum’tBešgDe¡royed
()) {

69 ià(
fœ¡LšeBox
()) {

74 ià(
isS–eùiÚBÜd”
())

75 
v›w
()->
ş—rS–eùiÚ
();

82 ià(
fœ¡LšeBox
()->
·»Á
()) {

83 
IÆšeFlowBox
* 
	gbox
 = 
fœ¡LšeBox
(); box; box = 
box
->
ÃxtLšeBox
())

84 
box
->
»move
();

86 } ià(
isIÆše
(è&& 
·»Á
())

87 
·»Á
()->
dœtyLšesFromChªgedChd
(
this
);

90 
	gm_lšeBoxes
.
d–‘eLšeBoxes
(
»nd”A»Ç
());

92 
	gR’d”BoxMod–Objeù
::
de¡roy
();

95 
R’d”IÆše
* 
	gR’d”IÆše
::
šlšeCÚtšu©iÚ
() const

97 ià(!
m_cÚtšu©iÚ
 || m_cÚtšu©iÚ->
isIÆše
())

98  
toR’d”IÆše
(
m_cÚtšu©iÚ
);

99  
toR’d”Block
(
m_cÚtšu©iÚ
)->
šlšeCÚtšu©iÚ
();

102 
	gR’d”IÆše
::
upd©eBoxMod–InfoFromStyË
()

104 
R’d”BoxMod–Objeù
::
upd©eBoxMod–InfoFromStyË
();

106 
£tIÆše
(
Œue
);

109 
£tHasT¿nsfÜm
(
çl£
);

110 
£tHasReæeùiÚ
(
çl£
);

113 
	gR’d”IÆše
::
¡yËDidChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
)

115 
	gR’d”BoxMod–Objeù
::
¡yËDidChªge
(
diff
, 
ŞdStyË
);

123 
R’d”IÆše
* 
	gcu¼CÚt
 = 
šlšeCÚtšu©iÚ
(); cu¼CÚt; cu¼CÚˆğ
cu¼CÚt
->inlineContinuation()) {

124 
R’d”BoxMod–Objeù
* 
ÃxtCÚt
 = 
cu¼CÚt
->
cÚtšu©iÚ
();

125 
	gcu¼CÚt
->
£tCÚtšu©iÚ
(0);

126 
	gcu¼CÚt
->
£tStyË
(
¡yË
());

127 
	gcu¼CÚt
->
£tCÚtšu©iÚ
(
ÃxtCÚt
);

130 
	gm_lšeHeight
 = -1;

133 ià(!
isAnÚymous
(è&& 
docum’t
()->
u£sBefÜeAá”RuËs
()) {

134 
chd»n
()->
upd©eBefÜeAá”CÚ‹Á
(
this
, 
BEFORE
);

135 
chd»n
()->
upd©eBefÜeAá”CÚ‹Á
(
this
, 
AFTER
);

139 
	gR’d”IÆše
::
addChd
(
R’d”Objeù
* 
ÃwChd
, R’d”Objeù* 
befÜeChd
)

141 ià(
cÚtšu©iÚ
())

142  
addChdToCÚtšu©iÚ
(
ÃwChd
, 
befÜeChd
);

143  
addChdIgnÜšgCÚtšu©iÚ
(
ÃwChd
, 
befÜeChd
);

146 
R’d”BoxMod–Objeù
* 
ÃxtCÚtšu©iÚ
(
R’d”Objeù
* 
»nd””
)

148 ià(
	g»nd””
->
isIÆše
(è&& !»nd””->
isR•Ïûd
())

149  
toR’d”IÆše
(
»nd””
)->
cÚtšu©iÚ
();

150  
toR’d”Block
(
»nd””
)->
šlšeCÚtšu©iÚ
();

153 
R’d”BoxMod–Objeù
* 
	gR’d”IÆše
::
cÚtšu©iÚBefÜe
(
R’d”Objeù
* 
befÜeChd
)

155 ià(
befÜeChd
 && befÜeChd->
·»Á
(è=ğ
this
)

156  
this
;

158 
R’d”BoxMod–Objeù
* 
	gcu¼
 = 
ÃxtCÚtšu©iÚ
(
this
);

159 
R’d”BoxMod–Objeù
* 
	gÃxtToLa¡
 = 
this
;

160 
R’d”BoxMod–Objeù
* 
	gÏ¡
 = 
this
;

161 
	gcu¼
) {

162 ià(
	gbefÜeChd
 && befÜeChd->
·»Á
(è=ğ
cu¼
) {

163 ià(
cu¼
->
fœ¡Chd
(è=ğ
befÜeChd
)

164  
Ï¡
;

165  
	gcu¼
;

168 
	gÃxtToLa¡
 = 
Ï¡
;

169 
	gÏ¡
 = 
cu¼
;

170 
	gcu¼
 = 
ÃxtCÚtšu©iÚ
(
cu¼
);

173 ià(!
	gbefÜeChd
 && !
	gÏ¡
->
fœ¡Chd
())

174  
	gÃxtToLa¡
;

175  
	gÏ¡
;

178 
	gR’d”IÆše
::
addChdIgnÜšgCÚtšu©iÚ
(
R’d”Objeù
* 
ÃwChd
, R’d”Objeù* 
befÜeChd
)

181 ià(!
	gbefÜeChd
 && 
isAá”CÚ‹Á
(
Ï¡Chd
()))

182 
	gbefÜeChd
 = 
Ï¡Chd
();

184 ià(!
	gÃwChd
->
isIÆše
(è&& !ÃwChd->
isFlßtšgOrPos™iÚed
()) {

189 
	gRefPŒ
<
	gR’d”StyË
> 
	gÃwStyË
 = 
R’d”StyË
::
ü—‹
();

190 
	gÃwStyË
->
šh”™From
(
¡yË
());

191 
	gÃwStyË
->
£tDi¥Ïy
(
BLOCK
);

193 
R’d”Block
* 
	gÃwBox
 = 
Ãw
 (
»nd”A»Ç
()èR’d”Block(
docum’t
() );

194 
	gÃwBox
->
£tStyË
(
ÃwStyË
.
»Ëa£
());

195 
R’d”BoxMod–Objeù
* 
	gŞdCÚtšu©iÚ
 = 
cÚtšu©iÚ
();

196 
£tCÚtšu©iÚ
(
ÃwBox
);

201 
boŞ
 
	gisLa¡Chd
 = (
befÜeChd
 =ğ
Ï¡Chd
());

202 ià(
docum’t
()->
u£sBefÜeAá”RuËs
())

203 
chd»n
()->
upd©eBefÜeAá”CÚ‹Á
(
this
, 
AFTER
);

204 ià(
	gisLa¡Chd
 && 
	gbefÜeChd
 !ğ
Ï¡Chd
())

205 
befÜeChd
 = 0;

208 
¥l™Flow
(
befÜeChd
, 
ÃwBox
, 
ÃwChd
, 
ŞdCÚtšu©iÚ
);

212 
	gR’d”BoxMod–Objeù
::
addChd
(
ÃwChd
, 
befÜeChd
);

214 
	gÃwChd
->
£tN“dsLayoutAndP»fWidthsReÿlc
();

217 
R’d”IÆše
* 
	gR’d”IÆše
::
şÚeIÆše
(R’d”IÆše* 
¤c
)

219 
R’d”IÆše
* 
o
 = 
Ãw
 (
¤c
->
»nd”A»Ç
()èR’d”IÆše(¤c->
node
());

220 
	go
->
£tStyË
(
¤c
->
¡yË
());

221  
	go
;

224 
	gR’d”IÆše
::
¥l™IÆšes
(
R’d”Block
* 
äomBlock
, R’d”Block* 
toBlock
,

225 
R’d”Block
* 
middËBlock
,

226 
R’d”Objeù
* 
befÜeChd
, 
R’d”BoxMod–Objeù
* 
ŞdCÚt
)

229 
R’d”IÆše
* 
	gşÚe
 = 
şÚeIÆše
(
this
);

230 
	gşÚe
->
£tCÚtšu©iÚ
(
ŞdCÚt
);

234 
R’d”Objeù
* 
	go
 = 
befÜeChd
;

235 
	go
) {

236 
R’d”Objeù
* 
	gtmp
 = 
o
;

237 
	go
 = 
tmp
->
ÃxtSiblšg
();

238 
	gşÚe
->
addChdIgnÜšgCÚtšu©iÚ
(
chd»n
()->
»moveChdNode
(
this
, 
tmp
), 0);

239 
	gtmp
->
£tN“dsLayoutAndP»fWidthsReÿlc
();

243 
	gmiddËBlock
->
£tIÆšeCÚtšu©iÚ
(
şÚe
);

248 
R’d”BoxMod–Objeù
* 
	gcu¼
 = 
toR’d”BoxMod–Objeù
(
·»Á
());

249 
R’d”BoxMod–Objeù
* 
	gcu¼Chd
 = 
this
;

255 
	g¥l™D•th
 = 1;

256 cÚ¡ 
	gcMaxS¶™D•th
 = 200;

257 
	gcu¼
 && cu¼ !ğ
äomBlock
) {

258 
ASSERT
(
cu¼
->
isR’d”IÆše
());

259 ià(
	g¥l™D•th
 < 
	gcMaxS¶™D•th
) {

261 
R’d”IÆše
* 
	gşÚeChd
 = 
şÚe
;

262 
	gşÚe
 = 
şÚeIÆše
(
toR’d”IÆše
(
cu¼
));

265 
	gşÚe
->
addChdIgnÜšgCÚtšu©iÚ
(
şÚeChd
, 0);

268 
R’d”IÆše
* 
	gšlšeCu¼
 = 
toR’d”IÆše
(
cu¼
);

269 
	gŞdCÚt
 = 
šlšeCu¼
->
cÚtšu©iÚ
();

270 
	gšlšeCu¼
->
£tCÚtšu©iÚ
(
şÚe
);

271 
	gşÚe
->
£tCÚtšu©iÚ
(
ŞdCÚt
);

276 ià(
docum’t
()->
u£sBefÜeAá”RuËs
())

277 
	gšlšeCu¼
->
chd»n
()->
upd©eBefÜeAá”CÚ‹Á
(
this
, 
AFTER
);

281 
	go
 = 
cu¼Chd
->
ÃxtSiblšg
();

282 
	go
) {

283 
R’d”Objeù
* 
	gtmp
 = 
o
;

284 
	go
 = 
tmp
->
ÃxtSiblšg
();

285 
	gşÚe
->
addChdIgnÜšgCÚtšu©iÚ
(
šlšeCu¼
->
chd»n
()->
»moveChdNode
(
cu¼
, 
tmp
), 0);

286 
	gtmp
->
£tN“dsLayoutAndP»fWidthsReÿlc
();

291 
	gcu¼Chd
 = 
cu¼
;

292 
	gcu¼
 = 
toR’d”BoxMod–Objeù
(
cu¼
->
·»Á
());

293 
	g¥l™D•th
++;

297 
	gtoBlock
->
chd»n
()->
­³ndChdNode
(
toBlock
, 
şÚe
);

301 
	go
 = 
cu¼Chd
->
ÃxtSiblšg
();

302 
	go
) {

303 
R’d”Objeù
* 
	gtmp
 = 
o
;

304 
	go
 = 
tmp
->
ÃxtSiblšg
();

305 
	gtoBlock
->
chd»n
()->
­³ndChdNode
(
toBlock
, 
äomBlock
->chd»n()->
»moveChdNode
(äomBlock, 
tmp
));

309 
	gR’d”IÆše
::
¥l™Flow
(
R’d”Objeù
* 
befÜeChd
, 
R’d”Block
* 
ÃwBlockBox
,

310 
R’d”Objeù
* 
ÃwChd
, 
R’d”BoxMod–Objeù
* 
ŞdCÚt
)

312 
R’d”Block
* 
	g´e
 = 0;

313 
R’d”Block
* 
	gblock
 = 
cÚššgBlock
();

316 
	gblock
->
d–‘eLšeBoxT»e
();

318 
boŞ
 
	gmadeNewBefÜeBlock
 = 
çl£
;

319 ià(
	gblock
->
isAnÚymousBlock
(è&& (!block->
·»Á
(è|| !block->·»Á()->
ü—‹sAnÚymousW¿µ”
())) {

321 
	g´e
 = 
block
;

322 
	g´e
->
»movePos™iÚedObjeùs
(0);

323 
	gblock
 = 
block
->
cÚššgBlock
();

326 
	g´e
 = 
block
->
ü—‹AnÚymousBlock
();

327 
	gmadeNewBefÜeBlock
 = 
Œue
;

330 
R’d”Block
* 
	gpo¡
 = 
block
->
ü—‹AnÚymousBlock
();

332 
R’d”Objeù
* 
	gboxFœ¡
 = 
madeNewBefÜeBlock
 ? 
block
->
fœ¡Chd
(è: 
´e
->
ÃxtSiblšg
();

333 ià(
	gmadeNewBefÜeBlock
)

334 
	gblock
->
chd»n
()->
š£¹ChdNode
(
block
, 
´e
, 
boxFœ¡
);

335 
	gblock
->
chd»n
()->
š£¹ChdNode
(
block
, 
ÃwBlockBox
, 
boxFœ¡
);

336 
	gblock
->
chd»n
()->
š£¹ChdNode
(
block
, 
po¡
, 
boxFœ¡
);

337 
	gblock
->
£tChd»nIÆše
(
çl£
);

339 ià(
	gmadeNewBefÜeBlock
) {

340 
R’d”Objeù
* 
	go
 = 
boxFœ¡
;

341 
	go
) {

342 
R’d”Objeù
* 
	gno
 = 
o
;

343 
	go
 = 
no
->
ÃxtSiblšg
();

344 
	g´e
->
chd»n
()->
­³ndChdNode
(
´e
, 
block
->chd»n()->
»moveChdNode
(block, 
no
));

345 
	gno
->
£tN“dsLayoutAndP»fWidthsReÿlc
();

349 
¥l™IÆšes
(
´e
, 
po¡
, 
ÃwBlockBox
, 
befÜeChd
, 
ŞdCÚt
);

353 
	gÃwBlockBox
->
£tChd»nIÆše
(
çl£
);

358 
	gÃwBlockBox
->
addChd
(
ÃwChd
);

363 
	g´e
->
£tN“dsLayoutAndP»fWidthsReÿlc
();

364 
	gblock
->
£tN“dsLayoutAndP»fWidthsReÿlc
();

365 
	gpo¡
->
£tN“dsLayoutAndP»fWidthsReÿlc
();

368 
	gR’d”IÆše
::
addChdToCÚtšu©iÚ
(
R’d”Objeù
* 
ÃwChd
, R’d”Objeù* 
befÜeChd
)

370 
R’d”BoxMod–Objeù
* 
	gæow
 = 
cÚtšu©iÚBefÜe
(
befÜeChd
);

371 
ASSERT
(!
befÜeChd
 || befÜeChd->
·»Á
()->
isR’d”Block
(è|| befÜeChd->·»Á()->
isR’d”IÆše
());

372 
R’d”BoxMod–Objeù
* 
	gbefÜeChdP¬’t
 = 0;

373 ià(
	gbefÜeChd
)

374 
	gbefÜeChdP¬’t
 = 
toR’d”BoxMod–Objeù
(
befÜeChd
->
·»Á
());

376 
R’d”BoxMod–Objeù
* 
	gcÚt
 = 
ÃxtCÚtšu©iÚ
(
æow
);

377 ià(
	gcÚt
)

378 
	gbefÜeChdP¬’t
 = 
cÚt
;

380 
	gbefÜeChdP¬’t
 = 
æow
;

383 ià(
	gÃwChd
->
isFlßtšgOrPos™iÚed
())

384  
	gbefÜeChdP¬’t
->
addChdIgnÜšgCÚtšu©iÚ
(
ÃwChd
, 
befÜeChd
);

388 
boŞ
 
	gchdIÆše
 = 
ÃwChd
->
isIÆše
();

389 
boŞ
 
	gbıIÆše
 = 
befÜeChdP¬’t
->
isIÆše
();

390 
boŞ
 
	gæowIÆše
 = 
æow
->
isIÆše
();

392 ià(
	gæow
 =ğ
befÜeChdP¬’t
)

393  
æow
->
addChdIgnÜšgCÚtšu©iÚ
(
ÃwChd
, 
befÜeChd
);

397 ià(
	gchdIÆše
 =ğ
bıIÆše
)

398  
befÜeChdP¬’t
->
addChdIgnÜšgCÚtšu©iÚ
(
ÃwChd
, 
befÜeChd
);

399 ià(
	gæowIÆše
 =ğ
chdIÆše
)

400  
æow
->
addChdIgnÜšgCÚtšu©iÚ
(
ÃwChd
, 0);

402  
	gbefÜeChdP¬’t
->
addChdIgnÜšgCÚtšu©iÚ
(
ÃwChd
, 
befÜeChd
);

406 
	gR’d”IÆše
::
·št
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

408 
	gm_lšeBoxes
.
·št
(
this
, 
·štInfo
, 
tx
, 
ty
);

411 
	gR’d”IÆše
::
absŞu‹Reùs
(
VeùÜ
<
IÁReù
>& 
»ùs
, 
tx
, 
ty
)

413 ià(
IÆšeFlowBox
* 
	gcu¼
 = 
fœ¡LšeBox
()) {

414 ; 
	gcu¼
; cu¼ = 
cu¼
->
ÃxtLšeBox
())

415 
»ùs
.
­³nd
(
IÁReù
(
tx
 + 
cu¼
->
x
(), 
ty
 + cu¼->
y
(), cu¼->
width
(), cu¼->
height
()));

417 
	g»ùs
.
­³nd
(
IÁReù
(
tx
, 
ty
, 0, 0));

419 ià(
cÚtšu©iÚ
()) {

420 ià(
cÚtšu©iÚ
()->
isBox
()) {

421 
R’d”Box
* 
	gbox
 = 
toR’d”Box
(
cÚtšu©iÚ
());

422 
cÚtšu©iÚ
()->
absŞu‹Reùs
(
»ùs
,

423 
tx
 - 
cÚššgBlock
()->
x
(è+ 
box
->x(),

424 
ty
 - 
cÚššgBlock
()->
y
(è+ 
box
->y());

426 
cÚtšu©iÚ
()->
absŞu‹Reùs
(
»ùs
, 
tx
 - 
cÚššgBlock
()->
x
(), 
ty
 - cÚššgBlock()->
y
());

430 
	gR’d”IÆše
::
absŞu‹Quads
(
VeùÜ
<
FlßtQuad
>& 
quads
)

432 ià(
IÆšeFlowBox
* 
cu¼
 = 
fœ¡LšeBox
()) {

433 ; 
	gcu¼
; cu¼ = 
cu¼
->
ÃxtLšeBox
()) {

434 
FlßtReù
 
loÿlReù
(
cu¼
->
x
(), cu¼->
y
(), cu¼->
width
(), cu¼->
height
());

435 
	gquads
.
­³nd
(
loÿlToAbsŞu‹Quad
(
loÿlReù
));

438 
	gquads
.
­³nd
(
loÿlToAbsŞu‹Quad
(
FlßtReù
()));

440 ià(
cÚtšu©iÚ
())

441 
cÚtšu©iÚ
()->
absŞu‹Quads
(
quads
);

444 
	gR’d”IÆše
::
off£tLeá
() const

446 
x
 = 
R’d”BoxMod–Objeù
::
off£tLeá
();

447 ià(
fœ¡LšeBox
())

448 
	gx
 +ğ
fœ¡LšeBox
()->
x
();

449  
	gx
;

452 
	gR’d”IÆše
::
off£tTİ
() const

454 
y
 = 
R’d”BoxMod–Objeù
::
off£tTİ
();

455 ià(
fœ¡LšeBox
())

456 
	gy
 +ğ
fœ¡LšeBox
()->
y
();

457  
	gy
;

460 
	gR’d”IÆše
::
m¬gšLeá
() const

462 
L’gth
 
m¬gš
 = 
¡yË
()->
m¬gšLeá
();

463 ià(
	gm¬gš
.
isAuto
())

465 ià(
	gm¬gš
.
isFixed
())

466  
	gm¬gš
.
v®ue
();

467 ià(
	gm¬gš
.
isP”ûÁ
())

468  
	gm¬gš
.
ÿlcMšV®ue
(
max
(0, 
cÚššgBlock
()->
avaabËWidth
()));

472 
	gR’d”IÆše
::
m¬gšRight
() const

474 
L’gth
 
m¬gš
 = 
¡yË
()->
m¬gšRight
();

475 ià(
	gm¬gš
.
isAuto
())

477 ià(
	gm¬gš
.
isFixed
())

478  
	gm¬gš
.
v®ue
();

479 ià(
	gm¬gš
.
isP”ûÁ
())

480  
	gm¬gš
.
ÿlcMšV®ue
(
max
(0, 
cÚššgBlock
()->
avaabËWidth
()));

484 cÚ¡ * 
	gR’d”IÆše
::
»nd”Name
() const

486 ià(
isR–Pos™iÚed
())

488 ià(
isAnÚymous
())

490 ià(
isRunIn
())

495 
boŞ
 
	gR’d”IÆše
::
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
& 
»que¡
, 
H™Te¡ResuÉ
& 
»suÉ
,

496 
x
, 
y
, 
tx
, 
ty
, 
H™Te¡AùiÚ
 
h™Te¡AùiÚ
)

498  
	gm_lšeBoxes
.
h™Te¡
(
this
, 
»que¡
, 
»suÉ
, 
x
, 
y
, 
tx
, 
ty
, 
h™Te¡AùiÚ
);

501 
VisibËPos™iÚ
 
	gR’d”IÆše
::
pos™iÚFÜPošt
(cÚ¡ 
IÁPošt
& 
pošt
)

504 
R’d”Block
* 
cb
 = 
cÚššgBlock
();

505 ià(
fœ¡LšeBox
()) {

508  
	gcb
->
pos™iÚFÜPošt
(
pošt
);

512 
	g·»ÁBlockX
 = 
cb
->
x
(è+ 
pošt
.x();

513 
	g·»ÁBlockY
 = 
cb
->
y
(è+ 
pošt
.y();

514 
R’d”BoxMod–Objeù
* 
	gc
 = 
cÚtšu©iÚ
();

515 
	gc
) {

516 
R’d”Box
* 
	gcÚtBlock
 = 
c
->
isIÆše
(è? c->
cÚššgBlock
(è: 
toR’d”Block
(c);

517 ià(
	gc
->
isIÆše
(è|| c->
fœ¡Chd
())

518  
	gc
->
pos™iÚFÜCoÜdš©es
(
·»ÁBlockX
 - 
cÚtBlock
->
x
(), 
·»ÁBlockY
 - cÚtBlock->
y
());

519 
	gc
 = 
toR’d”Block
(
c
)->
šlšeCÚtšu©iÚ
();

522  
	gR’d”BoxMod–Objeù
::
pos™iÚFÜPošt
(
pošt
);

525 
IÁReù
 
	gR’d”IÆše
::
lšesBoundšgBox
() const

527 
IÁReù
 
»suÉ
;

532 
ASSERT
(!
fœ¡LšeBox
(è=ğ!
Ï¡LšeBox
());

533 ià(
fœ¡LšeBox
(è&& 
Ï¡LšeBox
()) {

535 
	gËáSide
 = 0;

536 
	grightSide
 = 0;

537 
IÆšeFlowBox
* 
	gcu¼
 = 
fœ¡LšeBox
(); cu¼; cu¼ = 
cu¼
->
ÃxtLšeBox
()) {

538 ià(
cu¼
 =ğ
fœ¡LšeBox
(è|| cu¼->
x
(è< 
ËáSide
)

539 
ËáSide
 = 
cu¼
->
x
();

540 ià(
	gcu¼
 =ğ
fœ¡LšeBox
(è|| 
cu¼
->
x
(è+ cu¼->
width
(è> 
rightSide
)

541 
rightSide
 = 
cu¼
->
x
(è+ cu¼->
width
();

543 
	g»suÉ
.
£tWidth
(
rightSide
 - 
ËáSide
);

544 
	g»suÉ
.
£tX
(
ËáSide
);

545 
	g»suÉ
.
£tHeight
(
Ï¡LšeBox
()->
y
(è+†a¡LšeBox()->
height
(è- 
fœ¡LšeBox
()->y());

546 
	g»suÉ
.
£tY
(
fœ¡LšeBox
()->
y
());

549  
	g»suÉ
;

552 
IÁReù
 
	gR’d”IÆše
::
lšesVisibËOv”æowBoundšgBox
() const

554 ià(!
fœ¡LšeBox
(è|| !
Ï¡LšeBox
())

555  
IÁReù
();

558 
	gËáSide
 = 
num”ic_lim™s
<>::
max
();

559 
	grightSide
 = 
num”ic_lim™s
<>::
mš
();

560 
IÆšeFlowBox
* 
	gcu¼
 = 
fœ¡LšeBox
(); cu¼; cu¼ = 
cu¼
->
ÃxtLšeBox
()) {

561 
ËáSide
 = 
mš
ÖeáSide, 
cu¼
->
ËáVisibËOv”æow
());

562 
	grightSide
 = 
max
(
rightSide
, 
cu¼
->
rightVisibËOv”æow
());

565  
IÁReù
(
ËáSide
, 
fœ¡LšeBox
()->
tİVisibËOv”æow
(), 
rightSide
 -†eftSide,

566 
Ï¡LšeBox
()->
bÙtomVisibËOv”æow
(è- 
fœ¡LšeBox
()->
tİVisibËOv”æow
());

569 
IÁReù
 
	gR’d”IÆše
::
ş³dOv”æowReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
)

572 
ASSERT
(!
v›w
(è|| !v›w()->
ÏyoutS‹EÇbËd
(è|| 
isRunIn
());

574 ià(!
fœ¡LšeBox
(è&& !
cÚtšu©iÚ
())

575  
IÁReù
();

578 
IÁReù
 
boundšgBox
(
lšesVisibËOv”æowBoundšgBox
());

579 
	gËá
 = 
boundšgBox
.
x
();

580 
	gtİ
 = 
boundšgBox
.
y
();

583 
	gow
 = 
¡yË
(è? styË()->
oušeSize
() : 0;

587 
R’d”Block
* 
	gcb
 = 
cÚššgBlock
();

588 
R’d”Objeù
* 
	gšlšeFlow
 = 
this
; iÆšeFlow && iÆšeFlow->
isR’d”IÆše
(è&& iÆšeFlow !ğ
cb
;

589 
	gšlšeFlow
 = 
šlšeFlow
->
·»Á
()) {

590 ià(
šlšeFlow
->
¡yË
()->
pos™iÚ
(è=ğ
R–©ivePos™iÚ
 && iÆšeFlow->
hasLay”
())

591 
toR’d”IÆše
(
šlšeFlow
)->
Ïy”
()->
»ÏtivePos™iÚOff£t
(
Ëá
, 
tİ
);

594 
IÁReù
 
r
(-
ow
 + 
Ëá
, -ow + 
tİ
, 
boundšgBox
.
width
(è+ ow * 2, boundšgBox.
height
() + ow * 2);

595 ià(
	gcb
->
hasCŞumns
())

596 
	gcb
->
adju¡ReùFÜCŞumns
(
r
);

598 ià(
	gcb
->
hasOv”æowCl
()) {

602 
IÁReù
 
»·štReù
(
r
);

603 
	g»·štReù
.
move
(-
cb
->
Ïy”
()->
süŞËdCÚ‹ÁOff£t
());

605 
IÁReù
 
boxReù
(0, 0, 
cb
->
Ïy”
()->
width
(), cb->Ïy”()->
height
());

606 
	gr
 = 
š‹r£ùiÚ
(
»·štReù
, 
boxReù
);

611 ià(
	g»·štCÚš”
 !ğ
this
)

612 
cb
->
compu‹ReùFÜR•ašt
(
»·štCÚš”
, 
r
);

614 ià(
	gow
) {

615 
R’d”Objeù
* 
	gcu¼
 = 
fœ¡Chd
(); cu¼; cu¼ = 
cu¼
->
ÃxtSiblšg
()) {

616 ià(!
cu¼
->
isText
()) {

617 
IÁReù
 
chdReù
 = 
cu¼
->
»ùW™hOušeFÜR•ašt
(
»·štCÚš”
, 
ow
);

618 
	gr
.
un™e
(
chdReù
);

622 ià(
cÚtšu©iÚ
(è&& !cÚtšu©iÚ()->
isIÆše
()) {

623 
IÁReù
 
	gcÚtReù
 = 
cÚtšu©iÚ
()->
»ùW™hOušeFÜR•ašt
(
»·štCÚš”
, 
ow
);

624 
	gr
.
un™e
(
cÚtReù
);

628  
	gr
;

631 
IÁReù
 
	gR’d”IÆše
::
»ùW™hOušeFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
oušeWidth
)

633 
IÁReù
 
r
(
R’d”BoxMod–Objeù
::
»ùW™hOušeFÜR•ašt
(
»·štCÚš”
, 
oušeWidth
));

634 
R’d”Objeù
* 
	gcu¼
 = 
fœ¡Chd
(); cu¼; cu¼ = 
cu¼
->
ÃxtSiblšg
()) {

635 ià(!
cu¼
->
isText
())

636 
r
.
un™e
(
cu¼
->
»ùW™hOušeFÜR•ašt
(
»·štCÚš”
, 
oušeWidth
));

638  
	gr
;

641 
	gR’d”IÆše
::
compu‹ReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
IÁReù
& 
»ù
, 
boŞ
 
fixed
)

643 ià(
R’d”V›w
* 
	gv
 = 
v›w
()) {

645 ià(
v
->
ÏyoutS‹EÇbËd
(è&& !
»·štCÚš”
) {

646 
LayoutS‹
* 
ÏyoutS‹
 = 
v
->layoutState();

647 ià(
¡yË
()->
pos™iÚ
(è=ğ
R–©ivePos™iÚ
 && 
Ïy”
())

648 
»ù
.
move
(
Ïy”
()->
»ÏtivePos™iÚOff£t
());

649 
	g»ù
.
move
(
ÏyoutS‹
->
m_off£t
);

650 ià(
	gÏyoutS‹
->
	gm_ş³d
)

651 
	g»ù
.
š‹r£ù
(
ÏyoutS‹
->
m_şReù
);

656 ià(
	g»·štCÚš”
 =ğ
this
)

659 
boŞ
 
	gcÚš”Sk³d
;

660 
R’d”Objeù
* 
	go
 = 
cÚš”
(
»·štCÚš”
, &
cÚš”Sk³d
);

661 ià(!
	go
)

664 
IÁPošt
 
	gtİLeá
 = 
»ù
.
loÿtiÚ
();

666 ià(
	go
->
isBlockFlow
(è&& 
¡yË
()->
pos™iÚ
(è!ğ
AbsŞu‹Pos™iÚ
 && styË()->pos™iÚ(è!ğ
FixedPos™iÚ
) {

667 
R’d”Block
* 
cb
 = 
toR’d”Block
(
o
);

668 ià(
	gcb
->
hasCŞumns
()) {

669 
IÁReù
 
»·štReù
(
tİLeá
, 
»ù
.
size
());

670 
	gcb
->
adju¡ReùFÜCŞumns
(
»·štReù
);

671 
	gtİLeá
 = 
»·štReù
.
loÿtiÚ
();

672 
	g»ù
 = 
»·štReù
;

676 ià(
¡yË
()->
pos™iÚ
(è=ğ
R–©ivePos™iÚ
 && 
Ïy”
()) {

681 
tİLeá
 +ğ
Ïy”
()->
»ÏtivePos™iÚOff£t
();

686 ià(
	go
->
hasOv”æowCl
()) {

687 
R’d”Box
* 
	gcÚš”Box
 = 
toR’d”Box
(
o
);

692 
	gtİLeá
 -ğ
cÚš”Box
->
Ïy”
()->
süŞËdCÚ‹ÁOff£t
();

694 
IÁReù
 
»·štReù
(
tİLeá
, 
»ù
.
size
());

695 
IÁReù
 
boxReù
(0, 0, 
cÚš”Box
->
Ïy”
()->
width
(), cÚš”Box->Ïy”()->
height
());

696 
	g»ù
 = 
š‹r£ùiÚ
(
»·štReù
, 
boxReù
);

697 ià(
	g»ù
.
isEm±y
())

700 
	g»ù
.
£tLoÿtiÚ
(
tİLeá
);

702 ià(
	gcÚš”Sk³d
) {

704 
IÁSize
 
	gcÚš”Off£t
 = 
»·štCÚš”
->
off£tFromAnû¡ÜCÚš”
(
o
);

705 
	g»ù
.
move
(-
cÚš”Off£t
);

709 
	go
->
compu‹ReùFÜR•ašt
(
»·štCÚš”
, 
»ù
, 
fixed
);

712 
IÁSize
 
	gR’d”IÆše
::
off£tFromCÚš”
(
R’d”Objeù
* 
cÚš”
, cÚ¡ 
IÁPošt
& 
pošt
) const

714 
ASSERT
(
cÚš”
 =ğ
this
->container());

716 
IÁSize
 
	goff£t
;

717 ià(
isR–Pos™iÚed
())

718 
	goff£t
 +ğ
»ÏtivePos™iÚOff£t
();

720 
	gcÚš”
->
adju¡FÜCŞumns
(
off£t
, 
pošt
);

722 ià(
	gcÚš”
->
hasOv”æowCl
())

723 
	goff£t
 -ğ
toR’d”Box
(
cÚš”
)->
Ïy”
()->
süŞËdCÚ‹ÁOff£t
();

725  
	goff£t
;

728 
	gR’d”IÆše
::
m­LoÿlToCÚš”
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
boŞ
 
fixed
, boŞ 
u£T¿nsfÜms
, 
T¿nsfÜmS‹
& 
ŒªsfÜmS‹
) const

730 ià(
	g»·štCÚš”
 =ğ
this
)

733 ià(
R’d”V›w
 *
	gv
 = 
v›w
()) {

734 ià(
v
->
ÏyoutS‹EÇbËd
(è&& !
»·štCÚš”
) {

735 
LayoutS‹
* 
ÏyoutS‹
 = 
v
->layoutState();

736 
IÁSize
 
	goff£t
 = 
ÏyoutS‹
->
m_off£t
;

737 ià(
¡yË
()->
pos™iÚ
(è=ğ
R–©ivePos™iÚ
 && 
Ïy”
())

738 
off£t
 +ğ
Ïy”
()->
»ÏtivePos™iÚOff£t
();

739 
	gŒªsfÜmS‹
.
move
(
off£t
);

744 
boŞ
 
	gcÚš”Sk³d
;

745 
R’d”Objeù
* 
	go
 = 
cÚš”
(
»·štCÚš”
, &
cÚš”Sk³d
);

746 ià(!
	go
)

749 
IÁSize
 
	gcÚš”Off£t
 = 
off£tFromCÚš”
(
o
, 
roundedIÁPošt
(
ŒªsfÜmS‹
.
m­³dPošt
()));

751 
boŞ
 
	g´e£rve3D
 = 
u£T¿nsfÜms
 && (
o
->
¡yË
()->
´e£rves3D
() || style()->preserves3D());

752 ià(
	gu£T¿nsfÜms
 && 
shouldU£T¿nsfÜmFromCÚš”
(
o
)) {

753 
T¿nsfÜm©iÚM©rix
 
	gt
;

754 
g‘T¿nsfÜmFromCÚš”
(
o
, 
cÚš”Off£t
, 
t
);

755 
	gŒªsfÜmS‹
.
­¶yT¿nsfÜm
(
t
, 
´e£rve3D
 ? 
T¿nsfÜmS‹
::
AccumuÏ‹T¿nsfÜm
 : T¿nsfÜmS‹::
FÏ‰’T¿nsfÜm
);

757 
	gŒªsfÜmS‹
.
move
(
cÚš”Off£t
.
width
(), cÚš”Off£t.
height
(), 
´e£rve3D
 ? 
T¿nsfÜmS‹
::
AccumuÏ‹T¿nsfÜm
 : T¿nsfÜmS‹::
FÏ‰’T¿nsfÜm
);

759 ià(
	gcÚš”Sk³d
) {

762 
IÁSize
 
	gcÚš”Off£t
 = 
»·štCÚš”
->
off£tFromAnû¡ÜCÚš”
(
o
);

763 
	gŒªsfÜmS‹
.
move
(-
cÚš”Off£t
.
width
(), -cÚš”Off£t.
height
(), 
´e£rve3D
 ? 
T¿nsfÜmS‹
::
AccumuÏ‹T¿nsfÜm
 : T¿nsfÜmS‹::
FÏ‰’T¿nsfÜm
);

767 
	go
->
m­LoÿlToCÚš”
(
»·štCÚš”
, 
fixed
, 
u£T¿nsfÜms
, 
ŒªsfÜmS‹
);

770 
	gR’d”IÆše
::
m­AbsŞu‹ToLoÿlPošt
(
boŞ
 
fixed
, boŞ 
u£T¿nsfÜms
, 
T¿nsfÜmS‹
& 
ŒªsfÜmS‹
) const

773 
ASSERT
(!
v›w
(è|| !v›w()->
ÏyoutS‹EÇbËd
());

775 
R’d”Objeù
* 
	go
 = 
cÚš”
();

776 ià(!
	go
)

779 
	go
->
m­AbsŞu‹ToLoÿlPošt
(
fixed
, 
u£T¿nsfÜms
, 
ŒªsfÜmS‹
);

781 
IÁSize
 
	gcÚš”Off£t
 = 
off£tFromCÚš”
(
o
, 
IÁPošt
());

783 
boŞ
 
	g´e£rve3D
 = 
u£T¿nsfÜms
 && (
o
->
¡yË
()->
´e£rves3D
() || style()->preserves3D());

784 ià(
	gu£T¿nsfÜms
 && 
shouldU£T¿nsfÜmFromCÚš”
(
o
)) {

785 
T¿nsfÜm©iÚM©rix
 
	gt
;

786 
g‘T¿nsfÜmFromCÚš”
(
o
, 
cÚš”Off£t
, 
t
);

787 
	gŒªsfÜmS‹
.
­¶yT¿nsfÜm
(
t
, 
´e£rve3D
 ? 
T¿nsfÜmS‹
::
AccumuÏ‹T¿nsfÜm
 : T¿nsfÜmS‹::
FÏ‰’T¿nsfÜm
);

789 
	gŒªsfÜmS‹
.
move
(-
cÚš”Off£t
.
width
(), -cÚš”Off£t.
height
(), 
´e£rve3D
 ? 
T¿nsfÜmS‹
::
AccumuÏ‹T¿nsfÜm
 : T¿nsfÜmS‹::
FÏ‰’T¿nsfÜm
);

792 
	gR’d”IÆše
::
upd©eD¿gS‹
(
boŞ
 
d¿gOn
)

794 
R’d”BoxMod–Objeù
::
upd©eD¿gS‹
(
d¿gOn
);

795 ià(
cÚtšu©iÚ
())

796 
cÚtšu©iÚ
()->
upd©eD¿gS‹
(
d¿gOn
);

799 
	gR’d”IÆše
::
chdBeÿmeNÚIÆše
(
R’d”Objeù
* 
chd
)

802 
R’d”Block
* 
ÃwBox
 = 
cÚššgBlock
()->
ü—‹AnÚymousBlock
();

803 
R’d”BoxMod–Objeù
* 
	gŞdCÚtšu©iÚ
 = 
cÚtšu©iÚ
();

804 
£tCÚtšu©iÚ
(
ÃwBox
);

805 
R’d”Objeù
* 
	gbefÜeChd
 = 
chd
->
ÃxtSiblšg
();

806 
chd»n
()->
»moveChdNode
(
this
, 
chd
);

807 
¥l™Flow
(
befÜeChd
, 
ÃwBox
, 
chd
, 
ŞdCÚtšu©iÚ
);

810 
	gR’d”IÆše
::
upd©eH™Te¡ResuÉ
(
H™Te¡ResuÉ
& 
»suÉ
, cÚ¡ 
IÁPošt
& 
pošt
)

812 ià(
	g»suÉ
.
šÃrNode
())

815 
Node
* 
	gn
 = 
node
();

816 
IÁPošt
 
loÿlPošt
(
pošt
);

817 ià(
	gn
) {

818 ià(
isIÆšeCÚtšu©iÚ
()) {

821 
R’d”Block
* 
	gfœ¡Block
 = 
n
->
»nd””
()->
cÚššgBlock
();

824 
R’d”Box
* 
	gblock
 = 
cÚššgBlock
();

825 
	gloÿlPošt
.
move
(
block
->
x
(è- 
fœ¡Block
->x(), block->
y
() - firstBlock->y());

828 
	g»suÉ
.
£tIÂ”Node
(
n
);

829 ià(!
	g»suÉ
.
šÃrNÚSh¬edNode
())

830 
	g»suÉ
.
£tIÂ”NÚSh¬edNode
(
n
);

831 
	g»suÉ
.
£tLoÿlPošt
(
loÿlPošt
);

835 
	gR’d”IÆše
::
dœtyLšeBoxes
(
boŞ
 
fuÎLayout
)

837 ià(
fuÎLayout
)

838 
m_lšeBoxes
.
d–‘eLšeBoxes
(
»nd”A»Ç
());

840 
	gm_lšeBoxes
.
dœtyLšeBoxes
();

843 
IÆšeFlowBox
* 
	gR’d”IÆše
::
ü—‹IÆšeFlowBox
()

845  
Ãw
 (
»nd”A»Ç
()è
IÆšeFlowBox
(
this
);

848 
IÆšeFlowBox
* 
	gR’d”IÆše
::
ü—‹AndAµ’dIÆšeFlowBox
()

850 
IÆšeFlowBox
* 
æowBox
 = 
ü—‹IÆšeFlowBox
();

851 
	gm_lšeBoxes
.
­³ndLšeBox
(
æowBox
);

852  
	gæowBox
;

855 
	gR’d”IÆše
::
lšeHeight
(
boŞ
 
fœ¡Lše
, bool ) const

857 ià(
	gfœ¡Lše
 && 
docum’t
()->
u£sFœ¡LšeRuËs
()) {

858 
R’d”StyË
* 
	gs
 = 
¡yË
(
fœ¡Lše
);

859 ià(
	gs
 !ğ
¡yË
())

860  
s
->
compu‹dLšeHeight
();

863 ià(
	gm_lšeHeight
 == -1)

864 
m_lšeHeight
 = 
¡yË
()->
compu‹dLšeHeight
();

866  
	gm_lšeHeight
;

869 
	gR’d”IÆše
::
v”tiÿlPos™iÚFromCache
(
boŞ
 
fœ¡Lše
) const

871 ià(
fœ¡Lše
)

872 
fœ¡Lše
 = 
docum’t
()->
u£sFœ¡LšeRuËs
();

873 
	gvpos
 = 
m_v”tiÿlPos™iÚ
;

874 ià(
	gm_v”tiÿlPos™iÚ
 =ğ
Pos™iÚUndefšed
 || 
fœ¡Lše
) {

875 
vpos
 = 
v”tiÿlPos™iÚ
(
fœ¡Lše
);

876 ià(!
	gfœ¡Lše
)

877 
	gm_v”tiÿlPos™iÚ
 = 
vpos
;

879  
	gvpos
;

882 
IÁSize
 
	gR’d”IÆše
::
»ÏtivePos™iÚedIÆšeOff£t
(cÚ¡ 
R’d”Box
* 
chd
) const

884 
ASSERT
(
isR–Pos™iÚed
());

885 ià(!
isR–Pos™iÚed
())

886  
IÁSize
();

892 
IÁSize
 
	goff£t
;

893 
	gsx
;

894 
	gsy
;

895 ià(
fœ¡LšeBox
()) {

896 
	gsx
 = 
fœ¡LšeBox
()->
x
();

897 
	gsy
 = 
fœ¡LšeBox
()->
y
();

899 
	gsx
 = 
Ïy”
()->
¡©icX
();

900 
	gsy
 = 
Ïy”
()->
¡©icY
();

903 ià(!
	gchd
->
¡yË
()->
hasSticX
())

904 
	goff£t
.
£tWidth
(
sx
);

909 ià(!
	gchd
->
¡yË
()->
isOrigš®Di¥ÏyIÆšeTy³
())

911 
	goff£t
.
£tWidth
(
sx
 - (
chd
->
cÚššgBlock
()->
bÜd”Leá
(è+ chd->cÚššgBlock()->
·ddšgLeá
()));

913 ià(!
	gchd
->
¡yË
()->
hasSticY
())

914 
	goff£t
.
£tHeight
(
sy
);

916  
	goff£t
;

919 
	gR’d”IÆše
::
imageChªged
(
W¿µedImagePŒ
, cÚ¡ 
IÁReù
*)

921 ià(!
·»Á
())

925 
»·št
();

928 
	gR’d”IÆše
::
addFocusRšgReùs
(
VeùÜ
<
IÁReù
>& 
»ùs
, 
tx
, 
ty
)

930 
IÆšeFlowBox
* 
	gcu¼
 = 
fœ¡LšeBox
(); cu¼; cu¼ = 
cu¼
->
ÃxtLšeBox
()) {

931 
RoÙIÆšeBox
* 
roÙ
 = 
cu¼
->root();

932 
	gtİ
 = 
max
(
roÙ
->
lšeTİ
(), 
cu¼
->
y
());

933 
	gbÙtom
 = 
mš
(
roÙ
->
lšeBÙtom
(), 
cu¼
->
y
(è+ cu¼->
height
());

934 
IÁReù
 
»ù
(
tx
 + 
cu¼
->
x
(), 
ty
 + 
tİ
, cu¼->
width
(), 
bÙtom
 -op);

935 ià(!
	g»ù
.
isEm±y
())

936 
	g»ùs
.
­³nd
(
»ù
);

939 
R’d”Objeù
* 
	gcu¼
 = 
fœ¡Chd
(); cu¼; cu¼ = 
cu¼
->
ÃxtSiblšg
()) {

940 ià(!
cu¼
->
isText
(è&& !cu¼->
isLi¡M¬k”
()) {

941 
FlßtPošt
 
pos
(
tx
, 
ty
);

943 ià(
	gcu¼
->
hasLay”
())

944 
	gpos
 = 
cu¼
->
loÿlToAbsŞu‹
();

945 ià(
	gcu¼
->
isBox
())

946 
	gpos
.
move
(
toR’d”Box
(
cu¼
)->
x
(),oR’d”Box(cu¼)->
y
());

947 
	gcu¼
->
addFocusRšgReùs
(
»ùs
, 
pos
.
x
(),…os.
y
());

951 ià(
cÚtšu©iÚ
()) {

952 ià(
cÚtšu©iÚ
()->
isIÆše
())

953 
cÚtšu©iÚ
()->
addFocusRšgReùs
(
»ùs
,

954 
tx
 - 
cÚššgBlock
()->
x
(è+ 
cÚtšu©iÚ
()->containingBlock()->x(),

955 
ty
 - 
cÚššgBlock
()->
y
(è+ 
cÚtšu©iÚ
()->containingBlock()->y());

957 
cÚtšu©iÚ
()->
addFocusRšgReùs
(
»ùs
,

958 
tx
 - 
cÚššgBlock
()->
x
(è+ 
toR’d”Box
(
cÚtšu©iÚ
())->x(),

959 
ty
 - 
cÚššgBlock
()->
y
(è+ 
toR’d”Box
(
cÚtšu©iÚ
())->y());

963 
	gR’d”IÆše
::
·štOuše
(
G¿phicsCÚ‹xt
* 
g¿phicsCÚ‹xt
, 
tx
, 
ty
)

965 ià(!
hasOuše
())

968 
R’d”StyË
* 
	g¡yËToU£
 = 
¡yË
();

969 ià(
	g¡yËToU£
->
oušeStyËIsAuto
(è|| 
hasOušeAÂÙ©iÚ
()) {

970 
	gow
 = 
¡yËToU£
->
oušeWidth
();

971 
CŞÜ
 
	goc
 = 
¡yËToU£
->
vis™edD•’d’tCŞÜ
(
CSSPrİ”tyOušeCŞÜ
);

973 
	gVeùÜ
<
	gIÁReù
> 
	gfocusRšgReùs
;

974 
addFocusRšgReùs
(
focusRšgReùs
, 
tx
, 
ty
);

975 ià(
	g¡yËToU£
->
oušeStyËIsAuto
())

976 
	gg¿phicsCÚ‹xt
->
d¿wFocusRšg
(
focusRšgReùs
, 
ow
, 
¡yËToU£
->
oušeOff£t
(), 
oc
);

978 
addPDFURLReù
(
g¿phicsCÚ‹xt
, 
uniÚReù
(
focusRšgReùs
));

981 ià(
	g¡yËToU£
->
oušeStyËIsAuto
(è|| styËToU£->
oušeStyË
(è=ğ
BNONE
)

984 
	gVeùÜ
<
	gIÁReù
> 
	g»ùs
;

986 
	g»ùs
.
­³nd
(
IÁReù
());

987 
IÆšeFlowBox
* 
	gcu¼
 = 
fœ¡LšeBox
(); cu¼; cu¼ = 
cu¼
->
ÃxtLšeBox
()) {

988 
RoÙIÆšeBox
* 
roÙ
 = 
cu¼
->root();

989 
	gtİ
 = 
max
(
roÙ
->
lšeTİ
(), 
cu¼
->
y
());

990 
	gbÙtom
 = 
mš
(
roÙ
->
lšeBÙtom
(), 
cu¼
->
y
(è+ cu¼->
height
());

991 
	g»ùs
.
­³nd
(
IÁReù
(
cu¼
->
x
(), 
tİ
, cu¼->
width
(), 
bÙtom
 -op));

993 
	g»ùs
.
­³nd
(
IÁReù
());

995 
	gi
 = 1; i < 
	g»ùs
.
size
() - 1; i++)

996 
·štOušeFÜLše
(
g¿phicsCÚ‹xt
, 
tx
, 
ty
, 
»ùs
.
©
(
i
 - 1),„ects.at(i),„ects.at(i + 1));

999 
	gR’d”IÆše
::
·štOušeFÜLše
(
G¿phicsCÚ‹xt
* 
g¿phicsCÚ‹xt
, 
tx
, 
ty
,

1000 cÚ¡ 
IÁReù
& 
Ï¡lše
, cÚ¡ IÁReù& 
thi¦še
, cÚ¡ IÁReù& 
Ãxše
)

1002 
R’d”StyË
* 
	g¡yËToU£
 = 
¡yË
();

1003 
	gow
 = 
¡yËToU£
->
oušeWidth
();

1004 
EBÜd”StyË
 
	gos
 = 
¡yËToU£
->
oušeStyË
();

1005 
CŞÜ
 
	goc
 = 
¡yËToU£
->
vis™edD•’d’tCŞÜ
(
CSSPrİ”tyOušeCŞÜ
);

1007 
	goff£t
 = 
¡yË
()->
oušeOff£t
();

1009 
	gt
 = 
ty
 + 
thi¦še
.
y
(è- 
off£t
;

1010 
	gl
 = 
tx
 + 
thi¦še
.
x
(è- 
off£t
;

1011 
	gb
 = 
ty
 + 
thi¦še
.
bÙtom
(è+ 
off£t
;

1012 
	gr
 = 
tx
 + 
thi¦še
.
right
(è+ 
off£t
;

1015 
d¿wLšeFÜBoxSide
(
g¿phicsCÚ‹xt
,

1016 
l
 - 
ow
,

1017 
t
 - (
Ï¡lše
.
isEm±y
(è|| 
thi¦še
.
x
(è<†a¡lše.x(è|| (Ï¡lše.
right
(è- 1è<ğthi¦še.x(è? 
ow
 : 0),

1018 
l
,

1019 
b
 + (
Ãxše
.
isEm±y
(è|| 
thi¦še
.
x
(è<ğÃxše.x(è|| (Ãxše.
right
(è- 1è<ğthi¦še.x(è? 
ow
 : 0),

1020 
BSLeá
,

1021 
oc
, 
os
,

1022 (
Ï¡lše
.
isEm±y
(è|| 
thi¦še
.
x
(è<†a¡lše.x(è|| (Ï¡lše.
right
(è- 1è<ğthi¦še.x(è? 
ow
 : -ow),

1023 (
Ãxše
.
isEm±y
(è|| 
thi¦še
.
x
(è<ğÃxše.x(è|| (Ãxše.
right
(è- 1è<ğthi¦še.x(è? 
ow
 : -ow));

1026 
d¿wLšeFÜBoxSide
(
g¿phicsCÚ‹xt
,

1027 
r
,

1028 
t
 - (
Ï¡lše
.
isEm±y
(è||†a¡lše.
right
(è< 
thi¦še
.right(è|| (thi¦še.right(è- 1è<ğÏ¡lše.
x
(è? 
ow
 : 0),

1029 
r
 + 
ow
,

1030 
b
 + (
Ãxše
.
isEm±y
(è||‚exše.
right
(è<ğ
thi¦še
.right(è|| (thi¦še.right(è- 1è<ğÃxše.
x
(è? 
ow
 : 0),

1031 
BSRight
,

1032 
oc
, 
os
,

1033 (
Ï¡lše
.
isEm±y
(è||†a¡lše.
right
(è< 
thi¦še
.right(è|| (thi¦še.right(è- 1è<ğÏ¡lše.
x
(è? 
ow
 : -ow),

1034 (
Ãxše
.
isEm±y
(è||‚exše.
right
(è<ğ
thi¦še
.right(è|| (thi¦še.right(è- 1è<ğÃxše.
x
(è? 
ow
 : -ow));

1036 ià(
	gthi¦še
.
x
(è< 
	gÏ¡lše
.x())

1037 
d¿wLšeFÜBoxSide
(
g¿phicsCÚ‹xt
,

1038 
l
 - 
ow
,

1039 
t
 - 
ow
,

1040 
mš
(
r
+
ow
, (
Ï¡lše
.
isEm±y
(è? 1000000 : 
tx
 +†a¡lše.
x
())),

1041 
t
 ,

1042 
BSTİ
, 
oc
, 
os
,

1043 
ow
,

1044 (!
Ï¡lše
.
isEm±y
(è&& 
tx
 +†a¡lše.
x
(è+ 1 < 
r
 + 
ow
) ? -ow : ow);

1046 ià(
	gÏ¡lše
.
right
(è< 
	gthi¦še
.right())

1047 
d¿wLšeFÜBoxSide
(
g¿phicsCÚ‹xt
,

1048 
max
(
Ï¡lše
.
isEm±y
(è? -1000000 : 
tx
 +†a¡lše.
right
(), 
l
 - 
ow
),

1049 
t
 - 
ow
,

1050 
r
 + 
ow
,

1051 
t
 ,

1052 
BSTİ
, 
oc
, 
os
,

1053 (!
Ï¡lše
.
isEm±y
(è&& 
l
 - 
ow
 < 
tx
 +†a¡lše.
right
()) ? -ow : ow,

1054 
ow
);

1057 ià(
	gthi¦še
.
x
(è< 
	gÃxše
.x())

1058 
d¿wLšeFÜBoxSide
(
g¿phicsCÚ‹xt
,

1059 
l
 - 
ow
,

1060 
b
,

1061 
mš
(
r
 + 
ow
, !
Ãxše
.
isEm±y
(è? 
tx
 +‚exše.
x
() + 1 : 1000000),

1062 
b
 + 
ow
,

1063 
BSBÙtom
, 
oc
, 
os
,

1064 
ow
,

1065 (!
Ãxše
.
isEm±y
(è&& 
tx
 +‚exše.
x
(è+ 1 < 
r
 + 
ow
) ? -ow : ow);

1067 ià(
	gÃxše
.
right
(è< 
	gthi¦še
.right())

1068 
d¿wLšeFÜBoxSide
(
g¿phicsCÚ‹xt
,

1069 
max
(!
Ãxše
.
isEm±y
(è? 
tx
 +‚exše.
right
(è: -1000000, 
l
 - 
ow
),

1070 
b
,

1071 
r
 + 
ow
,

1072 
b
 + 
ow
,

1073 
BSBÙtom
, 
oc
, 
os
,

1074 (!
Ãxše
.
isEm±y
(è&& 
l
 - 
ow
 < 
tx
 +‚exše.
right
()) ? -ow : ow,

1075 
ow
);

1078 #ià
ENABLE
(
DASHBOARD_SUPPORT
)

1079 
	gR’d”IÆše
::
addDashbßrdRegiÚs
(
VeùÜ
<
DashbßrdRegiÚV®ue
>& 
»giÚs
)

1082 ià(
¡yË
()->
visib™y
(è!ğ
VISIBLE
)

1085 cÚ¡ 
	gVeùÜ
<
	gStyËDashbßrdRegiÚ
>& 
	g¡yËRegiÚs
 = 
¡yË
()->
dashbßrdRegiÚs
();

1086 
	gi
, 
	gcouÁ
 = 
¡yËRegiÚs
.
size
();

1087 
	gi
 = 0; i < 
	gcouÁ
; i++) {

1088 
StyËDashbßrdRegiÚ
 
	g¡yËRegiÚ
 = 
¡yËRegiÚs
[
i
];

1090 
IÁReù
 
	glšesBoundšgBox
 = 
this
->
lšesBoundšgBox
();

1091 
	gw
 = 
lšesBoundšgBox
.
width
();

1092 
	gh
 = 
lšesBoundšgBox
.
height
();

1094 
DashbßrdRegiÚV®ue
 
	g»giÚ
;

1095 
	g»giÚ
.
	gÏb–
 = 
¡yËRegiÚ
.
Ïb–
;

1096 
	g»giÚ
.
	gbounds
 = 
IÁReù
(
lšesBoundšgBox
.
x
(è+ 
¡yËRegiÚ
.
off£t
.
Ëá
().
v®ue
(),

1097 
lšesBoundšgBox
.
y
(è+ 
¡yËRegiÚ
.
off£t
.
tİ
().
v®ue
(),

1098 
w
 - 
¡yËRegiÚ
.
off£t
.
Ëá
().
v®ue
(è- styËRegiÚ.off£t.
right
().value(),

1099 
h
 - 
¡yËRegiÚ
.
off£t
.
tİ
().
v®ue
(è- styËRegiÚ.off£t.
bÙtom
().value());

1100 
	g»giÚ
.
	gty³
 = 
¡yËRegiÚ
.
ty³
;

1102 
R’d”Objeù
* 
	gcÚš”
 = 
cÚššgBlock
();

1103 ià(!
	gcÚš”
)

1104 
	gcÚš”
 = 
this
;

1106 
	g»giÚ
.
	gş
 = 
»giÚ
.
bounds
;

1107 
	gcÚš”
->
compu‹AbsŞu‹R•aštReù
(
»giÚ
.
ş
);

1108 ià(
	g»giÚ
.
	gş
.
height
() < 0) {

1109 
	g»giÚ
.
	gş
.
£tHeight
(0);

1110 
	g»giÚ
.
	gş
.
£tWidth
(0);

1113 
FlßtPošt
 
	gabsPos
 = 
cÚš”
->
loÿlToAbsŞu‹
();

1114 
	g»giÚ
.
	gbounds
.
£tX
(
absPos
.
x
(è+ 
»giÚ
.
bounds
.x());

1115 
	g»giÚ
.
	gbounds
.
£tY
(
absPos
.
y
(è+ 
»giÚ
.
bounds
.y());

1117 ià(
docum’t
()->
äame
()) {

1118 
	g·geSÿËFaùÜ
 = 
docum’t
()->
äame
()->
·ge
()->
chrome
()->
sÿËFaùÜ
();

1119 ià(
	g·geSÿËFaùÜ
 != 1.0f) {

1120 
»giÚ
.
bounds
.
sÿË
(
·geSÿËFaùÜ
);

1121 
	g»giÚ
.
	gş
.
sÿË
(
·geSÿËFaùÜ
);

1125 
	g»giÚs
.
­³nd
(
»giÚ
);

	@RenderInline.h

23 #iâdeà
R’d”IÆše_h


24 
	#R’d”IÆše_h


	)

26 
	~"R’d”BoxMod–Objeù.h
"

27 
	~"R’d”LšeBoxLi¡.h
"

29 
Çme¥aû
 
	gWebCÜe
 {

31 
şass
 
	gPos™iÚ
;

33 şas 
	cR’d”IÆše
 : 
public
 
R’d”BoxMod–Objeù
 {

34 
public
:

35 
R’d”IÆše
(
Node
*);

37 
vœtu®
 
de¡roy
();

39 
vœtu®
 
addChd
(
R’d”Objeù
* 
ÃwChd
, R’d”Objeù* 
befÜeChd
 = 0);

41 
vœtu®
 
m¬gšLeá
() const;

42 
vœtu®
 
m¬gšRight
() const;

44 
vœtu®
 
absŞu‹Reùs
(
VeùÜ
<
IÁReù
>&, 
tx
, 
ty
);

45 
vœtu®
 
absŞu‹Quads
(
VeùÜ
<
FlßtQuad
>&);

47 
vœtu®
 
IÁSize
 
off£tFromCÚš”
(
R’d”Objeù
*, cÚ¡ 
IÁPošt
&) const;

49 
IÁReù
 
lšesBoundšgBox
() const;

50 
IÁReù
 
lšesVisibËOv”æowBoundšgBox
() const;

52 
IÆšeFlowBox
* 
ü—‹AndAµ’dIÆšeFlowBox
();

54 
dœtyLšeBoxes
(
boŞ
 
fuÎLayout
);

56 
R’d”LšeBoxLi¡
* 
lšeBoxes
(è{  &
	gm_lšeBoxes
; }

57 cÚ¡ 
R’d”LšeBoxLi¡
* 
lšeBoxes
(ècÚ¡ {  &
	gm_lšeBoxes
; }

59 
IÆšeFlowBox
* 
fœ¡LšeBox
(ècÚ¡ {  
	gm_lšeBoxes
.firstLineBox(); }

60 
IÆšeFlowBox
* 
Ï¡LšeBox
(ècÚ¡ {  
	gm_lšeBoxes
.lastLineBox(); }

62 
R’d”BoxMod–Objeù
* 
cÚtšu©iÚ
(ècÚ¡ {  
	gm_cÚtšu©iÚ
; }

64 
vœtu®
 
upd©eD¿gS‹
(
boŞ
 
d¿gOn
);

66 
IÁSize
 
»ÏtivePos™iÚedIÆšeOff£t
(cÚ¡ 
R’d”Box
* 
chd
) const;

68 
vœtu®
 
addFocusRšgReùs
(
VeùÜ
<
IÁReù
>&, 
tx
, 
ty
);

69 
·štOuše
(
G¿phicsCÚ‹xt
*, 
tx
, 
ty
);

71 
v”tiÿlPos™iÚFromCache
(
boŞ
 
fœ¡Lše
) const;

72 
šv®id©eV”tiÿlPos™iÚ
(è{ 
	gm_v”tiÿlPos™iÚ
 = 
Pos™iÚUndefšed
; }

74 
	g´iv©e
:

75 
vœtu®
 
R’d”ObjeùChdLi¡
* 
vœtu®Chd»n
(è{  
chd»n
(); }

76 
vœtu®
 cÚ¡ 
R’d”ObjeùChdLi¡
* 
vœtu®Chd»n
(ècÚ¡ {  
chd»n
(); }

77 cÚ¡ 
R’d”ObjeùChdLi¡
* 
chd»n
(ècÚ¡ {  &
	gm_chd»n
; }

78 
R’d”ObjeùChdLi¡
* 
chd»n
(è{  &
	gm_chd»n
; }

80 
vœtu®
 cÚ¡ * 
»nd”Name
() const;

82 
vœtu®
 
boŞ
 
isR’d”IÆše
(ècÚ¡ {  
	gŒue
; }

84 
addChdToCÚtšu©iÚ
(
R’d”Objeù
* 
ÃwChd
, R’d”Objeù* 
befÜeChd
);

85 
vœtu®
 
addChdIgnÜšgCÚtšu©iÚ
(
R’d”Objeù
* 
ÃwChd
, R’d”Objeù* 
befÜeChd
 = 0);

87 
¥l™IÆšes
(
R’d”Block
* 
äomBlock
, R’d”Block* 
toBlock
, R’d”Block* 
middËBlock
,

88 
R’d”Objeù
* 
befÜeChd
, 
R’d”BoxMod–Objeù
* 
ŞdCÚt
);

89 
¥l™Flow
(
R’d”Objeù
* 
befÜeChd
, 
R’d”Block
* 
ÃwBlockBox
,

90 
R’d”Objeù
* 
ÃwChd
, 
R’d”BoxMod–Objeù
* 
ŞdCÚt
);

92 
vœtu®
 
Ïyout
(è{ 
ASSERT_NOT_REACHED
(); }

94 
vœtu®
 
·št
(
PaštInfo
&, 
tx
, 
ty
);

96 
vœtu®
 
boŞ
 
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, 
x
, 
y
, 
tx
, 
ty
, 
H™Te¡AùiÚ
);

98 
vœtu®
 
boŞ
 
»quœesLay”
(ècÚ¡ {  
isR–Pos™iÚed
(è|| 
isT¿n¥¬’t
(è|| 
hasMask
(); }

100 
vœtu®
 
off£tLeá
() const;

101 
vœtu®
 
off£tTİ
() const;

102 
vœtu®
 
off£tWidth
(ècÚ¡ {  
lšesBoundšgBox
().
width
(); }

103 
vœtu®
 
off£tHeight
(ècÚ¡ {  
lšesBoundšgBox
().
height
(); }

106 
vœtu®
 
m¬gšTİ
() const {  0; }

107 
vœtu®
 
m¬gšBÙtom
() const {  0; }

108 
vœtu®
 
IÁReù
 
ş³dOv”æowReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
);

109 
vœtu®
 
IÁReù
 
»ùW™hOušeFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
oušeWidth
);

110 
vœtu®
 
compu‹ReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
IÁReù
& 
»ù
, 
boŞ
 
fixed
);

112 
vœtu®
 
m­LoÿlToCÚš”
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
boŞ
 
fixed
, boŞ 
u£T¿nsfÜms
, 
T¿nsfÜmS‹
&) const;

113 
vœtu®
 
m­AbsŞu‹ToLoÿlPošt
(
boŞ
 
fixed
, boŞ 
u£T¿nsfÜms
, 
T¿nsfÜmS‹
&) const;

115 
vœtu®
 
VisibËPos™iÚ
 
pos™iÚFÜPošt
(cÚ¡ 
IÁPošt
&);

117 
vœtu®
 
IÁReù
 
bÜd”BoundšgBox
() const

119 
IÁReù
 
	gboundšgBox
 = 
lšesBoundšgBox
();

120  
IÁReù
(0, 0, 
boundšgBox
.
width
(), boundšgBox.
height
());

123 
vœtu®
 
IÆšeFlowBox
* 
ü—‹IÆšeFlowBox
();

125 
vœtu®
 
dœtyLšesFromChªgedChd
(
R’d”Objeù
* 
chd
è{ 
	gm_lšeBoxes
.dœtyLšesFromChªgedChd(
this
, child); }

127 
vœtu®
 
lšeHeight
(
boŞ
 
fœ¡Lše
, boŞ 
isRoÙLšeBox
 = 
çl£
) const;

129 
R’d”IÆše
* 
šlšeCÚtšu©iÚ
() const;

130 
£tCÚtšu©iÚ
(
R’d”BoxMod–Objeù
* 
c
è{ 
	gm_cÚtšu©iÚ
 = c; }

132 
vœtu®
 
chdBeÿmeNÚIÆše
(
R’d”Objeù
* 
chd
);

134 
vœtu®
 
upd©eH™Te¡ResuÉ
(
H™Te¡ResuÉ
&, cÚ¡ 
IÁPošt
&);

136 
vœtu®
 
imageChªged
(
W¿µedImagePŒ
, cÚ¡ 
IÁReù
* = 0);

138 #ià
ENABLE
(
DASHBOARD_SUPPORT
)

139 
vœtu®
 
addDashbßrdRegiÚs
(
VeùÜ
<
DashbßrdRegiÚV®ue
>&);

142 
vœtu®
 
¡yËDidChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
);

143 
vœtu®
 
upd©eBoxMod–InfoFromStyË
();

145 
R’d”IÆše
* 
şÚeIÆše
(R’d”IÆše* 
¤c
);

147 
·štOušeFÜLše
(
G¿phicsCÚ‹xt
*, 
tx
, 
ty
, cÚ¡ 
IÁReù
& 
´evLše
, cÚ¡ IÁReù& 
thisLše
, cÚ¡ IÁReù& 
ÃxtLše
);

148 
R’d”BoxMod–Objeù
* 
cÚtšu©iÚBefÜe
(
R’d”Objeù
* 
befÜeChd
);

150 
R’d”ObjeùChdLi¡
 
	gm_chd»n
;

151 
R’d”LšeBoxLi¡
 
	gm_lšeBoxes
;

153 
R’d”BoxMod–Objeù
* 
	gm_cÚtšu©iÚ
;

155 
mubË
 
	gm_lšeHeight
;

156 
mubË
 
	gm_v”tiÿlPos™iÚ
;

159 
šlše
 
R’d”IÆše
* 
	$toR’d”IÆše
(
R’d”Objeù
* 
objeù
)

161 
	`ASSERT
(!
objeù
 || objeù->
	`isR’d”IÆše
());

162  
¡©ic_ÿ¡
<
R’d”IÆše
*>(
objeù
);

163 
	}
}

165 
šlše
 cÚ¡ 
R’d”IÆše
* 
	$toR’d”IÆše
(cÚ¡ 
R’d”Objeù
* 
objeù
)

167 
	`ASSERT
(!
objeù
 || objeù->
	`isR’d”IÆše
());

168  
¡©ic_ÿ¡
<cÚ¡ 
R’d”IÆše
*>(
objeù
);

169 
	}
}

172 
toR’d”IÆše
(cÚ¡ 
R’d”IÆše
*);

	@RenderLayer.cpp

44 
	~"cÚfig.h
"

45 
	~"R’d”Lay”.h
"

47 
	~"CSSPrİ”tyNames.h
"

48 
	~"CSSStyËDeş¬©iÚ.h
"

49 
	~"CSSStyËS–eùÜ.h
"

50 
	~"Docum’t.h
"

51 
	~"Ev’tHªdËr.h
"

52 
	~"Ev’tNames.h
"

53 
	~"FlßtPošt3D.h
"

54 
	~"FlßtReù.h
"

55 
	~"FocusCÚŒŞËr.h
"

56 
	~"F¿me.h
"

57 
	~"F¿meT»e.h
"

58 
	~"F¿meV›w.h
"

59 
	~"G¿d›Á.h
"

60 
	~"G¿phicsCÚ‹xt.h
"

61 
	~"HTMLNames.h
"

62 
	~"H™Te¡Reque¡.h
"

63 
	~"H™Te¡ResuÉ.h
"

64 
	~"Ov”æowEv’t.h
"

65 
	~"Ov”ÏpTe¡Reque¡Cl›Á.h
"

66 
	~"Page.h
"

67 
	~"PÏtfÜmMou£Ev’t.h
"

68 
	~"R’d”A»Ç.h
"

69 
	~"R’d”IÆše.h
"

70 
	~"R’d”M¬qu“.h
"

71 
	~"R’d”R•liÿ.h
"

72 
	~"R’d”SüŞlb¬.h
"

73 
	~"R’d”SüŞlb¬P¬t.h
"

74 
	~"R’d”Theme.h
"

75 
	~"R’d”T»eAsText.h
"

76 
	~"R’d”V›w.h
"

77 
	~"SÿËT¿nsfÜmO³¿tiÚ.h
"

78 
	~"SüŞlb¬.h
"

79 
	~"SüŞlb¬Theme.h
"

80 
	~"S–eùiÚCÚŒŞËr.h
"

81 
	~"TextSŒ—m.h
"

82 
	~"T¿nsfÜm©iÚM©rix.h
"

83 
	~"T¿nsfÜmS‹.h
"

84 
	~"T¿n¦©eT¿nsfÜmO³¿tiÚ.h
"

85 
	~<wtf/‹xt/CSŒšg.h
>

86 
	~<wtf/StdLibExŒas.h
>

87 
	~<wtf/Unu£dP¬am.h
>

89 #ià
USE
(
ACCELERATED_COMPOSITING
)

90 
	~"R’d”Lay”Backšg.h
"

91 
	~"R’d”Lay”Compos™Ü.h
"

94 #ià
ENABLE
(
SVG
)

95 
	~"SVGNames.h
"

98 
	#MIN_INTERSECT_FOR_REVEAL
 32

	)

100 
usšg
 
Çme¥aû
 
	g¡d
;

102 
Çme¥aû
 
	gWebCÜe
 {

104 
usšg
 
Çme¥aû
 
	gHTMLNames
;

106 cÚ¡ 
	gMšimumWidthWheResizšg
 = 100;

107 cÚ¡ 
	gMšimumHeightWheResizšg
 = 40;

109 * 
	gClReùs
::
İ”©Ü
 
Ãw
(
size_t
 
sz
, 
R’d”A»Ç
* 
»nd”A»Ç
è
throw
()

111  
	g»nd”A»Ç
->
®loÿ‹
(
sz
);

114 
	gClReùs
::
İ”©Ü
 
d–‘e
(* 
±r
, 
size_t
 
sz
)

117 *(
	gsize_t
 *)
	g±r
 = 
sz
;

120 
	gClReùs
::
de¡roy
(
R’d”A»Ç
* 
»nd”A»Ç
)

122 
d–‘e
 
this
;

125 
	g»nd”A»Ç
->
ä“
(*(
size_t
 *)
this
,his);

128 
	gR’d”Lay”
::
R’d”Lay”
(
R’d”BoxMod–Objeù
* 
»nd””
)

129 : 
m_»nd””
(
»nd””
)

130 , 
m_·»Á
(0)

131 , 
m_´evious
(0)

132 , 
m_Ãxt
(0)

133 , 
m_fœ¡
(0)

134 , 
m_Ï¡
(0)

135 , 
m_»lX
(0)

136 , 
m_»lY
(0)

137 , 
m_x
(0)

138 , 
m_y
(0)

139 , 
m_width
(0)

140 , 
m_height
(0)

141 , 
m_süŞlX
(0)

142 , 
m_süŞlY
(0)

143 , 
m_süŞlOrigšX
(0)

144 , 
m_süŞlLeáOv”æow
(0)

145 , 
m_süŞlWidth
(0)

146 , 
m_süŞlHeight
(0)

147 , 
m_šResizeMode
(
çl£
)

148 , 
m_posZOrd”Li¡
(0)

149 , 
m_ÃgZOrd”Li¡
(0)

150 , 
m_nÜm®FlowLi¡
(0)

151 , 
m_şReùs
(0)

152 #iâdeà
NDEBUG


153 , 
m_şReùsRoÙ
(0)

155 , 
m_süŞlDim’siÚsDœty
(
Œue
)

156 , 
m_zOrd”Li¡sDœty
(
Œue
)

157 , 
m_nÜm®FlowLi¡Dœty
(
Œue
)

158 , 
m_isNÜm®FlowOÆy
(
shouldBeNÜm®FlowOÆy
())

159 , 
m_u£dT¿n¥¬’cy
(
çl£
)

160 , 
m_·štšgInsideReæeùiÚ
(
çl£
)

161 , 
m_šOv”æowR–ayout
(
çl£
)

162 , 
m_ÃedsFuÎR•ašt
(
çl£
)

163 , 
m_ov”æowStusDœty
(
Œue
)

164 , 
m_visibËCÚ‹ÁStusDœty
(
Œue
)

165 , 
m_hasVisibËCÚ‹Á
(
çl£
)

166 , 
m_visibËDesûndªtStusDœty
(
çl£
)

167 , 
m_hasVisibËDesûndªt
(
çl£
)

168 , 
m_3DT¿nsfÜmedDesûndªtStusDœty
(
Œue
)

169 , 
m_has3DT¿nsfÜmedDesûndªt
(
çl£
)

170 #ià
USE
(
ACCELERATED_COMPOSITING
)

171 , 
m_hasCompos™šgDesûndªt
(
çl£
)

172 , 
m_mu¡Ov”ÏpCompos™edLay”s
(
çl£
)

174 , 
m_m¬qu“
(0)

175 , 
m_¡©icX
(0)

176 , 
m_¡©icY
(0)

177 , 
m_»æeùiÚ
(0)

178 , 
m_süŞlCÜÃr
(0)

179 , 
m_»siz”
(0)

181 ià(!
	g»nd””
->
fœ¡Chd
(è&&„’d””->
¡yË
()) {

182 
	gm_visibËCÚ‹ÁStusDœty
 = 
çl£
;

183 
	gm_hasVisibËCÚ‹Á
 = 
»nd””
->
¡yË
()->
visib™y
(è=ğ
VISIBLE
;

187 
	gR’d”Lay”
::~
R’d”Lay”
()

189 ià(
šResizeMode
(è&& !
»nd””
()->
docum’tBešgDe¡royed
()) {

190 ià(
F¿me
* 
äame
 = 
»nd””
()->
docum’t
()->frame())

191 
äame
->
ev’tHªdËr
()->
»sizeLay”De¡royed
();

194 
de¡roySüŞlb¬
(
HÜizÚlSüŞlb¬
);

195 
de¡roySüŞlb¬
(
V”tiÿlSüŞlb¬
);

200 
d–‘e
 
	gm_posZOrd”Li¡
;

201 
d–‘e
 
	gm_ÃgZOrd”Li¡
;

202 
d–‘e
 
	gm_nÜm®FlowLi¡
;

203 
d–‘e
 
	gm_m¬qu“
;

205 #ià
USE
(
ACCELERATED_COMPOSITING
)

206 
ş—rBackšg
();

210 
ASSERT
(!
m_şReùs
);

212 ià(
	gm_»æeùiÚ
)

213 
»moveReæeùiÚ
();

215 ià(
	gm_süŞlCÜÃr
)

216 
	gm_süŞlCÜÃr
->
de¡roy
();

217 ià(
	gm_»siz”
)

218 
	gm_»siz”
->
de¡roy
();

221 #ià
USE
(
ACCELERATED_COMPOSITING
)

222 
R’d”Lay”Compos™Ü
* 
	gR’d”Lay”
::
compos™Ü
() const

224 
ASSERT
(
»nd””
()->
v›w
());

225  
»nd””
()->
v›w
()->
compos™Ü
();

228 
	gR’d”Lay”
::
»nd””CÚ‹ÁChªged
()

231 ià(
compos™Ü
()->
upd©eLay”Compos™šgS‹
(
this
))

232 
compos™Ü
()->
£tCompos™šgLay”sN“dRebud
();

234 ià(
	gm_backšg
)

235 
	gm_backšg
->
»nd””CÚ‹ÁChªged
();

239 
boŞ
 
	gR’d”Lay”
::
hasAcûË¿‹dCompos™šg
() const

241 #ià
USE
(
ACCELERATED_COMPOSITING
)

242  
compos™Ü
()->
hasAcûË¿‹dCompos™šg
();

244  
	gçl£
;

248 
	gR’d”Lay”
::
upd©eLay”Pos™iÚs
(
Upd©eLay”Pos™iÚsFÏgs
 
æags
, 
IÁPošt
* 
ÿchedOff£t
)

250 ià(
	gæags
 & 
	gDoFuÎR•ašt
) {

251 
»nd””
()->
»·št
();

252 #ià
USE
(
ACCELERATED_COMPOSITING
)

253 
	gæags
 &ğ~
CheckFÜR•ašt
;

255 ià(!
compos™Ü
()->
šCompos™šgMode
())

256 
	gæags
 &ğ~
DoFuÎR•ašt
;

258 
	gæags
 &ğ~(
CheckFÜR•ašt
 | 
DoFuÎR•ašt
);

263 
upd©eLay”Pos™iÚ
();

266 
IÁPošt
 
	gŞdCachedOff£t
;

267 ià(
	gÿchedOff£t
) {

269 
boŞ
 
	gdi§bËOff£tCache
 = 
»nd””
()->
hasCŞumns
(è||„’d””()->
hasT¿nsfÜm
(è|| 
isCompos™ed
();

270 #ià
ENABLE
(
SVG
)

271 
	gdi§bËOff£tCache
 = 
di§bËOff£tCache
 || 
»nd””
()->
isSVGRoÙ
();

273 ià(
	gdi§bËOff£tCache
)

274 
	gÿchedOff£t
 = 0;

276 
	gŞdCachedOff£t
 = *
ÿchedOff£t
;

280 ià(!
	gm_·»Á
 || m_·»Á->
»nd””
(è=ğ»nd””()->
cÚššgBlock
())

281 
ÿchedOff£t
->
move
(
m_x
, 
m_y
);

283 
	gx
 = 0;

284 
	gy
 = 0;

285 
cÚv”tToLay”CoÜds
(
roÙ
(), 
x
, 
y
);

286 *
	gÿchedOff£t
 = 
IÁPošt
(
x
, 
y
);

291 
	gx
 = 0;

292 
	gy
 = 0;

293 ià(
	gÿchedOff£t
) {

294 
	gx
 +ğ
ÿchedOff£t
->
x
();

295 
	gy
 +ğ
ÿchedOff£t
->
y
();

296 #iâdeà
NDEBUG


297 
	gnÚCachedX
 = 0;

298 
	gnÚCachedY
 = 0;

299 
cÚv”tToLay”CoÜds
(
roÙ
(), 
nÚCachedX
, 
nÚCachedY
);

300 
ASSERT
(
x
 =ğ
nÚCachedX
);

301 
ASSERT
(
y
 =ğ
nÚCachedY
);

304 
cÚv”tToLay”CoÜds
(
roÙ
(), 
x
, 
y
);

305 
pos™iÚOv”æowCÚŒŞs
(
x
, 
y
);

307 
upd©eVisib™yStus
();

309 
upd©eT¿nsfÜm
();

311 ià(
	gm_hasVisibËCÚ‹Á
) {

312 
R’d”V›w
* 
	gv›w
 = 
»nd””
()->
v›w
();

313 
ASSERT
(
v›w
);

316 
ASSERT
(!
v›w
->
ÏyoutS‹EÇbËd
());

318 
R’d”BoxMod–Objeù
* 
	g»·štCÚš”
 = 
»nd””
()->
cÚš”FÜR•ašt
();

319 
IÁReù
 
	gÃwReù
 = 
»nd””
()->
ş³dOv”æowReùFÜR•ašt
(
»·štCÚš”
);

320 
IÁReù
 
	gÃwOušeBox
 = 
»nd””
()->
oušeBoundsFÜR•ašt
(
»·štCÚš”
, 
ÿchedOff£t
);

323 ià(
	gæags
 & 
	gCheckFÜR•ašt
) {

324 ià(
	gv›w
 && !v›w->
´štšg
()) {

325 ià(
	gm_ÃedsFuÎR•ašt
) {

326 
»nd””
()->
»·štUsšgCÚš”
(
»·štCÚš”
, 
m_»·štReù
);

327 ià(
	gÃwReù
 !ğ
m_»·štReù
)

328 
»nd””
()->
»·štUsšgCÚš”
(
»·štCÚš”
, 
ÃwReù
);

330 
»nd””
()->
»·štAá”LayoutIfN“ded
(
»·štCÚš”
, 
m_»·štReù
, 
m_oušeBox
, &
ÃwReù
, &
ÃwOušeBox
);

333 
	gm_»·štReù
 = 
ÃwReù
;

334 
	gm_oušeBox
 = 
ÃwOušeBox
;

336 
	gm_»·štReù
 = 
IÁReù
();

337 
	gm_oušeBox
 = 
IÁReù
();

340 
	gm_ÃedsFuÎR•ašt
 = 
çl£
;

343 ià(
	gm_»æeùiÚ
)

344 
	gm_»æeùiÚ
->
Ïyout
();

346 #ià
USE
(
ACCELERATED_COMPOSITING
)

348 
boŞ
 
	gisUpd©eRoÙ
 = (
æags
 & 
IsCompos™šgUpd©eRoÙ
);

349 ià(
isCompos™ed
())

350 
	gæags
 &ğ~
IsCompos™šgUpd©eRoÙ
;

353 
R’d”Lay”
* 
	gchd
 = 
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
())

354 
chd
->
upd©eLay”Pos™iÚs
(
æags
, 
ÿchedOff£t
);

356 #ià
USE
(
ACCELERATED_COMPOSITING
)

357 ià((
	gæags
 & 
	gUpd©eCompos™šgLay”s
è&& 
isCompos™ed
())

358 
backšg
()->
upd©eAá”Layout
(
R’d”Lay”Backšg
::
Compos™šgChd»n
, 
isUpd©eRoÙ
);

362 ià(
	gm_m¬qu“
)

363 
	gm_m¬qu“
->
upd©eM¬qu“Pos™iÚ
();

365 ià(
	gÿchedOff£t
)

366 *
	gÿchedOff£t
 = 
ŞdCachedOff£t
;

369 
	gR’d”Lay”
::
compu‹R•aštReùs
()

371 
R’d”BoxMod–Objeù
* 
»·štCÚš”
 = 
»nd””
()->
cÚš”FÜR•ašt
();

372 
	gm_»·štReù
 = 
»nd””
()->
ş³dOv”æowReùFÜR•ašt
(
»·štCÚš”
);

373 
	gm_oušeBox
 = 
»nd””
()->
oušeBoundsFÜR•ašt
(
»·štCÚš”
);

376 
	gR’d”Lay”
::
upd©eT¿nsfÜm
()

380 
boŞ
 
hasT¿nsfÜm
 = 
»nd””
()->hasT¿nsfÜm(è&&„’d””()->
¡yË
()->hasTransform();

381 
boŞ
 
	ghad3DT¿nsfÜm
 = 
has3DT¿nsfÜm
();

383 
boŞ
 
	ghadT¿nsfÜm
 = 
m_ŒªsfÜm
;

384 ià(
	ghasT¿nsfÜm
 !ğ
hadT¿nsfÜm
) {

385 ià(
hasT¿nsfÜm
)

386 
m_ŒªsfÜm
.
£t
(
Ãw
 
T¿nsfÜm©iÚM©rix
);

388 
	gm_ŒªsfÜm
.
ş—r
();

391 ià(
	ghasT¿nsfÜm
) {

392 
R’d”Box
* 
	gbox
 = 
»nd”Box
();

393 
ASSERT
(
box
);

394 
	gm_ŒªsfÜm
->
makeId’t™y
();

395 
	gbox
->
¡yË
()->
­¶yT¿nsfÜm
(*
m_ŒªsfÜm
, 
box
->
bÜd”BoxReù
().
size
(), 
R’d”StyË
::
InşudeT¿nsfÜmOrigš
);

396 
makeM©rixR’d”abË
(*
m_ŒªsfÜm
, 
hasAcûË¿‹dCompos™šg
());

399 ià(
	ghad3DT¿nsfÜm
 !ğ
has3DT¿nsfÜm
())

400 
dœty3DT¿nsfÜmedDesûndªtStus
();

403 
T¿nsfÜm©iÚM©rix
 
	gR’d”Lay”
::
cu¼’tT¿nsfÜm
() const

405 ià(!
m_ŒªsfÜm
)

406  
T¿nsfÜm©iÚM©rix
();

408 #ià
USE
(
ACCELERATED_COMPOSITING
)

409 ià(
»nd””
()->
¡yË
()->
isRuÂšgAcûË¿‹dAnim©iÚ
()) {

410 
T¿nsfÜm©iÚM©rix
 
	gcu¼T¿nsfÜm
;

411 
	gRefPŒ
<
	gR’d”StyË
> 
	g¡yË
 = 
»nd””
()->
ªim©iÚ
()->
g‘Anim©edStyËFÜR’d””
(renderer());

412 
	g¡yË
->
­¶yT¿nsfÜm
(
cu¼T¿nsfÜm
, 
»nd”Box
()->
bÜd”BoxReù
().
size
(), 
R’d”StyË
::
InşudeT¿nsfÜmOrigš
);

413 
makeM©rixR’d”abË
(
cu¼T¿nsfÜm
, 
hasAcûË¿‹dCompos™šg
());

414  
	gcu¼T¿nsfÜm
;

418  *
	gm_ŒªsfÜm
;

421 
T¿nsfÜm©iÚM©rix
 
	gR’d”Lay”
::
»nd”abËT¿nsfÜm
(
PaštBehaviÜ
 
·štBehaviÜ
) const

423 ià(!
m_ŒªsfÜm
)

424  
T¿nsfÜm©iÚM©rix
();

426 ià(
	g·štBehaviÜ
 & 
	gPaštBehaviÜFÏ‰’Compos™šgLay”s
) {

427 
T¿nsfÜm©iÚM©rix
 
	gm©rix
 = *
m_ŒªsfÜm
;

428 
makeM©rixR’d”abË
(
m©rix
, 
çl£
 );

429  
	gm©rix
;

432  *
	gm_ŒªsfÜm
;

435 
	gR’d”Lay”
::
£tHasVisibËCÚ‹Á
(
boŞ
 
b
)

437 ià(
m_hasVisibËCÚ‹Á
 =ğ
b
 && !
m_visibËCÚ‹ÁStusDœty
)

439 
	gm_visibËCÚ‹ÁStusDœty
 = 
çl£
;

440 
	gm_hasVisibËCÚ‹Á
 = 
b
;

441 ià(
	gm_hasVisibËCÚ‹Á
) {

442 
R’d”BoxMod–Objeù
* 
	g»·štCÚš”
 = 
»nd””
()->
cÚš”FÜR•ašt
();

443 
	gm_»·štReù
 = 
»nd””
()->
ş³dOv”æowReùFÜR•ašt
(
»·štCÚš”
);

444 
	gm_oušeBox
 = 
»nd””
()->
oušeBoundsFÜR•ašt
(
»·štCÚš”
);

445 ià(!
isNÜm®FlowOÆy
())

446 
dœtySckšgCÚ‹xtZOrd”Li¡s
();

448 ià(
·»Á
())

449 
·»Á
()->
chdVisib™yChªged
(
m_hasVisibËCÚ‹Á
);

452 
	gR’d”Lay”
::
dœtyVisibËCÚ‹ÁStus
()

454 
m_visibËCÚ‹ÁStusDœty
 = 
Œue
;

455 ià(
·»Á
())

456 
·»Á
()->
dœtyVisibËDesûndªtStus
();

459 
	gR’d”Lay”
::
chdVisib™yChªged
(
boŞ
 
ÃwVisib™y
)

461 ià(
m_hasVisibËDesûndªt
 =ğ
ÃwVisib™y
 || 
m_visibËDesûndªtStusDœty
)

463 ià(
	gÃwVisib™y
) {

464 
R’d”Lay”
* 
	gl
 = 
this
;

465 
	gl
 && !l->
	gm_visibËDesûndªtStusDœty
 && !l->
	gm_hasVisibËDesûndªt
) {

466 
	gl
->
	gm_hasVisibËDesûndªt
 = 
Œue
;

467 
	gl
 = 
l
->
·»Á
();

470 
dœtyVisibËDesûndªtStus
();

473 
	gR’d”Lay”
::
dœtyVisibËDesûndªtStus
()

475 
R’d”Lay”
* 
l
 = 
this
;

476 
	gl
 && !l->
	gm_visibËDesûndªtStusDœty
) {

477 
	gl
->
	gm_visibËDesûndªtStusDœty
 = 
Œue
;

478 
	gl
 = 
l
->
·»Á
();

482 
	gR’d”Lay”
::
upd©eVisib™yStus
()

484 ià(
m_visibËDesûndªtStusDœty
) {

485 
m_hasVisibËDesûndªt
 = 
çl£
;

486 
R’d”Lay”
* 
	gchd
 = 
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
()) {

487 
chd
->
upd©eVisib™yStus
();

488 ià(
	gchd
->
	gm_hasVisibËCÚ‹Á
 || chd->
	gm_hasVisibËDesûndªt
) {

489 
	gm_hasVisibËDesûndªt
 = 
Œue
;

493 
	gm_visibËDesûndªtStusDœty
 = 
çl£
;

496 ià(
	gm_visibËCÚ‹ÁStusDœty
) {

497 ià(
»nd””
()->
¡yË
()->
visib™y
(è=ğ
VISIBLE
)

498 
m_hasVisibËCÚ‹Á
 = 
Œue
;

501 
	gm_hasVisibËCÚ‹Á
 = 
çl£
;

502 
R’d”Objeù
* 
	gr
 = 
»nd””
()->
fœ¡Chd
();

503 
	gr
) {

504 ià(
	gr
->
¡yË
()->
visib™y
(è=ğ
VISIBLE
 && !
r
->
hasLay”
()) {

505 
m_hasVisibËCÚ‹Á
 = 
Œue
;

508 ià(
	gr
->
fœ¡Chd
(è&& !r->
hasLay”
())

509 
	gr
 = 
r
->
fœ¡Chd
();

510 ià(
	gr
->
ÃxtSiblšg
())

511 
	gr
 = 
r
->
ÃxtSiblšg
();

514 
	gr
 = 
r
->
·»Á
();

515 ià(
	gr
 =ğ
»nd””
())

516 
r
 = 0;

517 } 
	gr
 && !r->
ÃxtSiblšg
());

518 ià(
	gr
)

519 
	gr
 = 
r
->
ÃxtSiblšg
();

523 
	gm_visibËCÚ‹ÁStusDœty
 = 
çl£
;

527 
	gR’d”Lay”
::
dœty3DT¿nsfÜmedDesûndªtStus
()

529 
R’d”Lay”
* 
cu¼
 = 
¡ackšgCÚ‹xt
();

530 ià(
	gcu¼
)

531 
	gcu¼
->
	gm_3DT¿nsfÜmedDesûndªtStusDœty
 = 
Œue
;

535 
	gcu¼
 && cu¼->
´e£rves3D
()) {

536 
	gcu¼
->
	gm_3DT¿nsfÜmedDesûndªtStusDœty
 = 
Œue
;

537 
	gcu¼
 = 
cu¼
->
¡ackšgCÚ‹xt
();

542 
boŞ
 
	gR’d”Lay”
::
upd©e3DT¿nsfÜmedDesûndªtStus
()

544 ià(
m_3DT¿nsfÜmedDesûndªtStusDœty
) {

545 
m_has3DT¿nsfÜmedDesûndªt
 = 
çl£
;

549 ià(
	gm_posZOrd”Li¡
) {

550 
	gi
 = 0; i < 
	gm_posZOrd”Li¡
->
size
(); ++i)

551 
	gm_has3DT¿nsfÜmedDesûndªt
 |ğ
m_posZOrd”Li¡
->
©
(
i
)->
upd©e3DT¿nsfÜmedDesûndªtStus
();

555 ià(
	gm_ÃgZOrd”Li¡
) {

556 
	gi
 = 0; i < 
	gm_ÃgZOrd”Li¡
->
size
(); ++i)

557 
	gm_has3DT¿nsfÜmedDesûndªt
 |ğ
m_ÃgZOrd”Li¡
->
©
(
i
)->
upd©e3DT¿nsfÜmedDesûndªtStus
();

560 
	gm_3DT¿nsfÜmedDesûndªtStusDœty
 = 
çl£
;

565 ià(
´e£rves3D
())

566  
has3DT¿nsfÜm
(è|| 
	gm_has3DT¿nsfÜmedDesûndªt
;

568  
has3DT¿nsfÜm
();

571 
	gR’d”Lay”
::
upd©eLay”Pos™iÚ
()

574 
ş—rClReùs
();

576 
R’d”Box
* 
	g»nd””Box
 = 
»nd”Box
();

578 
	gx
 = 
»nd””Box
 ?„’d””Box->
x
() : 0;

579 
	gy
 = 
»nd””Box
 ?„’d””Box->
y
() : 0;

581 ià(!
»nd””
()->
isPos™iÚed
(è&&„’d””()->
·»Á
()) {

584 
R’d”Objeù
* 
	gcu¼
 = 
»nd””
()->
·»Á
();

585 
	gcu¼
 && !cu¼->
hasLay”
()) {

586 ià(
	gcu¼
->
isBox
(è&& !cu¼->
isTabËRow
()) {

589 
R’d”Box
* 
	gcu¼Box
 = 
toR’d”Box
(
cu¼
);

590 
	gx
 +ğ
cu¼Box
->
x
();

591 
	gy
 +ğ
cu¼Box
->
y
();

593 
	gcu¼
 = 
cu¼
->
·»Á
();

595 ià(
	gcu¼
->
isBox
(è&& cu¼->
isTabËRow
()) {

597 
R’d”Box
* 
	gcu¼Box
 = 
toR’d”Box
(
cu¼
);

598 
	gx
 -ğ
cu¼Box
->
x
();

599 
	gy
 -ğ
cu¼Box
->
y
();

603 
	gm_»lX
 = 
m_»lY
 = 0;

604 ià(
»nd””
()->
isR–Pos™iÚed
()) {

605 
	gm_»lX
 = 
»nd””
()->
»ÏtivePos™iÚOff£tX
();

606 
	gm_»lY
 = 
»nd””
()->
»ÏtivePos™iÚOff£tY
();

607 
	gx
 +ğ
m_»lX
; 
	gy
 +ğ
m_»lY
;

611 ià(
»nd””
()->
isPos™iÚed
(è&& 
’şosšgPos™iÚedAnû¡Ü
()) {

612 
R’d”Lay”
* 
	gpos™iÚedP¬’t
 = 
’şosšgPos™iÚedAnû¡Ü
();

615 
IÁSize
 
	goff£t
 = 
pos™iÚedP¬’t
->
süŞËdCÚ‹ÁOff£t
();

616 
	gx
 -ğ
off£t
.
width
();

617 
	gy
 -ğ
off£t
.
height
();

619 ià(
»nd””
()->
isPos™iÚed
(è&& 
	gpos™iÚedP¬’t
->»nd””()->
isR–Pos™iÚed
(è&&…os™iÚedP¬’t->»nd””()->
isR’d”IÆše
()) {

620 
IÁSize
 
	goff£t
 = 
toR’d”IÆše
(
pos™iÚedP¬’t
->
»nd””
())->
»ÏtivePos™iÚedIÆšeOff£t
(
toR’d”Box
(renderer()));

621 
	gx
 +ğ
off£t
.
width
();

622 
	gy
 +ğ
off£t
.
height
();

624 } ià(
·»Á
()) {

625 
IÁSize
 
	goff£t
 = 
·»Á
()->
süŞËdCÚ‹ÁOff£t
();

626 
	gx
 -ğ
off£t
.
width
();

627 
	gy
 -ğ
off£t
.
height
();

632 
£tLoÿtiÚ
(
x
, 
y
);

634 ià(
»nd””
()->
isR’d”IÆše
()) {

635 
R’d”IÆše
* 
	gšlšeFlow
 = 
toR’d”IÆše
(
»nd””
());

636 
IÁReù
 
	glšeBox
 = 
šlšeFlow
->
lšesBoundšgBox
();

637 
£tWidth
(
lšeBox
.
width
());

638 
£tHeight
(
lšeBox
.
height
());

639 } ià(
R’d”Box
* 
	gbox
 = 
»nd”Box
()) {

640 
£tWidth
(
box
->
width
());

641 
£tHeight
(
box
->
height
());

643 ià(!
	gbox
->
hasOv”æowCl
()) {

644 ià(
	gbox
->
rightLayoutOv”æow
(è> box->
width
())

645 
£tWidth
(
box
->
rightLayoutOv”æow
());

646 ià(
	gbox
->
bÙtomLayoutOv”æow
(è> box->
height
())

647 
£tHeight
(
box
->
bÙtomLayoutOv”æow
());

652 
T¿nsfÜm©iÚM©rix
 
	gR’d”Lay”
::
³r¥eùiveT¿nsfÜm
() const

654 ià(!
»nd””
()->
hasT¿nsfÜm
())

655  
T¿nsfÜm©iÚM©rix
();

657 
R’d”StyË
* 
	g¡yË
 = 
»nd””
()->
¡yË
();

658 ià(!
	g¡yË
->
hasP”¥eùive
())

659  
T¿nsfÜm©iÚM©rix
();

662 cÚ¡ 
IÁReù
 
	gbÜd”Box
 = 
toR’d”Box
(
»nd””
())->
bÜd”BoxReù
();

663 cÚ¡ 
	gboxWidth
 = 
bÜd”Box
.
width
();

664 cÚ¡ 
	gboxHeight
 = 
bÜd”Box
.
height
();

666 
	g³r¥eùiveOrigšX
 = 
¡yË
->
³r¥eùiveOrigšX
().
ÿlcFlßtV®ue
(
boxWidth
);

667 
	g³r¥eùiveOrigšY
 = 
¡yË
->
³r¥eùiveOrigšY
().
ÿlcFlßtV®ue
(
boxHeight
);

671 
	g³r¥eùiveOrigšX
 -ğ
boxWidth
 / 2.0f;

672 
	g³r¥eùiveOrigšY
 -ğ
boxHeight
 / 2.0f;

674 
T¿nsfÜm©iÚM©rix
 
	gt
;

675 
	gt
.
Œª¦©e
(
³r¥eùiveOrigšX
, 
³r¥eùiveOrigšY
);

676 
	gt
.
­¶yP”¥eùive
(
¡yË
->
³r¥eùive
());

677 
	gt
.
Œª¦©e
(-
³r¥eùiveOrigšX
, -
³r¥eùiveOrigšY
);

679  
	gt
;

682 
FlßtPošt
 
	gR’d”Lay”
::
³r¥eùiveOrigš
() const

684 ià(!
»nd””
()->
hasT¿nsfÜm
())

685  
FlßtPošt
();

687 cÚ¡ 
IÁReù
 
	gbÜd”Box
 = 
toR’d”Box
(
»nd””
())->
bÜd”BoxReù
();

688 
R’d”StyË
* 
	g¡yË
 = 
»nd””
()->
¡yË
();

690  
FlßtPošt
(
¡yË
->
³r¥eùiveOrigšX
().
ÿlcFlßtV®ue
(
bÜd”Box
.
width
()),

691 
¡yË
->
³r¥eùiveOrigšY
().
ÿlcFlßtV®ue
(
bÜd”Box
.
height
()));

694 
R’d”Lay”
* 
	gR’d”Lay”
::
¡ackšgCÚ‹xt
() const

696 
R’d”Lay”
* 
Ïy”
 = 
·»Á
();

697 
	gÏy”
 && !Ïy”->
»nd””
()->
isR’d”V›w
(è&& !Ïy”->»nd””()->
isRoÙ
(è&&†ay”->»nd””()->
¡yË
()->
hasAutoZIndex
())

698 
	gÏy”
 = 
Ïy”
->
·»Á
();

699  
	gÏy”
;

702 
šlše
 
boŞ
 
isPos™iÚedCÚš”
(
R’d”Lay”
* 
Ïy”
)

704 
R’d”Objeù
* 
	go
 = 
Ïy”
->
»nd””
();

705  
	go
->
isR’d”V›w
(è|| o->
isPos™iÚed
(è|| o->
isR–Pos™iÚed
(è|| 
	gÏy”
->
hasT¿nsfÜm
();

708 
šlše
 
boŞ
 
isFixedPos™iÚedCÚš”
(
R’d”Lay”
* 
Ïy”
)

710 
R’d”Objeù
* 
	go
 = 
Ïy”
->
»nd””
();

711  
	go
->
isR’d”V›w
(è|| 
	gÏy”
->
hasT¿nsfÜm
();

714 
R’d”Lay”
* 
	gR’d”Lay”
::
’şosšgPos™iÚedAnû¡Ü
() const

716 
R’d”Lay”
* 
cu¼
 = 
·»Á
();

717 
	gcu¼
 && !
isPos™iÚedCÚš”
(
cu¼
))

718 
	gcu¼
 = 
cu¼
->
·»Á
();

720  
	gcu¼
;

723 
R’d”Lay”
* 
	gR’d”Lay”
::
’şosšgT¿nsfÜmedAnû¡Ü
() const

725 
R’d”Lay”
* 
cu¼
 = 
·»Á
();

726 
	gcu¼
 && !cu¼->
»nd””
()->
isR’d”V›w
(è&& !cu¼->
ŒªsfÜm
())

727 
	gcu¼
 = 
cu¼
->
·»Á
();

729  
	gcu¼
;

732 
šlše
 cÚ¡ 
R’d”Lay”
* 
compos™šgCÚš”
(cÚ¡ R’d”Lay”* 
Ïy”
)

734  
	gÏy”
->
isNÜm®FlowOÆy
(è?†ay”->
·»Á
(è: 
Ïy”
->
¡ackšgCÚ‹xt
();

737 #ià
USE
(
ACCELERATED_COMPOSITING
)

738 
R’d”Lay”
* 
	gR’d”Lay”
::
’şosšgCompos™šgLay”
(
boŞ
 
šşudeS–f
) const

740 ià(
šşudeS–f
 && 
isCompos™ed
())

741  
cÚ¡_ÿ¡
<
R’d”Lay”
*>(
this
);

743 cÚ¡ 
R’d”Lay”
* 
	gcu¼
 = 
compos™šgCÚš”
(
this
); cu¼; cu¼ = compos™šgCÚš”(
cu¼
)) {

744 ià(
cu¼
->
isCompos™ed
())

745  
cÚ¡_ÿ¡
<
R’d”Lay”
*>(
cu¼
);

752 
R’d”Lay”
* 
	gR’d”Lay”
::
şpšgRoÙ
() const

754 #ià
USE
(
ACCELERATED_COMPOSITING
)

755 ià(
isCompos™ed
())

756  
cÚ¡_ÿ¡
<
R’d”Lay”
*>(
this
);

759 cÚ¡ 
R’d”Lay”
* 
	gcu¼’t
 = 
this
;

760 
	gcu¼’t
) {

761 ià(
	gcu¼’t
->
»nd””
()->
isR’d”V›w
())

762  
	gcÚ¡_ÿ¡
<
	gR’d”Lay”
*>(
	gcu¼’t
);

764 
	gcu¼’t
 = 
compos™šgCÚš”
(
cu¼’t
);

765 
ASSERT
(
cu¼’t
);

766 ià(
	gcu¼’t
->
ŒªsfÜm
()

767 #ià
USE
(
ACCELERATED_COMPOSITING
)

768 || 
	gcu¼’t
->
isCompos™ed
()

771  
	gcÚ¡_ÿ¡
<
	gR’d”Lay”
*>(
	gcu¼’t
);

774 
ASSERT_NOT_REACHED
();

778 
IÁPošt
 
	gR’d”Lay”
::
absŞu‹ToCÚ‹Ás
(cÚ¡ IÁPošt& 
absŞu‹Pošt
) const

781  
roundedIÁPošt
(
»nd””
()->
absŞu‹ToLoÿl
(
absŞu‹Pošt
, 
çl£
, 
Œue
));

784 
boŞ
 
	gR’d”Lay”
::
»quœesSlowR•ašts
() const

786 ià(
isT¿n¥¬’t
(è|| 
hasReæeùiÚ
(è|| 
hasT¿nsfÜm
())

787  
Œue
;

788 ià(!
·»Á
())

789  
	gçl£
;

790  
·»Á
()->
»quœesSlowR•ašts
();

793 
boŞ
 
	gR’d”Lay”
::
isT¿n¥¬’t
() const

795 #ià
ENABLE
(
SVG
)

796 ià(
»nd””
()->
node
(è&&„’d””()->node()->
Çme¥aûURI
(è=ğ
SVGNames
::
svgName¥aûURI
)

797  
çl£
;

799  
»nd””
()->
isT¿n¥¬’t
(è||„’d””()->
hasMask
();

802 
R’d”Lay”
* 
	gR’d”Lay”
::
Œª¥¬’tPaštšgAnû¡Ü
()

804 ià(
isCompos™ed
())

807 
R’d”Lay”
* 
	gcu¼
 = 
·»Á
(); cu¼; cu¼ = 
cu¼
->parent()) {

808 ià(
cu¼
->
isCompos™ed
())

810 ià(
	gcu¼
->
isT¿n¥¬’t
())

811  
	gcu¼
;

816 
IÁReù
 
Œª¥¬’cyClBox
(cÚ¡ 
R’d”Lay”
* 
l
, cÚ¡ R’d”Lay”* 
roÙLay”
, 
PaštBehaviÜ
 
·štBehaviÜ
);

818 
ex·ndClReùFÜDesûndªtsAndReæeùiÚ
(
IÁReù
& 
şReù
, cÚ¡ 
R’d”Lay”
* 
l
, cÚ¡ R’d”Lay”* 
roÙLay”
, 
PaštBehaviÜ
 
·štBehaviÜ
)

822 ià(!
	gl
->
»nd””
()->
hasMask
()) {

825 
R’d”Lay”
* 
	gcu¼
 = 
l
->
fœ¡Chd
(); cu¼; cu¼ = 
cu¼
->
ÃxtSiblšg
()) {

826 ià(!
l
->
»æeùiÚ
(è||†->
»æeùiÚLay”
(è!ğ
cu¼
)

827 
şReù
.
un™e
(
Œª¥¬’cyClBox
(
cu¼
, 
roÙLay”
, 
·štBehaviÜ
));

835 ià(
	gl
->
»nd””
()->
hasReæeùiÚ
()) {

836 
	gd–X
 = 0;

837 
	gd–Y
 = 0;

838 
	gl
->
cÚv”tToLay”CoÜds
(
roÙLay”
, 
d–X
, 
d–Y
);

839 
	gşReù
.
move
(-
d–X
, -
d–Y
);

840 
	gşReù
.
un™e
(
l
->
»nd”Box
()->
»æeùedReù
(
şReù
));

841 
	gşReù
.
move
(
d–X
, 
d–Y
);

845 
IÁReù
 
Œª¥¬’cyClBox
(cÚ¡ 
R’d”Lay”
* 
l
, cÚ¡ R’d”Lay”* 
roÙLay”
, 
PaštBehaviÜ
 
·štBehaviÜ
)

851 ià(
	groÙLay”
 !ğ
l
 &&†->
·štsW™hT¿nsfÜm
(
·štBehaviÜ
)) {

854 
x
 = 0;

855 
	gy
 = 0;

856 
	gl
->
cÚv”tToLay”CoÜds
(
roÙLay”
, 
x
, 
y
);

858 
T¿nsfÜm©iÚM©rix
 
	gŒªsfÜm
;

859 
	gŒªsfÜm
.
Œª¦©e
(
x
, 
y
);

860 
	gŒªsfÜm
 = *
l
->
ŒªsfÜm
() *ransform;

862 
IÁReù
 
	gşReù
 = 
l
->
boundšgBox
(l);

863 
ex·ndClReùFÜDesûndªtsAndReæeùiÚ
(
şReù
, 
l
,†, 
·štBehaviÜ
);

864  
	gŒªsfÜm
.
m­Reù
(
şReù
);

867 
IÁReù
 
	gşReù
 = 
l
->
boundšgBox
(
roÙLay”
);

868 
ex·ndClReùFÜDesûndªtsAndReæeùiÚ
(
şReù
, 
l
, 
roÙLay”
, 
·štBehaviÜ
);

869  
	gşReù
;

872 
	gR’d”Lay”
::
begšT¿n¥¬’cyLay”s
(
G¿phicsCÚ‹xt
* 
p
, cÚ¡ 
R’d”Lay”
* 
roÙLay”
, 
PaštBehaviÜ
 
·štBehaviÜ
)

874 ià(
	gp
->
·štšgDi§bËd
(è|| (
·štsW™hT¿n¥¬’cy
(
·štBehaviÜ
è&& 
	gm_u£dT¿n¥¬’cy
))

877 
R’d”Lay”
* 
	gªû¡Ü
 = 
Œª¥¬’tPaštšgAnû¡Ü
();

878 ià(
	gªû¡Ü
)

879 
	gªû¡Ü
->
begšT¿n¥¬’cyLay”s
(
p
, 
roÙLay”
, 
·štBehaviÜ
);

881 ià(
·štsW™hT¿n¥¬’cy
(
·štBehaviÜ
)) {

882 
	gm_u£dT¿n¥¬’cy
 = 
Œue
;

883 
	gp
->
§ve
();

884 
IÁReù
 
	gşReù
 = 
Œª¥¬’cyClBox
(
this
, 
roÙLay”
, 
·štBehaviÜ
);

885 
	gp
->
ş
(
şReù
);

886 
	gp
->
begšT¿n¥¬’cyLay”
(
»nd””
()->
İac™y
());

887 #ifdeà
REVEAL_TRANSPARENCY_LAYERS


888 
	gp
->
£tFlCŞÜ
(
CŞÜ
(0.0f, 0.0f, 0.5f, 0.2f), 
DeviûCŞÜS·û
);

889 
	gp
->
flReù
(
şReù
);

894 * 
	gR’d”Lay”
::
İ”©Ü
 
Ãw
(
size_t
 
sz
, 
R’d”A»Ç
* 
»nd”A»Ç
è
throw
()

896  
	g»nd”A»Ç
->
®loÿ‹
(
sz
);

899 
	gR’d”Lay”
::
İ”©Ü
 
d–‘e
(* 
±r
, 
size_t
 
sz
)

902 *(
	gsize_t
 *)
	g±r
 = 
sz
;

905 
	gR’d”Lay”
::
de¡roy
(
R’d”A»Ç
* 
»nd”A»Ç
)

907 
d–‘e
 
this
;

910 
	g»nd”A»Ç
->
ä“
(*(
size_t
 *)
this
,his);

913 
	gR’d”Lay”
::
addChd
(
R’d”Lay”
* 
chd
, R’d”Lay”* 
befÜeChd
)

915 
R’d”Lay”
* 
	g´evSiblšg
 = 
befÜeChd
 ? befÜeChd->
´eviousSiblšg
(è: 
Ï¡Chd
();

916 ià(
	g´evSiblšg
) {

917 
	gchd
->
£tP»viousSiblšg
(
´evSiblšg
);

918 
	g´evSiblšg
->
£tNextSiblšg
(
chd
);

920 
£tFœ¡Chd
(
chd
);

922 ià(
	gbefÜeChd
) {

923 
	gbefÜeChd
->
£tP»viousSiblšg
(
chd
);

924 
	gchd
->
£tNextSiblšg
(
befÜeChd
);

926 
£tLa¡Chd
(
chd
);

928 
	gchd
->
£tP¬’t
(
this
);

930 ià(
	gchd
->
isNÜm®FlowOÆy
())

931 
dœtyNÜm®FlowLi¡
();

933 ià(!
	gchd
->
isNÜm®FlowOÆy
(è|| chd->
fœ¡Chd
()) {

937 
	gchd
->
dœtySckšgCÚ‹xtZOrd”Li¡s
();

940 
	gchd
->
upd©eVisib™yStus
();

941 ià(
	gchd
->
	gm_hasVisibËCÚ‹Á
 || chd->
	gm_hasVisibËDesûndªt
)

942 
chdVisib™yChªged
(
Œue
);

944 #ià
USE
(
ACCELERATED_COMPOSITING
)

945 
compos™Ü
()->
Ïy”WasAdded
(
this
, 
chd
);

949 
R’d”Lay”
* 
	gR’d”Lay”
::
»moveChd
(R’d”Lay”* 
ŞdChd
)

951 #ià
USE
(
ACCELERATED_COMPOSITING
)

952 ià(!
»nd””
()->
docum’tBešgDe¡royed
())

953 
compos™Ü
()->
Ïy”WlBeRemoved
(
this
, 
ŞdChd
);

957 ià(
	gŞdChd
->
´eviousSiblšg
())

958 
	gŞdChd
->
´eviousSiblšg
()->
£tNextSiblšg
(
ŞdChd
->
ÃxtSiblšg
());

959 ià(
	gŞdChd
->
ÃxtSiblšg
())

960 
	gŞdChd
->
ÃxtSiblšg
()->
£tP»viousSiblšg
(
ŞdChd
->
´eviousSiblšg
());

962 ià(
	gm_fœ¡
 =ğ
ŞdChd
)

963 
m_fœ¡
 = 
ŞdChd
->
ÃxtSiblšg
();

964 ià(
	gm_Ï¡
 =ğ
ŞdChd
)

965 
m_Ï¡
 = 
ŞdChd
->
´eviousSiblšg
();

967 ià(
	gŞdChd
->
isNÜm®FlowOÆy
())

968 
dœtyNÜm®FlowLi¡
();

969 ià(!
	gŞdChd
->
isNÜm®FlowOÆy
(è|| oldChd->
fœ¡Chd
()) {

973 
	gŞdChd
->
dœtySckšgCÚ‹xtZOrd”Li¡s
();

976 
	gŞdChd
->
£tP»viousSiblšg
(0);

977 
	gŞdChd
->
£tNextSiblšg
(0);

978 
	gŞdChd
->
£tP¬’t
(0);

980 
	gŞdChd
->
upd©eVisib™yStus
();

981 ià(
	gŞdChd
->
	gm_hasVisibËCÚ‹Á
 || oldChd->
	gm_hasVisibËDesûndªt
)

982 
chdVisib™yChªged
(
çl£
);

984  
	gŞdChd
;

987 
	gR’d”Lay”
::
»moveOÆyThisLay”
()

989 ià(!
m_·»Á
)

994 
	gm_»nd””
->
£tHasLay”
(
çl£
);

996 #ià
USE
(
ACCELERATED_COMPOSITING
)

997 
compos™Ü
()->
Ïy”WlBeRemoved
(
m_·»Á
, 
this
);

1001 
ş—rClReùsInşudšgDesûndªts
();

1004 
R’d”Lay”
* 
	g·»Á
 = 
m_·»Á
;

1005 
R’d”Lay”
* 
	gÃxtSib
 = 
ÃxtSiblšg
();

1006 
	g·»Á
->
»moveChd
(
this
);

1008 ià(
»æeùiÚ
())

1009 
»moveChd
(
»æeùiÚLay”
());

1012 
R’d”Lay”
* 
	gcu¼’t
 = 
m_fœ¡
;

1013 
	gcu¼’t
) {

1014 
R’d”Lay”
* 
	gÃxt
 = 
cu¼’t
->
ÃxtSiblšg
();

1015 
»moveChd
(
cu¼’t
);

1016 
	g·»Á
->
addChd
(
cu¼’t
, 
ÃxtSib
);

1017 
	gcu¼’t
->
upd©eLay”Pos™iÚs
();

1018 
	gcu¼’t
 = 
Ãxt
;

1021 
	gm_»nd””
->
de¡royLay”
();

1024 
	gR’d”Lay”
::
š£¹OÆyThisLay”
()

1026 ià(!
m_·»Á
 && 
»nd””
()->
·»Á
()) {

1029 
R’d”Lay”
* 
·»ÁLay”
 = 
»nd””
()->
·»Á
()->
’şosšgLay”
();

1030 
ASSERT
(
·»ÁLay”
);

1031 
R’d”Lay”
* 
	gbefÜeChd
 = 
·»ÁLay”
->
»æeùiÚLay”
(è!ğ
this
 ? 
»nd””
()->
·»Á
()->
fšdNextLay”
(parentLayer,„enderer()) : 0;

1032 
	g·»ÁLay”
->
addChd
(
this
, 
befÜeChd
);

1036 
R’d”Objeù
* 
	gcu¼
 = 
»nd””
()->
fœ¡Chd
(); cu¼; cu¼ = 
cu¼
->
ÃxtSiblšg
())

1037 
cu¼
->
moveLay”s
(
m_·»Á
, 
this
);

1040 
ş—rClReùsInşudšgDesûndªts
();

1044 
	gR’d”Lay”
::
cÚv”tToLay”CoÜds
(cÚ¡ 
R’d”Lay”
* 
ªû¡ÜLay”
, & 
xPos
, & 
yPos
) const

1046 ià(
	gªû¡ÜLay”
 =ğ
this
)

1049 
EPos™iÚ
 
	gpos™iÚ
 = 
»nd””
()->
¡yË
()->
pos™iÚ
();

1050 ià(
	gpos™iÚ
 =ğ
FixedPos™iÚ
 && (!
ªû¡ÜLay”
 ||‡nû¡ÜLay” =ğ
»nd””
()->
v›w
()->
Ïy”
())) {

1053 
FlßtPošt
 
absPos
 = 
»nd””
()->
loÿlToAbsŞu‹
(FlßtPošt(), 
Œue
);

1054 
	gxPos
 +ğ
absPos
.
x
();

1055 
	gyPos
 +ğ
absPos
.
y
();

1059 ià(
	gpos™iÚ
 =ğ
FixedPos™iÚ
) {

1063 
R’d”Lay”
* 
fixedPos™iÚCÚš”Lay”
 = 0;

1064 
boŞ
 
	gfoundAnû¡Ü
 = 
çl£
;

1065 
R’d”Lay”
* 
	gcu¼Lay”
 = 
·»Á
(); cu¼Lay”; cu¼Lay” = 
cu¼Lay”
->parent()) {

1066 ià(
cu¼Lay”
 =ğ
ªû¡ÜLay”
)

1067 
foundAnû¡Ü
 = 
Œue
;

1069 ià(
isFixedPos™iÚedCÚš”
(
cu¼Lay”
)) {

1070 
	gfixedPos™iÚCÚš”Lay”
 = 
cu¼Lay”
;

1071 
ASSERT
(
foundAnû¡Ü
);

1076 
ASSERT
(
fixedPos™iÚCÚš”Lay”
);

1078 ià(
	gfixedPos™iÚCÚš”Lay”
 !ğ
ªû¡ÜLay”
) {

1079 
fixedCÚš”X
 = 0;

1080 
	gfixedCÚš”Y
 = 0;

1081 
cÚv”tToLay”CoÜds
(
fixedPos™iÚCÚš”Lay”
, 
fixedCÚš”X
, 
fixedCÚš”Y
);

1083 
	gªû¡ÜX
 = 0;

1084 
	gªû¡ÜY
 = 0;

1085 
	gªû¡ÜLay”
->
cÚv”tToLay”CoÜds
(
fixedPos™iÚCÚš”Lay”
, 
ªû¡ÜX
, 
ªû¡ÜY
);

1087 
	gxPos
 +ğ(
fixedCÚš”X
 - 
ªû¡ÜX
);

1088 
	gyPos
 +ğ(
fixedCÚš”Y
 - 
ªû¡ÜY
);

1093 
R’d”Lay”
* 
	g·»ÁLay”
;

1094 ià(
	gpos™iÚ
 =ğ
AbsŞu‹Pos™iÚ
 || 
pos™iÚ
 =ğ
FixedPos™iÚ
) {

1096 
·»ÁLay”
 = 
·»Á
();

1097 
boŞ
 
	gfoundAnû¡ÜFœ¡
 = 
çl£
;

1098 
	g·»ÁLay”
) {

1099 ià(
isPos™iÚedCÚš”
(
·»ÁLay”
))

1102 ià(
	g·»ÁLay”
 =ğ
ªû¡ÜLay”
) {

1103 
foundAnû¡ÜFœ¡
 = 
Œue
;

1107 
	g·»ÁLay”
 = 
·»ÁLay”
->
·»Á
();

1110 ià(
	gfoundAnû¡ÜFœ¡
) {

1113 
R’d”Lay”
* 
	gpos™iÚedAnû¡Ü
 = 
·»ÁLay”
->
’şosšgPos™iÚedAnû¡Ü
();

1115 
	gthisX
 = 0;

1116 
	gthisY
 = 0;

1117 
cÚv”tToLay”CoÜds
(
pos™iÚedAnû¡Ü
, 
thisX
, 
thisY
);

1119 
	gªû¡ÜX
 = 0;

1120 
	gªû¡ÜY
 = 0;

1121 
	gªû¡ÜLay”
->
cÚv”tToLay”CoÜds
(
pos™iÚedAnû¡Ü
, 
ªû¡ÜX
, 
ªû¡ÜY
);

1123 
	gxPos
 +ğ(
thisX
 - 
ªû¡ÜX
);

1124 
	gyPos
 +ğ(
thisY
 - 
ªû¡ÜY
);

1128 
	g·»ÁLay”
 = 
·»Á
();

1130 ià(!
	g·»ÁLay”
)

1133 
	g·»ÁLay”
->
cÚv”tToLay”CoÜds
(
ªû¡ÜLay”
, 
xPos
, 
yPos
);

1135 
	gxPos
 +ğ
x
();

1136 
	gyPos
 +ğ
y
();

1139 
šlše
 
adju¡edSüŞlD–
(
begšnšgD–
) {

1142 cÚ¡ 
	g¥“dReduûr
 = 12;

1144 
	gadju¡edD–
 = 
begšnšgD–
 / 
¥“dReduûr
;

1145 ià(
	gadju¡edD–
 > 1)

1146 
	gadju¡edD–
 = 
¡©ic_ÿ¡
<>(
adju¡edD–
 * 
sq¹
(static_cast<>(adjustedDelta))) - 1;

1147 ià(
	gadju¡edD–
 < -1)

1148 
	gadju¡edD–
 = 
¡©ic_ÿ¡
<>(
adju¡edD–
 * 
sq¹
(static_cast<>(-adjustedDelta))) + 1;

1150  
	gadju¡edD–
;

1153 
	gR’d”Lay”
::
·nSüŞlFromPošt
(cÚ¡ 
IÁPošt
& 
sourûPošt
)

1155 
F¿me
* 
äame
 = 
»nd””
()->
docum’t
()->frame();

1156 ià(!
	gäame
)

1159 
IÁPošt
 
	gcu¼’tMou£Pos™iÚ
 = 
äame
->
ev’tHªdËr
()->
cu¼’tMou£Pos™iÚ
();

1162 
IÁPošt
 
	g´eviousMou£Pos™iÚ
;

1163 ià(
	gcu¼’tMou£Pos™iÚ
.
x
(è< 0 || cu¼’tMou£Pos™iÚ.
y
() < 0)

1164 
	gcu¼’tMou£Pos™iÚ
 = 
´eviousMou£Pos™iÚ
;

1166 
	g´eviousMou£Pos™iÚ
 = 
cu¼’tMou£Pos™iÚ
;

1168 
	gxD–
 = 
cu¼’tMou£Pos™iÚ
.
x
(è- 
sourûPošt
.x();

1169 
	gyD–
 = 
cu¼’tMou£Pos™iÚ
.
y
(è- 
sourûPošt
.y();

1171 ià(
abs
(
xD–
è<ğ
SüŞlV›w
::
noPªSüŞlRadius
)

1172 
xD–
 = 0;

1173 ià(
abs
(
yD–
è<ğ
SüŞlV›w
::
noPªSüŞlRadius
)

1174 
yD–
 = 0;

1176 
süŞlByRecursiv–y
(
adju¡edSüŞlD–
(
xD–
),‡dju¡edSüŞlD–(
yD–
));

1179 
	gR’d”Lay”
::
süŞlByRecursiv–y
(
xD–
, 
yD–
)

1181 ià(!
	gxD–
 && !
	gyD–
)

1184 
boŞ
 
	g»¡riùedByLšeCÏmp
 = 
çl£
;

1185 ià(
»nd””
()->
·»Á
())

1186 
	g»¡riùedByLšeCÏmp
 = !
»nd””
()->
·»Á
()->
¡yË
()->
lšeCÏmp
().
isNÚe
();

1188 ià(
»nd””
()->
hasOv”æowCl
(è&& !
	g»¡riùedByLšeCÏmp
) {

1189 
	gÃwOff£tX
 = 
süŞlXOff£t
(è+ 
xD–
;

1190 
	gÃwOff£tY
 = 
süŞlYOff£t
(è+ 
yD–
;

1191 
süŞlToOff£t
(
ÃwOff£tX
, 
ÃwOff£tY
);

1194 
	gËáToSüŞlX
 = 
ÃwOff£tX
 - 
süŞlXOff£t
();

1195 
	gËáToSüŞlY
 = 
ÃwOff£tY
 - 
süŞlYOff£t
();

1196 ià((
	gËáToSüŞlX
 || 
	gËáToSüŞlY
è&& 
»nd””
()->
·»Á
()) {

1197 
R’d”Objeù
* 
	gÃxtR’d””
 = 
»nd””
()->
·»Á
();

1198 
	gÃxtR’d””
) {

1199 ià(
	gÃxtR’d””
->
isBox
(è&& 
toR’d”Box
(
ÃxtR’d””
)->
ÿnBeSüŞËdAndHasSüŞÏbËA»a
()) {

1200 
	gÃxtR’d””
->
’şosšgLay”
()->
süŞlByRecursiv–y
(
ËáToSüŞlX
, 
ËáToSüŞlY
);

1203 
	gÃxtR’d””
 = 
ÃxtR’d””
->
·»Á
();

1206 
F¿me
* 
	gäame
 = 
»nd””
()->
docum’t
()->
äame
();

1207 ià(
	gäame
)

1208 
	gäame
->
ev’tHªdËr
()->
upd©eAutosüŞlR’d””
();

1210 } ià(
»nd””
()->
v›w
()->
äameV›w
()) {

1213 
»nd””
()->
v›w
()->
äameV›w
()->
süŞlBy
(
IÁSize
(
xD–
, 
yD–
));

1219 
	gR’d”Lay”
::
süŞlToOff£t
(
x
, 
y
, 
boŞ
 
upd©eSüŞlb¬s
, boŞ 
»·št
)

1221 
R’d”Box
* 
	gbox
 = 
»nd”Box
();

1222 ià(!
	gbox
)

1225 ià(
	gbox
->
¡yË
()->
ov”æowX
(è!ğ
OMARQUEE
) {

1226 ià(
x
 < 0) x = 0;

1227 ià(
	gy
 < 0) y = 0;

1231 
	gmaxX
 = 
süŞlWidth
(è- 
box
->
ş›ÁWidth
();

1232 
	gmaxY
 = 
süŞlHeight
(è- 
box
->
ş›ÁHeight
();

1234 ià(
	gx
 > 
	gmaxX
èx = 
maxX
;

1235 ià(
	gy
 > 
	gmaxY
èy = 
maxY
;

1243 
	gÃwSüŞlX
 = 
x
 - 
m_süŞlOrigšX
;

1244 ià(
	gm_süŞlY
 =ğ
y
 && 
m_süŞlX
 =ğ
ÃwSüŞlX
)

1246 
	gm_süŞlX
 = 
ÃwSüŞlX
;

1247 
	gm_süŞlY
 = 
y
;

1251 
R’d”Lay”
* 
	gchd
 = 
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
())

1252 
chd
->
upd©eLay”Pos™iÚs
(0);

1254 #ià
USE
(
ACCELERATED_COMPOSITING
)

1255 ià(
compos™Ü
()->
šCompos™šgMode
()) {

1258 ià(
R’d”Lay”
* 
	gcompos™šgAnû¡Ü
 = 
¡ackšgCÚ‹xt
()->
’şosšgCompos™šgLay”
()) {

1259 
boŞ
 
isUpd©eRoÙ
 = 
Œue
;

1260 
	gcompos™šgAnû¡Ü
->
backšg
()->
upd©eAá”Layout
(
R’d”Lay”Backšg
::
AÎDesûndªts
, 
isUpd©eRoÙ
);

1265 
R’d”V›w
* 
	gv›w
 = 
»nd””
()->
v›w
();

1268 
ASSERT
(
v›w
);

1269 ià(
	gv›w
) {

1270 #ià
ENABLE
(
DASHBOARD_SUPPORT
)

1273 
	gv›w
->
äameV›w
()->
upd©eDashbßrdRegiÚs
();

1276 
	gv›w
->
upd©eWidg‘Pos™iÚs
();

1279 
R’d”BoxMod–Objeù
* 
	g»·štCÚš”
 = 
»nd””
()->
cÚš”FÜR•ašt
();

1280 
IÁReù
 
	g»ùFÜR•ašt
 = 
»nd””
()->
ş³dOv”æowReùFÜR•ašt
(
»·štCÚš”
);

1282 
F¿me
* 
	gäame
 = 
»nd””
()->
docum’t
()->
äame
();

1283 ià(
	gäame
) {

1285 
	gäame
->
£ËùiÚ
()->
£tN“dsLayout
();

1287 
FlßtQuad
 
	gquadFÜFakeMou£MoveEv’t
 = FlßtQuad(
»ùFÜR•ašt
);

1288 ià(
	g»·štCÚš”
)

1289 
	gquadFÜFakeMou£MoveEv’t
 = 
»·štCÚš”
->
loÿlToAbsŞu‹Quad
(
quadFÜFakeMou£MoveEv’t
);

1290 
	gäame
->
ev’tHªdËr
()->
di¥©chFakeMou£MoveEv’tSoÚInQuad
(
quadFÜFakeMou£MoveEv’t
);

1294 ià(
	gv›w
 && 
	g»·št
)

1295 
»nd””
()->
»·štUsšgCÚš”
(
»·štCÚš”
, 
»ùFÜR•ašt
);

1297 ià(
	gupd©eSüŞlb¬s
) {

1298 ià(
	gm_hB¬
)

1299 
	gm_hB¬
->
£tV®ue
(
süŞlXOff£t
());

1300 ià(
	gm_vB¬
)

1301 
	gm_vB¬
->
£tV®ue
(
m_süŞlY
);

1305 ià(
	gv›w
) {

1306 ià(
F¿meV›w
* 
	gäameV›w
 = 
v›w
->
äameV›w
())

1307 
äameV›w
->
scheduËEv’t
(
Ev’t
::
ü—‹
(
ev’tNames
().
süŞlEv’t
, 
çl£
, f®£), 
»nd””
()->
node
());

1311 
	gR’d”Lay”
::
süŞlReùToVisibË
(cÚ¡ 
IÁReù
 &
»ù
, 
boŞ
 
süŞlToAnchÜ
, cÚ¡ 
SüŞlAlignm’t
& 
®ignX
, cÚ¡ SüŞlAlignm’t& 
®ignY
)

1313 
R’d”Lay”
* 
	g·»ÁLay”
 = 0;

1314 
IÁReù
 
	gÃwReù
 = 
»ù
;

1315 
	gxOff£t
 = 0, 
	gyOff£t
 = 0;

1319 
F¿meV›w
* 
	gäameV›w
 = 
»nd””
()->
docum’t
()->
v›w
();

1320 ià(
	gäameV›w
)

1321 
	gäameV›w
->
·u£ScheduËdEv’ts
();

1323 
boŞ
 
	g»¡riùedByLšeCÏmp
 = 
çl£
;

1324 ià(
»nd””
()->
·»Á
()) {

1325 
	g·»ÁLay”
 = 
»nd””
()->
·»Á
()->
’şosšgLay”
();

1326 
	g»¡riùedByLšeCÏmp
 = !
»nd””
()->
·»Á
()->
¡yË
()->
lšeCÏmp
().
isNÚe
();

1329 ià(
»nd””
()->
hasOv”æowCl
(è&& !
	g»¡riùedByLšeCÏmp
) {

1332 
R’d”Box
* 
	gbox
 = 
»nd”Box
();

1333 
ASSERT
(
box
);

1334 
FlßtPošt
 
	gabsPos
 = 
box
->
loÿlToAbsŞu‹
();

1335 
	gabsPos
.
move
(
box
->
bÜd”Leá
(), box->
bÜd”Tİ
());

1337 
IÁReù
 
	gÏy”Bounds
 = IÁReù(
absPos
.
x
(è+ 
süŞlXOff£t
(),‡bsPos.
y
(è+ 
süŞlYOff£t
(), 
box
->
ş›ÁWidth
(), box->
ş›ÁHeight
());

1338 
IÁReù
 
	gexpo£Reù
 = IÁReù(
»ù
.
x
(è+ 
süŞlXOff£t
(),„eù.
y
(è+ 
süŞlYOff£t
(),„eù.
width
(),„eù.
height
());

1339 
IÁReù
 
	gr
 = 
g‘ReùToExpo£
(
Ïy”Bounds
, 
expo£Reù
, 
®ignX
, 
®ignY
);

1341 
	gxOff£t
 = 
r
.
x
(è- 
absPos
.x();

1342 
	gyOff£t
 = 
r
.
y
(è- 
absPos
.y();

1344 
	gxOff£t
 = 
max
(0, 
mš
(
süŞlWidth
(è- 
Ïy”Bounds
.
width
(), 
xOff£t
));

1345 
	gyOff£t
 = 
max
(0, 
mš
(
süŞlHeight
(è- 
Ïy”Bounds
.
height
(), 
yOff£t
));

1347 ià(
	gxOff£t
 !ğ
süŞlXOff£t
(è|| 
yOff£t
 !ğ
süŞlYOff£t
()) {

1348 
diffX
 = 
süŞlXOff£t
();

1349 
	gdiffY
 = 
süŞlYOff£t
();

1350 
süŞlToOff£t
(
xOff£t
, 
yOff£t
);

1351 
	gdiffX
 = 
süŞlXOff£t
(è- 
diffX
;

1352 
	gdiffY
 = 
süŞlYOff£t
(è- 
diffY
;

1353 
	gÃwReù
.
£tX
(
»ù
.
x
(è- 
diffX
);

1354 
	gÃwReù
.
£tY
(
»ù
.
y
(è- 
diffY
);

1356 } ià(!
	g·»ÁLay”
 && 
»nd””
()->
isBox
(è&& 
»nd”Box
()->
ÿnBeProg¿m©iÿÎySüŞËd
(
süŞlToAnchÜ
)) {

1357 ià(
	gäameV›w
) {

1358 ià(
»nd””
()->
docum’t
(è&&„’d””()->docum’t()->
owÃrEËm’t
() &&„enderer()->document()->ownerElement()->renderer()) {

1359 
IÁReù
 
	gv›wReù
 = 
äameV›w
->
visibËCÚ‹ÁReù
();

1360 
IÁReù
 
	gr
 = 
g‘ReùToExpo£
(
v›wReù
, 
»ù
, 
®ignX
, 
®ignY
);

1362 
	gxOff£t
 = 
r
.
x
();

1363 
	gyOff£t
 = 
r
.
y
();

1365 
	gxOff£t
 = 
max
(0, 
mš
(
äameV›w
->
cÚ‹ÁsWidth
(), 
xOff£t
));

1366 
	gyOff£t
 = 
max
(0, 
mš
(
äameV›w
->
cÚ‹ÁsHeight
(), 
yOff£t
));

1368 
	gäameV›w
->
£tSüŞlPos™iÚ
(
IÁPošt
(
xOff£t
, 
yOff£t
));

1369 
	g·»ÁLay”
 = 
»nd””
()->
docum’t
()->
owÃrEËm’t
()->»nd””()->
’şosšgLay”
();

1370 
	gÃwReù
.
£tX
(
»ù
.
x
(è- 
äameV›w
->
süŞlX
() + frameView->x());

1371 
	gÃwReù
.
£tY
(
»ù
.
y
(è- 
äameV›w
->
süŞlY
() + frameView->y());

1373 
IÁReù
 
	gv›wReù
 = 
äameV›w
->
visibËCÚ‹ÁReù
(
Œue
);

1374 
IÁReù
 
	gr
 = 
g‘ReùToExpo£
(
v›wReù
, 
»ù
, 
®ignX
, 
®ignY
);

1378 
	gäameV›w
->
süŞlReùIÁoV›wRecursiv–y
(
r
);

1383 ià(
	g·»ÁLay”
)

1384 
	g·»ÁLay”
->
süŞlReùToVisibË
(
ÃwReù
, 
süŞlToAnchÜ
, 
®ignX
, 
®ignY
);

1386 ià(
	gäameV›w
)

1387 
	gäameV›w
->
»sumeScheduËdEv’ts
();

1390 
IÁReù
 
	gR’d”Lay”
::
g‘ReùToExpo£
(cÚ¡ IÁReù &
visibËReù
, cÚ¡ IÁReù &
expo£Reù
, cÚ¡ 
SüŞlAlignm’t
& 
®ignX
, cÚ¡ SüŞlAlignm’t& 
®ignY
)

1393 
SüŞlBehaviÜ
 
	gsüŞlX
;

1394 
IÁReù
 
expo£ReùX
(
expo£Reù
.
x
(), 
visibËReù
.
y
(),ƒxpo£Reù.
width
(), visibËReù.
height
());

1395 
	gš‹r£ùWidth
 = 
š‹r£ùiÚ
(
visibËReù
, 
expo£ReùX
).
width
();

1396 ià(
	gš‹r£ùWidth
 =ğ
expo£Reù
.
width
(è|| 
š‹r£ùWidth
 >ğ
MIN_INTERSECT_FOR_REVEAL
)

1400 
süŞlX
 = 
SüŞlAlignm’t
::
g‘VisibËBehaviÜ
(
®ignX
);

1401 ià(
	gš‹r£ùWidth
 =ğ
visibËReù
.
width
()) {

1403 
süŞlX
 = 
SüŞlAlignm’t
::
g‘VisibËBehaviÜ
(
®ignX
);

1404 ià(
	gsüŞlX
 =ğ
®ignC’‹r
)

1405 
süŞlX
 = 
noSüŞl
;

1406 } ià(
	gš‹r£ùWidth
 > 0)

1408 
	gsüŞlX
 = 
SüŞlAlignm’t
::
g‘P¬tŸlBehaviÜ
(
®ignX
);

1410 
	gsüŞlX
 = 
SüŞlAlignm’t
::
g‘Hidd’BehaviÜ
(
®ignX
);

1413 ià(
	gsüŞlX
 =ğ
®ignToClo£¡Edge
 && 
expo£Reù
.
right
(è> 
visibËReù
.right(è&&ƒxpo£Reù.
width
() < visibleRect.width())

1414 
süŞlX
 = 
®ignRight
;

1417 
	gx
;

1418 ià(
	gsüŞlX
 =ğ
noSüŞl
)

1419 
x
 = 
visibËReù
.x();

1420 ià(
	gsüŞlX
 =ğ
®ignRight
)

1421 
x
 = 
expo£Reù
.
right
(è- 
visibËReù
.
width
();

1422 ià(
	gsüŞlX
 =ğ
®ignC’‹r
)

1423 
x
 = 
expo£Reù
.x(è+ (expo£Reù.
width
(è- 
visibËReù
.width()) / 2;

1425 
	gx
 = 
expo£Reù
.
x
();

1428 
SüŞlBehaviÜ
 
	gsüŞlY
;

1429 
IÁReù
 
expo£ReùY
(
visibËReù
.
x
(), 
expo£Reù
.
y
(), visibËReù.
width
(),ƒxpo£Reù.
height
());

1430 
	gš‹r£ùHeight
 = 
š‹r£ùiÚ
(
visibËReù
, 
expo£ReùY
).
height
();

1431 ià(
	gš‹r£ùHeight
 =ğ
expo£Reù
.
height
())

1433 
süŞlY
 = 
SüŞlAlignm’t
::
g‘VisibËBehaviÜ
(
®ignY
);

1434 ià(
	gš‹r£ùHeight
 =ğ
visibËReù
.
height
()) {

1436 
süŞlY
 = 
SüŞlAlignm’t
::
g‘VisibËBehaviÜ
(
®ignY
);

1437 ià(
	gsüŞlY
 =ğ
®ignC’‹r
)

1438 
süŞlY
 = 
noSüŞl
;

1439 } ià(
	gš‹r£ùHeight
 > 0)

1441 
	gsüŞlY
 = 
SüŞlAlignm’t
::
g‘P¬tŸlBehaviÜ
(
®ignY
);

1443 
	gsüŞlY
 = 
SüŞlAlignm’t
::
g‘Hidd’BehaviÜ
(
®ignY
);

1446 ià(
	gsüŞlY
 =ğ
®ignToClo£¡Edge
 && 
expo£Reù
.
bÙtom
(è> 
visibËReù
.bÙtom(è&&ƒxpo£Reù.
height
() < visibleRect.height())

1447 
süŞlY
 = 
®ignBÙtom
;

1450 
	gy
;

1451 ià(
	gsüŞlY
 =ğ
noSüŞl
)

1452 
y
 = 
visibËReù
.y();

1453 ià(
	gsüŞlY
 =ğ
®ignBÙtom
)

1454 
y
 = 
expo£Reù
.
bÙtom
(è- 
visibËReù
.
height
();

1455 ià(
	gsüŞlY
 =ğ
®ignC’‹r
)

1456 
y
 = 
expo£Reù
.y(è+ (expo£Reù.
height
(è- 
visibËReù
.height()) / 2;

1458 
	gy
 = 
expo£Reù
.
y
();

1460  
IÁReù
(
IÁPošt
(
x
, 
y
), 
visibËReù
.
size
());

1463 
	gR’d”Lay”
::
autosüŞl
()

1465 
F¿me
* 
äame
 = 
»nd””
()->
docum’t
()->frame();

1466 ià(!
	gäame
)

1469 
F¿meV›w
* 
	gäameV›w
 = 
äame
->
v›w
();

1470 ià(!
	gäameV›w
)

1473 #ià
ENABLE
(
DRAG_SUPPORT
)

1474 
	gäame
->
ev’tHªdËr
()->
upd©eS–eùiÚFÜMou£D¿g
();

1477 
IÁPošt
 
	gcu¼’tDocum’tPos™iÚ
 = 
äameV›w
->
wšdowToCÚ‹Ás
(
äame
->
ev’tHªdËr
()->
cu¼’tMou£Pos™iÚ
());

1478 
süŞlReùToVisibË
(
IÁReù
(
cu¼’tDocum’tPos™iÚ
, 
IÁSize
(1, 1)), 
çl£
, 
SüŞlAlignm’t
::
®ignToEdgeIfN“ded
, ScrollAlignment::alignToEdgeIfNeeded);

1481 
	gR’d”Lay”
::
»size
(cÚ¡ 
PÏtfÜmMou£Ev’t
& 
evt
, cÚ¡ 
IÁSize
& 
ŞdOff£t
)

1484 ià(!
šResizeMode
(è|| !
»nd””
()->
hasOv”æowCl
(è|| !»nd””()->
node
())

1489 
EËm’t
* 
	g–em’t
 = 
¡©ic_ÿ¡
<EËm’t*>(
»nd””
()->
node
()->
shadowAnû¡ÜNode
());

1490 
R’d”Box
* 
	g»nd””
 = 
toR’d”Box
(
–em’t
->
»nd””
());

1492 
EResize
 
	g»size
 = 
»nd””
->
¡yË
()->
»size
();

1493 ià(
	g»size
 =ğ
RESIZE_NONE
)

1496 
Docum’t
* 
	gdocum’t
 = 
–em’t
->
docum’t
();

1497 ià(!
	gdocum’t
->
äame
()->
ev’tHªdËr
()->
mou£P»s£d
())

1500 
	gzoomFaùÜ
 = 
»nd””
->
¡yË
()->
efãùiveZoom
();

1502 
IÁSize
 
	gÃwOff£t
 = 
off£tFromResizeCÜÃr
(
docum’t
->
v›w
()->
wšdowToCÚ‹Ás
(
evt
.
pos
()));

1503 
	gÃwOff£t
.
£tWidth
(
ÃwOff£t
.
width
(è/ 
zoomFaùÜ
);

1504 
	gÃwOff£t
.
£tHeight
(
ÃwOff£t
.
height
(è/ 
zoomFaùÜ
);

1506 
IÁSize
 
	gcu¼’tSize
 = IÁSize(
»nd””
->
width
(è/ 
zoomFaùÜ
,„’d””->
height
() / zoomFactor);

1507 
IÁSize
 
	gmšimumSize
 = 
–em’t
->
mšimumSizeFÜResizšg
().
shrunkTo
(
cu¼’tSize
);

1508 
	g–em’t
->
£tMšimumSizeFÜResizšg
(
mšimumSize
);

1510 
IÁSize
 
	gadju¡edOldOff£t
 = IÁSize(
ŞdOff£t
.
width
(è/ 
zoomFaùÜ
, oldOff£t.
height
() / zoomFactor);

1512 
IÁSize
 
	gdifã»nû
 = (
cu¼’tSize
 + 
ÃwOff£t
 - 
adju¡edOldOff£t
).
ex·ndedTo
(
mšimumSize
) - currentSize;

1514 
CSSStyËDeş¬©iÚ
* 
	g¡yË
 = 
–em’t
->
¡yË
();

1515 
boŞ
 
	gisBoxSizšgBÜd”
 = 
»nd””
->
¡yË
()->
boxSizšg
(è=ğ
BORDER_BOX
;

1517 
Exû±iÚCode
 
	gec
;

1519 ià(
	g»size
 !ğ
RESIZE_VERTICAL
 && 
difã»nû
.
width
()) {

1520 ià(
–em’t
->
isFÜmCÚŒŞEËm’t
()) {

1522 
¡yË
->
£tPrİ”ty
(
CSSPrİ”tyM¬gšLeá
, 
SŒšg
::
numb”
(
»nd””
->
m¬gšLeá
(è/ 
zoomFaùÜ
è+ "px", 
çl£
, 
ec
);

1523 
	g¡yË
->
£tPrİ”ty
(
CSSPrİ”tyM¬gšRight
, 
SŒšg
::
numb”
(
»nd””
->
m¬gšRight
(è/ 
zoomFaùÜ
è+ "px", 
çl£
, 
ec
);

1525 
	gba£Width
 = 
»nd””
->
width
(è- (
isBoxSizšgBÜd”
 ? 0

1526 : 
»nd””
->
bÜd”Leá
(è+„’d””->
·ddšgLeá
(è+„’d””->
bÜd”Right
(è+„’d””->
·ddšgRight
());

1527 
	gba£Width
 = 
ba£Width
 / 
zoomFaùÜ
;

1528 
	g¡yË
->
£tPrİ”ty
(
CSSPrİ”tyWidth
, 
SŒšg
::
numb”
(
ba£Width
 + 
difã»nû
.
width
()è+ "px", 
çl£
, 
ec
);

1531 ià(
	g»size
 !ğ
RESIZE_HORIZONTAL
 && 
difã»nû
.
height
()) {

1532 ià(
–em’t
->
isFÜmCÚŒŞEËm’t
()) {

1534 
¡yË
->
£tPrİ”ty
(
CSSPrİ”tyM¬gšTİ
, 
SŒšg
::
numb”
(
»nd””
->
m¬gšTİ
(è/ 
zoomFaùÜ
è+ "px", 
çl£
, 
ec
);

1535 
	g¡yË
->
£tPrİ”ty
(
CSSPrİ”tyM¬gšBÙtom
, 
SŒšg
::
numb”
(
»nd””
->
m¬gšBÙtom
(è/ 
zoomFaùÜ
è+ "px", 
çl£
, 
ec
);

1537 
	gba£Height
 = 
»nd””
->
height
(è- (
isBoxSizšgBÜd”
 ? 0

1538 : 
»nd””
->
bÜd”Tİ
(è+„’d””->
·ddšgTİ
(è+„’d””->
bÜd”BÙtom
(è+„’d””->
·ddšgBÙtom
());

1539 
	gba£Height
 = 
ba£Height
 / 
zoomFaùÜ
;

1540 
	g¡yË
->
£tPrİ”ty
(
CSSPrİ”tyHeight
, 
SŒšg
::
numb”
(
ba£Height
 + 
difã»nû
.
height
()è+ "px", 
çl£
, 
ec
);

1543 
	gdocum’t
->
upd©eLayout
();

1548 
	gR’d”Lay”
::
v®ueChªged
(
SüŞlb¬
*)

1552 
boŞ
 
ÃedUpd©e
 = 
çl£
;

1553 
	gÃwX
 = 
süŞlXOff£t
();

1554 
	gÃwY
 = 
m_süŞlY
;

1556 ià(
	gm_hB¬
) {

1557 
	gÃwX
 = 
m_hB¬
->
v®ue
();

1558 ià(
	gÃwX
 !ğ
süŞlXOff£t
())

1559 
ÃedUpd©e
 = 
Œue
;

1562 ià(
	gm_vB¬
) {

1563 
	gÃwY
 = 
m_vB¬
->
v®ue
();

1564 ià(
	gÃwY
 !ğ
m_süŞlY
)

1565 
ÃedUpd©e
 = 
Œue
;

1568 ià(
	gÃedUpd©e
)

1569 
süŞlToOff£t
(
ÃwX
, 
ÃwY
, 
çl£
);

1572 
boŞ
 
	gR’d”Lay”
::
isAùive
() const

1574 
Page
* 
·ge
 = 
»nd””
()->
docum’t
()->
äame
()->page();

1575  
	g·ge
 &&…age->
focusCÚŒŞËr
()->
isAùive
();

1579 
IÁReù
 
cÜÃrReù
(cÚ¡ 
R’d”Lay”
* 
Ïy”
, cÚ¡ IÁReù& 
bounds
)

1581 
	ghÜizÚlThickÃss
;

1582 
	gv”tiÿlThickÃss
;

1583 ià(!
	gÏy”
->
v”tiÿlSüŞlb¬
(è&& !Ïy”->
hÜizÚlSüŞlb¬
()) {

1586 
	ghÜizÚlThickÃss
 = 
SüŞlb¬Theme
::
ÇtiveTheme
()->
süŞlb¬ThickÃss
();

1587 
	gv”tiÿlThickÃss
 = 
hÜizÚlThickÃss
;

1588 } ià(
	gÏy”
->
v”tiÿlSüŞlb¬
(è&& !Ïy”->
hÜizÚlSüŞlb¬
()) {

1589 
	ghÜizÚlThickÃss
 = 
Ïy”
->
v”tiÿlSüŞlb¬
()->
width
();

1590 
	gv”tiÿlThickÃss
 = 
hÜizÚlThickÃss
;

1591 } ià(
	gÏy”
->
hÜizÚlSüŞlb¬
(è&& !Ïy”->
v”tiÿlSüŞlb¬
()) {

1592 
	gv”tiÿlThickÃss
 = 
Ïy”
->
hÜizÚlSüŞlb¬
()->
height
();

1593 
	ghÜizÚlThickÃss
 = 
v”tiÿlThickÃss
;

1595 
	ghÜizÚlThickÃss
 = 
Ïy”
->
v”tiÿlSüŞlb¬
()->
width
();

1596 
	gv”tiÿlThickÃss
 = 
Ïy”
->
hÜizÚlSüŞlb¬
()->
height
();

1598  
IÁReù
(
bounds
.
right
(è- 
hÜizÚlThickÃss
 - 
Ïy”
->
»nd””
()->
¡yË
()->
bÜd”RightWidth
(),

1599 
bounds
.
bÙtom
(è- 
v”tiÿlThickÃss
 - 
Ïy”
->
»nd””
()->
¡yË
()->
bÜd”BÙtomWidth
(),

1600 
hÜizÚlThickÃss
, 
v”tiÿlThickÃss
);

1603 
IÁReù
 
süŞlCÜÃrReù
(cÚ¡ 
R’d”Lay”
* 
Ïy”
, cÚ¡ IÁReù& 
bounds
)

1609 
boŞ
 
	ghasHÜizÚlB¬
 = 
Ïy”
->
hÜizÚlSüŞlb¬
();

1610 
boŞ
 
	ghasV”tiÿlB¬
 = 
Ïy”
->
v”tiÿlSüŞlb¬
();

1611 
boŞ
 
	ghasResiz”
 = 
Ïy”
->
»nd””
()->
¡yË
()->
»size
(è!ğ
RESIZE_NONE
;

1612 ià((
	ghasHÜizÚlB¬
 && 
	ghasV”tiÿlB¬
è|| (
	ghasResiz”
 && (hasHorizontalBar || hasVerticalBar)))

1613  
cÜÃrReù
(
Ïy”
, 
bounds
);

1614  
IÁReù
();

1617 
IÁReù
 
»siz”CÜÃrReù
(cÚ¡ 
R’d”Lay”
* 
Ïy”
, cÚ¡ IÁReù& 
bounds
)

1619 
ASSERT
(
Ïy”
->
»nd””
()->
isBox
());

1620 ià(
	gÏy”
->
»nd””
()->
¡yË
()->
»size
(è=ğ
RESIZE_NONE
)

1621  
IÁReù
();

1622  
cÜÃrReù
(
Ïy”
, 
bounds
);

1625 
boŞ
 
	gR’d”Lay”
::
süŞlb¬CÜÃrP»£Á
() const

1627 
ASSERT
(
»nd””
()->
isBox
());

1628  !
süŞlCÜÃrReù
(
this
, 
»nd”Box
()->
bÜd”BoxReù
()).
isEm±y
();

1631 
IÁReù
 
	gR’d”Lay”
::
cÚv”tFromSüŞlb¬ToCÚššgV›w
(cÚ¡ 
SüŞlb¬
* 
süŞlb¬
, cÚ¡ IÁReù& 
süŞlb¬Reù
) const

1633 
R’d”V›w
* 
	gv›w
 = 
»nd””
()->
v›w
();

1634 ià(!
	gv›w
)

1635  
	gsüŞlb¬Reù
;

1637 
IÁReù
 
	g»ù
 = 
süŞlb¬Reù
;

1638 
	g»ù
.
move
(
süŞlb¬Off£t
(
süŞlb¬
));

1640  
	gv›w
->
äameV›w
()->
cÚv”tFromR’d””
(
»nd””
(), 
»ù
);

1643 
IÁReù
 
	gR’d”Lay”
::
cÚv”tFromCÚššgV›wToSüŞlb¬
(cÚ¡ 
SüŞlb¬
* 
süŞlb¬
, cÚ¡ IÁReù& 
·»ÁReù
) const

1645 
R’d”V›w
* 
	gv›w
 = 
»nd””
()->
v›w
();

1646 ià(!
	gv›w
)

1647  
	g·»ÁReù
;

1649 
IÁReù
 
	g»ù
 = 
v›w
->
äameV›w
()->
cÚv”tToR’d””
(
»nd””
(), 
·»ÁReù
);

1650 
	g»ù
.
move
(-
süŞlb¬Off£t
(
süŞlb¬
));

1651  
	g»ù
;

1654 
IÁPošt
 
	gR’d”Lay”
::
cÚv”tFromSüŞlb¬ToCÚššgV›w
(cÚ¡ 
SüŞlb¬
* 
süŞlb¬
, cÚ¡ IÁPošt& 
süŞlb¬Pošt
) const

1656 
R’d”V›w
* 
	gv›w
 = 
»nd””
()->
v›w
();

1657 ià(!
	gv›w
)

1658  
	gsüŞlb¬Pošt
;

1660 
IÁPošt
 
	gpošt
 = 
süŞlb¬Pošt
;

1661 
	gpošt
.
move
(
süŞlb¬Off£t
(
süŞlb¬
));

1662  
	gv›w
->
äameV›w
()->
cÚv”tFromR’d””
(
»nd””
(), 
pošt
);

1665 
IÁPošt
 
	gR’d”Lay”
::
cÚv”tFromCÚššgV›wToSüŞlb¬
(cÚ¡ 
SüŞlb¬
* 
süŞlb¬
, cÚ¡ IÁPošt& 
·»ÁPošt
) const

1667 
R’d”V›w
* 
	gv›w
 = 
»nd””
()->
v›w
();

1668 ià(!
	gv›w
)

1669  
	g·»ÁPošt
;

1671 
IÁPošt
 
	gpošt
 = 
v›w
->
äameV›w
()->
cÚv”tToR’d””
(
»nd””
(), 
·»ÁPošt
);

1673 
	gpošt
.
move
(-
süŞlb¬Off£t
(
süŞlb¬
));

1674  
	gpošt
;

1677 
IÁSize
 
	gR’d”Lay”
::
süŞlb¬Off£t
(cÚ¡ 
SüŞlb¬
* 
süŞlb¬
) const

1679 
R’d”Box
* 
box
 = 
»nd”Box
();

1681 ià(
	gsüŞlb¬
 =ğ
m_vB¬
.
g‘
())

1682  
IÁSize
(
box
->
width
(è- box->
bÜd”Right
(è- 
süŞlb¬
->width(), box->
bÜd”Tİ
());

1684 ià(
	gsüŞlb¬
 =ğ
m_hB¬
.
g‘
())

1685  
IÁSize
(
box
->
bÜd”Leá
(), box->
height
(è- box->
bÜd”BÙtom
(è- 
süŞlb¬
->height());

1687 
ASSERT_NOT_REACHED
();

1688  
IÁSize
();

1691 
	gR’d”Lay”
::
šv®id©eSüŞlb¬Reù
(
SüŞlb¬
* 
süŞlb¬
, cÚ¡ 
IÁReù
& 
»ù
)

1693 
IÁReù
 
	gsüŞlReù
 = 
»ù
;

1694 
R’d”Box
* 
	gbox
 = 
»nd”Box
();

1695 
ASSERT
(
box
);

1696 ià(
	gsüŞlb¬
 =ğ
m_vB¬
.
g‘
())

1697 
süŞlReù
.
move
(
box
->
width
(è- box->
bÜd”Right
(è- 
süŞlb¬
->width(), box->
bÜd”Tİ
());

1699 
	gsüŞlReù
.
move
(
box
->
bÜd”Leá
(), box->
height
(è- box->
bÜd”BÙtom
(è- 
süŞlb¬
->height());

1700 
»nd””
()->
»·štReùªgË
(
süŞlReù
);

1703 
	gPassRefPŒ
<
	gSüŞlb¬
> 
	gR’d”Lay”
::
ü—‹SüŞlb¬
(
SüŞlb¬Or›Á©iÚ
 
Ü›Á©iÚ
)

1705 
RefPŒ
<
SüŞlb¬
> 
widg‘
;

1706 
R’d”Objeù
* 
	gaùu®R’d””
 = 
»nd””
()->
node
(è?„’d””()->node()->
shadowAnû¡ÜNode
()->renderer() :„enderer();

1707 
boŞ
 
	ghasCu¡omSüŞlb¬StyË
 = 
aùu®R’d””
->
isBox
(è&&‡ùu®R’d””->
¡yË
()->
hasP£udoStyË
(
SCROLLBAR
);

1708 ià(
	ghasCu¡omSüŞlb¬StyË
)

1709 
	gwidg‘
 = 
R’d”SüŞlb¬
::
ü—‹Cu¡omSüŞlb¬
(
this
, 
Ü›Á©iÚ
, 
toR’d”Box
(
aùu®R’d””
));

1711 
	gwidg‘
 = 
SüŞlb¬
::
ü—‹N©iveSüŞlb¬
(
this
, 
Ü›Á©iÚ
, 
ReguÏrSüŞlb¬
);

1712 
»nd””
()->
docum’t
()->
v›w
()->
addChd
(
widg‘
.
g‘
());

1713  
	gwidg‘
.
»Ëa£
();

1716 
	gR’d”Lay”
::
de¡roySüŞlb¬
(
SüŞlb¬Or›Á©iÚ
 
Ü›Á©iÚ
)

1718 
RefPŒ
<
SüŞlb¬
>& 
süŞlb¬
 = 
Ü›Á©iÚ
 =ğ
HÜizÚlSüŞlb¬
 ? 
m_hB¬
 : 
m_vB¬
;

1719 ià(
	gsüŞlb¬
) {

1720 
	gsüŞlb¬
->
»moveFromP¬’t
();

1721 
	gsüŞlb¬
->
£tCl›Á
(0);

1722 
	gsüŞlb¬
 = 0;

1726 
	gR’d”Lay”
::
£tHasHÜizÚlSüŞlb¬
(
boŞ
 
hasSüŞlb¬
)

1728 ià(
hasSüŞlb¬
 =ğ(
m_hB¬
 != 0))

1731 ià(
	ghasSüŞlb¬
)

1732 
	gm_hB¬
 = 
ü—‹SüŞlb¬
(
HÜizÚlSüŞlb¬
);

1734 
de¡roySüŞlb¬
(
HÜizÚlSüŞlb¬
);

1737 ià(
	gm_hB¬
)

1738 
	gm_hB¬
->
¡yËChªged
();

1739 ià(
	gm_vB¬
)

1740 
	gm_vB¬
->
¡yËChªged
();

1742 #ià
ENABLE
(
DASHBOARD_SUPPORT
)

1744 ià(
»nd””
()->
docum’t
()->
hasDashbßrdRegiÚs
())

1745 
»nd””
()->
docum’t
()->
£tDashbßrdRegiÚsDœty
(
Œue
);

1749 
	gR’d”Lay”
::
£tHasV”tiÿlSüŞlb¬
(
boŞ
 
hasSüŞlb¬
)

1751 ià(
hasSüŞlb¬
 =ğ(
m_vB¬
 != 0))

1754 ià(
	ghasSüŞlb¬
)

1755 
	gm_vB¬
 = 
ü—‹SüŞlb¬
(
V”tiÿlSüŞlb¬
);

1757 
de¡roySüŞlb¬
(
V”tiÿlSüŞlb¬
);

1760 ià(
	gm_hB¬
)

1761 
	gm_hB¬
->
¡yËChªged
();

1762 ià(
	gm_vB¬
)

1763 
	gm_vB¬
->
¡yËChªged
();

1765 #ià
ENABLE
(
DASHBOARD_SUPPORT
)

1767 ià(
»nd””
()->
docum’t
()->
hasDashbßrdRegiÚs
())

1768 
»nd””
()->
docum’t
()->
£tDashbßrdRegiÚsDœty
(
Œue
);

1772 
	gR’d”Lay”
::
v”tiÿlSüŞlb¬Width
() const

1774 ià(!
m_vB¬
)

1776  
	gm_vB¬
->
width
();

1779 
	gR’d”Lay”
::
hÜizÚlSüŞlb¬Height
() const

1781 ià(!
m_hB¬
)

1783  
	gm_hB¬
->
height
();

1786 
IÁSize
 
	gR’d”Lay”
::
off£tFromResizeCÜÃr
(cÚ¡ 
IÁPošt
& 
absŞu‹Pošt
) const

1789 
IÁPošt
 
bÙtomRight
(
width
(), 
height
());

1790 
IÁPošt
 
	gloÿlPošt
 = 
absŞu‹ToCÚ‹Ás
(
absŞu‹Pošt
);

1791  
	gloÿlPošt
 - 
	gbÙtomRight
;

1794 
boŞ
 
	gR’d”Lay”
::
hasOv”æowCÚŒŞs
() const

1796  
m_hB¬
 || 
m_vB¬
 || 
m_süŞlCÜÃr
 || 
»nd””
()->
¡yË
()->
»size
(è!ğ
RESIZE_NONE
;

1799 
	gR’d”Lay”
::
pos™iÚOv”æowCÚŒŞs
(
tx
, 
ty
)

1801 ià(!
	gm_hB¬
 && !
	gm_vB¬
 && (!
»nd””
()->
hasOv”æowCl
(è||„’d””()->
¡yË
()->
»size
(è=ğ
RESIZE_NONE
))

1804 
R’d”Box
* 
	gbox
 = 
»nd”Box
();

1805 ià(!
	gbox
)

1808 
IÁReù
 
	gbÜd”Box
 = 
box
->
bÜd”BoxReù
();

1809 
IÁReù
 
süŞlCÜÃr
(
süŞlCÜÃrReù
(
this
, 
bÜd”Box
));

1810 
IÁReù
 
absBounds
(
bÜd”Box
.
x
(è+ 
tx
, bÜd”Box.
y
(è+ 
ty
, bÜd”Box.
width
(), bÜd”Box.
height
());

1811 ià(
	gm_vB¬
)

1812 
	gm_vB¬
->
£tF¿meReù
(
IÁReù
(
absBounds
.
right
(è- 
box
->
bÜd”Right
(è- 
m_vB¬
->
width
(),

1813 
absBounds
.
y
(è+ 
box
->
bÜd”Tİ
(),

1814 
m_vB¬
->
width
(),

1815 
absBounds
.
height
(è- (
box
->
bÜd”Tİ
(è+ box->
bÜd”BÙtom
()è- 
süŞlCÜÃr
.height()));

1817 ià(
	gm_hB¬
)

1818 
	gm_hB¬
->
£tF¿meReù
(
IÁReù
(
absBounds
.
x
(è+ 
box
->
bÜd”Leá
(),

1819 
absBounds
.
bÙtom
(è- 
box
->
bÜd”BÙtom
(è- 
m_hB¬
->
height
(),

1820 
absBounds
.
width
(è- (
box
->
bÜd”Leá
(è+ box->
bÜd”Right
()è- 
süŞlCÜÃr
.width(),

1821 
m_hB¬
->
height
()));

1823 ià(
	gm_süŞlCÜÃr
)

1824 
	gm_süŞlCÜÃr
->
£tF¿meReù
(
süŞlCÜÃr
);

1825 ià(
	gm_»siz”
)

1826 
	gm_»siz”
->
£tF¿meReù
(
»siz”CÜÃrReù
(
this
, 
bÜd”Box
));

1829 
	gR’d”Lay”
::
süŞlWidth
()

1831 ià(
m_süŞlDim’siÚsDœty
)

1832 
compu‹SüŞlDim’siÚs
();

1833  
	gm_süŞlWidth
;

1836 
	gR’d”Lay”
::
süŞlHeight
()

1838 ià(
m_süŞlDim’siÚsDœty
)

1839 
compu‹SüŞlDim’siÚs
();

1840  
	gm_süŞlHeight
;

1843 
	gR’d”Lay”
::
compu‹SüŞlDim’siÚs
(
boŞ
* 
ÃedHB¬
, boŞ* 
ÃedVB¬
)

1845 
R’d”Box
* 
	gbox
 = 
»nd”Box
();

1846 
ASSERT
(
box
);

1848 
	gm_süŞlDim’siÚsDœty
 = 
çl£
;

1850 
boŞ
 
	gÉr
 = 
»nd””
()->
¡yË
()->
dœeùiÚ
(è=ğ
LTR
;

1852 
	gş›ÁWidth
 = 
box
->
ş›ÁWidth
();

1853 
	gş›ÁHeight
 = 
box
->
ş›ÁHeight
();

1855 
	gm_süŞlLeáOv”æow
 = 
Ér
 ? 0 : 
mš
(0, 
box
->
Ëámo¡Pos™iÚ
(
Œue
, 
çl£
è- box->
bÜd”Leá
());

1857 
	grightPos
 = 
Ér
 ?

1858 
box
->
rightmo¡Pos™iÚ
(
Œue
, 
çl£
è- 
	gbox
->
bÜd”Leá
() :

1859 
ş›ÁWidth
 - 
m_süŞlLeáOv”æow
;

1860 
	gbÙtomPos
 = 
box
->
lowe¡Pos™iÚ
(
Œue
, 
çl£
è- 
	gbox
->
bÜd”Tİ
();

1862 
	gm_süŞlWidth
 = 
max
(
rightPos
, 
ş›ÁWidth
);

1863 
	gm_süŞlHeight
 = 
max
(
bÙtomPos
, 
ş›ÁHeight
);

1865 
	gm_süŞlOrigšX
 = 
Ér
 ? 0 : 
m_süŞlWidth
 - 
ş›ÁWidth
;

1867 ià(
	gÃedHB¬
)

1868 *
	gÃedHB¬
 = 
rightPos
 > 
ş›ÁWidth
;

1869 ià(
	gÃedVB¬
)

1870 *
	gÃedVB¬
 = 
bÙtomPos
 > 
ş›ÁHeight
;

1873 
	gR’d”Lay”
::
upd©eOv”æowStus
(
boŞ
 
hÜizÚlOv”æow
, boŞ 
v”tiÿlOv”æow
)

1875 ià(
	gm_ov”æowStusDœty
) {

1876 
	gm_hÜizÚlOv”æow
 = 
hÜizÚlOv”æow
;

1877 
	gm_v”tiÿlOv”æow
 = 
v”tiÿlOv”æow
;

1878 
	gm_ov”æowStusDœty
 = 
çl£
;

1883 
boŞ
 
	ghÜizÚlOv”æowChªged
 = (
m_hÜizÚlOv”æow
 !ğ
hÜizÚlOv”æow
);

1884 
boŞ
 
	gv”tiÿlOv”æowChªged
 = (
m_v”tiÿlOv”æow
 !ğ
v”tiÿlOv”æow
);

1886 ià(
	ghÜizÚlOv”æowChªged
 || 
	gv”tiÿlOv”æowChªged
) {

1887 
	gm_hÜizÚlOv”æow
 = 
hÜizÚlOv”æow
;

1888 
	gm_v”tiÿlOv”æow
 = 
v”tiÿlOv”æow
;

1890 ià(
F¿meV›w
* 
	gäameV›w
 = 
»nd””
()->
docum’t
()->
v›w
()) {

1891 
äameV›w
->
scheduËEv’t
(
Ov”æowEv’t
::
ü—‹
(
hÜizÚlOv”æowChªged
, 
hÜizÚlOv”æow
, 
v”tiÿlOv”æowChªged
, 
v”tiÿlOv”æow
),

1892 
»nd””
()->
node
());

1898 
	gR’d”Lay”
::
upd©eSüŞlInfoAá”Layout
()

1900 
R’d”Box
* 
box
 = 
»nd”Box
();

1901 ià(!
	gbox
)

1904 
	gm_süŞlDim’siÚsDœty
 = 
Œue
;

1906 
boŞ
 
	ghÜizÚlOv”æow
, 
	gv”tiÿlOv”æow
;

1907 
compu‹SüŞlDim’siÚs
(&
hÜizÚlOv”æow
, &
v”tiÿlOv”æow
);

1909 ià(
	gbox
->
¡yË
()->
ov”æowX
(è!ğ
OMARQUEE
) {

1912 
ÃwX
 = 
max
(0, 
mš
(
süŞlXOff£t
(), 
süŞlWidth
(è- 
box
->
ş›ÁWidth
()));

1913 
	gÃwY
 = 
max
(0, 
mš
(
m_süŞlY
, 
süŞlHeight
(è- 
box
->
ş›ÁHeight
()));

1914 ià(
	gÃwX
 !ğ
süŞlXOff£t
(è|| 
ÃwY
 !ğ
m_süŞlY
) {

1915 
R’d”V›w
* 
v›w
 = 
»nd””
()->view();

1916 
ASSERT
(
v›w
);

1920 ià(
	gv›w
)

1921 
	gv›w
->
di§bËLayoutS‹
();

1922 
süŞlToOff£t
(
ÃwX
, 
ÃwY
);

1923 ià(
	gv›w
)

1924 
	gv›w
->
’abËLayoutS‹
();

1928 
boŞ
 
	ghaveHÜizÚlB¬
 = 
m_hB¬
;

1929 
boŞ
 
	ghaveV”tiÿlB¬
 = 
m_vB¬
;

1932 ià(
»nd””
()->
¡yË
()->
ov”æowX
(è=ğ
OSCROLL
)

1933 
m_hB¬
->
£tEÇbËd
(
hÜizÚlOv”æow
);

1934 ià(
»nd””
()->
¡yË
()->
ov”æowY
(è=ğ
OSCROLL
)

1935 
m_vB¬
->
£tEÇbËd
(
v”tiÿlOv”æow
);

1939 ià(
»nd””
()->
¡yË
()->
ov”æowX
(è=ğ
OHIDDEN
 && 
haveHÜizÚlB¬
)

1940 
£tHasHÜizÚlSüŞlb¬
(
çl£
);

1941 ià(
»nd””
()->
¡yË
()->
ov”æowY
(è=ğ
OHIDDEN
 && 
haveV”tiÿlB¬
)

1942 
£tHasV”tiÿlSüŞlb¬
(
çl£
);

1945 
boŞ
 
	gsüŞlb¬sChªged
 = (
box
->
hasAutoHÜizÚlSüŞlb¬
(è&& 
haveHÜizÚlB¬
 !ğ
hÜizÚlOv”æow
) ||

1946 (
box
->
hasAutoV”tiÿlSüŞlb¬
(è&& 
haveV”tiÿlB¬
 !ğ
v”tiÿlOv”æow
);

1947 ià(
	gsüŞlb¬sChªged
) {

1948 ià(
	gbox
->
hasAutoHÜizÚlSüŞlb¬
())

1949 
£tHasHÜizÚlSüŞlb¬
(
hÜizÚlOv”æow
);

1950 ià(
	gbox
->
hasAutoV”tiÿlSüŞlb¬
())

1951 
£tHasV”tiÿlSüŞlb¬
(
v”tiÿlOv”æow
);

1953 #ià
ENABLE
(
DASHBOARD_SUPPORT
)

1955 ià(
»nd””
()->
docum’t
()->
hasDashbßrdRegiÚs
())

1956 
»nd””
()->
docum’t
()->
£tDashbßrdRegiÚsDœty
(
Œue
);

1959 
»nd””
()->
»·št
();

1961 ià(
»nd””
()->
¡yË
()->
ov”æowX
(è=ğ
OAUTO
 ||„’d””()->¡yË()->
ov”æowY
() == OAUTO) {

1962 ià(!
m_šOv”æowR–ayout
) {

1964 
m_šOv”æowR–ayout
 = 
Œue
;

1965 
»nd””
()->
£tN“dsLayout
(
Œue
, 
çl£
);

1966 ià(
»nd””
()->
isR’d”Block
())

1967 
toR’d”Block
(
»nd””
())->
ÏyoutBlock
(
Œue
);

1969 
»nd””
()->
Ïyout
();

1970 
	gm_šOv”æowR–ayout
 = 
çl£
;

1976 ià(
	gm_hB¬
 && 
	gbox
->
hasAutoHÜizÚlSüŞlb¬
())

1977 
	gm_hB¬
->
£tEÇbËd
(
Œue
);

1978 ià(
	gm_vB¬
 && 
	gbox
->
hasAutoV”tiÿlSüŞlb¬
())

1979 
	gm_vB¬
->
£tEÇbËd
(
Œue
);

1982 ià(
	gm_hB¬
) {

1983 
	gş›ÁWidth
 = 
box
->
ş›ÁWidth
();

1984 
	g·geS‹p
 = 
max
(max<>(
ş›ÁWidth
 * 
SüŞlb¬
::
mšF¿ùiÚToS‹pWh’Pagšg
(), cl›ÁWidth - SüŞlb¬::
maxOv”ÏpB‘w“nPages
()), 1);

1985 
	gm_hB¬
->
£tS‹ps
(
SüŞlb¬
::
pix–sP”LšeS‹p
(), 
·geS‹p
);

1986 
	gm_hB¬
->
£tPrİÜtiÚ
(
ş›ÁWidth
, 
m_süŞlWidth
);

1995 
	gm_hB¬
->
£tV®ue
(
süŞlXOff£t
());

1997 ià(
	gm_vB¬
) {

1998 
	gş›ÁHeight
 = 
box
->
ş›ÁHeight
();

1999 
	g·geS‹p
 = 
max
(max<>(
ş›ÁHeight
 * 
SüŞlb¬
::
mšF¿ùiÚToS‹pWh’Pagšg
(), cl›ÁHeighˆ- SüŞlb¬::
maxOv”ÏpB‘w“nPages
()), 1);

2000 
	gm_vB¬
->
£tS‹ps
(
SüŞlb¬
::
pix–sP”LšeS‹p
(), 
·geS‹p
);

2001 
	gm_vB¬
->
£tPrİÜtiÚ
(
ş›ÁHeight
, 
m_süŞlHeight
);

2004 ià(
»nd””
()->
node
(è&&„’d””()->
docum’t
()->
hasLi¡’”Ty³
(
Docum’t
::
OVERFLOWCHANGED_LISTENER
))

2005 
upd©eOv”æowStus
(
hÜizÚlOv”æow
, 
v”tiÿlOv”æow
);

2008 
	gR’d”Lay”
::
·štOv”æowCÚŒŞs
(
G¿phicsCÚ‹xt
* 
cÚ‹xt
, 
tx
, 
ty
, cÚ¡ 
IÁReù
& 
damageReù
)

2011 ià(!
»nd””
()->
hasOv”æowCl
())

2017 
pos™iÚOv”æowCÚŒŞs
(
tx
, 
ty
);

2020 ià(
	gm_hB¬
)

2021 
	gm_hB¬
->
·št
(
cÚ‹xt
, 
damageReù
);

2022 ià(
	gm_vB¬
)

2023 
	gm_vB¬
->
·št
(
cÚ‹xt
, 
damageReù
);

2027 
·štSüŞlCÜÃr
(
cÚ‹xt
, 
tx
, 
ty
, 
damageReù
);

2030 
·štResiz”
(
cÚ‹xt
, 
tx
, 
ty
, 
damageReù
);

2033 
	gR’d”Lay”
::
·štSüŞlCÜÃr
(
G¿phicsCÚ‹xt
* 
cÚ‹xt
, 
tx
, 
ty
, cÚ¡ 
IÁReù
& 
damageReù
)

2035 
R’d”Box
* 
	gbox
 = 
»nd”Box
();

2036 
ASSERT
(
box
);

2038 
IÁReù
 
	gcÜÃrReù
 = 
süŞlCÜÃrReù
(
this
, 
box
->
bÜd”BoxReù
());

2039 
IÁReù
 
	gabsReù
 = IÁReù(
cÜÃrReù
.
x
(è+ 
tx
, cÜÃrReù.
y
(è+ 
ty
, cÜÃrReù.
width
(), cÜÃrReù.
height
());

2040 ià(!
	gabsReù
.
š‹r£ùs
(
damageReù
))

2043 ià(
	gcÚ‹xt
->
upd©šgCÚŒŞTšts
()) {

2044 
upd©eSüŞlCÜÃrStyË
();

2048 ià(
	gm_süŞlCÜÃr
) {

2049 
	gm_süŞlCÜÃr
->
·štIÁoReù
(
cÚ‹xt
, 
tx
, 
ty
, 
absReù
);

2053 
	gcÚ‹xt
->
flReù
(
absReù
, 
CŞÜ
::
wh™e
, 
box
->
¡yË
()->
cŞÜS·û
());

2056 
	gR’d”Lay”
::
·štResiz”
(
G¿phicsCÚ‹xt
* 
cÚ‹xt
, 
tx
, 
ty
, cÚ¡ 
IÁReù
& 
damageReù
)

2058 ià(
»nd””
()->
¡yË
()->
»size
(è=ğ
RESIZE_NONE
)

2061 
R’d”Box
* 
	gbox
 = 
»nd”Box
();

2062 
ASSERT
(
box
);

2064 
IÁReù
 
	gcÜÃrReù
 = 
»siz”CÜÃrReù
(
this
, 
box
->
bÜd”BoxReù
());

2065 
IÁReù
 
	gabsReù
 = IÁReù(
cÜÃrReù
.
x
(è+ 
tx
, cÜÃrReù.
y
(è+ 
ty
, cÜÃrReù.
width
(), cÜÃrReù.
height
());

2066 ià(!
	gabsReù
.
š‹r£ùs
(
damageReù
))

2069 ià(
	gcÚ‹xt
->
upd©šgCÚŒŞTšts
()) {

2070 
upd©eResiz”StyË
();

2074 ià(
	gm_»siz”
) {

2075 
	gm_»siz”
->
·štIÁoReù
(
cÚ‹xt
, 
tx
, 
ty
, 
absReù
);

2080 
DEFINE_STATIC_LOCAL
(
RefPŒ
<
Image
>, 
»sizeCÜÃrImage
, (Image::
lßdPÏtfÜmResourû
("textAreaResizeCorner")));

2081 
IÁPošt
 
imagePošt
(
absReù
.
right
(è- 
»sizeCÜÃrImage
->
width
(),‡bsReù.
bÙtom
(è-„esizeCÜÃrImage->
height
());

2082 
	gcÚ‹xt
->
d¿wImage
(
»sizeCÜÃrImage
.
g‘
(), 
box
->
¡yË
()->
cŞÜS·û
(), 
imagePošt
);

2086 ià(
	gm_hB¬
 || 
	gm_vB¬
) {

2087 
	gcÚ‹xt
->
§ve
();

2088 
	gcÚ‹xt
->
ş
(
absReù
);

2089 
IÁReù
 
	gÏrg”CÜÃr
 = 
absReù
;

2090 
	gÏrg”CÜÃr
.
£tSize
(
IÁSize
(
Ïrg”CÜÃr
.
width
(è+ 1,†¬g”CÜÃr.
height
() + 1));

2091 
	gcÚ‹xt
->
£tSŒokeCŞÜ
(
CŞÜ
(
makeRGB
(217, 217, 217)), 
DeviûCŞÜS·û
);

2092 
	gcÚ‹xt
->
£tSŒokeThickÃss
(1.0f);

2093 
	gcÚ‹xt
->
£tFlCŞÜ
(
CŞÜ
::
Œª¥¬’t
, 
DeviûCŞÜS·û
);

2094 
	gcÚ‹xt
->
d¿wReù
(
Ïrg”CÜÃr
);

2095 
	gcÚ‹xt
->
»¡Üe
();

2099 
boŞ
 
	gR’d”Lay”
::
isPoštInResizeCÚŒŞ
(cÚ¡ 
IÁPošt
& 
absŞu‹Pošt
) const

2101 ià(!
»nd””
()->
hasOv”æowCl
(è||„’d””()->
¡yË
()->
»size
(è=ğ
RESIZE_NONE
)

2102  
çl£
;

2104 
R’d”Box
* 
	gbox
 = 
»nd”Box
();

2105 
ASSERT
(
box
);

2107 
IÁPošt
 
	gloÿlPošt
 = 
absŞu‹ToCÚ‹Ás
(
absŞu‹Pošt
);

2109 
IÁReù
 
loÿlBounds
(0, 0, 
box
->
width
(), box->
height
());

2110  
»siz”CÜÃrReù
(
this
, 
loÿlBounds
).
cÚšs
(
loÿlPošt
);

2113 
boŞ
 
	gR’d”Lay”
::
h™Te¡Ov”æowCÚŒŞs
(
H™Te¡ResuÉ
& 
»suÉ
, cÚ¡ 
IÁPošt
& 
loÿlPošt
)

2115 ià(!
	gm_hB¬
 && !
	gm_vB¬
 && (!
»nd””
()->
hasOv”æowCl
(è||„’d””()->
¡yË
()->
»size
(è=ğ
RESIZE_NONE
))

2116  
çl£
;

2118 
R’d”Box
* 
	gbox
 = 
»nd”Box
();

2119 
ASSERT
(
box
);

2121 
IÁReù
 
	g»sizeCÚŒŞReù
;

2122 ià(
»nd””
()->
¡yË
()->
»size
(è!ğ
RESIZE_NONE
) {

2123 
»sizeCÚŒŞReù
 = 
»siz”CÜÃrReù
(
this
, 
box
->
bÜd”BoxReù
());

2124 ià(
	g»sizeCÚŒŞReù
.
cÚšs
(
loÿlPošt
))

2125  
	gŒue
;

2128 
	g»sizeCÚŒŞSize
 = 
max
(
»sizeCÚŒŞReù
.
height
(), 0);

2130 ià(
	gm_vB¬
) {

2131 
IÁReù
 
vB¬Reù
(
box
->
width
(è- box->
bÜd”Right
(è- 
m_vB¬
->width(),

2132 
box
->
bÜd”Tİ
(),

2133 
m_vB¬
->
width
(),

2134 
box
->
height
(è- (box->
bÜd”Tİ
(è+ box->
bÜd”BÙtom
()è- (
m_hB¬
 ? m_hB¬->height(è: 
»sizeCÚŒŞSize
));

2135 ià(
	gvB¬Reù
.
cÚšs
(
loÿlPošt
)) {

2136 
	g»suÉ
.
£tSüŞlb¬
(
m_vB¬
.
g‘
());

2137  
	gŒue
;

2141 
	g»sizeCÚŒŞSize
 = 
max
(
»sizeCÚŒŞReù
.
width
(), 0);

2142 ià(
	gm_hB¬
) {

2143 
IÁReù
 
hB¬Reù
(
box
->
bÜd”Leá
(),

2144 
box
->
height
(è- box->
bÜd”BÙtom
(è- 
m_hB¬
->height(),

2145 
box
->
width
(è- (box->
bÜd”Leá
(è+ box->
bÜd”Right
()è- (
m_vB¬
 ? m_vB¬->width(è: 
»sizeCÚŒŞSize
),

2146 
m_hB¬
->
height
());

2147 ià(
	ghB¬Reù
.
cÚšs
(
loÿlPošt
)) {

2148 
	g»suÉ
.
£tSüŞlb¬
(
m_hB¬
.
g‘
());

2149  
	gŒue
;

2153  
	gçl£
;

2156 
boŞ
 
	gR’d”Lay”
::
süŞl
(
SüŞlDœeùiÚ
 
dœeùiÚ
, 
SüŞlG¿nuÏr™y
 
g¿nuÏr™y
, 
muÉl›r
)

2158 
boŞ
 
	gdidHÜizÚlSüŞl
 = 
çl£
;

2159 
boŞ
 
	gdidV”tiÿlSüŞl
 = 
çl£
;

2161 ià(
	gm_hB¬
) {

2162 ià(
	gg¿nuÏr™y
 =ğ
SüŞlByDocum’t
) {

2165 
didHÜizÚlSüŞl
 = 
m_hB¬
->
süŞl
(
SüŞlLeá
, 
SüŞlByDocum’t
, 
muÉl›r
);

2167 
	gdidHÜizÚlSüŞl
 = 
m_hB¬
->
süŞl
(
dœeùiÚ
, 
g¿nuÏr™y
, 
muÉl›r
);

2170 ià(
	gm_vB¬
)

2171 
	gdidV”tiÿlSüŞl
 = 
m_vB¬
->
süŞl
(
dœeùiÚ
, 
g¿nuÏr™y
, 
muÉl›r
);

2173  (
	gdidHÜizÚlSüŞl
 || 
	gdidV”tiÿlSüŞl
);

2176 
	gR’d”Lay”
::
·št
(
G¿phicsCÚ‹xt
* 
p
, cÚ¡ 
IÁReù
& 
damageReù
, 
PaštBehaviÜ
 
·štBehaviÜ
, 
R’d”Objeù
 *
·štšgRoÙ
)

2178 
	gR’d”Objeù
::
Ov”ÏpTe¡Reque¡M­
 
ov”ÏpTe¡Reque¡s
;

2179 
·štLay”
(
this
, 
p
, 
damageReù
, 
·štBehaviÜ
, 
·štšgRoÙ
, &
ov”ÏpTe¡Reque¡s
);

2180 
	gR’d”Objeù
::
Ov”ÏpTe¡Reque¡M­
::
™”©Ü
 
’d
 = 
ov”ÏpTe¡Reque¡s
.end();

2181 
	gR’d”Objeù
::
Ov”ÏpTe¡Reque¡M­
::
™”©Ü
 
™
 = 
ov”ÏpTe¡Reque¡s
.
begš
(); 
	g™
 !ğ
’d
; ++it)

2182 
	g™
->
	gfœ¡
->
£tOv”ÏpTe¡ResuÉ
(
çl£
);

2185 
£tCl
(
G¿phicsCÚ‹xt
* 
p
, cÚ¡ 
IÁReù
& 
·štDœtyReù
, cÚ¡ IÁReù& 
şReù
)

2187 ià(
	g·štDœtyReù
 =ğ
şReù
)

2189 
	gp
->
§ve
();

2190 
	gp
->
ş
(
şReù
);

2193 
»¡ÜeCl
(
G¿phicsCÚ‹xt
* 
p
, cÚ¡ 
IÁReù
& 
·štDœtyReù
, cÚ¡ IÁReù& 
şReù
)

2195 ià(
	g·štDœtyReù
 =ğ
şReù
)

2197 
	gp
->
»¡Üe
();

2200 
³rfÜmOv”ÏpTe¡s
(
R’d”Objeù
::
Ov”ÏpTe¡Reque¡M­
& 
ov”ÏpTe¡Reque¡s
, cÚ¡ 
IÁReù
& 
Ïy”Bounds
)

2202 
	gVeùÜ
<
	gOv”ÏpTe¡Reque¡Cl›Á
*> 
	gov”ÏµedReque¡Cl›Ás
;

2203 
	gR’d”Objeù
::
Ov”ÏpTe¡Reque¡M­
::
™”©Ü
 
’d
 = 
ov”ÏpTe¡Reque¡s
.end();

2204 
	gR’d”Objeù
::
Ov”ÏpTe¡Reque¡M­
::
™”©Ü
 
™
 = 
ov”ÏpTe¡Reque¡s
.
begš
(); 
	g™
 !ğ
’d
; ++it) {

2205 ià(!
	gÏy”Bounds
.
š‹r£ùs
(
™
->
£cÚd
))

2208 
	g™
->
	gfœ¡
->
£tOv”ÏpTe¡ResuÉ
(
Œue
);

2209 
	gov”ÏµedReque¡Cl›Ás
.
­³nd
(
™
->
fœ¡
);

2211 
size_t
 
	gi
 = 0; i < 
	gov”ÏµedReque¡Cl›Ás
.
size
(); ++i)

2212 
	gov”ÏpTe¡Reque¡s
.
»move
(
ov”ÏµedReque¡Cl›Ás
[
i
]);

2215 #ià
USE
(
ACCELERATED_COMPOSITING
)

2216 
boŞ
 
shouldDoSoáw¬ePašt
(cÚ¡ 
R’d”Lay”
* 
Ïy”
, boŞ 
·štšgReæeùiÚ
)

2218  
	g·štšgReæeùiÚ
 && !
	gÏy”
->
has3DT¿nsfÜm
();

2222 
	gR’d”Lay”
::
·štLay”
(
R’d”Lay”
* 
roÙLay”
, 
G¿phicsCÚ‹xt
* 
p
,

2223 cÚ¡ 
IÁReù
& 
·štDœtyReù
, 
PaštBehaviÜ
 
·štBehaviÜ
,

2224 
R’d”Objeù
* 
·štšgRoÙ
, R’d”Objeù::
Ov”ÏpTe¡Reque¡M­
* 
ov”ÏpTe¡Reque¡s
,

2225 
PaštLay”FÏgs
 
·štFÏgs
)

2227 #ià
USE
(
ACCELERATED_COMPOSITING
)

2228 ià(
isCompos™ed
()) {

2231 ià(
	gp
->
upd©šgCÚŒŞTšts
(è|| (
	g·štBehaviÜ
 & 
	gPaštBehaviÜFÏ‰’Compos™šgLay”s
))

2232 
	g·štFÏgs
 |ğ
PaštLay”TempÜ¬yClReùs
;

2233 ià(!
backšg
()->
·štšgGÛsToWšdow
(è&& !
shouldDoSoáw¬ePašt
(
this
, 
·štFÏgs
 & 
PaštLay”PaštšgReæeùiÚ
)) {

2243 ià(
»nd””
()->
docum’t
()->
didLayoutW™hP’dšgStyËsh“ts
(è&& !»nd””()->
isR’d”V›w
(è&& !»nd””()->
isRoÙ
())

2247 ià(!
»nd””
()->
İac™y
())

2250 ià(
·štsW™hT¿n¥¬’cy
(
·štBehaviÜ
))

2251 
	g·štFÏgs
 |ğ
PaštLay”HaveT¿n¥¬’cy
;

2254 ià(
·štsW™hT¿nsfÜm
(
·štBehaviÜ
è&& !(
	g·štFÏgs
 & 
	gPaštLay”Aµl›dT¿nsfÜm
)) {

2255 
T¿nsfÜm©iÚM©rix
 
	gÏy”T¿nsfÜm
 = 
»nd”abËT¿nsfÜm
(
·štBehaviÜ
);

2257 ià(!
	gÏy”T¿nsfÜm
.
isInv”tibË
())

2262 ià(
	g·štFÏgs
 & 
	gPaštLay”HaveT¿n¥¬’cy
)

2263 
·»Á
()->
begšT¿n¥¬’cyLay”s
(
p
, 
roÙLay”
, 
·štBehaviÜ
);

2266 
IÁReù
 
	gşReù
 = 
·štDœtyReù
;

2267 ià(
·»Á
()) {

2268 
	gşReù
 = 
backgroundClReù
(
roÙLay”
, 
·štFÏgs
 & 
PaštLay”TempÜ¬yClReùs
);

2269 
	gşReù
.
š‹r£ù
(
·štDœtyReù
);

2273 
£tCl
(
p
, 
·štDœtyReù
, 
şReù
);

2277 
	gx
 = 0;

2278 
	gy
 = 0;

2279 
cÚv”tToLay”CoÜds
(
roÙLay”
, 
x
, 
y
);

2280 
T¿nsfÜm©iÚM©rix
 
ŒªsfÜm
(
Ïy”T¿nsfÜm
);

2281 
	gŒªsfÜm
.
Œª¦©eRight
(
x
, 
y
);

2284 
	gp
->
§ve
();

2285 
	gp
->
cÚÿtCTM
(
ŒªsfÜm
.
toAffšeT¿nsfÜm
());

2288 
·štLay”
(
this
, 
p
, 
ŒªsfÜm
.
šv”£
().
m­Reù
(
·štDœtyReù
), 
·štBehaviÜ
, 
·štšgRoÙ
, 
ov”ÏpTe¡Reque¡s
, 
·štFÏgs
 | 
PaštLay”Aµl›dT¿nsfÜm
);

2290 
	gp
->
»¡Üe
();

2293 
»¡ÜeCl
(
p
, 
·štDœtyReù
, 
şReù
);

2298 
PaštLay”FÏgs
 
	gloÿlPaštFÏgs
 = 
·štFÏgs
 & ~
PaštLay”Aµl›dT¿nsfÜm
;

2299 
boŞ
 
	ghaveT¿n¥¬’cy
 = 
loÿlPaštFÏgs
 & 
PaštLay”HaveT¿n¥¬’cy
;

2302 ià(
	gm_»æeùiÚ
 && !
	gm_·štšgInsideReæeùiÚ
) {

2304 
	gm_·štšgInsideReæeùiÚ
 = 
Œue
;

2305 
»æeùiÚLay”
()->
·štLay”
(
roÙLay”
, 
p
, 
·štDœtyReù
, 
·štBehaviÜ
, 
·štšgRoÙ
, 
ov”ÏpTe¡Reque¡s
, 
loÿlPaštFÏgs
 | 
PaštLay”PaštšgReæeùiÚ
);

2306 
	gm_·štšgInsideReæeùiÚ
 = 
çl£
;

2310 
IÁReù
 
	gÏy”Bounds
, 
	gdamageReù
, 
	gşReùToAµly
, 
	goušeReù
;

2311 
ÿlcuÏ‹Reùs
(
roÙLay”
, 
·štDœtyReù
, 
Ïy”Bounds
, 
damageReù
, 
şReùToAµly
, 
oušeReù
, 
loÿlPaštFÏgs
 & 
PaštLay”TempÜ¬yClReùs
);

2312 
	gx
 = 
Ïy”Bounds
.
x
();

2313 
	gy
 = 
Ïy”Bounds
.
y
();

2314 
	gtx
 = 
x
 - 
»nd”BoxX
();

2315 
	gty
 = 
y
 - 
»nd”BoxY
();

2318 
upd©eCompos™šgAndLay”Li¡sIfN“ded
();

2320 
boŞ
 
	gfÜûBÏckText
 = 
·štBehaviÜ
 & 
PaštBehaviÜFÜûBÏckText
;

2321 
boŞ
 
	g£ËùiÚOÆy
 = 
·štBehaviÜ
 & 
PaštBehaviÜS–eùiÚOÆy
;

2327 
R’d”Objeù
* 
	g·štšgRoÙFÜR’d””
 = 0;

2328 ià(
	g·štšgRoÙ
 && !
»nd””
()->
isDesûndªtOf
(
·štšgRoÙ
))

2329 
	g·štšgRoÙFÜR’d””
 = 
·štšgRoÙ
;

2331 ià(
	gov”ÏpTe¡Reque¡s
)

2332 
³rfÜmOv”ÏpTe¡s
(*
ov”ÏpTe¡Reque¡s
, 
Ïy”Bounds
);

2335 
boŞ
 
	gshouldPašt
 = 
š‹r£ùsDamageReù
(
Ïy”Bounds
, 
damageReù
, 
roÙLay”
è&& 
	gm_hasVisibËCÚ‹Á
 && 
isS–fPaštšgLay”
();

2336 ià(
	gshouldPašt
 && !
	g£ËùiÚOÆy
 && !
	gdamageReù
.
isEm±y
()) {

2338 ià(
	ghaveT¿n¥¬’cy
)

2339 
begšT¿n¥¬’cyLay”s
(
p
, 
roÙLay”
, 
·štBehaviÜ
);

2343 
£tCl
(
p
, 
·štDœtyReù
, 
damageReù
);

2346 
	gR’d”Objeù
::
PaštInfo
 
·štInfo
(
p
, 
damageReù
, 
PaštPha£BlockBackground
, 
çl£
, 
·štšgRoÙFÜR’d””
, 0);

2347 
»nd””
()->
·št
(
·štInfo
, 
tx
, 
ty
);

2350 
»¡ÜeCl
(
p
, 
·štDœtyReù
, 
damageReù
);

2354 ià(
	gm_ÃgZOrd”Li¡
)

2355 
	gVeùÜ
<
	gR’d”Lay”
*>::
™”©Ü
 
™
 = 
m_ÃgZOrd”Li¡
->
begš
(); 
	g™
 !ğm_ÃgZOrd”Li¡->
’d
(); ++it)

2356 
	g™
[0]->
·štLay”
(
roÙLay”
, 
p
, 
·štDœtyReù
, 
·štBehaviÜ
, 
·štšgRoÙ
, 
ov”ÏpTe¡Reque¡s
, 
loÿlPaštFÏgs
);

2359 ià(
	gshouldPašt
 && !
	gşReùToAµly
.
isEm±y
()) {

2361 ià(
	ghaveT¿n¥¬’cy
)

2362 
begšT¿n¥¬’cyLay”s
(
p
, 
roÙLay”
, 
·štBehaviÜ
);

2365 
£tCl
(
p
, 
·štDœtyReù
, 
şReùToAµly
);

2366 
	gR’d”Objeù
::
PaštInfo
 
·štInfo
(
p
, 
şReùToAµly
,

2367 
£ËùiÚOÆy
 ? 
PaštPha£S–eùiÚ
 : 
PaštPha£ChdBlockBackgrounds
,

2368 
fÜûBÏckText
, 
·štšgRoÙFÜR’d””
, 0);

2369 
»nd””
()->
·št
(
·štInfo
, 
tx
, 
ty
);

2370 ià(!
	g£ËùiÚOÆy
) {

2371 
	g·štInfo
.
	gpha£
 = 
PaštPha£Flßt
;

2372 
»nd””
()->
·št
(
·štInfo
, 
tx
, 
ty
);

2373 
	g·štInfo
.
	gpha£
 = 
PaštPha£FÜeground
;

2374 
	g·štInfo
.
	gov”ÏpTe¡Reque¡s
 = 
ov”ÏpTe¡Reque¡s
;

2375 
»nd””
()->
·št
(
·štInfo
, 
tx
, 
ty
);

2376 
	g·štInfo
.
	gpha£
 = 
PaštPha£ChdOušes
;

2377 
»nd””
()->
·št
(
·štInfo
, 
tx
, 
ty
);

2381 
»¡ÜeCl
(
p
, 
·štDœtyReù
, 
şReùToAµly
);

2384 ià(!
	goušeReù
.
isEm±y
(è&& 
isS–fPaštšgLay”
()) {

2386 
	gR’d”Objeù
::
PaštInfo
 
·štInfo
(
p
, 
oušeReù
, 
PaštPha£S–fOuše
, 
çl£
, 
·štšgRoÙFÜR’d””
, 0);

2387 
£tCl
(
p
, 
·štDœtyReù
, 
oušeReù
);

2388 
»nd””
()->
·št
(
·štInfo
, 
tx
, 
ty
);

2389 
»¡ÜeCl
(
p
, 
·štDœtyReù
, 
oušeReù
);

2393 ià(
	gm_nÜm®FlowLi¡
)

2394 
	gVeùÜ
<
	gR’d”Lay”
*>::
™”©Ü
 
™
 = 
m_nÜm®FlowLi¡
->
begš
(); 
	g™
 !ğm_nÜm®FlowLi¡->
’d
(); ++it)

2395 
	g™
[0]->
·štLay”
(
roÙLay”
, 
p
, 
·štDœtyReù
, 
·štBehaviÜ
, 
·štšgRoÙ
, 
ov”ÏpTe¡Reque¡s
, 
loÿlPaštFÏgs
);

2398 ià(
	gm_posZOrd”Li¡
)

2399 
	gVeùÜ
<
	gR’d”Lay”
*>::
™”©Ü
 
™
 = 
m_posZOrd”Li¡
->
begš
(); 
	g™
 !ğm_posZOrd”Li¡->
’d
(); ++it)

2400 
	g™
[0]->
·štLay”
(
roÙLay”
, 
p
, 
·štDœtyReù
, 
·štBehaviÜ
, 
·štšgRoÙ
, 
ov”ÏpTe¡Reque¡s
, 
loÿlPaštFÏgs
);

2402 ià(
»nd””
()->
hasMask
(è&& 
	gshouldPašt
 && !
	g£ËùiÚOÆy
 && !
	gdamageReù
.
isEm±y
()) {

2403 
£tCl
(
p
, 
·štDœtyReù
, 
damageReù
);

2406 
	gR’d”Objeù
::
PaštInfo
 
·štInfo
(
p
, 
damageReù
, 
PaštPha£Mask
, 
çl£
, 
·štšgRoÙFÜR’d””
, 0);

2407 
»nd””
()->
·št
(
·štInfo
, 
tx
, 
ty
);

2410 
»¡ÜeCl
(
p
, 
·štDœtyReù
, 
damageReù
);

2414 ià(
	ghaveT¿n¥¬’cy
 && 
	gm_u£dT¿n¥¬’cy
 && !
	gm_·štšgInsideReæeùiÚ
) {

2415 
	gp
->
’dT¿n¥¬’cyLay”
();

2416 
	gp
->
»¡Üe
();

2417 
	gm_u£dT¿n¥¬’cy
 = 
çl£
;

2421 
šlše
 
IÁReù
 
äameVisibËReù
(
R’d”Objeù
* 
»nd””
)

2423 
F¿meV›w
* 
	gäameV›w
 = 
»nd””
->
docum’t
()->
v›w
();

2424 ià(!
	gäameV›w
)

2425  
IÁReù
();

2427  
	gäameV›w
->
visibËCÚ‹ÁReù
();

2430 
boŞ
 
	gR’d”Lay”
::
h™Te¡
(cÚ¡ 
H™Te¡Reque¡
& 
»que¡
, 
H™Te¡ResuÉ
& 
»suÉ
)

2432 
»nd””
()->
docum’t
()->
upd©eLayout
();

2434 
IÁReù
 
boundsReù
(
m_x
, 
m_y
, 
width
(), 
height
());

2435 ià(!
	g»que¡
.
ignÜeClpšg
())

2436 
	gboundsReù
.
š‹r£ù
(
äameVisibËReù
(
»nd””
()));

2438 
R’d”Lay”
* 
	gšsideLay”
 = 
h™Te¡Lay”
(
this
, 0, 
»que¡
, 
»suÉ
, 
boundsReù
,„esuÉ.
pošt
(), 
çl£
);

2439 ià(!
	gšsideLay”
) {

2443 ià((
	g»que¡
.
aùive
(è||„eque¡.
mou£Up
()è&& 
»nd””
()->
isR’d”V›w
()) {

2444 
»nd””
()->
upd©eH™Te¡ResuÉ
(
»suÉ
,„esuÉ.
pošt
());

2445 
	gšsideLay”
 = 
this
;

2450 
Node
* 
	gnode
 = 
»suÉ
.
šÃrNode
();

2451 ià(
	gnode
 && !
	g»suÉ
.
URLEËm’t
())

2452 
	g»suÉ
.
£tURLEËm’t
(
¡©ic_ÿ¡
<
EËm’t
*>(
node
->
’şosšgLškEv’tP¬’tOrS–f
()));

2455 
upd©eHov”AùiveS‹
(
»que¡
, 
»suÉ
);

2459  
	gšsideLay”
;

2462 
Node
* 
	gR’d”Lay”
::
’şosšgEËm’t
() const

2464 
R’d”Objeù
* 
r
 = 
»nd””
(); 
	gr
;„ =„->
·»Á
()) {

2465 ià(
Node
* 
e
 = 
r
->
node
())

2466  
e
;

2468 
ASSERT_NOT_REACHED
();

2475 
compu‹ZOff£t
(cÚ¡ 
H™Te¡šgT¿nsfÜmS‹
& 
ŒªsfÜmS‹
)

2478 ià(
	gŒªsfÜmS‹
.
	gm_accumuÏ‹dT¿nsfÜm
.
isAffše
())

2482 
FlßtPošt
 
	grg‘Pošt
 = 
ŒªsfÜmS‹
.
m­³dPošt
();

2485 
FlßtPošt3D
 
	gbackm­³dPošt
 = 
ŒªsfÜmS‹
.
m_accumuÏ‹dT¿nsfÜm
.
m­Pošt
(FlßtPošt3D(
rg‘Pošt
));

2486  
	gbackm­³dPošt
.
z
();

2489 
	gPassRefPŒ
<
	gH™Te¡šgT¿nsfÜmS‹
> 
	gR’d”Lay”
::
ü—‹LoÿlT¿nsfÜmS‹
(
R’d”Lay”
* 
roÙLay”
, R’d”Lay”* 
cÚš”Lay”
,

2490 cÚ¡ 
IÁReù
& 
h™Te¡Reù
, cÚ¡ 
IÁPošt
& 
h™Te¡Pošt
,

2491 cÚ¡ 
H™Te¡šgT¿nsfÜmS‹
* 
cÚš”T¿nsfÜmS‹
) const

2493 
	gRefPŒ
<
	gH™Te¡šgT¿nsfÜmS‹
> 
	gŒªsfÜmS‹
;

2494 
	goff£tX
 = 0;

2495 
	goff£tY
 = 0;

2496 ià(
	gcÚš”T¿nsfÜmS‹
) {

2498 
	gŒªsfÜmS‹
 = 
H™Te¡šgT¿nsfÜmS‹
::
ü—‹
(*
cÚš”T¿nsfÜmS‹
);

2499 
cÚv”tToLay”CoÜds
(
cÚš”Lay”
, 
off£tX
, 
off£tY
);

2503 
	gŒªsfÜmS‹
 = 
H™Te¡šgT¿nsfÜmS‹
::
ü—‹
(
h™Te¡Pošt
, 
FlßtQuad
(
h™Te¡Reù
));

2504 
cÚv”tToLay”CoÜds
(
roÙLay”
, 
off£tX
, 
off£tY
);

2507 
R’d”Objeù
* 
	gcÚš”R’d””
 = 
cÚš”Lay”
 ? cÚš”Lay”->
»nd””
() : 0;

2508 ià(
»nd””
()->
shouldU£T¿nsfÜmFromCÚš”
(
cÚš”R’d””
)) {

2509 
T¿nsfÜm©iÚM©rix
 
	gcÚš”T¿nsfÜm
;

2510 
»nd””
()->
g‘T¿nsfÜmFromCÚš”
(
cÚš”R’d””
, 
IÁSize
(
off£tX
, 
off£tY
), 
cÚš”T¿nsfÜm
);

2511 
	gŒªsfÜmS‹
->
­¶yT¿nsfÜm
(
cÚš”T¿nsfÜm
, 
H™Te¡šgT¿nsfÜmS‹
::
AccumuÏ‹T¿nsfÜm
);

2513 
	gŒªsfÜmS‹
->
Œª¦©e
(
off£tX
, 
off£tY
, 
H™Te¡šgT¿nsfÜmS‹
::
AccumuÏ‹T¿nsfÜm
);

2516  
	gŒªsfÜmS‹
;

2520 
boŞ
 
isH™Cªdid©e
(cÚ¡ 
R’d”Lay”
* 
h™Lay”
, boŞ 
ÿnD•thSÜt
, * 
zOff£t
, cÚ¡ 
H™Te¡šgT¿nsfÜmS‹
* 
ŒªsfÜmS‹
)

2522 ià(!
	gh™Lay”
)

2523  
	gçl£
;

2526 ià(
	gÿnD•thSÜt
)

2527  
	gŒue
;

2530 ià(
	gzOff£t
) {

2531 
ASSERT
(
ŒªsfÜmS‹
);

2533 
	gchdZOff£t
 = 
compu‹ZOff£t
(*
ŒªsfÜmS‹
);

2534 ià(
	gchdZOff£t
 > *
	gzOff£t
) {

2535 *
	gzOff£t
 = 
chdZOff£t
;

2536  
	gŒue
;

2538  
	gçl£
;

2541  
	gŒue
;

2552 
R’d”Lay”
* 
	gR’d”Lay”
::
h™Te¡Lay”
(R’d”Lay”* 
roÙLay”
, R’d”Lay”* 
cÚš”Lay”
, cÚ¡ 
H™Te¡Reque¡
& 
»que¡
, 
H™Te¡ResuÉ
& 
»suÉ
,

2553 cÚ¡ 
IÁReù
& 
h™Te¡Reù
, cÚ¡ 
IÁPošt
& 
h™Te¡Pošt
, 
boŞ
 
­¶›dT¿nsfÜm
,

2554 cÚ¡ 
H™Te¡šgT¿nsfÜmS‹
* 
ŒªsfÜmS‹
, * 
zOff£t
)

2558 
boŞ
 
	gu£TempÜ¬yClReùs
 = 
çl£
;

2559 #ià
USE
(
ACCELERATED_COMPOSITING
)

2560 
	gu£TempÜ¬yClReùs
 = 
compos™Ü
()->
šCompos™šgMode
();

2564 ià(
ŒªsfÜm
(è&& !
	g­¶›dT¿nsfÜm
) {

2566 ià(
·»Á
()) {

2567 
IÁReù
 
	gşReù
 = 
backgroundClReù
(
roÙLay”
, 
u£TempÜ¬yClReùs
);

2569 ià(!
	gşReù
.
cÚšs
(
h™Te¡Pošt
))

2574 
	gRefPŒ
<
	gH™Te¡šgT¿nsfÜmS‹
> 
	gÃwT¿nsfÜmS‹
 = 
ü—‹LoÿlT¿nsfÜmS‹
(
roÙLay”
, 
cÚš”Lay”
, 
h™Te¡Reù
, 
h™Te¡Pošt
, 
ŒªsfÜmS‹
);

2577 ià(!
	gÃwT¿nsfÜmS‹
->
	gm_accumuÏ‹dT¿nsfÜm
.
isInv”tibË
())

2586 
IÁPošt
 
	gloÿlPošt
 = 
roundedIÁPošt
(
ÃwT¿nsfÜmS‹
->
m­³dPošt
());

2587 
IÁReù
 
	gloÿlH™Te¡Reù
;

2588 #ià
USE
(
ACCELERATED_COMPOSITING
)

2589 ià(
isCompos™ed
()) {

2591 
	gloÿlH™Te¡Reù
 = 
backšg
()->
compos™edBounds
();

2594 
	gloÿlH™Te¡Reù
 = 
ÃwT¿nsfÜmS‹
->
m­³dQuad
().
’şosšgBoundšgBox
();

2597  
h™Te¡Lay”
(
this
, 
cÚš”Lay”
, 
»que¡
, 
»suÉ
, 
loÿlH™Te¡Reù
, 
loÿlPošt
, 
Œue
, 
ÃwT¿nsfÜmS‹
.
g‘
(), 
zOff£t
);

2601 
upd©eCompos™šgAndLay”Li¡sIfN“ded
();

2602 
upd©e3DT¿nsfÜmedDesûndªtStus
();

2604 
	gRefPŒ
<
	gH™Te¡šgT¿nsfÜmS‹
> 
	gloÿlT¿nsfÜmS‹
;

2605 ià(
	g­¶›dT¿nsfÜm
) {

2607 
ASSERT
(
ŒªsfÜmS‹
);

2608 
	gloÿlT¿nsfÜmS‹
 = 
cÚ¡_ÿ¡
<
H™Te¡šgT¿nsfÜmS‹
*>(
ŒªsfÜmS‹
);

2609 } ià(
	gŒªsfÜmS‹
 || 
	gm_has3DT¿nsfÜmedDesûndªt
 || 
´e£rves3D
()) {

2611 
	gloÿlT¿nsfÜmS‹
 = 
ü—‹LoÿlT¿nsfÜmS‹
(
roÙLay”
, 
cÚš”Lay”
, 
h™Te¡Reù
, 
h™Te¡Pošt
, 
ŒªsfÜmS‹
);

2615 ià(
	gloÿlT¿nsfÜmS‹
 && 
»nd””
()->
¡yË
()->
backçûVisib™y
(è=ğ
BackçûVisib™yHidd’
) {

2616 
T¿nsfÜm©iÚM©rix
 
šv”‹dM©rix
 = 
loÿlT¿nsfÜmS‹
->
m_accumuÏ‹dT¿nsfÜm
.
šv”£
();

2618 ià(
	gšv”‹dM©rix
.
m33
() < 0)

2622 
	gRefPŒ
<
	gH™Te¡šgT¿nsfÜmS‹
> 
	gunæ©‹ÃdT¿nsfÜmS‹
 = 
loÿlT¿nsfÜmS‹
;

2623 ià(
	gloÿlT¿nsfÜmS‹
 && !
´e£rves3D
()) {

2625 
	gunæ©‹ÃdT¿nsfÜmS‹
 = 
H™Te¡šgT¿nsfÜmS‹
::
ü—‹
(*
loÿlT¿nsfÜmS‹
);

2627 
	gloÿlT¿nsfÜmS‹
->
æ©‹n
();

2631 
IÁReù
 
	gÏy”Bounds
;

2632 
IÁReù
 
	gbgReù
;

2633 
IÁReù
 
	gfgReù
;

2634 
IÁReù
 
	goušeReù
;

2635 
ÿlcuÏ‹Reùs
(
roÙLay”
, 
h™Te¡Reù
, 
Ïy”Bounds
, 
bgReù
, 
fgReù
, 
oušeReù
, 
u£TempÜ¬yClReùs
);

2639 
	gloÿlZOff£t
 = -
num”ic_lim™s
<>::
šfš™y
();

2640 * 
	gzOff£tFÜDesûndªtsPŒ
 = 0;

2641 * 
	gzOff£tFÜCÚ‹ÁsPŒ
 = 0;

2643 
boŞ
 
	gd•thSÜtDesûndªts
 = 
çl£
;

2644 ià(
´e£rves3D
()) {

2645 
	gd•thSÜtDesûndªts
 = 
Œue
;

2647 
	gzOff£tFÜDesûndªtsPŒ
 = 
zOff£t
 ? zOff£ˆ: &
loÿlZOff£t
;

2648 
	gzOff£tFÜCÚ‹ÁsPŒ
 = 
zOff£t
 ? zOff£ˆ: &
loÿlZOff£t
;

2649 } ià(
	gm_has3DT¿nsfÜmedDesûndªt
) {

2651 
	gd•thSÜtDesûndªts
 = 
Œue
;

2652 
	gzOff£tFÜDesûndªtsPŒ
 = 
zOff£t
 ? zOff£ˆ: &
loÿlZOff£t
;

2653 
	gzOff£tFÜCÚ‹ÁsPŒ
 = 
zOff£t
 ? zOff£ˆ: &
loÿlZOff£t
;

2654 } ià(
	gzOff£t
) {

2655 
	gzOff£tFÜDesûndªtsPŒ
 = 0;

2657 
	gzOff£tFÜCÚ‹ÁsPŒ
 = 
zOff£t
;

2661 
R’d”Lay”
* 
	gÿndid©eLay”
 = 0;

2664 ià(
	gm_posZOrd”Li¡
) {

2665 
	gi
 = 
m_posZOrd”Li¡
->
size
() - 1; i >= 0; --i) {

2666 
H™Te¡ResuÉ
 
‹mpResuÉ
(
»suÉ
.
pošt
());

2667 
R’d”Lay”
* 
	gh™Lay”
 = 
m_posZOrd”Li¡
->
©
(
i
)->
h™Te¡Lay”
(
roÙLay”
, 
this
, 
»que¡
, 
‹mpResuÉ
, 
h™Te¡Reù
, 
h™Te¡Pošt
, 
çl£
, 
loÿlT¿nsfÜmS‹
.
g‘
(), 
zOff£tFÜDesûndªtsPŒ
);

2668 ià(
isH™Cªdid©e
(
h™Lay”
, 
d•thSÜtDesûndªts
, 
zOff£t
, 
unæ©‹ÃdT¿nsfÜmS‹
.
g‘
())) {

2669 
	g»suÉ
 = 
‹mpResuÉ
;

2670 ià(!
	gd•thSÜtDesûndªts
)

2671  
	gh™Lay”
;

2673 
	gÿndid©eLay”
 = 
h™Lay”
;

2679 ià(
	gm_nÜm®FlowLi¡
) {

2680 
	gi
 = 
m_nÜm®FlowLi¡
->
size
() - 1; i >= 0; --i) {

2681 
R’d”Lay”
* 
	gcu¼Lay”
 = 
m_nÜm®FlowLi¡
->
©
(
i
);

2682 
H™Te¡ResuÉ
 
‹mpResuÉ
(
»suÉ
.
pošt
());

2683 
R’d”Lay”
* 
	gh™Lay”
 = 
cu¼Lay”
->
h™Te¡Lay”
(
roÙLay”
, 
this
, 
»que¡
, 
‹mpResuÉ
, 
h™Te¡Reù
, 
h™Te¡Pošt
, 
çl£
, 
loÿlT¿nsfÜmS‹
.
g‘
(), 
zOff£tFÜDesûndªtsPŒ
);

2684 ià(
isH™Cªdid©e
(
h™Lay”
, 
d•thSÜtDesûndªts
, 
zOff£t
, 
unæ©‹ÃdT¿nsfÜmS‹
.
g‘
())) {

2685 
	g»suÉ
 = 
‹mpResuÉ
;

2686 ià(!
	gd•thSÜtDesûndªts
)

2687  
	gh™Lay”
;

2689 
	gÿndid©eLay”
 = 
h™Lay”
;

2695 ià(
	gfgReù
.
cÚšs
(
h™Te¡Pošt
è&& 
isS–fPaštšgLay”
()) {

2697 
H™Te¡ResuÉ
 
‹mpResuÉ
(
»suÉ
.
pošt
());

2698 ià(
h™Te¡CÚ‹Ás
(
»que¡
, 
‹mpResuÉ
, 
Ïy”Bounds
, 
h™Te¡Pošt
, 
H™Te¡Desûndªts
) &&

2699 
isH™Cªdid©e
(
this
, 
çl£
, 
zOff£tFÜCÚ‹ÁsPŒ
, 
unæ©‹ÃdT¿nsfÜmS‹
.
g‘
())) {

2700 
	g»suÉ
 = 
‹mpResuÉ
;

2701 ià(!
	gd•thSÜtDesûndªts
)

2702  
	gthis
;

2704 
	gÿndid©eLay”
 = 
this
;

2709 ià(
	gm_ÃgZOrd”Li¡
) {

2710 
	gi
 = 
m_ÃgZOrd”Li¡
->
size
() - 1; i >= 0; --i) {

2711 
H™Te¡ResuÉ
 
‹mpResuÉ
(
»suÉ
.
pošt
());

2712 
R’d”Lay”
* 
	gh™Lay”
 = 
m_ÃgZOrd”Li¡
->
©
(
i
)->
h™Te¡Lay”
(
roÙLay”
, 
this
, 
»que¡
, 
‹mpResuÉ
, 
h™Te¡Reù
, 
h™Te¡Pošt
, 
çl£
, 
loÿlT¿nsfÜmS‹
.
g‘
(), 
zOff£tFÜDesûndªtsPŒ
);

2713 ià(
isH™Cªdid©e
(
h™Lay”
, 
d•thSÜtDesûndªts
, 
zOff£t
, 
unæ©‹ÃdT¿nsfÜmS‹
.
g‘
())) {

2714 
	g»suÉ
 = 
‹mpResuÉ
;

2715 ià(!
	gd•thSÜtDesûndªts
)

2716  
	gh™Lay”
;

2718 
	gÿndid©eLay”
 = 
h™Lay”
;

2724 ià(
	gÿndid©eLay”
)

2725  
	gÿndid©eLay”
;

2727 ià(
	gbgReù
.
cÚšs
(
h™Te¡Pošt
è&& 
isS–fPaštšgLay”
()) {

2728 
H™Te¡ResuÉ
 
‹mpResuÉ
(
»suÉ
.
pošt
());

2729 ià(
h™Te¡CÚ‹Ás
(
»que¡
, 
‹mpResuÉ
, 
Ïy”Bounds
, 
h™Te¡Pošt
, 
H™Te¡S–f
) &&

2730 
isH™Cªdid©e
(
this
, 
çl£
, 
zOff£tFÜCÚ‹ÁsPŒ
, 
unæ©‹ÃdT¿nsfÜmS‹
.
g‘
())) {

2731 
	g»suÉ
 = 
‹mpResuÉ
;

2732  
	gthis
;

2739 
boŞ
 
	gR’d”Lay”
::
h™Te¡CÚ‹Ás
(cÚ¡ 
H™Te¡Reque¡
& 
»que¡
, 
H™Te¡ResuÉ
& 
»suÉ
, cÚ¡ 
IÁReù
& 
Ïy”Bounds
, cÚ¡ 
IÁPošt
& 
h™Te¡Pošt
, 
H™Te¡F‹r
 
h™Te¡F‹r
) const

2741 ià(!
»nd””
()->
h™Te¡
(
»que¡
, 
»suÉ
, 
h™Te¡Pošt
,

2742 
Ïy”Bounds
.
x
(è- 
»nd”BoxX
(),

2743 
Ïy”Bounds
.
y
(è- 
»nd”BoxY
(),

2744 
h™Te¡F‹r
)) {

2746 
ASSERT
(!
»suÉ
.
šÃrNode
());

2747  
	gçl£
;

2754 ià(!
	g»suÉ
.
šÃrNode
(è|| !»suÉ.
šÃrNÚSh¬edNode
()) {

2755 
Node
* 
	ge
 = 
’şosšgEËm’t
();

2756 ià(!
	g»suÉ
.
šÃrNode
())

2757 
	g»suÉ
.
£tIÂ”Node
(
e
);

2758 ià(!
	g»suÉ
.
šÃrNÚSh¬edNode
())

2759 
	g»suÉ
.
£tIÂ”NÚSh¬edNode
(
e
);

2762  
	gŒue
;

2765 
	gR’d”Lay”
::
upd©eClReùs
(cÚ¡ 
R’d”Lay”
* 
roÙLay”
)

2767 ià(
m_şReùs
) {

2768 
ASSERT
(
roÙLay”
 =ğ
m_şReùsRoÙ
);

2774 
R’d”Lay”
* 
	g·»ÁLay”
 = 
roÙLay”
 !ğ
this
 ? 
·»Á
() : 0;

2775 ià(
	g·»ÁLay”
)

2776 
	g·»ÁLay”
->
upd©eClReùs
(
roÙLay”
);

2778 
ClReùs
 
	gşReùs
;

2779 
ÿlcuÏ‹ClReùs
(
roÙLay”
, 
şReùs
, 
Œue
);

2781 ià(
	g·»ÁLay”
 &&…¬’tLay”->
şReùs
(è&& 
	gşReùs
 =ğ*
·»ÁLay”
->clipRects())

2782 
m_şReùs
 = 
·»ÁLay”
->
şReùs
();

2784 
	gm_şReùs
 = 
Ãw
 (
»nd””
()->
»nd”A»Ç
()è
ClReùs
(
şReùs
);

2785 
	gm_şReùs
->
»f
();

2786 #iâdeà
NDEBUG


2787 
	gm_şReùsRoÙ
 = 
roÙLay”
;

2791 
	gR’d”Lay”
::
ÿlcuÏ‹ClReùs
(cÚ¡ 
R’d”Lay”
* 
roÙLay”
, 
ClReùs
& 
şReùs
, 
boŞ
 
u£Cached
) const

2793 ià(!
·»Á
()) {

2795 
	gşReùs
.
»£t
(
ClReùs
::
šfš™eReù
());

2801 
R’d”Lay”
* 
	g·»ÁLay”
 = 
roÙLay”
 !ğ
this
 ? 
·»Á
() : 0;

2804 ià(
	g·»ÁLay”
) {

2805 ià(
	gu£Cached
 && 
	g·»ÁLay”
->
şReùs
())

2806 
	gşReùs
 = *
·»ÁLay”
->
şReùs
();

2808 
	g·»ÁLay”
->
ÿlcuÏ‹ClReùs
(
roÙLay”
, 
şReùs
);

2811 
	gşReùs
.
»£t
(
ClReùs
::
šfš™eReù
());

2815 ià(
»nd””
()->
¡yË
()->
pos™iÚ
(è=ğ
FixedPos™iÚ
) {

2816 
şReùs
.
£tPosClReù
(şReùs.
fixedClReù
());

2817 
	gşReùs
.
£tOv”æowClReù
(
şReùs
.
fixedClReù
());

2818 
	gşReùs
.
£tFixed
(
Œue
);

2820 ià(
»nd””
()->
¡yË
()->
pos™iÚ
(è=ğ
R–©ivePos™iÚ
)

2821 
şReùs
.
£tPosClReù
(şReùs.
ov”æowClReù
());

2822 ià(
»nd””
()->
¡yË
()->
pos™iÚ
(è=ğ
AbsŞu‹Pos™iÚ
)

2823 
şReùs
.
£tOv”æowClReù
(şReùs.
posClReù
());

2826 ià(
»nd””
()->
hasOv”æowCl
(è||„’d””()->
hasCl
()) {

2828 
	gx
 = 0;

2829 
	gy
 = 0;

2830 
cÚv”tToLay”CoÜds
(
roÙLay”
, 
x
, 
y
);

2831 
R’d”V›w
* 
	gv›w
 = 
»nd””
()->
v›w
();

2832 
ASSERT
(
v›w
);

2833 ià(
	gv›w
 && 
	gşReùs
.
fixed
(è&& 
	groÙLay”
->
»nd””
(è=ğ
v›w
) {

2834 
x
 -ğ
v›w
->
äameV›w
()->
süŞlX
();

2835 
	gy
 -ğ
v›w
->
äameV›w
()->
süŞlY
();

2838 ià(
»nd””
()->
hasOv”æowCl
()) {

2839 
IÁReù
 
	gÃwOv”æowCl
 = 
toR’d”Box
(
»nd””
())->
ov”æowClReù
(
x
, 
y
);

2840 
	gşReùs
.
£tOv”æowClReù
(
š‹r£ùiÚ
(
ÃwOv”æowCl
, 
şReùs
.
ov”æowClReù
()));

2841 ià(
»nd””
()->
isPos™iÚed
(è||„’d””()->
isR–Pos™iÚed
())

2842 
	gşReùs
.
£tPosClReù
(
š‹r£ùiÚ
(
ÃwOv”æowCl
, 
şReùs
.
posClReù
()));

2844 ià(
»nd””
()->
hasCl
()) {

2845 
IÁReù
 
	gÃwPosCl
 = 
toR’d”Box
(
»nd””
())->
şReù
(
x
, 
y
);

2846 
	gşReùs
.
£tPosClReù
(
š‹r£ùiÚ
(
ÃwPosCl
, 
şReùs
.
posClReù
()));

2847 
	gşReùs
.
£tOv”æowClReù
(
š‹r£ùiÚ
(
ÃwPosCl
, 
şReùs
.
ov”æowClReù
()));

2848 
	gşReùs
.
£tFixedClReù
(
š‹r£ùiÚ
(
ÃwPosCl
, 
şReùs
.
fixedClReù
()));

2853 
	gR’d”Lay”
::
·»ÁClReùs
(cÚ¡ 
R’d”Lay”
* 
roÙLay”
, 
ClReùs
& 
şReùs
, 
boŞ
 
‹mpÜ¬yClReùs
) const

2855 
ASSERT
(
·»Á
());

2856 ià(
	g‹mpÜ¬yClReùs
) {

2857 
·»Á
()->
ÿlcuÏ‹ClReùs
(
roÙLay”
, 
şReùs
);

2861 
·»Á
()->
upd©eClReùs
(
roÙLay”
);

2862 
	gşReùs
 = *
·»Á
()->
şReùs
();

2865 
IÁReù
 
	gR’d”Lay”
::
backgroundClReù
(cÚ¡ 
R’d”Lay”
* 
roÙLay”
, 
boŞ
 
‹mpÜ¬yClReùs
) const

2867 
IÁReù
 
	gbackgroundReù
;

2868 ià(
·»Á
()) {

2869 
ClReùs
 
	g·»ÁReùs
;

2870 
·»ÁClReùs
(
roÙLay”
, 
·»ÁReùs
, 
‹mpÜ¬yClReùs
);

2871 
	gbackgroundReù
 = 
»nd””
()->
¡yË
()->
pos™iÚ
(è=ğ
FixedPos™iÚ
 ? 
·»ÁReùs
.
fixedClReù
() :

2872 (
»nd””
()->
isPos™iÚed
(è? 
·»ÁReùs
.
posClReù
() :

2873 
·»ÁReùs
.
ov”æowClReù
());

2874 
R’d”V›w
* 
	gv›w
 = 
»nd””
()->
v›w
();

2875 
ASSERT
(
v›w
);

2876 ià(
	gv›w
 && 
	g·»ÁReùs
.
fixed
(è&& 
	groÙLay”
->
»nd””
(è=ğ
v›w
)

2877 
backgroundReù
.
move
(
v›w
->
äameV›w
()->
süŞlX
(), v›w->äameV›w()->
süŞlY
());

2879  
	gbackgroundReù
;

2882 
	gR’d”Lay”
::
ÿlcuÏ‹Reùs
(cÚ¡ 
R’d”Lay”
* 
roÙLay”
, cÚ¡ 
IÁReù
& 
·štDœtyReù
, IÁReù& 
Ïy”Bounds
,

2883 
IÁReù
& 
backgroundReù
, IÁReù& 
fÜegroundReù
, IÁReù& 
oušeReù
, 
boŞ
 
‹mpÜ¬yClReùs
) const

2885 ià(
	groÙLay”
 !ğ
this
 && 
·»Á
()) {

2886 
backgroundReù
 = 
backgroundClReù
(
roÙLay”
, 
‹mpÜ¬yClReùs
);

2887 
	gbackgroundReù
.
š‹r£ù
(
·štDœtyReù
);

2889 
	gbackgroundReù
 = 
·štDœtyReù
;

2891 
	gfÜegroundReù
 = 
backgroundReù
;

2892 
	goušeReù
 = 
backgroundReù
;

2894 
	gx
 = 0;

2895 
	gy
 = 0;

2896 
cÚv”tToLay”CoÜds
(
roÙLay”
, 
x
, 
y
);

2897 
	gÏy”Bounds
 = 
IÁReù
(
x
, 
y
, 
width
(), 
height
());

2900 ià(
»nd””
()->
hasOv”æowCl
(è||„’d””()->
hasCl
()) {

2902 ià(
»nd””
()->
hasOv”æowCl
())

2903 
	gfÜegroundReù
.
š‹r£ù
(
toR’d”Box
(
»nd””
())->
ov”æowClReù
(
x
, 
y
));

2904 ià(
»nd””
()->
hasCl
()) {

2906 
IÁReù
 
	gÃwPosCl
 = 
toR’d”Box
(
»nd””
())->
şReù
(
x
, 
y
);

2907 
	gbackgroundReù
.
š‹r£ù
(
ÃwPosCl
);

2908 
	gfÜegroundReù
.
š‹r£ù
(
ÃwPosCl
);

2909 
	goušeReù
.
š‹r£ù
(
ÃwPosCl
);

2916 ià(cÚ¡ 
ShadowD©a
* 
	gboxShadow
 = 
»nd””
()->
¡yË
()->
boxShadow
()) {

2917 
IÁReù
 
ov”æow
 = 
Ïy”Bounds
;

2919 ià(
	gboxShadow
->
¡yË
(è=ğ
NÜm®
) {

2920 
IÁReù
 
shadowReù
 = 
Ïy”Bounds
;

2921 
	gshadowReù
.
move
(
boxShadow
->
x
(), boxShadow->
y
());

2922 
	gshadowReù
.
šæ©e
(
boxShadow
->
blur
(è+ boxShadow->
¥»ad
());

2923 
	gov”æow
.
un™e
(
shadowReù
);

2926 
	gboxShadow
 = 
boxShadow
->
Ãxt
();

2927 } 
	gboxShadow
);

2928 
	gbackgroundReù
.
š‹r£ù
(
ov”æow
);

2930 
	gbackgroundReù
.
š‹r£ù
(
Ïy”Bounds
);

2934 
IÁReù
 
	gR’d”Lay”
::
chd»nClReù
() const

2936 
R’d”Lay”
* 
roÙLay”
 = 
»nd””
()->
v›w
()->
Ïy”
();

2937 
R’d”Lay”
* 
	gşpšgRoÙLay”
 = 
şpšgRoÙ
();

2938 
IÁReù
 
	gÏy”Bounds
, 
	gbackgroundReù
, 
	gfÜegroundReù
, 
	goušeReù
;

2939 
ÿlcuÏ‹Reùs
(
şpšgRoÙLay”
, 
roÙLay”
->
boundšgBox
ÔoÙLay”), 
Ïy”Bounds
, 
backgroundReù
, 
fÜegroundReù
, 
oušeReù
);

2940  
	gşpšgRoÙLay”
->
»nd””
()->
loÿlToAbsŞu‹Quad
(
FlßtQuad
(
fÜegroundReù
)).
’şosšgBoundšgBox
();

2943 
IÁReù
 
	gR’d”Lay”
::
£lfClReù
() const

2945 
R’d”Lay”
* 
roÙLay”
 = 
»nd””
()->
v›w
()->
Ïy”
();

2946 
R’d”Lay”
* 
	gşpšgRoÙLay”
 = 
şpšgRoÙ
();

2947 
IÁReù
 
	gÏy”Bounds
, 
	gbackgroundReù
, 
	gfÜegroundReù
, 
	goušeReù
;

2948 
ÿlcuÏ‹Reùs
(
şpšgRoÙLay”
, 
roÙLay”
->
boundšgBox
ÔoÙLay”), 
Ïy”Bounds
, 
backgroundReù
, 
fÜegroundReù
, 
oušeReù
);

2949  
	gşpšgRoÙLay”
->
»nd””
()->
loÿlToAbsŞu‹Quad
(
FlßtQuad
(
backgroundReù
)).
’şosšgBoundšgBox
();

2952 
	gR’d”Lay”
::
addBlockS–eùiÚG­sBounds
(cÚ¡ 
IÁReù
& 
bounds
)

2954 
m_blockS–eùiÚG­sBounds
.
un™e
(
bounds
);

2957 
	gR’d”Lay”
::
ş—rBlockS–eùiÚG­sBounds
()

2959 
m_blockS–eùiÚG­sBounds
 = 
IÁReù
();

2960 
R’d”Lay”
* 
	gchd
 = 
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
())

2961 
chd
->
ş—rBlockS–eùiÚG­sBounds
();

2964 
	gR’d”Lay”
::
»·štBlockS–eùiÚG­s
()

2966 
R’d”Lay”
* 
chd
 = 
fœ¡Chd
(); 
	gchd
; chd = chd->
ÃxtSiblšg
())

2967 
chd
->
»·štBlockS–eùiÚG­s
();

2969 ià(
	gm_blockS–eùiÚG­sBounds
.
isEm±y
())

2972 
IÁReù
 
	g»ù
 = 
m_blockS–eùiÚG­sBounds
;

2973 
	g»ù
.
move
(-
süŞËdCÚ‹ÁOff£t
());

2974 ià(
»nd””
()->
hasOv”æowCl
())

2975 
	g»ù
.
š‹r£ù
(
toR’d”Box
(
»nd””
())->
ov”æowClReù
(0, 0));

2976 ià(
»nd””
()->
hasCl
())

2977 
	g»ù
.
š‹r£ù
(
toR’d”Box
(
»nd””
())->
şReù
(0, 0));

2978 ià(!
	g»ù
.
isEm±y
())

2979 
»nd””
()->
»·štReùªgË
(
»ù
);

2982 
boŞ
 
	gR’d”Lay”
::
š‹r£ùsDamageReù
(cÚ¡ 
IÁReù
& 
Ïy”Bounds
, cÚ¡ IÁReù& 
damageReù
, cÚ¡ 
R’d”Lay”
* 
roÙLay”
) const

2987 ià(
»nd””
()->
isR’d”V›w
(è||„’d””()->
isRoÙ
())

2988  
	gŒue
;

2992 
R’d”V›w
* 
	gv›w
 = 
»nd””
()->
v›w
();

2993 
ASSERT
(
v›w
);

2994 ià(
	gv›w
 && !
»nd””
()->
isR’d”IÆše
()) {

2995 
IÁReù
 
	gb
 = 
Ïy”Bounds
;

2996 
	gb
.
šæ©e
(
v›w
->
maxim®OušeSize
());

2997 ià(
	gb
.
š‹r£ùs
(
damageReù
))

2998  
	gŒue
;

3003  
boundšgBox
(
roÙLay”
).
š‹r£ùs
(
damageReù
);

3006 
IÁReù
 
	gR’d”Lay”
::
loÿlBoundšgBox
() const

3017 
IÁReù
 
»suÉ
;

3018 ià(
»nd””
()->
isR’d”IÆše
()) {

3020 
R’d”IÆše
* 
	gšlšeFlow
 = 
toR’d”IÆše
(
»nd””
());

3021 
IÆšeFlowBox
* 
	gfœ¡Box
 = 
šlšeFlow
->
fœ¡LšeBox
();

3022 ià(!
	gfœ¡Box
)

3023  
	g»suÉ
;

3024 
	gtİ
 = 
fœ¡Box
->
tİVisibËOv”æow
();

3025 
	gbÙtom
 = 
šlšeFlow
->
Ï¡LšeBox
()->
bÙtomVisibËOv”æow
();

3026 
	gËá
 = 
fœ¡Box
->
x
();

3027 
IÆšeFlowBox
* 
	gcu¼
 = 
fœ¡Box
->
ÃxtLšeBox
(); cu¼; cu¼ = 
cu¼
->nextLineBox())

3028 
Ëá
 = 
mš
Öeá, 
cu¼
->
x
());

3029 
	g»suÉ
 = 
IÁReù
(
Ëá
, 
tİ
, 
width
(), 
bÙtom
 -op);

3030 } ià(
»nd””
()->
isTabËRow
()) {

3032 
R’d”Objeù
* 
	gchd
 = 
»nd””
()->
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
()) {

3033 ià(
chd
->
isTabËC–l
()) {

3034 
IÁReù
 
bbox
 = 
toR’d”Box
(
chd
)->
bÜd”BoxReù
();

3035 
	g»suÉ
.
un™e
(
bbox
);

3036 
IÁReù
 
	gov”æowReù
 = 
»nd”Box
()->
visibËOv”æowReù
();

3037 ià(
	gbbox
 !ğ
ov”æowReù
)

3038 
»suÉ
.
un™e
(
ov”æowReù
);

3042 
R’d”Box
* 
	gbox
 = 
»nd”Box
();

3043 
ASSERT
(
box
);

3044 ià(
	gbox
->
hasMask
())

3045 
	g»suÉ
 = 
box
->
maskClReù
();

3047 
IÁReù
 
	gbbox
 = 
box
->
bÜd”BoxReù
();

3048 
	g»suÉ
 = 
bbox
;

3049 
IÁReù
 
	gov”æowReù
 = 
box
->
visibËOv”æowReù
();

3050 ià(
	gbbox
 !ğ
ov”æowReù
)

3051 
»suÉ
.
un™e
(
ov”æowReù
);

3055 
R’d”V›w
* 
	gv›w
 = 
»nd””
()->
v›w
();

3056 
ASSERT
(
v›w
);

3057 ià(
	gv›w
)

3058 
	g»suÉ
.
šæ©e
(
v›w
->
maxim®OušeSize
());

3060  
	g»suÉ
;

3063 
IÁReù
 
	gR’d”Lay”
::
boundšgBox
(cÚ¡ 
R’d”Lay”
* 
ªû¡ÜLay”
) const

3065 
IÁReù
 
»suÉ
 = 
loÿlBoundšgBox
();

3067 
	gd–X
 = 0, 
	gd–Y
 = 0;

3068 
cÚv”tToLay”CoÜds
(
ªû¡ÜLay”
, 
d–X
, 
d–Y
);

3069 
	g»suÉ
.
move
(
d–X
, 
d–Y
);

3070  
	g»suÉ
;

3073 
IÁReù
 
	gR’d”Lay”
::
absŞu‹BoundšgBox
() const

3075  
boundšgBox
(
roÙ
());

3078 
	gR’d”Lay”
::
ş—rClReùsInşudšgDesûndªts
()

3080 ià(!
m_şReùs
)

3083 
ş—rClReùs
();

3085 
R’d”Lay”
* 
	gl
 = 
fœ¡Chd
();†;† = 
l
->
ÃxtSiblšg
())

3086 
l
->
ş—rClReùsInşudšgDesûndªts
();

3089 
	gR’d”Lay”
::
ş—rClReùs
()

3091 ià(
m_şReùs
) {

3092 
m_şReùs
->
d”ef
(
»nd””
()->
»nd”A»Ç
());

3093 
	gm_şReùs
 = 0;

3094 #iâdeà
NDEBUG


3095 
	gm_şReùsRoÙ
 = 0;

3100 #ià
USE
(
ACCELERATED_COMPOSITING
)

3101 
R’d”Lay”Backšg
* 
	gR’d”Lay”
::
’su»Backšg
()

3103 ià(!
m_backšg
)

3104 
m_backšg
.
£t
(
Ãw
 
R’d”Lay”Backšg
(
this
));

3105  
	gm_backšg
.
g‘
();

3108 
	gR’d”Lay”
::
ş—rBackšg
()

3110 
m_backšg
.
ş—r
();

3113 
boŞ
 
	gR’d”Lay”
::
hasCompos™edMask
() const

3115  
m_backšg
 && m_backšg->
hasMaskLay”
();

3119 
	gR’d”Lay”
::
£tP¬’t
(
R’d”Lay”
* 
·»Á
)

3121 ià(
·»Á
 =ğ
m_·»Á
)

3124 #ià
USE
(
ACCELERATED_COMPOSITING
)

3125 ià(
	gm_·»Á
 && !
»nd””
()->
docum’tBešgDe¡royed
())

3126 
compos™Ü
()->
Ïy”WlBeRemoved
(
m_·»Á
, 
this
);

3129 
	gm_·»Á
 = 
·»Á
;

3131 #ià
USE
(
ACCELERATED_COMPOSITING
)

3132 ià(
	gm_·»Á
 && !
»nd””
()->
docum’tBešgDe¡royed
())

3133 
compos™Ü
()->
Ïy”WasAdded
(
m_·»Á
, 
this
);

3137 
R’d”Objeù
* 
commÚAnû¡Ü
(R’d”Objeù* 
obj1
, R’d”Objeù* 
obj2
)

3139 ià(!
	gobj1
 || !
	gobj2
)

3142 
R’d”Objeù
* 
	gcu¼Obj1
 = 
obj1
; cu¼Obj1; cu¼Obj1 = 
cu¼Obj1
->
hov”Anû¡Ü
())

3143 
R’d”Objeù
* 
cu¼Obj2
 = 
obj2
; 
	gcu¼Obj2
; cu¼Obj2 = cu¼Obj2->
hov”Anû¡Ü
())

3144 ià(
cu¼Obj1
 =ğ
cu¼Obj2
)

3145  
cu¼Obj1
;

3150 
	gR’d”Lay”
::
upd©eHov”AùiveS‹
(cÚ¡ 
H™Te¡Reque¡
& 
»que¡
, 
H™Te¡ResuÉ
& 
»suÉ
)

3153 ià(
	g»que¡
.
»adOÆy
())

3156 
Docum’t
* 
	gdoc
 = 
»nd””
()->
docum’t
();

3158 
Node
* 
	gaùiveNode
 = 
doc
->
aùiveNode
();

3159 ià(
	gaùiveNode
 && !
	g»que¡
.
aùive
()) {

3161 
R’d”Objeù
* 
	gcu¼
 = 
aùiveNode
->
»nd””
(); cu¼; cu¼ = 
cu¼
->
·»Á
()) {

3162 ià(
cu¼
->
node
(è&& !cu¼->
isText
())

3163 
cu¼
->
node
()->
£tInAùiveChaš
(
çl£
);

3165 
	gdoc
->
£tAùiveNode
(0);

3167 
Node
* 
	gÃwAùiveNode
 = 
»suÉ
.
šÃrNode
();

3168 ià(!
	gaùiveNode
 && 
	gÃwAùiveNode
 && 
	g»que¡
.
aùive
()) {

3171 
R’d”Objeù
* 
	gcu¼
 = 
ÃwAùiveNode
->
»nd””
(); cu¼; cu¼ = 
cu¼
->
·»Á
()) {

3172 ià(
cu¼
->
node
(è&& !cu¼->
isText
()) {

3173 
cu¼
->
node
()->
£tInAùiveChaš
(
Œue
);

3176 
	gdoc
->
£tAùiveNode
(
ÃwAùiveNode
);

3183 
boŞ
 
	gmu¡BeInAùiveChaš
 = 
»que¡
.
aùive
(è&&„eque¡.
mou£Move
();

3187 
	gRefPŒ
<
	gNode
> 
	gŞdHov”Node
 = 
doc
->
hov”Node
();

3188 
Node
* 
	gÃwHov”Node
 = 
»suÉ
.
šÃrNode
();

3191 
	gdoc
->
£tHov”Node
(
ÃwHov”Node
);

3194 
R’d”Objeù
* 
	gŞdHov”Obj
 = 
ŞdHov”Node
 ? oldHov”Node->
»nd””
() : 0;

3195 
R’d”Objeù
* 
	gÃwHov”Obj
 = 
ÃwHov”Node
 ?‚ewHov”Node->
»nd””
() : 0;

3198 
R’d”Objeù
* 
	gªû¡Ü
 = 
commÚAnû¡Ü
(
ŞdHov”Obj
, 
ÃwHov”Obj
);

3200 ià(
	gŞdHov”Obj
 !ğ
ÃwHov”Obj
) {

3202 
R’d”Objeù
* 
cu¼
 = 
ŞdHov”Obj
; 
	gcu¼
 && cu¼ !ğ
ªû¡Ü
; cu¼ = cu¼->
hov”Anû¡Ü
()) {

3203 ià(
cu¼
->
node
(è&& !cu¼->
isText
(è&& (!
mu¡BeInAùiveChaš
 || cu¼->node()->
šAùiveChaš
())) {

3204 
cu¼
->
node
()->
£tAùive
(
çl£
);

3205 
	gcu¼
->
node
()->
£tHov”ed
(
çl£
);

3211 
R’d”Objeù
* 
	gcu¼
 = 
ÃwHov”Obj
; cu¼; cu¼ = 
cu¼
->
hov”Anû¡Ü
()) {

3212 ià(
cu¼
->
node
(è&& !cu¼->
isText
(è&& (!
mu¡BeInAùiveChaš
 || cu¼->node()->
šAùiveChaš
())) {

3213 
cu¼
->
node
()->
£tAùive
(
»que¡
.
aùive
());

3214 
	gcu¼
->
node
()->
£tHov”ed
(
Œue
);

3220 
šlše
 
boŞ
 
com·»ZIndex
(
R’d”Lay”
* 
fœ¡
, R’d”Lay”* 
£cÚd
)

3222  
	gfœ¡
->
zIndex
(è< 
	g£cÚd
->zIndex();

3225 
	gR’d”Lay”
::
dœtyZOrd”Li¡s
()

3227 ià(
m_posZOrd”Li¡
)

3228 
m_posZOrd”Li¡
->
ş—r
();

3229 ià(
	gm_ÃgZOrd”Li¡
)

3230 
	gm_ÃgZOrd”Li¡
->
ş—r
();

3231 
	gm_zOrd”Li¡sDœty
 = 
Œue
;

3233 #ià
USE
(
ACCELERATED_COMPOSITING
)

3234 ià(!
»nd””
()->
docum’tBešgDe¡royed
())

3235 
compos™Ü
()->
£tCompos™šgLay”sN“dRebud
();

3239 
	gR’d”Lay”
::
dœtySckšgCÚ‹xtZOrd”Li¡s
()

3241 
R’d”Lay”
* 
sc
 = 
¡ackšgCÚ‹xt
();

3242 ià(
	gsc
)

3243 
	gsc
->
dœtyZOrd”Li¡s
();

3246 
	gR’d”Lay”
::
dœtyNÜm®FlowLi¡
()

3248 ià(
m_nÜm®FlowLi¡
)

3249 
m_nÜm®FlowLi¡
->
ş—r
();

3250 
	gm_nÜm®FlowLi¡Dœty
 = 
Œue
;

3252 #ià
USE
(
ACCELERATED_COMPOSITING
)

3253 ià(!
»nd””
()->
docum’tBešgDe¡royed
())

3254 
compos™Ü
()->
£tCompos™šgLay”sN“dRebud
();

3258 
	gR’d”Lay”
::
upd©eZOrd”Li¡s
()

3260 ià(!
isSckšgCÚ‹xt
(è|| !
m_zOrd”Li¡sDœty
)

3263 
R’d”Lay”
* 
	gchd
 = 
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
())

3264 ià(!
m_»æeùiÚ
 || 
»æeùiÚLay”
(è!ğ
chd
)

3265 
chd
->
cŞËùLay”s
(
m_posZOrd”Li¡
, 
m_ÃgZOrd”Li¡
);

3268 ià(
	gm_posZOrd”Li¡
)

3269 
	g¡d
::
¡abË_sÜt
(
m_posZOrd”Li¡
->
begš
(), m_posZOrd”Li¡->
’d
(), 
com·»ZIndex
);

3271 ià(
	gm_ÃgZOrd”Li¡
)

3272 
	g¡d
::
¡abË_sÜt
(
m_ÃgZOrd”Li¡
->
begš
(), m_ÃgZOrd”Li¡->
’d
(), 
com·»ZIndex
);

3274 
	gm_zOrd”Li¡sDœty
 = 
çl£
;

3277 
	gR’d”Lay”
::
upd©eNÜm®FlowLi¡
()

3279 ià(!
m_nÜm®FlowLi¡Dœty
)

3282 
R’d”Lay”
* 
	gchd
 = 
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
()) {

3284 ià(
chd
->
isNÜm®FlowOÆy
(è&& (!
m_»æeùiÚ
 || 
»æeùiÚLay”
() != child)) {

3285 ià(!
m_nÜm®FlowLi¡
)

3286 
m_nÜm®FlowLi¡
 = 
Ãw
 
VeùÜ
<
R’d”Lay”
*>;

3287 
	gm_nÜm®FlowLi¡
->
­³nd
(
chd
);

3291 
	gm_nÜm®FlowLi¡Dœty
 = 
çl£
;

3294 
	gR’d”Lay”
::
cŞËùLay”s
(
VeùÜ
<
R’d”Lay”
*>*& 
posBufãr
, VeùÜ<R’d”Lay”*>*& 
ÃgBufãr
)

3296 
upd©eVisib™yStus
();

3299 ià((
	gm_hasVisibËCÚ‹Á
 || (
	gm_hasVisibËDesûndªt
 && 
isSckšgCÚ‹xt
())è&& !
isNÜm®FlowOÆy
()) {

3301 
	gVeùÜ
<
	gR’d”Lay”
*>*& 
	gbufãr
 = (
zIndex
(è>ğ0è? 
posBufãr
 : 
ÃgBufãr
;

3304 ià(!
	gbufãr
)

3305 
	gbufãr
 = 
Ãw
 
VeùÜ
<
R’d”Lay”
*>;

3308 
	gbufãr
->
­³nd
(
this
);

3313 ià(
	gm_hasVisibËDesûndªt
 && !
isSckšgCÚ‹xt
()) {

3314 
R’d”Lay”
* 
	gchd
 = 
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
()) {

3316 ià(!
m_»æeùiÚ
 || 
»æeùiÚLay”
(è!ğ
chd
)

3317 
chd
->
cŞËùLay”s
(
posBufãr
, 
ÃgBufãr
);

3322 
	gR’d”Lay”
::
upd©eLay”Li¡sIfN“ded
()

3324 
upd©eZOrd”Li¡s
();

3325 
upd©eNÜm®FlowLi¡
();

3328 
	gR’d”Lay”
::
upd©eCompos™šgAndLay”Li¡sIfN“ded
()

3330 #ià
USE
(
ACCELERATED_COMPOSITING
)

3331 ià(
compos™Ü
()->
šCompos™šgMode
()) {

3332 ià((
isSckšgCÚ‹xt
(è&& 
m_zOrd”Li¡sDœty
è|| 
m_nÜm®FlowLi¡Dœty
)

3333 
compos™Ü
()->
upd©eCompos™šgLay”s
(
Compos™šgUpd©eOnPa™šgOrH™Te¡
, 
this
);

3337 
upd©eLay”Li¡sIfN“ded
();

3340 
	gR’d”Lay”
::
»·štInşudšgDesûndªts
()

3342 
»nd””
()->
»·št
();

3343 
R’d”Lay”
* 
	gcu¼
 = 
fœ¡Chd
(); cu¼; cu¼ = 
cu¼
->
ÃxtSiblšg
())

3344 
cu¼
->
»·štInşudšgDesûndªts
();

3347 #ià
USE
(
ACCELERATED_COMPOSITING
)

3348 
	gR’d”Lay”
::
£tBackšgN“dsR•ašt
()

3350 
ASSERT
(
isCompos™ed
());

3351 ià(
backšg
()->
·štšgGÛsToWšdow
()) {

3354 
R’d”V›w
* 
	gv›w
 = 
»nd””
()->
v›w
();

3355 ià(
	gv›w
)

3356 
	gv›w
->
»·štV›wReùªgË
(
absŞu‹BoundšgBox
());

3358 
backšg
()->
£tCÚ‹ÁsN“dDi¥Ïy
();

3361 
	gR’d”Lay”
::
£tBackšgN“dsR•aštInReù
(cÚ¡ 
IÁReù
& 
r
)

3363 
ASSERT
(
isCompos™ed
());

3364 ià(
backšg
()->
·štšgGÛsToWšdow
()) {

3367 
IÁReù
 
absReù
(
r
);

3368 
	gx
 = 0;

3369 
	gy
 = 0;

3370 
cÚv”tToLay”CoÜds
(
roÙ
(), 
x
, 
y
);

3371 
	gabsReù
.
move
(
x
, 
y
);

3373 
R’d”V›w
* 
	gv›w
 = 
»nd””
()->
v›w
();

3374 ià(
	gv›w
)

3375 
	gv›w
->
»·štV›wReùªgË
(
absReù
);

3377 
backšg
()->
£tCÚ‹ÁsN“dDi¥ÏyInReù
(
r
);

3381 
	gR’d”Lay”
::
»·štInşudšgNÚCompos™šgDesûndªts
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
)

3383 
»nd””
()->
»·štUsšgCÚš”
(
»·štCÚš”
,„’d””()->
ş³dOv”æowReùFÜR•ašt
(repaintContainer));

3385 
R’d”Lay”
* 
	gcu¼
 = 
fœ¡Chd
(); cu¼; cu¼ = 
cu¼
->
ÃxtSiblšg
()) {

3386 ià(!
cu¼
->
isCompos™ed
())

3387 
cu¼
->
»·štInşudšgNÚCompos™šgDesûndªts
(
»·štCÚš”
);

3392 
boŞ
 
	gR’d”Lay”
::
shouldBeNÜm®FlowOÆy
() const

3394  (
»nd””
()->
hasOv”æowCl
(è||„’d””()->
hasReæeùiÚ
(è||„’d””()->
hasMask
(è||„’d””()->
isVideo
(è||„’d””()->
isEmbeddedObjeù
()) &&

3395 !
»nd””
()->
isPos™iÚed
() &&

3396 !
»nd””
()->
isR–Pos™iÚed
() &&

3397 !
»nd””
()->
hasT¿nsfÜm
() &&

3398 !
isT¿n¥¬’t
();

3401 
boŞ
 
	gR’d”Lay”
::
isS–fPaštšgLay”
() const

3403  !
isNÜm®FlowOÆy
(è|| 
»nd””
()->
hasReæeùiÚ
(è||„’d””()->
hasMask
(è||„’d””()->
isTabËRow
(è||„’d””()->
isVideo
(è||„’d””()->
isEmbeddedObjeù
();

3406 
	gR’d”Lay”
::
¡yËChªged
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
*)

3408 
boŞ
 
	gisNÜm®FlowOÆy
 = 
shouldBeNÜm®FlowOÆy
();

3409 ià(
	gisNÜm®FlowOÆy
 !ğ
m_isNÜm®FlowOÆy
) {

3410 
m_isNÜm®FlowOÆy
 = 
isNÜm®FlowOÆy
;

3411 
R’d”Lay”
* 
	gp
 = 
·»Á
();

3412 ià(
	gp
)

3413 
	gp
->
dœtyNÜm®FlowLi¡
();

3414 
dœtySckšgCÚ‹xtZOrd”Li¡s
();

3417 ià(
»nd””
()->
¡yË
()->
ov”æowX
(è=ğ
OMARQUEE
 &&„’d””()->¡yË()->
m¬qu“BehaviÜ
(è!ğ
MNONE
 &&„’d””()->
isBox
()) {

3418 ià(!
m_m¬qu“
)

3419 
m_m¬qu“
 = 
Ãw
 
R’d”M¬qu“
(
this
);

3420 
	gm_m¬qu“
->
upd©eM¬qu“StyË
();

3422 ià(
	gm_m¬qu“
) {

3423 
d–‘e
 
	gm_m¬qu“
;

3424 
	gm_m¬qu“
 = 0;

3427 ià(!
hasReæeùiÚ
(è&& 
	gm_»æeùiÚ
)

3428 
»moveReæeùiÚ
();

3429 ià(
hasReæeùiÚ
()) {

3430 ià(!
	gm_»æeùiÚ
)

3431 
ü—‹ReæeùiÚ
();

3432 
upd©eReæeùiÚStyË
();

3436 ià(
	gm_hB¬
)

3437 
	gm_hB¬
->
¡yËChªged
();

3438 ià(
	gm_vB¬
)

3439 
	gm_vB¬
->
¡yËChªged
();

3441 
upd©eSüŞlCÜÃrStyË
();

3442 
upd©eResiz”StyË
();

3444 #ià
USE
(
ACCELERATED_COMPOSITING
)

3445 
upd©eT¿nsfÜm
();

3447 ià(
compos™Ü
()->
upd©eLay”Compos™šgS‹
(
this
))

3448 
compos™Ü
()->
£tCompos™šgLay”sN“dRebud
();

3449 ià(
	gm_backšg
)

3450 
	gm_backšg
->
upd©eG¿phicsLay”Geom‘ry
();

3452 ià(
	gm_backšg
 && 
	gdiff
 >ğ
StyËDifã»nûR•ašt
)

3453 
m_backšg
->
£tCÚ‹ÁsN“dDi¥Ïy
();

3455 
UNUSED_PARAM
(
diff
);

3459 
	gR’d”Lay”
::
upd©eSüŞlCÜÃrStyË
()

3461 
R’d”Objeù
* 
aùu®R’d””
 = 
»nd””
()->
node
(è?„’d””()->node()->
shadowAnû¡ÜNode
()->renderer() :„enderer();

3462 
	gRefPŒ
<
	gR’d”StyË
> 
	gcÜÃr
 = 
»nd””
()->
hasOv”æowCl
(è? 
aùu®R’d””
->
g‘UnÿchedP£udoStyË
(
SCROLLBAR_CORNER
,‡ùu®R’d””->
¡yË
()) : 0;

3463 ià(
	gcÜÃr
) {

3464 ià(!
	gm_süŞlCÜÃr
) {

3465 
	gm_süŞlCÜÃr
 = 
Ãw
 (
»nd””
()->
»nd”A»Ç
()è
R’d”SüŞlb¬P¬t
Ô’d””()->
docum’t
());

3466 
	gm_süŞlCÜÃr
->
£tP¬’t
(
»nd””
());

3468 
	gm_süŞlCÜÃr
->
£tStyË
(
cÜÃr
.
»Ëa£
());

3469 } ià(
	gm_süŞlCÜÃr
) {

3470 
	gm_süŞlCÜÃr
->
de¡roy
();

3471 
	gm_süŞlCÜÃr
 = 0;

3475 
	gR’d”Lay”
::
upd©eResiz”StyË
()

3477 
R’d”Objeù
* 
aùu®R’d””
 = 
»nd””
()->
node
(è?„’d””()->node()->
shadowAnû¡ÜNode
()->renderer() :„enderer();

3478 
	gRefPŒ
<
	gR’d”StyË
> 
	g»siz”
 = 
»nd””
()->
hasOv”æowCl
(è? 
aùu®R’d””
->
g‘UnÿchedP£udoStyË
(
RESIZER
,‡ùu®R’d””->
¡yË
()) : 0;

3479 ià(
	g»siz”
) {

3480 ià(!
	gm_»siz”
) {

3481 
	gm_»siz”
 = 
Ãw
 (
»nd””
()->
»nd”A»Ç
()è
R’d”SüŞlb¬P¬t
Ô’d””()->
docum’t
());

3482 
	gm_»siz”
->
£tP¬’t
(
»nd””
());

3484 
	gm_»siz”
->
£tStyË
(
»siz”
.
»Ëa£
());

3485 } ià(
	gm_»siz”
) {

3486 
	gm_»siz”
->
de¡roy
();

3487 
	gm_»siz”
 = 0;

3491 
R’d”Lay”
* 
	gR’d”Lay”
::
»æeùiÚLay”
() const

3493  
m_»æeùiÚ
 ? m_»æeùiÚ->
Ïy”
() : 0;

3496 
	gR’d”Lay”
::
ü—‹ReæeùiÚ
()

3498 
ASSERT
(!
m_»æeùiÚ
);

3499 
	gm_»æeùiÚ
 = 
Ãw
 (
»nd””
()->
»nd”A»Ç
()è
R’d”R•liÿ
Ô’d””()->
docum’t
());

3500 
	gm_»æeùiÚ
->
£tP¬’t
(
»nd””
());

3503 
	gR’d”Lay”
::
»moveReæeùiÚ
()

3505 ià(!
m_»æeùiÚ
->
docum’tBešgDe¡royed
())

3506 
m_»æeùiÚ
->
»moveLay”s
(
this
);

3508 
	gm_»æeùiÚ
->
£tP¬’t
(0);

3509 
	gm_»æeùiÚ
->
de¡roy
();

3510 
	gm_»æeùiÚ
 = 0;

3513 
	gR’d”Lay”
::
upd©eReæeùiÚStyË
()

3515 
RefPŒ
<
R’d”StyË
> 
ÃwStyË
 = R’d”StyË::
ü—‹
();

3516 
	gÃwStyË
->
šh”™From
(
»nd””
()->
¡yË
());

3519 
T¿nsfÜmO³¿tiÚs
 
	gŒªsfÜm
;

3520 
»nd””
()->
¡yË
()->
boxReæeù
()->
dœeùiÚ
()) {

3521 
	gReæeùiÚB–ow
:

3522 
ŒªsfÜm
.
İ”©iÚs
().
­³nd
(
T¿n¦©eT¿nsfÜmO³¿tiÚ
::
ü—‹
(
L’gth
(0, 
Fixed
), L’gth(100., 
P”ûÁ
), 
T¿nsfÜmO³¿tiÚ
::
TRANSLATE
));

3523 
	gŒªsfÜm
.
İ”©iÚs
().
­³nd
(
T¿n¦©eT¿nsfÜmO³¿tiÚ
::
ü—‹
(
L’gth
(0, 
Fixed
), 
»nd””
()->
¡yË
()->
boxReæeù
()->
off£t
(), 
T¿nsfÜmO³¿tiÚ
::
TRANSLATE
));

3524 
	gŒªsfÜm
.
İ”©iÚs
().
­³nd
(
SÿËT¿nsfÜmO³¿tiÚ
::
ü—‹
(1.0, -1.0, SÿËT¿nsfÜmO³¿tiÚ::
SCALE
));

3526 
	gReæeùiÚAbove
:

3527 
ŒªsfÜm
.
İ”©iÚs
().
­³nd
(
SÿËT¿nsfÜmO³¿tiÚ
::
ü—‹
(1.0, -1.0, SÿËT¿nsfÜmO³¿tiÚ::
SCALE
));

3528 
	gŒªsfÜm
.
İ”©iÚs
().
­³nd
(
T¿n¦©eT¿nsfÜmO³¿tiÚ
::
ü—‹
(
L’gth
(0, 
Fixed
), L’gth(100., 
P”ûÁ
), 
T¿nsfÜmO³¿tiÚ
::
TRANSLATE
));

3529 
	gŒªsfÜm
.
İ”©iÚs
().
­³nd
(
T¿n¦©eT¿nsfÜmO³¿tiÚ
::
ü—‹
(
L’gth
(0, 
Fixed
), 
»nd””
()->
¡yË
()->
boxReæeù
()->
off£t
(), 
T¿nsfÜmO³¿tiÚ
::
TRANSLATE
));

3531 
	gReæeùiÚRight
:

3532 
ŒªsfÜm
.
İ”©iÚs
().
­³nd
(
T¿n¦©eT¿nsfÜmO³¿tiÚ
::
ü—‹
(
L’gth
(100., 
P”ûÁ
), L’gth(0, 
Fixed
), 
T¿nsfÜmO³¿tiÚ
::
TRANSLATE
));

3533 
	gŒªsfÜm
.
İ”©iÚs
().
­³nd
(
T¿n¦©eT¿nsfÜmO³¿tiÚ
::
ü—‹
(
»nd””
()->
¡yË
()->
boxReæeù
()->
off£t
(), 
L’gth
(0, 
Fixed
), 
T¿nsfÜmO³¿tiÚ
::
TRANSLATE
));

3534 
	gŒªsfÜm
.
İ”©iÚs
().
­³nd
(
SÿËT¿nsfÜmO³¿tiÚ
::
ü—‹
(-1.0, 1.0, SÿËT¿nsfÜmO³¿tiÚ::
SCALE
));

3536 
	gReæeùiÚLeá
:

3537 
ŒªsfÜm
.
İ”©iÚs
().
­³nd
(
SÿËT¿nsfÜmO³¿tiÚ
::
ü—‹
(-1.0, 1.0, SÿËT¿nsfÜmO³¿tiÚ::
SCALE
));

3538 
	gŒªsfÜm
.
İ”©iÚs
().
­³nd
(
T¿n¦©eT¿nsfÜmO³¿tiÚ
::
ü—‹
(
L’gth
(100., 
P”ûÁ
), L’gth(0, 
Fixed
), 
T¿nsfÜmO³¿tiÚ
::
TRANSLATE
));

3539 
	gŒªsfÜm
.
İ”©iÚs
().
­³nd
(
T¿n¦©eT¿nsfÜmO³¿tiÚ
::
ü—‹
(
»nd””
()->
¡yË
()->
boxReæeù
()->
off£t
(), 
L’gth
(0, 
Fixed
), 
T¿nsfÜmO³¿tiÚ
::
TRANSLATE
));

3542 
	gÃwStyË
->
£tT¿nsfÜm
(
ŒªsfÜm
);

3545 
	gÃwStyË
->
£tMaskBoxImage
(
»nd””
()->
¡yË
()->
boxReæeù
()->
mask
());

3547 
	gm_»æeùiÚ
->
£tStyË
(
ÃwStyË
.
»Ëa£
());

3549 #iâdeà
NDEBUG


3551 
	gR’d”Lay”
::
showR’d”Lay”
() const

3553 cÚ¡ 
R’d”Lay”
* 
roÙLay”
 = 
roÙ
();

3554 if(
	groÙLay”
 =ğ
NULL
)

3557 
	g´efix
[100];

3558 
	gi
=0;

3559 cÚ¡ 
R’d”Lay”
* 
	gtmpLay”
 = 
this
;mpLay” &&mpLay” !ğ
roÙLay”
;mpLay” = 
tmpLay”
->
·»Á
())

3560 
i
++;

3561 
mem£t
(
´efix
,'\t',
i
);

3562 
	g´efix
[
i
]='\0';

3564 
Node
* 
	gnode
 = 
»nd””
()->
node
();

3565 if(
	gnode
 !ğ
NULL
){

3566 
node
->
showNode
(
´efix
);

3568 cÚ¡ 
R’d”Lay”
* 
	gtmpLay”
 = 
this
;mpLay” &&mpLay” !ğ
roÙLay”
;mpLay” = 
tmpLay”
->
·»Á
())

3569 
årštf
(
¡d”r
, "\t");

3570 
årštf
(
¡d”r
, "[ x:%d y:%d w:%d h:%d ]\n",
m_x
,
m_y
,
m_width
,
m_height
 );

3573 
	gR’d”Lay”
::
showT»eFÜThis
() const

3575 cÚ¡ 
R’d”Lay”
* 
roÙLay”
 = 
roÙ
();

3576 if(
	groÙLay”
 =ğ
NULL
)

3579 
showR’d”Lay”
();

3581 
R’d”Lay”
* 
	gchd
 = 
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
()) {

3582 
chd
->
showT»eFÜThis
();

3590 #iâdeà
NDEBUG


3591 
showLay”T»e
(cÚ¡ 
WebCÜe
::
R’d”Lay”
* 
Ïy”
)

3593 ià(!
Ïy”
)

3596 ià(
	gWebCÜe
::
F¿me
* 
äame
 = 
Ïy”
->
»nd””
()->
docum’t
()->frame()) {

3597 
WebCÜe
::
SŒšg
 
ouut
 = 
ex‹º®R•»£Á©iÚ
(
äame
, WebCÜe::
R’d”AsTextShowAÎLay”s
 | WebCÜe::
R’d”AsTextShowLay”Ne¡šg
 | WebCÜe::
R’d”AsTextShowCompos™edLay”s
 | WebCÜe::
R’d”AsTextShowAdd»s£s
);

3598 
årštf
(
¡d”r
, "%s\n", 
ouut
.
utf8
().
d©a
());

	@RenderLayer.h

44 #iâdeà
R’d”Lay”_h


45 
	#R’d”Lay”_h


	)

47 
	~"R’d”Box.h
"

48 
	~"SüŞlBehaviÜ.h
"

49 
	~"SüŞlb¬Cl›Á.h
"

50 
	~"Tim”.h
"

51 
	~<wtf/OwnPŒ.h
>

53 
Çme¥aû
 
	gWebCÜe
 {

55 
şass
 
	gCachedResourû
;

56 
şass
 
	gH™Te¡Reque¡
;

57 
şass
 
	gH™Te¡ResuÉ
;

58 
şass
 
	gH™Te¡šgT¿nsfÜmS‹
;

59 
şass
 
	gR’d”F¿meS‘
;

60 
şass
 
	gR’d”M¬qu“
;

61 
şass
 
	gR’d”R•liÿ
;

62 
şass
 
	gR’d”SüŞlb¬P¬t
;

63 
şass
 
	gR’d”StyË
;

64 
şass
 
	gR’d”TabË
;

65 
şass
 
	gR’d”Text
;

66 
şass
 
	gR’d”V›w
;

67 
şass
 
	gSüŞlb¬
;

68 
şass
 
	gT¿nsfÜm©iÚM©rix
;

70 #ià
USE
(
ACCELERATED_COMPOSITING
)

71 
şass
 
	gR’d”Lay”Backšg
;

72 
şass
 
	gR’d”Lay”Compos™Ü
;

75 şas 
	cClReùs
 {

76 
	gpublic
:

77 
ClReùs
()

78 : 
m_»fCÁ
(0)

79 , 
m_fixed
(
çl£
)

83 
ClReùs
(cÚ¡ 
IÁReù
& 
r
)

84 : 
m_ov”æowClReù
(
r
)

85 , 
m_fixedClReù
(
r
)

86 , 
m_posClReù
(
r
)

87 , 
m_»fCÁ
(0)

88 , 
m_fixed
(
çl£
)

92 
ClReùs
(cÚ¡ ClReùs& 
Ùh”
)

93 : 
m_ov”æowClReù
(
Ùh”
.
ov”æowClReù
())

94 , 
m_fixedClReù
(
Ùh”
.
fixedClReù
())

95 , 
m_posClReù
(
Ùh”
.
posClReù
())

96 , 
m_»fCÁ
(0)

97 , 
m_fixed
(
Ùh”
.
fixed
())

101 
»£t
(cÚ¡ 
IÁReù
& 
r
)

103 
	gm_ov”æowClReù
 = 
r
;

104 
	gm_fixedClReù
 = 
r
;

105 
	gm_posClReù
 = 
r
;

106 
	gm_fixed
 = 
çl£
;

109 cÚ¡ 
	gIÁReù
& 
ov”æowClReù
(ècÚ¡ {  
	gm_ov”æowClReù
; }

110 
£tOv”æowClReù
(cÚ¡ 
IÁReù
& 
r
è{ 
	gm_ov”æowClReù
 =„; }

112 cÚ¡ 
	gIÁReù
& 
fixedClReù
(ècÚ¡ {  
	gm_fixedClReù
; }

113 
£tFixedClReù
(cÚ¡ 
IÁReù
&
r
è{ 
	gm_fixedClReù
 =„; }

115 cÚ¡ 
	gIÁReù
& 
posClReù
(ècÚ¡ {  
	gm_posClReù
; }

116 
£tPosClReù
(cÚ¡ 
IÁReù
& 
r
è{ 
	gm_posClReù
 =„; }

118 
boŞ
 
fixed
(ècÚ¡ {  
	gm_fixed
; }

119 
£tFixed
(
boŞ
 
fixed
è{ 
	gm_fixed
 = fixed; }

121 
»f
(è{ 
	gm_»fCÁ
++; }

122 
d”ef
(
R’d”A»Ç
* 
»nd”A»Ç
è{ ià(--
	gm_»fCÁ
 =ğ0è
de¡roy
(renderArena); }

124 
de¡roy
(
R’d”A»Ç
*);

127 * 
İ”©Ü
 
Ãw
(
size_t
, 
R’d”A»Ç
*è
throw
();

130 
İ”©Ü
 
d–‘e
(*, 
size_t
);

132 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
ClReùs
& 
Ùh”
) const

134  
m_ov”æowClReù
 =ğ
Ùh”
.
ov”æowClReù
() &&

135 
m_fixedClReù
 =ğ
Ùh”
.
fixedClReù
() &&

136 
m_posClReù
 =ğ
Ùh”
.
posClReù
() &&

137 
m_fixed
 =ğ
Ùh”
.
fixed
();

140 
	gClReùs
& 
	gİ”©Ü
=(cÚ¡ 
ClReùs
& 
Ùh”
)

142 
m_ov”æowClReù
 = 
Ùh”
.
ov”æowClReù
();

143 
	gm_fixedClReù
 = 
Ùh”
.
fixedClReù
();

144 
	gm_posClReù
 = 
Ùh”
.
posClReù
();

145 
	gm_fixed
 = 
Ùh”
.
fixed
();

146  *
	gthis
;

149 
IÁReù
 
šfš™eReù
(è{  IÁReù(
INT_MIN
/2, INT_MIN/2, 
INT_MAX
, INT_MAX); }

151 
	g´iv©e
:

153 * 
İ”©Ü
 
Ãw
(
size_t
è
throw
();

155 
	g´iv©e
:

156 
IÁReù
 
m_ov”æowClReù
;

157 
IÁReù
 
	gm_fixedClReù
;

158 
IÁReù
 
	gm_posClReù
;

159 
	gm_»fCÁ
 : 31;

160 
boŞ
 
	gm_fixed
 : 1;

163 şas 
	cR’d”Lay”
 : 
public
 
SüŞlb¬Cl›Á
 {

164 
public
:

165 
ä›nd
 
şass
 
R’d”R•liÿ
;

167 
R’d”Lay”
(
R’d”BoxMod–Objeù
*);

168 ~
R’d”Lay”
();

170 
R’d”BoxMod–Objeù
* 
»nd””
(ècÚ¡ {  
	gm_»nd””
; }

171 
R’d”Box
* 
»nd”Box
(ècÚ¡ {  
	gm_»nd””
 && m_»nd””->
isBox
(è? 
toR’d”Box
(
m_»nd””
) : 0; }

172 
R’d”Lay”
* 
·»Á
(ècÚ¡ {  
	gm_·»Á
; }

173 
R’d”Lay”
* 
´eviousSiblšg
(ècÚ¡ {  
	gm_´evious
; }

174 
R’d”Lay”
* 
ÃxtSiblšg
(ècÚ¡ {  
	gm_Ãxt
; }

175 
R’d”Lay”
* 
fœ¡Chd
(ècÚ¡ {  
	gm_fœ¡
; }

176 
R’d”Lay”
* 
Ï¡Chd
(ècÚ¡ {  
	gm_Ï¡
; }

178 
addChd
(
R’d”Lay”
* 
ÃwChd
, R’d”Lay”* 
befÜeChd
 = 0);

179 
R’d”Lay”
* 
»moveChd
(RenderLayer*);

181 
»moveOÆyThisLay”
();

182 
š£¹OÆyThisLay”
();

184 
»·štInşudšgDesûndªts
();

186 #ià
USE
(
ACCELERATED_COMPOSITING
)

189 
£tBackšgN“dsR•ašt
();

190 
£tBackšgN“dsR•aštInReù
(cÚ¡ 
IÁReù
& 
r
);

191 
»·štInşudšgNÚCompos™šgDesûndªts
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
);

194 
¡yËChªged
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
*);

196 
R’d”M¬qu“
* 
m¬qu“
(ècÚ¡ {  
	gm_m¬qu“
; }

198 
boŞ
 
isNÜm®FlowOÆy
(ècÚ¡ {  
	gm_isNÜm®FlowOÆy
; }

199 
boŞ
 
isS–fPaštšgLay”
() const;

201 
boŞ
 
»quœesSlowR•ašts
() const;

203 
boŞ
 
isT¿n¥¬’t
() const;

204 
R’d”Lay”
* 
Œª¥¬’tPaštšgAnû¡Ü
();

205 
begšT¿n¥¬’cyLay”s
(
G¿phicsCÚ‹xt
*, cÚ¡ 
R’d”Lay”
* 
roÙLay”
, 
PaštBehaviÜ
);

207 
boŞ
 
hasReæeùiÚ
(ècÚ¡ {  
»nd””
()->hasReflection(); }

208 
boŞ
 
isReæeùiÚ
(ècÚ¡ {  
»nd””
()->
isR•liÿ
(); }

209 
R’d”R•liÿ
* 
»æeùiÚ
(ècÚ¡ {  
	gm_»æeùiÚ
; }

210 
R’d”Lay”
* 
»æeùiÚLay”
() const;

212 cÚ¡ 
R’d”Lay”
* 
roÙ
() const

214 cÚ¡ 
R’d”Lay”
* 
	gcu¼
 = 
this
;

215 
	gcu¼
->
·»Á
())

216 
	gcu¼
 = 
cu¼
->
·»Á
();

217  
	gcu¼
;

220 
x
(ècÚ¡ {  
	gm_x
; }

221 
y
(ècÚ¡ {  
	gm_y
; }

222 
£tLoÿtiÚ
(
x
, 
y
)

224 
	gm_x
 = 
x
;

225 
	gm_y
 = 
y
;

228 
width
(ècÚ¡ {  
	gm_width
; }

229 
height
(ècÚ¡ {  
	gm_height
; }

230 
IÁSize
 
size
(ècÚ¡ {  IÁSize(
m_width
, 
m_height
); }

232 
£tWidth
(
w
è{ 
	gm_width
 = w; }

233 
£tHeight
(
h
è{ 
	gm_height
 = h; }

235 
süŞlWidth
();

236 
süŞlHeight
();

238 
·nSüŞlFromPošt
(cÚ¡ 
IÁPošt
&);

241 
süŞlByRecursiv–y
(
xD–
, 
yD–
);

243 
IÁSize
 
süŞËdCÚ‹ÁOff£t
(ècÚ¡ {  IÁSize(
süŞlXOff£t
(è+ 
m_süŞlLeáOv”æow
, 
süŞlYOff£t
()); }

245 
süŞlXOff£t
(ècÚ¡ {  
	gm_süŞlX
 + 
	gm_süŞlOrigšX
; }

246 
süŞlYOff£t
(ècÚ¡ {  
	gm_süŞlY
; }

248 
süŞlToOff£t
(
x
, 
y
, 
boŞ
 
upd©eSüŞlb¬s
 = 
Œue
, boŞ 
»·št
 =rue);

249 
süŞlToXOff£t
(
x
è{ 
süŞlToOff£t
(x, 
m_süŞlY
); }

250 
süŞlToYOff£t
(
y
è{ 
süŞlToOff£t
(
m_süŞlX
 + 
m_süŞlOrigšX
, y); }

251 
süŞlReùToVisibË
(cÚ¡ 
IÁReù
&, 
boŞ
 
süŞlToAnchÜ
 = 
çl£
, cÚ¡ 
SüŞlAlignm’t
& 
®ignX
 = SüŞlAlignm’t::
®ignC’‹rIfN“ded
, cÚ¡ SüŞlAlignm’t& 
®ignY
 = ScrollAlignment::alignCenterIfNeeded);

253 
IÁReù
 
g‘ReùToExpo£
(cÚ¡ IÁReù& 
visibËReù
, cÚ¡ IÁReù& 
expo£Reù
, cÚ¡ 
SüŞlAlignm’t
& 
®ignX
, cÚ¡ SüŞlAlignm’t& 
®ignY
);

255 
£tHasHÜizÚlSüŞlb¬
(
boŞ
);

256 
£tHasV”tiÿlSüŞlb¬
(
boŞ
);

258 
	gPassRefPŒ
<
	gSüŞlb¬
> 
ü—‹SüŞlb¬
(
SüŞlb¬Or›Á©iÚ
);

259 
de¡roySüŞlb¬
(
SüŞlb¬Or›Á©iÚ
);

261 
SüŞlb¬
* 
hÜizÚlSüŞlb¬
(ècÚ¡ {  
	gm_hB¬
.
g‘
(); }

262 
SüŞlb¬
* 
v”tiÿlSüŞlb¬
(ècÚ¡ {  
	gm_vB¬
.
g‘
(); }

264 
v”tiÿlSüŞlb¬Width
() const;

265 
hÜizÚlSüŞlb¬Height
() const;

267 
boŞ
 
hasOv”æowCÚŒŞs
() const;

268 
pos™iÚOv”æowCÚŒŞs
(
tx
, 
ty
);

269 
boŞ
 
isPoštInResizeCÚŒŞ
(cÚ¡ 
IÁPošt
& 
absŞu‹Pošt
) const;

270 
boŞ
 
h™Te¡Ov”æowCÚŒŞs
(
H™Te¡ResuÉ
&, cÚ¡ 
IÁPošt
& 
loÿlPošt
);

271 
IÁSize
 
off£tFromResizeCÜÃr
(cÚ¡ 
IÁPošt
& 
absŞu‹Pošt
) const;

273 
·štOv”æowCÚŒŞs
(
G¿phicsCÚ‹xt
*, 
tx
, 
ty
, cÚ¡ 
IÁReù
& 
damageReù
);

274 
·štSüŞlCÜÃr
(
G¿phicsCÚ‹xt
*, 
tx
, 
ty
, cÚ¡ 
IÁReù
& 
damageReù
);

275 
·štResiz”
(
G¿phicsCÚ‹xt
*, 
tx
, 
ty
, cÚ¡ 
IÁReù
& 
damageReù
);

277 
upd©eSüŞlInfoAá”Layout
();

279 
boŞ
 
süŞl
(
SüŞlDœeùiÚ
, 
SüŞlG¿nuÏr™y
, 
muÉl›r
 = 1.0f);

280 
autosüŞl
();

282 
»size
(cÚ¡ 
PÏtfÜmMou£Ev’t
&, cÚ¡ 
IÁSize
&);

283 
boŞ
 
šResizeMode
(ècÚ¡ {  
	gm_šResizeMode
; }

284 
£tInResizeMode
(
boŞ
 
b
è{ 
	gm_šResizeMode
 = b; }

286 
boŞ
 
isRoÙLay”
(ècÚ¡ {  
»nd””
()->
isR’d”V›w
(); }

288 #ià
USE
(
ACCELERATED_COMPOSITING
)

289 
R’d”Lay”Compos™Ü
* 
compos™Ü
() const;

293 
»nd””CÚ‹ÁChªged
();

297 
boŞ
 
hasAcûË¿‹dCompos™šg
() const;

299 
upd©eLay”Pos™iÚ
();

301 
	eUpd©eLay”Pos™iÚsFÏg
 {

302 
	gDoFuÎR•ašt
 = 1,

303 
	gCheckFÜR•ašt
 = 1 << 1,

304 
	gIsCompos™šgUpd©eRoÙ
 = 1 << 2,

305 
	gUpd©eCompos™šgLay”s
 = 1 << 3,

307 
	tUpd©eLay”Pos™iÚsFÏgs
;

308 
upd©eLay”Pos™iÚs
(
Upd©eLay”Pos™iÚsFÏgs
 = 
DoFuÎR•ašt
 | 
IsCompos™šgUpd©eRoÙ
 | 
Upd©eCompos™šgLay”s
, 
IÁPošt
* 
ÿchedOff£t
 = 0);

310 
upd©eT¿nsfÜm
();

312 
»ÏtivePos™iÚOff£t
(& 
»lX
, & 
»lY
ècÚ¡ { 
	g»lX
 +ğ
m_»lX
; 
	g»lY
 +ğ
m_»lY
; }

313 
IÁSize
 
»ÏtivePos™iÚOff£t
(ècÚ¡ {  IÁSize(
m_»lX
, 
m_»lY
); }

315 
ş—rClReùsInşudšgDesûndªts
();

316 
ş—rClReùs
();

318 
addBlockS–eùiÚG­sBounds
(cÚ¡ 
IÁReù
&);

319 
ş—rBlockS–eùiÚG­sBounds
();

320 
»·štBlockS–eùiÚG­s
();

324 
R’d”Lay”
* 
¡ackšgCÚ‹xt
() const;

325 
boŞ
 
isSckšgCÚ‹xt
(ècÚ¡ {  !
hasAutoZIndex
(è|| 
»nd””
()->
isR’d”V›w
(); }

327 
dœtyZOrd”Li¡s
();

328 
dœtySckšgCÚ‹xtZOrd”Li¡s
();

329 
upd©eZOrd”Li¡s
();

330 
	gVeùÜ
<
	gR’d”Lay”
*>* 
posZOrd”Li¡
(ècÚ¡ {  
	gm_posZOrd”Li¡
; }

331 
	gVeùÜ
<
	gR’d”Lay”
*>* 
ÃgZOrd”Li¡
(ècÚ¡ {  
	gm_ÃgZOrd”Li¡
; }

333 
dœtyNÜm®FlowLi¡
();

334 
upd©eNÜm®FlowLi¡
();

335 
	gVeùÜ
<
	gR’d”Lay”
*>* 
nÜm®FlowLi¡
(ècÚ¡ {  
	gm_nÜm®FlowLi¡
; }

337 
boŞ
 
hasVisibËCÚ‹Á
(ècÚ¡ {  
	gm_hasVisibËCÚ‹Á
; }

338 
boŞ
 
hasVisibËDesûndªt
(ècÚ¡ {  
	gm_hasVisibËDesûndªt
; }

339 
£tHasVisibËCÚ‹Á
(
boŞ
);

340 
dœtyVisibËCÚ‹ÁStus
();

344 
R’d”Lay”
* 
’şosšgPos™iÚedAnû¡Ü
() const;

347 
R’d”Lay”
* 
şpšgRoÙ
() const;

349 #ià
USE
(
ACCELERATED_COMPOSITING
)

351 
R’d”Lay”
* 
’şosšgCompos™šgLay”
(
boŞ
 
šşudeS–f
 = 
Œue
) const;

353 
R’d”Lay”
* 
ªû¡ÜCompos™šgLay”
(ècÚ¡ {  
’şosšgCompos™šgLay”
(
çl£
); }

356 
cÚv”tToLay”CoÜds
(cÚ¡ 
R’d”Lay”
* 
ªû¡ÜLay”
, & 
x
, & 
y
) const;

358 
boŞ
 
hasAutoZIndex
(ècÚ¡ {  
»nd””
()->
¡yË
()->hasAutoZIndex(); }

359 
zIndex
(ècÚ¡ {  
»nd””
()->
¡yË
()->zIndex(); }

365 
·št
(
G¿phicsCÚ‹xt
*, cÚ¡ 
IÁReù
& 
damageReù
, 
PaštBehaviÜ
 = 
PaštBehaviÜNÜm®
, 
R’d”Objeù
* 
·štšgRoÙ
 = 0);

366 
boŞ
 
h™Te¡
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&);

371 
ÿlcuÏ‹Reùs
(cÚ¡ 
R’d”Lay”
* 
roÙLay”
, cÚ¡ 
IÁReù
& 
·štDœtyReù
, IÁReù& 
Ïy”Bounds
,

372 
IÁReù
& 
backgroundReù
, IÁReù& 
fÜegroundReù
, IÁReù& 
oušeReù
, 
boŞ
 
‹mpÜ¬yClReùs
 = 
çl£
) const;

375 
upd©eClReùs
(cÚ¡ 
R’d”Lay”
* 
roÙLay”
);

378 
ÿlcuÏ‹ClReùs
(cÚ¡ 
R’d”Lay”
* 
roÙLay”
, 
ClReùs
&, 
boŞ
 
u£Cached
 = 
çl£
) const;

379 
ClReùs
* 
şReùs
(ècÚ¡ {  
	gm_şReùs
; }

381 
IÁReù
 
chd»nClReù
() const;

382 
IÁReù
 
£lfClReù
() const;

384 
boŞ
 
š‹r£ùsDamageReù
(cÚ¡ 
IÁReù
& 
Ïy”Bounds
, cÚ¡ IÁReù& 
damageReù
, cÚ¡ 
R’d”Lay”
* 
roÙLay”
) const;

387 
IÁReù
 
boundšgBox
(cÚ¡ 
R’d”Lay”
* 
roÙLay”
) const;

389 
IÁReù
 
loÿlBoundšgBox
() const;

391 
IÁReù
 
absŞu‹BoundšgBox
() const;

393 
upd©eHov”AùiveS‹
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&);

396 
IÁReù
 
»·štReù
(ècÚ¡ {  
	gm_»·štReù
; }

397 
compu‹R•aštReùs
();

398 
£tN“dsFuÎR•ašt
(
boŞ
 
f
 = 
Œue
è{ 
m_ÃedsFuÎR•ašt
 = f; }

400 
¡©icX
(ècÚ¡ {  
	gm_¡©icX
; }

401 
¡©icY
(ècÚ¡ {  
	gm_¡©icY
; }

402 
£tSticX
(
¡©icX
è{ 
	gm_¡©icX
 = staticX; }

403 
£tSticY
(
¡©icY
è{ 
	gm_¡©icY
 = staticY; }

405 
boŞ
 
hasT¿nsfÜm
(ècÚ¡ {  
»nd””
()->hasTransform(); }

407 
T¿nsfÜm©iÚM©rix
* 
ŒªsfÜm
(ècÚ¡ {  
	gm_ŒªsfÜm
.
g‘
(); }

411 
T¿nsfÜm©iÚM©rix
 
cu¼’tT¿nsfÜm
() const;

412 
T¿nsfÜm©iÚM©rix
 
»nd”abËT¿nsfÜm
(
PaštBehaviÜ
) const;

417 
T¿nsfÜm©iÚM©rix
 
³r¥eùiveT¿nsfÜm
() const;

418 
FlßtPošt
 
³r¥eùiveOrigš
() const;

419 
boŞ
 
´e£rves3D
(ècÚ¡ {  
»nd””
()->
¡yË
()->
ŒªsfÜmStyË3D
(è=ğ
T¿nsfÜmStyË3DP»£rve3D
; }

420 
boŞ
 
has3DT¿nsfÜm
(ècÚ¡ {  
	gm_ŒªsfÜm
 && !m_ŒªsfÜm->
isAffše
(); }

424 * 
İ”©Ü
 
Ãw
(
size_t
, 
R’d”A»Ç
*è
throw
();

427 
İ”©Ü
 
d–‘e
(*, 
size_t
);

429 #ià
USE
(
ACCELERATED_COMPOSITING
)

430 
boŞ
 
isCompos™ed
(ècÚ¡ {  
	gm_backšg
 != 0; }

431 
boŞ
 
hasCompos™edMask
() const;

432 
R’d”Lay”Backšg
* 
backšg
(ècÚ¡ {  
	gm_backšg
.
g‘
(); }

433 
R’d”Lay”Backšg
* 
’su»Backšg
();

434 
ş—rBackšg
();

436 
boŞ
 
isCompos™ed
(ècÚ¡ {  
	gçl£
; }

437 
boŞ
 
hasCompos™edMask
(ècÚ¡ {  
	gçl£
; }

440 
boŞ
 
·štsW™hT¿n¥¬’cy
(
PaštBehaviÜ
 
·štBehaviÜ
) const

442  
isT¿n¥¬’t
(è&& ((
	g·štBehaviÜ
 & 
	gPaštBehaviÜFÏ‰’Compos™šgLay”s
è|| !
isCompos™ed
());

445 
boŞ
 
·štsW™hT¿nsfÜm
(
PaštBehaviÜ
 
·štBehaviÜ
) const

447  
ŒªsfÜm
(è&& ((
	g·štBehaviÜ
 & 
	gPaštBehaviÜFÏ‰’Compos™šgLay”s
è|| !
isCompos™ed
());

450 
	g´iv©e
:

452 * 
İ”©Ü
 
Ãw
(
size_t
è
throw
();

454 
	g´iv©e
:

455 
£tNextSiblšg
(
R’d”Lay”
* 
Ãxt
è{ 
m_Ãxt
 =‚ext; }

456 
£tP»viousSiblšg
(
R’d”Lay”
* 
´ev
è{ 
	gm_´evious
 =…rev; }

457 
£tP¬’t
(
R’d”Lay”
* 
·»Á
);

458 
£tFœ¡Chd
(
R’d”Lay”
* 
fœ¡
è{ 
	gm_fœ¡
 = first; }

459 
£tLa¡Chd
(
R’d”Lay”
* 
Ï¡
è{ 
	gm_Ï¡
 =†ast; }

461 
»nd”BoxX
(ècÚ¡ {  
»nd””
()->
isBox
(è? 
toR’d”Box
Ô’d””())->
x
() : 0; }

462 
»nd”BoxY
(ècÚ¡ {  
»nd””
()->
isBox
(è? 
toR’d”Box
Ô’d””())->
y
() : 0; }

464 
cŞËùLay”s
(
VeùÜ
<
R’d”Lay”
*>*&, Vector<RenderLayer*>*&);

466 
upd©eLay”Li¡sIfN“ded
();

467 
upd©eCompos™šgAndLay”Li¡sIfN“ded
();

469 
	ePaštLay”FÏg
 {

470 
	gPaštLay”HaveT¿n¥¬’cy
 = 1,

471 
	gPaštLay”Aµl›dT¿nsfÜm
 = 1 << 1,

472 
	gPaštLay”TempÜ¬yClReùs
 = 1 << 2,

473 
	gPaštLay”PaštšgReæeùiÚ
 = 1 << 3

476 
	tPaštLay”FÏgs
;

478 
·štLay”
(
R’d”Lay”
* 
roÙLay”
, 
G¿phicsCÚ‹xt
*, cÚ¡ 
IÁReù
& 
·štDœtyReù
,

479 
PaštBehaviÜ
, 
R’d”Objeù
* 
·štšgRoÙ
, R’d”Objeù::
Ov”ÏpTe¡Reque¡M­
* = 0,

480 
PaštLay”FÏgs
 
·štFÏgs
 = 0);

482 
R’d”Lay”
* 
h™Te¡Lay”
(R’d”Lay”* 
roÙLay”
, R’d”Lay”* 
cÚš”Lay”
, cÚ¡ 
H™Te¡Reque¡
& 
»que¡
, 
H™Te¡ResuÉ
& 
»suÉ
,

483 cÚ¡ 
IÁReù
& 
h™Te¡Reù
, cÚ¡ 
IÁPošt
& 
h™Te¡Pošt
, 
boŞ
 
­¶›dT¿nsfÜm
,

484 cÚ¡ 
H™Te¡šgT¿nsfÜmS‹
* 
ŒªsfÜmS‹
 = 0, * 
zOff£t
 = 0);

486 
	gPassRefPŒ
<
	gH™Te¡šgT¿nsfÜmS‹
> 
ü—‹LoÿlT¿nsfÜmS‹
(
R’d”Lay”
* 
roÙLay”
, R’d”Lay”* 
cÚš”Lay”
,

487 cÚ¡ 
IÁReù
& 
h™Te¡Reù
, cÚ¡ 
IÁPošt
& 
h™Te¡Pošt
,

488 cÚ¡ 
H™Te¡šgT¿nsfÜmS‹
* 
cÚš”T¿nsfÜmS‹
) const;

490 
boŞ
 
h™Te¡CÚ‹Ás
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, cÚ¡ 
IÁReù
& 
Ïy”Bounds
, cÚ¡ 
IÁPošt
& 
h™Te¡Pošt
, 
H™Te¡F‹r
) const;

492 
compu‹SüŞlDim’siÚs
(
boŞ
* 
ÃedHB¬
 = 0, boŞ* 
ÃedVB¬
 = 0);

494 
boŞ
 
shouldBeNÜm®FlowOÆy
() const;

497 
vœtu®
 
v®ueChªged
(
SüŞlb¬
*);

498 
vœtu®
 
šv®id©eSüŞlb¬Reù
(
SüŞlb¬
*, cÚ¡ 
IÁReù
&);

499 
vœtu®
 
boŞ
 
isAùive
() const;

500 
vœtu®
 
boŞ
 
süŞlb¬CÜÃrP»£Á
() const;

501 
vœtu®
 
IÁReù
 
cÚv”tFromSüŞlb¬ToCÚššgV›w
(cÚ¡ 
SüŞlb¬
*, const IntRect&) const;

502 
vœtu®
 
IÁReù
 
cÚv”tFromCÚššgV›wToSüŞlb¬
(cÚ¡ 
SüŞlb¬
*, const IntRect&) const;

503 
vœtu®
 
IÁPošt
 
cÚv”tFromSüŞlb¬ToCÚššgV›w
(cÚ¡ 
SüŞlb¬
*, const IntPoint&) const;

504 
vœtu®
 
IÁPošt
 
cÚv”tFromCÚššgV›wToSüŞlb¬
(cÚ¡ 
SüŞlb¬
*, const IntPoint&) const;

506 
IÁSize
 
süŞlb¬Off£t
(cÚ¡ 
SüŞlb¬
*) const;

508 
upd©eOv”æowStus
(
boŞ
 
hÜizÚlOv”æow
, boŞ 
v”tiÿlOv”æow
);

510 
chdVisib™yChªged
(
boŞ
 
ÃwVisib™y
);

511 
dœtyVisibËDesûndªtStus
();

512 
upd©eVisib™yStus
();

515 
£tHas3DT¿nsfÜmedDesûndªt
(
boŞ
 
b
è{ 
	gm_has3DT¿nsfÜmedDesûndªt
 = b; }

516 
boŞ
 
has3DT¿nsfÜmedDesûndªt
(ècÚ¡ {  
	gm_has3DT¿nsfÜmedDesûndªt
; }

518 
dœty3DT¿nsfÜmedDesûndªtStus
();

520 
boŞ
 
upd©e3DT¿nsfÜmedDesûndªtStus
();

522 
Node
* 
’şosšgEËm’t
() const;

524 
ü—‹ReæeùiÚ
();

525 
»moveReæeùiÚ
();

527 
upd©eReæeùiÚStyË
();

528 
boŞ
 
·štšgInsideReæeùiÚ
(ècÚ¡ {  
	gm_·štšgInsideReæeùiÚ
; }

529 
£tPaštšgInsideReæeùiÚ
(
boŞ
 
b
è{ 
	gm_·štšgInsideReæeùiÚ
 = b; }

531 
·»ÁClReùs
(cÚ¡ 
R’d”Lay”
* 
roÙLay”
, 
ClReùs
&, 
boŞ
 
‹mpÜ¬yClReùs
 = 
çl£
) const;

532 
IÁReù
 
backgroundClReù
(cÚ¡ 
R’d”Lay”
* 
roÙLay”
, 
boŞ
 
‹mpÜ¬yClReùs
) const;

534 
R’d”Lay”
* 
’şosšgT¿nsfÜmedAnû¡Ü
() const;

537 
IÁPošt
 
absŞu‹ToCÚ‹Ás
(const IntPoint&) const;

539 
upd©eSüŞlCÜÃrStyË
();

540 
upd©eResiz”StyË
();

542 #ià
USE
(
ACCELERATED_COMPOSITING
)

543 
boŞ
 
hasCompos™šgDesûndªt
(ècÚ¡ {  
	gm_hasCompos™šgDesûndªt
; }

544 
£tHasCompos™šgDesûndªt
(
boŞ
 
b
è{ 
	gm_hasCompos™šgDesûndªt
 = b; }

546 
boŞ
 
mu¡Ov”ÏpCompos™edLay”s
(ècÚ¡ {  
	gm_mu¡Ov”ÏpCompos™edLay”s
; }

547 
£tMu¡Ov”ÏpCompos™edLay”s
(
boŞ
 
b
è{ 
	gm_mu¡Ov”ÏpCompos™edLay”s
 = b; }

550 #iâdeà
NDEBUG


551 
showR’d”Lay”
() const;

552 
showT»eFÜThis
() const;

555 
	g´iv©e
:

556 
ä›nd
 
şass
 
R’d”Lay”Backšg
;

557 
ä›nd
 
şass
 
	gR’d”Lay”Compos™Ü
;

558 
ä›nd
 
şass
 
	gR’d”BoxMod–Objeù
;

561 
de¡roy
(
R’d”A»Ç
*);

563 
	g´Ùeùed
:

564 
R’d”BoxMod–Objeù
* 
m_»nd””
;

566 
R’d”Lay”
* 
	gm_·»Á
;

567 
R’d”Lay”
* 
	gm_´evious
;

568 
R’d”Lay”
* 
	gm_Ãxt
;

569 
R’d”Lay”
* 
	gm_fœ¡
;

570 
R’d”Lay”
* 
	gm_Ï¡
;

572 
IÁReù
 
	gm_»·štReù
;

573 
IÁReù
 
	gm_oušeBox
;

576 
	gm_»lX
;

577 
	gm_»lY
;

580 
	gm_x
;

581 
	gm_y
;

584 
	gm_width
;

585 
	gm_height
;

588 
	gm_süŞlX
;

589 
	gm_süŞlY
;

590 
	gm_süŞlOrigšX
;

591 
	gm_süŞlLeáOv”æow
;

594 
	gm_süŞlWidth
;

595 
	gm_süŞlHeight
;

598 
	gRefPŒ
<
	gSüŞlb¬
> 
	gm_hB¬
;

599 
	gRefPŒ
<
	gSüŞlb¬
> 
	gm_vB¬
;

602 
boŞ
 
	gm_šResizeMode
;

608 
	gVeùÜ
<
	gR’d”Lay”
*>* 
	gm_posZOrd”Li¡
;

609 
	gVeùÜ
<
	gR’d”Lay”
*>* 
	gm_ÃgZOrd”Li¡
;

613 
	gVeùÜ
<
	gR’d”Lay”
*>* 
	gm_nÜm®FlowLi¡
;

615 
ClReùs
* 
	gm_şReùs
;

616 #iâdeà
NDEBUG


617 cÚ¡ 
R’d”Lay”
* 
	gm_şReùsRoÙ
;

620 
boŞ
 
	gm_süŞlDim’siÚsDœty
 : 1;

621 
boŞ
 
	gm_zOrd”Li¡sDœty
 : 1;

622 
boŞ
 
	gm_nÜm®FlowLi¡Dœty
: 1;

623 
boŞ
 
	gm_isNÜm®FlowOÆy
 : 1;

625 
boŞ
 
	gm_u£dT¿n¥¬’cy
 : 1;

628 
boŞ
 
	gm_·štšgInsideReæeùiÚ
 : 1;

629 
boŞ
 
	gm_šOv”æowR–ayout
 : 1;

630 
boŞ
 
	gm_ÃedsFuÎR•ašt
 : 1;

632 
boŞ
 
	gm_ov”æowStusDœty
 : 1;

633 
boŞ
 
	gm_hÜizÚlOv”æow
 : 1;

634 
boŞ
 
	gm_v”tiÿlOv”æow
 : 1;

635 
boŞ
 
	gm_visibËCÚ‹ÁStusDœty
 : 1;

636 
boŞ
 
	gm_hasVisibËCÚ‹Á
 : 1;

637 
boŞ
 
	gm_visibËDesûndªtStusDœty
 : 1;

638 
boŞ
 
	gm_hasVisibËDesûndªt
 : 1;

640 
boŞ
 
	gm_3DT¿nsfÜmedDesûndªtStusDœty
 : 1;

641 
boŞ
 
	gm_has3DT¿nsfÜmedDesûndªt
 : 1;

643 #ià
USE
(
ACCELERATED_COMPOSITING
)

644 
boŞ
 
	gm_hasCompos™šgDesûndªt
 : 1;

645 
boŞ
 
	gm_mu¡Ov”ÏpCompos™edLay”s
 : 1;

648 
R’d”M¬qu“
* 
	gm_m¬qu“
;

651 
	gm_¡©icX
;

652 
	gm_¡©icY
;

654 
	gOwnPŒ
<
	gT¿nsfÜm©iÚM©rix
> 
	gm_ŒªsfÜm
;

657 
R’d”R•liÿ
* 
	gm_»æeùiÚ
;

660 
R’d”SüŞlb¬P¬t
* 
	gm_süŞlCÜÃr
;

661 
R’d”SüŞlb¬P¬t
* 
	gm_»siz”
;

663 
	g´iv©e
:

664 
IÁReù
 
m_blockS–eùiÚG­sBounds
;

666 #ià
USE
(
ACCELERATED_COMPOSITING
)

667 
	gOwnPŒ
<
	gR’d”Lay”Backšg
> 
	gm_backšg
;

673 #iâdeà
NDEBUG


675 
showLay”T»e
(cÚ¡ 
WebCÜe
::
R’d”Lay”
* 
Ïy”
);

	@RenderLayerBacking.cpp

26 
	~"cÚfig.h
"

28 #ià
USE
(
ACCELERATED_COMPOSITING
)

30 
	~"Anim©iÚCÚŒŞËr.h
"

31 #ià
ENABLE
(3D
_CANVAS
)

32 
	~"WebGLR’d”šgCÚ‹xt.h
"

34 
	~"CSSPrİ”tyNames.h
"

35 
	~"CSSStyËS–eùÜ.h
"

36 
	~"F¿meV›w.h
"

37 
	~"G¿phicsCÚ‹xt.h
"

38 
	~"G¿phicsLay”.h
"

39 
	~"HTMLCªvasEËm’t.h
"

40 
	~"HTMLEËm’t.h
"

41 
	~"HTMLMedŸEËm’t.h
"

42 
	~"HTMLNames.h
"

43 
	~"In¥eùÜTim–šeAg’t.h
"

44 
	~"KeyäameLi¡.h
"

45 
	~"PlugšWidg‘.h
"

46 
	~"R’d”Box.h
"

47 
	~"R’d”Image.h
"

48 
	~"R’d”Lay”Compos™Ü.h
"

49 
	~"R’d”EmbeddedObjeù.h
"

50 
	~"R’d”Video.h
"

51 
	~"R’d”V›w.h
"

52 
	~"S‘tšgs.h
"

54 
	~"R’d”Lay”Backšg.h
"

56 
usšg
 
Çme¥aû
 
	g¡d
;

58 
Çme¥aû
 
	gWebCÜe
 {

60 
usšg
 
Çme¥aû
 
	gHTMLNames
;

62 
boŞ
 
hasBÜd”OušeOrShadow
(cÚ¡ 
R’d”StyË
*);

63 
boŞ
 
hasBoxDecÜ©iÚsOrBackground
(cÚ¡ 
R’d”StyË
*);

64 
boŞ
 
hasBoxDecÜ©iÚsOrBackgroundImage
(cÚ¡ 
R’d”StyË
*);

66 
šlše
 
boŞ
 
is3DCªvas
(
R’d”Objeù
* 
»nd””
)

68 #ià
ENABLE
(3D
_CANVAS
)

69 ià(
	g»nd””
->
isCªvas
())

70  
	g¡©ic_ÿ¡
<
	gHTMLCªvasEËm’t
*>(
	g»nd””
->
node
())->
is3D
();

72 
UNUSED_PARAM
(
»nd””
);

74  
	gçl£
;

77 
	gR’d”Lay”Backšg
::
R’d”Lay”Backšg
(
R’d”Lay”
* 
Ïy”
)

78 : 
m_ownšgLay”
(
Ïy”
)

79 , 
m_¬tificŸÎyInæ©edBounds
(
çl£
)

81 
ü—‹G¿phicsLay”
();

84 
	gR’d”Lay”Backšg
::~
R’d”Lay”Backšg
()

86 
upd©eClpšgLay”s
(
çl£
, false);

87 
upd©eFÜegroundLay”
(
çl£
);

88 
upd©eMaskLay”
(
çl£
);

89 
de¡royG¿phicsLay”
();

92 
	gR’d”Lay”Backšg
::
ü—‹G¿phicsLay”
()

94 
m_g¿phicsLay”
 = 
G¿phicsLay”
::
ü—‹
(
this
);

96 #iâdeà
NDEBUG


97 ià(
»nd””
()->
node
()) {

98 ià(
»nd””
()->
node
()->
isDocum’tNode
())

99 
	gm_g¿phicsLay”
->
£tName
("Document Node");

101 ià(
»nd””
()->
node
()->
isHTMLEËm’t
(è&&„’d””()->node()->
hasID
())

102 
	gm_g¿phicsLay”
->
£tName
(
»nd””
()->
»nd”Name
(è+ 
SŒšg
(" "è+ 
¡©ic_ÿ¡
<
HTMLEËm’t
*>Ô’d””()->
node
())->
g‘IDA‰ribu‹
());

104 
	gm_g¿phicsLay”
->
£tName
(
»nd””
()->
»nd”Name
());

106 } ià(
	gm_ownšgLay”
->
isReæeùiÚ
())

107 
	gm_g¿phicsLay”
->
£tName
("Reflection");

109 
	gm_g¿phicsLay”
->
£tName
("Anonymous Node");

112 
upd©eLay”O·c™y
(
»nd””
()->
¡yË
());

113 
upd©eLay”T¿nsfÜm
(
»nd””
()->
¡yË
());

116 
	gR’d”Lay”Backšg
::
de¡royG¿phicsLay”
()

118 ià(
m_g¿phicsLay”
)

119 
m_g¿phicsLay”
->
»moveFromP¬’t
();

121 
	gm_g¿phicsLay”
 = 0;

122 
	gm_fÜegroundLay”
 = 0;

123 
	gm_şpšgLay”
 = 0;

124 
	gm_maskLay”
 = 0;

127 
	gR’d”Lay”Backšg
::
upd©eLay”O·c™y
(cÚ¡ 
R’d”StyË
* 
¡yË
)

129 
m_g¿phicsLay”
->
£tO·c™y
(
compos™šgO·c™y
(
¡yË
->
İac™y
()));

132 
	gR’d”Lay”Backšg
::
upd©eLay”T¿nsfÜm
(cÚ¡ 
R’d”StyË
* 
¡yË
)

136 
T¿nsfÜm©iÚM©rix
 
t
;

137 ià(
	gm_ownšgLay”
->
hasT¿nsfÜm
()) {

138 
	g¡yË
->
­¶yT¿nsfÜm
(
t
, 
toR’d”Box
(
»nd””
())->
bÜd”BoxReù
().
size
(), 
R’d”StyË
::
ExşudeT¿nsfÜmOrigš
);

139 
makeM©rixR’d”abË
(
t
, 
compos™Ü
()->
hasAcûË¿‹dCompos™šg
());

142 
	gm_g¿phicsLay”
->
£tT¿nsfÜm
(
t
);

145 
boŞ
 
hasNÚZ”oT¿nsfÜmOrigš
(cÚ¡ 
R’d”Objeù
* 
»nd””
)

147 
R’d”StyË
* 
	g¡yË
 = 
»nd””
->
¡yË
();

148  (
	g¡yË
->
ŒªsfÜmOrigšX
().
ty³
(è=ğ
Fixed
 && 
¡yË
->ŒªsfÜmOrigšX().
v®ue
())

149 || (
¡yË
->
ŒªsfÜmOrigšY
().
ty³
(è=ğ
Fixed
 && styË->ŒªsfÜmOrigšY().
v®ue
());

152 
	gR’d”Lay”Backšg
::
upd©eCompos™edBounds
()

154 
IÁReù
 
Ïy”Bounds
 = 
compos™Ü
()->
ÿlcuÏ‹Compos™edBounds
(
m_ownšgLay”
, m_owningLayer);

159 ià(
	gÏy”Bounds
.
isEm±y
(è&& 
hasNÚZ”oT¿nsfÜmOrigš
(
»nd””
())) {

160 
	gÏy”Bounds
.
£tWidth
(1);

161 
	gÏy”Bounds
.
£tHeight
(1);

162 
	gm_¬tificŸÎyInæ©edBounds
 = 
Œue
;

164 
	gm_¬tificŸÎyInæ©edBounds
 = 
çl£
;

166 
£tCompos™edBounds
(
Ïy”Bounds
);

169 
	gR’d”Lay”Backšg
::
upd©eAá”Layout
(
Upd©eD•th
 
upd©eD•th
, 
boŞ
 
isUpd©eRoÙ
)

171 
R’d”Lay”Compos™Ü
* 
	gÏy”Compos™Ü
 = 
compos™Ü
();

172 ià(!
	gÏy”Compos™Ü
->
compos™šgLay”sN“dRebud
()) {

180 
upd©eCompos™edBounds
();

181 
	gÏy”Compos™Ü
->
upd©eCompos™šgDesûndªtGeom‘ry
(
m_ownšgLay”
, m_ownšgLay”, 
upd©eD•th
);

183 ià(
	gisUpd©eRoÙ
) {

184 
upd©eG¿phicsLay”Geom‘ry
();

185 
	gÏy”Compos™Ü
->
upd©eRoÙLay”Pos™iÚ
();

190 
boŞ
 
	gR’d”Lay”Backšg
::
upd©eG¿phicsLay”CÚfigu¿tiÚ
()

192 
R’d”Lay”Compos™Ü
* 
compos™Ü
 = 
this
->compositor();

194 
boŞ
 
	gÏy”CÚfigChªged
 = 
çl£
;

195 ià(
upd©eFÜegroundLay”
(
compos™Ü
->
ÃedsCÚ‹ÁsCompos™šgLay”
(
m_ownšgLay”
)))

196 
	gÏy”CÚfigChªged
 = 
Œue
;

198 ià(
upd©eClpšgLay”s
(
compos™Ü
->
ş³dByAnû¡Ü
(
m_ownšgLay”
), compos™Ü->
şsCompos™šgDesûndªts
(m_owningLayer)))

199 
	gÏy”CÚfigChªged
 = 
Œue
;

201 ià(
upd©eMaskLay”
(
m_ownšgLay”
->
»nd””
()->
hasMask
()))

202 
	gm_g¿phicsLay”
->
£tMaskLay”
(
m_maskLay”
.
g‘
());

204 ià(
	gm_ownšgLay”
->
hasReæeùiÚ
()) {

205 ià(
	gm_ownšgLay”
->
»æeùiÚLay”
()->
backšg
()) {

206 
G¿phicsLay”
* 
	g»æeùiÚLay”
 = 
m_ownšgLay”
->
»æeùiÚLay”
()->
backšg
()->
g¿phicsLay”
();

207 
	gm_g¿phicsLay”
->
£tR•liÿ‹dByLay”
(
»æeùiÚLay”
);

210 
	gm_g¿phicsLay”
->
£tR•liÿ‹dByLay”
(0);

212 ià(
isDœeùlyCompos™edImage
())

213 
upd©eImageCÚ‹Ás
();

215 ià(
»nd””
()->
isEmbeddedObjeù
(è&& 
toR’d”EmbeddedObjeù
Ô’d””())->
®lowsAcûË¿‹dCompos™šg
()) {

216 
PlugšWidg‘
* 
	g¶ugšWidg‘
 = 
¡©ic_ÿ¡
<PlugšWidg‘*>(
toR’d”EmbeddedObjeù
(
»nd””
())->
widg‘
());

217 
	gm_g¿phicsLay”
->
£tCÚ‹ÁsToMedŸ
(
¶ugšWidg‘
->
¶©fÜmLay”
());

219 #ià
ENABLE
(
VIDEO
)

220 ià(
»nd””
()->
isVideo
()) {

221 
HTMLMedŸEËm’t
* 
	gmedŸEËm’t
 = 
¡©ic_ÿ¡
<HTMLMedŸEËm’t*>(
»nd””
()->
node
());

222 
	gm_g¿phicsLay”
->
£tCÚ‹ÁsToMedŸ
(
medŸEËm’t
->
¶©fÜmLay”
());

225 #ià
ENABLE
(3D
_CANVAS
)

226 ià(
is3DCªvas
(
»nd””
())) {

227 
HTMLCªvasEËm’t
* 
	gÿnvas
 = 
¡©ic_ÿ¡
<HTMLCªvasEËm’t*>(
»nd””
()->
node
());

228 
WebGLR’d”šgCÚ‹xt
* 
	gcÚ‹xt
 = 
¡©ic_ÿ¡
<WebGLR’d”šgCÚ‹xt*>(
ÿnvas
->
»nd”šgCÚ‹xt
());

229 ià(
	gcÚ‹xt
->
g¿phicsCÚ‹xt3D
()->
¶©fÜmG¿phicsCÚ‹xt3D
())

230 
	gm_g¿phicsLay”
->
£tCÚ‹ÁsToG¿phicsCÚ‹xt3D
(
cÚ‹xt
->
g¿phicsCÚ‹xt3D
());

234  
	gÏy”CÚfigChªged
;

237 
	gR’d”Lay”Backšg
::
upd©eG¿phicsLay”Geom‘ry
()

240 ià(
m_ownšgLay”
->
isSckšgCÚ‹xt
(è&& m_ownšgLay”->
m_zOrd”Li¡sDœty
)

245 ià(!
»nd””
()->
ªim©iÚ
()->
isAnim©šgPrİ”tyOnR’d””
Ô’d””(), 
CSSPrİ”tyWebk™T¿nsfÜm
))

246 
upd©eLay”T¿nsfÜm
(
»nd””
()->
¡yË
());

249 ià(!
»nd””
()->
ªim©iÚ
()->
isAnim©šgPrİ”tyOnR’d””
Ô’d””(), 
CSSPrİ”tyO·c™y
))

250 
upd©eLay”O·c™y
(
»nd””
()->
¡yË
());

252 
R’d”StyË
* 
	g¡yË
 = 
»nd””
()->
¡yË
();

253 
	gm_g¿phicsLay”
->
£tP»£rves3D
(
¡yË
->
ŒªsfÜmStyË3D
(è=ğ
T¿nsfÜmStyË3DP»£rve3D
 && !
»nd””
()->
hasReæeùiÚ
());

254 
	gm_g¿phicsLay”
->
£tBackçûVisib™y
(
¡yË
->
backçûVisib™y
(è=ğ
BackçûVisib™yVisibË
);

256 
R’d”Lay”
* 
	gcompAnû¡Ü
 = 
m_ownšgLay”
->
ªû¡ÜCompos™šgLay”
();

259 
IÁReù
 
	gªû¡ÜCompos™šgBounds
;

260 ià(
	gcompAnû¡Ü
) {

261 
ASSERT
(
compAnû¡Ü
->
backšg
());

262 
	gªû¡ÜCompos™šgBounds
 = 
compAnû¡Ü
->
backšg
()->
compos™edBounds
();

265 
IÁReù
 
	gloÿlCompos™šgBounds
 = 
compos™edBounds
();

267 
IÁReù
 
»ÏtiveCompos™šgBounds
(
loÿlCompos™šgBounds
);

268 
	gd–X
 = 0, 
	gd–Y
 = 0;

269 
	gm_ownšgLay”
->
cÚv”tToLay”CoÜds
(
compAnû¡Ü
, 
d–X
, 
d–Y
);

270 
	g»ÏtiveCompos™šgBounds
.
move
(
d–X
, 
d–Y
);

272 
IÁPošt
 
	gg¿phicsLay”P¬’tLoÿtiÚ
;

273 ià(
	gcompAnû¡Ü
 && compAnû¡Ü->
backšg
()->
hasClpšgLay”
()) {

276 
	gg¿phicsLay”P¬’tLoÿtiÚ
 = 
toR’d”Box
(
compAnû¡Ü
->
»nd””
())->
ov”æowClReù
(0, 0).
loÿtiÚ
();

278 
	gg¿phicsLay”P¬’tLoÿtiÚ
 = 
ªû¡ÜCompos™šgBounds
.
loÿtiÚ
();

280 ià(
	gcompAnû¡Ü
 && 
	gm_ªû¡ÜClpšgLay”
) {

284 
IÁReù
 
	g·»ÁClReù
 = 
m_ownšgLay”
->
backgroundClReù
(
compAnû¡Ü
, 
Œue
);

285 
	gm_ªû¡ÜClpšgLay”
->
£tPos™iÚ
(
FlßtPošt
(è+ (
·»ÁClReù
.
loÿtiÚ
(è- 
g¿phicsLay”P¬’tLoÿtiÚ
));

286 
	gm_ªû¡ÜClpšgLay”
->
£tSize
(
·»ÁClReù
.
size
());

289 
IÁSize
 
»nd””Off£t
(
·»ÁClReù
.
loÿtiÚ
().
x
(è- 
d–X
,…¬’tClReù.loÿtiÚ().
y
(è- 
d–Y
);

290 
	gm_ªû¡ÜClpšgLay”
->
£tOff£tFromR’d””
(
»nd””Off£t
);

293 
	gg¿phicsLay”P¬’tLoÿtiÚ
 = 
·»ÁClReù
.
loÿtiÚ
();

296 
	gm_g¿phicsLay”
->
£tPos™iÚ
(
FlßtPošt
(è+ (
»ÏtiveCompos™šgBounds
.
loÿtiÚ
(è- 
g¿phicsLay”P¬’tLoÿtiÚ
));

297 
	gm_g¿phicsLay”
->
£tOff£tFromR’d””
(
loÿlCompos™šgBounds
.
loÿtiÚ
(è- 
IÁPošt
());

299 
FlßtSize
 
	gŞdSize
 = 
m_g¿phicsLay”
->
size
();

300 
FlßtSize
 
	gÃwSize
 = 
»ÏtiveCompos™šgBounds
.
size
();

301 ià(
	gŞdSize
 !ğ
ÃwSize
) {

302 
m_g¿phicsLay”
->
£tSize
(
ÃwSize
);

306 
	gm_g¿phicsLay”
->
£tN“dsDi¥Ïy
();

310 
IÁReù
 
	gşpšgBox
;

311 ià(
	gm_şpšgLay”
) {

312 
	gşpšgBox
 = 
toR’d”Box
(
»nd””
())->
ov”æowClReù
(0, 0);

313 
	gm_şpšgLay”
->
£tPos™iÚ
(
FlßtPošt
(è+ (
şpšgBox
.
loÿtiÚ
(è- 
loÿlCompos™šgBounds
.location()));

314 
	gm_şpšgLay”
->
£tSize
(
şpšgBox
.
size
());

315 
	gm_şpšgLay”
->
£tOff£tFromR’d””
(
şpšgBox
.
loÿtiÚ
(è- 
IÁPošt
());

318 ià(
	gm_maskLay”
) {

319 
	gm_maskLay”
->
£tSize
(
m_g¿phicsLay”
->
size
());

320 
	gm_maskLay”
->
£tPos™iÚ
(
FlßtPošt
());

323 ià(
	gm_ownšgLay”
->
hasT¿nsfÜm
()) {

324 cÚ¡ 
IÁReù
 
	gbÜd”Box
 = 
toR’d”Box
(
»nd””
())->
bÜd”BoxReù
();

327 
IÁReù
 
	gÏy”Bounds
 = IÁReù(
d–X
, 
d–Y
, 
bÜd”Box
.
width
(), bÜd”Box.
height
());

330 
FlßtPošt3D
 
	gŒªsfÜmOrigš
 = 
compu‹T¿nsfÜmOrigš
(
bÜd”Box
);

332 
FlßtPošt3D
 
ªchÜ
(
»ÏtiveCompos™šgBounds
.
width
(è!ğ0.0à? ((
Ïy”Bounds
.
x
(è-„–©iveCompos™šgBounds.x()è+ 
ŒªsfÜmOrigš
.x()) /„elativeCompositingBounds.width() : 0.5f,

333 
»ÏtiveCompos™šgBounds
.
height
(è!ğ0.0à? ((
Ïy”Bounds
.
y
(è-„–©iveCompos™šgBounds.y()è+ 
ŒªsfÜmOrigš
.y()) /„elativeCompositingBounds.height() : 0.5f,

334 
ŒªsfÜmOrigš
.
z
());

335 
	gm_g¿phicsLay”
->
£tAnchÜPošt
(
ªchÜ
);

337 
R’d”StyË
* 
	g¡yË
 = 
»nd””
()->
¡yË
();

338 ià(
	g¡yË
->
hasP”¥eùive
()) {

339 
T¿nsfÜm©iÚM©rix
 
	gt
 = 
ownšgLay”
()->
³r¥eùiveT¿nsfÜm
();

341 ià(
	gm_şpšgLay”
) {

342 
	gm_şpšgLay”
->
£tChd»nT¿nsfÜm
(
t
);

343 
	gm_g¿phicsLay”
->
£tChd»nT¿nsfÜm
(
T¿nsfÜm©iÚM©rix
());

346 
	gm_g¿phicsLay”
->
£tChd»nT¿nsfÜm
(
t
);

348 ià(
	gm_şpšgLay”
)

349 
	gm_şpšgLay”
->
£tChd»nT¿nsfÜm
(
T¿nsfÜm©iÚM©rix
());

351 
	gm_g¿phicsLay”
->
£tChd»nT¿nsfÜm
(
T¿nsfÜm©iÚM©rix
());

354 
	gm_g¿phicsLay”
->
£tAnchÜPošt
(
FlßtPošt3D
(0.5f, 0.5f, 0));

357 ià(
	gm_fÜegroundLay”
) {

358 
FlßtPošt
 
	gfÜegroundPos™iÚ
;

359 
FlßtSize
 
	gfÜegroundSize
 = 
ÃwSize
;

360 
IÁSize
 
	gfÜegroundOff£t
 = 
m_g¿phicsLay”
->
off£tFromR’d””
();

363 ià(
	gm_şpšgLay”
) {

364 
	gfÜegroundPos™iÚ
 = 
FlßtPošt
(è+ (
loÿlCompos™šgBounds
.
loÿtiÚ
(è- 
şpšgBox
.location());

365 
	gfÜegroundSize
 = 
FlßtSize
(
şpšgBox
.
size
());

366 
	gfÜegroundOff£t
 = 
şpšgBox
.
loÿtiÚ
(è- 
IÁPošt
();

369 
	gm_fÜegroundLay”
->
£tPos™iÚ
(
fÜegroundPos™iÚ
);

370 
	gm_fÜegroundLay”
->
£tSize
(
fÜegroundSize
);

371 
	gm_fÜegroundLay”
->
£tOff£tFromR’d””
(
fÜegroundOff£t
);

374 ià(
	gm_ownšgLay”
->
»æeùiÚLay”
(è&& m_ownšgLay”->»æeùiÚLay”()->
isCompos™ed
()) {

375 
R’d”Lay”Backšg
* 
	g»æeùiÚBackšg
 = 
m_ownšgLay”
->
»æeùiÚLay”
()->
backšg
();

376 
	g»æeùiÚBackšg
->
upd©eG¿phicsLay”Geom‘ry
();

380 
FlßtReù
 
	gÏy”Bounds
 = 
compos™edBounds
();

381 
FlßtReù
 
	g»æeùiÚLay”Bounds
 = 
»æeùiÚBackšg
->
compos™edBounds
();

382 
	g»æeùiÚBackšg
->
g¿phicsLay”
()->
£tR•liÿ‹dLay”Pos™iÚ
(
FlßtPošt
(è+ (
Ïy”Bounds
.
loÿtiÚ
(è- 
»æeùiÚLay”Bounds
.location()));

385 
	gm_g¿phicsLay”
->
£tCÚ‹ÁsReù
(
cÚ‹ÁsBox
());

386 
	gm_g¿phicsLay”
->
£tD¿wsCÚ‹Á
(
cÚšsPaš‹dCÚ‹Á
());

389 
	gR’d”Lay”Backšg
::
upd©eIÁ”ÇlH›¿rchy
()

393 ià(
m_ªû¡ÜClpšgLay”
) {

394 
m_ªû¡ÜClpšgLay”
->
»moveAÎChd»n
();

395 
	gm_g¿phicsLay”
->
»moveFromP¬’t
();

396 
	gm_ªû¡ÜClpšgLay”
->
addChd
(
m_g¿phicsLay”
.
g‘
());

399 ià(
	gm_şpšgLay”
) {

400 
	gm_şpšgLay”
->
»moveFromP¬’t
();

401 
	gm_g¿phicsLay”
->
addChd
(
m_şpšgLay”
.
g‘
());

406 
boŞ
 
	gR’d”Lay”Backšg
::
upd©eClpšgLay”s
(boŞ 
ÃedsAnû¡ÜCl
, boŞ 
ÃedsDesûndªtCl
)

408 
boŞ
 
	gÏy”sChªged
 = 
çl£
;

410 ià(
	gÃedsAnû¡ÜCl
) {

411 ià(!
	gm_ªû¡ÜClpšgLay”
) {

412 
	gm_ªû¡ÜClpšgLay”
 = 
G¿phicsLay”
::
ü—‹
(
this
);

413 #iâdeà
NDEBUG


414 
	gm_ªû¡ÜClpšgLay”
->
£tName
("Ancestor clipping Layer");

416 
	gm_ªû¡ÜClpšgLay”
->
£tMasksToBounds
(
Œue
);

417 
	gÏy”sChªged
 = 
Œue
;

419 } ià(
	gm_ªû¡ÜClpšgLay”
) {

420 
	gm_ªû¡ÜClpšgLay”
->
»moveFromP¬’t
();

421 
	gm_ªû¡ÜClpšgLay”
 = 0;

422 
	gÏy”sChªged
 = 
Œue
;

425 ià(
	gÃedsDesûndªtCl
) {

426 ià(!
	gm_şpšgLay”
) {

427 
	gm_şpšgLay”
 = 
G¿phicsLay”
::
ü—‹
(
this
);

428 #iâdeà
NDEBUG


429 
	gm_şpšgLay”
->
£tName
("Child clipping Layer");

431 
	gm_şpšgLay”
->
£tMasksToBounds
(
Œue
);

432 
	gÏy”sChªged
 = 
Œue
;

434 } ià(
	gm_şpšgLay”
) {

435 
	gm_şpšgLay”
->
»moveFromP¬’t
();

436 
	gm_şpšgLay”
 = 0;

437 
	gÏy”sChªged
 = 
Œue
;

440 ià(
	gÏy”sChªged
)

441 
upd©eIÁ”ÇlH›¿rchy
();

443  
	gÏy”sChªged
;

446 
boŞ
 
	gR’d”Lay”Backšg
::
upd©eFÜegroundLay”
(boŞ 
ÃedsFÜegroundLay”
)

448 
boŞ
 
Ïy”Chªged
 = 
çl£
;

449 ià(
	gÃedsFÜegroundLay”
) {

450 ià(!
	gm_fÜegroundLay”
) {

451 
	gm_fÜegroundLay”
 = 
G¿phicsLay”
::
ü—‹
(
this
);

452 #iâdeà
NDEBUG


453 
	gm_fÜegroundLay”
->
£tName
("Foreground");

455 
	gm_fÜegroundLay”
->
£tD¿wsCÚ‹Á
(
Œue
);

456 
	gm_fÜegroundLay”
->
£tPaštšgPha£
(
G¿phicsLay”PaštFÜeground
);

457 
	gÏy”Chªged
 = 
Œue
;

459 } ià(
	gm_fÜegroundLay”
) {

460 
	gm_fÜegroundLay”
->
»moveFromP¬’t
();

461 
	gm_fÜegroundLay”
 = 0;

462 
	gÏy”Chªged
 = 
Œue
;

465 ià(
	gÏy”Chªged
)

466 
	gm_g¿phicsLay”
->
£tPaštšgPha£
(
·štšgPha£FÜPrim¬yLay”
());

468  
	gÏy”Chªged
;

471 
boŞ
 
	gR’d”Lay”Backšg
::
upd©eMaskLay”
(boŞ 
ÃedsMaskLay”
)

473 
boŞ
 
Ïy”Chªged
 = 
çl£
;

474 ià(
	gÃedsMaskLay”
) {

475 ià(!
	gm_maskLay”
) {

476 
	gm_maskLay”
 = 
G¿phicsLay”
::
ü—‹
(
this
);

477 #iâdeà
NDEBUG


478 
	gm_maskLay”
->
£tName
("Mask");

480 
	gm_maskLay”
->
£tD¿wsCÚ‹Á
(
Œue
);

481 
	gm_maskLay”
->
£tPaštšgPha£
(
G¿phicsLay”PaštMask
);

482 
	gÏy”Chªged
 = 
Œue
;

484 } ià(
	gm_maskLay”
) {

485 
	gm_maskLay”
 = 0;

486 
	gÏy”Chªged
 = 
Œue
;

489 ià(
	gÏy”Chªged
)

490 
	gm_g¿phicsLay”
->
£tPaštšgPha£
(
·štšgPha£FÜPrim¬yLay”
());

492  
	gÏy”Chªged
;

495 
G¿phicsLay”PaštšgPha£
 
	gR’d”Lay”Backšg
::
·štšgPha£FÜPrim¬yLay”
() const

497 
pha£
 = 
G¿phicsLay”PaštBackground
;

498 ià(!
	gm_fÜegroundLay”
)

499 
	gpha£
 |ğ
G¿phicsLay”PaštFÜeground
;

500 ià(!
	gm_maskLay”
)

501 
	gpha£
 |ğ
G¿phicsLay”PaštMask
;

503  
	g¡©ic_ÿ¡
<
	gG¿phicsLay”PaštšgPha£
>(
	gpha£
);

506 
	gR’d”Lay”Backšg
::
compos™šgO·c™y
(
»nd””O·c™y
) const

508 
fš®O·c™y
 = 
»nd””O·c™y
;

510 
R’d”Lay”
* 
	gcu¼
 = 
m_ownšgLay”
->
·»Á
(); cu¼; cu¼ = 
cu¼
->parent()) {

513 ià(!
cu¼
->
isSckšgCÚ‹xt
())

518 ià(
	gcu¼
->
isCompos™ed
())

521 
	gfš®O·c™y
 *ğ
cu¼
->
»nd””
()->
İac™y
();

524  
	gfš®O·c™y
;

527 
boŞ
 
hasBÜd”OušeOrShadow
(cÚ¡ 
R’d”StyË
* 
¡yË
)

529  
	g¡yË
->
hasBÜd”
(è|| styË->
hasBÜd”Radius
(è|| styË->
hasOuše
(è|| styË->
hasAµ—¿nû
(è|| styË->
boxShadow
();

532 
boŞ
 
hasBoxDecÜ©iÚsOrBackground
(cÚ¡ 
R’d”StyË
* 
¡yË
)

534  
hasBÜd”OušeOrShadow
(
¡yË
è|| 
	g¡yË
->
hasBackground
();

537 
boŞ
 
hasBoxDecÜ©iÚsOrBackgroundImage
(cÚ¡ 
R’d”StyË
* 
¡yË
)

539  
hasBÜd”OušeOrShadow
(
¡yË
è|| 
	g¡yË
->
hasBackgroundImage
();

542 
boŞ
 
	gR’d”Lay”Backšg
::
»nd””HasBackground
() const

545 ià(
»nd””
()->
node
(è&&„’d””()->node()->
isDocum’tNode
()) {

546 
R’d”Objeù
* 
htmlObjeù
 = 
»nd””
()->
fœ¡Chd
();

547 ià(!
	ghtmlObjeù
)

548  
	gçl£
;

550 
R’d”StyË
* 
	g¡yË
 = 
htmlObjeù
->
¡yË
();

551 ià(
	g¡yË
->
hasBackground
())

552  
	gŒue
;

554 
R’d”Objeù
* 
	gbodyObjeù
 = 
htmlObjeù
->
fœ¡Chd
();

555 ià(!
	gbodyObjeù
)

556  
	gçl£
;

558 
	g¡yË
 = 
bodyObjeù
->
¡yË
();

559  
	g¡yË
->
hasBackground
();

562  
»nd””
()->
¡yË
()->
hasBackground
();

565 cÚ¡ 
	gCŞÜ
& 
	gR’d”Lay”Backšg
::
»nd””BackgroundCŞÜ
() const

568 ià(
»nd””
()->
node
(è&&„’d””()->node()->
isDocum’tNode
()) {

569 
R’d”Objeù
* 
htmlObjeù
 = 
»nd””
()->
fœ¡Chd
();

570 
R’d”StyË
* 
	g¡yË
 = 
htmlObjeù
->
¡yË
();

571 ià(
	g¡yË
->
hasBackground
())

572  
	g¡yË
->
backgroundCŞÜ
();

574 
R’d”Objeù
* 
	gbodyObjeù
 = 
htmlObjeù
->
fœ¡Chd
();

575 
	g¡yË
 = 
bodyObjeù
->
¡yË
();

576  
	g¡yË
->
backgroundCŞÜ
();

579  
»nd””
()->
¡yË
()->
backgroundCŞÜ
();

585 
boŞ
 
	gR’d”Lay”Backšg
::
isSim¶eCÚš”Compos™šgLay”
() const

587 
R’d”Objeù
* 
»nd”Objeù
 = 
»nd””
();

588 ià(
	g»nd”Objeù
->
isR•Ïûd
() ||

589 
	g»nd”Objeù
->
hasMask
())

590  
	gçl£
;

592 
R’d”StyË
* 
	g¡yË
 = 
»nd”Objeù
->
¡yË
();

597 ià(
hasBoxDecÜ©iÚsOrBackground
(
¡yË
))

598  
	gçl£
;

601 ià(!
	g»nd”Objeù
->
fœ¡Chd
())

602  
	gŒue
;

604 ià(
	g»nd”Objeù
->
node
(è&&„’d”Objeù->node()->
isDocum’tNode
()) {

606 
R’d”Objeù
* 
	groÙObjeù
 = 
»nd”Objeù
->
docum’t
()->
docum’tEËm’t
()->
»nd””
();

607 ià(!
	groÙObjeù
)

608  
	gçl£
;

610 
	g¡yË
 = 
roÙObjeù
->
¡yË
();

614 ià(
hasBoxDecÜ©iÚsOrBackgroundImage
(
¡yË
))

615  
	gçl£
;

618 
HTMLEËm’t
* 
	gbody
 = 
»nd”Objeù
->
docum’t
()->
body
();

619 
R’d”Objeù
* 
	gbodyObjeù
 = (
body
 && body->
hasLoÿlName
(
bodyTag
)è? body->
»nd””
() : 0;

620 ià(!
	gbodyObjeù
)

621  
	gçl£
;

623 
	g¡yË
 = 
bodyObjeù
->
¡yË
();

625 ià(
hasBoxDecÜ©iÚsOrBackgroundImage
(
¡yË
))

626  
	gçl£
;

629 ià(
hasNÚCompos™šgCÚ‹Á
())

630  
	gçl£
;

632  
	gŒue
;

636 ià(
hasNÚCompos™šgCÚ‹Á
())

637  
	gçl£
;

639  
	gŒue
;

643 
boŞ
 
	gR’d”Lay”Backšg
::
hasNÚCompos™šgCÚ‹Á
() const

645 ià(
m_ownšgLay”
->
hasOv”æowCÚŒŞs
())

646  
Œue
;

653 
R’d”Objeù
* 
	gchd
 = 
»nd””
()->
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
()) {

654 ià(!
chd
->
hasLay”
()) {

655 ià(
chd
->
isR’d”IÆše
(è|| !chd->
isBox
())

656  
Œue
;

658 ià(
toR’d”Box
(
chd
)->
width
(è> 0 ||oR’d”Box(chd)->
height
() > 0)

659  
	gŒue
;

663 ià(
	gm_ownšgLay”
->
isSckšgCÚ‹xt
()) {

665 ià(
	gVeùÜ
<
	gR’d”Lay”
*>* 
	gÃgZOrd”Li¡
 = 
m_ownšgLay”
->
ÃgZOrd”Li¡
()) {

666 
size_t
 
li¡Size
 = 
ÃgZOrd”Li¡
->
size
();

667 
size_t
 
	gi
 = 0; i < 
	gli¡Size
; ++i) {

668 
R’d”Lay”
* 
	gcurLay”
 = 
ÃgZOrd”Li¡
->
©
(
i
);

669 ià(!
	gcurLay”
->
isCompos™ed
())

670  
	gŒue
;

674 ià(
	gVeùÜ
<
	gR’d”Lay”
*>* 
	gposZOrd”Li¡
 = 
m_ownšgLay”
->
posZOrd”Li¡
()) {

675 
size_t
 
li¡Size
 = 
posZOrd”Li¡
->
size
();

676 
size_t
 
	gi
 = 0; i < 
	gli¡Size
; ++i) {

677 
R’d”Lay”
* 
	gcurLay”
 = 
posZOrd”Li¡
->
©
(
i
);

678 ià(!
	gcurLay”
->
isCompos™ed
())

679  
	gŒue
;

684 ià(
	gVeùÜ
<
	gR’d”Lay”
*>* 
	gnÜm®FlowLi¡
 = 
m_ownšgLay”
->
nÜm®FlowLi¡
()) {

685 
size_t
 
li¡Size
 = 
nÜm®FlowLi¡
->
size
();

686 
size_t
 
	gi
 = 0; i < 
	gli¡Size
; ++i) {

687 
R’d”Lay”
* 
	gcurLay”
 = 
nÜm®FlowLi¡
->
©
(
i
);

688 ià(!
	gcurLay”
->
isCompos™ed
())

689  
	gŒue
;

693  
	gçl£
;

696 
boŞ
 
	gR’d”Lay”Backšg
::
cÚšsPaš‹dCÚ‹Á
() const

698 ià(
isSim¶eCÚš”Compos™šgLay”
(è|| 
·štšgGÛsToWšdow
(è|| 
m_¬tificŸÎyInæ©edBounds
 || 
m_ownšgLay”
->
isReæeùiÚ
())

699  
çl£
;

701 ià(
isDœeùlyCompos™edImage
())

702  
	gçl£
;

706 ià(
»nd””
()->
isVideo
(è|| 
is3DCªvas
(renderer()))

707  
hasBoxDecÜ©iÚsOrBackground
(
»nd””
()->
¡yË
());

709  
	gŒue
;

714 
boŞ
 
	gR’d”Lay”Backšg
::
isDœeùlyCompos™edImage
() const

716 
R’d”Objeù
* 
»nd”Objeù
 = 
»nd””
();

717  
	g»nd”Objeù
->
isImage
(è&& !
hasBoxDecÜ©iÚsOrBackground
(
»nd”Objeù
->
¡yË
());

720 
	gR’d”Lay”Backšg
::
»nd””CÚ‹ÁChªged
()

722 ià(
isDœeùlyCompos™edImage
()) {

723 
upd©eImageCÚ‹Ás
();

727 #ià
ENABLE
(3D
_CANVAS
)

728 ià(
is3DCªvas
(
»nd””
())) {

729 
	gm_g¿phicsLay”
->
£tG¿phicsCÚ‹xt3DN“dsDi¥Ïy
();

735 
	gR’d”Lay”Backšg
::
upd©eImageCÚ‹Ás
()

737 
ASSERT
(
»nd””
()->
isImage
());

738 
R’d”Image
* 
	gimageR’d””
 = 
toR’d”Image
(
»nd””
());

740 
CachedImage
* 
	gÿchedImage
 = 
imageR’d””
->
ÿchedImage
();

741 ià(!
	gÿchedImage
)

744 
Image
* 
	gimage
 = 
ÿchedImage
->
image
();

745 ià(!
	gimage
)

749 ià(!
	gÿchedImage
->
isLßded
())

753 
	gm_g¿phicsLay”
->
£tCÚ‹ÁsToImage
(
image
);

758 
	gimage
->
¡¬tAnim©iÚ
();

761 
FlßtPošt3D
 
	gR’d”Lay”Backšg
::
compu‹T¿nsfÜmOrigš
(cÚ¡ 
IÁReù
& 
bÜd”Box
) const

763 
R’d”StyË
* 
¡yË
 = 
»nd””
()->style();

765 
FlßtPošt3D
 
	gÜigš
;

766 
	gÜigš
.
£tX
(
¡yË
->
ŒªsfÜmOrigšX
().
ÿlcFlßtV®ue
(
bÜd”Box
.
width
()));

767 
	gÜigš
.
£tY
(
¡yË
->
ŒªsfÜmOrigšY
().
ÿlcFlßtV®ue
(
bÜd”Box
.
height
()));

768 
	gÜigš
.
£tZ
(
¡yË
->
ŒªsfÜmOrigšZ
());

770  
	gÜigš
;

773 
FlßtPošt
 
	gR’d”Lay”Backšg
::
compu‹P”¥eùiveOrigš
(cÚ¡ 
IÁReù
& 
bÜd”Box
) const

775 
R’d”StyË
* 
¡yË
 = 
»nd””
()->style();

777 
	gboxWidth
 = 
bÜd”Box
.
width
();

778 
	gboxHeight
 = 
bÜd”Box
.
height
();

780 
FlßtPošt
 
	gÜigš
;

781 
	gÜigš
.
£tX
(
¡yË
->
³r¥eùiveOrigšX
().
ÿlcFlßtV®ue
(
boxWidth
));

782 
	gÜigš
.
£tY
(
¡yË
->
³r¥eùiveOrigšY
().
ÿlcFlßtV®ue
(
boxHeight
));

784  
	gÜigš
;

788 
IÁSize
 
	gR’d”Lay”Backšg
::
cÚ‹ÁOff£tInCompo¡šgLay”
() const

790  
IÁSize
(-
m_compos™edBounds
.
x
(), -m_compos™edBounds.
y
());

793 
IÁReù
 
	gR’d”Lay”Backšg
::
cÚ‹ÁsBox
() const

795 ià(!
»nd””
()->
isBox
())

796  
IÁReù
();

798 
IÁReù
 
	gcÚ‹ÁsReù
;

799 #ià
ENABLE
(
VIDEO
)

800 ià(
»nd””
()->
isVideo
()) {

801 
R’d”Video
* 
	gvideoR’d””
 = 
toR’d”Video
(
»nd””
());

802 
	gcÚ‹ÁsReù
 = 
videoR’d””
->
videoBox
();

805 
	gcÚ‹ÁsReù
 = 
toR’d”Box
(
»nd””
())->
cÚ‹ÁBoxReù
();

807 
IÁSize
 
	gcÚ‹ÁOff£t
 = 
cÚ‹ÁOff£tInCompo¡šgLay”
();

808 
	gcÚ‹ÁsReù
.
move
(
cÚ‹ÁOff£t
);

809  
	gcÚ‹ÁsReù
;

813 
FlßtPošt
 
	gR’d”Lay”Backšg
::
g¿phicsLay”ToCÚ‹ÁsCoÜdš©es
(cÚ¡ 
G¿phicsLay”
* 
g¿phicsLay”
, cÚ¡ FlßtPošt& 
pošt
)

815  
	gpošt
 + 
FlßtSize
(
g¿phicsLay”
->
off£tFromR’d””
());

819 
FlßtPošt
 
	gR’d”Lay”Backšg
::
cÚ‹ÁsToG¿phicsLay”CoÜdš©es
(cÚ¡ 
G¿phicsLay”
* 
g¿phicsLay”
, cÚ¡ FlßtPošt& 
pošt
)

821  
	gpošt
 - 
FlßtSize
(
g¿phicsLay”
->
off£tFromR’d””
());

824 
boŞ
 
	gR’d”Lay”Backšg
::
·štšgGÛsToWšdow
() const

826  
m_ownšgLay”
->
isRoÙLay”
();

829 
	gR’d”Lay”Backšg
::
£tCÚ‹ÁsN“dDi¥Ïy
()

831 ià(
m_g¿phicsLay”
 && m_g¿phicsLay”->
d¿wsCÚ‹Á
())

832 
m_g¿phicsLay”
->
£tN“dsDi¥Ïy
();

834 ià(
	gm_fÜegroundLay”
 && m_fÜegroundLay”->
d¿wsCÚ‹Á
())

835 
	gm_fÜegroundLay”
->
£tN“dsDi¥Ïy
();

837 ià(
	gm_maskLay”
 && m_maskLay”->
d¿wsCÚ‹Á
())

838 
	gm_maskLay”
->
£tN“dsDi¥Ïy
();

842 
	gR’d”Lay”Backšg
::
£tCÚ‹ÁsN“dDi¥ÏyInReù
(cÚ¡ 
IÁReù
& 
r
)

844 ià(
m_g¿phicsLay”
 && m_g¿phicsLay”->
d¿wsCÚ‹Á
()) {

845 
FlßtPošt
 
dœtyOrigš
 = 
cÚ‹ÁsToG¿phicsLay”CoÜdš©es
(
m_g¿phicsLay”
.
g‘
(), FlßtPošt(
r
.
x
(),„.
y
()));

846 
FlßtReù
 
dœtyReù
(
dœtyOrigš
, 
r
.
size
());

847 
FlßtReù
 
bounds
(
FlßtPošt
(), 
m_g¿phicsLay”
->
size
());

848 ià(
	gbounds
.
š‹r£ùs
(
dœtyReù
))

849 
	gm_g¿phicsLay”
->
£tN“dsDi¥ÏyInReù
(
dœtyReù
);

852 ià(
	gm_fÜegroundLay”
 && m_fÜegroundLay”->
d¿wsCÚ‹Á
()) {

854 
	gm_fÜegroundLay”
->
£tN“dsDi¥Ïy
();

857 ià(
	gm_maskLay”
 && m_maskLay”->
d¿wsCÚ‹Á
()) {

859 
	gm_maskLay”
->
£tN“dsDi¥Ïy
();

863 
£tCl
(
G¿phicsCÚ‹xt
* 
p
, cÚ¡ 
IÁReù
& 
·štDœtyReù
, cÚ¡ IÁReù& 
şReù
)

865 ià(
	g·štDœtyReù
 =ğ
şReù
)

867 
	gp
->
§ve
();

868 
	gp
->
ş
(
şReù
);

871 
»¡ÜeCl
(
G¿phicsCÚ‹xt
* 
p
, cÚ¡ 
IÁReù
& 
·štDœtyReù
, cÚ¡ IÁReù& 
şReù
)

873 ià(
	g·štDœtyReù
 =ğ
şReù
)

875 
	gp
->
»¡Üe
();

879 
	gR’d”Lay”Backšg
::
·štIÁoLay”
(
R’d”Lay”
* 
roÙLay”
, 
G¿phicsCÚ‹xt
* 
cÚ‹xt
,

880 cÚ¡ 
IÁReù
& 
·štDœtyReù
,

881 
PaštBehaviÜ
 
·štBehaviÜ
, 
G¿phicsLay”PaštšgPha£
 
·štšgPha£
,

882 
R’d”Objeù
* 
·štšgRoÙ
)

884 ià(
·štšgGÛsToWšdow
()) {

885 
ASSERT_NOT_REACHED
();

889 
	gm_ownšgLay”
->
upd©eLay”Li¡sIfN“ded
();

892 
IÁReù
 
	gÏy”Bounds
, 
	gdamageReù
, 
	gşReùToAµly
, 
	goušeReù
;

893 
	gm_ownšgLay”
->
ÿlcuÏ‹Reùs
(
roÙLay”
, 
·štDœtyReù
, 
Ïy”Bounds
, 
damageReù
, 
şReùToAµly
, 
oušeReù
);

895 
	gx
 = 
Ïy”Bounds
.
x
();

896 
	gy
 = 
Ïy”Bounds
.
y
();

897 
	gtx
 = 
x
 - 
m_ownšgLay”
->
»nd”BoxX
();

898 
	gty
 = 
y
 - 
m_ownšgLay”
->
»nd”BoxY
();

904 
R’d”Objeù
 *
	g·štšgRoÙFÜR’d””
 = 0;

905 ià(
	g·štšgRoÙ
 && !
»nd””
()->
isDesûndªtOf
(
·štšgRoÙ
))

906 
	g·štšgRoÙFÜR’d””
 = 
·štšgRoÙ
;

908 
boŞ
 
	gshouldPašt
 = (
m_ownšgLay”
->
hasVisibËCÚ‹Á
(è|| m_ownšgLay”->
hasVisibËDesûndªt
()è&& m_ownšgLay”->
isS–fPaštšgLay”
();

910 ià(
	gshouldPašt
 && (
	g·štšgPha£
 & 
	gG¿phicsLay”PaštBackground
)) {

913 
IÁReù
 
	g·štBox
 = 
şReùToAµly
;

916 ià(
»nd””
()->
node
(è&&„’d””()->node()->
isDocum’tNode
(è&&„’d””()->
docum’t
()->
isHTMLDocum’t
()) {

917 
R’d”Box
* 
	gbox
 = 
toR’d”Box
(
»nd””
());

918 
	gw
 = 
box
->
width
();

919 
	gh
 = 
box
->
height
();

921 
	grw
;

922 
	grh
;

923 ià(
F¿meV›w
* 
	gäameV›w
 = 
box
->
v›w
()->
äameV›w
()) {

924 
rw
 = 
äameV›w
->
cÚ‹ÁsWidth
();

925 
	grh
 = 
äameV›w
->
cÚ‹ÁsHeight
();

927 
	grw
 = 
box
->
v›w
()->
width
();

928 
	grh
 = 
box
->
v›w
()->
height
();

931 
	gbx
 = 
tx
 - 
box
->
m¬gšLeá
();

932 
	gby
 = 
ty
 - 
box
->
m¬gšTİ
();

933 
	gbw
 = 
max
(
w
 + 
box
->
m¬gšLeá
(è+ box->
m¬gšRight
(è+ box->
bÜd”Leá
(è+ box->
bÜd”Right
(), 
rw
);

934 
	gbh
 = 
max
(
h
 + 
box
->
m¬gšTİ
(è+ box->
m¬gšBÙtom
(è+ box->
bÜd”Tİ
(è+ box->
bÜd”BÙtom
(), 
rh
);

935 
	g·štBox
 = 
IÁReù
(
bx
, 
by
, 
bw
, 
bh
);

940 
£tCl
(
cÚ‹xt
, 
·štDœtyReù
, 
damageReù
);

942 
	gR’d”Objeù
::
PaštInfo
 
šfo
(
cÚ‹xt
, 
·štBox
, 
PaštPha£BlockBackground
, 
çl£
, 
·štšgRoÙFÜR’d””
, 0);

943 
»nd””
()->
·št
(
šfo
, 
tx
, 
ty
);

948 
	gm_ownšgLay”
->
·štOv”æowCÚŒŞs
(
cÚ‹xt
, 
x
, 
y
, 
damageReù
);

951 
»¡ÜeCl
(
cÚ‹xt
, 
·štDœtyReù
, 
damageReù
);

954 
boŞ
 
	gfÜûBÏckText
 = 
·štBehaviÜ
 & 
PaštBehaviÜFÜûBÏckText
;

955 
boŞ
 
	g£ËùiÚOÆy
 = 
·štBehaviÜ
 & 
PaštBehaviÜS–eùiÚOÆy
;

957 ià(
	gshouldPašt
 && (
	g·štšgPha£
 & 
	gG¿phicsLay”PaštFÜeground
)) {

960 
	gVeùÜ
<
	gR’d”Lay”
*>* 
	gÃgZOrd”Li¡
 = 
m_ownšgLay”
->
ÃgZOrd”Li¡
();

961 ià(
	gÃgZOrd”Li¡
) {

962 
	gVeùÜ
<
	gR’d”Lay”
*>::
™”©Ü
 
™
 = 
ÃgZOrd”Li¡
->
begš
(); 
	g™
 !ğÃgZOrd”Li¡->
’d
(); ++it)

963 
	g™
[0]->
·štLay”
(
roÙLay”
, 
cÚ‹xt
, 
·štDœtyReù
, 
·štBehaviÜ
, 
·štšgRoÙ
);

967 
£tCl
(
cÚ‹xt
, 
·štDœtyReù
, 
şReùToAµly
);

968 
	gR’d”Objeù
::
PaštInfo
 
·štInfo
(
cÚ‹xt
, 
şReùToAµly
,

969 
£ËùiÚOÆy
 ? 
PaštPha£S–eùiÚ
 : 
PaštPha£ChdBlockBackgrounds
,

970 
fÜûBÏckText
, 
·štšgRoÙFÜR’d””
, 0);

971 
»nd””
()->
·št
(
·štInfo
, 
tx
, 
ty
);

973 ià(!
	g£ËùiÚOÆy
) {

974 
	g·štInfo
.
	gpha£
 = 
PaštPha£Flßt
;

975 
»nd””
()->
·št
(
·štInfo
, 
tx
, 
ty
);

977 
	g·štInfo
.
	gpha£
 = 
PaštPha£FÜeground
;

978 
»nd””
()->
·št
(
·štInfo
, 
tx
, 
ty
);

980 
	g·štInfo
.
	gpha£
 = 
PaštPha£ChdOušes
;

981 
»nd””
()->
·št
(
·štInfo
, 
tx
, 
ty
);

985 
»¡ÜeCl
(
cÚ‹xt
, 
·štDœtyReù
, 
şReùToAµly
);

987 ià(!
	goušeReù
.
isEm±y
()) {

989 
	gR’d”Objeù
::
PaštInfo
 
·štInfo
(
cÚ‹xt
, 
oušeReù
, 
PaštPha£S–fOuše
, 
çl£
, 
·štšgRoÙFÜR’d””
, 0);

990 
£tCl
(
cÚ‹xt
, 
·štDœtyReù
, 
oušeReù
);

991 
»nd””
()->
·št
(
·štInfo
, 
tx
, 
ty
);

992 
»¡ÜeCl
(
cÚ‹xt
, 
·štDœtyReù
, 
oušeReù
);

996 
	gVeùÜ
<
	gR’d”Lay”
*>* 
	gnÜm®FlowLi¡
 = 
m_ownšgLay”
->
nÜm®FlowLi¡
();

997 ià(
	gnÜm®FlowLi¡
) {

998 
	gVeùÜ
<
	gR’d”Lay”
*>::
™”©Ü
 
™
 = 
nÜm®FlowLi¡
->
begš
(); 
	g™
 !ğnÜm®FlowLi¡->
’d
(); ++it)

999 
	g™
[0]->
·štLay”
(
roÙLay”
, 
cÚ‹xt
, 
·štDœtyReù
, 
·štBehaviÜ
, 
·štšgRoÙ
);

1003 
	gVeùÜ
<
	gR’d”Lay”
*>* 
	gposZOrd”Li¡
 = 
m_ownšgLay”
->
posZOrd”Li¡
();

1004 ià(
	gposZOrd”Li¡
) {

1005 
	gVeùÜ
<
	gR’d”Lay”
*>::
™”©Ü
 
™
 = 
posZOrd”Li¡
->
begš
(); 
	g™
 !ğposZOrd”Li¡->
’d
(); ++it)

1006 
	g™
[0]->
·štLay”
(
roÙLay”
, 
cÚ‹xt
, 
·štDœtyReù
, 
·štBehaviÜ
, 
·štšgRoÙ
);

1010 ià(
	gshouldPašt
 && (
	g·štšgPha£
 & 
	gG¿phicsLay”PaštMask
)) {

1011 ià(
»nd””
()->
hasMask
(è&& !
	g£ËùiÚOÆy
 && !
	gdamageReù
.
isEm±y
()) {

1012 
£tCl
(
cÚ‹xt
, 
·štDœtyReù
, 
damageReù
);

1015 
	gR’d”Objeù
::
PaštInfo
 
·štInfo
(
cÚ‹xt
, 
damageReù
, 
PaštPha£Mask
, 
çl£
, 
·štšgRoÙFÜR’d””
, 0);

1016 
»nd””
()->
·št
(
·štInfo
, 
tx
, 
ty
);

1019 
»¡ÜeCl
(
cÚ‹xt
, 
·štDœtyReù
, 
damageReù
);

1023 
ASSERT
(!
m_ownšgLay”
->
m_u£dT¿n¥¬’cy
);

1026 #ià
ENABLE
(
INSPECTOR
)

1027 
In¥eùÜTim–šeAg’t
* 
š¥eùÜTim–šeAg’t
(
R’d”Objeù
* 
»nd””
)

1029 
F¿me
* 
	gäame
 = 
»nd””
->
docum’t
()->
äame
();

1030 ià(!
	gäame
)

1032 
Page
* 
	g·ge
 = 
äame
->
·ge
();

1033 ià(!
	g·ge
)

1035  
	g·ge
->
š¥eùÜTim–šeAg’t
();

1040 
	gR’d”Lay”Backšg
::
·štCÚ‹Ás
(cÚ¡ 
G¿phicsLay”
*, 
G¿phicsCÚ‹xt
& 
cÚ‹xt
, 
G¿phicsLay”PaštšgPha£
 
·štšgPha£
, cÚ¡ 
IÁReù
& 
ş
)

1042 #ià
ENABLE
(
INSPECTOR
)

1043 ià(
In¥eùÜTim–šeAg’t
* 
	gtim–šeAg’t
 = 
š¥eùÜTim–šeAg’t
(
m_ownšgLay”
->
»nd””
()))

1044 
tim–šeAg’t
->
wlPašt
(
ş
);

1049 
IÁReù
 
	g’şosšgBBox
 = 
compos™edBounds
();

1051 
IÁReù
 
şReù
(
ş
);

1054 
	gcÚ‹xt
.
Œª¦©e
(-
’şosšgBBox
.
x
(), -’şosšgBBox.
y
());

1057 
	gşReù
.
move
(
’şosšgBBox
.
x
(),ƒnşosšgBBox.
y
());

1060 
IÁReù
 
	gdœtyReù
 = 
’şosšgBBox
;

1061 
	gdœtyReù
.
š‹r£ù
(
şReù
);

1063 
·štIÁoLay”
(
m_ownšgLay”
, &
cÚ‹xt
, 
dœtyReù
, 
PaštBehaviÜNÜm®
, 
·štšgPha£
, 
»nd””
());

1065 #ià
ENABLE
(
INSPECTOR
)

1066 ià(
In¥eùÜTim–šeAg’t
* 
	gtim–šeAg’t
 = 
š¥eùÜTim–šeAg’t
(
m_ownšgLay”
->
»nd””
()))

1067 
tim–šeAg’t
->
didPašt
();

1071 
boŞ
 
	gR’d”Lay”Backšg
::
showDebugBÜd”s
() const

1073  
compos™Ü
(è? compos™Ü()->
showDebugBÜd”s
(è: 
çl£
;

1076 
boŞ
 
	gR’d”Lay”Backšg
::
showR•aštCouÁ”
() const

1078  
compos™Ü
(è? compos™Ü()->
showR•aštCouÁ”
(è: 
çl£
;

1081 
boŞ
 
	gR’d”Lay”Backšg
::
¡¬tAnim©iÚ
(
timeOff£t
, cÚ¡ 
Anim©iÚ
* 
ªim
, cÚ¡ 
KeyäameLi¡
& 
keyäames
)

1083 
boŞ
 
	ghasO·c™y
 = 
keyäames
.
cÚšsPrİ”ty
(
CSSPrİ”tyO·c™y
);

1084 
boŞ
 
	ghasT¿nsfÜm
 = 
keyäames
.
cÚšsPrİ”ty
(
CSSPrİ”tyWebk™T¿nsfÜm
);

1086 ià(!
	ghasO·c™y
 && !
	ghasT¿nsfÜm
)

1087  
	gçl£
;

1089 
KeyäameV®ueLi¡
 
ŒªsfÜmVeùÜ
(
Anim©edPrİ”tyWebk™T¿nsfÜm
);

1090 
KeyäameV®ueLi¡
 
İac™yVeùÜ
(
Anim©edPrİ”tyO·c™y
);

1092 
	gVeùÜ
<
	gKeyäameV®ue
>::
cÚ¡_™”©Ü
 
™
 = 
keyäames
.
begšKeyäames
(); 
	g™
 !ğkeyäames.
’dKeyäames
(); ++it) {

1093 cÚ¡ 
R’d”StyË
* 
	gkeyäameStyË
 = 
™
->
¡yË
();

1094 
	gkey
 = 
™
->
key
();

1096 ià(!
	gkeyäameStyË
)

1100 cÚ¡ 
TimšgFunùiÚ
* 
	gtf
 = 
keyäameStyË
->
hasAnim©iÚs
(è? &((*keyäameStyË->
ªim©iÚs
()).
ªim©iÚ
(0)->
timšgFunùiÚ
()) : 0;

1102 ià(
	ghasT¿nsfÜm
)

1103 
	gŒªsfÜmVeùÜ
.
š£¹
(
Ãw
 
T¿nsfÜmAnim©iÚV®ue
(
key
, &(
keyäameStyË
->
ŒªsfÜm
()), 
tf
));

1105 ià(
	ghasO·c™y
)

1106 
	gİac™yVeùÜ
.
š£¹
(
Ãw
 
FlßtAnim©iÚV®ue
(
key
, 
keyäameStyË
->
İac™y
(), 
tf
));

1109 
boŞ
 
	gdidAnim©eT¿nsfÜm
 = !
hasT¿nsfÜm
;

1110 
boŞ
 
	gdidAnim©eO·c™y
 = !
hasO·c™y
;

1112 ià(
	ghasT¿nsfÜm
 && 
	gm_g¿phicsLay”
->
addAnim©iÚ
(
ŒªsfÜmVeùÜ
, 
toR’d”Box
(
»nd””
())->
bÜd”BoxReù
().
size
(), 
ªim
, 
keyäames
.
ªim©iÚName
(), 
timeOff£t
))

1113 
	gdidAnim©eT¿nsfÜm
 = 
Œue
;

1115 ià(
	ghasO·c™y
 && 
	gm_g¿phicsLay”
->
addAnim©iÚ
(
İac™yVeùÜ
, 
IÁSize
(), 
ªim
, 
keyäames
.
ªim©iÚName
(), 
timeOff£t
))

1116 
	gdidAnim©eO·c™y
 = 
Œue
;

1118 
boŞ
 
	gruÂšgAcûË¿‹dAnim©iÚ
 = 
didAnim©eT¿nsfÜm
 && 
didAnim©eO·c™y
;

1119 ià(
	gruÂšgAcûË¿‹dAnim©iÚ
)

1120 
compos™Ü
()->
didS¹AcûË¿‹dAnim©iÚ
();

1122  
	gruÂšgAcûË¿‹dAnim©iÚ
;

1125 
boŞ
 
	gR’d”Lay”Backšg
::
¡¬tT¿ns™iÚ
(
timeOff£t
, 
´İ”ty
, cÚ¡ 
R’d”StyË
* 
äomStyË
, cÚ¡ R’d”StyË* 
toStyË
)

1127 
boŞ
 
	gdidAnim©e
 = 
çl£
;

1128 
ASSERT
(
´İ”ty
 !ğ
cAnim©eAÎ
);

1130 ià(
	g´İ”ty
 =ğ()
CSSPrİ”tyO·c™y
) {

1131 cÚ¡ 
Anim©iÚ
* 
İac™yAnim
 = 
toStyË
->
Œªs™iÚFÜPrİ”ty
(
CSSPrİ”tyO·c™y
);

1132 ià(
	gİac™yAnim
 && !İac™yAnim->
isEm±yOrZ”oDu¿tiÚ
()) {

1133 
KeyäameV®ueLi¡
 
İac™yVeùÜ
(
Anim©edPrİ”tyO·c™y
);

1134 
	gİac™yVeùÜ
.
š£¹
(
Ãw
 
FlßtAnim©iÚV®ue
(0, 
compos™šgO·c™y
(
äomStyË
->
İac™y
())));

1135 
	gİac™yVeùÜ
.
š£¹
(
Ãw
 
FlßtAnim©iÚV®ue
(1, 
compos™šgO·c™y
(
toStyË
->
İac™y
())));

1137 ià(
	gm_g¿phicsLay”
->
addAnim©iÚ
(
İac™yVeùÜ
, 
IÁSize
(), 
İac™yAnim
, 
SŒšg
(), 
timeOff£t
)) {

1139 
upd©eLay”O·c™y
(
toStyË
);

1140 
	gdidAnim©e
 = 
Œue
;

1145 ià(
	g´İ”ty
 =ğ()
CSSPrİ”tyWebk™T¿nsfÜm
 && 
m_ownšgLay”
->
hasT¿nsfÜm
()) {

1146 cÚ¡ 
Anim©iÚ
* 
ŒªsfÜmAnim
 = 
toStyË
->
Œªs™iÚFÜPrİ”ty
(
CSSPrİ”tyWebk™T¿nsfÜm
);

1147 ià(
	gŒªsfÜmAnim
 && !ŒªsfÜmAnim->
isEm±yOrZ”oDu¿tiÚ
()) {

1148 
KeyäameV®ueLi¡
 
ŒªsfÜmVeùÜ
(
Anim©edPrİ”tyWebk™T¿nsfÜm
);

1149 
	gŒªsfÜmVeùÜ
.
š£¹
(
Ãw
 
T¿nsfÜmAnim©iÚV®ue
(0, &
äomStyË
->
ŒªsfÜm
()));

1150 
	gŒªsfÜmVeùÜ
.
š£¹
(
Ãw
 
T¿nsfÜmAnim©iÚV®ue
(1, &
toStyË
->
ŒªsfÜm
()));

1151 ià(
	gm_g¿phicsLay”
->
addAnim©iÚ
(
ŒªsfÜmVeùÜ
, 
toR’d”Box
(
»nd””
())->
bÜd”BoxReù
().
size
(), 
ŒªsfÜmAnim
, 
SŒšg
(), 
timeOff£t
)) {

1153 
upd©eLay”T¿nsfÜm
(
toStyË
);

1154 
	gdidAnim©e
 = 
Œue
;

1159 ià(
	gdidAnim©e
)

1160 
compos™Ü
()->
didS¹AcûË¿‹dAnim©iÚ
();

1162  
	gdidAnim©e
;

1165 
	gR’d”Lay”Backšg
::
nÙifyAnim©iÚS¹ed
(cÚ¡ 
G¿phicsLay”
*, 
time
)

1167 
»nd””
()->
ªim©iÚ
()->
nÙifyAnim©iÚS¹ed
Ô’d””(), 
time
);

1170 
	gR’d”Lay”Backšg
::
nÙifySyncRequœed
(cÚ¡ 
G¿phicsLay”
*)

1172 ià(!
»nd””
()->
docum’tBešgDe¡royed
())

1173 
compos™Ü
()->
scheduËSync
();

1176 
	gR’d”Lay”Backšg
::
ªim©iÚFšished
(cÚ¡ 
SŒšg
& 
ªim©iÚName
)

1178 
m_g¿phicsLay”
->
»moveAnim©iÚsFÜKeyäames
(
ªim©iÚName
);

1181 
	gR’d”Lay”Backšg
::
ªim©iÚPau£d
(
timeOff£t
, cÚ¡ 
SŒšg
& 
ªim©iÚName
)

1183 
	gm_g¿phicsLay”
->
·u£Anim©iÚ
(
ªim©iÚName
, 
timeOff£t
);

1186 
	gR’d”Lay”Backšg
::
Œªs™iÚFšished
(
´İ”ty
)

1188 
Anim©edPrİ”tyID
 
ªim©edPrİ”ty
 = 
cssToG¿phicsLay”Prİ”ty
(
´İ”ty
);

1189 ià(
	gªim©edPrİ”ty
 !ğ
Anim©edPrİ”tyInv®id
)

1190 
m_g¿phicsLay”
->
»moveAnim©iÚsFÜPrİ”ty
(
ªim©edPrİ”ty
);

1193 
	gR’d”Lay”Backšg
::
su¥’dAnim©iÚs
(
time
)

1195 
m_g¿phicsLay”
->
su¥’dAnim©iÚs
(
time
);

1198 
	gR’d”Lay”Backšg
::
»sumeAnim©iÚs
()

1200 
m_g¿phicsLay”
->
»sumeAnim©iÚs
();

1203 
IÁReù
 
	gR’d”Lay”Backšg
::
compos™edBounds
() const

1205  
m_compos™edBounds
;

1208 
	gR’d”Lay”Backšg
::
£tCompos™edBounds
(cÚ¡ 
IÁReù
& 
bounds
)

1210 
m_compos™edBounds
 = 
bounds
;

1213 
	gR’d”Lay”Backšg
::
g¿phicsLay”ToCSSPrİ”ty
(
Anim©edPrİ”tyID
 
´İ”ty
)

1215 
cssPrİ”ty
 = 
CSSPrİ”tyInv®id
;

1216 
	g´İ”ty
) {

1217 
	gAnim©edPrİ”tyWebk™T¿nsfÜm
:

1218 
cssPrİ”ty
 = 
CSSPrİ”tyWebk™T¿nsfÜm
;

1220 
	gAnim©edPrİ”tyO·c™y
:

1221 
cssPrİ”ty
 = 
CSSPrİ”tyO·c™y
;

1223 
	gAnim©edPrİ”tyBackgroundCŞÜ
:

1224 
cssPrİ”ty
 = 
CSSPrİ”tyBackgroundCŞÜ
;

1226 
	gAnim©edPrİ”tyInv®id
:

1227 
ASSERT_NOT_REACHED
();

1229  
	gcssPrİ”ty
;

1232 
Anim©edPrİ”tyID
 
	gR’d”Lay”Backšg
::
cssToG¿phicsLay”Prİ”ty
(
cssPrİ”ty
)

1234 
cssPrİ”ty
) {

1235 
CSSPrİ”tyWebk™T¿nsfÜm
:

1236  
Anim©edPrİ”tyWebk™T¿nsfÜm
;

1237 
	gCSSPrİ”tyO·c™y
:

1238  
Anim©edPrİ”tyO·c™y
;

1239 
	gCSSPrİ”tyBackgroundCŞÜ
:

1240  
Anim©edPrİ”tyBackgroundCŞÜ
;

1243  
	gAnim©edPrİ”tyInv®id
;

	@RenderLayerBacking.h

26 #iâdeà
R’d”Lay”Backšg_h


27 
	#R’d”Lay”Backšg_h


	)

29 #ià
USE
(
ACCELERATED_COMPOSITING
)

31 
	~"FlßtPošt.h
"

32 
	~"FlßtPošt3D.h
"

33 
	~"G¿phicsLay”.h
"

34 
	~"G¿phicsLay”Cl›Á.h
"

35 
	~"R’d”Lay”.h
"

36 
	~"T¿nsfÜm©iÚM©rix.h
"

38 
Çme¥aû
 
	gWebCÜe
 {

40 
şass
 
	gKeyäameLi¡
;

41 
şass
 
	gR’d”Lay”Compos™Ü
;

49 
şass
 
	gR’d”Lay”Backšg
 : 
public
 
G¿phicsLay”Cl›Á
,…ubliø
	gNÚcİyabË
 {

50 
	gpublic
:

51 
R’d”Lay”Backšg
(
R’d”Lay”
*);

52 ~
R’d”Lay”Backšg
();

54 
R’d”Lay”
* 
ownšgLay”
(ècÚ¡ {  
	gm_ownšgLay”
; }

56 
	eUpd©eD•th
 { 
	gCompos™šgChd»n
, 
	gAÎDesûndªts
 };

57 
upd©eAá”Layout
(
Upd©eD•th
, 
boŞ
 
isUpd©eRoÙ
);

60 
boŞ
 
upd©eG¿phicsLay”CÚfigu¿tiÚ
();

62 
upd©eG¿phicsLay”Geom‘ry
();

64 
upd©eIÁ”ÇlH›¿rchy
();

66 
G¿phicsLay”
* 
g¿phicsLay”
(ècÚ¡ {  
	gm_g¿phicsLay”
.
g‘
(); }

69 
boŞ
 
hasClpšgLay”
(ècÚ¡ {  
	gm_şpšgLay”
 != 0; }

70 
G¿phicsLay”
* 
şpšgLay”
(ècÚ¡ {  
	gm_şpšgLay”
.
g‘
(); }

73 
boŞ
 
hasAnû¡ÜClpšgLay”
(ècÚ¡ {  
	gm_ªû¡ÜClpšgLay”
 != 0; }

74 
G¿phicsLay”
* 
ªû¡ÜClpšgLay”
(ècÚ¡ {  
	gm_ªû¡ÜClpšgLay”
.
g‘
(); }

76 
boŞ
 
hasCÚ‹ÁsLay”
(ècÚ¡ {  
	gm_fÜegroundLay”
 != 0; }

77 
G¿phicsLay”
* 
fÜegroundLay”
(ècÚ¡ {  
	gm_fÜegroundLay”
.
g‘
(); }

79 
boŞ
 
hasMaskLay”
(ècÚ¡ {  
	gm_maskLay”
 != 0; }

81 
G¿phicsLay”
* 
·»ÁFÜSubÏy”s
(ècÚ¡ {  
	gm_şpšgLay”
 ? m_şpšgLay”.
g‘
(è: 
m_g¿phicsLay”
.get(); }

82 
G¿phicsLay”
* 
chdFÜSu³¾ay”s
(ècÚ¡ {  
	gm_ªû¡ÜClpšgLay”
 ? m_ªû¡ÜClpšgLay”.
g‘
(è: 
m_g¿phicsLay”
.get(); }

90 
boŞ
 
·štšgGÛsToWšdow
() const;

92 
£tCÚ‹ÁsN“dDi¥Ïy
();

94 
£tCÚ‹ÁsN“dDi¥ÏyInReù
(cÚ¡ 
IÁReù
& 
r
);

97 
»nd””CÚ‹ÁChªged
();

100 
boŞ
 
¡¬tAnim©iÚ
(
timeOff£t
, cÚ¡ 
Anim©iÚ
* 
ªim
, cÚ¡ 
KeyäameLi¡
& 
keyäames
);

101 
boŞ
 
¡¬tT¿ns™iÚ
(
timeOff£t
, 
´İ”ty
, cÚ¡ 
R’d”StyË
* 
äomStyË
, cÚ¡ R’d”StyË* 
toStyË
);

102 
ªim©iÚFšished
(cÚ¡ 
SŒšg
& 
Çme
);

103 
ªim©iÚPau£d
(
timeOff£t
, cÚ¡ 
SŒšg
& 
Çme
);

104 
Œªs™iÚFšished
(
´İ”ty
);

106 
su¥’dAnim©iÚs
(
time
 = 0);

107 
»sumeAnim©iÚs
();

109 
IÁReù
 
compos™edBounds
() const;

110 
£tCompos™edBounds
(cÚ¡ 
IÁReù
&);

111 
upd©eCompos™edBounds
();

113 
FlßtPošt
 
g¿phicsLay”ToCÚ‹ÁsCoÜdš©es
(cÚ¡ 
G¿phicsLay”
*, const FloatPoint&);

114 
FlßtPošt
 
cÚ‹ÁsToG¿phicsLay”CoÜdš©es
(cÚ¡ 
G¿phicsLay”
*, const FloatPoint&);

117 
vœtu®
 
nÙifyAnim©iÚS¹ed
(cÚ¡ 
G¿phicsLay”
*, 
¡¬tTime
);

118 
vœtu®
 
nÙifySyncRequœed
(cÚ¡ 
G¿phicsLay”
*);

120 
vœtu®
 
·štCÚ‹Ás
(cÚ¡ 
G¿phicsLay”
*, 
G¿phicsCÚ‹xt
&, 
G¿phicsLay”PaštšgPha£
, cÚ¡ 
IÁReù
& 
ş
);

122 
vœtu®
 
boŞ
 
showDebugBÜd”s
() const;

123 
vœtu®
 
boŞ
 
showR•aštCouÁ”
() const;

125 
IÁReù
 
cÚ‹ÁsBox
() const;

127 
	g´iv©e
:

128 
ü—‹G¿phicsLay”
();

129 
de¡royG¿phicsLay”
();

131 
R’d”BoxMod–Objeù
* 
»nd””
(ècÚ¡ {  
	gm_ownšgLay”
->renderer(); }

132 
R’d”Lay”Compos™Ü
* 
compos™Ü
(ècÚ¡ {  
	gm_ownšgLay”
->compositor(); }

134 
boŞ
 
upd©eClpšgLay”s
(boŞ 
ÃedsAnû¡ÜCl
, boŞ 
ÃedsDesûndªtCl
);

135 
boŞ
 
upd©eFÜegroundLay”
(boŞ 
ÃedsFÜegroundLay”
);

136 
boŞ
 
upd©eMaskLay”
(boŞ 
ÃedsMaskLay”
);

138 
G¿phicsLay”PaštšgPha£
 
·štšgPha£FÜPrim¬yLay”
() const;

140 
IÁSize
 
cÚ‹ÁOff£tInCompo¡šgLay”
() const;

142 
FlßtPošt3D
 
compu‹T¿nsfÜmOrigš
(cÚ¡ 
IÁReù
& 
bÜd”Box
) const;

144 
FlßtPošt
 
compu‹P”¥eùiveOrigš
(cÚ¡ 
IÁReù
& 
bÜd”Box
) const;

146 
upd©eLay”O·c™y
(cÚ¡ 
R’d”StyË
*);

147 
upd©eLay”T¿nsfÜm
(cÚ¡ 
R’d”StyË
*);

150 
compos™šgO·c™y
(
»nd””O·c™y
) const;

153 
boŞ
 
isSim¶eCÚš”Compos™šgLay”
() const;

155 
boŞ
 
cÚšsPaš‹dCÚ‹Á
() const;

157 
boŞ
 
isDœeùlyCompos™edImage
() const;

158 
upd©eImageCÚ‹Ás
();

160 
boŞ
 
»nd””HasBackground
() const;

161 cÚ¡ 
	gCŞÜ
& 
»nd””BackgroundCŞÜ
() const;

163 
boŞ
 
hasNÚCompos™šgCÚ‹Á
() const;

165 
·štIÁoLay”
(
R’d”Lay”
* 
roÙLay”
, 
G¿phicsCÚ‹xt
*, cÚ¡ 
IÁReù
& 
·štDœtyReù
,

166 
PaštBehaviÜ
 
·štBehaviÜ
, 
G¿phicsLay”PaštšgPha£
, 
R’d”Objeù
* 
·štšgRoÙ
);

168 
g¿phicsLay”ToCSSPrİ”ty
(
Anim©edPrİ”tyID
);

169 
Anim©edPrİ”tyID
 
cssToG¿phicsLay”Prİ”ty
();

171 
	g´iv©e
:

172 
R’d”Lay”
* 
m_ownšgLay”
;

174 
	gOwnPŒ
<
	gG¿phicsLay”
> 
	gm_ªû¡ÜClpšgLay”
;

175 
	gOwnPŒ
<
	gG¿phicsLay”
> 
	gm_g¿phicsLay”
;

176 
	gOwnPŒ
<
	gG¿phicsLay”
> 
	gm_fÜegroundLay”
;

177 
	gOwnPŒ
<
	gG¿phicsLay”
> 
	gm_şpšgLay”
;

178 
	gOwnPŒ
<
	gG¿phicsLay”
> 
	gm_maskLay”
;

180 
IÁReù
 
	gm_compos™edBounds
;

182 
boŞ
 
	gm_¬tificŸÎyInæ©edBounds
;

	@RenderLayerCompositor.cpp

26 
	~"cÚfig.h
"

28 #ià
USE
(
ACCELERATED_COMPOSITING
)

29 
	~"R’d”Lay”Compos™Ü.h
"

31 
	~"Anim©iÚCÚŒŞËr.h
"

32 
	~"Chrome.h
"

33 
	~"ChromeCl›Á.h
"

34 
	~"CSSPrİ”tyNames.h
"

35 
	~"F¿me.h
"

36 
	~"F¿meV›w.h
"

37 
	~"G¿phicsLay”.h
"

38 
	~"H™Te¡ResuÉ.h
"

39 
	~"HTMLCªvasEËm’t.h
"

40 #ià
ENABLE
(
PLUGIN_PROXY_FOR_VIDEO
)

41 
	~"HTMLMedŸEËm’t.h
"

42 
	~"HTMLNames.h
"

44 
	~"Page.h
"

45 
	~"R’d”EmbeddedObjeù.h
"

46 
	~"R’d”Lay”Backšg.h
"

47 
	~"R’d”R•liÿ.h
"

48 
	~"R’d”Video.h
"

49 
	~"R’d”V›w.h
"

50 
	~"S‘tšgs.h
"

52 #ià
PROFILE_LAYER_REBUILD


53 
	~<wtf/Cu¼’tTime.h
>

56 #iâdeà
NDEBUG


57 
	~"R’d”T»eAsText.h
"

60 #ià
ENABLE
(3D
_RENDERING
)

62 
boŞ
 
	gWebCÜeHas3DR’d”šg
 = 
Œue
;

65 
Çme¥aû
 
	gWebCÜe
 {

67 
usšg
 
Çme¥aû
 
	gHTMLNames
;

69 
	sCompos™šgS‹
 {

70 
Compos™šgS‹
(
R’d”Lay”
* 
compAnû¡Ü
)

71 : 
m_compos™šgAnû¡Ü
(
compAnû¡Ü
)

72 , 
m_subŒ“IsCompos™šg
(
çl£
)

73 #iâdeà
NDEBUG


74 , 
m_d•th
(0)

79 
R’d”Lay”
* 
	gm_compos™šgAnû¡Ü
;

80 
boŞ
 
	gm_subŒ“IsCompos™šg
;

81 #iâdeà
NDEBUG


82 
	gm_d•th
;

86 
	gR’d”Lay”Compos™Ü
::
R’d”Lay”Compos™Ü
(
R’d”V›w
* 
»nd”V›w
)

87 : 
m_»nd”V›w
(
»nd”V›w
)

88 , 
m_roÙPÏtfÜmLay”
(0)

89 , 
m_hasAcûË¿‹dCompos™šg
(
Œue
)

90 , 
m_showDebugBÜd”s
(
çl£
)

91 , 
m_showR•aštCouÁ”
(
çl£
)

92 , 
m_compos™šgCÚsuÉsOv”Ïp
(
Œue
)

93 , 
m_compos™šg
(
çl£
)

94 , 
m_roÙLay”A‰ached
(
çl£
)

95 , 
m_compos™šgLay”sN“dRebud
(
çl£
)

96 #ià
PROFILE_LAYER_REBUILD


97 , 
m_roÙLay”Upd©eCouÁ
(0)

102 
	gR’d”Lay”Compos™Ü
::~
R’d”Lay”Compos™Ü
()

104 
ASSERT
(!
m_roÙLay”A‰ached
);

107 
	gR’d”Lay”Compos™Ü
::
’abËCompos™šgMode
(
boŞ
 
’abË
 )

109 ià(
’abË
 !ğ
m_compos™šg
) {

110 
m_compos™šg
 = 
’abË
;

115 ià(
	gm_compos™šg
)

116 
’su»RoÙPÏtfÜmLay”
();

118 
de¡royRoÙPÏtfÜmLay”
();

122 
	gR’d”Lay”Compos™Ü
::
ÿcheAcûË¿‹dCompos™šgFÏgs
()

124 
boŞ
 
hasAcûË¿‹dCompos™šg
 = 
çl£
;

125 
boŞ
 
	gshowDebugBÜd”s
 = 
çl£
;

126 
boŞ
 
	gshowR•aštCouÁ”
 = 
çl£
;

128 ià(
S‘tšgs
* 
	g£‰šgs
 = 
m_»nd”V›w
->
docum’t
()->
£‰šgs
()) {

129 
hasAcûË¿‹dCompos™šg
 = 
£‰šgs
->
acûË¿‹dCompos™šgEÇbËd
();

130 
	gshowDebugBÜd”s
 = 
£‰šgs
->
showDebugBÜd”s
();

131 
	gshowR•aštCouÁ”
 = 
£‰šgs
->
showR•aštCouÁ”
();

134 ià(
	ghasAcûË¿‹dCompos™šg
 !ğ
m_hasAcûË¿‹dCompos™šg
 || 
showDebugBÜd”s
 !ğ
m_showDebugBÜd”s
 || 
showR•aštCouÁ”
 !ğ
m_showR•aštCouÁ”
)

135 
£tCompos™šgLay”sN“dRebud
();

137 
	gm_hasAcûË¿‹dCompos™šg
 = 
hasAcûË¿‹dCompos™šg
;

138 
	gm_showDebugBÜd”s
 = 
showDebugBÜd”s
;

139 
	gm_showR•aštCouÁ”
 = 
showR•aštCouÁ”
;

142 
	gR’d”Lay”Compos™Ü
::
£tCompos™šgLay”sN“dRebud
(
boŞ
 
ÃedRebud
)

144 ià(
šCompos™šgMode
())

145 
m_compos™šgLay”sN“dRebud
 = 
ÃedRebud
;

148 
	gR’d”Lay”Compos™Ü
::
scheduËSync
()

150 
F¿me
* 
äame
 = 
m_»nd”V›w
->
äameV›w
()->frame();

151 
Page
* 
	g·ge
 = 
äame
 ? f¿me->
·ge
() : 0;

152 ià(!
	g·ge
)

155 
	g·ge
->
chrome
()->
ş›Á
()->
scheduËCompos™šgLay”Sync
();

158 
	gR’d”Lay”Compos™Ü
::
upd©eCompos™šgLay”s
(
Compos™šgUpd©eTy³
 
upd©eTy³
, 
R’d”Lay”
* 
upd©eRoÙ
)

160 
boŞ
 
	gcheckFÜH›¿rchyUpd©e
 = 
çl£
;

161 
boŞ
 
	gÃedGeom‘ryUpd©e
 = 
çl£
;

163 
	gupd©eTy³
) {

164 
	gCompos™šgUpd©eAá”LayoutOrStyËChªge
:

165 
Compos™šgUpd©eOnPa™šgOrH™Te¡
:

166 
checkFÜH›¿rchyUpd©e
 = 
Œue
;

168 
	gCompos™šgUpd©eOnSüŞl
:

169 ià(
m_compos™šgCÚsuÉsOv”Ïp
)

170 
checkFÜH›¿rchyUpd©e
 = 
Œue
;

172 
	gÃedGeom‘ryUpd©e
 = 
Œue
;

176 ià(!
	gcheckFÜH›¿rchyUpd©e
 && !
	gÃedGeom‘ryUpd©e
)

179 
ASSERT
(
šCompos™šgMode
());

181 
boŞ
 
	gÃedH›¿rchyUpd©e
 = 
m_compos™šgLay”sN“dRebud
;

182 ià(!
	gupd©eRoÙ
) {

184 
	gm_compos™šgLay”sN“dRebud
 = 
çl£
;

185 
	gupd©eRoÙ
 = 
roÙR’d”Lay”
();

188 #ià
PROFILE_LAYER_REBUILD


189 ++
	gm_roÙLay”Upd©eCouÁ
;

191 
	g¡¬tTime
 = 
WTF
::
cu¼’tTime
();

194 ià(
	gcheckFÜH›¿rchyUpd©e
) {

197 
Compos™šgS‹
 
compS‹
(
upd©eRoÙ
);

198 
boŞ
 
	gÏy”sChªged
 = 
çl£
;

199 ià(
	gm_compos™šgCÚsuÉsOv”Ïp
) {

200 
Ov”ÏpM­
 
	gov”ÏpTe¡Reque¡M­
;

201 
compu‹Compos™šgRequœem’ts
(
upd©eRoÙ
, &
ov”ÏpTe¡Reque¡M­
, 
compS‹
, 
Ïy”sChªged
);

203 
compu‹Compos™šgRequœem’ts
(
upd©eRoÙ
, 0, 
compS‹
, 
Ïy”sChªged
);

205 
	gÃedH›¿rchyUpd©e
 |ğ
Ïy”sChªged
;

208 ià(
	gÃedH›¿rchyUpd©e
) {

210 
Compos™šgS‹
 
compS‹
(
upd©eRoÙ
);

211 
	gVeùÜ
<
	gG¿phicsLay”
*> 
	gchdLi¡
;

212 
»budCompos™šgLay”T»e
(
upd©eRoÙ
, 
compS‹
, 
chdLi¡
);

215 ià(
	gupd©eRoÙ
 =ğ
roÙR’d”Lay”
()) {

216 ià(
chdLi¡
.
isEm±y
()) {

217 
wlMoveOffsü“n
();

218 
	gm_roÙPÏtfÜmLay”
 = 0;

220 
	gm_roÙPÏtfÜmLay”
->
£tChd»n
(
chdLi¡
);

222 } ià(
	gÃedGeom‘ryUpd©e
) {

225 
upd©eLay”T»eGeom‘ry
(
upd©eRoÙ
);

228 #ià
PROFILE_LAYER_REBUILD


229 
	g’dTime
 = 
WTF
::
cu¼’tTime
();

230 ià(
	gupd©eRoÙ
 =ğ
roÙR’d”Lay”
())

231 
årštf
(
¡d”r
, "Update %d: computeCompositingRequirements forhe worldook %fms\n",

232 
m_roÙLay”Upd©eCouÁ
, 1000.0 * (
’dTime
 - 
¡¬tTime
));

234 
ASSERT
(
upd©eRoÙ
 || !
m_compos™šgLay”sN“dRebud
);

236 ià(!
hasAcûË¿‹dCompos™šg
())

237 
’abËCompos™šgMode
(
çl£
);

240 
boŞ
 
	gR’d”Lay”Compos™Ü
::
upd©eBackšg
(
R’d”Lay”
* 
Ïy”
, 
Compos™šgChªgeR•ašt
 
shouldR•ašt
)

242 
boŞ
 
	gÏy”Chªged
 = 
çl£
;

244 ià(
ÃedsToBeCompos™ed
(
Ïy”
)) {

245 
’abËCompos™šgMode
();

248 ià(
»quœesCompos™šgFÜT¿nsfÜm
(
Ïy”
->
»nd””
()))

249 
£tCompos™šgCÚsuÉsOv”Ïp
(
çl£
);

251 ià(!
	gÏy”
->
backšg
()) {

254 ià(
	gshouldR•ašt
 =ğ
Compos™šgChªgeR•aštNow
)

255 
»·štOnCompos™šgChªge
(
Ïy”
);

257 
	gÏy”
->
’su»Backšg
();

258 
	gÏy”Chªged
 = 
Œue
;

261 ià(
	gÏy”
->
backšg
()) {

265 ià(
	gÏy”
->
isReæeùiÚ
()) {

266 
R’d”Lay”
* 
	gsourûLay”
 = 
toR’d”BoxMod–Objeù
(
Ïy”
->
»nd””
()->
·»Á
())->layer();

267 ià(
R’d”Lay”Backšg
* 
	gbackšg
 = 
sourûLay”
->
backšg
()) {

268 
ASSERT
(
backšg
->
g¿phicsLay”
()->
»¶iÿLay”
(è=ğ
Ïy”
->backing()->graphicsLayer());

269 
	gbackšg
->
g¿phicsLay”
()->
£tR•liÿ‹dByLay”
(0);

273 
	gÏy”
->
ş—rBackšg
();

274 
	gÏy”Chªged
 = 
Œue
;

278 
	gÏy”
->
compu‹R•aštReùs
();

281 ià(
	gshouldR•ašt
 =ğ
Compos™šgChªgeR•aštNow
)

282 
»·štOnCompos™šgChªge
(
Ïy”
);

286 #ià
ENABLE
(
VIDEO
)

287 ià(
	gÏy”Chªged
 && 
	gÏy”
->
»nd””
()->
isVideo
()) {

289 
R’d”Video
* 
	gvideo
 = 
toR’d”Video
(
Ïy”
->
»nd””
());

290 
	gvideo
->
acûË¿‹dR’d”šgS‹Chªged
();

293  
	gÏy”Chªged
;

296 
boŞ
 
	gR’d”Lay”Compos™Ü
::
upd©eLay”Compos™šgS‹
(
R’d”Lay”
* 
Ïy”
, 
Compos™šgChªgeR•ašt
 
shouldR•ašt
)

298 
boŞ
 
	gÏy”Chªged
 = 
upd©eBackšg
(
Ïy”
, 
shouldR•ašt
);

302 ià(
	gÏy”
->
backšg
(è&&†ay”->backšg()->
upd©eG¿phicsLay”CÚfigu¿tiÚ
())

303 
	gÏy”Chªged
 = 
Œue
;

305  
	gÏy”Chªged
;

308 
	gR’d”Lay”Compos™Ü
::
»·štOnCompos™šgChªge
(
R’d”Lay”
* 
Ïy”
)

311 ià(!
Ïy”
->
»nd””
()->
·»Á
())

314 
R’d”BoxMod–Objeù
* 
	g»·štCÚš”
 = 
Ïy”
->
»nd””
()->
cÚš”FÜR•ašt
();

315 ià(!
	g»·štCÚš”
)

316 
	g»·štCÚš”
 = 
m_»nd”V›w
;

318 
	gÏy”
->
»·štInşudšgNÚCompos™šgDesûndªts
(
»·štCÚš”
);

319 ià(
	g»·štCÚš”
 =ğ
m_»nd”V›w
) {

323 
m_»nd”V›w
->
äameV›w
()->
£tN“dsOÃShÙD¿wšgSynchrÚiz©iÚ
();

329 
IÁReù
 
	gR’d”Lay”Compos™Ü
::
ÿlcuÏ‹Compos™edBounds
(cÚ¡ 
R’d”Lay”
* 
Ïy”
, cÚ¡ R’d”Lay”* 
ªû¡ÜLay”
)

331 ià(!
ÿnBeCompos™ed
(
Ïy”
))

332  
IÁReù
();

334 
IÁReù
 
	gboundšgBoxReù
, 
	guniÚBounds
;

335 
	gboundšgBoxReù
 = 
uniÚBounds
 = 
Ïy”
->
loÿlBoundšgBox
();

337 ià(
	gÏy”
->
»nd””
()->
hasOv”æowCl
(è||†ay”->»nd””()->
hasMask
()) {

338 
	gªû¡ÜR–X
 = 0, 
	gªû¡ÜR–Y
 = 0;

339 
	gÏy”
->
cÚv”tToLay”CoÜds
(
ªû¡ÜLay”
, 
ªû¡ÜR–X
, 
ªû¡ÜR–Y
);

340 
	gboundšgBoxReù
.
move
(
ªû¡ÜR–X
, 
ªû¡ÜR–Y
);

341  
	gboundšgBoxReù
;

344 ià(
R’d”Lay”
* 
	g»æeùiÚ
 = 
Ïy”
->
»æeùiÚLay”
()) {

345 ià(!
»æeùiÚ
->
isCompos™ed
()) {

346 
IÁReù
 
chdUniÚBounds
 = 
ÿlcuÏ‹Compos™edBounds
(
»æeùiÚ
, 
Ïy”
);

347 
	guniÚBounds
.
un™e
(
chdUniÚBounds
);

351 
ASSERT
(
Ïy”
->
isSckšgCÚ‹xt
(è|| (!Ïy”->
m_posZOrd”Li¡
 ||†ay”->m_posZOrd”Li¡->
size
() == 0));

353 ià(
	gVeùÜ
<
	gR’d”Lay”
*>* 
	gÃgZOrd”Li¡
 = 
Ïy”
->
ÃgZOrd”Li¡
()) {

354 
size_t
 
li¡Size
 = 
ÃgZOrd”Li¡
->
size
();

355 
size_t
 
	gi
 = 0; i < 
	gli¡Size
; ++i) {

356 
R’d”Lay”
* 
	gcurLay”
 = 
ÃgZOrd”Li¡
->
©
(
i
);

357 ià(!
	gcurLay”
->
isCompos™ed
()) {

358 
IÁReù
 
	gchdUniÚBounds
 = 
ÿlcuÏ‹Compos™edBounds
(
curLay”
, 
Ïy”
);

359 
	guniÚBounds
.
un™e
(
chdUniÚBounds
);

364 ià(
	gVeùÜ
<
	gR’d”Lay”
*>* 
	gposZOrd”Li¡
 = 
Ïy”
->
posZOrd”Li¡
()) {

365 
size_t
 
li¡Size
 = 
posZOrd”Li¡
->
size
();

366 
size_t
 
	gi
 = 0; i < 
	gli¡Size
; ++i) {

367 
R’d”Lay”
* 
	gcurLay”
 = 
posZOrd”Li¡
->
©
(
i
);

368 ià(!
	gcurLay”
->
isCompos™ed
()) {

369 
IÁReù
 
	gchdUniÚBounds
 = 
ÿlcuÏ‹Compos™edBounds
(
curLay”
, 
Ïy”
);

370 
	guniÚBounds
.
un™e
(
chdUniÚBounds
);

375 ià(
	gVeùÜ
<
	gR’d”Lay”
*>* 
	gnÜm®FlowLi¡
 = 
Ïy”
->
nÜm®FlowLi¡
()) {

376 
size_t
 
li¡Size
 = 
nÜm®FlowLi¡
->
size
();

377 
size_t
 
	gi
 = 0; i < 
	gli¡Size
; ++i) {

378 
R’d”Lay”
* 
	gcurLay”
 = 
nÜm®FlowLi¡
->
©
(
i
);

379 ià(!
	gcurLay”
->
isCompos™ed
()) {

380 
IÁReù
 
	gcurAbsBounds
 = 
ÿlcuÏ‹Compos™edBounds
(
curLay”
, 
Ïy”
);

381 
	guniÚBounds
.
un™e
(
curAbsBounds
);

386 ià(
	gÏy”
->
·štsW™hT¿nsfÜm
(
PaštBehaviÜNÜm®
)) {

387 
T¿nsfÜm©iÚM©rix
* 
	gaffšeT¿ns
 = 
Ïy”
->
ŒªsfÜm
();

388 
	gboundšgBoxReù
 = 
affšeT¿ns
->
m­Reù
(
boundšgBoxReù
);

389 
	guniÚBounds
 = 
affšeT¿ns
->
m­Reù
(
uniÚBounds
);

392 
	gªû¡ÜR–X
 = 0, 
	gªû¡ÜR–Y
 = 0;

393 
	gÏy”
->
cÚv”tToLay”CoÜds
(
ªû¡ÜLay”
, 
ªû¡ÜR–X
, 
ªû¡ÜR–Y
);

394 
	guniÚBounds
.
move
(
ªû¡ÜR–X
, 
ªû¡ÜR–Y
);

396  
	guniÚBounds
;

399 
	gR’d”Lay”Compos™Ü
::
Ïy”WasAdded
(
R’d”Lay”
* , RenderLayer* )

401 
£tCompos™šgLay”sN“dRebud
();

404 
	gR’d”Lay”Compos™Ü
::
Ïy”WlBeRemoved
(
R’d”Lay”
* 
·»Á
, R’d”Lay”* 
chd
)

406 ià(!
	gchd
->
isCompos™ed
(è|| 
	g·»Á
->
»nd””
()->
docum’tBešgDe¡royed
())

409 
£tCompos™šgP¬’t
(
chd
, 0);

411 
R’d”Lay”
* 
	gcompLay”
 = 
·»Á
->
’şosšgCompos™šgLay”
();

412 ià(
	gcompLay”
) {

413 
ASSERT
(
compLay”
->
backšg
());

414 
IÁReù
 
	gcompBounds
 = 
chd
->
backšg
()->
compos™edBounds
();

416 
	goff£tX
 = 0, 
	goff£tY
 = 0;

417 
	gchd
->
cÚv”tToLay”CoÜds
(
compLay”
, 
off£tX
, 
off£tY
);

418 
	gcompBounds
.
move
(
off£tX
, 
off£tY
);

420 
	gcompLay”
->
£tBackšgN“dsR•aštInReù
(
compBounds
);

424 
	gm_»nd”V›w
->
äameV›w
()->
£tN“dsOÃShÙD¿wšgSynchrÚiz©iÚ
();

427 
£tCompos™šgLay”sN“dRebud
();

430 
R’d”Lay”
* 
	gR’d”Lay”Compos™Ü
::
’şosšgNÚSckšgClpšgLay”
(cÚ¡ R’d”Lay”* 
Ïy”
) const

432 
R’d”Lay”
* 
cu¼
 = 
Ïy”
->
·»Á
(); 
	gcu¼
 != 0; curr = curr->parent()) {

433 ià(
cu¼
->
isSckšgCÚ‹xt
())

436 ià(
	gcu¼
->
»nd””
()->
hasOv”æowCl
())

437  
	gcu¼
;

442 
	gR’d”Lay”Compos™Ü
::
addToOv”ÏpM­
(
Ov”ÏpM­
& 
ov”ÏpM­
, 
R’d”Lay”
* 
Ïy”
, 
IÁReù
& 
Ïy”Bounds
, 
boŞ
& 
boundsCompu‹d
)

444 ià(
	gÏy”
->
isRoÙLay”
())

447 ià(!
	gboundsCompu‹d
) {

448 
	gÏy”Bounds
 = 
Ïy”
->
»nd””
()->
loÿlToAbsŞu‹Quad
(
FlßtReù
Öay”->
loÿlBoundšgBox
())).
’şosšgBoundšgBox
();

450 ià(
	gÏy”Bounds
.
isEm±y
())

451 
	gÏy”Bounds
.
£tSize
(
IÁSize
(1, 1));

452 
	gboundsCompu‹d
 = 
Œue
;

455 
	gov”ÏpM­
.
add
(
Ïy”
, 
Ïy”Bounds
);

458 
boŞ
 
	gR’d”Lay”Compos™Ü
::
ov”ÏpsCompos™edLay”s
(
Ov”ÏpM­
& 
ov”ÏpM­
, cÚ¡ 
IÁReù
& 
Ïy”Bounds
)

460 
	gR’d”Lay”Compos™Ü
::
Ov”ÏpM­
::
cÚ¡_™”©Ü
 
’d
 = 
ov”ÏpM­
.end();

461 
	gR’d”Lay”Compos™Ü
::
Ov”ÏpM­
::
cÚ¡_™”©Ü
 
™
 = 
ov”ÏpM­
.
begš
(); 
	g™
 !ğ
’d
; ++it) {

462 cÚ¡ 
	gIÁReù
& 
	gbounds
 = 
™
->
£cÚd
;

463 ià(
	gÏy”Bounds
.
š‹r£ùs
(
bounds
))

464  
	gŒue
;

467  
	gçl£
;

479 
	gR’d”Lay”Compos™Ü
::
compu‹Compos™šgRequœem’ts
(
R’d”Lay”
* 
Ïy”
, 
Ov”ÏpM­
* 
ov”ÏpM­
, 
Compos™šgS‹
& 
compos™šgS‹
, 
boŞ
& 
Ïy”sChªged
)

481 
	gÏy”
->
upd©eLay”Pos™iÚ
();

482 
	gÏy”
->
upd©eZOrd”Li¡s
();

483 
	gÏy”
->
upd©eNÜm®FlowLi¡
();

486 
	gÏy”
->
£tHasCompos™šgDesûndªt
(
çl£
);

488 
boŞ
 
	gmu¡Ov”ÏpCompos™edLay”s
 = 
compos™šgS‹
.
m_subŒ“IsCompos™šg
;

490 
boŞ
 
	ghaveCompu‹dBounds
 = 
çl£
;

491 
IÁReù
 
	gabsBounds
;

492 ià(
	gov”ÏpM­
 && !ov”ÏpM­->
isEm±y
()) {

494 
	gabsBounds
 = 
Ïy”
->
»nd””
()->
loÿlToAbsŞu‹Quad
(
FlßtReù
Öay”->
loÿlBoundšgBox
())).
’şosšgBoundšgBox
();

496 ià(
	gabsBounds
.
isEm±y
())

497 
	gabsBounds
.
£tSize
(
IÁSize
(1, 1));

498 
	ghaveCompu‹dBounds
 = 
Œue
;

499 
	gmu¡Ov”ÏpCompos™edLay”s
 = 
ov”ÏpsCompos™edLay”s
(*
ov”ÏpM­
, 
absBounds
);

502 
	gÏy”
->
£tMu¡Ov”ÏpCompos™edLay”s
(
mu¡Ov”ÏpCompos™edLay”s
);

507 
Compos™šgS‹
 
chdS‹
(
compos™šgS‹
.
m_compos™šgAnû¡Ü
);

508 #iâdeà
NDEBUG


509 ++
	gchdS‹
.
	gm_d•th
;

512 
boŞ
 
	gwlBeCompos™ed
 = 
ÃedsToBeCompos™ed
(
Ïy”
);

513 ià(
	gwlBeCompos™ed
) {

515 
	gcompos™šgS‹
.
	gm_subŒ“IsCompos™šg
 = 
Œue
;

517 
	gchdS‹
.
	gm_compos™šgAnû¡Ü
 = 
Ïy”
;

518 ià(
	gov”ÏpM­
)

519 
addToOv”ÏpM­
(*
ov”ÏpM­
, 
Ïy”
, 
absBounds
, 
haveCompu‹dBounds
);

522 #ià
ENABLE
(
VIDEO
)

526 ià(
	gwlBeCompos™ed
 && 
	gÏy”
->
»nd””
()->
isVideo
())

527 
	gchdS‹
.
	gm_subŒ“IsCompos™šg
 = 
Œue
;

530 ià(
	gÏy”
->
isSckšgCÚ‹xt
()) {

531 
ASSERT
(!
Ïy”
->
m_zOrd”Li¡sDœty
);

532 ià(
	gVeùÜ
<
	gR’d”Lay”
*>* 
	gÃgZOrd”Li¡
 = 
Ïy”
->
ÃgZOrd”Li¡
()) {

533 
size_t
 
li¡Size
 = 
ÃgZOrd”Li¡
->
size
();

534 
size_t
 
	gi
 = 0; i < 
	gli¡Size
; ++i) {

535 
R’d”Lay”
* 
	gcurLay”
 = 
ÃgZOrd”Li¡
->
©
(
i
);

536 
compu‹Compos™šgRequœem’ts
(
curLay”
, 
ov”ÏpM­
, 
chdS‹
, 
Ïy”sChªged
);

540 ià(!
	gwlBeCompos™ed
 && 
	gchdS‹
.
	gm_subŒ“IsCompos™šg
) {

542 
	gÏy”
->
£tMu¡Ov”ÏpCompos™edLay”s
(
Œue
);

543 
	gchdS‹
.
	gm_compos™šgAnû¡Ü
 = 
Ïy”
;

544 ià(
	gov”ÏpM­
)

545 
addToOv”ÏpM­
(*
ov”ÏpM­
, 
Ïy”
, 
absBounds
, 
haveCompu‹dBounds
);

551 
ASSERT
(!
Ïy”
->
m_nÜm®FlowLi¡Dœty
);

552 ià(
	gVeùÜ
<
	gR’d”Lay”
*>* 
	gnÜm®FlowLi¡
 = 
Ïy”
->
nÜm®FlowLi¡
()) {

553 
size_t
 
li¡Size
 = 
nÜm®FlowLi¡
->
size
();

554 
size_t
 
	gi
 = 0; i < 
	gli¡Size
; ++i) {

555 
R’d”Lay”
* 
	gcurLay”
 = 
nÜm®FlowLi¡
->
©
(
i
);

556 
compu‹Compos™šgRequœem’ts
(
curLay”
, 
ov”ÏpM­
, 
chdS‹
, 
Ïy”sChªged
);

560 ià(
	gÏy”
->
isSckšgCÚ‹xt
()) {

561 ià(
	gVeùÜ
<
	gR’d”Lay”
*>* 
	gposZOrd”Li¡
 = 
Ïy”
->
posZOrd”Li¡
()) {

562 
size_t
 
li¡Size
 = 
posZOrd”Li¡
->
size
();

563 
size_t
 
	gi
 = 0; i < 
	gli¡Size
; ++i) {

564 
R’d”Lay”
* 
	gcurLay”
 = 
posZOrd”Li¡
->
©
(
i
);

565 
compu‹Compos™šgRequœem’ts
(
curLay”
, 
ov”ÏpM­
, 
chdS‹
, 
Ïy”sChªged
);

573 ià(!
	gwlBeCompos™ed
 && 
ÿnBeCompos™ed
(
Ïy”
è&& 
	gchdS‹
.
	gm_subŒ“IsCompos™šg
 && 
»quœesCompos™šgWh’DesûndªtsA»Compos™šg
Öay”->
»nd””
())) {

574 
	gÏy”
->
£tMu¡Ov”ÏpCompos™edLay”s
(
Œue
);

575 ià(
	gov”ÏpM­
)

576 
addToOv”ÏpM­
(*
ov”ÏpM­
, 
Ïy”
, 
absBounds
, 
haveCompu‹dBounds
);

577 
	gwlBeCompos™ed
 = 
Œue
;

580 
ASSERT
(
wlBeCompos™ed
 =ğ
ÃedsToBeCompos™ed
(
Ïy”
));

581 ià(
	gÏy”
->
»æeùiÚLay”
())

582 
	gÏy”
->
»æeùiÚLay”
()->
£tMu¡Ov”ÏpCompos™edLay”s
(
wlBeCompos™ed
);

585 ià(
	gchdS‹
.
	gm_subŒ“IsCompos™šg
)

586 
	gcompos™šgS‹
.
	gm_subŒ“IsCompos™šg
 = 
Œue
;

589 
	gÏy”
->
£tHasCompos™šgDesûndªt
(
chdS‹
.
m_subŒ“IsCompos™šg
);

593 ià(!
	gwlBeCompos™ed
 && 
ÿnBeCompos™ed
(
Ïy”
è&& 
şsCompos™šgDesûndªts
(layer)) {

594 ià(
	gov”ÏpM­
)

595 
addToOv”ÏpM­
(*
ov”ÏpM­
, 
Ïy”
, 
absBounds
, 
haveCompu‹dBounds
);

596 
	gwlBeCompos™ed
 = 
Œue
;

601 ià(
	gÏy”
->
isRoÙLay”
(è&& !
	gchdS‹
.
	gm_subŒ“IsCompos™šg
 && !
»quœesCompos™šgLay”
(
Ïy”
)) {

602 
	gm_compos™šg
 = 
çl£
;

603 
	gwlBeCompos™ed
 = 
çl£
;

607 
ASSERT
(
wlBeCompos™ed
 =ğ
ÃedsToBeCompos™ed
(
Ïy”
));

608 ià(!
	gÏy”
->
isCompos™ed
(è&& 
	gwlBeCompos™ed
)

609 
»·štOnCompos™šgChªge
(
Ïy”
);

612 ià(
upd©eBackšg
(
Ïy”
, 
Compos™šgChªgeR•aštNow
))

613 
	gÏy”sChªged
 = 
Œue
;

615 ià(
	gÏy”
->
»æeùiÚLay”
(è&& 
upd©eLay”Compos™šgS‹
(
Ïy”
->»æeùiÚLay”(), 
Compos™šgChªgeR•aštNow
))

616 
	gÏy”sChªged
 = 
Œue
;

619 
	gR’d”Lay”Compos™Ü
::
£tCompos™šgP¬’t
(
R’d”Lay”
* 
chdLay”
, R’d”Lay”* 
·»ÁLay”
)

621 
ASSERT
(!
·»ÁLay”
 || 
chdLay”
->
ªû¡ÜCompos™šgLay”
() ==…arentLayer);

622 
ASSERT
(
chdLay”
->
isCompos™ed
());

627 ià(!
	g·»ÁLay”
 || !·»ÁLay”->
isCompos™ed
())

630 ià(
	g·»ÁLay”
) {

631 
G¿phicsLay”
* 
	gho¡šgLay”
 = 
·»ÁLay”
->
backšg
()->
·»ÁFÜSubÏy”s
();

632 
G¿phicsLay”
* 
	gho¡edLay”
 = 
chdLay”
->
backšg
()->
chdFÜSu³¾ay”s
();

634 
	gho¡šgLay”
->
addChd
(
ho¡edLay”
);

636 
	gchdLay”
->
backšg
()->
chdFÜSu³¾ay”s
()->
»moveFromP¬’t
();

639 
	gR’d”Lay”Compos™Ü
::
»moveCompos™edChd»n
(
R’d”Lay”
* 
Ïy”
)

641 
ASSERT
(
Ïy”
->
isCompos™ed
());

643 
G¿phicsLay”
* 
	gho¡šgLay”
 = 
Ïy”
->
backšg
()->
·»ÁFÜSubÏy”s
();

644 
	gho¡šgLay”
->
»moveAÎChd»n
();

647 
	gR’d”Lay”Compos™Ü
::
·»ÁInRoÙLay”
(
R’d”Lay”
* 
Ïy”
)

649 
ASSERT
(
Ïy”
->
isCompos™ed
());

651 
G¿phicsLay”
* 
	gÏy”AnchÜ
 = 
Ïy”
->
backšg
()->
chdFÜSu³¾ay”s
();

653 ià(
	gÏy”AnchÜ
->
·»Á
(è!ğ
m_roÙPÏtfÜmLay”
) {

654 
Ïy”AnchÜ
->
»moveFromP¬’t
();

655 ià(
	gm_roÙPÏtfÜmLay”
)

656 
	gm_roÙPÏtfÜmLay”
->
addChd
(
Ïy”AnchÜ
);

660 #ià
ENABLE
(
VIDEO
)

661 
boŞ
 
	gR’d”Lay”Compos™Ü
::
ÿnAcûË¿‹VideoR’d”šg
(
R’d”Video
* 
o
) const

663 ià(!
m_hasAcûË¿‹dCompos™šg
)

664  
çl£
;

666  
	go
->
suµÜtsAcûË¿‹dR’d”šg
();

670 
	gR’d”Lay”Compos™Ü
::
»budCompos™šgLay”T»e
(
R’d”Lay”
* 
Ïy”
, cÚ¡ 
Compos™šgS‹
& 
compos™šgS‹
, 
VeùÜ
<
G¿phicsLay”
*>& 
chdLay”sOfEnşosšgLay”
)

676 
R’d”Lay”Backšg
* 
	gÏy”Backšg
 = 
Ïy”
->
backšg
();

677 ià(
	gÏy”Backšg
) {

680 
	gÏy”Backšg
->
upd©eCompos™edBounds
();

682 ià(
R’d”Lay”
* 
	g»æeùiÚ
 = 
Ïy”
->
»æeùiÚLay”
()) {

683 ià(
»æeùiÚ
->
backšg
())

684 
»æeùiÚ
->
backšg
()->
upd©eCompos™edBounds
();

687 
	gÏy”Backšg
->
upd©eG¿phicsLay”CÚfigu¿tiÚ
();

688 
	gÏy”Backšg
->
upd©eG¿phicsLay”Geom‘ry
();

690 ià(!
	gÏy”
->
·»Á
())

691 
upd©eRoÙLay”Pos™iÚ
();

696 
	gVeùÜ
<
	gG¿phicsLay”
*> 
	gÏy”Chd»n
;

697 
	gVeùÜ
<
	gG¿phicsLay”
*>& 
	gchdLi¡
 = 
Ïy”Backšg
 ? 
Ïy”Chd»n
 : 
chdLay”sOfEnşosšgLay”
;

699 
Compos™šgS‹
 
	gchdS‹
 = 
compos™šgS‹
;

700 ià(
	gÏy”
->
isCompos™ed
())

701 
	gchdS‹
.
	gm_compos™šgAnû¡Ü
 = 
Ïy”
;

703 #iâdeà
NDEBUG


704 ++
	gchdS‹
.
	gm_d•th
;

709 
	gchdS‹
.
	gm_subŒ“IsCompos™šg
 = 
çl£
;

711 ià(
	gÏy”
->
isSckšgCÚ‹xt
()) {

712 
ASSERT
(!
Ïy”
->
m_zOrd”Li¡sDœty
);

714 ià(
	gVeùÜ
<
	gR’d”Lay”
*>* 
	gÃgZOrd”Li¡
 = 
Ïy”
->
ÃgZOrd”Li¡
()) {

715 
size_t
 
li¡Size
 = 
ÃgZOrd”Li¡
->
size
();

716 
size_t
 
	gi
 = 0; i < 
	gli¡Size
; ++i) {

717 
R’d”Lay”
* 
	gcurLay”
 = 
ÃgZOrd”Li¡
->
©
(
i
);

718 
»budCompos™šgLay”T»e
(
curLay”
, 
chdS‹
, 
chdLi¡
);

723 ià(
	gÏy”Backšg
 &&†ay”Backšg->
fÜegroundLay”
())

724 
	gchdLi¡
.
­³nd
(
Ïy”Backšg
->
fÜegroundLay”
());

727 
ASSERT
(!
Ïy”
->
m_nÜm®FlowLi¡Dœty
);

728 ià(
	gVeùÜ
<
	gR’d”Lay”
*>* 
	gnÜm®FlowLi¡
 = 
Ïy”
->
nÜm®FlowLi¡
()) {

729 
size_t
 
li¡Size
 = 
nÜm®FlowLi¡
->
size
();

730 
size_t
 
	gi
 = 0; i < 
	gli¡Size
; ++i) {

731 
R’d”Lay”
* 
	gcurLay”
 = 
nÜm®FlowLi¡
->
©
(
i
);

732 
»budCompos™šgLay”T»e
(
curLay”
, 
chdS‹
, 
chdLi¡
);

736 ià(
	gÏy”
->
isSckšgCÚ‹xt
()) {

737 ià(
	gVeùÜ
<
	gR’d”Lay”
*>* 
	gposZOrd”Li¡
 = 
Ïy”
->
posZOrd”Li¡
()) {

738 
size_t
 
li¡Size
 = 
posZOrd”Li¡
->
size
();

739 
size_t
 
	gi
 = 0; i < 
	gli¡Size
; ++i) {

740 
R’d”Lay”
* 
	gcurLay”
 = 
posZOrd”Li¡
->
©
(
i
);

741 
»budCompos™šgLay”T»e
(
curLay”
, 
chdS‹
, 
chdLi¡
);

746 ià(
	gÏy”Backšg
) {

747 
	gÏy”Backšg
->
·»ÁFÜSubÏy”s
()->
£tChd»n
(
Ïy”Chd»n
);

748 
	gchdLay”sOfEnşosšgLay”
.
­³nd
(
Ïy”Backšg
->
chdFÜSu³¾ay”s
());

753 
	gR’d”Lay”Compos™Ü
::
upd©eLay”T»eGeom‘ry
(
R’d”Lay”
* 
Ïy”
)

755 ià(
R’d”Lay”Backšg
* 
Ïy”Backšg
 = 
Ïy”
->
backšg
()) {

758 
Ïy”Backšg
->
upd©eCompos™edBounds
();

760 ià(
R’d”Lay”
* 
	g»æeùiÚ
 = 
Ïy”
->
»æeùiÚLay”
()) {

761 ià(
»æeùiÚ
->
backšg
())

762 
»æeùiÚ
->
backšg
()->
upd©eCompos™edBounds
();

765 
	gÏy”Backšg
->
upd©eG¿phicsLay”CÚfigu¿tiÚ
();

766 
	gÏy”Backšg
->
upd©eG¿phicsLay”Geom‘ry
();

768 ià(!
	gÏy”
->
·»Á
())

769 
upd©eRoÙLay”Pos™iÚ
();

772 ià(
	gÏy”
->
isSckšgCÚ‹xt
()) {

773 
ASSERT
(!
Ïy”
->
m_zOrd”Li¡sDœty
);

775 ià(
	gVeùÜ
<
	gR’d”Lay”
*>* 
	gÃgZOrd”Li¡
 = 
Ïy”
->
ÃgZOrd”Li¡
()) {

776 
size_t
 
li¡Size
 = 
ÃgZOrd”Li¡
->
size
();

777 
size_t
 
	gi
 = 0; i < 
	gli¡Size
; ++i)

778 
upd©eLay”T»eGeom‘ry
(
ÃgZOrd”Li¡
->
©
(
i
));

782 
ASSERT
(!
Ïy”
->
m_nÜm®FlowLi¡Dœty
);

783 ià(
	gVeùÜ
<
	gR’d”Lay”
*>* 
	gnÜm®FlowLi¡
 = 
Ïy”
->
nÜm®FlowLi¡
()) {

784 
size_t
 
li¡Size
 = 
nÜm®FlowLi¡
->
size
();

785 
size_t
 
	gi
 = 0; i < 
	gli¡Size
; ++i)

786 
upd©eLay”T»eGeom‘ry
(
nÜm®FlowLi¡
->
©
(
i
));

789 ià(
	gÏy”
->
isSckšgCÚ‹xt
()) {

790 ià(
	gVeùÜ
<
	gR’d”Lay”
*>* 
	gposZOrd”Li¡
 = 
Ïy”
->
posZOrd”Li¡
()) {

791 
size_t
 
li¡Size
 = 
posZOrd”Li¡
->
size
();

792 
size_t
 
	gi
 = 0; i < 
	gli¡Size
; ++i)

793 
upd©eLay”T»eGeom‘ry
(
posZOrd”Li¡
->
©
(
i
));

799 
	gR’d”Lay”Compos™Ü
::
upd©eCompos™šgDesûndªtGeom‘ry
(
R’d”Lay”
* 
compos™šgAnû¡Ü
, R’d”Lay”* 
Ïy”
, 
R’d”Lay”Backšg
::
Upd©eD•th
 
upd©eD•th
)

801 ià(
Ïy”
 !ğ
compos™šgAnû¡Ü
) {

802 ià(
R’d”Lay”Backšg
* 
Ïy”Backšg
 = 
Ïy”
->
backšg
()) {

803 
Ïy”Backšg
->
upd©eCompos™edBounds
();

805 ià(
R’d”Lay”
* 
	g»æeùiÚ
 = 
Ïy”
->
»æeùiÚLay”
()) {

806 ià(
»æeùiÚ
->
backšg
())

807 
»æeùiÚ
->
backšg
()->
upd©eCompos™edBounds
();

810 
	gÏy”Backšg
->
upd©eG¿phicsLay”Geom‘ry
();

811 ià(
	gupd©eD•th
 =ğ
R’d”Lay”Backšg
::
Compos™šgChd»n
)

816 ià(
	gÏy”
->
»æeùiÚLay”
())

817 
upd©eCompos™šgDesûndªtGeom‘ry
(
compos™šgAnû¡Ü
, 
Ïy”
->
»æeùiÚLay”
(), 
upd©eD•th
);

819 ià(!
	gÏy”
->
hasCompos™šgDesûndªt
())

822 ià(
	gÏy”
->
isSckšgCÚ‹xt
()) {

823 ià(
	gVeùÜ
<
	gR’d”Lay”
*>* 
	gÃgZOrd”Li¡
 = 
Ïy”
->
ÃgZOrd”Li¡
()) {

824 
size_t
 
li¡Size
 = 
ÃgZOrd”Li¡
->
size
();

825 
size_t
 
	gi
 = 0; i < 
	gli¡Size
; ++i)

826 
upd©eCompos™šgDesûndªtGeom‘ry
(
compos™šgAnû¡Ü
, 
ÃgZOrd”Li¡
->
©
(
i
), 
upd©eD•th
);

830 ià(
	gVeùÜ
<
	gR’d”Lay”
*>* 
	gnÜm®FlowLi¡
 = 
Ïy”
->
nÜm®FlowLi¡
()) {

831 
size_t
 
li¡Size
 = 
nÜm®FlowLi¡
->
size
();

832 
size_t
 
	gi
 = 0; i < 
	gli¡Size
; ++i)

833 
upd©eCompos™šgDesûndªtGeom‘ry
(
compos™šgAnû¡Ü
, 
nÜm®FlowLi¡
->
©
(
i
), 
upd©eD•th
);

836 ià(
	gÏy”
->
isSckšgCÚ‹xt
()) {

837 ià(
	gVeùÜ
<
	gR’d”Lay”
*>* 
	gposZOrd”Li¡
 = 
Ïy”
->
posZOrd”Li¡
()) {

838 
size_t
 
li¡Size
 = 
posZOrd”Li¡
->
size
();

839 
size_t
 
	gi
 = 0; i < 
	gli¡Size
; ++i)

840 
upd©eCompos™šgDesûndªtGeom‘ry
(
compos™šgAnû¡Ü
, 
posZOrd”Li¡
->
©
(
i
), 
upd©eD•th
);

846 
	gR’d”Lay”Compos™Ü
::
»·štCompos™edLay”sAbsŞu‹Reù
(cÚ¡ 
IÁReù
& 
absReù
)

848 
»cursiveR•aštLay”Reù
(
roÙR’d”Lay”
(), 
absReù
);

851 
	gR’d”Lay”Compos™Ü
::
»cursiveR•aštLay”Reù
(
R’d”Lay”
* 
Ïy”
, cÚ¡ 
IÁReù
& 
»ù
)

854 ià(
	gÏy”
->
isCompos™ed
())

855 
	gÏy”
->
£tBackšgN“dsR•aštInReù
(
»ù
);

857 ià(
	gÏy”
->
hasCompos™šgDesûndªt
()) {

858 ià(
	gVeùÜ
<
	gR’d”Lay”
*>* 
	gÃgZOrd”Li¡
 = 
Ïy”
->
ÃgZOrd”Li¡
()) {

859 
size_t
 
li¡Size
 = 
ÃgZOrd”Li¡
->
size
();

860 
size_t
 
	gi
 = 0; i < 
	gli¡Size
; ++i) {

861 
R’d”Lay”
* 
	gcurLay”
 = 
ÃgZOrd”Li¡
->
©
(
i
);

862 
	gx
 = 0;

863 
	gy
 = 0;

864 
	gcurLay”
->
cÚv”tToLay”CoÜds
(
Ïy”
, 
x
, 
y
);

865 
IÁReù
 
chdReù
(
»ù
);

866 
	gchdReù
.
move
(-
x
, -
y
);

867 
»cursiveR•aštLay”Reù
(
curLay”
, 
chdReù
);

871 ià(
	gVeùÜ
<
	gR’d”Lay”
*>* 
	gposZOrd”Li¡
 = 
Ïy”
->
posZOrd”Li¡
()) {

872 
size_t
 
li¡Size
 = 
posZOrd”Li¡
->
size
();

873 
size_t
 
	gi
 = 0; i < 
	gli¡Size
; ++i) {

874 
R’d”Lay”
* 
	gcurLay”
 = 
posZOrd”Li¡
->
©
(
i
);

875 
	gx
 = 0;

876 
	gy
 = 0;

877 
	gcurLay”
->
cÚv”tToLay”CoÜds
(
Ïy”
, 
x
, 
y
);

878 
IÁReù
 
chdReù
(
»ù
);

879 
	gchdReù
.
move
(-
x
, -
y
);

880 
»cursiveR•aštLay”Reù
(
curLay”
, 
chdReù
);

884 ià(
	gVeùÜ
<
	gR’d”Lay”
*>* 
	gnÜm®FlowLi¡
 = 
Ïy”
->
nÜm®FlowLi¡
()) {

885 
size_t
 
li¡Size
 = 
nÜm®FlowLi¡
->
size
();

886 
size_t
 
	gi
 = 0; i < 
	gli¡Size
; ++i) {

887 
R’d”Lay”
* 
	gcurLay”
 = 
nÜm®FlowLi¡
->
©
(
i
);

888 
	gx
 = 0;

889 
	gy
 = 0;

890 
	gcurLay”
->
cÚv”tToLay”CoÜds
(
Ïy”
, 
x
, 
y
);

891 
IÁReù
 
chdReù
(
»ù
);

892 
	gchdReù
.
move
(-
x
, -
y
);

893 
»cursiveR•aštLay”Reù
(
curLay”
, 
chdReù
);

898 
R’d”Lay”
* 
	gR’d”Lay”Compos™Ü
::
roÙR’d”Lay”
() const

900  
m_»nd”V›w
->
Ïy”
();

903 
G¿phicsLay”
* 
	gR’d”Lay”Compos™Ü
::
roÙPÏtfÜmLay”
() const

905  
m_roÙPÏtfÜmLay”
.
g‘
();

908 
	gR’d”Lay”Compos™Ü
::
didMoveOnsü“n
()

910 ià(!
m_roÙPÏtfÜmLay”
)

913 
F¿me
* 
	gäame
 = 
m_»nd”V›w
->
äameV›w
()->
äame
();

914 
Page
* 
	g·ge
 = 
äame
 ? f¿me->
·ge
() : 0;

915 ià(!
	g·ge
)

918 
	g·ge
->
chrome
()->
ş›Á
()->
©chRoÙG¿phicsLay”
(
äame
, 
m_roÙPÏtfÜmLay”
.
g‘
());

919 
	gm_roÙLay”A‰ached
 = 
Œue
;

922 
	gR’d”Lay”Compos™Ü
::
wlMoveOffsü“n
()

924 ià(!
m_roÙPÏtfÜmLay”
 || !
m_roÙLay”A‰ached
)

927 
F¿me
* 
	gäame
 = 
m_»nd”V›w
->
äameV›w
()->
äame
();

928 
Page
* 
	g·ge
 = 
äame
 ? f¿me->
·ge
() : 0;

929 ià(!
	g·ge
)

932 
	g·ge
->
chrome
()->
ş›Á
()->
©chRoÙG¿phicsLay”
(
äame
, 0);

933 
	gm_roÙLay”A‰ached
 = 
çl£
;

936 
	gR’d”Lay”Compos™Ü
::
upd©eRoÙLay”Pos™iÚ
()

938 ià(
m_roÙPÏtfÜmLay”
)

939 
m_roÙPÏtfÜmLay”
->
£tSize
(
FlßtSize
(
m_»nd”V›w
->
rightLayoutOv”æow
(), m_»nd”V›w->
bÙtomLayoutOv”æow
()));

942 
	gR’d”Lay”Compos™Ü
::
didS¹AcûË¿‹dAnim©iÚ
()

947 
£tCompos™šgCÚsuÉsOv”Ïp
(
çl£
);

950 
boŞ
 
	gR’d”Lay”Compos™Ü
::
has3DCÚ‹Á
() const

952  
Ïy”Has3DCÚ‹Á
(
roÙR’d”Lay”
());

955 
boŞ
 
	gR’d”Lay”Compos™Ü
::
ÃedsToBeCompos™ed
(cÚ¡ 
R’d”Lay”
* 
Ïy”
) const

957 ià(!
ÿnBeCompos™ed
(
Ïy”
))

958  
çl£
;

960  
»quœesCompos™šgLay”
(
Ïy”
è|| 
	gÏy”
->
mu¡Ov”ÏpCompos™edLay”s
(è|| (
šCompos™šgMode
(è&&†ay”->
isRoÙLay”
());

966 
boŞ
 
	gR’d”Lay”Compos™Ü
::
»quœesCompos™šgLay”
(cÚ¡ 
R’d”Lay”
* 
Ïy”
) const

968 
R’d”Objeù
* 
»nd””
 = 
Ïy”
->renderer();

970 ià(
	gÏy”
->
isReæeùiÚ
()) {

971 
	g»nd””
 = 
»nd””
->
·»Á
();

972 
	gÏy”
 = 
toR’d”BoxMod–Objeù
(
»nd””
)->
Ïy”
();

975  
»quœesCompos™šgFÜT¿nsfÜm
(
»nd””
)

976 || 
»quœesCompos™šgFÜVideo
(
»nd””
)

977 || 
»quœesCompos™šgFÜCªvas
(
»nd””
)

978 || 
»quœesCompos™šgFÜPlugš
(
»nd””
)

979 || 
	g»nd””
->
¡yË
()->
backçûVisib™y
(è=ğ
BackçûVisib™yHidd’


980 || 
şsCompos™šgDesûndªts
(
Ïy”
)

981 || 
»quœesCompos™šgFÜAnim©iÚ
(
»nd””
);

984 
boŞ
 
	gR’d”Lay”Compos™Ü
::
ÿnBeCompos™ed
(cÚ¡ 
R’d”Lay”
* 
Ïy”
) const

986  
m_hasAcûË¿‹dCompos™šg
 && 
Ïy”
->
isS–fPaštšgLay”
();

994 
boŞ
 
	gR’d”Lay”Compos™Ü
::
ş³dByAnû¡Ü
(
R’d”Lay”
* 
Ïy”
) const

996 ià(!
Ïy”
->
isCompos™ed
(è|| !Ïy”->
·»Á
())

997  
çl£
;

999 
R’d”Lay”
* 
	gcompos™šgAnû¡Ü
 = 
Ïy”
->
ªû¡ÜCompos™šgLay”
();

1000 ià(!
	gcompos™šgAnû¡Ü
)

1001  
	gçl£
;

1006 
R’d”Lay”
* 
	gcompu‹ClRoÙ
 = 0;

1007 
R’d”Lay”
* 
	gcu¼
 = 
Ïy”
;

1008 
	gcu¼
) {

1009 
R’d”Lay”
* 
	gÃxt
 = 
cu¼
->
·»Á
();

1010 ià(
	gÃxt
 =ğ
compos™šgAnû¡Ü
) {

1011 
compu‹ClRoÙ
 = 
cu¼
;

1014 
	gcu¼
 = 
Ãxt
;

1017 ià(!
	gcompu‹ClRoÙ
 || compu‹ClRoÙ =ğ
Ïy”
)

1018  
çl£
;

1020 
IÁReù
 
	gbackgroundReù
 = 
Ïy”
->
backgroundClReù
(
compu‹ClRoÙ
, 
Œue
);

1021  
	gbackgroundReù
 !ğ
ClReùs
::
šfš™eReù
();

1027 
boŞ
 
	gR’d”Lay”Compos™Ü
::
şsCompos™šgDesûndªts
(cÚ¡ 
R’d”Lay”
* 
Ïy”
) const

1030  
Ïy”
->
hasCompos™šgDesûndªt
() &&

1031 
Ïy”
->
»nd””
()->
hasOv”æowCl
();

1034 
boŞ
 
	gR’d”Lay”Compos™Ü
::
»quœesCompos™šgFÜT¿nsfÜm
(
R’d”Objeù
* 
»nd””
) const

1036 
R’d”StyË
* 
¡yË
 = 
»nd””
->style();

1039  
	g»nd””
->
hasT¿nsfÜm
(è&& (
	g¡yË
->
ŒªsfÜm
().
has3DO³¿tiÚ
(è|| styË->
ŒªsfÜmStyË3D
(è=ğ
T¿nsfÜmStyË3DP»£rve3D
 || 
¡yË
->
hasP”¥eùive
());

1042 
boŞ
 
	gR’d”Lay”Compos™Ü
::
»quœesCompos™šgFÜVideo
(
R’d”Objeù
* 
»nd””
) const

1044 #ià
ENABLE
(
VIDEO
)

1045 ià(
»nd””
->
isVideo
()) {

1046 
R’d”Video
* 
video
 = 
toR’d”Video
(
»nd””
);

1047  
ÿnAcûË¿‹VideoR’d”šg
(
video
);

1049 #ià
ENABLE
(
PLUGIN_PROXY_FOR_VIDEO
)

1050 ià(
	g»nd””
->
isR’d”P¬t
()) {

1051 ià(!
	gm_hasAcûË¿‹dCompos™šg
)

1052  
	gçl£
;

1054 
Node
* 
	gnode
 = 
»nd””
->
node
();

1055 ià(!
	gnode
 || (!node->
hasTagName
(
HTMLNames
::
videoTag
è&& !
node
->hasTagName(HTMLNames::
audioTag
)))

1056  
çl£
;

1058 
HTMLMedŸEËm’t
* 
	gmedŸEËm’t
 = 
¡©ic_ÿ¡
<HTMLMedŸEËm’t*>(
node
);

1059  
	gmedŸEËm’t
->
¶ay”
(è? medŸEËm’t->¶ay”()->
suµÜtsAcûË¿‹dR’d”šg
(è: 
çl£
;

1063 
UNUSED_PARAM
(
»nd””
);

1065  
	gçl£
;

1068 
boŞ
 
	gR’d”Lay”Compos™Ü
::
»quœesCompos™šgFÜCªvas
(
R’d”Objeù
* 
»nd””
) const

1070 #ià
ENABLE
(3D
_CANVAS
)

1071 ià(
»nd””
->
isCªvas
()) {

1072 
HTMLCªvasEËm’t
* 
ÿnvas
 = 
¡©ic_ÿ¡
<HTMLCªvasEËm’t*>(
»nd””
->
node
());

1073  
	gÿnvas
->
is3D
();

1076 
UNUSED_PARAM
(
»nd””
);

1078  
	gçl£
;

1081 
boŞ
 
	gR’d”Lay”Compos™Ü
::
»quœesCompos™šgFÜPlugš
(
R’d”Objeù
* 
»nd””
) const

1083  
»nd””
->
isEmbeddedObjeù
(è&& 
toR’d”EmbeddedObjeù
Ô’d””)->
®lowsAcûË¿‹dCompos™šg
();

1086 
boŞ
 
	gR’d”Lay”Compos™Ü
::
»quœesCompos™šgFÜAnim©iÚ
(
R’d”Objeù
* 
»nd””
) const

1088 ià(
Anim©iÚCÚŒŞËr
* 
ªimCÚŒŞËr
 = 
»nd””
->
ªim©iÚ
()) {

1089  (
ªimCÚŒŞËr
->
isAnim©šgPrİ”tyOnR’d””
(
»nd””
, 
CSSPrİ”tyO·c™y
è&& 
šCompos™šgMode
())

1090 || 
ªimCÚŒŞËr
->
isAnim©šgPrİ”tyOnR’d””
(
»nd””
, 
CSSPrİ”tyWebk™T¿nsfÜm
);

1092  
	gçl£
;

1095 
boŞ
 
	gR’d”Lay”Compos™Ü
::
»quœesCompos™šgWh’DesûndªtsA»Compos™šg
(
R’d”Objeù
* 
»nd””
) const

1097  
»nd””
->
hasT¿nsfÜm
(è||„’d””->
isT¿n¥¬’t
(è||„’d””->
hasMask
(è||„’d””->
hasReæeùiÚ
();

1103 
boŞ
 
	gR’d”Lay”Compos™Ü
::
ÃedsCÚ‹ÁsCompos™šgLay”
(cÚ¡ 
R’d”Lay”
* 
Ïy”
) const

1105  (
Ïy”
->
m_ÃgZOrd”Li¡
 &&†ay”->m_ÃgZOrd”Li¡->
size
() > 0);

1108 
	gR’d”Lay”Compos™Ü
::
’su»RoÙPÏtfÜmLay”
()

1110 ià(
m_roÙPÏtfÜmLay”
)

1113 
	gm_roÙPÏtfÜmLay”
 = 
G¿phicsLay”
::
ü—‹
(0);

1114 
	gm_roÙPÏtfÜmLay”
->
£tSize
(
FlßtSize
(
m_»nd”V›w
->
rightLayoutOv”æow
(), m_»nd”V›w->
bÙtomLayoutOv”æow
()));

1115 
	gm_roÙPÏtfÜmLay”
->
£tPos™iÚ
(
FlßtPošt
(0, 0));

1117 
	gm_roÙPÏtfÜmLay”
->
£tGeom‘ryOr›Á©iÚ
(
G¿phicsLay”
::
compos™šgCoÜdš©esOr›Á©iÚ
());

1120 
	gm_roÙPÏtfÜmLay”
->
£tMasksToBounds
(
Œue
);

1122 
didMoveOnsü“n
();

1125 
	gR’d”Lay”Compos™Ü
::
de¡royRoÙPÏtfÜmLay”
()

1127 ià(!
m_roÙPÏtfÜmLay”
)

1130 
wlMoveOffsü“n
();

1131 
	gm_roÙPÏtfÜmLay”
 = 0;

1134 
boŞ
 
	gR’d”Lay”Compos™Ü
::
Ïy”Has3DCÚ‹Á
(cÚ¡ 
R’d”Lay”
* 
Ïy”
) const

1136 cÚ¡ 
R’d”StyË
* 
¡yË
 = 
Ïy”
->
»nd””
()->style();

1138 ià(
	g¡yË
 &&

1139 (
	g¡yË
->
ŒªsfÜmStyË3D
(è=ğ
T¿nsfÜmStyË3DP»£rve3D
 ||

1140 
¡yË
->
hasP”¥eùive
() ||

1141 
¡yË
->
ŒªsfÜm
().
has3DO³¿tiÚ
()))

1142  
Œue
;

1144 ià(
	gÏy”
->
isSckšgCÚ‹xt
()) {

1145 ià(
	gVeùÜ
<
	gR’d”Lay”
*>* 
	gÃgZOrd”Li¡
 = 
Ïy”
->
ÃgZOrd”Li¡
()) {

1146 
size_t
 
li¡Size
 = 
ÃgZOrd”Li¡
->
size
();

1147 
size_t
 
	gi
 = 0; i < 
	gli¡Size
; ++i) {

1148 
R’d”Lay”
* 
	gcurLay”
 = 
ÃgZOrd”Li¡
->
©
(
i
);

1149 ià(
Ïy”Has3DCÚ‹Á
(
curLay”
))

1150  
	gŒue
;

1154 ià(
	gVeùÜ
<
	gR’d”Lay”
*>* 
	gposZOrd”Li¡
 = 
Ïy”
->
posZOrd”Li¡
()) {

1155 
size_t
 
li¡Size
 = 
posZOrd”Li¡
->
size
();

1156 
size_t
 
	gi
 = 0; i < 
	gli¡Size
; ++i) {

1157 
R’d”Lay”
* 
	gcurLay”
 = 
posZOrd”Li¡
->
©
(
i
);

1158 ià(
Ïy”Has3DCÚ‹Á
(
curLay”
))

1159  
	gŒue
;

1164 ià(
	gVeùÜ
<
	gR’d”Lay”
*>* 
	gnÜm®FlowLi¡
 = 
Ïy”
->
nÜm®FlowLi¡
()) {

1165 
size_t
 
li¡Size
 = 
nÜm®FlowLi¡
->
size
();

1166 
size_t
 
	gi
 = 0; i < 
	gli¡Size
; ++i) {

1167 
R’d”Lay”
* 
	gcurLay”
 = 
nÜm®FlowLi¡
->
©
(
i
);

1168 ià(
Ïy”Has3DCÚ‹Á
(
curLay”
))

1169  
	gŒue
;

1172  
	gçl£
;

	@RenderLayerCompositor.h

26 #iâdeà
R’d”Lay”Compos™Ü_h


27 
	#R’d”Lay”Compos™Ü_h


	)

29 
	~"R’d”Lay”.h
"

30 
	~"R’d”Lay”Backšg.h
"

32 
Çme¥aû
 
	gWebCÜe
 {

34 
	#PROFILE_LAYER_REBUILD
 0

	)

36 
şass
 
	gG¿phicsLay”
;

37 #ià
ENABLE
(
VIDEO
)

38 
şass
 
	gR’d”Video
;

41 
	eCompos™šgUpd©eTy³
 {

42 
	gCompos™šgUpd©eAá”LayoutOrStyËChªge
,

43 
	gCompos™šgUpd©eOnPa™šgOrH™Te¡
,

44 
	gCompos™šgUpd©eOnSüŞl


54 şas 
	cR’d”Lay”Compos™Ü
 {

55 
	gpublic
:

56 
R’d”Lay”Compos™Ü
(
R’d”V›w
*);

57 ~
R’d”Lay”Compos™Ü
();

61 
boŞ
 
šCompos™šgMode
(ècÚ¡ {  
	gm_compos™šg
; }

64 
’abËCompos™šgMode
(
boŞ
 
’abË
 = 
Œue
);

67 
boŞ
 
hasAcûË¿‹dCompos™šg
(ècÚ¡ {  
	gm_hasAcûË¿‹dCompos™šg
; }

69 
boŞ
 
showDebugBÜd”s
(ècÚ¡ {  
	gm_showDebugBÜd”s
; }

70 
boŞ
 
showR•aštCouÁ”
(ècÚ¡ {  
	gm_showR•aštCouÁ”
; }

73 
ÿcheAcûË¿‹dCompos™šgFÏgs
();

77 
£tCompos™šgLay”sN“dRebud
(
boŞ
 
ÃedRebud
 = 
Œue
);

78 
boŞ
 
compos™šgLay”sN“dRebud
(ècÚ¡ {  
	gm_compos™šgLay”sN“dRebud
; }

82 
£tCompos™šgCÚsuÉsOv”Ïp
(
boŞ
 
b
è{ 
	gm_compos™šgCÚsuÉsOv”Ïp
 = b; }

83 
boŞ
 
compos™šgCÚsuÉsOv”Ïp
(ècÚ¡ {  
	gm_compos™šgCÚsuÉsOv”Ïp
; }

85 
scheduËSync
();

88 
upd©eCompos™šgLay”s
(
Compos™šgUpd©eTy³
 = 
Compos™šgUpd©eAá”LayoutOrStyËChªge
, 
R’d”Lay”
* 
upd©eRoÙ
 = 0);

91 
	eCompos™šgChªgeR•ašt
 { 
	gCompos™šgChªgeR•aštNow
, 
	gCompos™šgChªgeWlR•aštL©”
 };

92 
boŞ
 
upd©eLay”Compos™šgS‹
(
R’d”Lay”
*, 
Compos™šgChªgeR•ašt
 = 
Compos™šgChªgeR•aštNow
);

95 
upd©eCompos™šgDesûndªtGeom‘ry
(
R’d”Lay”
* 
compos™šgAnû¡Ü
, R’d”Lay”* 
Ïy”
, 
R’d”Lay”Backšg
::
Upd©eD•th
);

98 
boŞ
 
ş³dByAnû¡Ü
(
R’d”Lay”
*) const;

100 
boŞ
 
şsCompos™šgDesûndªts
(cÚ¡ 
R’d”Lay”
*) const;

103 
boŞ
 
ÃedsCÚ‹ÁsCompos™šgLay”
(cÚ¡ 
R’d”Lay”
*) const;

106 
IÁReù
 
ÿlcuÏ‹Compos™edBounds
(cÚ¡ 
R’d”Lay”
* 
Ïy”
, cÚ¡ R’d”Lay”* 
ªû¡ÜLay”
);

109 
»·štOnCompos™šgChªge
(
R’d”Lay”
*);

112 
Ïy”WasAdded
(
R’d”Lay”
* 
·»Á
, R’d”Lay”* 
chd
);

113 
Ïy”WlBeRemoved
(
R’d”Lay”
* 
·»Á
, R’d”Lay”* 
chd
);

116 
R’d”Lay”
* 
’şosšgNÚSckšgClpšgLay”
(cÚ¡ R’d”Lay”* 
Ïy”
) const;

119 
»·štCompos™edLay”sAbsŞu‹Reù
(cÚ¡ 
IÁReù
&);

121 
R’d”Lay”
* 
roÙR’d”Lay”
() const;

122 
G¿phicsLay”
* 
roÙPÏtfÜmLay”
() const;

124 
didMoveOnsü“n
();

125 
wlMoveOffsü“n
();

127 
upd©eRoÙLay”Pos™iÚ
();

129 
didS¹AcûË¿‹dAnim©iÚ
();

131 #ià
ENABLE
(
VIDEO
)

133 
boŞ
 
ÿnAcûË¿‹VideoR’d”šg
(
R’d”Video
*) const;

138 
boŞ
 
has3DCÚ‹Á
() const;

140 
	g´iv©e
:

142 
boŞ
 
ÃedsToBeCompos™ed
(cÚ¡ 
R’d”Lay”
*) const;

144 
boŞ
 
»quœesCompos™šgLay”
(cÚ¡ 
R’d”Lay”
*) const;

146 
boŞ
 
ÿnBeCompos™ed
(cÚ¡ 
R’d”Lay”
*) const;

149 
boŞ
 
upd©eBackšg
(
R’d”Lay”
*, 
Compos™šgChªgeR•ašt
 
shouldR•ašt
);

152 
»cursiveR•aštLay”Reù
(
R’d”Lay”
* 
Ïy”
, cÚ¡ 
IÁReù
& 
»ù
);

154 
	gHashM­
<
	tR’d”Lay”
*, 
	tIÁReù
> 
	tOv”ÏpM­
;

155 
addToOv”ÏpM­
(
Ov”ÏpM­
&, 
R’d”Lay”
*, 
IÁReù
& 
Ïy”Bounds
, 
boŞ
& 
boundsCompu‹d
);

156 
boŞ
 
ov”ÏpsCompos™edLay”s
(
Ov”ÏpM­
&, cÚ¡ 
IÁReù
& 
Ïy”Bounds
);

159 
compu‹Compos™šgRequœem’ts
(
R’d”Lay”
*, 
Ov”ÏpM­
*, 
Compos™šgS‹
&, 
boŞ
& 
Ïy”sChªged
);

162 
»budCompos™šgLay”T»e
(
R’d”Lay”
* 
Ïy”
, cÚ¡ 
Compos™šgS‹
&, 
VeùÜ
<
G¿phicsLay”
*>& 
chdG¿phicsLay”sOfEnşosšgLay”
);

165 
upd©eLay”T»eGeom‘ry
(
R’d”Lay”
*);

168 
£tCompos™šgP¬’t
(
R’d”Lay”
* 
chdLay”
, R’d”Lay”* 
·»ÁLay”
);

169 
»moveCompos™edChd»n
(
R’d”Lay”
*);

171 
·»ÁInRoÙLay”
(
R’d”Lay”
*);

173 
boŞ
 
Ïy”Has3DCÚ‹Á
(cÚ¡ 
R’d”Lay”
*) const;

175 
’su»RoÙPÏtfÜmLay”
();

176 
de¡royRoÙPÏtfÜmLay”
();

179 
boŞ
 
»quœesCompos™šgFÜAnim©iÚ
(
R’d”Objeù
*) const;

180 
boŞ
 
»quœesCompos™šgFÜT¿nsfÜm
(
R’d”Objeù
*) const;

181 
boŞ
 
»quœesCompos™šgFÜVideo
(
R’d”Objeù
*) const;

182 
boŞ
 
»quœesCompos™šgFÜCªvas
(
R’d”Objeù
*) const;

183 
boŞ
 
»quœesCompos™šgFÜPlugš
(
R’d”Objeù
*) const;

184 
boŞ
 
»quœesCompos™šgWh’DesûndªtsA»Compos™šg
(
R’d”Objeù
*) const;

186 
	g´iv©e
:

187 
R’d”V›w
* 
m_»nd”V›w
;

188 
	gOwnPŒ
<
	gG¿phicsLay”
> 
	gm_roÙPÏtfÜmLay”
;

189 
boŞ
 
	gm_hasAcûË¿‹dCompos™šg
;

190 
boŞ
 
	gm_showDebugBÜd”s
;

191 
boŞ
 
	gm_showR•aštCouÁ”
;

192 
boŞ
 
	gm_compos™šgCÚsuÉsOv”Ïp
;

193 
boŞ
 
	gm_compos™šg
;

194 
boŞ
 
	gm_roÙLay”A‰ached
;

195 
boŞ
 
	gm_compos™šgLay”sN“dRebud
;

197 #ià
PROFILE_LAYER_REBUILD


198 
	gm_roÙLay”Upd©eCouÁ
;

	@RenderLineBoxList.cpp

29 
	~"cÚfig.h
"

30 
	~"R’d”LšeBoxLi¡.h
"

32 
	~"IÆšeTextBox.h
"

33 
	~"R’d”A»Ç.h
"

34 
	~"R’d”IÆše.h
"

35 
	~"R’d”V›w.h
"

36 
	~"RoÙIÆšeBox.h
"

38 
usšg
 
Çme¥aû
 
	g¡d
;

40 
Çme¥aû
 
	gWebCÜe
 {

42 #iâdeà
NDEBUG


43 
	gR’d”LšeBoxLi¡
::~
R’d”LšeBoxLi¡
()

45 
ASSERT
(!
m_fœ¡LšeBox
);

46 
ASSERT
(!
m_Ï¡LšeBox
);

50 
	gR’d”LšeBoxLi¡
::
­³ndLšeBox
(
IÆšeFlowBox
* 
box
)

52 
checkCÚsi¡’cy
();

54 ià(!
	gm_fœ¡LšeBox
)

55 
	gm_fœ¡LšeBox
 = 
m_Ï¡LšeBox
 = 
box
;

57 
	gm_Ï¡LšeBox
->
£tNextLšeBox
(
box
);

58 
	gbox
->
£tP»viousLšeBox
(
m_Ï¡LšeBox
);

59 
	gm_Ï¡LšeBox
 = 
box
;

62 
checkCÚsi¡’cy
();

65 
	gR’d”LšeBoxLi¡
::
d–‘eLšeBoxT»e
(
R’d”A»Ç
* 
¬’a
)

67 
IÆšeFlowBox
* 
lše
 = 
m_fœ¡LšeBox
;

68 
IÆšeFlowBox
* 
	gÃxtLše
;

69 
	glše
) {

70 
	gÃxtLše
 = 
lše
->
ÃxtLšeBox
();

71 
	glše
->
d–‘eLše
(
¬’a
);

72 
	glše
 = 
ÃxtLše
;

74 
	gm_fœ¡LšeBox
 = 
m_Ï¡LšeBox
 = 0;

77 
	gR’d”LšeBoxLi¡
::
exŒaùLšeBox
(
IÆšeFlowBox
* 
box
)

79 
checkCÚsi¡’cy
();

81 
	gm_Ï¡LšeBox
 = 
box
->
´evLšeBox
();

82 ià(
	gbox
 =ğ
m_fœ¡LšeBox
)

83 
m_fœ¡LšeBox
 = 0;

84 ià(
	gbox
->
´evLšeBox
())

85 
	gbox
->
´evLšeBox
()->
£tNextLšeBox
(0);

86 
	gbox
->
£tP»viousLšeBox
(0);

87 
IÆšeFlowBox
* 
	gcu¼
 = 
box
; cu¼; cu¼ = 
cu¼
->
ÃxtLšeBox
())

88 
cu¼
->
£tExŒaùed
();

90 
checkCÚsi¡’cy
();

93 
	gR’d”LšeBoxLi¡
::
©chLšeBox
(
IÆšeFlowBox
* 
box
)

95 
checkCÚsi¡’cy
();

97 ià(
	gm_Ï¡LšeBox
) {

98 
	gm_Ï¡LšeBox
->
£tNextLšeBox
(
box
);

99 
	gbox
->
£tP»viousLšeBox
(
m_Ï¡LšeBox
);

101 
	gm_fœ¡LšeBox
 = 
box
;

102 
IÆšeFlowBox
* 
	gÏ¡
 = 
box
;

103 
IÆšeFlowBox
* 
	gcu¼
 = 
box
; cu¼; cu¼ = 
cu¼
->
ÃxtLšeBox
()) {

104 
cu¼
->
£tExŒaùed
(
çl£
);

105 
	gÏ¡
 = 
cu¼
;

107 
	gm_Ï¡LšeBox
 = 
Ï¡
;

109 
checkCÚsi¡’cy
();

112 
	gR’d”LšeBoxLi¡
::
»moveLšeBox
(
IÆšeFlowBox
* 
box
)

114 
checkCÚsi¡’cy
();

116 ià(
	gbox
 =ğ
m_fœ¡LšeBox
)

117 
m_fœ¡LšeBox
 = 
box
->
ÃxtLšeBox
();

118 ià(
	gbox
 =ğ
m_Ï¡LšeBox
)

119 
m_Ï¡LšeBox
 = 
box
->
´evLšeBox
();

120 ià(
	gbox
->
ÃxtLšeBox
())

121 
	gbox
->
ÃxtLšeBox
()->
£tP»viousLšeBox
(
box
->
´evLšeBox
());

122 ià(
	gbox
->
´evLšeBox
())

123 
	gbox
->
´evLšeBox
()->
£tNextLšeBox
(
box
->
ÃxtLšeBox
());

125 
checkCÚsi¡’cy
();

128 
	gR’d”LšeBoxLi¡
::
d–‘eLšeBoxes
(
R’d”A»Ç
* 
¬’a
)

130 ià(
m_fœ¡LšeBox
) {

131 
IÆšeFlowBox
* 
Ãxt
;

132 
IÆšeFlowBox
* 
	gcu¼
 = 
m_fœ¡LšeBox
; cu¼; cu¼ = 
Ãxt
) {

133 
Ãxt
 = 
cu¼
->
ÃxtLšeBox
();

134 
	gcu¼
->
de¡roy
(
¬’a
);

136 
	gm_fœ¡LšeBox
 = 0;

137 
	gm_Ï¡LšeBox
 = 0;

141 
	gR’d”LšeBoxLi¡
::
dœtyLšeBoxes
()

143 
IÆšeFlowBox
* 
cu¼
 = 
fœ¡LšeBox
(); 
	gcu¼
; cu¼ = cu¼->
ÃxtLšeBox
())

144 
cu¼
->
dœtyLšeBoxes
();

147 
	gR’d”LšeBoxLi¡
::
·št
(
R’d”BoxMod–Objeù
* 
»nd””
, 
R’d”Objeù
::
PaštInfo
& 
·štInfo
, 
tx
, 
ty
) const

150 ià(
	g·štInfo
.
	gpha£
 !ğ
PaštPha£FÜeground
 && 
·štInfo
.
pha£
 !ğ
PaštPha£S–eùiÚ
 &&…aštInfo.pha£ !ğ
PaštPha£Ouše


151 && 
·štInfo
.
pha£
 !ğ
PaštPha£S–fOuše
 &&…aštInfo.pha£ !ğ
PaštPha£ChdOušes
 &&…aštInfo.pha£ !ğ
PaštPha£TextCl


152 && 
·štInfo
.
pha£
 !ğ
PaštPha£Mask
)

155 
ASSERT
(
»nd””
->
isR’d”Block
(è|| (»nd””->
isR’d”IÆše
(è&&„’d””->
hasLay”
()));

158 ià(!
fœ¡LšeBox
())

165 
	gyPos
 = 
fœ¡LšeBox
()->
tİVisibËOv”æow
(è- 
»nd””
->
maxim®OušeSize
(
·štInfo
.
pha£
);

166 
	gh
 = 
»nd””
->
maxim®OušeSize
(
·štInfo
.
pha£
è+ 
Ï¡LšeBox
()->
bÙtomVisibËOv”æow
(è- 
yPos
;

167 
	gyPos
 +ğ
ty
;

168 ià(
	gyPos
 >ğ
·štInfo
.
»ù
.
bÙtom
(è|| 
yPos
 + 
h
 <ğ·štInfo.»ù.
y
())

171 
	gR’d”Objeù
::
PaštInfo
 
šfo
(
·štInfo
);

172 
	gLi¡HashS‘
<
	gR’d”IÆše
*> 
	goušeObjeùs
;

173 
	gšfo
.
	goušeObjeùs
 = &
oušeObjeùs
;

178 
R’d”V›w
* 
	gv
 = 
»nd””
->
v›w
();

179 
boŞ
 
	gu£PrštReù
 = !
v
->
´štReù
().
isEm±y
();

180 
IÆšeFlowBox
* 
	gcu¼
 = 
fœ¡LšeBox
(); cu¼; cu¼ = 
cu¼
->
ÃxtLšeBox
()) {

181 ià(
u£PrštReù
) {

187 ià(
cu¼
->
bÙtomVisibËOv”æow
(è- cu¼->
tİVisibËOv”æow
(è<ğ
v
->
´štReù
().
height
()) {

188 ià(
ty
 + 
cu¼
->
bÙtomVisibËOv”æow
(è> 
v
->
´štReù
().
bÙtom
()) {

189 ià(
ty
 + 
cu¼
->
tİVisibËOv”æow
(è< 
v
->
Œunÿ‹dAt
())

190 
v
->
£tBe¡Trunÿ‹dAt
(
ty
 + 
cu¼
->
roÙ
()->
tİVisibËOv”æow
(), 
»nd””
);

192 ià(
	gty
 + 
	gcu¼
->
tİVisibËOv”æow
(è>ğ
v
->
Œunÿ‹dAt
())

198 
	gtİ
 = 
mš
(
cu¼
->
tİVisibËOv”æow
(), cu¼->
roÙ
()->
£ËùiÚTİ
()è- 
	g»nd””
->
maxim®OušeSize
(
šfo
.
pha£
);

199 
	gbÙtom
 = 
cu¼
->
bÙtomVisibËOv”æow
(è+ 
»nd””
->
maxim®OušeSize
(
šfo
.
pha£
);

200 
	gh
 = 
bÙtom
 - 
tİ
;

201 
	gyPos
 = 
ty
 + 
tİ
;

202 
	gv
->
£tMšimumCŞumnHeight
(
h
);

203 ià(
	gyPos
 < 
	gšfo
.
	g»ù
.
bÙtom
(è&& yPo + 
	gh
 > info.»ù.
y
())

204 
	gcu¼
->
·št
(
šfo
, 
tx
, 
ty
);

207 ià(
	gšfo
.
	gpha£
 =ğ
PaštPha£Ouše
 || 
šfo
.
pha£
 =ğ
PaštPha£S–fOuše
 || info.pha£ =ğ
PaštPha£ChdOušes
) {

208 
Li¡HashS‘
<
R’d”IÆše
*>::
™”©Ü
 
’d
 = 
šfo
.
oušeObjeùs
->end();

209 
	gLi¡HashS‘
<
	gR’d”IÆše
*>::
™”©Ü
 
™
 = 
šfo
.
oušeObjeùs
->
begš
(); 
	g™
 !ğ
’d
; ++it) {

210 
R’d”IÆše
* 
	gæow
 = *
™
;

211 
	gæow
->
·štOuše
(
šfo
.
cÚ‹xt
, 
tx
, 
ty
);

213 
	gšfo
.
	goušeObjeùs
->
ş—r
();

218 
boŞ
 
	gR’d”LšeBoxLi¡
::
h™Te¡
(
R’d”BoxMod–Objeù
* 
»nd””
, cÚ¡ 
H™Te¡Reque¡
& 
»que¡
, 
H™Te¡ResuÉ
& 
»suÉ
, 
x
, 
y
, 
tx
, 
ty
, 
H™Te¡AùiÚ
 
h™Te¡AùiÚ
) const

220 ià(
	gh™Te¡AùiÚ
 !ğ
H™Te¡FÜeground
)

221  
çl£
;

223 
ASSERT
(
»nd””
->
isR’d”Block
(è|| (»nd””->
isR’d”IÆše
(è&&„’d””->
hasLay”
()));

226 ià(!
fœ¡LšeBox
())

227  
	gçl£
;

233 ià((
	gy
 >ğ
ty
 + 
Ï¡LšeBox
()->
roÙ
()->
bÙtomVisibËOv”æow
()è|| (
y
 <y + 
fœ¡LšeBox
()->roÙ()->
tİVisibËOv”æow
()))

234  
çl£
;

239 
IÆšeFlowBox
* 
	gcu¼
 = 
Ï¡LšeBox
(); cu¼; cu¼ = 
cu¼
->
´evLšeBox
()) {

240 ià(
y
 >ğ
ty
 + 
cu¼
->
roÙ
()->
tİVisibËOv”æow
(è&& y <y + cu¼->roÙ()->
bÙtomVisibËOv”æow
()) {

241 
boŞ
 
šside
 = 
cu¼
->
nodeAtPošt
(
»que¡
, 
»suÉ
, 
x
, 
y
, 
tx
, 
ty
);

242 ià(
	gšside
) {

243 
	g»nd””
->
upd©eH™Te¡ResuÉ
(
»suÉ
, 
IÁPošt
(
x
 - 
tx
, 
y
 - 
ty
));

244  
	gŒue
;

249  
	gçl£
;

252 
	gR’d”LšeBoxLi¡
::
dœtyLšesFromChªgedChd
(
R’d”Objeù
* 
cÚš”
, R’d”Objeù* 
chd
)

254 ià(!
	gcÚš”
->
·»Á
(è|| (cÚš”->
isR’d”Block
(è&& (cÚš”->
£lfN“dsLayout
(è|| !cÚš”->
isBlockFlow
())))

258 ià(!
fœ¡LšeBox
()) {

261 ià(
	gcÚš”
->
isIÆše
(è&& !cÚš”->
·»Á
()->
£lfN“dsLayout
())

262 
	gcÚš”
->
·»Á
()->
dœtyLšesFromChªgedChd
(
cÚš”
);

269 
RoÙIÆšeBox
* 
	gbox
 = 0;

270 
R’d”Objeù
* 
	gcu¼
 = 0;

271 
	gcu¼
 = 
chd
->
´eviousSiblšg
(); cu¼; cu¼ = 
cu¼
->previousSibling()) {

272 ià(
cu¼
->
isFlßtšgOrPos™iÚed
())

275 ià(
	gcu¼
->
isR•Ïûd
()) {

276 
IÆšeBox
* 
	gw¿µ”
 = 
toR’d”Box
(
cu¼
)->
šlšeBoxW¿µ”
();

277 ià(
	gw¿µ”
)

278 
	gbox
 = 
w¿µ”
->
roÙ
();

279 } ià(
	gcu¼
->
isText
()) {

280 
IÆšeTextBox
* 
	g‹xtBox
 = 
toR’d”Text
(
cu¼
)->
Ï¡TextBox
();

281 ià(
	g‹xtBox
)

282 
	gbox
 = 
‹xtBox
->
roÙ
();

283 } ià(
	gcu¼
->
isR’d”IÆše
()) {

284 
IÆšeFlowBox
* 
	gæowBox
 = 
toR’d”IÆše
(
cu¼
)->
Ï¡LšeBox
();

285 ià(
	gæowBox
)

286 
	gbox
 = 
æowBox
->
roÙ
();

289 ià(
	gbox
)

292 ià(!
	gbox
)

293 
	gbox
 = 
fœ¡LšeBox
()->
roÙ
();

296 ià(
	gbox
) {

297 
RoÙIÆšeBox
* 
	gadjaûÁBox
;

298 
	gbox
->
m¬kDœty
();

307 
	gadjaûÁBox
 = 
box
->
´evRoÙBox
();

308 ià(
	gadjaûÁBox
)

309 
	gadjaûÁBox
->
m¬kDœty
();

310 ià(
	gchd
->
isBR
(è|| (
	gcu¼
 && curr->isBR())) {

311 
	gadjaûÁBox
 = 
box
->
ÃxtRoÙBox
();

312 ià(
	gadjaûÁBox
)

313 
	gadjaûÁBox
->
m¬kDœty
();

318 #iâdeà
NDEBUG


320 
	gR’d”LšeBoxLi¡
::
checkCÚsi¡’cy
() const

322 #ifdeà
CHECK_CONSISTENCY


323 cÚ¡ 
IÆšeFlowBox
* 
´ev
 = 0;

324 cÚ¡ 
IÆšeFlowBox
* 
	gchd
 = 
m_fœ¡LšeBox
; chd !ğ0; chd = 
chd
->
ÃxtLšeBox
()) {

325 
ASSERT
(
chd
->
´evLšeBox
(è=ğ
´ev
);

326 
	g´ev
 = 
chd
;

328 
ASSERT
(
´ev
 =ğ
m_Ï¡LšeBox
);

	@RenderLineBoxList.h

30 #iâdeà
R’d”LšeBoxLi¡_h


31 
	#R’d”LšeBoxLi¡_h


	)

33 
	~"R’d”Box.h
"

35 
Çme¥aû
 
	gWebCÜe
 {

37 şas 
	cR’d”LšeBoxLi¡
 {

38 
	gpublic
:

39 
R’d”LšeBoxLi¡
()

40 : 
m_fœ¡LšeBox
(0)

41 , 
m_Ï¡LšeBox
(0)

45 #iâdeà
NDEBUG


46 ~
R’d”LšeBoxLi¡
();

49 
IÆšeFlowBox
* 
fœ¡LšeBox
(ècÚ¡ {  
	gm_fœ¡LšeBox
; }

50 
IÆšeFlowBox
* 
Ï¡LšeBox
(ècÚ¡ {  
	gm_Ï¡LšeBox
; }

52 
checkCÚsi¡’cy
() const;

54 
­³ndLšeBox
(
IÆšeFlowBox
*);

56 
d–‘eLšeBoxT»e
(
R’d”A»Ç
*);

57 
d–‘eLšeBoxes
(
R’d”A»Ç
*);

59 
exŒaùLšeBox
(
IÆšeFlowBox
*);

60 
©chLšeBox
(
IÆšeFlowBox
*);

61 
»moveLšeBox
(
IÆšeFlowBox
*);

63 
dœtyLšeBoxes
();

64 
dœtyLšesFromChªgedChd
(
R’d”Objeù
* 
·»Á
, R’d”Objeù* 
chd
);

66 
·št
(
R’d”BoxMod–Objeù
*, 
R’d”Objeù
::
PaštInfo
&, 
x
, 
y
) const;

67 
boŞ
 
h™Te¡
(
R’d”BoxMod–Objeù
*, cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, 
x
, 
y
, 
tx
, 
ty
, 
H™Te¡AùiÚ
) const;

69 
	g´iv©e
:

73 
IÆšeFlowBox
* 
m_fœ¡LšeBox
;

74 
IÆšeFlowBox
* 
	gm_Ï¡LšeBox
;

78 #ifdeà
NDEBUG


79 
šlše
 
	gR’d”LšeBoxLi¡
::
	$checkCÚsi¡’cy
() const

81 
	}
}

	@RenderListBox.cpp

32 
	~"cÚfig.h
"

33 
	~"R’d”Li¡Box.h
"

35 
	~"AXObjeùCache.h
"

36 
	~"CSSStyËS–eùÜ.h
"

37 
	~"Docum’t.h
"

38 
	~"Ev’tHªdËr.h
"

39 
	~"Ev’tNames.h
"

40 
	~"FocusCÚŒŞËr.h
"

41 
	~"F¿me.h
"

42 
	~"F¿meV›w.h
"

43 
	~"G¿phicsCÚ‹xt.h
"

44 
	~"HTMLNames.h
"

45 
	~"H™Te¡ResuÉ.h
"

46 
	~"O±iÚGroupEËm’t.h
"

47 
	~"O±iÚEËm’t.h
"

48 
	~"Page.h
"

49 
	~"R’d”SüŞlb¬.h
"

50 
	~"R’d”Theme.h
"

51 
	~"R’d”V›w.h
"

52 
	~"SüŞlb¬.h
"

53 
	~"S–eùEËm’t.h
"

54 
	~"S–eùiÚCÚŒŞËr.h
"

55 
	~"NodeR’d”StyË.h
"

56 
	~<m©h.h
>

58 
usšg
 
Çme¥aû
 
	g¡d
;

60 
Çme¥aû
 
	gWebCÜe
 {

62 
usšg
 
Çme¥aû
 
	gHTMLNames
;

64 cÚ¡ 
	growS·cšg
 = 1;

66 cÚ¡ 
	gİtiÚsS·cšgHÜizÚl
 = 2;

68 cÚ¡ 
	gmšSize
 = 4;

69 cÚ¡ 
	gmaxDeçuÉSize
 = 10;

73 cÚ¡ 
	gba£lšeAdju¡m’t
 = 7;

75 
	gR’d”Li¡Box
::
R’d”Li¡Box
(
EËm’t
* 
–em’t
)

76 : 
R’d”Block
(
–em’t
)

77 , 
m_İtiÚsChªged
(
Œue
)

78 , 
m_süŞlToRev—lS–eùiÚAá”Layout
(
çl£
)

79 , 
m_šAutosüŞl
(
çl£
)

80 , 
m_İtiÚsWidth
(0)

81 , 
m_šdexOff£t
(0)

85 
	gR’d”Li¡Box
::~
R’d”Li¡Box
()

87 
£tHasV”tiÿlSüŞlb¬
(
çl£
);

90 
	gR’d”Li¡Box
::
¡yËDidChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
)

92 
	gR’d”Block
::
¡yËDidChªge
(
diff
, 
ŞdStyË
);

93 
£tR•Ïûd
(
isIÆše
());

96 
	gR’d”Li¡Box
::
upd©eFromEËm’t
()

98 ià(
m_İtiÚsChªged
) {

99 cÚ¡ 
VeùÜ
<
EËm’t
*>& 
li¡I‹ms
 = 
toS–eùEËm’t
(
¡©ic_ÿ¡
<EËm’t*>(
node
()))->listItems();

100 
	gsize
 = 
numI‹ms
();

102 
	gwidth
 = 0;

103 
	gi
 = 0; i < 
	gsize
; ++i) {

104 
EËm’t
* 
	g–em’t
 = 
li¡I‹ms
[
i
];

105 
SŒšg
 
	g‹xt
;

106 
FÚt
 
	g™emFÚt
 = 
¡yË
()->
fÚt
();

107 ià(
O±iÚEËm’t
* 
	gİtiÚEËm’t
 = 
toO±iÚEËm’t
(
–em’t
))

108 
‹xt
 = 
İtiÚEËm’t
->
‹xtInd’‹dToRe¥eùGroupLab–
();

109 ià(
O±iÚGroupEËm’t
* 
	gİtiÚGroupEËm’t
 = 
toO±iÚGroupEËm’t
(
–em’t
)) {

110 
‹xt
 = 
İtiÚGroupEËm’t
->
groupLab–Text
();

111 
FÚtDesütiÚ
 
	gd
 = 
™emFÚt
.
fÚtDesütiÚ
();

112 
	gd
.
£tWeight
(
d
.
bŞd”Weight
());

113 
	g™emFÚt
 = 
FÚt
(
d
, 
™emFÚt
.
Ë‰”S·cšg
(), i‹mFÚt.
wÜdS·cšg
());

114 
	g™emFÚt
.
upd©e
(
docum’t
()->
¡yËS–eùÜ
()->
fÚtS–eùÜ
());

117 ià(!
	g‹xt
.
isEm±y
()) {

118 
	g‹xtWidth
 = 
™emFÚt
.
æßtWidth
(
TextRun
(
‹xt
.
im¶
(), 0, 0, 0, 
çl£
, false, false, false));

119 
	gwidth
 = 
max
(
width
, 
‹xtWidth
);

122 
	gm_İtiÚsWidth
 = 
¡©ic_ÿ¡
<>(
ûf
(
width
));

123 
	gm_İtiÚsChªged
 = 
çl£
;

125 
£tHasV”tiÿlSüŞlb¬
(
Œue
);

127 
£tN“dsLayoutAndP»fWidthsReÿlc
();

131 
	gR’d”Li¡Box
::
£ËùiÚChªged
()

133 
»·št
();

134 ià(!
	gm_šAutosüŞl
) {

135 ià(
	gm_İtiÚsChªged
 || 
ÃedsLayout
())

136 
	gm_süŞlToRev—lS–eùiÚAá”Layout
 = 
Œue
;

138 
süŞlToRev—lS–eùiÚ
();

141 ià(
	gAXObjeùCache
::
acûssib™yEÇbËd
())

142 
docum’t
()->
axObjeùCache
()->
£ËùedChd»nChªged
(
this
);

145 
	gR’d”Li¡Box
::
Ïyout
()

147 
R’d”Block
::
Ïyout
();

148 ià(
	gm_süŞlToRev—lS–eùiÚAá”Layout
)

149 
süŞlToRev—lS–eùiÚ
();

152 
	gR’d”Li¡Box
::
süŞlToRev—lS–eùiÚ
()

154 
S–eùEËm’t
* 
£Ëù
 = 
toS–eùEËm’t
(
¡©ic_ÿ¡
<
EËm’t
*>(
node
()));

156 
	gm_süŞlToRev—lS–eùiÚAá”Layout
 = 
çl£
;

158 
	gfœ¡Index
 = 
£Ëù
->
aùiveS–eùiÚS¹Li¡Index
();

159 ià(
	gfœ¡Index
 >ğ0 && !
li¡IndexIsVisibË
(
£Ëù
->
aùiveS–eùiÚEndLi¡Index
()))

160 
süŞlToRev—lEËm’tAtLi¡Index
(
fœ¡Index
);

163 
	gR’d”Li¡Box
::
ÿlcP»fWidths
()

165 
ASSERT
(!
m_İtiÚsChªged
);

167 
	gm_mšP»fWidth
 = 0;

168 
	gm_maxP»fWidth
 = 0;

170 ià(
¡yË
()->
width
().
isFixed
(è&& styË()->width().
v®ue
() > 0)

171 
	gm_mšP»fWidth
 = 
m_maxP»fWidth
 = 
ÿlcCÚ‹ÁBoxWidth
(
¡yË
()->
width
().
v®ue
());

173 
	gm_maxP»fWidth
 = 
m_İtiÚsWidth
 + 2 * 
İtiÚsS·cšgHÜizÚl
;

174 ià(
	gm_vB¬
)

175 
	gm_maxP»fWidth
 +ğ
m_vB¬
->
width
();

178 ià(
¡yË
()->
mšWidth
().
isFixed
(è&& styË()->mšWidth().
v®ue
() > 0) {

179 
	gm_maxP»fWidth
 = 
max
(
m_maxP»fWidth
, 
ÿlcCÚ‹ÁBoxWidth
(
¡yË
()->
mšWidth
().
v®ue
()));

180 
	gm_mšP»fWidth
 = 
max
(
m_mšP»fWidth
, 
ÿlcCÚ‹ÁBoxWidth
(
¡yË
()->
mšWidth
().
v®ue
()));

181 } ià(
¡yË
()->
width
().
isP”ûÁ
(è|| (¡yË()->width().
isAuto
(è&& styË()->
height
().isPercent()))

182 
	gm_mšP»fWidth
 = 0;

184 
	gm_mšP»fWidth
 = 
m_maxP»fWidth
;

186 ià(
¡yË
()->
maxWidth
().
isFixed
(è&& styË()->maxWidth().
v®ue
(è!ğ
undefšedL’gth
) {

187 
m_maxP»fWidth
 = 
mš
(m_maxP»fWidth, 
ÿlcCÚ‹ÁBoxWidth
(
¡yË
()->
maxWidth
().
v®ue
()));

188 
	gm_mšP»fWidth
 = 
mš
(
m_mšP»fWidth
, 
ÿlcCÚ‹ÁBoxWidth
(
¡yË
()->
maxWidth
().
v®ue
()));

191 
	gtoAdd
 = 
·ddšgLeá
(è+ 
·ddšgRight
(è+ 
bÜd”Leá
(è+ 
bÜd”Right
();

192 
	gm_mšP»fWidth
 +ğ
toAdd
;

193 
	gm_maxP»fWidth
 +ğ
toAdd
;

195 
£tP»fWidthsDœty
(
çl£
);

198 
	gR’d”Li¡Box
::
size
() const

200 
¥ecif›dSize
 = 
toS–eùEËm’t
(
¡©ic_ÿ¡
<
EËm’t
*>(
node
()))->
size
();

201 ià(
	g¥ecif›dSize
 > 1)

202  
max
(
mšSize
, 
¥ecif›dSize
);

203  
mš
(
max
(
mšSize
, 
numI‹ms
()), 
maxDeçuÉSize
);

206 
	gR’d”Li¡Box
::
numVisibËI‹ms
() const

209  
max
(1, (
cÚ‹ÁHeight
(è+ 
rowS·cšg
è/ 
™emHeight
());

212 
	gR’d”Li¡Box
::
numI‹ms
() const

214  
toS–eùEËm’t
(
¡©ic_ÿ¡
<
EËm’t
*>(
node
()))->
li¡I‹ms
().
size
();

217 
	gR’d”Li¡Box
::
li¡Height
() const

219  
™emHeight
(è* 
numI‹ms
(è- 
rowS·cšg
;

222 
	gR’d”Li¡Box
::
ÿlcHeight
()

224 
toAdd
 = 
·ddšgTİ
(è+ 
·ddšgBÙtom
(è+ 
bÜd”Tİ
(è+ 
bÜd”BÙtom
();

226 
	g™emHeight
 = 
R’d”Li¡Box
::
™emHeight
();

227 
£tHeight
(
™emHeight
 * 
size
(è- 
rowS·cšg
 + 
toAdd
);

229 
	gR’d”Block
::
ÿlcHeight
();

231 ià(
	gm_vB¬
) {

232 
boŞ
 
	g’abËd
 = 
numVisibËI‹ms
(è< 
numI‹ms
();

233 
	gm_vB¬
->
£tEÇbËd
(
’abËd
);

234 
	gm_vB¬
->
£tS‹ps
(1, 
mš
(1, 
numVisibËI‹ms
(è- 1), 
™emHeight
);

235 
	gm_vB¬
->
£tPrİÜtiÚ
(
numVisibËI‹ms
(), 
numI‹ms
());

236 ià(!
	g’abËd
)

237 
	gm_šdexOff£t
 = 0;

241 
	gR’d”Li¡Box
::
ba£lšePos™iÚ
(
boŞ
, bool) const

243  
height
(è+ 
m¬gšTİ
(è+ 
m¬gšBÙtom
(è- 
	gba£lšeAdju¡m’t
;

246 
IÁReù
 
	gR’d”Li¡Box
::
™emBoundšgBoxReù
(
tx
, 
ty
, 
šdex
)

248  
IÁReù
(
tx
 + 
bÜd”Leá
(è+ 
·ddšgLeá
(),

249 
ty
 + 
bÜd”Tİ
(è+ 
·ddšgTİ
(è+ 
™emHeight
(è* (
šdex
 - 
m_šdexOff£t
),

250 
cÚ‹ÁWidth
(), 
™emHeight
());

253 
	gR’d”Li¡Box
::
·štObjeù
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

255 ià(
¡yË
()->
visib™y
(è!ğ
VISIBLE
)

258 
	gli¡I‹msSize
 = 
numI‹ms
();

260 ià(
	g·štInfo
.
	gpha£
 =ğ
PaštPha£FÜeground
) {

261 
šdex
 = 
m_šdexOff£t
;

262 
	gšdex
 < 
	gli¡I‹msSize
 && index <ğ
m_šdexOff£t
 + 
numVisibËI‹ms
()) {

263 
·štI‹mFÜeground
(
·štInfo
, 
tx
, 
ty
, 
šdex
);

264 
	gšdex
++;

269 
	gR’d”Block
::
·štObjeù
(
·štInfo
, 
tx
, 
ty
);

271 ià(
	g·štInfo
.
	gpha£
 =ğ
PaštPha£BlockBackground
)

272 
·štSüŞlb¬
(
·štInfo
, 
tx
, 
ty
);

273 ià(
	g·štInfo
.
	gpha£
 =ğ
PaštPha£ChdBlockBackground
 || 
·štInfo
.
pha£
 =ğ
PaštPha£ChdBlockBackgrounds
) {

274 
šdex
 = 
m_šdexOff£t
;

275 
	gšdex
 < 
	gli¡I‹msSize
 && index <ğ
m_šdexOff£t
 + 
numVisibËI‹ms
()) {

276 
·štI‹mBackground
(
·štInfo
, 
tx
, 
ty
, 
šdex
);

277 
	gšdex
++;

282 
	gR’d”Li¡Box
::
·štSüŞlb¬
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

284 ià(
	gm_vB¬
) {

285 
IÁReù
 
süŞlReù
(
tx
 + 
width
(è- 
bÜd”Right
(è- 
m_vB¬
->width(),

286 
ty
 + 
bÜd”Tİ
(),

287 
m_vB¬
->
width
(),

288 
height
(è- (
bÜd”Tİ
(è+ 
bÜd”BÙtom
()));

289 
	gm_vB¬
->
£tF¿meReù
(
süŞlReù
);

290 
	gm_vB¬
->
·št
(
·štInfo
.
cÚ‹xt
,…aštInfo.
»ù
);

294 
	gR’d”Li¡Box
::
·štI‹mFÜeground
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
, 
li¡Index
)

296 
S–eùEËm’t
* 
	g£Ëù
 = 
toS–eùEËm’t
(
¡©ic_ÿ¡
<
EËm’t
*>(
node
()));

297 cÚ¡ 
	gVeùÜ
<
	gEËm’t
*>& 
	gli¡I‹ms
 = 
£Ëù
->
li¡I‹ms
();

298 
EËm’t
* 
	g–em’t
 = 
li¡I‹ms
[
li¡Index
];

299 
O±iÚEËm’t
* 
	gİtiÚEËm’t
 = 
toO±iÚEËm’t
(
–em’t
);

301 
SŒšg
 
	g™emText
;

302 ià(
	gİtiÚEËm’t
)

303 
	g™emText
 = 
İtiÚEËm’t
->
‹xtInd’‹dToRe¥eùGroupLab–
();

304 ià(
O±iÚGroupEËm’t
* 
	gİtiÚGroupEËm’t
 = 
toO±iÚGroupEËm’t
(
–em’t
))

305 
™emText
 = 
İtiÚGroupEËm’t
->
groupLab–Text
();

308 
IÁReù
 
	gr
 = 
™emBoundšgBoxReù
(
tx
, 
ty
, 
li¡Index
);

309 
	gr
.
move
(
İtiÚsS·cšgHÜizÚl
, 
¡yË
()->
fÚt
().
asûÁ
());

311 
R’d”StyË
* 
	g™emStyË
 = 
–em’t
->
»nd”StyË
();

312 ià(!
	g™emStyË
)

313 
	g™emStyË
 = 
¡yË
();

315 
CŞÜ
 
	g‹xtCŞÜ
 = 
–em’t
->
»nd”StyË
(è?ƒËm’t->»nd”StyË()->
cŞÜ
(è: 
¡yË
()->color();

316 ià(
	gİtiÚEËm’t
 && o±iÚEËm’t->
£Ëùed
()) {

317 ià(
docum’t
()->
äame
()->
£ËùiÚ
()->
isFocu£dAndAùive
(è&& docum’t()->
focu£dNode
(è=ğ
node
())

318 
‹xtCŞÜ
 = 
theme
()->
aùiveLi¡BoxS–eùiÚFÜegroundCŞÜ
();

320 ià(!
	g–em’t
->
di§bËd
())

321 
	g‹xtCŞÜ
 = 
theme
()->
šaùiveLi¡BoxS–eùiÚFÜegroundCŞÜ
();

324 
CŞÜS·û
 
	gcŞÜS·û
 = 
™emStyË
->
cŞÜS·û
();

325 
	g·štInfo
.
	gcÚ‹xt
->
£tFlCŞÜ
(
‹xtCŞÜ
, 
cŞÜS·û
);

327 
FÚt
 
	g™emFÚt
 = 
¡yË
()->
fÚt
();

328 ià(
isO±iÚGroupEËm’t
(
–em’t
)) {

329 
FÚtDesütiÚ
 
	gd
 = 
™emFÚt
.
fÚtDesütiÚ
();

330 
	gd
.
£tWeight
(
d
.
bŞd”Weight
());

331 
	g™emFÚt
 = 
FÚt
(
d
, 
™emFÚt
.
Ë‰”S·cšg
(), i‹mFÚt.
wÜdS·cšg
());

332 
	g™emFÚt
.
upd©e
(
docum’t
()->
¡yËS–eùÜ
()->
fÚtS–eùÜ
());

335 
	gËngth
 = 
™emText
.
Ëngth
();

336 cÚ¡ 
UCh¬
* 
	g¡ršg
 = 
™emText
.
ch¬aù”s
();

337 
TextRun
 
‹xtRun
(
¡ršg
, 
Ëngth
, 0, 0, 0, 
™emStyË
->
dœeùiÚ
(è=ğ
RTL
, i‹mStyË->
unicodeBidi
(è=ğ
Ov”ride
, 
çl£
, false);

340 ià(
	g™emStyË
->
visib™y
(è!ğ
HIDDEN
)

341 
·štInfo
.
cÚ‹xt
->
d¿wBidiText
(
™emFÚt
, 
‹xtRun
, 
r
.
loÿtiÚ
());

344 
	gR’d”Li¡Box
::
·štI‹mBackground
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
, 
li¡Index
)

346 
S–eùEËm’t
* 
	g£Ëù
 = 
toS–eùEËm’t
(
¡©ic_ÿ¡
<
EËm’t
*>(
node
()));

347 cÚ¡ 
	gVeùÜ
<
	gEËm’t
*>& 
	gli¡I‹ms
 = 
£Ëù
->
li¡I‹ms
();

348 
EËm’t
* 
	g–em’t
 = 
li¡I‹ms
[
li¡Index
];

349 
O±iÚEËm’t
* 
	gİtiÚEËm’t
 = 
toO±iÚEËm’t
(
–em’t
);

351 
CŞÜ
 
	gbackCŞÜ
;

352 ià(
	gİtiÚEËm’t
 && o±iÚEËm’t->
£Ëùed
()) {

353 ià(
docum’t
()->
äame
()->
£ËùiÚ
()->
isFocu£dAndAùive
(è&& docum’t()->
focu£dNode
(è=ğ
node
())

354 
backCŞÜ
 = 
theme
()->
aùiveLi¡BoxS–eùiÚBackgroundCŞÜ
();

356 
	gbackCŞÜ
 = 
theme
()->
šaùiveLi¡BoxS–eùiÚBackgroundCŞÜ
();

358 
	gbackCŞÜ
 = 
–em’t
->
»nd”StyË
(è?ƒËm’t->»nd”StyË()->
backgroundCŞÜ
(è: 
¡yË
()->backgroundColor();

361 ià(!
	g–em’t
->
»nd”StyË
(è||ƒËm’t->»nd”StyË()->
visib™y
(è!ğ
HIDDEN
) {

362 
CŞÜS·û
 
cŞÜS·û
 = 
–em’t
->
»nd”StyË
(è?ƒËm’t->»nd”StyË()->cŞÜS·û(è: 
¡yË
()->colorSpace();

363 
IÁReù
 
	g™emReù
 = 
™emBoundšgBoxReù
(
tx
, 
ty
, 
li¡Index
);

364 
	g™emReù
.
š‹r£ù
(
cÚŒŞClReù
(
tx
, 
ty
));

365 
	g·štInfo
.
	gcÚ‹xt
->
flReù
(
™emReù
, 
backCŞÜ
, 
cŞÜS·û
);

369 
boŞ
 
	gR’d”Li¡Box
::
isPoštInOv”æowCÚŒŞ
(
H™Te¡ResuÉ
& 
»suÉ
, 
_x
, 
_y
, 
_tx
, 
_ty
)

371 ià(!
	gm_vB¬
)

372  
	gçl£
;

374 
IÁReù
 
v”tReù
(
_tx
 + 
width
(è- 
bÜd”Right
(è- 
m_vB¬
->width(),

375 
_ty
 + 
bÜd”Tİ
(),

376 
m_vB¬
->
width
(),

377 
height
(è- 
bÜd”Tİ
(è- 
bÜd”BÙtom
());

379 ià(
	gv”tReù
.
cÚšs
(
_x
, 
_y
)) {

380 
	g»suÉ
.
£tSüŞlb¬
(
m_vB¬
.
g‘
());

381  
	gŒue
;

383  
	gçl£
;

386 
	gR’d”Li¡Box
::
li¡IndexAtOff£t
(
off£tX
, 
off£tY
)

388 ià(!
numI‹ms
())

391 ià(
	goff£tY
 < 
bÜd”Tİ
(è+ 
·ddšgTİ
(è|| off£tY > 
height
(è- 
·ddšgBÙtom
(è- 
bÜd”BÙtom
())

394 
	gsüŞlb¬Width
 = 
m_vB¬
 ? m_vB¬->
width
() : 0;

395 ià(
	goff£tX
 < 
bÜd”Leá
(è+ 
·ddšgLeá
(è|| off£tX > 
width
(è- 
bÜd”Right
(è- 
·ddšgRight
(è- 
	gsüŞlb¬Width
)

398 
	gÃwOff£t
 = (
off£tY
 - 
bÜd”Tİ
(è- 
·ddšgTİ
()è/ 
™emHeight
(è+ 
m_šdexOff£t
;

399  
	gÃwOff£t
 < 
numI‹ms
() ?‚ewOffset : -1;

402 
	gR’d”Li¡Box
::
·nSüŞl
(cÚ¡ 
IÁPošt
& 
·nS¹Mou£Pos™iÚ
)

404 cÚ¡ 
maxS³ed
 = 20;

405 cÚ¡ 
	gicÚRadius
 = 7;

406 cÚ¡ 
	g¥“dReduûr
 = 4;

409 
FlßtPošt
 
	gabsOff£t
 = 
loÿlToAbsŞu‹
();

411 
IÁPošt
 
	gcu¼’tMou£Pos™iÚ
 = 
docum’t
()->
äame
()->
ev’tHªdËr
()->
cu¼’tMou£Pos™iÚ
();

413 
IÁPošt
 
	g´eviousMou£Pos™iÚ
;

414 ià(
	gcu¼’tMou£Pos™iÚ
.
y
() < 0)

415 
	gcu¼’tMou£Pos™iÚ
 = 
´eviousMou£Pos™iÚ
;

417 
	g´eviousMou£Pos™iÚ
 = 
cu¼’tMou£Pos™iÚ
;

419 
	gyD–
 = 
cu¼’tMou£Pos™iÚ
.
y
(è- 
·nS¹Mou£Pos™iÚ
.y();

422 
	gyD–
 = 
max
(
mš
(
yD–
, 
maxS³ed
), -maxSpeed);

424 ià(
abs
(
yD–
è< 
	gicÚRadius
)

427 ià(
	gyD–
 > 0)

429 
	gabsOff£t
.
move
(0, 
li¡Height
());

430 ià(
	gyD–
 < 0)

431 
	gyD–
--;

434 
	gyD–
 /ğ
¥“dReduûr
;

436 
IÁPošt
 
süŞlPošt
(0, 0);

437 
	gsüŞlPošt
.
£tY
(
absOff£t
.
y
(è+ 
yD–
);

438 
	gÃwOff£t
 = 
süŞlTow¬d
(
süŞlPošt
);

439 ià(
	gÃwOff£t
 < 0)

442 
	gm_šAutosüŞl
 = 
Œue
;

443 
S–eùEËm’t
* 
	g£Ëù
 = 
toS–eùEËm’t
(
¡©ic_ÿ¡
<
EËm’t
*>(
node
()));

444 
	g£Ëù
->
upd©eLi¡BoxS–eùiÚ
(!
£Ëù
->
muÉË
());

445 
	gm_šAutosüŞl
 = 
çl£
;

448 
	gR’d”Li¡Box
::
süŞlTow¬d
(cÚ¡ 
IÁPošt
& 
de¡š©iÚ
)

451 
FlßtPošt
 
absPos
 = 
loÿlToAbsŞu‹
();

452 
	goff£tX
 = 
de¡š©iÚ
.
x
(è- 
absPos
.x();

453 
	goff£tY
 = 
de¡š©iÚ
.
y
(è- 
absPos
.y();

455 
	grows
 = 
numVisibËI‹ms
();

456 
	goff£t
 = 
m_šdexOff£t
;

458 ià(
	goff£tY
 < 
bÜd”Tİ
(è+ 
·ddšgTİ
(è&& 
süŞlToRev—lEËm’tAtLi¡Index
(
off£t
 - 1))

459  
	goff£t
 - 1;

461 ià(
	goff£tY
 > 
height
(è- 
·ddšgBÙtom
(è- 
bÜd”BÙtom
(è&& 
süŞlToRev—lEËm’tAtLi¡Index
(
off£t
 + 
rows
))

462  
	goff£t
 + 
	grows
 - 1;

464  
li¡IndexAtOff£t
(
off£tX
, 
off£tY
);

467 
	gR’d”Li¡Box
::
autosüŞl
()

469 
IÁPošt
 
pos
 = 
docum’t
()->
äame
()->
v›w
()->
wšdowToCÚ‹Ás
(docum’t()->äame()->
ev’tHªdËr
()->
cu¼’tMou£Pos™iÚ
());

471 
	g’dIndex
 = 
süŞlTow¬d
(
pos
);

472 ià(
	g’dIndex
 >= 0) {

473 
S–eùEËm’t
* 
£Ëù
 = 
toS–eùEËm’t
(
¡©ic_ÿ¡
<
EËm’t
*>(
node
()));

474 
	gm_šAutosüŞl
 = 
Œue
;

476 ià(!
	g£Ëù
->
muÉË
())

477 
	g£Ëù
->
£tAùiveS–eùiÚAnchÜIndex
(
’dIndex
);

479 
	g£Ëù
->
£tAùiveS–eùiÚEndIndex
(
’dIndex
);

480 
	g£Ëù
->
upd©eLi¡BoxS–eùiÚ
(!
£Ëù
->
muÉË
());

481 
	gm_šAutosüŞl
 = 
çl£
;

485 
	gR’d”Li¡Box
::
¡İAutosüŞl
()

487 
toS–eùEËm’t
(
¡©ic_ÿ¡
<
EËm’t
*>(
node
()))->
li¡BoxOnChªge
();

490 
boŞ
 
	gR’d”Li¡Box
::
süŞlToRev—lEËm’tAtLi¡Index
(
šdex
)

492 ià(
šdex
 < 0 || index >ğ
numI‹ms
(è|| 
li¡IndexIsVisibË
(index))

493  
çl£
;

495 
	gÃwOff£t
;

496 ià(
	gšdex
 < 
	gm_šdexOff£t
)

497 
	gÃwOff£t
 = 
šdex
;

499 
	gÃwOff£t
 = 
šdex
 - 
numVisibËI‹ms
() + 1;

501 
	gm_šdexOff£t
 = 
ÃwOff£t
;

502 ià(
	gm_vB¬
)

503 
	gm_vB¬
->
£tV®ue
(
m_šdexOff£t
);

505  
	gŒue
;

508 
boŞ
 
	gR’d”Li¡Box
::
li¡IndexIsVisibË
(
šdex
)

510  
šdex
 >ğ
m_šdexOff£t
 && index < m_šdexOff£ˆ+ 
numVisibËI‹ms
();

513 
boŞ
 
	gR’d”Li¡Box
::
süŞl
(
SüŞlDœeùiÚ
 
dœeùiÚ
, 
SüŞlG¿nuÏr™y
 
g¿nuÏr™y
, 
muÉl›r
, 
Node
**)

515  
	gm_vB¬
 && m_vB¬->
süŞl
(
dœeùiÚ
, 
g¿nuÏr™y
, 
muÉl›r
);

518 
	gR’d”Li¡Box
::
v®ueChªged
(
li¡Index
)

520 
EËm’t
* 
–em’t
 = 
¡©ic_ÿ¡
<EËm’t*>(
node
());

521 
S–eùEËm’t
* 
	g£Ëù
 = 
toS–eùEËm’t
(
–em’t
);

522 
	g£Ëù
->
£tS–eùedIndex
(
£Ëù
->
li¡ToO±iÚIndex
(
li¡Index
));

523 
	g–em’t
->
di¥©chFÜmCÚŒŞChªgeEv’t
();

526 
	gR’d”Li¡Box
::
v®ueChªged
(
SüŞlb¬
*)

528 
ÃwOff£t
 = 
m_vB¬
->
v®ue
();

529 ià(
	gÃwOff£t
 !ğ
m_šdexOff£t
) {

530 
m_šdexOff£t
 = 
ÃwOff£t
;

531 
»·št
();

532 
node
()->
di¥©chEv’t
(
Ev’t
::
ü—‹
(
ev’tNames
().
süŞlEv’t
, 
çl£
, false));

536 
	gR’d”Li¡Box
::
™emHeight
() const

538  
¡yË
()->
fÚt
().
height
(è+ 
rowS·cšg
;

541 
	gR’d”Li¡Box
::
v”tiÿlSüŞlb¬Width
() const

543  
m_vB¬
 ? m_vB¬->
width
() : 0;

548 
	gR’d”Li¡Box
::
süŞlWidth
() const

551  
ş›ÁWidth
();

554 
	gR’d”Li¡Box
::
süŞlHeight
() const

556  
max
(
ş›ÁHeight
(), 
li¡Height
());

559 
	gR’d”Li¡Box
::
süŞlLeá
() const

564 
	gR’d”Li¡Box
::
£tSüŞlLeá
()

568 
R’d”Li¡Box
::
süŞlTİ
() const

570  
m_šdexOff£t
 * 
™emHeight
();

573 
	gR’d”Li¡Box
::
£tSüŞlTİ
(
ÃwTİ
)

576 
šdex
 = 
ÃwTİ
 / 
™emHeight
();

577 ià(
	gšdex
 < 0 || index >ğ
numI‹ms
(è|| 
šdex
 =ğ
m_šdexOff£t
)

579 
	gm_šdexOff£t
 = 
šdex
;

580 ià(
	gm_vB¬
)

581 
	gm_vB¬
->
£tV®ue
(
šdex
);

584 
boŞ
 
	gR’d”Li¡Box
::
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
& 
»que¡
, 
H™Te¡ResuÉ
& 
»suÉ
, 
x
, 
y
, 
tx
, 
ty
, 
H™Te¡AùiÚ
 
h™Te¡AùiÚ
)

586 ià(!
	gR’d”Block
::
nodeAtPošt
(
»que¡
, 
»suÉ
, 
x
, 
y
, 
tx
, 
ty
, 
h™Te¡AùiÚ
))

587  
	gçl£
;

588 cÚ¡ 
	gVeùÜ
<
	gEËm’t
*>& 
	gli¡I‹ms
 = 
toS–eùEËm’t
(
¡©ic_ÿ¡
<
EËm’t
*>(
node
()))->
li¡I‹ms
();

589 
	gsize
 = 
numI‹ms
();

590 
	gtx
 +ğ
this
->
x
();

591 
	gty
 +ğ
this
->
y
();

592 
	gi
 = 0; i < 
	gsize
; ++i) {

593 ià(
™emBoundšgBoxReù
(
tx
, 
ty
, 
i
).
cÚšs
(
x
, 
y
)) {

594 ià(
EËm’t
* 
	gnode
 = 
li¡I‹ms
[
i
]) {

595 
»suÉ
.
£tIÂ”Node
(
node
);

596 ià(!
	g»suÉ
.
šÃrNÚSh¬edNode
())

597 
	g»suÉ
.
£tIÂ”NÚSh¬edNode
(
node
);

598 
	g»suÉ
.
£tLoÿlPošt
(
IÁPošt
(
x
 - 
tx
, 
y
 - 
ty
));

604  
	gŒue
;

607 
IÁReù
 
	gR’d”Li¡Box
::
cÚŒŞClReù
(
tx
, 
ty
) const

609 
IÁReù
 
	gşReù
 = 
cÚ‹ÁBoxReù
();

610 
	gşReù
.
move
(
tx
, 
ty
);

611  
	gşReù
;

614 
boŞ
 
	gR’d”Li¡Box
::
isAùive
() const

616 
Page
* 
·ge
 = 
docum’t
()->
äame
()->page();

617  
	g·ge
 &&…age->
focusCÚŒŞËr
()->
isAùive
();

620 
	gR’d”Li¡Box
::
šv®id©eSüŞlb¬Reù
(
SüŞlb¬
* 
süŞlb¬
, cÚ¡ 
IÁReù
& 
»ù
)

622 
IÁReù
 
	gsüŞlReù
 = 
»ù
;

623 
	gsüŞlReù
.
move
(
width
(è- 
bÜd”Right
(è- 
süŞlb¬
->width(), 
bÜd”Tİ
());

624 
»·štReùªgË
(
süŞlReù
);

627 
IÁReù
 
	gR’d”Li¡Box
::
cÚv”tFromSüŞlb¬ToCÚššgV›w
(cÚ¡ 
SüŞlb¬
* 
süŞlb¬
, cÚ¡ IÁReù& 
süŞlb¬Reù
) const

629 
R’d”V›w
* 
	gv›w
 = 
this
->
v›w
();

630 ià(!
	gv›w
)

631  
	gsüŞlb¬Reù
;

633 
IÁReù
 
	g»ù
 = 
süŞlb¬Reù
;

635 
	gsüŞlb¬Leá
 = 
width
(è- 
bÜd”Right
(è- 
süŞlb¬
->width();

636 
	gsüŞlb¬Tİ
 = 
bÜd”Tİ
();

637 
	g»ù
.
move
(
süŞlb¬Leá
, 
süŞlb¬Tİ
);

639  
	gv›w
->
äameV›w
()->
cÚv”tFromR’d””
(
this
, 
»ù
);

642 
IÁReù
 
	gR’d”Li¡Box
::
cÚv”tFromCÚššgV›wToSüŞlb¬
(cÚ¡ 
SüŞlb¬
* 
süŞlb¬
, cÚ¡ IÁReù& 
·»ÁReù
) const

644 
R’d”V›w
* 
	gv›w
 = 
this
->
v›w
();

645 ià(!
	gv›w
)

646  
	g·»ÁReù
;

648 
IÁReù
 
	g»ù
 = 
v›w
->
äameV›w
()->
cÚv”tToR’d””
(
this
, 
·»ÁReù
);

650 
	gsüŞlb¬Leá
 = 
width
(è- 
bÜd”Right
(è- 
süŞlb¬
->width();

651 
	gsüŞlb¬Tİ
 = 
bÜd”Tİ
();

652 
	g»ù
.
move
(-
süŞlb¬Leá
, -
süŞlb¬Tİ
);

653  
	g»ù
;

656 
IÁPošt
 
	gR’d”Li¡Box
::
cÚv”tFromSüŞlb¬ToCÚššgV›w
(cÚ¡ 
SüŞlb¬
* 
süŞlb¬
, cÚ¡ IÁPošt& 
süŞlb¬Pošt
) const

658 
R’d”V›w
* 
	gv›w
 = 
this
->
v›w
();

659 ià(!
	gv›w
)

660  
	gsüŞlb¬Pošt
;

662 
IÁPošt
 
	gpošt
 = 
süŞlb¬Pošt
;

664 
	gsüŞlb¬Leá
 = 
width
(è- 
bÜd”Right
(è- 
süŞlb¬
->width();

665 
	gsüŞlb¬Tİ
 = 
bÜd”Tİ
();

666 
	gpošt
.
move
(
süŞlb¬Leá
, 
süŞlb¬Tİ
);

668  
	gv›w
->
äameV›w
()->
cÚv”tFromR’d””
(
this
, 
pošt
);

671 
IÁPošt
 
	gR’d”Li¡Box
::
cÚv”tFromCÚššgV›wToSüŞlb¬
(cÚ¡ 
SüŞlb¬
* 
süŞlb¬
, cÚ¡ IÁPošt& 
·»ÁPošt
) const

673 
R’d”V›w
* 
	gv›w
 = 
this
->
v›w
();

674 ià(!
	gv›w
)

675  
	g·»ÁPošt
;

677 
IÁPošt
 
	gpošt
 = 
v›w
->
äameV›w
()->
cÚv”tToR’d””
(
this
, 
·»ÁPošt
);

679 
	gsüŞlb¬Leá
 = 
width
(è- 
bÜd”Right
(è- 
süŞlb¬
->width();

680 
	gsüŞlb¬Tİ
 = 
bÜd”Tİ
();

681 
	gpošt
.
move
(-
süŞlb¬Leá
, -
süŞlb¬Tİ
);

682  
	gpošt
;

685 
	gPassRefPŒ
<
	gSüŞlb¬
> 
	gR’d”Li¡Box
::
ü—‹SüŞlb¬
()

687 
RefPŒ
<
SüŞlb¬
> 
widg‘
;

688 
boŞ
 
	ghasCu¡omSüŞlb¬StyË
 = 
¡yË
()->
hasP£udoStyË
(
SCROLLBAR
);

689 ià(
	ghasCu¡omSüŞlb¬StyË
)

690 
	gwidg‘
 = 
R’d”SüŞlb¬
::
ü—‹Cu¡omSüŞlb¬
(
this
, 
V”tiÿlSüŞlb¬
,his);

692 
	gwidg‘
 = 
SüŞlb¬
::
ü—‹N©iveSüŞlb¬
(
this
, 
V”tiÿlSüŞlb¬
, 
theme
()->
süŞlb¬CÚŒŞSizeFÜP¬t
(
Li¡boxP¬t
));

693 
docum’t
()->
v›w
()->
addChd
(
widg‘
.
g‘
());

694  
	gwidg‘
.
»Ëa£
();

697 
	gR’d”Li¡Box
::
de¡roySüŞlb¬
()

699 ià(!
m_vB¬
)

702 
	gm_vB¬
->
»moveFromP¬’t
();

703 
	gm_vB¬
->
£tCl›Á
(0);

704 
	gm_vB¬
 = 0;

707 
	gR’d”Li¡Box
::
£tHasV”tiÿlSüŞlb¬
(
boŞ
 
hasSüŞlb¬
)

709 ià(
hasSüŞlb¬
 =ğ(
m_vB¬
 != 0))

712 ià(
	ghasSüŞlb¬
)

713 
	gm_vB¬
 = 
ü—‹SüŞlb¬
();

715 
de¡roySüŞlb¬
();

717 ià(
	gm_vB¬
)

718 
	gm_vB¬
->
¡yËChªged
();

720 #ià
ENABLE
(
DASHBOARD_SUPPORT
)

722 ià(
docum’t
()->
hasDashbßrdRegiÚs
())

723 
docum’t
()->
£tDashbßrdRegiÚsDœty
(
Œue
);

	@RenderListBox.h

31 #iâdeà
R’d”Li¡Box_h


32 
	#R’d”Li¡Box_h


	)

34 
	~"R’d”Block.h
"

35 
	~"SüŞlb¬Cl›Á.h
"

37 
Çme¥aû
 
	gWebCÜe
 {

39 
şass
 
	gR’d”Li¡Box
 : 
public
 
R’d”Block
, 
´iv©e
 
	gSüŞlb¬Cl›Á
 {

40 
	gpublic
:

41 
R’d”Li¡Box
(
EËm’t
*);

42 
	gvœtu®
 ~
R’d”Li¡Box
();

44 
£ËùiÚChªged
();

46 
£tO±iÚsChªged
(
boŞ
 
chªged
è{ 
	gm_İtiÚsChªged
 = changed; }

48 
li¡IndexAtOff£t
(
x
, 
y
);

49 
IÁReù
 
™emBoundšgBoxReù
(
tx
, 
ty
, 
šdex
);

51 
boŞ
 
süŞlToRev—lEËm’tAtLi¡Index
(
šdex
);

52 
boŞ
 
li¡IndexIsVisibË
(
šdex
);

54 
süŞlTow¬d
(cÚ¡ 
IÁPošt
&);

56 
	g´iv©e
:

57 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderListBox"; }

59 
vœtu®
 
boŞ
 
isLi¡Box
(ècÚ¡ {  
	gŒue
; }

61 
vœtu®
 
upd©eFromEËm’t
();

63 
vœtu®
 
boŞ
 
ÿnHaveChd»n
(ècÚ¡ {  
	gçl£
; }

65 
vœtu®
 
boŞ
 
hasCÚŒŞCl
(ècÚ¡ {  
	gŒue
; }

66 
vœtu®
 
·štObjeù
(
PaštInfo
&, 
tx
, 
ty
);

67 
vœtu®
 
IÁReù
 
cÚŒŞClReù
(
tx
, 
ty
) const;

69 
vœtu®
 
boŞ
 
isPoštInOv”æowCÚŒŞ
(
H™Te¡ResuÉ
&, 
x
, 
y
, 
tx
, 
ty
);

71 
vœtu®
 
boŞ
 
süŞl
(
SüŞlDœeùiÚ
, 
SüŞlG¿nuÏr™y
, 
muÉl›r
 = 1.0f, 
Node
** 
¡İNode
 = 0);

73 
vœtu®
 
ÿlcP»fWidths
();

74 
vœtu®
 
ba£lšePos™iÚ
(
boŞ
 
fœ¡Lše
, boŞ 
isRoÙLšeBox
) const;

75 
vœtu®
 
ÿlcHeight
();

77 
vœtu®
 
Ïyout
();

79 
vœtu®
 
boŞ
 
ÿnBeProg¿m©iÿÎySüŞËd
(boŞècÚ¡ {  
	gŒue
; }

80 
vœtu®
 
autosüŞl
();

81 
vœtu®
 
¡İAutosüŞl
();

83 
vœtu®
 
boŞ
 
shouldPªSüŞl
(ècÚ¡ {  
	gŒue
; }

84 
vœtu®
 
·nSüŞl
(cÚ¡ 
IÁPošt
&);

86 
vœtu®
 
v”tiÿlSüŞlb¬Width
() const;

87 
vœtu®
 
süŞlLeá
() const;

88 
vœtu®
 
süŞlTİ
() const;

89 
vœtu®
 
süŞlWidth
() const;

90 
vœtu®
 
süŞlHeight
() const;

91 
vœtu®
 
£tSüŞlLeá
();

92 
vœtu®
 
£tSüŞlTİ
();

94 
vœtu®
 
boŞ
 
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, 
x
, 
y
, 
tx
, 
ty
, 
H™Te¡AùiÚ
);

96 
vœtu®
 
¡yËDidChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
);

99 
vœtu®
 
v®ueChªged
(
SüŞlb¬
*);

100 
vœtu®
 
šv®id©eSüŞlb¬Reù
(
SüŞlb¬
*, cÚ¡ 
IÁReù
&);

101 
vœtu®
 
boŞ
 
isAùive
() const;

102 
vœtu®
 
boŞ
 
süŞlb¬CÜÃrP»£Á
(ècÚ¡ {  
	gçl£
; }

103 
vœtu®
 
IÁReù
 
cÚv”tFromSüŞlb¬ToCÚššgV›w
(cÚ¡ 
SüŞlb¬
*, const IntRect&) const;

104 
vœtu®
 
IÁReù
 
cÚv”tFromCÚššgV›wToSüŞlb¬
(cÚ¡ 
SüŞlb¬
*, const IntRect&) const;

105 
vœtu®
 
IÁPošt
 
cÚv”tFromSüŞlb¬ToCÚššgV›w
(cÚ¡ 
SüŞlb¬
*, const IntPoint&) const;

106 
vœtu®
 
IÁPošt
 
cÚv”tFromCÚššgV›wToSüŞlb¬
(cÚ¡ 
SüŞlb¬
*, const IntPoint&) const;

108 
£tHasV”tiÿlSüŞlb¬
(
boŞ
 
hasSüŞlb¬
);

109 
	gPassRefPŒ
<
	gSüŞlb¬
> 
ü—‹SüŞlb¬
();

110 
de¡roySüŞlb¬
();

112 
™emHeight
() const;

113 
v®ueChªged
(
li¡Index
);

114 
size
() const;

115 
numVisibËI‹ms
() const;

116 
numI‹ms
() const;

117 
li¡Height
() const;

118 
·štSüŞlb¬
(
PaštInfo
&, 
tx
, 
ty
);

119 
·štI‹mFÜeground
(
PaštInfo
&, 
tx
, 
ty
, 
li¡Index
);

120 
·štI‹mBackground
(
PaštInfo
&, 
tx
, 
ty
, 
li¡Index
);

121 
süŞlToRev—lS–eùiÚ
();

123 
boŞ
 
	gm_İtiÚsChªged
;

124 
boŞ
 
	gm_süŞlToRev—lS–eùiÚAá”Layout
;

125 
boŞ
 
	gm_šAutosüŞl
;

126 
	gm_İtiÚsWidth
;

127 
	gm_šdexOff£t
;

129 
	gRefPŒ
<
	gSüŞlb¬
> 
	gm_vB¬
;

132 
šlše
 
R’d”Li¡Box
* 
toR’d”Li¡Box
(
R’d”Objeù
* 
objeù
)

134 
ASSERT
(!
objeù
 || objeù->
isLi¡Box
());

135  
	g¡©ic_ÿ¡
<
	gR’d”Li¡Box
*>(
	gobjeù
);

139 
toR’d”Li¡Box
(cÚ¡ 
R’d”Li¡Box
*);

	@RenderListItem.cpp

24 
	~"cÚfig.h
"

25 
	~"R’d”Li¡I‹m.h
"

27 
	~"CachedImage.h
"

28 
	~"HTMLNames.h
"

29 
	~"HTMLOLi¡EËm’t.h
"

30 
	~"R’d”Li¡M¬k”.h
"

31 
	~"R’d”V›w.h
"

32 
	~<wtf/StdLibExŒas.h
>

34 
usšg
 
Çme¥aû
 
	g¡d
;

36 
Çme¥aû
 
	gWebCÜe
 {

38 
usšg
 
Çme¥aû
 
	gHTMLNames
;

40 
	gR’d”Li¡I‹m
::
R’d”Li¡I‹m
(
Node
* 
node
)

41 : 
R’d”Block
(
node
)

42 , 
m_m¬k”
(0)

43 , 
m_hasEx¶ic™V®ue
(
çl£
)

44 , 
m_isV®ueUpToD©e
(
çl£
)

45 , 
m_nÙInLi¡
(
çl£
)

47 
£tIÆše
(
çl£
);

50 
	gR’d”Li¡I‹m
::
¡yËDidChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
)

52 
	gR’d”Block
::
¡yËDidChªge
(
diff
, 
ŞdStyË
);

54 ià(
¡yË
()->
li¡StyËTy³
(è!ğ
NÚeLi¡StyË


55 || (
¡yË
()->
li¡StyËImage
(è&& !¡yË()->li¡StyËImage()->
”rÜOccu¼ed
())) {

56 
RefPŒ
<
R’d”StyË
> 
ÃwStyË
 = R’d”StyË::
ü—‹
();

59 
	gÃwStyË
->
šh”™From
(
¡yË
());

60 ià(!
	gm_m¬k”
)

61 
	gm_m¬k”
 = 
Ãw
 (
»nd”A»Ç
()è
R’d”Li¡M¬k”
(
this
);

62 
	gm_m¬k”
->
£tStyË
(
ÃwStyË
.
»Ëa£
());

63 } ià(
	gm_m¬k”
) {

64 
	gm_m¬k”
->
de¡roy
();

65 
	gm_m¬k”
 = 0;

69 
	gR’d”Li¡I‹m
::
de¡roy
()

71 ià(
m_m¬k”
) {

72 
m_m¬k”
->
de¡roy
();

73 
	gm_m¬k”
 = 0;

75 
	gR’d”Block
::
de¡roy
();

78 
boŞ
 
isLi¡
(
Node
* 
node
)

80  (
	gnode
->
hasTagName
(
ulTag
è||‚ode->hasTagName(
ŞTag
));

83 
Node
* 
’şosšgLi¡
(Node* 
node
)

85 
Node
* 
	g·»Á
 = 
node
->
·»ÁNode
();

86 
Node
* 
	gn
 = 
·»Á
;‚;‚ = 
n
->
·»ÁNode
())

87 ià(
isLi¡
(
n
))

88  
n
;

92  
	g·»Á
;

95 
Node
* 
’şosšgLi¡
(cÚ¡ 
R’d”Objeù
* 
»nd””
)

97 
Node
* 
	gnode
 = 
»nd””
->
node
();

98 ià(
	gnode
)

99  
’şosšgLi¡
(
node
);

101 
	g»nd””
 = 
»nd””
->
·»Á
();

102 
	g»nd””
 && !»nd””->
node
())

103 
	g»nd””
 = 
»nd””
->
·»Á
();

105 
	gnode
 = 
»nd””
->
node
();

106 ià(
isLi¡
(
node
))

107  
	gnode
;

109  
’şosšgLi¡
(
node
);

112 
R’d”Li¡I‹m
* 
´eviousLi¡I‹m
(
Node
* 
li¡
, cÚ¡ R’d”Li¡I‹m* 
™em
)

114 
R’d”Objeù
* 
	g»nd””
 = 
™em
->
´eviousInP»Ord”
();„’d”” !ğ
li¡
->
»nd””
();„enderer =„enderer->previousInPreOrder()) {

115 ià(!
»nd””
->
isLi¡I‹m
())

117 
Node
* 
	gÙh”Li¡
 = 
’şosšgLi¡
(
»nd””
);

119 ià(
	gli¡
 =ğ
Ùh”Li¡
)

120  
toR’d”Li¡I‹m
(
»nd””
);

125 ià(
	gÙh”Li¡
)

126 
	g»nd””
 = 
Ùh”Li¡
->
»nd””
()->
ÃxtInP»Ord”
();

131 
šlše
 
	gR’d”Li¡I‹m
::
ÿlcV®ue
() const

133 ià(
m_hasEx¶ic™V®ue
)

134  
m_ex¶ic™V®ue
;

135 
Node
* 
	gli¡
 = 
’şosšgLi¡
(
this
);

138 ià(
R’d”Li¡I‹m
* 
	g´eviousI‹m
 = 
´eviousLi¡I‹m
(
li¡
, 
this
))

139  
	g´eviousI‹m
->
v®ue
() + 1;

140 ià(
	gli¡
 &&†i¡->
hasTagName
(
ŞTag
))

141  
	g¡©ic_ÿ¡
<
	gHTMLOLi¡EËm’t
*>(
	gli¡
)->
¡¬t
();

145 
	gR’d”Li¡I‹m
::
upd©eV®ueNow
() const

147 
m_v®ue
 = 
ÿlcV®ue
();

148 
	gm_isV®ueUpToD©e
 = 
Œue
;

151 
boŞ
 
	gR’d”Li¡I‹m
::
isEm±y
() const

153  
Ï¡Chd
(è=ğ
m_m¬k”
;

156 
R’d”Objeù
* 
g‘P¬’tOfFœ¡LšeBox
(
R’d”Block
* 
cu¼
, R’d”Objeù* 
m¬k”
)

158 
R’d”Objeù
* 
	gfœ¡Chd
 = 
cu¼
->
fœ¡Chd
();

159 ià(!
	gfœ¡Chd
)

162 
R’d”Objeù
* 
	gcu¼Chd
 = 
fœ¡Chd
; cu¼Chd; cu¼Chd = 
cu¼Chd
->
ÃxtSiblšg
()) {

163 ià(
cu¼Chd
 =ğ
m¬k”
)

166 ià(
	gcu¼Chd
->
isIÆše
(è&& (!cu¼Chd->
isR’d”IÆše
(è|| 
	gcu¼
->
g’”©esLšeBoxesFÜIÆšeChd
(
cu¼Chd
)))

167  
	gcu¼
;

169 ià(
	gcu¼Chd
->
isFlßtšg
(è|| cu¼Chd->
isPos™iÚed
())

172 ià(
	gcu¼Chd
->
isTabË
(è|| !cu¼Chd->
isR’d”Block
())

175 ià(
	gcu¼
->
isLi¡I‹m
(è&& 
	gcu¼Chd
->
¡yË
()->
htmlHacks
(è&& cu¼Chd->
node
() &&

176 (
	gcu¼Chd
->
node
()->
hasTagName
(
ulTag
)|| cu¼Chd->node()->hasTagName(
ŞTag
)))

179 
R’d”Objeù
* 
	glšeBox
 = 
g‘P¬’tOfFœ¡LšeBox
(
toR’d”Block
(
cu¼Chd
), 
m¬k”
);

180 ià(
	glšeBox
)

181  
	glšeBox
;

187 
	gR’d”Li¡I‹m
::
upd©eV®ue
()

189 ià(!
m_hasEx¶ic™V®ue
) {

190 
m_isV®ueUpToD©e
 = 
çl£
;

191 ià(
	gm_m¬k”
)

192 
	gm_m¬k”
->
£tN“dsLayoutAndP»fWidthsReÿlc
();

196 
R’d”Objeù
* 
fœ¡NÚM¬k”Chd
(R’d”Objeù* 
·»Á
)

198 
R’d”Objeù
* 
	g»suÉ
 = 
·»Á
->
fœ¡Chd
();

199 
	g»suÉ
 &&„esuÉ->
isLi¡M¬k”
())

200 
	g»suÉ
 = 
»suÉ
->
ÃxtSiblšg
();

201  
	g»suÉ
;

204 
	gR’d”Li¡I‹m
::
upd©eM¬k”LoÿtiÚ
()

207 ià(
m_m¬k”
) {

208 
R’d”Objeù
* 
m¬k”P¬
 = 
m_m¬k”
->
·»Á
();

209 
R’d”Objeù
* 
	glšeBoxP¬’t
 = 
g‘P¬’tOfFœ¡LšeBox
(
this
, 
m_m¬k”
);

210 ià(!
	glšeBoxP¬’t
) {

215 ià(
	gm¬k”P¬
 && m¬k”P¬->
isAnÚymousBlock
())

216 
	glšeBoxP¬’t
 = 
m¬k”P¬
;

218 
	glšeBoxP¬’t
 = 
this
;

221 ià(
	gm¬k”P¬
 !ğ
lšeBoxP¬’t
 || 
m_m¬k”
->
´efWidthsDœty
()) {

224 
v›w
()->
di§bËLayoutS‹
();

225 
upd©eFœ¡L‘‹r
();

226 
	gm_m¬k”
->
»move
();

227 ià(!
	glšeBoxP¬’t
)

228 
	glšeBoxP¬’t
 = 
this
;

229 
	glšeBoxP¬’t
->
addChd
(
m_m¬k”
, 
fœ¡NÚM¬k”Chd
(
lšeBoxP¬’t
));

230 ià(
	gm_m¬k”
->
´efWidthsDœty
())

231 
	gm_m¬k”
->
ÿlcP»fWidths
();

232 
v›w
()->
’abËLayoutS‹
();

237 
	gR’d”Li¡I‹m
::
ÿlcP»fWidths
()

239 
ASSERT
(
´efWidthsDœty
());

241 
upd©eM¬k”LoÿtiÚ
();

243 
	gR’d”Block
::
ÿlcP»fWidths
();

246 
	gR’d”Li¡I‹m
::
Ïyout
()

248 
ASSERT
(
ÃedsLayout
());

250 
upd©eM¬k”LoÿtiÚ
();

251 
	gR’d”Block
::
Ïyout
();

254 
	gR’d”Li¡I‹m
::
pos™iÚLi¡M¬k”
()

256 ià(
m_m¬k”
 && !m_m¬k”->
isInside
(è&& m_m¬k”->
šlšeBoxW¿µ”
()) {

257 
m¬k”OldX
 = 
m_m¬k”
->
x
();

258 
	gyOff£t
 = 0;

259 
	gxOff£t
 = 0;

260 
R’d”Box
* 
	go
 = 
m_m¬k”
->
·»ÁBox
(); o !ğ
this
; o = 
o
->parentBox()) {

261 
yOff£t
 +ğ
o
->
y
();

262 
	gxOff£t
 +ğ
o
->
x
();

265 
boŞ
 
	gadju¡Ov”æow
 = 
çl£
;

266 
	gm¬k”XPos
;

267 
RoÙIÆšeBox
* 
	groÙ
 = 
m_m¬k”
->
šlšeBoxW¿µ”
()->
roÙ
();

272 ià(
¡yË
()->
dœeùiÚ
(è=ğ
LTR
) {

273 
ËáLšeOff£t
 = 
ËáR–Off£t
(
yOff£t
, 
ËáOff£t
(yOff£t, 
çl£
), false);

274 
	gm¬k”XPos
 = 
ËáLšeOff£t
 - 
xOff£t
 - 
·ddšgLeá
(è- 
bÜd”Leá
(è+ 
m_m¬k”
->
m¬gšLeá
();

275 
	gm_m¬k”
->
šlšeBoxW¿µ”
()->
adju¡Pos™iÚ
(
m¬k”XPos
 - 
m¬k”OldX
, 0);

276 
IÆšeFlowBox
* 
	gbox
 = 
m_m¬k”
->
šlšeBoxW¿µ”
()->
·»Á
(); box; box = 
box
->parent()) {

277 ià(
m¬k”XPos
 < 
box
->
ËáLayoutOv”æow
()) {

278 
box
->
£tHÜizÚlOv”æowPos™iÚs
(
m¬k”XPos
, box->
rightLayoutOv”æow
(), box->
ËáVisu®Ov”æow
(), box->
rightVisu®Ov”æow
());

279 ià(
	gbox
 =ğ
roÙ
)

280 
adju¡Ov”æow
 = 
Œue
;

284 
	grightLšeOff£t
 = 
rightR–Off£t
(
yOff£t
, 
rightOff£t
(yOff£t, 
çl£
), false);

285 
	gm¬k”XPos
 = 
rightLšeOff£t
 - 
xOff£t
 + 
·ddšgRight
(è+ 
bÜd”Right
(è+ 
m_m¬k”
->
m¬gšLeá
();

286 
	gm_m¬k”
->
šlšeBoxW¿µ”
()->
adju¡Pos™iÚ
(
m¬k”XPos
 - 
m¬k”OldX
, 0);

287 
IÆšeFlowBox
* 
	gbox
 = 
m_m¬k”
->
šlšeBoxW¿µ”
()->
·»Á
(); box; box = 
box
->parent()) {

288 ià(
m¬k”XPos
 + 
m_m¬k”
->
width
(è> 
box
->
rightLayoutOv”æow
()) {

289 
box
->
£tHÜizÚlOv”æowPos™iÚs
(box->
ËáLayoutOv”æow
(), 
m¬k”XPos
 + 
m_m¬k”
->
width
(), box->
ËáVisu®Ov”æow
(), box->
rightVisu®Ov”æow
());

290 ià(
	gbox
 =ğ
roÙ
)

291 
adju¡Ov”æow
 = 
Œue
;

296 ià(
	gadju¡Ov”æow
) {

297 
IÁReù
 
m¬k”Reù
(
m¬k”XPos
 + 
xOff£t
, 
yOff£t
, 
m_m¬k”
->
width
(), m_m¬k”->
height
());

298 
R’d”Box
* 
	go
 = 
m_m¬k”
;

300 
	go
 = 
o
->
·»ÁBox
();

301 ià(
	go
->
isR’d”Block
())

302 
toR’d”Block
(
o
)->
addLayoutOv”æow
(
m¬k”Reù
);

303 
	gm¬k”Reù
.
move
(-
o
->
x
(), -o->
y
());

304 } 
	go
 !ğ
this
 && !
o
->
hasS–fPaštšgLay”
());

309 
	gR’d”Li¡I‹m
::
·št
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

311 ià(!
height
())

314 
	gR’d”Block
::
·št
(
·štInfo
, 
tx
, 
ty
);

317 cÚ¡ 
	gSŒšg
& 
	gR’d”Li¡I‹m
::
m¬k”Text
() const

319 ià(
m_m¬k”
)

320  
m_m¬k”
->
‹xt
();

321 
DEFINE_STATIC_LOCAL
(
SŒšg
, 
¡©icNuÎSŒšg
, ());

322  
	g¡©icNuÎSŒšg
;

325 
	gR’d”Li¡I‹m
::
ex¶ic™V®ueChªged
()

327 ià(
m_m¬k”
)

328 
m_m¬k”
->
£tN“dsLayoutAndP»fWidthsReÿlc
();

329 
Node
* 
	gli¡Node
 = 
’şosšgLi¡
(
node
());

330 
R’d”Objeù
* 
	gli¡R’d””
 = 0;

331 ià(
	gli¡Node
)

332 
	gli¡R’d””
 = 
li¡Node
->
»nd””
();

333 
R’d”Objeù
* 
	g»nd””
 = 
this
;„’d””;„’d”” = 
»nd””
->
ÃxtInP»Ord”
(
li¡R’d””
))

334 ià(
»nd””
->
isLi¡I‹m
()) {

335 
R’d”Li¡I‹m
* 
™em
 = 
toR’d”Li¡I‹m
(
»nd””
);

336 ià(!
	g™em
->
	gm_hasEx¶ic™V®ue
) {

337 
	g™em
->
	gm_isV®ueUpToD©e
 = 
çl£
;

338 ià(
R’d”Li¡M¬k”
* 
	gm¬k”
 = 
™em
->
m_m¬k”
)

339 
m¬k”
->
£tN“dsLayoutAndP»fWidthsReÿlc
();

344 
	gR’d”Li¡I‹m
::
£tEx¶ic™V®ue
(
v®ue
)

346 
ASSERT
(
node
());

348 ià(
	gm_hasEx¶ic™V®ue
 && 
	gm_ex¶ic™V®ue
 =ğ
v®ue
)

350 
	gm_ex¶ic™V®ue
 = 
v®ue
;

351 
	gm_v®ue
 = 
v®ue
;

352 
	gm_hasEx¶ic™V®ue
 = 
Œue
;

353 
ex¶ic™V®ueChªged
();

356 
	gR’d”Li¡I‹m
::
ş—rEx¶ic™V®ue
()

358 
ASSERT
(
node
());

360 ià(!
	gm_hasEx¶ic™V®ue
)

362 
	gm_hasEx¶ic™V®ue
 = 
çl£
;

363 
	gm_isV®ueUpToD©e
 = 
çl£
;

364 
ex¶ic™V®ueChªged
();

	@RenderListItem.h

23 #iâdeà
R’d”Li¡I‹m_h


24 
	#R’d”Li¡I‹m_h


	)

26 
	~"R’d”Block.h
"

28 
Çme¥aû
 
	gWebCÜe
 {

30 
şass
 
	gR’d”Li¡M¬k”
;

32 şas 
	cR’d”Li¡I‹m
 : 
public
 
R’d”Block
 {

33 
public
:

34 
R’d”Li¡I‹m
(
Node
*);

36 
v®ue
(ècÚ¡ { ià(!
	gm_isV®ueUpToD©e
è
upd©eV®ueNow
();  
	gm_v®ue
; }

37 
upd©eV®ue
();

39 
boŞ
 
hasEx¶ic™V®ue
(ècÚ¡ {  
	gm_hasEx¶ic™V®ue
; }

40 
ex¶ic™V®ue
(ècÚ¡ {  
	gm_ex¶ic™V®ue
; }

41 
£tEx¶ic™V®ue
(
v®ue
);

42 
ş—rEx¶ic™V®ue
();

44 
£tNÙInLi¡
(
boŞ
 
nÙInLi¡
è{ 
	gm_nÙInLi¡
 =‚otInList; }

45 
boŞ
 
nÙInLi¡
(ècÚ¡ {  
	gm_nÙInLi¡
; }

47 cÚ¡ 
	gSŒšg
& 
m¬k”Text
() const;

49 
	g´iv©e
:

50 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderListItem"; }

52 
vœtu®
 
boŞ
 
isLi¡I‹m
(ècÚ¡ {  
	gŒue
; }

54 
vœtu®
 
de¡roy
();

56 
vœtu®
 
boŞ
 
isEm±y
() const;

57 
vœtu®
 
·št
(
PaštInfo
&, 
tx
, 
ty
);

59 
vœtu®
 
Ïyout
();

60 
vœtu®
 
ÿlcP»fWidths
();

62 
vœtu®
 
pos™iÚLi¡M¬k”
();

64 
vœtu®
 
¡yËDidChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
);

66 
upd©eM¬k”LoÿtiÚ
();

67 
šlše
 
ÿlcV®ue
() const;

68 
upd©eV®ueNow
() const;

69 
ex¶ic™V®ueChªged
();

71 
R’d”Li¡M¬k”
* 
	gm_m¬k”
;

72 
	gm_ex¶ic™V®ue
;

73 
mubË
 
	gm_v®ue
;

75 
boŞ
 
	gm_hasEx¶ic™V®ue
 : 1;

76 
mubË
 
boŞ
 
	gm_isV®ueUpToD©e
 : 1;

77 
boŞ
 
	gm_nÙInLi¡
 : 1;

80 
šlše
 
R’d”Li¡I‹m
* 
	$toR’d”Li¡I‹m
(
R’d”Objeù
* 
objeù
)

82 
	`ASSERT
(!
objeù
 || objeù->
	`isLi¡I‹m
());

83  
¡©ic_ÿ¡
<
R’d”Li¡I‹m
*>(
objeù
);

84 
	}
}

87 
toR’d”Li¡I‹m
(cÚ¡ 
R’d”Li¡I‹m
*);

	@RenderListMarker.cpp

25 
	~"cÚfig.h
"

26 
	~"R’d”Li¡M¬k”.h
"

28 
	~"CachedImage.h
"

29 
	~"Ch¬aù”Names.h
"

30 
	~"Docum’t.h
"

31 
	~"G¿phicsCÚ‹xt.h
"

32 
	~"R’d”Lay”.h
"

33 
	~"R’d”Li¡I‹m.h
"

34 
	~"R’d”V›w.h
"

36 
usšg
 
Çme¥aû
 
	g¡d
;

37 
usšg
 
Çme¥aû
 
	gWTF
;

38 
usšg
 
Çme¥aû
 
	gUnicode
;

40 
Çme¥aû
 
	gWebCÜe
 {

42 cÚ¡ 
	gcM¬k”Paddšg
 = 7;

44 
	eSequ’ûTy³
 { 
	gNum”icSequ’û
, 
	gAÍhab‘icSequ’û
 };

46 
SŒšg
 
toRomª
(
numb”
, 
boŞ
 
uµ”
)

51 ià(
	gnumb”
 < 1 ||‚umber > 3999)

52  
	gSŒšg
::
numb”
(number);

56 cÚ¡ 
	gË‰”sSize
 = 15;

57 
UCh¬
 
	gË‰”s
[
Ë‰”sSize
];

59 
	gËngth
 = 0;

60 cÚ¡ 
UCh¬
 
	gldig™s
[] = { 'i', 'v', 'x', 'l', 'c', 'd', 'm' };

61 cÚ¡ 
UCh¬
 
	gudig™s
[] = { 'I', 'V', 'X', 'L', 'C', 'D', 'M' };

62 cÚ¡ 
UCh¬
* 
	gdig™s
 = 
uµ”
 ? 
udig™s
 : 
ldig™s
;

63 
	gd
 = 0;

65 
	gnum
 = 
numb”
 % 10;

66 ià(
	gnum
 % 5 < 4)

67 
	gi
 = 
num
 % 5; i > 0; i--)

68 
	gË‰”s
[
Ë‰”sSize
 - ++
Ëngth
] = 
dig™s
[
d
];

69 ià(
	gnum
 >ğ4 && 
num
 <= 8)

70 
Ë‰”s
[
Ë‰”sSize
 - ++
Ëngth
] = 
dig™s
[
d
 + 1];

71 ià(
	gnum
 == 9)

72 
Ë‰”s
[
Ë‰”sSize
 - ++
Ëngth
] = 
dig™s
[
d
 + 2];

73 ià(
	gnum
 % 5 == 4)

74 
Ë‰”s
[
Ë‰”sSize
 - ++
Ëngth
] = 
dig™s
[
d
];

75 
	gnumb”
 /= 10;

76 
	gd
 += 2;

77 } 
	gnumb”
);

79 
ASSERT
(
Ëngth
 <ğ
Ë‰”sSize
);

80  
SŒšg
(&
Ë‰”s
[
Ë‰”sSize
 - 
Ëngth
],†ength);

83 
šlše
 
SŒšg
 
toAÍhab‘icOrNum”ic
(
numb”
, cÚ¡ 
UCh¬
* 
£qu’û
, 
£qu’ûSize
, 
Sequ’ûTy³
 
ty³
)

85 
ASSERT
(
£qu’ûSize
 >= 2);

87 cÚ¡ 
	gË‰”sSize
 = (
numb”
) * 8 + 1;

89 
UCh¬
 
	gË‰”s
[
Ë‰”sSize
];

91 
boŞ
 
	gisNeg©iveNumb”
 = 
çl£
;

92 
	gnumb”Shadow
 = 
numb”
;

93 ià(
	gty³
 =ğ
AÍhab‘icSequ’û
) {

94 
ASSERT
(
numb”
 > 0);

95 --
	gnumb”Shadow
;

96 } ià(
	gnumb”
 < 0) {

97 
	gnumb”Shadow
 = -
numb”
;

98 
	gisNeg©iveNumb”
 = 
Œue
;

100 
	gË‰”s
[
Ë‰”sSize
 - 1] = 
£qu’û
[
numb”Shadow
 % 
£qu’ûSize
];

101 
	gËngth
 = 1;

103 ià(
	gty³
 =ğ
AÍhab‘icSequ’û
) {

104 (
numb”Shadow
 /ğ
£qu’ûSize
) > 0)

105 
Ë‰”s
[
Ë‰”sSize
 - ++
Ëngth
] = 
£qu’û
[
numb”Shadow
 % 
£qu’ûSize
 - 1];

107 (
	gnumb”Shadow
 /ğ
£qu’ûSize
) > 0)

108 
Ë‰”s
[
Ë‰”sSize
 - ++
Ëngth
] = 
£qu’û
[
numb”Shadow
 % 
£qu’ûSize
];

110 ià(
	gisNeg©iveNumb”
)

111 
	gË‰”s
[
Ë‰”sSize
 - ++
Ëngth
] = 
hyph’Mšus
;

113 
ASSERT
(
Ëngth
 <ğ
Ë‰”sSize
);

114  
SŒšg
(&
Ë‰”s
[
Ë‰”sSize
 - 
Ëngth
],†ength);

117 
SŒšg
 
toAÍhab‘ic
(
numb”
, cÚ¡ 
UCh¬
* 
®phab‘
, 
®phab‘Size
)

119 ià(
	gnumb”
 < 1)

120  
	gSŒšg
::
numb”
(number);

122  
toAÍhab‘icOrNum”ic
(
numb”
, 
®phab‘
, 
®phab‘Size
, 
AÍhab‘icSequ’û
);

125 
SŒšg
 
toNum”ic
(
numb”
, cÚ¡ 
UCh¬
* 
num”®s
, 
num”®sSize
)

127  
toAÍhab‘icOrNum”ic
(
numb”
, 
num”®s
, 
num”®sSize
, 
Num”icSequ’û
);

130 
	g‹m¶©e
 <
size_t
 
	gsize
> 
šlše
 
SŒšg
 
toAÍhab‘ic
(
numb”
, cÚ¡ 
UCh¬
(&
®phab‘
)[
size
])

132  
toAÍhab‘ic
(
numb”
, 
®phab‘
, 
size
);

135 
	g‹m¶©e
 <
size_t
 
	gsize
> 
šlše
 
SŒšg
 
toNum”ic
(
numb”
, cÚ¡ 
UCh¬
(&
®phab‘
)[
size
])

137  
toNum”ic
(
numb”
, 
®phab‘
, 
size
);

140 
toHeb»wUnd”1000
(
numb”
, 
UCh¬
 
Ë‰”s
[5])

144 
ASSERT
(
numb”
 >= 0 &&‚umber < 1000);

145 
	gËngth
 = 0;

146 
	gfourHund»ds
 = 
numb”
 / 400;

147 
	gi
 = 0; i < 
	gfourHund»ds
; i++)

148 
	gË‰”s
[
Ëngth
++] = 1511 + 3;

149 
	gnumb”
 %= 400;

150 ià(
	gnumb”
 / 100)

151 
	gË‰”s
[
Ëngth
++] = 1511 + (
numb”
 / 100) - 1;

152 
	gnumb”
 %= 100;

153 ià(
	gnumb”
 =ğ15 || 
numb”
 == 16) {

154 
Ë‰”s
[
Ëngth
++] = 1487 + 9;

155 
	gË‰”s
[
Ëngth
++] = 1487 + 
numb”
 - 9;

157 ià(
	g‹ns
 = 
numb”
 / 10) {

158 cÚ¡ 
UCh¬
 
heb»wT’s
[9] = { 1497, 1499, 1500, 1502, 1504, 1505, 1506, 1508, 1510 };

159 
	gË‰”s
[
Ëngth
++] = 
heb»wT’s
[
‹ns
 - 1];

161 ià(
	gÚes
 = 
numb”
 % 10)

162 
Ë‰”s
[
Ëngth
++] = 1487 + 
Úes
;

164 
ASSERT
(
Ëngth
 <= 5);

165  
	gËngth
;

168 
SŒšg
 
toHeb»w
(
numb”
)

171 ià(
	gnumb”
 < 0 ||‚umber > 999999)

172  
	gSŒšg
::
numb”
(number);

174 ià(
	gnumb”
 == 0) {

175 cÚ¡ 
UCh¬
 
heb»wZ”o
[3] = { 0x05D0, 0x05E4, 0x05E1 };

176  
SŒšg
(
heb»wZ”o
, 3);

179 cÚ¡ 
	gË‰”sSize
 = 11;

180 
UCh¬
 
	gË‰”s
[
Ë‰”sSize
];

182 
	gËngth
;

183 ià(
	gnumb”
 < 1000)

184 
	gËngth
 = 0;

186 
	gËngth
 = 
toHeb»wUnd”1000
(
numb”
 / 1000, 
Ë‰”s
);

187 
	gË‰”s
[
Ëngth
++] = '\'';

188 
	gnumb”
 = 
numb”
 % 1000;

190 
	gËngth
 +ğ
toHeb»wUnd”1000
(
numb”
, 
Ë‰”s
 + 
Ëngth
);

192 
ASSERT
(
Ëngth
 <ğ
Ë‰”sSize
);

193  
SŒšg
(
Ë‰”s
, 
Ëngth
);

196 
toArm’ŸnUnd”10000
(
numb”
, 
boŞ
 
uµ”
, boŞ 
addCœcumæex
, 
UCh¬
 
Ë‰”s
[9])

198 
ASSERT
(
numb”
 >= 0 &&‚umber < 10000);

199 
	gËngth
 = 0;

201 
	glow”Off£t
 = 
uµ”
 ? 0 : 0x0030;

203 ià(
	gthou§nds
 = 
numb”
 / 1000) {

204 ià(
thou§nds
 == 7) {

205 
Ë‰”s
[
Ëngth
++] = 0x0548 + 
low”Off£t
;

206 
	gË‰”s
[
Ëngth
++] = 0x0552 + 
low”Off£t
;

207 ià(
	gaddCœcumæex
)

208 
	gË‰”s
[
Ëngth
++] = 0x0302;

210 
	gË‰”s
[
Ëngth
++] = (0x054C - 1 + 
low”Off£t
è+ 
thou§nds
;

211 ià(
	gaddCœcumæex
)

212 
	gË‰”s
[
Ëngth
++] = 0x0302;

216 ià(
	ghund»ds
 = (
numb”
 / 100) % 10) {

217 
Ë‰”s
[
Ëngth
++] = (0x0543 - 1 + 
low”Off£t
è+ 
hund»ds
;

218 ià(
	gaddCœcumæex
)

219 
	gË‰”s
[
Ëngth
++] = 0x0302;

222 ià(
	g‹ns
 = (
numb”
 / 10) % 10) {

223 
Ë‰”s
[
Ëngth
++] = (0x053A - 1 + 
low”Off£t
è+ 
‹ns
;

224 ià(
	gaddCœcumæex
)

225 
	gË‰”s
[
Ëngth
++] = 0x0302;

228 ià(
	gÚes
 = 
numb”
 % 10) {

229 
Ë‰”s
[
Ëngth
++] = (0x531 - 1 + 
low”Off£t
è+ 
Úes
;

230 ià(
	gaddCœcumæex
)

231 
	gË‰”s
[
Ëngth
++] = 0x0302;

234  
	gËngth
;

237 
SŒšg
 
toArm’Ÿn
(
numb”
, 
boŞ
 
uµ”
)

239 ià(
	gnumb”
 < 1 ||‚umber > 99999999)

240  
	gSŒšg
::
numb”
(number);

242 cÚ¡ 
	gË‰”sSize
 = 18;

243 
UCh¬
 
	gË‰”s
[
Ë‰”sSize
];

245 
	gËngth
 = 
toArm’ŸnUnd”10000
(
numb”
 / 10000, 
uµ”
, 
Œue
, 
Ë‰”s
);

246 
	gËngth
 +ğ
toArm’ŸnUnd”10000
(
numb”
 % 10000, 
uµ”
, 
çl£
, 
Ë‰”s
 + 
Ëngth
);

248 
ASSERT
(
Ëngth
 <ğ
Ë‰”sSize
);

249  
SŒšg
(
Ë‰”s
, 
Ëngth
);

252 
SŒšg
 
toGeÜgŸn
(
numb”
)

254 ià(
	gnumb”
 < 1 ||‚umber > 19999)

255  
	gSŒšg
::
numb”
(number);

257 cÚ¡ 
	gË‰”sSize
 = 5;

258 
UCh¬
 
	gË‰”s
[
Ë‰”sSize
];

260 
	gËngth
 = 0;

262 ià(
	gnumb”
 > 9999)

263 
	gË‰”s
[
Ëngth
++] = 0x10F5;

265 ià(
	gthou§nds
 = (
numb”
 / 1000) % 10) {

266 cÚ¡ 
UCh¬
 
geÜgŸnThou§nds
[9] = {

269 
	gË‰”s
[
Ëngth
++] = 
geÜgŸnThou§nds
[
thou§nds
 - 1];

272 ià(
	ghund»ds
 = (
numb”
 / 100) % 10) {

273 cÚ¡ 
UCh¬
 
geÜgŸnHund»ds
[9] = {

276 
	gË‰”s
[
Ëngth
++] = 
geÜgŸnHund»ds
[
hund»ds
 - 1];

279 ià(
	g‹ns
 = (
numb”
 / 10) % 10) {

280 cÚ¡ 
UCh¬
 
geÜgŸnT’s
[9] = {

283 
	gË‰”s
[
Ëngth
++] = 
geÜgŸnT’s
[
‹ns
 - 1];

286 ià(
	gÚes
 = 
numb”
 % 10) {

287 cÚ¡ 
UCh¬
 
geÜgŸnOÃs
[9] = {

290 
	gË‰”s
[
Ëngth
++] = 
geÜgŸnOÃs
[
Úes
 - 1];

293 
ASSERT
(
Ëngth
 <ğ
Ë‰”sSize
);

294  
SŒšg
(
Ë‰”s
, 
Ëngth
);

299 
SŒšg
 
toCJKIdeog¿phic
(
numb”
, cÚ¡ 
UCh¬
 
bË
[16])

301 ià(
	gnumb”
 < 0)

302  
	gSŒšg
::
numb”
(number);

304 
	eAb¡¿ùCJKCh¬
 {

305 
	gnoCh¬
,

306 
	g£cÚdGroupM¬k”
, 
	gthœdGroupM¬k”
, 
	gfou¹hGroupM¬k”
,

307 
	g£cÚdDig™M¬k”
, 
	gthœdDig™M¬k”
, 
	gfou¹hDig™M¬k”
,

308 
	gdig™0
, 
	gdig™1
, 
	gdig™2
, 
	gdig™3
, 
	gdig™4
,

309 
	gdig™5
, 
	gdig™6
, 
	gdig™7
, 
	gdig™8
, 
	gdig™9


312 ià(
	gnumb”
 == 0)

313  
SŒšg
(&
bË
[
dig™0
 - 1], 1);

315 cÚ¡ 
	ggroupL’gth
 = 8;

316 cÚ¡ 
	gbufãrL’gth
 = 4 * 
groupL’gth
;

317 
Ab¡¿ùCJKCh¬
 
	gbufãr
[
bufãrL’gth
] = { 
noCh¬
 };

319 
	gi
 = 0; i < 4; ++i) {

320 
	ggroupV®ue
 = 
numb”
 % 10000;

321 
	gnumb”
 /= 10000;

324 
Ab¡¿ùCJKCh¬
* 
	ggroup
 = &
bufãr
[(3 - 
i
è* 
groupL’gth
];

326 ià(
	ggroupV®ue
 && 
	gi
)

327 
	ggroup
[7] = 
¡©ic_ÿ¡
<
Ab¡¿ùCJKCh¬
>(
£cÚdGroupM¬k”
 - 1 + 
i
);

330 
	ggroup
[6] = 
¡©ic_ÿ¡
<
Ab¡¿ùCJKCh¬
>(
dig™0
 + (
groupV®ue
 % 10));

331 ià(
	gnumb”
 !ğ0 || 
groupV®ue
 > 9) {

332 
dig™V®ue
 = ((
groupV®ue
 / 10) % 10);

333 
	ggroup
[4] = 
¡©ic_ÿ¡
<
Ab¡¿ùCJKCh¬
>(
dig™0
 + 
dig™V®ue
);

334 ià(
	gdig™V®ue
)

335 
	ggroup
[5] = 
£cÚdDig™M¬k”
;

337 ià(
	gnumb”
 !ğ0 || 
groupV®ue
 > 99) {

338 
dig™V®ue
 = ((
groupV®ue
 / 100) % 10);

339 
	ggroup
[2] = 
¡©ic_ÿ¡
<
Ab¡¿ùCJKCh¬
>(
dig™0
 + 
dig™V®ue
);

340 ià(
	gdig™V®ue
)

341 
	ggroup
[3] = 
thœdDig™M¬k”
;

343 ià(
	gnumb”
 !ğ0 || 
groupV®ue
 > 999) {

344 
dig™V®ue
 = 
groupV®ue
 / 1000;

345 
	ggroup
[0] = 
¡©ic_ÿ¡
<
Ab¡¿ùCJKCh¬
>(
dig™0
 + 
dig™V®ue
);

346 ià(
	gdig™V®ue
)

347 
	ggroup
[1] = 
fou¹hDig™M¬k”
;

352 ià(
	ggroupV®ue
 < 20) {

353 
ASSERT
(
group
[4] =ğ
noCh¬
 || group[4] =ğ
dig™0
 || group[4] =ğ
dig™1
);

354 
	ggroup
[4] = 
noCh¬
;

357 ià(
	gnumb”
 == 0)

363 
	gËngth
 = 0;

364 
UCh¬
 
	gch¬aù”s
[
bufãrL’gth
];

365 
Ab¡¿ùCJKCh¬
 
	gÏ¡
 = 
noCh¬
;

366 
	gi
 = 0; i < 
	gbufãrL’gth
; ++i) {

367 
Ab¡¿ùCJKCh¬
 
	ga
 = 
bufãr
[
i
];

368 ià(
	ga
 !ğ
noCh¬
) {

369 ià(
a
 !ğ
dig™0
 || 
Ï¡
 != digit0)

370 
ch¬aù”s
[
Ëngth
++] = 
bË
[
a
 - 1];

371 
	gÏ¡
 = 
a
;

374 ià(
	gÏ¡
 =ğ
dig™0
)

375 --
Ëngth
;

377  
SŒšg
(
ch¬aù”s
, 
Ëngth
);

380 
UCh¬
 
li¡M¬k”Suffix
(
ELi¡StyËTy³
 
ty³
)

384 
	gty³
) {

385 
	gNÚeLi¡StyË
:

386 
Disc
:

387 
Cœşe
:

388 
Squ¬e
:

389 
ASSERT_NOT_REACHED
();

391 
	gAçr
:

392 
Amh¬ic
:

393 
Amh¬icAbegede
:

394 
Ethiİic
:

395 
EthiİicAbegede
:

396 
EthiİicAbegedeAmEt
:

397 
EthiİicAbegedeGez
:

398 
EthiİicAbegedeTiEr
:

399 
EthiİicAbegedeTiEt
:

400 
EthiİicH®ehameAaEr
:

401 
EthiİicH®ehameAaEt
:

402 
EthiİicH®ehameAmEt
:

403 
EthiİicH®ehameGez
:

404 
EthiİicH®ehameOmEt
:

405 
EthiİicH®ehameSidEt
:

406 
EthiİicH®ehameSoEt
:

407 
EthiİicH®ehameTiEr
:

408 
EthiİicH®ehameTiEt
:

409 
EthiİicH®ehameTig
:

410 
Oromo
:

411 
Sidama
:

412 
Som®i
:

413 
Tig»
:

414 
TigršyaEr
:

415 
TigršyaErAbegede
:

416 
TigršyaEt
:

417 
TigršyaEtAbegede
:

418  
‘hiİicP»çûCŞÚ
;

419 
	gArm’Ÿn
:

420 
A¿bicIndic
:

421 
B’g®i
:

422 
Bš¬yLi¡StyË
:

423 
CambodŸn
:

424 
CJKIdeog¿phic
:

425 
CjkE¬thlyB¿nch
:

426 
CjkH—v’lyS‹m
:

427 
Decim®L—dšgZ”o
:

428 
Decim®Li¡StyË
:

429 
Devªag¬i
:

430 
GeÜgŸn
:

431 
Guj¬©i
:

432 
Gurmukhi
:

433 
Hªgul
:

434 
HªgulCÚsÚªt
:

435 
Heb»w
:

436 
Hœagªa
:

437 
HœagªaIroha
:

438 
KªÇda
:

439 
K©akªa
:

440 
K©akªaIroha
:

441 
Khm”
:

442 
Lao
:

443 
Low”AÍha
:

444 
Low”G»ek
:

445 
Low”Hexadecim®
:

446 
Low”L©š
:

447 
Low”NÜwegŸn
:

448 
Low”Romª
:

449 
M®ay®am
:

450 
MÚgŞŸn
:

451 
Myªm¬
:

452 
Où®
:

453 
Oriya
:

454 
P”sŸn
:

455 
T–ugu
:

456 
Thai
:

457 
Tib‘ª
:

458 
Uµ”AÍha
:

459 
Uµ”G»ek
:

460 
Uµ”Hexadecim®
:

461 
Uµ”L©š
:

462 
Uµ”NÜwegŸn
:

463 
Uµ”Romª
:

464 
Urdu
:

468 
ASSERT_NOT_REACHED
();

472 
SŒšg
 
li¡M¬k”Text
(
ELi¡StyËTy³
 
ty³
, 
v®ue
)

474 
	gty³
) {

475 
	gNÚeLi¡StyË
:

480 
	gCœşe
:

481  
SŒšg
(&
wh™eBuÎ‘
, 1);

482 
	gDisc
:

483  
SŒšg
(&
buÎ‘
, 1);

484 
	gSqu¬e
:

487  
SŒšg
(&
bÏckSqu¬e
, 1);

489 
	gDecim®Li¡StyË
:

490  
SŒšg
::
numb”
(
v®ue
);

491 
	gDecim®L—dšgZ”o
:

492 ià(
v®ue
 < -9 || value > 9)

493  
SŒšg
::
numb”
(
v®ue
);

494 ià(
	gv®ue
 < 0)

495  "-0" + 
	gSŒšg
::
numb”
(-
v®ue
);

496  "0" + 
	gSŒšg
::
numb”
(
v®ue
);

498 
	gA¿bicIndic
: {

499 cÚ¡ 
UCh¬
 
¬abicIndicNum”®s
[10] = {

502  
toNum”ic
(
v®ue
, 
¬abicIndicNum”®s
);

504 
	gBš¬yLi¡StyË
: {

505 cÚ¡ 
UCh¬
 
bš¬yNum”®s
[2] = {

508  
toNum”ic
(
v®ue
, 
bš¬yNum”®s
);

510 
	gB’g®i
: {

511 cÚ¡ 
UCh¬
 
b’g®iNum”®s
[10] = {

514  
toNum”ic
(
v®ue
, 
b’g®iNum”®s
);

516 
	gCambodŸn
:

517 
Khm”
: {

518 cÚ¡ 
UCh¬
 
khm”Num”®s
[10] = {

521  
toNum”ic
(
v®ue
, 
khm”Num”®s
);

523 
	gDevªag¬i
: {

524 cÚ¡ 
UCh¬
 
devªag¬iNum”®s
[10] = {

527  
toNum”ic
(
v®ue
, 
devªag¬iNum”®s
);

529 
	gGuj¬©i
: {

530 cÚ¡ 
UCh¬
 
guj¬©iNum”®s
[10] = {

533  
toNum”ic
(
v®ue
, 
guj¬©iNum”®s
);

535 
	gGurmukhi
: {

536 cÚ¡ 
UCh¬
 
gurmukhiNum”®s
[10] = {

539  
toNum”ic
(
v®ue
, 
gurmukhiNum”®s
);

541 
	gKªÇda
: {

542 cÚ¡ 
UCh¬
 
kªÇdaNum”®s
[10] = {

545  
toNum”ic
(
v®ue
, 
kªÇdaNum”®s
);

547 
	gLow”Hexadecim®
: {

548 cÚ¡ 
UCh¬
 
low”Hexadecim®Num”®s
[16] = {

551  
toNum”ic
(
v®ue
, 
low”Hexadecim®Num”®s
);

553 
	gLao
: {

554 cÚ¡ 
UCh¬
 
ÏoNum”®s
[10] = {

557  
toNum”ic
(
v®ue
, 
ÏoNum”®s
);

559 
	gM®ay®am
: {

560 cÚ¡ 
UCh¬
 
m®ay®amNum”®s
[10] = {

563  
toNum”ic
(
v®ue
, 
m®ay®amNum”®s
);

565 
	gMÚgŞŸn
: {

566 cÚ¡ 
UCh¬
 
mÚgŞŸnNum”®s
[10] = {

569  
toNum”ic
(
v®ue
, 
mÚgŞŸnNum”®s
);

571 
	gMyªm¬
: {

572 cÚ¡ 
UCh¬
 
myªm¬Num”®s
[10] = {

575  
toNum”ic
(
v®ue
, 
myªm¬Num”®s
);

577 
	gOù®
: {

578 cÚ¡ 
UCh¬
 
où®Num”®s
[8] = {

581  
toNum”ic
(
v®ue
, 
où®Num”®s
);

583 
	gOriya
: {

584 cÚ¡ 
UCh¬
 
ÜiyaNum”®s
[10] = {

587  
toNum”ic
(
v®ue
, 
ÜiyaNum”®s
);

589 
	gP”sŸn
:

590 
Urdu
: {

591 cÚ¡ 
UCh¬
 
urduNum”®s
[10] = {

594  
toNum”ic
(
v®ue
, 
urduNum”®s
);

596 
	gT–ugu
: {

597 cÚ¡ 
UCh¬
 
‹luguNum”®s
[10] = {

600  
toNum”ic
(
v®ue
, 
‹luguNum”®s
);

602 
	gTib‘ª
: {

603 cÚ¡ 
UCh¬
 
tib‘ªNum”®s
[10] = {

606  
toNum”ic
(
v®ue
, 
tib‘ªNum”®s
);

608 
	gThai
: {

609 cÚ¡ 
UCh¬
 
thaiNum”®s
[10] = {

612  
toNum”ic
(
v®ue
, 
thaiNum”®s
);

614 
	gUµ”Hexadecim®
: {

615 cÚ¡ 
UCh¬
 
uµ”Hexadecim®Num”®s
[16] = {

618  
toNum”ic
(
v®ue
, 
uµ”Hexadecim®Num”®s
);

621 
	gLow”AÍha
:

622 
Low”L©š
: {

623 cÚ¡ 
UCh¬
 
low”L©šAÍhab‘
[26] = {

627  
toAÍhab‘ic
(
v®ue
, 
low”L©šAÍhab‘
);

629 
	gUµ”AÍha
:

630 
Uµ”L©š
: {

631 cÚ¡ 
UCh¬
 
uµ”L©šAÍhab‘
[26] = {

635  
toAÍhab‘ic
(
v®ue
, 
uµ”L©šAÍhab‘
);

637 
	gLow”G»ek
: {

638 cÚ¡ 
UCh¬
 
low”G»ekAÍhab‘
[24] = {

643  
toAÍhab‘ic
(
v®ue
, 
low”G»ekAÍhab‘
);

646 
	gHœagªa
: {

649 cÚ¡ 
UCh¬
 
hœagªaAÍhab‘
[48] = {

657  
toAÍhab‘ic
(
v®ue
, 
hœagªaAÍhab‘
);

659 
	gHœagªaIroha
: {

662 cÚ¡ 
UCh¬
 
hœagªaIrohaAÍhab‘
[47] = {

670  
toAÍhab‘ic
(
v®ue
, 
hœagªaIrohaAÍhab‘
);

672 
	gK©akªa
: {

675 cÚ¡ 
UCh¬
 
k©akªaAÍhab‘
[48] = {

683  
toAÍhab‘ic
(
v®ue
, 
k©akªaAÍhab‘
);

685 
	gK©akªaIroha
: {

688 cÚ¡ 
UCh¬
 
k©akªaIrohaAÍhab‘
[47] = {

696  
toAÍhab‘ic
(
v®ue
, 
k©akªaIrohaAÍhab‘
);

699 
	gAçr
:

700 
EthiİicH®ehameAaEt
:

701 
EthiİicH®ehameAaEr
: {

702 cÚ¡ 
UCh¬
 
‘hiİicH®ehameAaErAÍhab‘
[18] = {

706  
toAÍhab‘ic
(
v®ue
, 
‘hiİicH®ehameAaErAÍhab‘
);

708 
	gAmh¬ic
:

709 
EthiİicH®ehameAmEt
: {

710 cÚ¡ 
UCh¬
 
‘hiİicH®ehameAmEtAÍhab‘
[33] = {

716  
toAÍhab‘ic
(
v®ue
, 
‘hiİicH®ehameAmEtAÍhab‘
);

718 
	gAmh¬icAbegede
:

719 
EthiİicAbegedeAmEt
: {

720 cÚ¡ 
UCh¬
 
‘hiİicAbegedeAmEtAÍhab‘
[33] = {

726  
toAÍhab‘ic
(
v®ue
, 
‘hiİicAbegedeAmEtAÍhab‘
);

728 
	gCjkE¬thlyB¿nch
: {

729 cÚ¡ 
UCh¬
 
cjkE¬thlyB¿nchAÍhab‘
[12] = {

733  
toAÍhab‘ic
(
v®ue
, 
cjkE¬thlyB¿nchAÍhab‘
);

735 
	gCjkH—v’lyS‹m
: {

736 cÚ¡ 
UCh¬
 
cjkH—v’lyS‹mAÍhab‘
[10] = {

740  
toAÍhab‘ic
(
v®ue
, 
cjkH—v’lyS‹mAÍhab‘
);

742 
	gEthiİic
:

743 
EthiİicH®ehameGez
: {

744 cÚ¡ 
UCh¬
 
‘hiİicH®ehameGezAÍhab‘
[26] = {

749  
toAÍhab‘ic
(
v®ue
, 
‘hiİicH®ehameGezAÍhab‘
);

751 
	gEthiİicAbegede
:

752 
EthiİicAbegedeGez
: {

753 cÚ¡ 
UCh¬
 
‘hiİicAbegedeGezAÍhab‘
[26] = {

758  
toAÍhab‘ic
(
v®ue
, 
‘hiİicAbegedeGezAÍhab‘
);

760 
	gHªgulCÚsÚªt
: {

761 cÚ¡ 
UCh¬
 
hªgulCÚsÚªtAÍhab‘
[14] = {

765  
toAÍhab‘ic
(
v®ue
, 
hªgulCÚsÚªtAÍhab‘
);

767 
	gHªgul
: {

768 cÚ¡ 
UCh¬
 
hªgulAÍhab‘
[14] = {

772  
toAÍhab‘ic
(
v®ue
, 
hªgulAÍhab‘
);

774 
	gOromo
:

775 
EthiİicH®ehameOmEt
: {

776 cÚ¡ 
UCh¬
 
‘hiİicH®ehameOmEtAÍhab‘
[25] = {

781  
toAÍhab‘ic
(
v®ue
, 
‘hiİicH®ehameOmEtAÍhab‘
);

783 
	gSidama
:

784 
EthiİicH®ehameSidEt
: {

785 cÚ¡ 
UCh¬
 
‘hiİicH®ehameSidEtAÍhab‘
[26] = {

790  
toAÍhab‘ic
(
v®ue
, 
‘hiİicH®ehameSidEtAÍhab‘
);

792 
	gSom®i
:

793 
EthiİicH®ehameSoEt
: {

794 cÚ¡ 
UCh¬
 
‘hiİicH®ehameSoEtAÍhab‘
[22] = {

799  
toAÍhab‘ic
(
v®ue
, 
‘hiİicH®ehameSoEtAÍhab‘
);

801 
	gTig»
:

802 
EthiİicH®ehameTig
: {

803 cÚ¡ 
UCh¬
 
‘hiİicH®ehameTigAÍhab‘
[27] = {

808  
toAÍhab‘ic
(
v®ue
, 
‘hiİicH®ehameTigAÍhab‘
);

810 
	gTigršyaEr
:

811 
EthiİicH®ehameTiEr
: {

812 cÚ¡ 
UCh¬
 
‘hiİicH®ehameTiErAÍhab‘
[31] = {

818  
toAÍhab‘ic
(
v®ue
, 
‘hiİicH®ehameTiErAÍhab‘
);

820 
	gTigršyaErAbegede
:

821 
EthiİicAbegedeTiEr
: {

822 cÚ¡ 
UCh¬
 
‘hiİicAbegedeTiErAÍhab‘
[31] = {

828  
toAÍhab‘ic
(
v®ue
, 
‘hiİicAbegedeTiErAÍhab‘
);

830 
	gTigršyaEt
:

831 
EthiİicH®ehameTiEt
: {

832 cÚ¡ 
UCh¬
 
‘hiİicH®ehameTiEtAÍhab‘
[34] = {

838  
toAÍhab‘ic
(
v®ue
, 
‘hiİicH®ehameTiEtAÍhab‘
);

840 
	gTigršyaEtAbegede
:

841 
EthiİicAbegedeTiEt
: {

842 cÚ¡ 
UCh¬
 
‘hiİicAbegedeTiEtAÍhab‘
[34] = {

848  
toAÍhab‘ic
(
v®ue
, 
‘hiİicAbegedeTiEtAÍhab‘
);

850 
	gUµ”G»ek
: {

851 cÚ¡ 
UCh¬
 
uµ”G»ekAÍhab‘
[24] = {

856  
toAÍhab‘ic
(
v®ue
, 
uµ”G»ekAÍhab‘
);

858 
	gLow”NÜwegŸn
: {

859 cÚ¡ 
UCh¬
 
low”NÜwegŸnAÍhab‘
[29] = {

865  
toAÍhab‘ic
(
v®ue
, 
low”NÜwegŸnAÍhab‘
);

867 
	gUµ”NÜwegŸn
: {

868 cÚ¡ 
UCh¬
 
uµ”NÜwegŸnAÍhab‘
[29] = {

874  
toAÍhab‘ic
(
v®ue
, 
uµ”NÜwegŸnAÍhab‘
);

876 
	gCJKIdeog¿phic
: {

877 cÚ¡ 
UCh¬
 
Œad™iÚ®Chše£InfÜm®TabË
[16] = {

883  
toCJKIdeog¿phic
(
v®ue
, 
Œad™iÚ®Chše£InfÜm®TabË
);

886 
	gLow”Romª
:

887  
toRomª
(
v®ue
, 
çl£
);

888 
	gUµ”Romª
:

889  
toRomª
(
v®ue
, 
Œue
);

891 
	gArm’Ÿn
:

895  
toArm’Ÿn
(
v®ue
, 
Œue
);

896 
	gGeÜgŸn
:

897  
toGeÜgŸn
(
v®ue
);

898 
	gHeb»w
:

899  
toHeb»w
(
v®ue
);

902 
ASSERT_NOT_REACHED
();

906 
	gR’d”Li¡M¬k”
::
R’d”Li¡M¬k”
(
R’d”Li¡I‹m
* 
™em
)

907 : 
R’d”Box
(
™em
->
docum’t
())

908 , 
m_li¡I‹m
(
™em
)

911 
£tIÆše
(
Œue
);

912 
£tR•Ïûd
(
Œue
);

915 
	gR’d”Li¡M¬k”
::~
R’d”Li¡M¬k”
()

917 ià(
m_image
)

918 
m_image
->
»moveCl›Á
(
this
);

921 
	gR’d”Li¡M¬k”
::
¡yËWlChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ÃwStyË
)

923 ià(
¡yË
(è&& (
	gÃwStyË
->
li¡StyËPos™iÚ
(è!ğ¡yË()->li¡StyËPos™iÚ(è|| 
ÃwStyË
->
li¡StyËTy³
() != style()->listStyleType()))

924 
£tN“dsLayoutAndP»fWidthsReÿlc
();

926 
	gR’d”Box
::
¡yËWlChªge
(
diff
, 
ÃwStyË
);

929 
	gR’d”Li¡M¬k”
::
¡yËDidChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
)

931 
	gR’d”Box
::
¡yËDidChªge
(
diff
, 
ŞdStyË
);

933 ià(
	gm_image
 !ğ
¡yË
()->
li¡StyËImage
()) {

934 ià(
m_image
)

935 
m_image
->
»moveCl›Á
(
this
);

936 
	gm_image
 = 
¡yË
()->
li¡StyËImage
();

937 ià(
	gm_image
)

938 
	gm_image
->
addCl›Á
(
this
);

942 
IÆšeBox
* 
	gR’d”Li¡M¬k”
::
ü—‹IÆšeBox
()

944 
IÆšeBox
* 
»suÉ
 = 
R’d”Box
::
ü—‹IÆšeBox
();

945 
	g»suÉ
->
£tIsText
(
isText
());

946  
	g»suÉ
;

949 
boŞ
 
	gR’d”Li¡M¬k”
::
isImage
() const

951  
m_image
 && !m_image->
”rÜOccu¼ed
();

954 
IÁReù
 
	gR’d”Li¡M¬k”
::
loÿlS–eùiÚReù
()

956 
IÆšeBox
* 
box
 = 
šlšeBoxW¿µ”
();

957 ià(!
	gbox
)

958  
IÁReù
();

959 
RoÙIÆšeBox
* 
	groÙ
 = 
box
->
roÙ
();

960  
IÁReù
(
x
(), 
roÙ
->
£ËùiÚTİ
(è- 
y
(), 
width
(),„oÙ->
£ËùiÚHeight
());

963 
	gR’d”Li¡M¬k”
::
·št
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

965 ià(
	g·štInfo
.
	gpha£
 !ğ
PaštPha£FÜeground
)

968 ià(
¡yË
()->
visib™y
(è!ğ
VISIBLE
)

971 
IÁReù
 
	gm¬k”
 = 
g‘R–©iveM¬k”Reù
();

972 
	gm¬k”
.
move
(
tx
, 
ty
);

974 
IÁReù
 
box
(
tx
 + 
x
(), 
ty
 + 
y
(), 
width
(), 
height
());

976 ià(
	gbox
.
y
(è> 
	g·štInfo
.
	g»ù
.
bÙtom
(è|| box.y(è+ box.
height
() <…aintInfo.rect.y())

979 ià(
hasBoxDecÜ©iÚs
())

980 
·štBoxDecÜ©iÚs
(
·štInfo
, 
box
.
x
(), box.
y
());

982 
G¿phicsCÚ‹xt
* 
	gcÚ‹xt
 = 
·štInfo
.
cÚ‹xt
;

984 ià(
isImage
()) {

985 #ià
PLATFORM
(
MAC
)

986 ià(
¡yË
()->
highlight
(è!ğ
nuÎAtom
 && !
·štInfo
.
cÚ‹xt
->
·štšgDi§bËd
())

987 
·štCu¡omHighlight
(
tx
, 
ty
, 
¡yË
()->
highlight
(), 
Œue
);

989 
	gcÚ‹xt
->
d¿wImage
(
m_image
->
image
(
this
, 
m¬k”
.
size
()), 
¡yË
()->
cŞÜS·û
(), m¬k”.
loÿtiÚ
());

990 ià(
£ËùiÚS‹
(è!ğ
S–eùiÚNÚe
) {

991 
IÁReù
 
£lReù
 = 
loÿlS–eùiÚReù
();

992 
	g£lReù
.
move
(
tx
, 
ty
);

993 
	gcÚ‹xt
->
flReù
(
£lReù
, 
£ËùiÚBackgroundCŞÜ
(), 
¡yË
()->
cŞÜS·û
());

998 #ià
PLATFORM
(
MAC
)

1000 ià(
¡yË
()->
highlight
(è!ğ
nuÎAtom
 && !
·štInfo
.
cÚ‹xt
->
·štšgDi§bËd
())

1001 
·štCu¡omHighlight
(
tx
, 
ty
, 
¡yË
()->
highlight
(), 
Œue
);

1004 ià(
£ËùiÚS‹
(è!ğ
S–eùiÚNÚe
) {

1005 
IÁReù
 
£lReù
 = 
loÿlS–eùiÚReù
();

1006 
	g£lReù
.
move
(
tx
, 
ty
);

1007 
	gcÚ‹xt
->
flReù
(
£lReù
, 
£ËùiÚBackgroundCŞÜ
(), 
¡yË
()->
cŞÜS·û
());

1010 cÚ¡ 
CŞÜ
 
cŞÜ
(
¡yË
()->color());

1011 
	gcÚ‹xt
->
£tSŒokeCŞÜ
(
cŞÜ
, 
¡yË
()->
cŞÜS·û
());

1012 
	gcÚ‹xt
->
£tSŒokeStyË
(
SŞidSŒoke
);

1013 
	gcÚ‹xt
->
£tSŒokeThickÃss
(1.0f);

1014 
	gcÚ‹xt
->
£tFlCŞÜ
(
cŞÜ
, 
¡yË
()->
cŞÜS·û
());

1016 
ELi¡StyËTy³
 
	gty³
 = 
¡yË
()->
li¡StyËTy³
();

1017 
	gty³
) {

1018 
	gDisc
:

1019 
cÚ‹xt
->
d¿wEÎ£
(
m¬k”
);

1021 
	gCœşe
:

1022 
cÚ‹xt
->
£tFlCŞÜ
(
CŞÜ
::
Œª¥¬’t
, 
DeviûCŞÜS·û
);

1023 
	gcÚ‹xt
->
d¿wEÎ£
(
m¬k”
);

1025 
	gSqu¬e
:

1026 
cÚ‹xt
->
d¿wReù
(
m¬k”
);

1028 
	gNÚeLi¡StyË
:

1030 
	gAçr
:

1031 
Amh¬ic
:

1032 
Amh¬icAbegede
:

1033 
A¿bicIndic
:

1034 
Arm’Ÿn
:

1035 
Bš¬yLi¡StyË
:

1036 
B’g®i
:

1037 
CambodŸn
:

1038 
CJKIdeog¿phic
:

1039 
CjkE¬thlyB¿nch
:

1040 
CjkH—v’lyS‹m
:

1041 
Decim®L—dšgZ”o
:

1042 
Decim®Li¡StyË
:

1043 
Devªag¬i
:

1044 
Ethiİic
:

1045 
EthiİicAbegede
:

1046 
EthiİicAbegedeAmEt
:

1047 
EthiİicAbegedeGez
:

1048 
EthiİicAbegedeTiEr
:

1049 
EthiİicAbegedeTiEt
:

1050 
EthiİicH®ehameAaEr
:

1051 
EthiİicH®ehameAaEt
:

1052 
EthiİicH®ehameAmEt
:

1053 
EthiİicH®ehameGez
:

1054 
EthiİicH®ehameOmEt
:

1055 
EthiİicH®ehameSidEt
:

1056 
EthiİicH®ehameSoEt
:

1057 
EthiİicH®ehameTiEr
:

1058 
EthiİicH®ehameTiEt
:

1059 
EthiİicH®ehameTig
:

1060 
GeÜgŸn
:

1061 
Guj¬©i
:

1062 
Gurmukhi
:

1063 
Hªgul
:

1064 
HªgulCÚsÚªt
:

1065 
Heb»w
:

1066 
Hœagªa
:

1067 
HœagªaIroha
:

1068 
KªÇda
:

1069 
K©akªa
:

1070 
K©akªaIroha
:

1071 
Khm”
:

1072 
Lao
:

1073 
Low”AÍha
:

1074 
Low”G»ek
:

1075 
Low”Hexadecim®
:

1076 
Low”L©š
:

1077 
Low”NÜwegŸn
:

1078 
Low”Romª
:

1079 
M®ay®am
:

1080 
MÚgŞŸn
:

1081 
Myªm¬
:

1082 
Où®
:

1083 
Oriya
:

1084 
Oromo
:

1085 
P”sŸn
:

1086 
Sidama
:

1087 
Som®i
:

1088 
T–ugu
:

1089 
Thai
:

1090 
Tib‘ª
:

1091 
Tig»
:

1092 
TigršyaEr
:

1093 
TigršyaErAbegede
:

1094 
TigršyaEt
:

1095 
TigršyaEtAbegede
:

1096 
Uµ”AÍha
:

1097 
Uµ”G»ek
:

1098 
Uµ”Hexadecim®
:

1099 
Uµ”L©š
:

1100 
Uµ”NÜwegŸn
:

1101 
Uµ”Romª
:

1102 
Urdu
:

1105 ià(
	gm_‹xt
.
isEm±y
())

1108 
TextRun
 
‹xtRun
(
m_‹xt
);

1112 
boŞ
 
	g‹xtN“dsRev”sšg
 = 
dœeùiÚ
(
m_‹xt
[0]è=ğ
RightToLeá
;

1113 
	gVeùÜ
<
	gUCh¬
> 
	g»v”£dText
;

1114 ià(
	g‹xtN“dsRev”sšg
) {

1115 
	gËngth
 = 
m_‹xt
.
Ëngth
();

1116 
	g»v”£dText
.
grow
(
Ëngth
);

1117 
	gi
 = 0; i < 
	gËngth
; ++i)

1118 
	g»v”£dText
[
Ëngth
 - 
i
 - 1] = 
m_‹xt
[i];

1119 
	g‹xtRun
 = 
TextRun
(
»v”£dText
.
d©a
(), 
Ëngth
);

1122 cÚ¡ 
	gFÚt
& 
	gfÚt
 = 
¡yË
()->
fÚt
();

1123 cÚ¡ 
UCh¬
 
	gsuffix
 = 
li¡M¬k”Suffix
(
ty³
);

1124 ià(
¡yË
()->
dœeùiÚ
(è=ğ
LTR
) {

1125 
width
 = 
fÚt
.width(
‹xtRun
);

1126 
	gcÚ‹xt
->
d¿wText
(
¡yË
()->
fÚt
(), 
‹xtRun
, 
m¬k”
.
loÿtiÚ
());

1127 
UCh¬
 
	gsuffixS·û
[2] = { 
suffix
, ' ' };

1128 
	gcÚ‹xt
->
d¿wText
(
¡yË
()->
fÚt
(), 
TextRun
(
suffixS·û
, 2), 
m¬k”
.
loÿtiÚ
(è+ 
IÁSize
(
width
, 0));

1130 
UCh¬
 
	g¥aûSuffix
[2] = { ' ', 
suffix
 };

1131 
TextRun
 
¥aûSuffixRun
(
¥aûSuffix
, 2);

1132 
	gwidth
 = 
fÚt
.
width
(
¥aûSuffixRun
);

1133 
	gcÚ‹xt
->
d¿wText
(
¡yË
()->
fÚt
(), 
¥aûSuffixRun
, 
m¬k”
.
loÿtiÚ
());

1134 
	gcÚ‹xt
->
d¿wText
(
¡yË
()->
fÚt
(), 
‹xtRun
, 
m¬k”
.
loÿtiÚ
(è+ 
IÁSize
(
width
, 0));

1138 
	gR’d”Li¡M¬k”
::
Ïyout
()

1140 
ASSERT
(
ÃedsLayout
());

1141 
ASSERT
(!
´efWidthsDœty
());

1143 ià(
isImage
()) {

1144 
£tWidth
(
m_image
->
imageSize
(
this
, 
¡yË
()->
efãùiveZoom
()).
width
());

1145 
£tHeight
(
m_image
->
imageSize
(
this
, 
¡yË
()->
efãùiveZoom
()).
height
());

1147 
£tWidth
(
mšP»fWidth
());

1148 
£tHeight
(
¡yË
()->
fÚt
().
height
());

1151 
	gm_m¬gšLeá
 = 
m_m¬gšRight
 = 0;

1153 
L’gth
 
	gËáM¬gš
 = 
¡yË
()->
m¬gšLeá
();

1154 
L’gth
 
	grightM¬gš
 = 
¡yË
()->
m¬gšRight
();

1155 ià(
	gËáM¬gš
.
isFixed
())

1156 
	gm_m¬gšLeá
 = 
ËáM¬gš
.
v®ue
();

1157 ià(
	grightM¬gš
.
isFixed
())

1158 
	gm_m¬gšRight
 = 
rightM¬gš
.
v®ue
();

1160 
£tN“dsLayout
(
çl£
);

1163 
	gR’d”Li¡M¬k”
::
imageChªged
(
W¿µedImagePŒ
 
o
, cÚ¡ 
IÁReù
*)

1166 ià(
	go
 !ğ
m_image
->
d©a
())

1169 ià(
width
(è!ğ
m_image
->
imageSize
(
this
, 
¡yË
()->
efãùiveZoom
()).width(è|| 
height
(è!ğm_image->imageSizeÑhis, styË()->efãùiveZoom()).height(è|| 
	gm_image
->
”rÜOccu¼ed
())

1170 
£tN“dsLayoutAndP»fWidthsReÿlc
();

1172 
»·št
();

1175 
	gR’d”Li¡M¬k”
::
ÿlcP»fWidths
()

1177 
ASSERT
(
´efWidthsDœty
());

1179 
	gm_‹xt
 = "";

1181 cÚ¡ 
	gFÚt
& 
	gfÚt
 = 
¡yË
()->
fÚt
();

1183 ià(
isImage
()) {

1186 
	gbuÎ‘Width
 = 
fÚt
.
asûÁ
() / 2;

1187 
	gm_image
->
£tImageCÚš”Size
(
IÁSize
(
buÎ‘Width
, bulletWidth));

1188 
	gm_mšP»fWidth
 = 
m_maxP»fWidth
 = 
m_image
->
imageSize
(
this
, 
¡yË
()->
efãùiveZoom
()).
width
();

1189 
£tP»fWidthsDœty
(
çl£
);

1190 
upd©eM¬gšs
();

1194 
	gwidth
 = 0;

1195 
ELi¡StyËTy³
 
	gty³
 = 
¡yË
()->
li¡StyËTy³
();

1196 
	gty³
) {

1197 
	gNÚeLi¡StyË
:

1199 
	gCœşe
:

1200 
Disc
:

1201 
Squ¬e
:

1202 
m_‹xt
 = 
li¡M¬k”Text
(
ty³
, 0);

1203 
	gwidth
 = (
fÚt
.
asûÁ
() * 2 / 3 + 1) / 2 + 2;

1205 
	gAçr
:

1206 
Amh¬ic
:

1207 
Amh¬icAbegede
:

1208 
A¿bicIndic
:

1209 
Arm’Ÿn
:

1210 
Bš¬yLi¡StyË
:

1211 
B’g®i
:

1212 
CambodŸn
:

1213 
CJKIdeog¿phic
:

1214 
CjkE¬thlyB¿nch
:

1215 
CjkH—v’lyS‹m
:

1216 
Decim®L—dšgZ”o
:

1217 
Decim®Li¡StyË
:

1218 
Devªag¬i
:

1219 
Ethiİic
:

1220 
EthiİicAbegede
:

1221 
EthiİicAbegedeAmEt
:

1222 
EthiİicAbegedeGez
:

1223 
EthiİicAbegedeTiEr
:

1224 
EthiİicAbegedeTiEt
:

1225 
EthiİicH®ehameAaEr
:

1226 
EthiİicH®ehameAaEt
:

1227 
EthiİicH®ehameAmEt
:

1228 
EthiİicH®ehameGez
:

1229 
EthiİicH®ehameOmEt
:

1230 
EthiİicH®ehameSidEt
:

1231 
EthiİicH®ehameSoEt
:

1232 
EthiİicH®ehameTiEr
:

1233 
EthiİicH®ehameTiEt
:

1234 
EthiİicH®ehameTig
:

1235 
GeÜgŸn
:

1236 
Guj¬©i
:

1237 
Gurmukhi
:

1238 
Hªgul
:

1239 
HªgulCÚsÚªt
:

1240 
Heb»w
:

1241 
Hœagªa
:

1242 
HœagªaIroha
:

1243 
KªÇda
:

1244 
K©akªa
:

1245 
K©akªaIroha
:

1246 
Khm”
:

1247 
Lao
:

1248 
Low”AÍha
:

1249 
Low”G»ek
:

1250 
Low”Hexadecim®
:

1251 
Low”L©š
:

1252 
Low”NÜwegŸn
:

1253 
Low”Romª
:

1254 
M®ay®am
:

1255 
MÚgŞŸn
:

1256 
Myªm¬
:

1257 
Où®
:

1258 
Oriya
:

1259 
Oromo
:

1260 
P”sŸn
:

1261 
Sidama
:

1262 
Som®i
:

1263 
T–ugu
:

1264 
Thai
:

1265 
Tib‘ª
:

1266 
Tig»
:

1267 
TigršyaEr
:

1268 
TigršyaErAbegede
:

1269 
TigršyaEt
:

1270 
TigršyaEtAbegede
:

1271 
Uµ”AÍha
:

1272 
Uµ”G»ek
:

1273 
Uµ”Hexadecim®
:

1274 
Uµ”L©š
:

1275 
Uµ”NÜwegŸn
:

1276 
Uµ”Romª
:

1277 
Urdu
:

1278 
m_‹xt
 = 
li¡M¬k”Text
(
ty³
, 
m_li¡I‹m
->
v®ue
());

1279 ià(
	gm_‹xt
.
isEm±y
())

1280 
	gwidth
 = 0;

1282 
	g™emWidth
 = 
fÚt
.
width
(
m_‹xt
);

1283 
UCh¬
 
	gsuffixS·û
[2] = { 
li¡M¬k”Suffix
(
ty³
), ' ' };

1284 
	gsuffixS·ûWidth
 = 
fÚt
.
width
(
TextRun
(
suffixS·û
, 2));

1285 
	gwidth
 = 
™emWidth
 + 
suffixS·ûWidth
;

1290 
	gm_mšP»fWidth
 = 
width
;

1291 
	gm_maxP»fWidth
 = 
width
;

1293 
£tP»fWidthsDœty
(
çl£
);

1295 
upd©eM¬gšs
();

1298 
	gR’d”Li¡M¬k”
::
upd©eM¬gšs
()

1300 cÚ¡ 
FÚt
& 
fÚt
 = 
¡yË
()->font();

1302 
	gm¬gšLeá
 = 0;

1303 
	gm¬gšRight
 = 0;

1305 ià(
isInside
()) {

1306 ià(
isImage
()) {

1307 ià(
¡yË
()->
dœeùiÚ
(è=ğ
LTR
)

1308 
m¬gšRight
 = 
cM¬k”Paddšg
;

1310 
	gm¬gšLeá
 = 
cM¬k”Paddšg
;

1311 } 
¡yË
()->
li¡StyËTy³
()) {

1312 
	gDisc
:

1313 
Cœşe
:

1314 
Squ¬e
:

1315 ià(
¡yË
()->
dœeùiÚ
(è=ğ
LTR
) {

1316 
m¬gšLeá
 = -1;

1317 
	gm¬gšRight
 = 
fÚt
.
asûÁ
(è- 
mšP»fWidth
() + 1;

1319 
	gm¬gšLeá
 = 
fÚt
.
asûÁ
(è- 
mšP»fWidth
() + 1;

1320 
	gm¬gšRight
 = -1;

1327 ià(
¡yË
()->
dœeùiÚ
(è=ğ
LTR
) {

1328 ià(
isImage
())

1329 
m¬gšLeá
 = -
mšP»fWidth
(è- 
cM¬k”Paddšg
;

1331 
	goff£t
 = 
fÚt
.
asûÁ
() * 2 / 3;

1332 
¡yË
()->
li¡StyËTy³
()) {

1333 
	gDisc
:

1334 
Cœşe
:

1335 
Squ¬e
:

1336 
m¬gšLeá
 = -
off£t
 - 
cM¬k”Paddšg
 - 1;

1338 
	gNÚeLi¡StyË
:

1341 
m¬gšLeá
 = 
m_‹xt
.
isEm±y
(è? 0 : -
mšP»fWidth
(è- 
off£t
 / 2;

1345 ià(
isImage
())

1346 
	gm¬gšLeá
 = 
cM¬k”Paddšg
;

1348 
	goff£t
 = 
fÚt
.
asûÁ
() * 2 / 3;

1349 
¡yË
()->
li¡StyËTy³
()) {

1350 
	gDisc
:

1351 
Cœşe
:

1352 
Squ¬e
:

1353 
m¬gšLeá
 = 
off£t
 + 
cM¬k”Paddšg
 + 1 - 
mšP»fWidth
();

1355 
	gNÚeLi¡StyË
:

1358 
m¬gšLeá
 = 
m_‹xt
.
isEm±y
(è? 0 : 
off£t
 / 2;

1362 
	gm¬gšRight
 = -
m¬gšLeá
 - 
mšP»fWidth
();

1365 
¡yË
()->
£tM¬gšLeá
(
L’gth
(
m¬gšLeá
, 
Fixed
));

1366 
¡yË
()->
£tM¬gšRight
(
L’gth
(
m¬gšRight
, 
Fixed
));

1369 
	gR’d”Li¡M¬k”
::
lšeHeight
(
boŞ
, bool) const

1371 ià(!
isImage
())

1372  
	gm_li¡I‹m
->
lšeHeight
(
çl£
, 
Œue
);

1373  
height
();

1376 
	gR’d”Li¡M¬k”
::
ba£lšePos™iÚ
(
boŞ
, bool) const

1378 ià(!
isImage
()) {

1379 cÚ¡ 
	gFÚt
& 
	gfÚt
 = 
¡yË
()->
fÚt
();

1380  
	gfÚt
.
asûÁ
(è+ (
lšeHeight
(
çl£
è- fÚt.
height
())/2;

1382  
height
();

1385 
boŞ
 
	gR’d”Li¡M¬k”
::
isInside
() const

1387  
m_li¡I‹m
->
nÙInLi¡
(è|| 
¡yË
()->
li¡StyËPos™iÚ
(è=ğ
INSIDE
;

1390 
IÁReù
 
	gR’d”Li¡M¬k”
::
g‘R–©iveM¬k”Reù
()

1392 ià(
isImage
())

1393  
IÁReù
(
x
(), 
y
(), 
m_image
->
imageSize
(
this
, 
¡yË
()->
efãùiveZoom
()).
width
(), m_image->imageSizeÑhis, styË()->efãùiveZoom()).
height
());

1395 
ELi¡StyËTy³
 
	gty³
 = 
¡yË
()->
li¡StyËTy³
();

1396 
	gty³
) {

1397 
	gDisc
:

1398 
Cœşe
:

1399 
Squ¬e
: {

1401 cÚ¡ 
FÚt
& 
fÚt
 = 
¡yË
()->font();

1402 
	gasûÁ
 = 
fÚt
.
asûÁ
();

1403 
	gbuÎ‘Width
 = (
asûÁ
 * 2 / 3 + 1) / 2;

1404  
IÁReù
(
x
(è+ 1, 
y
(è+ 3 * (
asûÁ
 -‡sûÁ * 2 / 3è/ 2, 
buÎ‘Width
, bulletWidth);

1406 
	gNÚeLi¡StyË
:

1407  
IÁReù
();

1408 
	gAçr
:

1409 
Amh¬ic
:

1410 
Amh¬icAbegede
:

1411 
A¿bicIndic
:

1412 
Arm’Ÿn
:

1413 
Bš¬yLi¡StyË
:

1414 
B’g®i
:

1415 
CambodŸn
:

1416 
CJKIdeog¿phic
:

1417 
CjkE¬thlyB¿nch
:

1418 
CjkH—v’lyS‹m
:

1419 
Decim®L—dšgZ”o
:

1420 
Decim®Li¡StyË
:

1421 
Devªag¬i
:

1422 
Ethiİic
:

1423 
EthiİicAbegede
:

1424 
EthiİicAbegedeAmEt
:

1425 
EthiİicAbegedeGez
:

1426 
EthiİicAbegedeTiEr
:

1427 
EthiİicAbegedeTiEt
:

1428 
EthiİicH®ehameAaEr
:

1429 
EthiİicH®ehameAaEt
:

1430 
EthiİicH®ehameAmEt
:

1431 
EthiİicH®ehameGez
:

1432 
EthiİicH®ehameOmEt
:

1433 
EthiİicH®ehameSidEt
:

1434 
EthiİicH®ehameSoEt
:

1435 
EthiİicH®ehameTiEr
:

1436 
EthiİicH®ehameTiEt
:

1437 
EthiİicH®ehameTig
:

1438 
GeÜgŸn
:

1439 
Guj¬©i
:

1440 
Gurmukhi
:

1441 
Hªgul
:

1442 
HªgulCÚsÚªt
:

1443 
Heb»w
:

1444 
Hœagªa
:

1445 
HœagªaIroha
:

1446 
KªÇda
:

1447 
K©akªa
:

1448 
K©akªaIroha
:

1449 
Khm”
:

1450 
Lao
:

1451 
Low”AÍha
:

1452 
Low”G»ek
:

1453 
Low”Hexadecim®
:

1454 
Low”L©š
:

1455 
Low”NÜwegŸn
:

1456 
Low”Romª
:

1457 
M®ay®am
:

1458 
MÚgŞŸn
:

1459 
Myªm¬
:

1460 
Où®
:

1461 
Oriya
:

1462 
Oromo
:

1463 
P”sŸn
:

1464 
Sidama
:

1465 
Som®i
:

1466 
T–ugu
:

1467 
Thai
:

1468 
Tib‘ª
:

1469 
Tig»
:

1470 
TigršyaEr
:

1471 
TigršyaErAbegede
:

1472 
TigršyaEt
:

1473 
TigršyaEtAbegede
:

1474 
Uµ”AÍha
:

1475 
Uµ”G»ek
:

1476 
Uµ”Hexadecim®
:

1477 
Uµ”L©š
:

1478 
Uµ”NÜwegŸn
:

1479 
Uµ”Romª
:

1480 
Urdu
:

1481 ià(
m_‹xt
.
isEm±y
())

1482  
IÁReù
();

1483 cÚ¡ 
	gFÚt
& 
	gfÚt
 = 
¡yË
()->
fÚt
();

1484 
	g™emWidth
 = 
fÚt
.
width
(
m_‹xt
);

1485 
UCh¬
 
	gsuffixS·û
[2] = { 
li¡M¬k”Suffix
(
ty³
), ' ' };

1486 
	gsuffixS·ûWidth
 = 
fÚt
.
width
(
TextRun
(
suffixS·û
, 2));

1487  
IÁReù
(
x
(), 
y
(è+ 
fÚt
.
asûÁ
(), 
™emWidth
 + 
suffixS·ûWidth
, fÚt.
height
());

1490  
IÁReù
();

1493 
	gR’d”Li¡M¬k”
::
£tS–eùiÚS‹
(
S–eùiÚS‹
 
¡©e
)

1495 
R’d”Box
::
£tS–eùiÚS‹
(
¡©e
);

1496 ià(
IÆšeBox
* 
	gbox
 = 
šlšeBoxW¿µ”
())

1497 ià(
RoÙIÆšeBox
* 
roÙ
 = 
box
->root())

1498 
roÙ
->
£tHasS–eùedChd»n
(
¡©e
 !ğ
S–eùiÚNÚe
);

1499 
cÚššgBlock
()->
£tS–eùiÚS‹
(
¡©e
);

1502 
IÁReù
 
	gR’d”Li¡M¬k”
::
£ËùiÚReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
boŞ
 
şToVisibËCÚ‹Á
)

1504 
ASSERT
(!
ÃedsLayout
());

1506 ià(
£ËùiÚS‹
(è=ğ
S–eùiÚNÚe
 || !
šlšeBoxW¿µ”
())

1507  
IÁReù
();

1509 
RoÙIÆšeBox
* 
	groÙ
 = 
šlšeBoxW¿µ”
()->
roÙ
();

1510 
IÁReù
 
»ù
(0, 
roÙ
->
£ËùiÚTİ
(è- 
y
(), 
width
(),„oÙ->
£ËùiÚHeight
());

1512 ià(
	gşToVisibËCÚ‹Á
)

1513 
compu‹ReùFÜR•ašt
(
»·štCÚš”
, 
»ù
);

1515 
	g»ù
 = 
loÿlToCÚš”Quad
(
FlßtReù
(
»ù
), 
»·štCÚš”
).
’şosšgBoundšgBox
();

1517  
	g»ù
;

	@RenderListMarker.h

23 #iâdeà
R’d”Li¡M¬k”_h


24 
	#R’d”Li¡M¬k”_h


	)

26 
	~"R’d”Box.h
"

28 
Çme¥aû
 
	gWebCÜe
 {

30 
şass
 
	gR’d”Li¡I‹m
;

32 
SŒšg
 
li¡M¬k”Text
(
ELi¡StyËTy³
, 
v®ue
);

36 şas 
	cR’d”Li¡M¬k”
 : 
public
 
R’d”Box
 {

37 
public
:

38 
R’d”Li¡M¬k”
(
R’d”Li¡I‹m
*);

39 
	gvœtu®
 ~
R’d”Li¡M¬k”
();

41 
vœtu®
 
ÿlcP»fWidths
();

43 cÚ¡ 
	gSŒšg
& 
‹xt
(ècÚ¡ {  
	gm_‹xt
; }

45 
boŞ
 
isInside
() const;

47 
	g´iv©e
:

48 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderListMarker"; }

50 
vœtu®
 
boŞ
 
isLi¡M¬k”
(ècÚ¡ {  
	gŒue
; }

52 
vœtu®
 
·št
(
PaštInfo
&, 
tx
, 
ty
);

54 
vœtu®
 
Ïyout
();

56 
vœtu®
 
imageChªged
(
W¿µedImagePŒ
, cÚ¡ 
IÁReù
* = 0);

58 
vœtu®
 
IÆšeBox
* 
ü—‹IÆšeBox
();

60 
vœtu®
 
lšeHeight
(
boŞ
 
fœ¡Lše
, boŞ 
isRoÙLšeBox
 = 
çl£
) const;

61 
vœtu®
 
ba£lšePos™iÚ
(
boŞ
 
fœ¡Lše
, boŞ 
isRoÙLšeBox
 = 
çl£
) const;

63 
boŞ
 
isImage
() const;

64 
boŞ
 
isText
(ècÚ¡ {  !
isImage
(); }

66 
vœtu®
 
£tS–eùiÚS‹
(
S–eùiÚS‹
);

67 
vœtu®
 
IÁReù
 
£ËùiÚReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
boŞ
 
şToVisibËCÚ‹Á
 = 
Œue
);

68 
vœtu®
 
boŞ
 
ÿnBeS–eùiÚL—f
(ècÚ¡ {  
	gŒue
; }

70 
upd©eM¬gšs
();

72 
vœtu®
 
¡yËWlChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
* 
ÃwStyË
);

73 
vœtu®
 
¡yËDidChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
);

75 
IÁReù
 
g‘R–©iveM¬k”Reù
();

76 
IÁReù
 
loÿlS–eùiÚReù
();

78 
SŒšg
 
	gm_‹xt
;

79 
	gRefPŒ
<
	gStyËImage
> 
	gm_image
;

80 
R’d”Li¡I‹m
* 
	gm_li¡I‹m
;

83 
šlše
 
R’d”Li¡M¬k”
* 
	$toR’d”Li¡M¬k”
(
R’d”Objeù
* 
objeù
)

85 
	`ASSERT
(!
objeù
 || objeù->
	`isLi¡M¬k”
());

86  
¡©ic_ÿ¡
<
R’d”Li¡M¬k”
*>(
objeù
);

87 
	}
}

89 
šlše
 cÚ¡ 
R’d”Li¡M¬k”
* 
	$toR’d”Li¡M¬k”
(cÚ¡ 
R’d”Objeù
* 
objeù
)

91 
	`ASSERT
(!
objeù
 || objeù->
	`isLi¡M¬k”
());

92  
¡©ic_ÿ¡
<cÚ¡ 
R’d”Li¡M¬k”
*>(
objeù
);

93 
	}
}

96 
toR’d”Li¡M¬k”
(cÚ¡ 
R’d”Li¡M¬k”
*);

	@RenderMarquee.cpp

45 
	~"cÚfig.h
"

47 
	~"R’d”M¬qu“.h
"

49 
	~"F¿meV›w.h
"

50 
	~"HTMLM¬qu“EËm’t.h
"

51 
	~"HTMLNames.h
"

52 
	~"R’d”Lay”.h
"

54 
usšg
 
Çme¥aû
 
	g¡d
;

56 
Çme¥aû
 
	gWebCÜe
 {

58 
usšg
 
Çme¥aû
 
	gHTMLNames
;

60 
	gR’d”M¬qu“
::
R’d”M¬qu“
(
R’d”Lay”
* 
l
)

61 : 
m_Ïy”
(
l
), 
m_cu¼’tLoİ
(0)

62 , 
m_tÙ®Loİs
(0)

63 , 
m_tim”
(
this
, &
R’d”M¬qu“
::
tim”Fœed
)

64 , 
m_¡¬t
(0), 
m_’d
(0), 
m_¥“d
(0), 
m_»£t
(
çl£
)

65 , 
m_su¥’ded
(
çl£
), 
m_¡İ³d
(çl£), 
m_dœeùiÚ
(
MAUTO
)

69 
	gR’d”M¬qu“
::
m¬qu“S³ed
() const

71 
»suÉ
 = 
m_Ïy”
->
»nd””
()->
¡yË
()->
m¬qu“S³ed
();

72 
Node
* 
	gn
 = 
m_Ïy”
->
»nd””
()->
node
();

73 ià(
	gn
 &&‚->
hasTagName
(
m¬qu“Tag
)) {

74 
HTMLM¬qu“EËm’t
* 
	gm¬qu“EÉ
 = 
¡©ic_ÿ¡
<HTMLM¬qu“EËm’t*>(
n
);

75 
	g»suÉ
 = 
max
(
»suÉ
, 
m¬qu“EÉ
->
mšimumD–ay
());

77  
	g»suÉ
;

80 
EM¬qu“DœeùiÚ
 
	gR’d”M¬qu“
::
dœeùiÚ
() const

84 
EM¬qu“DœeùiÚ
 
»suÉ
 = 
m_Ïy”
->
»nd””
()->
¡yË
()->
m¬qu“DœeùiÚ
();

85 
TextDœeùiÚ
 
	gdœ
 = 
m_Ïy”
->
»nd””
()->
¡yË
()->
dœeùiÚ
();

86 ià(
	g»suÉ
 =ğ
MAUTO
)

87 
»suÉ
 = 
MBACKWARD
;

88 ià(
	g»suÉ
 =ğ
MFORWARD
)

89 
»suÉ
 = (
dœ
 =ğ
LTR
è? 
MRIGHT
 : 
MLEFT
;

90 ià(
	g»suÉ
 =ğ
MBACKWARD
)

91 
»suÉ
 = (
dœ
 =ğ
LTR
è? 
MLEFT
 : 
MRIGHT
;

95 
L’gth
 
	gšüem’t
 = 
m_Ïy”
->
»nd””
()->
¡yË
()->
m¬qu“Inüem’t
();

96 ià(
	gšüem’t
.
isNeg©ive
())

97 
	g»suÉ
 = 
¡©ic_ÿ¡
<
EM¬qu“DœeùiÚ
>(-
»suÉ
);

99  
	g»suÉ
;

102 
boŞ
 
	gR’d”M¬qu“
::
isHÜizÚl
() const

104  
dœeùiÚ
(è=ğ
MLEFT
 || dœeùiÚ(è=ğ
MRIGHT
;

107 
	gR’d”M¬qu“
::
compu‹Pos™iÚ
(
EM¬qu“DœeùiÚ
 
dœ
, 
boŞ
 
¡İAtCÚ‹ÁEdge
)

109 
R’d”Box
* 
	gbox
 = 
m_Ïy”
->
»nd”Box
();

110 
ASSERT
(
box
);

111 
R’d”StyË
* 
	gs
 = 
box
->
¡yË
();

112 ià(
isHÜizÚl
()) {

113 
boŞ
 
	gÉr
 = 
s
->
dœeùiÚ
(è=ğ
LTR
;

114 
	gş›ÁWidth
 = 
box
->
ş›ÁWidth
();

115 
	gcÚ‹ÁWidth
 = 
Ér
 ? 
box
->
rightmo¡Pos™iÚ
(
Œue
, 
çl£
è: box->
Ëámo¡Pos™iÚ
(true, false);

116 ià(
	gÉr
)

117 
	gcÚ‹ÁWidth
 +ğ(
box
->
·ddšgRight
(è- box->
bÜd”Leá
());

119 
	gcÚ‹ÁWidth
 = 
box
->
width
(è- 
cÚ‹ÁWidth
;

120 
	gcÚ‹ÁWidth
 +ğ(
box
->
·ddšgLeá
(è- box->
bÜd”Right
());

122 ià(
	gdœ
 =ğ
MRIGHT
) {

123 ià(
¡İAtCÚ‹ÁEdge
)

124  
max
(0, 
Ér
 ? (
cÚ‹ÁWidth
 - 
ş›ÁWidth
) : (clientWidth - contentWidth));

126  
	gÉr
 ? 
	gcÚ‹ÁWidth
 : 
ş›ÁWidth
;

129 ià(
	g¡İAtCÚ‹ÁEdge
)

130  
mš
(0, 
Ér
 ? (
cÚ‹ÁWidth
 - 
ş›ÁWidth
) : (clientWidth - contentWidth));

132  
	gÉr
 ? -
	gş›ÁWidth
 : -
cÚ‹ÁWidth
;

136 
	gcÚ‹ÁHeight
 = 
box
->
lowe¡Pos™iÚ
(
Œue
, 
çl£
) -

137 
	gbox
->
bÜd”Tİ
(è+ box->
·ddšgBÙtom
();

138 
	gş›ÁHeight
 = 
box
->
ş›ÁHeight
();

139 ià(
	gdœ
 =ğ
MUP
) {

140 ià(
¡İAtCÚ‹ÁEdge
)

141  
mš
(
cÚ‹ÁHeight
 - 
ş›ÁHeight
, 0);

143  -
	gş›ÁHeight
;

146 ià(
	g¡İAtCÚ‹ÁEdge
)

147  
max
(
cÚ‹ÁHeight
 - 
ş›ÁHeight
, 0);

149  
	gcÚ‹ÁHeight
;

154 
	gR’d”M¬qu“
::
¡¬t
()

156 ià(
m_tim”
.
isAùive
(è|| 
m_Ïy”
->
»nd””
()->
¡yË
()->
m¬qu“Inüem’t
().
isZ”o
()

157 #ià
ENABLE
(
WCSS
è&& ENABLE(
XHTMLMP
)

158 || (
m_Ïy”
->
»nd””
()->
docum’t
()->
isXHTMLMPDocum’t
(è&& !m_Ïy”->»nd””()->
¡yË
()->
m¬qu“LoİCouÁ
())

165 
F¿meV›w
* 
	gäameV›w
 = 
m_Ïy”
->
»nd””
()->
docum’t
()->
v›w
();

166 ià(
	gäameV›w
)

167 
	gäameV›w
->
·u£ScheduËdEv’ts
();

169 ià(!
	gm_su¥’ded
 && !
	gm_¡İ³d
) {

170 ià(
isHÜizÚl
())

171 
	gm_Ïy”
->
süŞlToOff£t
(
m_¡¬t
, 0, 
çl£
, false);

173 
	gm_Ïy”
->
süŞlToOff£t
(0, 
m_¡¬t
, 
çl£
, false);

176 
	gm_su¥’ded
 = 
çl£
;

177 
	gm_¡İ³d
 = 
çl£
;

180 
	gm_tim”
.
¡¬tR•—tšg
(
¥“d
() * 0.001);

182 ià(
	gäameV›w
)

183 
	gäameV›w
->
»sumeScheduËdEv’ts
();

186 
	gR’d”M¬qu“
::
su¥’d
()

188 
m_tim”
.
¡İ
();

189 
	gm_su¥’ded
 = 
Œue
;

192 
	gR’d”M¬qu“
::
¡İ
()

194 
m_tim”
.
¡İ
();

195 
	gm_¡İ³d
 = 
Œue
;

198 
	gR’d”M¬qu“
::
upd©eM¬qu“Pos™iÚ
()

200 
boŞ
 
aùiv©e
 = (
m_tÙ®Loİs
 <ğ0 || 
m_cu¼’tLoİ
 < m_totalLoops);

201 ià(
	gaùiv©e
) {

202 
EM¬qu“BehaviÜ
 
	gbehaviÜ
 = 
m_Ïy”
->
»nd””
()->
¡yË
()->
m¬qu“BehaviÜ
();

203 
	gm_¡¬t
 = 
compu‹Pos™iÚ
(
dœeùiÚ
(), 
behaviÜ
 =ğ
MALTERNATE
);

204 
	gm_’d
 = 
compu‹Pos™iÚ
(
»v”£DœeùiÚ
(), 
behaviÜ
 =ğ
MALTERNATE
 || behaviÜ =ğ
MSLIDE
);

205 ià(!
	gm_¡İ³d
)

206 
¡¬t
();

210 
	gR’d”M¬qu“
::
upd©eM¬qu“StyË
()

212 
R’d”StyË
* 
s
 = 
m_Ïy”
->
»nd””
()->
¡yË
();

214 ià(
	gm_dœeùiÚ
 !ğ
s
->
m¬qu“DœeùiÚ
(è|| (
m_tÙ®Loİs
 !ğs->
m¬qu“LoİCouÁ
(è&& 
m_cu¼’tLoİ
 >= m_totalLoops))

215 
m_cu¼’tLoİ
 = 0;

217 
	gm_tÙ®Loİs
 = 
s
->
m¬qu“LoİCouÁ
();

218 
	gm_dœeùiÚ
 = 
s
->
m¬qu“DœeùiÚ
();

220 ià(
	gm_Ïy”
->
»nd””
()->
isHTMLM¬qu“
()) {

223 ià(
	gm_tÙ®Loİs
 <ğ0 && 
s
->
m¬qu“BehaviÜ
(è=ğ
MSLIDE
)

224 
m_tÙ®Loİs
 = 1;

232 ià(
isHÜizÚl
(è&& 
	gm_Ïy”
->
»nd””
()->
chd»nIÆše
()) {

233 
	gs
->
£tWh™eS·û
(
NOWRAP
);

234 
	gs
->
£tTextAlign
(
TAAUTO
);

241 ià(
isHÜizÚl
()) {

242 ià(
	gs
->
height
().
isFixed
(è&& s->height().
v®ue
(è< s->
fÚtSize
())

243 
	gs
->
£tHeight
(
L’gth
(
s
->
fÚtSize
(), 
Fixed
));

244 } ià(
	gs
->
height
().
isAuto
())

245 
	gs
->
£tHeight
(
L’gth
(200, 
Fixed
));

247 ià(
¥“d
(è!ğ
m¬qu“S³ed
()) {

248 
m_¥“d
 = 
m¬qu“S³ed
();

249 ià(
	gm_tim”
.
isAùive
())

250 
	gm_tim”
.
¡¬tR•—tšg
(
¥“d
() * 0.001);

254 
boŞ
 
	gaùiv©e
 = (
m_tÙ®Loİs
 <ğ0 || 
m_cu¼’tLoİ
 < m_totalLoops);

255 ià(
	gaùiv©e
 && !
	gm_tim”
.
isAùive
())

256 
	gm_Ïy”
->
»nd””
()->
£tN“dsLayout
(
Œue
);

257 ià(!
	gaùiv©e
 && 
	gm_tim”
.
isAùive
())

258 
	gm_tim”
.
¡İ
();

261 
	gR’d”M¬qu“
::
tim”Fœed
(
Tim”
<
R’d”M¬qu“
>*)

263 ià(
m_Ïy”
->
»nd””
()->
ÃedsLayout
())

266 ià(
	gm_»£t
) {

267 
	gm_»£t
 = 
çl£
;

268 ià(
isHÜizÚl
())

269 
	gm_Ïy”
->
süŞlToXOff£t
(
m_¡¬t
);

271 
	gm_Ïy”
->
süŞlToYOff£t
(
m_¡¬t
);

275 
R’d”StyË
* 
	gs
 = 
m_Ïy”
->
»nd””
()->
¡yË
();

277 
	g’dPošt
 = 
m_’d
;

278 
	g¿nge
 = 
m_’d
 - 
m_¡¬t
;

279 
	gÃwPos
;

280 ià(
	g¿nge
 == 0)

281 
ÃwPos
 = 
m_’d
;

283 
boŞ
 
	gaddInüem’t
 = 
dœeùiÚ
(è=ğ
MUP
 || dœeùiÚ(è=ğ
MLEFT
;

284 
boŞ
 
	gisRev”£d
 = 
s
->
m¬qu“BehaviÜ
(è=ğ
MALTERNATE
 && 
m_cu¼’tLoİ
 % 2;

285 ià(
	gisRev”£d
) {

287 
	g’dPošt
 = 
m_¡¬t
;

288 
	g¿nge
 = -
¿nge
;

289 
	gaddInüem’t
 = !
addInüem’t
;

291 
boŞ
 
	gpos™ive
 = 
¿nge
 > 0;

292 
	gş›ÁSize
 = (
isHÜizÚl
(è? 
m_Ïy”
->
»nd”Box
()->
ş›ÁWidth
(è: m_Ïy”->»nd”Box()->
ş›ÁHeight
());

293 
	gšüem’t
 = 
max
(1, 
abs
(
m_Ïy”
->
»nd””
()->
¡yË
()->
m¬qu“Inüem’t
().
ÿlcV®ue
(
ş›ÁSize
)));

294 
	gcu¼’tPos
 = (
isHÜizÚl
(è? 
m_Ïy”
->
süŞlXOff£t
(è: m_Ïy”->
süŞlYOff£t
());

295 
	gÃwPos
 = 
cu¼’tPos
 + (
addInüem’t
 ? 
šüem’t
 : -increment);

296 ià(
	gpos™ive
)

297 
	gÃwPos
 = 
mš
(
ÃwPos
, 
’dPošt
);

299 
	gÃwPos
 = 
max
(
ÃwPos
, 
’dPošt
);

302 ià(
	gÃwPos
 =ğ
’dPošt
) {

303 
m_cu¼’tLoİ
++;

304 ià(
	gm_tÙ®Loİs
 > 0 && 
	gm_cu¼’tLoİ
 >ğ
m_tÙ®Loİs
)

305 
m_tim”
.
¡İ
();

306 ià(
	gs
->
m¬qu“BehaviÜ
(è!ğ
MALTERNATE
)

307 
m_»£t
 = 
Œue
;

310 ià(
isHÜizÚl
())

311 
	gm_Ïy”
->
süŞlToXOff£t
(
ÃwPos
);

313 
	gm_Ïy”
->
süŞlToYOff£t
(
ÃwPos
);

	@RenderMarquee.h

44 #iâdeà
R’d”M¬qu“_h


45 
	#R’d”M¬qu“_h


	)

47 
	~"L’gth.h
"

48 
	~"R’d”StyËCÚ¡ªts.h
"

49 
	~"Tim”.h
"

51 
Çme¥aû
 
	gWebCÜe
 {

53 
şass
 
	gR’d”Lay”
;

56 şas 
	cR’d”M¬qu“
 : 
public
 
NÚcİyabË
 {

57 
public
:

58 
R’d”M¬qu“
(
R’d”Lay”
*);

60 
¥“d
(ècÚ¡ {  
	gm_¥“d
; }

61 
m¬qu“S³ed
() const;

63 
EM¬qu“DœeùiÚ
 
»v”£DœeùiÚ
(ècÚ¡ {  
	g¡©ic_ÿ¡
<
	gEM¬qu“DœeùiÚ
>(-
dœeùiÚ
()); }

64 
EM¬qu“DœeùiÚ
 
dœeùiÚ
() const;

66 
boŞ
 
isHÜizÚl
() const;

68 
compu‹Pos™iÚ
(
EM¬qu“DœeùiÚ
, 
boŞ
 
¡İAtCl›ÁEdge
);

70 
£tEnd
(
’d
è{ 
	gm_’d
 =ƒnd; }

72 
¡¬t
();

73 
su¥’d
();

74 
¡İ
();

76 
upd©eM¬qu“StyË
();

77 
upd©eM¬qu“Pos™iÚ
();

79 
	g´iv©e
:

80 
tim”Fœed
(
Tim”
<
R’d”M¬qu“
>*);

82 
R’d”Lay”
* 
	gm_Ïy”
;

83 
	gm_cu¼’tLoİ
;

84 
	gm_tÙ®Loİs
;

85 
	gTim”
<
	gR’d”M¬qu“
> 
	gm_tim”
;

86 
	gm_¡¬t
;

87 
	gm_’d
;

88 
	gm_¥“d
;

89 
L’gth
 
	gm_height
;

90 
boŞ
 
	gm_»£t
: 1;

91 
boŞ
 
	gm_su¥’ded
 : 1;

92 
boŞ
 
	gm_¡İ³d
 : 1;

93 
EM¬qu“DœeùiÚ
 
	gm_dœeùiÚ
 : 4;

	@RenderMedia.cpp

26 
	~"cÚfig.h
"

28 #ià
ENABLE
(
VIDEO
)

29 
	~"R’d”MedŸ.h
"

31 
	~"Ev’tNames.h
"

32 
	~"FlßtCÚv”siÚ.h
"

33 
	~"HTMLNames.h
"

34 
	~"MedŸCÚŒŞEËm’ts.h
"

35 
	~"Mou£Ev’t.h
"

36 
	~"R’d”Theme.h
"

37 
	~<wtf/Cu¼’tTime.h
>

38 
	~<wtf/M©hExŒas.h
>

40 
usšg
 
Çme¥aû
 
	g¡d
;

42 
Çme¥aû
 
	gWebCÜe
 {

44 
usšg
 
Çme¥aû
 
	gHTMLNames
;

46 cÚ¡ 
	gcTimeUpd©eR•—tD–ay
 = 0.2;

47 cÚ¡ 
	gcO·c™yAnim©iÚR•—tD–ay
 = 0.05;

49 
	gR’d”MedŸ
::
R’d”MedŸ
(
HTMLMedŸEËm’t
* 
video
)

50 : 
R’d”Image
(
video
)

51 , 
m_timeUpd©eTim”
(
this
, &
R’d”MedŸ
::
timeUpd©eTim”Fœed
)

52 , 
m_İac™yAnim©iÚTim”
(
this
, &
R’d”MedŸ
::
İac™yAnim©iÚTim”Fœed
)

53 , 
m_mou£Ov”
(
çl£
)

54 , 
m_İac™yAnim©iÚS¹Time
(0)

55 , 
m_İac™yAnim©iÚDu¿tiÚ
(0)

56 , 
m_İac™yAnim©iÚFrom
(0)

57 , 
m_İac™yAnim©iÚTo
(1.0f)

61 
	gR’d”MedŸ
::
R’d”MedŸ
(
HTMLMedŸEËm’t
* 
video
, cÚ¡ 
IÁSize
& 
šŒšsicSize
)

62 : 
R’d”Image
(
video
)

63 , 
m_timeUpd©eTim”
(
this
, &
R’d”MedŸ
::
timeUpd©eTim”Fœed
)

64 , 
m_İac™yAnim©iÚTim”
(
this
, &
R’d”MedŸ
::
İac™yAnim©iÚTim”Fœed
)

65 , 
m_mou£Ov”
(
çl£
)

66 , 
m_İac™yAnim©iÚS¹Time
(0)

67 , 
m_İac™yAnim©iÚDu¿tiÚ
(0)

68 , 
m_İac™yAnim©iÚFrom
(0)

69 , 
m_İac™yAnim©iÚTo
(1.0f)

71 
£tIÁršsicSize
(
šŒšsicSize
);

74 
	gR’d”MedŸ
::~
R’d”MedŸ
()

78 
R’d”MedŸ
::
de¡roy
()

80 ià(
m_cÚŒŞsShadowRoÙ
 && m_cÚŒŞsShadowRoÙ->
»nd””
()) {

84 
m_·Ãl
->
d‘ach
();

86 
»moveChd
(
m_cÚŒŞsShadowRoÙ
->
»nd””
());

87 
	gm_cÚŒŞsShadowRoÙ
->
d‘ach
();

88 
	gm_cÚŒŞsShadowRoÙ
 = 0;

90 
	gR’d”Image
::
de¡roy
();

93 
HTMLMedŸEËm’t
* 
	gR’d”MedŸ
::
medŸEËm’t
() const

95  
¡©ic_ÿ¡
<
HTMLMedŸEËm’t
*>(
node
());

98 
MedŸPÏy”
* 
	gR’d”MedŸ
::
¶ay”
() const

100  
medŸEËm’t
()->
¶ay”
();

103 
	gR’d”MedŸ
::
¡yËDidChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
)

105 
	gR’d”Image
::
¡yËDidChªge
(
diff
, 
ŞdStyË
);

107 ià(
	gm_cÚŒŞsShadowRoÙ
) {

108 ià(
	gm_·Ãl
)

109 
	gm_·Ãl
->
upd©eStyË
();

110 ià(
	gm_mu‹Bu‰Ú
)

111 
	gm_mu‹Bu‰Ú
->
upd©eStyË
();

112 ià(
	gm_¶ayBu‰Ú
)

113 
	gm_¶ayBu‰Ú
->
upd©eStyË
();

114 ià(
	gm_£ekBackBu‰Ú
)

115 
	gm_£ekBackBu‰Ú
->
upd©eStyË
();

116 ià(
	gm_£ekFÜw¬dBu‰Ú
)

117 
	gm_£ekFÜw¬dBu‰Ú
->
upd©eStyË
();

118 ià(
	gm_»wšdBu‰Ú
)

119 
	gm_»wšdBu‰Ú
->
upd©eStyË
();

120 ià(
	gm_»tuºToR—ÉimeBu‰Ú
)

121 
	gm_»tuºToR—ÉimeBu‰Ú
->
upd©eStyË
();

122 ià(
	gm_toggËClo£dC­tiÚsBu‰Ú
)

123 
	gm_toggËClo£dC­tiÚsBu‰Ú
->
upd©eStyË
();

124 ià(
	gm_¡©usDi¥Ïy
)

125 
	gm_¡©usDi¥Ïy
->
upd©eStyË
();

126 ià(
	gm_tim–šeCÚš”
)

127 
	gm_tim–šeCÚš”
->
upd©eStyË
();

128 ià(
	gm_tim–še
)

129 
	gm_tim–še
->
upd©eStyË
();

130 ià(
	gm_fuÎsü“nBu‰Ú
)

131 
	gm_fuÎsü“nBu‰Ú
->
upd©eStyË
();

132 ià(
	gm_cu¼’tTimeDi¥Ïy
)

133 
	gm_cu¼’tTimeDi¥Ïy
->
upd©eStyË
();

134 ià(
	gm_timeRemaššgDi¥Ïy
)

135 
	gm_timeRemaššgDi¥Ïy
->
upd©eStyË
();

136 ià(
	gm_vŞumeSlid”CÚš”
)

137 
	gm_vŞumeSlid”CÚš”
->
upd©eStyË
();

138 ià(
	gm_vŞumeSlid”
)

139 
	gm_vŞumeSlid”
->
upd©eStyË
();

143 
	gR’d”MedŸ
::
Ïyout
()

145 
IÁSize
 
ŞdSize
 = 
cÚ‹ÁBoxReù
().
size
();

147 
	gR’d”Image
::
Ïyout
();

149 
R’d”Box
* 
	gcÚŒŞsR’d””
 = 
m_cÚŒŞsShadowRoÙ
 ? m_cÚŒŞsShadowRoÙ->
»nd”Box
() : 0;

150 ià(!
	gcÚŒŞsR’d””
)

152 
IÁSize
 
	gÃwSize
 = 
cÚ‹ÁBoxReù
().
size
();

153 ià(
	gÃwSize
 !ğ
ŞdSize
 || 
cÚŒŞsR’d””
->
ÃedsLayout
()) {

155 ià(
m_cu¼’tTimeDi¥Ïy
 && 
m_timeRemaššgDi¥Ïy
) {

156 
boŞ
 
shouldShowTimeDi¥Ïys
 = 
shouldShowTimeDi¥ÏyCÚŒŞs
();

157 
	gm_cu¼’tTimeDi¥Ïy
->
£tVisibË
(
shouldShowTimeDi¥Ïys
);

158 
	gm_timeRemaššgDi¥Ïy
->
£tVisibË
(
shouldShowTimeDi¥Ïys
);

161 
	gcÚŒŞsR’d””
->
£tLoÿtiÚ
(
bÜd”Leá
(è+ 
·ddšgLeá
(), 
bÜd”Tİ
(è+ 
·ddšgTİ
());

162 
	gcÚŒŞsR’d””
->
¡yË
()->
£tHeight
(
L’gth
(
ÃwSize
.
height
(), 
Fixed
));

163 
	gcÚŒŞsR’d””
->
¡yË
()->
£tWidth
(
L’gth
(
ÃwSize
.
width
(), 
Fixed
));

164 
	gcÚŒŞsR’d””
->
£tN“dsLayout
(
Œue
, 
çl£
);

165 
	gcÚŒŞsR’d””
->
Ïyout
();

166 
£tChdN“dsLayout
(
çl£
);

170 
	gR’d”MedŸ
::
ü—‹CÚŒŞsShadowRoÙ
()

172 
ASSERT
(!
m_cÚŒŞsShadowRoÙ
);

173 
	gm_cÚŒŞsShadowRoÙ
 = 
Ãw
 
MedŸCÚŒŞShadowRoÙEËm’t
(
docum’t
(), 
medŸEËm’t
());

174 
addChd
(
m_cÚŒŞsShadowRoÙ
->
»nd””
());

177 
	gR’d”MedŸ
::
ü—‹Pª–
()

179 
ASSERT
(!
m_·Ãl
);

180 
	gm_·Ãl
 = 
Ãw
 
MedŸCÚŒŞEËm’t
(
docum’t
(), 
MEDIA_CONTROLS_PANEL
, 
medŸEËm’t
());

181 
	gm_·Ãl
->
©chToP¬’t
(
m_cÚŒŞsShadowRoÙ
.
g‘
());

184 
	gR’d”MedŸ
::
ü—‹Mu‹Bu‰Ú
()

186 
ASSERT
(!
m_mu‹Bu‰Ú
);

187 
	gm_mu‹Bu‰Ú
 = 
Ãw
 
MedŸCÚŒŞMu‹Bu‰ÚEËm’t
(
docum’t
(), 
medŸEËm’t
());

188 
	gm_mu‹Bu‰Ú
->
©chToP¬’t
(
m_·Ãl
.
g‘
());

191 
	gR’d”MedŸ
::
ü—‹PÏyBu‰Ú
()

193 
ASSERT
(!
m_¶ayBu‰Ú
);

194 
	gm_¶ayBu‰Ú
 = 
Ãw
 
MedŸCÚŒŞPÏyBu‰ÚEËm’t
(
docum’t
(), 
medŸEËm’t
());

195 
	gm_¶ayBu‰Ú
->
©chToP¬’t
(
m_·Ãl
.
g‘
());

198 
	gR’d”MedŸ
::
ü—‹S“kBackBu‰Ú
()

200 
ASSERT
(!
m_£ekBackBu‰Ú
);

201 
	gm_£ekBackBu‰Ú
 = 
Ãw
 
MedŸCÚŒŞS“kBu‰ÚEËm’t
(
docum’t
(), 
medŸEËm’t
(), 
çl£
);

202 
	gm_£ekBackBu‰Ú
->
©chToP¬’t
(
m_·Ãl
.
g‘
());

205 
	gR’d”MedŸ
::
ü—‹S“kFÜw¬dBu‰Ú
()

207 
ASSERT
(!
m_£ekFÜw¬dBu‰Ú
);

208 
	gm_£ekFÜw¬dBu‰Ú
 = 
Ãw
 
MedŸCÚŒŞS“kBu‰ÚEËm’t
(
docum’t
(), 
medŸEËm’t
(), 
Œue
);

209 
	gm_£ekFÜw¬dBu‰Ú
->
©chToP¬’t
(
m_·Ãl
.
g‘
());

212 
	gR’d”MedŸ
::
ü—‹RewšdBu‰Ú
()

214 
ASSERT
(!
m_»wšdBu‰Ú
);

215 
	gm_»wšdBu‰Ú
 = 
Ãw
 
MedŸCÚŒŞRewšdBu‰ÚEËm’t
(
docum’t
(), 
medŸEËm’t
());

216 
	gm_»wšdBu‰Ú
->
©chToP¬’t
(
m_·Ãl
.
g‘
());

219 
	gR’d”MedŸ
::
ü—‹R‘uºToR—ÉimeBu‰Ú
()

221 
ASSERT
(!
m_»tuºToR—ÉimeBu‰Ú
);

222 
	gm_»tuºToR—ÉimeBu‰Ú
 = 
Ãw
 
MedŸCÚŒŞR‘uºToR—ÉimeBu‰ÚEËm’t
(
docum’t
(), 
medŸEËm’t
());

223 
	gm_»tuºToR—ÉimeBu‰Ú
->
©chToP¬’t
(
m_·Ãl
.
g‘
());

226 
	gR’d”MedŸ
::
ü—‹ToggËClo£dC­tiÚsBu‰Ú
()

228 
ASSERT
(!
m_toggËClo£dC­tiÚsBu‰Ú
);

229 
	gm_toggËClo£dC­tiÚsBu‰Ú
 = 
Ãw
 
MedŸCÚŒŞToggËClo£dC­tiÚsBu‰ÚEËm’t
(
docum’t
(), 
medŸEËm’t
());

230 
	gm_toggËClo£dC­tiÚsBu‰Ú
->
©chToP¬’t
(
m_·Ãl
.
g‘
());

233 
	gR’d”MedŸ
::
ü—‹StusDi¥Ïy
()

235 
ASSERT
(!
m_¡©usDi¥Ïy
);

236 
	gm_¡©usDi¥Ïy
 = 
Ãw
 
MedŸCÚŒŞStusDi¥ÏyEËm’t
(
docum’t
(), 
medŸEËm’t
());

237 
	gm_¡©usDi¥Ïy
->
©chToP¬’t
(
m_·Ãl
.
g‘
());

240 
	gR’d”MedŸ
::
ü—‹Tim–šeCÚš”
()

242 
ASSERT
(!
m_tim–šeCÚš”
);

243 
	gm_tim–šeCÚš”
 = 
Ãw
 
MedŸCÚŒŞTim–šeCÚš”EËm’t
(
docum’t
(), 
medŸEËm’t
());

244 
	gm_tim–šeCÚš”
->
©chToP¬’t
(
m_·Ãl
.
g‘
());

247 
	gR’d”MedŸ
::
ü—‹Tim–še
()

249 
ASSERT
(!
m_tim–še
);

250 
	gm_tim–še
 = 
Ãw
 
MedŸCÚŒŞTim–šeEËm’t
(
docum’t
(), 
medŸEËm’t
());

251 
	gm_tim–še
->
£tA‰ribu‹
(
´ecisiÚA‰r
, "float");

252 
	gm_tim–še
->
©chToP¬’t
(
m_tim–šeCÚš”
.
g‘
());

255 
	gR’d”MedŸ
::
ü—‹VŞumeSlid”CÚš”
()

257 
ASSERT
(!
m_vŞumeSlid”CÚš”
);

258 
	gm_vŞumeSlid”CÚš”
 = 
Ãw
 
MedŸCÚŒŞVŞumeSlid”CÚš”EËm’t
(
docum’t
(), 
medŸEËm’t
());

259 
	gm_vŞumeSlid”CÚš”
->
©chToP¬’t
(
m_·Ãl
.
g‘
());

262 
	gR’d”MedŸ
::
ü—‹VŞumeSlid”
()

264 
ASSERT
(!
m_vŞumeSlid”
);

265 
	gm_vŞumeSlid”
 = 
Ãw
 
MedŸCÚŒŞVŞumeSlid”EËm’t
(
docum’t
(), 
medŸEËm’t
());

266 
	gm_vŞumeSlid”
->
£tA‰ribu‹
(
´ecisiÚA‰r
, "float");

267 
	gm_vŞumeSlid”
->
£tA‰ribu‹
(
maxA‰r
, "1");

268 
	gm_vŞumeSlid”
->
£tA‰ribu‹
(
v®ueA‰r
, 
SŒšg
::
numb”
(
medŸEËm’t
()->
vŞume
()));

269 
	gm_vŞumeSlid”
->
©chToP¬’t
(
m_vŞumeSlid”CÚš”
.
g‘
());

272 
	gR’d”MedŸ
::
ü—‹Cu¼’tTimeDi¥Ïy
()

274 
ASSERT
(!
m_cu¼’tTimeDi¥Ïy
);

275 
	gm_cu¼’tTimeDi¥Ïy
 = 
Ãw
 
MedŸCÚŒŞTimeDi¥ÏyEËm’t
(
docum’t
(), 
MEDIA_CONTROLS_CURRENT_TIME_DISPLAY
, 
medŸEËm’t
());

276 
	gm_cu¼’tTimeDi¥Ïy
->
©chToP¬’t
(
m_tim–šeCÚš”
.
g‘
());

279 
	gR’d”MedŸ
::
ü—‹TimeRemaššgDi¥Ïy
()

281 
ASSERT
(!
m_timeRemaššgDi¥Ïy
);

282 
	gm_timeRemaššgDi¥Ïy
 = 
Ãw
 
MedŸCÚŒŞTimeDi¥ÏyEËm’t
(
docum’t
(), 
MEDIA_CONTROLS_TIME_REMAINING_DISPLAY
, 
medŸEËm’t
());

283 
	gm_timeRemaššgDi¥Ïy
->
©chToP¬’t
(
m_tim–šeCÚš”
.
g‘
());

286 
	gR’d”MedŸ
::
ü—‹FuÎsü“nBu‰Ú
()

288 
ASSERT
(!
m_fuÎsü“nBu‰Ú
);

289 
	gm_fuÎsü“nBu‰Ú
 = 
Ãw
 
MedŸCÚŒŞFuÎsü“nBu‰ÚEËm’t
(
docum’t
(), 
medŸEËm’t
());

290 
	gm_fuÎsü“nBu‰Ú
->
©chToP¬’t
(
m_·Ãl
.
g‘
());

293 
	gR’d”MedŸ
::
upd©eFromEËm’t
()

295 
upd©eCÚŒŞs
();

298 
	gR’d”MedŸ
::
upd©eCÚŒŞs
()

300 
HTMLMedŸEËm’t
* 
medŸ
 = 
medŸEËm’t
();

301 ià(!
	gmedŸ
->
cÚŒŞs
(è|| !medŸ->
šAùiveDocum’t
()) {

302 ià(
	gm_cÚŒŞsShadowRoÙ
) {

303 
	gm_cÚŒŞsShadowRoÙ
->
d‘ach
();

304 
	gm_·Ãl
 = 0;

305 
	gm_mu‹Bu‰Ú
 = 0;

306 
	gm_¶ayBu‰Ú
 = 0;

307 
	gm_¡©usDi¥Ïy
 = 0;

308 
	gm_tim–šeCÚš”
 = 0;

309 
	gm_tim–še
 = 0;

310 
	gm_£ekBackBu‰Ú
 = 0;

311 
	gm_£ekFÜw¬dBu‰Ú
 = 0;

312 
	gm_»wšdBu‰Ú
 = 0;

313 
	gm_»tuºToR—ÉimeBu‰Ú
 = 0;

314 
	gm_cu¼’tTimeDi¥Ïy
 = 0;

315 
	gm_timeRemaššgDi¥Ïy
 = 0;

316 
	gm_fuÎsü“nBu‰Ú
 = 0;

317 
	gm_vŞumeSlid”CÚš”
 = 0;

318 
	gm_vŞumeSlid”
 = 0;

319 
	gm_cÚŒŞsShadowRoÙ
 = 0;

320 
	gm_toggËClo£dC­tiÚsBu‰Ú
 = 0;

322 
	gm_İac™yAnim©iÚTo
 = 1.0f;

323 
	gm_İac™yAnim©iÚTim”
.
¡İ
();

324 
	gm_timeUpd©eTim”
.
¡İ
();

328 ià(!
	gm_cÚŒŞsShadowRoÙ
) {

329 
ü—‹CÚŒŞsShadowRoÙ
();

330 
ü—‹Pª–
();

331 ià(
	gm_·Ãl
) {

332 
ü—‹RewšdBu‰Ú
();

333 
ü—‹PÏyBu‰Ú
();

334 
ü—‹R‘uºToR—ÉimeBu‰Ú
();

335 
ü—‹StusDi¥Ïy
();

336 
ü—‹Tim–šeCÚš”
();

337 ià(
	gm_tim–šeCÚš”
) {

338 
ü—‹Cu¼’tTimeDi¥Ïy
();

339 
ü—‹Tim–še
();

340 
ü—‹TimeRemaššgDi¥Ïy
();

342 
ü—‹S“kBackBu‰Ú
();

343 
ü—‹S“kFÜw¬dBu‰Ú
();

344 
ü—‹ToggËClo£dC­tiÚsBu‰Ú
();

345 
ü—‹FuÎsü“nBu‰Ú
();

346 
ü—‹Mu‹Bu‰Ú
();

347 
ü—‹VŞumeSlid”CÚš”
();

348 ià(
	gm_vŞumeSlid”CÚš”
)

349 
ü—‹VŞumeSlid”
();

350 
	gm_·Ãl
->
©ch
();

354 ià(
	gmedŸ
->
ÿnPÏy
()) {

355 ià(
	gm_timeUpd©eTim”
.
isAùive
())

356 
	gm_timeUpd©eTim”
.
¡İ
();

357 } ià(
¡yË
()->
visib™y
(è=ğ
VISIBLE
 && 
m_tim–še
 && m_tim–še->
»nd””
(è&& m_tim–še->»nd””()->¡yË()->
di¥Ïy
(è!ğ
NONE
) {

358 
m_timeUpd©eTim”
.
¡¬tR•—tšg
(
cTimeUpd©eR•—tD–ay
);

362 ià(
	gm_·Ãl
) {

365 
	gİac™yBefÜeChªgšgStyË
 = 
m_·Ãl
->
»nd””
(è? m_·Ãl->»nd””()->
¡yË
()->
İac™y
() : 0;

366 
	gm_·Ãl
->
upd©e
();

367 
chªgeO·c™y
(
m_·Ãl
.
g‘
(), 
İac™yBefÜeChªgšgStyË
);

369 ià(
	gm_mu‹Bu‰Ú
)

370 
	gm_mu‹Bu‰Ú
->
upd©e
();

371 ià(
	gm_¶ayBu‰Ú
)

372 
	gm_¶ayBu‰Ú
->
upd©e
();

373 ià(
	gm_tim–šeCÚš”
)

374 
	gm_tim–šeCÚš”
->
upd©e
();

375 ià(
	gm_vŞumeSlid”CÚš”
)

376 
	gm_vŞumeSlid”CÚš”
->
upd©e
();

377 ià(
	gm_tim–še
)

378 
	gm_tim–še
->
upd©e
();

379 ià(
	gm_cu¼’tTimeDi¥Ïy
)

380 
	gm_cu¼’tTimeDi¥Ïy
->
upd©e
();

381 ià(
	gm_timeRemaššgDi¥Ïy
)

382 
	gm_timeRemaššgDi¥Ïy
->
upd©e
();

383 ià(
	gm_£ekBackBu‰Ú
)

384 
	gm_£ekBackBu‰Ú
->
upd©e
();

385 ià(
	gm_£ekFÜw¬dBu‰Ú
)

386 
	gm_£ekFÜw¬dBu‰Ú
->
upd©e
();

387 ià(
	gm_»wšdBu‰Ú
)

388 
	gm_»wšdBu‰Ú
->
upd©e
();

389 ià(
	gm_»tuºToR—ÉimeBu‰Ú
)

390 
	gm_»tuºToR—ÉimeBu‰Ú
->
upd©e
();

391 ià(
	gm_toggËClo£dC­tiÚsBu‰Ú
)

392 
	gm_toggËClo£dC­tiÚsBu‰Ú
->
upd©e
();

393 ià(
	gm_¡©usDi¥Ïy
)

394 
	gm_¡©usDi¥Ïy
->
upd©e
();

395 ià(
	gm_fuÎsü“nBu‰Ú
)

396 
	gm_fuÎsü“nBu‰Ú
->
upd©e
();

397 ià(
	gm_vŞumeSlid”
)

398 
	gm_vŞumeSlid”
->
upd©e
();

400 
upd©eTimeDi¥Ïy
();

401 
upd©eCÚŒŞVisib™y
();

404 
	gR’d”MedŸ
::
timeUpd©eTim”Fœed
(
Tim”
<
R’d”MedŸ
>*)

406 ià(
m_tim–še
)

407 
m_tim–še
->
upd©e
(
çl£
);

408 
upd©eTimeDi¥Ïy
();

411 
	gR’d”MedŸ
::
upd©eTimeDi¥Ïy
()

413 ià(!
m_cu¼’tTimeDi¥Ïy
 || !m_cu¼’tTimeDi¥Ïy->
»nd””
(è|| m_cu¼’tTimeDi¥Ïy->»nd””()->
¡yË
()->
di¥Ïy
(è=ğ
NONE
 || styË()->
visib™y
(è!ğ
VISIBLE
)

416 
	gnow
 = 
medŸEËm’t
()->
cu¼’tTime
();

417 
	gdu¿tiÚ
 = 
medŸEËm’t
()->
du¿tiÚ
();

420 
Exû±iÚCode
 
	gec
;

421 
	gm_cu¼’tTimeDi¥Ïy
->
£tIÂ”Text
(
theme
()->
fÜm©MedŸCÚŒŞsCu¼’tTime
(
now
, 
du¿tiÚ
), 
ec
);

422 
	gm_cu¼’tTimeDi¥Ïy
->
£tCu¼’tV®ue
(
now
);

423 
	gm_timeRemaššgDi¥Ïy
->
£tIÂ”Text
(
theme
()->
fÜm©MedŸCÚŒŞsRemaššgTime
(
now
, 
du¿tiÚ
), 
ec
);

424 
	gm_timeRemaššgDi¥Ïy
->
£tCu¼’tV®ue
(
now
 - 
du¿tiÚ
);

427 
	gR’d”MedŸ
::
upd©eCÚŒŞVisib™y
()

429 ià(!
m_·Ãl
 || !m_·Ãl->
»nd””
())

433 
HTMLMedŸEËm’t
* 
	gmedŸ
 = 
medŸEËm’t
();

434 ià(!
	gmedŸ
->
hasVideo
())

438 ià(
¡yË
()->
visib™y
(è!ğ
VISIBLE
)

441 
boŞ
 
	gshouldHideCÚŒŞËr
 = !
m_mou£Ov”
 && !
medŸ
->
ÿnPÏy
();

445 
	gªim©eFrom
 = 
m_·Ãl
->
»nd””
()->
¡yË
()->
İac™y
();

446 
	gªim©eTo
 = 
shouldHideCÚŒŞËr
 ? 0.0f : 1.0f;

448 ià(
	gªim©eFrom
 =ğ
ªim©eTo
)

451 ià(
	gm_İac™yAnim©iÚTim”
.
isAùive
()) {

452 ià(
	gm_İac™yAnim©iÚTo
 =ğ
ªim©eTo
)

454 
	gm_İac™yAnim©iÚTim”
.
¡İ
();

457 ià(
	gªim©eFrom
 < 
	gªim©eTo
)

458 
	gm_İac™yAnim©iÚDu¿tiÚ
 = 
m_·Ãl
->
»nd””
()->
theme
()->
medŸCÚŒŞsFadeInDu¿tiÚ
();

460 
	gm_İac™yAnim©iÚDu¿tiÚ
 = 
m_·Ãl
->
»nd””
()->
theme
()->
medŸCÚŒŞsFadeOutDu¿tiÚ
();

462 
	gm_İac™yAnim©iÚFrom
 = 
ªim©eFrom
;

463 
	gm_İac™yAnim©iÚTo
 = 
ªim©eTo
;

465 
	gm_İac™yAnim©iÚS¹Time
 = 
cu¼’tTime
();

466 
	gm_İac™yAnim©iÚTim”
.
¡¬tR•—tšg
(
cO·c™yAnim©iÚR•—tD–ay
);

469 
	gR’d”MedŸ
::
chªgeO·c™y
(
HTMLEËm’t
* 
e
, 
İac™y
)

471 ià(!
	ge
 || !e->
»nd””
(è|| !e->»nd””()->
¡yË
())

473 
	gRefPŒ
<
	gR’d”StyË
> 
	gs
 = 
R’d”StyË
::
şÚe
(
e
->
»nd””
()->
¡yË
());

474 
	gs
->
£tO·c™y
(
İac™y
);

476 
	gs
->
£tZIndex
(0);

477 
	ge
->
»nd””
()->
£tStyË
(
s
.
»Ëa£
());

480 
	gR’d”MedŸ
::
İac™yAnim©iÚTim”Fœed
(
Tim”
<
R’d”MedŸ
>*)

482 
time
 = 
cu¼’tTime
(è- 
m_İac™yAnim©iÚS¹Time
;

483 ià(
	gtime
 >ğ
m_İac™yAnim©iÚDu¿tiÚ
) {

484 
time
 = 
m_İac™yAnim©iÚDu¿tiÚ
;

485 
	gm_İac™yAnim©iÚTim”
.
¡İ
();

487 
	gİac™y
 = 
Ç¼owP»cisiÚToFlßt
(
m_İac™yAnim©iÚFrom
 + (
m_İac™yAnim©iÚTo
 - m_İac™yAnim©iÚFromè* 
time
 / 
m_İac™yAnim©iÚDu¿tiÚ
);

488 
chªgeO·c™y
(
m_·Ãl
.
g‘
(), 
İac™y
);

491 
	gR’d”MedŸ
::
upd©eVŞumeSlid”CÚš”
(
boŞ
 
visibË
)

493 ià(!
medŸEËm’t
()->
hasAudio
(è|| !
m_vŞumeSlid”CÚš”
 || !
m_vŞumeSlid”
)

496 ià(
	gvisibË
 && !
	gm_vŞumeSlid”CÚš”
->
isVisibË
()) {

497 ià(!
	gm_mu‹Bu‰Ú
 || !m_mu‹Bu‰Ú->
»nd””
(è|| !m_mu‹Bu‰Ú->
»nd”Box
())

500 
	gRefPŒ
<
	gR’d”StyË
> 
	gs
 = 
m_vŞumeSlid”CÚš”
->
¡yËFÜEËm’t
();

501 
	gheight
 = 
s
->
height
().
isP”ûÁ
(è? 0 : s->height().
v®ue
();

502 
	gx
 = 
m_mu‹Bu‰Ú
->
»nd”Box
()->
off£tLeá
();

503 
	gy
 = 
m_mu‹Bu‰Ú
->
»nd”Box
()->
off£tTİ
(è- 
height
;

504 
FlßtPošt
 
	gabsPošt
 = 
m_mu‹Bu‰Ú
->
»nd””
()->
loÿlToAbsŞu‹
(FlßtPošt(
x
, 
y
), 
Œue
,rue);

505 ià(
	gabsPošt
.
y
() < 0)

506 
	gy
 = 
m_mu‹Bu‰Ú
->
»nd”Box
()->
off£tTİ
(è+ m_mu‹Bu‰Ú->»nd”Box()->
height
();

507 
	gm_vŞumeSlid”CÚš”
->
£tVisibË
(
Œue
);

508 
	gm_vŞumeSlid”CÚš”
->
£tPos™iÚ
(
x
, 
y
);

509 
	gm_vŞumeSlid”CÚš”
->
upd©e
();

510 
	gm_vŞumeSlid”
->
upd©e
();

511 } ià(!
	gvisibË
 && 
	gm_vŞumeSlid”CÚš”
->
isVisibË
()) {

512 
	gm_vŞumeSlid”CÚš”
->
£tVisibË
(
çl£
);

513 
	gm_vŞumeSlid”CÚš”
->
upd©eStyË
();

517 
	gR’d”MedŸ
::
fÜw¬dEv’t
(
Ev’t
* 
ev’t
)

519 ià(
ev’t
->
isMou£Ev’t
(è&& 
m_cÚŒŞsShadowRoÙ
) {

520 
Mou£Ev’t
* 
mou£Ev’t
 = 
¡©ic_ÿ¡
<Mou£Ev’t*>(
ev’t
);

521 
IÁPošt
 
pošt
(
mou£Ev’t
->
absŞu‹LoÿtiÚ
());

522 
boŞ
 
	gshowVŞumeSlid”
 = 
çl£
;

523 ià(
	gm_mu‹Bu‰Ú
 && m_mu‹Bu‰Ú->
h™Te¡
(
pošt
)) {

524 
	gm_mu‹Bu‰Ú
->
deçuÉEv’tHªdËr
(
ev’t
);

525 ià(
	gev’t
->
ty³
(è!ğ
ev’tNames
().
mou£outEv’t
)

526 
showVŞumeSlid”
 = 
Œue
;

529 ià(
	gm_vŞumeSlid”CÚš”
 && m_vŞumeSlid”CÚš”->
h™Te¡
(
pošt
))

530 
	gshowVŞumeSlid”
 = 
Œue
;

532 ià(
	gm_vŞumeSlid”
 && m_vŞumeSlid”->
h™Te¡
(
pošt
)) {

533 
	gm_vŞumeSlid”
->
deçuÉEv’tHªdËr
(
ev’t
);

534 
	gshowVŞumeSlid”
 = 
Œue
;

537 
upd©eVŞumeSlid”CÚš”
(
showVŞumeSlid”
);

539 ià(
	gm_¶ayBu‰Ú
 && m_¶ayBu‰Ú->
h™Te¡
(
pošt
))

540 
	gm_¶ayBu‰Ú
->
deçuÉEv’tHªdËr
(
ev’t
);

542 ià(
	gm_£ekBackBu‰Ú
 && m_£ekBackBu‰Ú->
h™Te¡
(
pošt
))

543 
	gm_£ekBackBu‰Ú
->
deçuÉEv’tHªdËr
(
ev’t
);

545 ià(
	gm_£ekFÜw¬dBu‰Ú
 && m_£ekFÜw¬dBu‰Ú->
h™Te¡
(
pošt
))

546 
	gm_£ekFÜw¬dBu‰Ú
->
deçuÉEv’tHªdËr
(
ev’t
);

548 ià(
	gm_»wšdBu‰Ú
 && m_»wšdBu‰Ú->
h™Te¡
(
pošt
))

549 
	gm_»wšdBu‰Ú
->
deçuÉEv’tHªdËr
(
ev’t
);

551 ià(
	gm_»tuºToR—ÉimeBu‰Ú
 && m_»tuºToR—ÉimeBu‰Ú->
h™Te¡
(
pošt
))

552 
	gm_»tuºToR—ÉimeBu‰Ú
->
deçuÉEv’tHªdËr
(
ev’t
);

554 ià(
	gm_toggËClo£dC­tiÚsBu‰Ú
 && m_toggËClo£dC­tiÚsBu‰Ú->
h™Te¡
(
pošt
))

555 
	gm_toggËClo£dC­tiÚsBu‰Ú
->
deçuÉEv’tHªdËr
(
ev’t
);

557 ià(
	gm_tim–še
 && m_tim–še->
h™Te¡
(
pošt
))

558 
	gm_tim–še
->
deçuÉEv’tHªdËr
(
ev’t
);

560 ià(
	gm_fuÎsü“nBu‰Ú
 && m_fuÎsü“nBu‰Ú->
h™Te¡
(
pošt
))

561 
	gm_fuÎsü“nBu‰Ú
->
deçuÉEv’tHªdËr
(
ev’t
);

563 ià(
	gev’t
->
ty³
(è=ğ
ev’tNames
().
mou£ov”Ev’t
) {

564 
m_mou£Ov”
 = 
Œue
;

565 
upd©eCÚŒŞVisib™y
();

567 ià(
	gev’t
->
ty³
(è=ğ
ev’tNames
().
mou£outEv’t
) {

569 
Node
* 
mou£Ov”Node
 = 
mou£Ev’t
->
»Ï‹dT¬g‘
(è? mou£Ev’t->»Ï‹dT¬g‘()->
toNode
() : 0;

570 
R’d”Objeù
* 
	gmou£Ov”R’d””
 = 
mou£Ov”Node
 ? mou£Ov”Node->
»nd””
() : 0;

571 
	gm_mou£Ov”
 = 
mou£Ov”R’d””
 && mou£Ov”R’d””->
isDesûndªtOf
(
this
);

572 
upd©eCÚŒŞVisib™y
();

577 
	gR’d”MedŸ
::
lowe¡Pos™iÚ
(
boŞ
 
šşudeOv”æowIÁ”iÜ
, boŞ 
šşudeS–f
) const

579 
	gbÙtom
 = 
R’d”Image
::
lowe¡Pos™iÚ
(
šşudeOv”æowIÁ”iÜ
, 
šşudeS–f
);

580 ià(!
	gm_cÚŒŞsShadowRoÙ
 || !m_cÚŒŞsShadowRoÙ->
»nd””
())

581  
	gbÙtom
;

583  
max
(
bÙtom
, 
m_cÚŒŞsShadowRoÙ
->
»nd”Box
()->
y
(è+ m_cÚŒŞsShadowRoÙ->»nd”Box()->
lowe¡Pos™iÚ
(
šşudeOv”æowIÁ”iÜ
, 
šşudeS–f
));

586 
	gR’d”MedŸ
::
rightmo¡Pos™iÚ
(
boŞ
 
šşudeOv”æowIÁ”iÜ
, boŞ 
šşudeS–f
) const

588 
	gright
 = 
R’d”Image
::
rightmo¡Pos™iÚ
(
šşudeOv”æowIÁ”iÜ
, 
šşudeS–f
);

589 ià(!
	gm_cÚŒŞsShadowRoÙ
 || !m_cÚŒŞsShadowRoÙ->
»nd””
())

590  
	gright
;

592  
max
(
right
, 
m_cÚŒŞsShadowRoÙ
->
»nd”Box
()->
x
(è+ m_cÚŒŞsShadowRoÙ->»nd”Box()->
rightmo¡Pos™iÚ
(
šşudeOv”æowIÁ”iÜ
, 
šşudeS–f
));

595 
	gR’d”MedŸ
::
Ëámo¡Pos™iÚ
(
boŞ
 
šşudeOv”æowIÁ”iÜ
, boŞ 
šşudeS–f
) const

597 
	gËá
 = 
R’d”Image
::
Ëámo¡Pos™iÚ
(
šşudeOv”æowIÁ”iÜ
, 
šşudeS–f
);

598 ià(!
	gm_cÚŒŞsShadowRoÙ
 || !m_cÚŒŞsShadowRoÙ->
»nd””
())

599  
	gËá
;

601  
mš
(
Ëá
, 
m_cÚŒŞsShadowRoÙ
->
»nd”Box
()->
x
(è+ m_cÚŒŞsShadowRoÙ->»nd”Box()->
Ëámo¡Pos™iÚ
(
šşudeOv”æowIÁ”iÜ
, 
šşudeS–f
));

606 cÚ¡ 
	gmšWidthToDi¥ÏyTimeDi¥Ïys
 = 16 + 16 + 45 + 100 + 45 + 16 + 1;

608 
boŞ
 
	gR’d”MedŸ
::
shouldShowTimeDi¥ÏyCÚŒŞs
() const

610 ià(!
m_cu¼’tTimeDi¥Ïy
 && !
m_timeRemaššgDi¥Ïy
)

611  
çl£
;

613 
	gwidth
 = 
medŸEËm’t
()->
»nd”Box
()->
width
();

614  
	gwidth
 >ğ
mšWidthToDi¥ÏyTimeDi¥Ïys
 * 
¡yË
()->
efãùiveZoom
();

	@RenderMedia.h

26 #iâdeà
R’d”MedŸ_h


27 
	#R’d”MedŸ_h


	)

29 #ià
ENABLE
(
VIDEO
)

31 
	~"R’d”Image.h
"

32 
	~"Tim”.h
"

34 
Çme¥aû
 
	gWebCÜe
 {

36 
şass
 
	gHTMLIÅutEËm’t
;

37 
şass
 
	gHTMLMedŸEËm’t
;

38 
şass
 
	gMedŸCÚŒŞMu‹Bu‰ÚEËm’t
;

39 
şass
 
	gMedŸCÚŒŞPÏyBu‰ÚEËm’t
;

40 
şass
 
	gMedŸCÚŒŞS“kBu‰ÚEËm’t
;

41 
şass
 
	gMedŸCÚŒŞRewšdBu‰ÚEËm’t
;

42 
şass
 
	gMedŸCÚŒŞR‘uºToR—ÉimeBu‰ÚEËm’t
;

43 
şass
 
	gMedŸCÚŒŞToggËClo£dC­tiÚsBu‰ÚEËm’t
;

44 
şass
 
	gMedŸCÚŒŞTim–šeEËm’t
;

45 
şass
 
	gMedŸCÚŒŞVŞumeSlid”EËm’t
;

46 
şass
 
	gMedŸCÚŒŞFuÎsü“nBu‰ÚEËm’t
;

47 
şass
 
	gMedŸCÚŒŞTimeDi¥ÏyEËm’t
;

48 
şass
 
	gMedŸCÚŒŞStusDi¥ÏyEËm’t
;

49 
şass
 
	gMedŸCÚŒŞTim–šeCÚš”EËm’t
;

50 
şass
 
	gMedŸCÚŒŞVŞumeSlid”CÚš”EËm’t
;

51 
şass
 
	gMedŸCÚŒŞEËm’t
;

52 
şass
 
	gMedŸPÏy”
;

54 şas 
	cR’d”MedŸ
 : 
public
 
R’d”Image
 {

55 
public
:

56 
R’d”MedŸ
(
HTMLMedŸEËm’t
*);

57 
R’d”MedŸ
(
HTMLMedŸEËm’t
*, cÚ¡ 
IÁSize
& 
šŒšsicSize
);

58 
	gvœtu®
 ~
R’d”MedŸ
();

60 cÚ¡ 
R’d”ObjeùChdLi¡
* 
chd»n
(ècÚ¡ {  &
	gm_chd»n
; }

61 
R’d”ObjeùChdLi¡
* 
chd»n
(è{  &
	gm_chd»n
; }

63 
HTMLMedŸEËm’t
* 
medŸEËm’t
() const;

64 
MedŸPÏy”
* 
¶ay”
() const;

66 
boŞ
 
shouldShowTimeDi¥ÏyCÚŒŞs
() const;

68 
upd©eFromEËm’t
();

69 
upd©ePÏy”
();

70 
upd©eCÚŒŞs
();

71 
upd©eTimeDi¥Ïy
();

73 
fÜw¬dEv’t
(
Ev’t
*);

75 
	g´Ùeùed
:

76 
vœtu®
 
Ïyout
();

78 
	g´iv©e
:

79 
vœtu®
 
R’d”ObjeùChdLi¡
* 
vœtu®Chd»n
(è{  
chd»n
(); }

80 
vœtu®
 cÚ¡ 
R’d”ObjeùChdLi¡
* 
vœtu®Chd»n
(ècÚ¡ {  
chd»n
(); }

82 
vœtu®
 
de¡roy
();

84 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderMedia"; }

85 
vœtu®
 
boŞ
 
isMedŸ
(ècÚ¡ {  
	gŒue
; }

86 
vœtu®
 
boŞ
 
isImage
(ècÚ¡ {  
	gçl£
; }

88 
vœtu®
 
lowe¡Pos™iÚ
(
boŞ
 
šşudeOv”æowIÁ”iÜ
 = 
Œue
, boŞ 
šşudeS–f
 =rue) const;

89 
vœtu®
 
rightmo¡Pos™iÚ
(
boŞ
 
šşudeOv”æowIÁ”iÜ
 = 
Œue
, boŞ 
šşudeS–f
 =rue) const;

90 
vœtu®
 
Ëámo¡Pos™iÚ
(
boŞ
 
šşudeOv”æowIÁ”iÜ
 = 
Œue
, boŞ 
šşudeS–f
 =rue) const;

92 
ü—‹CÚŒŞsShadowRoÙ
();

93 
de¡royCÚŒŞsShadowRoÙ
();

94 
ü—‹Pª–
();

95 
ü—‹Mu‹Bu‰Ú
();

96 
ü—‹PÏyBu‰Ú
();

97 
ü—‹S“kBackBu‰Ú
();

98 
ü—‹S“kFÜw¬dBu‰Ú
();

99 
ü—‹RewšdBu‰Ú
();

100 
ü—‹R‘uºToR—ÉimeBu‰Ú
();

101 
ü—‹ToggËClo£dC­tiÚsBu‰Ú
();

102 
ü—‹StusDi¥Ïy
();

103 
ü—‹Tim–šeCÚš”
();

104 
ü—‹Tim–še
();

105 
ü—‹VŞumeSlid”CÚš”
();

106 
ü—‹VŞumeSlid”
();

107 
ü—‹Cu¼’tTimeDi¥Ïy
();

108 
ü—‹TimeRemaššgDi¥Ïy
();

109 
ü—‹FuÎsü“nBu‰Ú
();

111 
timeUpd©eTim”Fœed
(
Tim”
<
R’d”MedŸ
>*);

113 
upd©eCÚŒŞVisib™y
();

114 
chªgeO·c™y
(
HTMLEËm’t
*, 
İac™y
);

115 
İac™yAnim©iÚTim”Fœed
(
Tim”
<
R’d”MedŸ
>*);

117 
upd©eVŞumeSlid”CÚš”
(
boŞ
 
visibË
);

119 
vœtu®
 
¡yËDidChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
);

121 
	gRefPŒ
<
	gHTMLEËm’t
> 
	gm_cÚŒŞsShadowRoÙ
;

122 
	gRefPŒ
<
	gMedŸCÚŒŞEËm’t
> 
	gm_·Ãl
;

123 
	gRefPŒ
<
	gMedŸCÚŒŞMu‹Bu‰ÚEËm’t
> 
	gm_mu‹Bu‰Ú
;

124 
	gRefPŒ
<
	gMedŸCÚŒŞPÏyBu‰ÚEËm’t
> 
	gm_¶ayBu‰Ú
;

125 
	gRefPŒ
<
	gMedŸCÚŒŞS“kBu‰ÚEËm’t
> 
	gm_£ekBackBu‰Ú
;

126 
	gRefPŒ
<
	gMedŸCÚŒŞS“kBu‰ÚEËm’t
> 
	gm_£ekFÜw¬dBu‰Ú
;

127 
	gRefPŒ
<
	gMedŸCÚŒŞRewšdBu‰ÚEËm’t
> 
	gm_»wšdBu‰Ú
;

128 
	gRefPŒ
<
	gMedŸCÚŒŞR‘uºToR—ÉimeBu‰ÚEËm’t
> 
	gm_»tuºToR—ÉimeBu‰Ú
;

129 
	gRefPŒ
<
	gMedŸCÚŒŞToggËClo£dC­tiÚsBu‰ÚEËm’t
> 
	gm_toggËClo£dC­tiÚsBu‰Ú
;

130 
	gRefPŒ
<
	gMedŸCÚŒŞTim–šeEËm’t
> 
	gm_tim–še
;

131 
	gRefPŒ
<
	gMedŸCÚŒŞVŞumeSlid”EËm’t
> 
	gm_vŞumeSlid”
;

132 
	gRefPŒ
<
	gMedŸCÚŒŞFuÎsü“nBu‰ÚEËm’t
> 
	gm_fuÎsü“nBu‰Ú
;

133 
	gRefPŒ
<
	gMedŸCÚŒŞTim–šeCÚš”EËm’t
> 
	gm_tim–šeCÚš”
;

134 
	gRefPŒ
<
	gMedŸCÚŒŞVŞumeSlid”CÚš”EËm’t
> 
	gm_vŞumeSlid”CÚš”
;

135 
	gRefPŒ
<
	gMedŸCÚŒŞTimeDi¥ÏyEËm’t
> 
	gm_cu¼’tTimeDi¥Ïy
;

136 
	gRefPŒ
<
	gMedŸCÚŒŞTimeDi¥ÏyEËm’t
> 
	gm_timeRemaššgDi¥Ïy
;

137 
	gRefPŒ
<
	gMedŸCÚŒŞStusDi¥ÏyEËm’t
> 
	gm_¡©usDi¥Ïy
;

138 
R’d”ObjeùChdLi¡
 
	gm_chd»n
;

139 
Node
* 
	gm_Ï¡Und”Node
;

140 
Node
* 
	gm_nodeUnd”Mou£
;

142 
	gTim”
<
	gR’d”MedŸ
> 
	gm_timeUpd©eTim”
;

143 
	gTim”
<
	gR’d”MedŸ
> 
	gm_İac™yAnim©iÚTim”
;

144 
boŞ
 
	gm_mou£Ov”
;

145 
	gm_İac™yAnim©iÚS¹Time
;

146 
	gm_İac™yAnim©iÚDu¿tiÚ
;

147 
	gm_İac™yAnim©iÚFrom
;

148 
	gm_İac™yAnim©iÚTo
;

151 
šlše
 
R’d”MedŸ
* 
	$toR’d”MedŸ
(
R’d”Objeù
* 
objeù
)

153 
	`ASSERT
(!
objeù
 || objeù->
	`isMedŸ
());

154  
¡©ic_ÿ¡
<
R’d”MedŸ
*>(
objeù
);

155 
	}
}

158 
toR’d”MedŸ
(cÚ¡ 
R’d”MedŸ
*);

	@RenderMediaControls.cpp

26 
	~"cÚfig.h
"

27 
	~"R’d”MedŸCÚŒŞs.h
"

29 
	~"G¿phicsCÚ‹xt.h
"

30 
	~"HTMLMedŸEËm’t.h
"

31 
	~"HTMLNames.h
"

32 
	~"R’d”ThemeSaçri.h
"

33 
	~"SoáLškšg.h
"

34 
	~<CÜeG¿phics/CÜeG¿phics.h
>

36 
usšg
 
Çme¥aû
 
	g¡d
;

38 
Çme¥aû
 
	gWebCÜe
 {

40 #ifdeà
DEBUG_ALL


41 
SOFT_LINK_DEBUG_LIBRARY
(
SaçriTheme
)

43 
SOFT_LINK_LIBRARY
(
SaçriTheme
)

46 
SOFT_LINK
(
SaçriTheme
, 
·štThemeP¬t
, , 
__¡dÿÎ
, (
ThemeP¬t
 
·¹
, 
CGCÚ‹xtRef
 
cÚ‹xt
, cÚ¡ 
CGReù
& 
»ù
, 
NSCÚŒŞSize
 
size
, 
ThemeCÚŒŞS‹
 
¡©e
), (part, context,„ect, size, state))

47 
SOFT_LINK
(
SaçriTheme
, 
STPaštProg»ssIndiÿtÜ
, , 
APIENTRY
, (
Prog»ssIndiÿtÜTy³
 
ty³
, 
CGCÚ‹xtRef
 
cÚ‹xt
, cÚ¡ 
CGReù
& 
»ù
, 
NSCÚŒŞSize
 
size
, 
ThemeCÚŒŞS‹
 
¡©e
, 
v®ue
), (type, context,„ect, size, state, value))

49 #ià
ENABLE
(
VIDEO
)

51 
ThemeCÚŒŞS‹
 
d‘”mšeS‹
(
R’d”Objeù
* 
o
)

53 
ThemeCÚŒŞS‹
 
	g»suÉ
 = 0;

54 
R’d”Theme
* 
	gtheme
 = 
o
->
theme
();

55 ià(
	gtheme
->
isAùive
(
o
))

56 
	g»suÉ
 |ğ
SaçriTheme
::
AùiveS‹
;

57 ià(
	gtheme
->
isEÇbËd
(
o
è&& !theme->
isR—dOÆyCÚŒŞ
(o))

58 
	g»suÉ
 |ğ
SaçriTheme
::
EÇbËdS‹
;

59 ià(
	gtheme
->
isP»s£d
(
o
))

60 
	g»suÉ
 |ğ
SaçriTheme
::
P»s£dS‹
;

61 ià(
	gtheme
->
isChecked
(
o
))

62 
	g»suÉ
 |ğ
SaçriTheme
::
CheckedS‹
;

63 ià(
	gtheme
->
isInd‘”mš©e
(
o
))

64 
	g»suÉ
 |ğ
SaçriTheme
::
Ind‘”mš©eCheckedS‹
;

65 ià(
	gtheme
->
isFocu£d
(
o
))

66 
	g»suÉ
 |ğ
SaçriTheme
::
Focu£dS‹
;

67 ià(
	gtheme
->
isDeçuÉ
(
o
))

68 
	g»suÉ
 |ğ
SaçriTheme
::
DeçuÉS‹
;

69  
	g»suÉ
;

72 cÚ¡ 
	gmedŸSlid”ThumbWidth
 = 13;

73 cÚ¡ 
	gmedŸSlid”ThumbHeight
 = 14;

75 
	gR’d”MedŸCÚŒŞs
::
adju¡MedŸSlid”ThumbSize
(
R’d”Objeù
* 
o
)

77 ià(
o
->
¡yË
()->
­³¬ªû
(è!ğ
MedŸSlid”ThumbP¬t
)

80 
	gzoomLev–
 = 
o
->
¡yË
()->
efãùiveZoom
();

81 
	go
->
¡yË
()->
£tWidth
(
L’gth
(
¡©ic_ÿ¡
<>(
medŸSlid”ThumbWidth
 * 
zoomLev–
), 
Fixed
));

82 
	go
->
¡yË
()->
£tHeight
(
L’gth
(
¡©ic_ÿ¡
<>(
medŸSlid”ThumbHeight
 * 
zoomLev–
), 
Fixed
));

85 
boŞ
 
	gR’d”MedŸCÚŒŞs
::
·štMedŸCÚŒŞsP¬t
(
MedŸCÚŒŞEËm’tTy³
 
·¹
, 
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

87 
ASSERT
(
SaçriThemeLib¿ry
());

89 
	g·¹
) {

90 
	gMedŸFuÎsü“nBu‰Ú
:

91 
·štThemeP¬t
(
SaçriTheme
::
MedŸFuÎsü“nBu‰ÚP¬t
, 
·štInfo
.
cÚ‹xt
->
¶©fÜmCÚ‹xt
(), 
r
, 
NSReguÏrCÚŒŞSize
, 
d‘”mšeS‹
(
o
));

93 
	gMedŸShowClo£dC­tiÚsBu‰Ú
:

94 
MedŸHideClo£dC­tiÚsBu‰Ú
:

95 #ià
SAFARI_THEME_VERSION
 >= 4

96 ià(
MedŸCÚŒŞToggËClo£dC­tiÚsBu‰ÚEËm’t
* 
bŠ
 = 
¡©ic_ÿ¡
<MedŸCÚŒŞToggËClo£dC­tiÚsBu‰ÚEËm’t*>(
o
->
node
())) {

97 
boŞ
 
ÿ±iÚsVisibË
 = 
bŠ
->
di¥ÏyTy³
(è=ğ
MedŸHideClo£dC­tiÚsBu‰Ú
;

98 
·štThemeP¬t
(
ÿ±iÚsVisibË
 ? 
SaçriTheme
::
MedŸHideClo£dC­tiÚsBu‰ÚP¬t
 : SaçriTheme::
MedŸShowClo£dC­tiÚsBu‰ÚP¬t
, 
·štInfo
.
cÚ‹xt
->
¶©fÜmCÚ‹xt
(), 
r
, 
NSReguÏrCÚŒŞSize
, 
d‘”mšeS‹
(
o
));

102 
	gMedŸMu‹Bu‰Ú
:

103 
MedŸUnMu‹Bu‰Ú
:

104 ià(
MedŸCÚŒŞMu‹Bu‰ÚEËm’t
* 
bŠ
 = 
¡©ic_ÿ¡
<MedŸCÚŒŞMu‹Bu‰ÚEËm’t*>(
o
->
node
())) {

105 
boŞ
 
audioEÇbËd
 = 
bŠ
->
di¥ÏyTy³
(è=ğ
MedŸMu‹Bu‰Ú
;

106 
·štThemeP¬t
(
audioEÇbËd
 ? 
SaçriTheme
::
MedŸMu‹Bu‰ÚP¬t
 : SaçriTheme::
MedŸUnMu‹Bu‰ÚP¬t
, 
·štInfo
.
cÚ‹xt
->
¶©fÜmCÚ‹xt
(), 
r
, 
NSReguÏrCÚŒŞSize
, 
d‘”mšeS‹
(
o
));

109 
	gMedŸPau£Bu‰Ú
:

110 
MedŸPÏyBu‰Ú
:

111 ià(
MedŸCÚŒŞPÏyBu‰ÚEËm’t
* 
bŠ
 = 
¡©ic_ÿ¡
<MedŸCÚŒŞPÏyBu‰ÚEËm’t*>(
o
->
node
())) {

112 
boŞ
 
ÿnPÏy
 = 
bŠ
->
di¥ÏyTy³
(è=ğ
MedŸPÏyBu‰Ú
;

113 
·štThemeP¬t
(
ÿnPÏy
 ? 
SaçriTheme
::
MedŸPÏyBu‰ÚP¬t
 : SaçriTheme::
MedŸPau£Bu‰ÚP¬t
, 
·štInfo
.
cÚ‹xt
->
¶©fÜmCÚ‹xt
(), 
r
, 
NSReguÏrCÚŒŞSize
, 
d‘”mšeS‹
(
o
));

116 
	gMedŸS“kBackBu‰Ú
:

117 
·štThemeP¬t
(
SaçriTheme
::
MedŸS“kBackBu‰ÚP¬t
, 
·štInfo
.
cÚ‹xt
->
¶©fÜmCÚ‹xt
(), 
r
, 
NSReguÏrCÚŒŞSize
, 
d‘”mšeS‹
(
o
));

119 
	gMedŸS“kFÜw¬dBu‰Ú
:

120 
·štThemeP¬t
(
SaçriTheme
::
MedŸS“kFÜw¬dBu‰ÚP¬t
, 
·štInfo
.
cÚ‹xt
->
¶©fÜmCÚ‹xt
(), 
r
, 
NSReguÏrCÚŒŞSize
, 
d‘”mšeS‹
(
o
));

122 
	gMedŸSlid”
: {

123 ià(
HTMLMedŸEËm’t
* 
medŸEËm’t
 = 
toP¬’tMedŸEËm’t
(
o
))

124 
STPaštProg»ssIndiÿtÜ
(
SaçriTheme
::
MedŸTy³
, 
·štInfo
.
cÚ‹xt
->
¶©fÜmCÚ‹xt
(), 
r
, 
NSReguÏrCÚŒŞSize
, 0, 
medŸEËm’t
->
³rûÁLßded
());

127 
	gMedŸSlid”Thumb
:

128 
·štThemeP¬t
(
SaçriTheme
::
MedŸSlid”ThumbP¬t
, 
·štInfo
.
cÚ‹xt
->
¶©fÜmCÚ‹xt
(), 
r
, 
NSReguÏrCÚŒŞSize
, 
d‘”mšeS‹
(
o
));

130 
	gMedŸVŞumeSlid”CÚš”
:

132 
ASSERT_NOT_REACHED
();

134 
	gMedŸVŞumeSlid”
:

136 
ASSERT_NOT_REACHED
();

138 
	gMedŸVŞumeSlid”Thumb
:

140 
ASSERT_NOT_REACHED
();

142 
	gMedŸTim–šeCÚš”
:

143 
ASSERT_NOT_REACHED
();

145 
	gMedŸCu¼’tTimeDi¥Ïy
:

146 
ASSERT_NOT_REACHED
();

148 
	gMedŸTimeRemaššgDi¥Ïy
:

149 
ASSERT_NOT_REACHED
();

151 
	gMedŸCÚŒŞsPª–
:

152 
ASSERT_NOT_REACHED
();

155  
	gçl£
;

	@RenderMediaControls.h

26 #iâdeà
R’d”MedŸCÚŒŞs_h


27 
	#R’d”MedŸCÚŒŞs_h


	)

29 
	~"R’d”Objeù.h
"

30 
	~"MedŸCÚŒŞEËm’ts.h
"

32 
Çme¥aû
 
	gWebCÜe
 {

34 
şass
 
	gHTMLMedŸEËm’t
;

35 şas 
	cR’d”MedŸCÚŒŞs
 {

36 
	gpublic
:

37 
boŞ
 
·štMedŸCÚŒŞsP¬t
(
MedŸCÚŒŞEËm’tTy³
, 
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

38 
adju¡MedŸSlid”ThumbSize
(
R’d”Objeù
*);

	@RenderMediaControlsChromium.cpp

28 
	~"cÚfig.h
"

29 
	~"R’d”MedŸCÚŒŞsChromium.h
"

31 
	~"G¿d›Á.h
"

32 
	~"G¿phicsCÚ‹xt.h
"

33 
	~"HTMLMedŸEËm’t.h
"

34 
	~"HTMLNames.h
"

36 
Çme¥aû
 
	gWebCÜe
 {

38 #ià
ENABLE
(
VIDEO
)

40 
	gWTF
::
	tHashM­
<cÚ¡ *, 
	tImage
*> 
	tMedŸCÚŒŞImageM­
;

41 
MedŸCÚŒŞImageM­
* 
	ggMedŸCÚŒŞImageM­
 = 0;

43 
Image
* 
¶©fÜmResourû
(cÚ¡ * 
Çme
)

45 ià(!
	ggMedŸCÚŒŞImageM­
)

46 
	ggMedŸCÚŒŞImageM­
 = 
Ãw
 
MedŸCÚŒŞImageM­
();

47 ià(
Image
* 
	gimage
 = 
gMedŸCÚŒŞImageM­
->
g‘
(
Çme
))

48  
image
;

49 ià(
Image
* 
	gimage
 = Image::
lßdPÏtfÜmResourû
(
Çme
).
»Ëa£Ref
()) {

50 
gMedŸCÚŒŞImageM­
->
£t
(
Çme
, 
image
);

51  
	gimage
;

53 
ASSERT_NOT_REACHED
();

57 
boŞ
 
hasSourû
(cÚ¡ 
HTMLMedŸEËm’t
* 
medŸEËm’t
)

59  
	gmedŸEËm’t
->
ÃtwÜkS‹
(è!ğ
HTMLMedŸEËm’t
::
NETWORK_EMPTY


60 && 
medŸEËm’t
->
ÃtwÜkS‹
(è!ğ
HTMLMedŸEËm’t
::
NETWORK_NO_SOURCE
;

63 
boŞ
 
·štMedŸBu‰Ú
(
G¿phicsCÚ‹xt
* 
cÚ‹xt
, cÚ¡ 
IÁReù
& 
»ù
, 
Image
* 
image
)

65 
IÁReù
 
	gimageReù
 = 
image
->
»ù
();

66 
	gcÚ‹xt
->
d¿wImage
(
image
, 
DeviûCŞÜS·û
, 
»ù
);

67  
	gŒue
;

70 
boŞ
 
·štMedŸMu‹Bu‰Ú
(
R’d”Objeù
* 
objeù
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
»ù
)

72 
HTMLMedŸEËm’t
* 
	gmedŸEËm’t
 = 
toP¬’tMedŸEËm’t
(
objeù
);

73 ià(!
	gmedŸEËm’t
)

74  
	gçl£
;

76 
Image
* 
	gsoundFuÎ
 = 
¶©fÜmResourû
("mediaSoundFull");

77 
Image
* 
	gsoundNÚe
 = 
¶©fÜmResourû
("mediaSoundNone");

78 
Image
* 
	gsoundDi§bËd
 = 
¶©fÜmResourû
("mediaSoundDisabled");

80 ià(!
hasSourû
(
medŸEËm’t
è|| !
	gmedŸEËm’t
->
hasAudio
())

81  
·štMedŸBu‰Ú
(
·štInfo
.
cÚ‹xt
, 
»ù
, 
soundDi§bËd
);

83  
·štMedŸBu‰Ú
(
·štInfo
.
cÚ‹xt
, 
»ù
, 
medŸEËm’t
->
mu‹d
(è? 
soundNÚe
: 
soundFuÎ
);

86 
boŞ
 
·štMedŸPÏyBu‰Ú
(
R’d”Objeù
* 
objeù
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
»ù
)

88 
HTMLMedŸEËm’t
* 
	gmedŸEËm’t
 = 
toP¬’tMedŸEËm’t
(
objeù
);

89 ià(!
	gmedŸEËm’t
)

90  
	gçl£
;

92 
Image
* 
	gmedŸPÏy
 = 
¶©fÜmResourû
("mediaPlay");

93 
Image
* 
	gmedŸPau£
 = 
¶©fÜmResourû
("mediaPause");

94 
Image
* 
	gmedŸPÏyDi§bËd
 = 
¶©fÜmResourû
("mediaPlayDisabled");

96 ià(!
hasSourû
(
medŸEËm’t
))

97  
·štMedŸBu‰Ú
(
·štInfo
.
cÚ‹xt
, 
»ù
, 
medŸPÏyDi§bËd
);

99  
·štMedŸBu‰Ú
(
·štInfo
.
cÚ‹xt
, 
»ù
, 
medŸEËm’t
->
·u£d
(è? 
medŸPÏy
 : 
medŸPau£
);

102 
boŞ
 
·štMedŸSlid”
(
R’d”Objeù
* 
objeù
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
»ù
)

104 
HTMLMedŸEËm’t
* 
	gmedŸEËm’t
 = 
toP¬’tMedŸEËm’t
(
objeù
);

105 ià(!
	gmedŸEËm’t
)

106  
	gçl£
;

108 
R’d”StyË
* 
	g¡yË
 = 
objeù
->
¡yË
();

109 
G¿phicsCÚ‹xt
* 
	gcÚ‹xt
 = 
·štInfo
.
cÚ‹xt
;

114 
	gcÚ‹xt
->
§ve
();

115 
	gcÚ‹xt
->
£tShouldAÁŸlŸs
(
Œue
);

116 
	gcÚ‹xt
->
£tSŒokeStyË
(
SŞidSŒoke
);

117 
	gcÚ‹xt
->
£tSŒokeCŞÜ
(
¡yË
->
bÜd”LeáCŞÜ
(), 
DeviûCŞÜS·û
);

118 
	gcÚ‹xt
->
£tSŒokeThickÃss
(
¡yË
->
bÜd”LeáWidth
());

119 
	gcÚ‹xt
->
£tFlCŞÜ
(
¡yË
->
backgroundCŞÜ
(), 
DeviûCŞÜS·û
);

120 
	gcÚ‹xt
->
d¿wReù
(
»ù
);

121 
	gcÚ‹xt
->
»¡Üe
();

125 
IÁReù
 
	gbufã»dReù
 = 
»ù
;

126 
	gbufã»dReù
.
šæ©e
(-
¡yË
->
bÜd”LeáWidth
());

127 
	gbufã»dReù
.
£tWidth
((
bufã»dReù
.
width
(è* 
medŸEËm’t
->
³rûÁLßded
()));

130 ià(!
	gbufã»dReù
.
isEm±y
()) {

131 
IÁPošt
 
	g¦id”TİLeá
 = 
bufã»dReù
.
loÿtiÚ
();

132 
IÁPošt
 
	g¦id”TİRight
 = 
¦id”TİLeá
;

133 
	g¦id”TİRight
.
move
(0, 
bufã»dReù
.
height
());

135 
	gRefPŒ
<
	gG¿d›Á
> 
	gg¿d›Á
 = 
G¿d›Á
::
ü—‹
(
¦id”TİLeá
, 
¦id”TİRight
);

136 
CŞÜ
 
	g¡¬tCŞÜ
 = 
objeù
->
¡yË
()->
cŞÜ
();

137 
	gg¿d›Á
->
addCŞÜStİ
(0.0, 
¡¬tCŞÜ
);

138 
	gg¿d›Á
->
addCŞÜStİ
(1.0, 
CŞÜ
(
¡¬tCŞÜ
.
»d
(è/ 2, s¹CŞÜ.
g»’
(è/ 2, s¹CŞÜ.
blue
(è/ 2, s¹CŞÜ.
®pha
()));

140 
	gcÚ‹xt
->
§ve
();

141 
	gcÚ‹xt
->
£tSŒokeStyË
(
NoSŒoke
);

142 
	gcÚ‹xt
->
£tFlG¿d›Á
(
g¿d›Á
);

143 
	gcÚ‹xt
->
flReù
(
bufã»dReù
);

144 
	gcÚ‹xt
->
»¡Üe
();

147  
	gŒue
;

150 
boŞ
 
·štMedŸSlid”Thumb
(
R’d”Objeù
* 
objeù
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
»ù
)

152 ià(!
	gobjeù
->
·»Á
()->
isSlid”
())

153  
	gçl£
;

155 
HTMLMedŸEËm’t
* 
	gmedŸEËm’t
 = 
toP¬’tMedŸEËm’t
(
objeù
->
·»Á
());

156 ià(!
	gmedŸEËm’t
)

157  
	gçl£
;

159 ià(!
hasSourû
(
medŸEËm’t
))

160  
	gŒue
;

162 
Image
* 
	gmedŸSlid”Thumb
 = 
¶©fÜmResourû
("mediaSliderThumb");

163  
·štMedŸBu‰Ú
(
·štInfo
.
cÚ‹xt
, 
»ù
, 
medŸSlid”Thumb
);

166 
boŞ
 
·štMedŸVŞumeSlid”
(
R’d”Objeù
* 
objeù
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
»ù
)

168 
HTMLMedŸEËm’t
* 
	gmedŸEËm’t
 = 
toP¬’tMedŸEËm’t
(
objeù
);

169 ià(!
	gmedŸEËm’t
)

170  
	gçl£
;

172 
G¿phicsCÚ‹xt
* 
	gcÚ‹xt
 = 
·štInfo
.
cÚ‹xt
;

173 
CŞÜ
 
	gÜigš®CŞÜ
 = 
cÚ‹xt
->
¡rokeCŞÜ
();

174 ià(
	gÜigš®CŞÜ
 !ğ
CŞÜ
::
wh™e
)

175 
cÚ‹xt
->
£tSŒokeCŞÜ
(
CŞÜ
::
wh™e
, 
DeviûCŞÜS·û
);

177 
	gx
 = 
»ù
.
x
(è+„eù.
width
() / 2;

178 
	gcÚ‹xt
->
d¿wLše
(
IÁPošt
(
x
, 
»ù
.
y
()), IÁPošt(x,„eù.y(è+„eù.
height
()));

180 ià(
	gÜigš®CŞÜ
 !ğ
CŞÜ
::
wh™e
)

181 
cÚ‹xt
->
£tSŒokeCŞÜ
(
Üigš®CŞÜ
, 
DeviûCŞÜS·û
);

182  
	gŒue
;

185 
boŞ
 
·štMedŸVŞumeSlid”Thumb
(
R’d”Objeù
* 
objeù
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
»ù
)

187 ià(!
	gobjeù
->
·»Á
()->
isSlid”
())

188  
	gçl£
;

190 
Image
* 
	gmedŸVŞumeSlid”Thumb
 = 
¶©fÜmResourû
("mediaVolumeSliderThumb");

191  
·štMedŸBu‰Ú
(
·štInfo
.
cÚ‹xt
, 
»ù
, 
medŸVŞumeSlid”Thumb
);

194 
boŞ
 
·štMedŸTim–šeCÚš”
(
R’d”Objeù
* 
objeù
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
»ù
)

196 
HTMLMedŸEËm’t
* 
	gmedŸEËm’t
 = 
toP¬’tMedŸEËm’t
(
objeù
);

197 ià(!
	gmedŸEËm’t
)

198  
	gçl£
;

200 ià(!
	g»ù
.
isEm±y
()) {

201 
G¿phicsCÚ‹xt
* 
	gcÚ‹xt
 = 
·štInfo
.
cÚ‹xt
;

202 
CŞÜ
 
	gÜigš®CŞÜ
 = 
cÚ‹xt
->
¡rokeCŞÜ
();

203 
	gÜigš®ThickÃss
 = 
cÚ‹xt
->
¡rokeThickÃss
();

204 
SŒokeStyË
 
	gÜigš®StyË
 = 
cÚ‹xt
->
¡rokeStyË
();

206 
	gcÚ‹xt
->
£tSŒokeStyË
(
SŞidSŒoke
);

209 
	gcÚ‹xt
->
£tSŒokeThickÃss
(
objeù
->
¡yË
()->
bÜd”LeáWidth
());

210 
	gcÚ‹xt
->
£tSŒokeCŞÜ
(
objeù
->
¡yË
()->
bÜd”LeáCŞÜ
().
rgb
(), 
DeviûCŞÜS·û
);

211 
	gcÚ‹xt
->
d¿wLše
(
IÁPošt
(
»ù
.
x
(è+ 1,„eù.
y
()),

212 
IÁPošt
(
»ù
.
x
(è+ 1,„eù.
y
(è+„eù.
height
()));

215 
	gcÚ‹xt
->
£tSŒokeThickÃss
(
objeù
->
¡yË
()->
bÜd”RightWidth
());

216 
	gcÚ‹xt
->
£tSŒokeCŞÜ
(
objeù
->
¡yË
()->
bÜd”RightCŞÜ
().
rgb
(), 
DeviûCŞÜS·û
);

217 
	gcÚ‹xt
->
d¿wLše
(
IÁPošt
(
»ù
.
x
(è+„eù.
width
(è- 1,„eù.
y
()),

218 
IÁPošt
(
»ù
.
x
(è+„eù.
width
(è- 1,„eù.
y
(è+„eù.
height
()));

220 
	gcÚ‹xt
->
£tSŒokeCŞÜ
(
Üigš®CŞÜ
, 
DeviûCŞÜS·û
);

221 
	gcÚ‹xt
->
£tSŒokeThickÃss
(
Üigš®ThickÃss
);

222 
	gcÚ‹xt
->
£tSŒokeStyË
(
Üigš®StyË
);

224  
	gŒue
;

227 
boŞ
 
	gR’d”MedŸCÚŒŞsChromium
::
shouldR’d”MedŸCÚŒŞP¬t
(
CÚŒŞP¬t
 
·¹
, 
EËm’t
* 
e
)

229 
UNUSED_PARAM
(
e
);

231 
	g·¹
) {

232 
	gMedŸMu‹Bu‰ÚP¬t
:

233 
MedŸPÏyBu‰ÚP¬t
:

234 
MedŸSlid”P¬t
:

235 
MedŸSlid”ThumbP¬t
:

236 
MedŸVŞumeSlid”CÚš”P¬t
:

237 
MedŸVŞumeSlid”P¬t
:

238 
MedŸVŞumeSlid”ThumbP¬t
:

239 
MedŸCÚŒŞsBackgroundP¬t
:

240 
MedŸCu¼’tTimeP¬t
:

241 
MedŸTimeRemaššgP¬t
:

242  
Œue
;

246  
	gçl£
;

249 
boŞ
 
	gR’d”MedŸCÚŒŞsChromium
::
·štMedŸCÚŒŞsP¬t
(
MedŸCÚŒŞEËm’tTy³
 
·¹
, 
R’d”Objeù
* 
objeù
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
»ù
)

251 
	g·¹
) {

252 
	gMedŸMu‹Bu‰Ú
:

253 
MedŸUnMu‹Bu‰Ú
:

254  
·štMedŸMu‹Bu‰Ú
(
objeù
, 
·štInfo
, 
»ù
);

255 
	gMedŸPau£Bu‰Ú
:

256 
MedŸPÏyBu‰Ú
:

257  
·štMedŸPÏyBu‰Ú
(
objeù
, 
·štInfo
, 
»ù
);

258 
	gMedŸSlid”
:

259  
·štMedŸSlid”
(
objeù
, 
·štInfo
, 
»ù
);

260 
	gMedŸSlid”Thumb
:

261  
·štMedŸSlid”Thumb
(
objeù
, 
·štInfo
, 
»ù
);

262 
	gMedŸVŞumeSlid”
:

263  
·štMedŸVŞumeSlid”
(
objeù
, 
·štInfo
, 
»ù
);

264 
	gMedŸVŞumeSlid”Thumb
:

265  
·štMedŸVŞumeSlid”Thumb
(
objeù
, 
·štInfo
, 
»ù
);

266 
	gMedŸTim–šeCÚš”
:

267  
·štMedŸTim–šeCÚš”
(
objeù
, 
·štInfo
, 
»ù
);

268 
	gMedŸFuÎsü“nBu‰Ú
:

269 
MedŸS“kBackBu‰Ú
:

270 
MedŸS“kFÜw¬dBu‰Ú
:

271 
MedŸVŞumeSlid”CÚš”
:

272 
MedŸCu¼’tTimeDi¥Ïy
:

273 
MedŸTimeRemaššgDi¥Ïy
:

274 
MedŸCÚŒŞsPª–
:

275 
MedŸRewšdBu‰Ú
:

276 
MedŸR‘uºToR—ÉimeBu‰Ú
:

277 
MedŸStusDi¥Ïy
:

278 
MedŸShowClo£dC­tiÚsBu‰Ú
:

279 
MedŸHideClo£dC­tiÚsBu‰Ú
:

280 
ASSERT_NOT_REACHED
();

283  
	gçl£
;

286 
	gR’d”MedŸCÚŒŞsChromium
::
adju¡MedŸSlid”ThumbSize
(
R’d”Objeù
* 
objeù
)

288 
Image
* 
medŸSlid”Thumb
 = 
¶©fÜmResourû
("mediaSliderThumb");

289 
Image
* 
	gmedŸVŞumeSlid”Thumb
 = 
¶©fÜmResourû
("mediaVolumeSliderThumb");

291 
Image
* 
	gthumbImage
 = 0;

292 ià(
	gobjeù
->
¡yË
()->
­³¬ªû
(è=ğ
MedŸSlid”ThumbP¬t
)

293 
thumbImage
 = 
medŸSlid”Thumb
;

294 ià(
	gobjeù
->
¡yË
()->
­³¬ªû
(è=ğ
MedŸVŞumeSlid”ThumbP¬t
)

295 
thumbImage
 = 
medŸVŞumeSlid”Thumb
;

297 
	gzoomLev–
 = 
objeù
->
¡yË
()->
efãùiveZoom
();

298 ià(
	gthumbImage
) {

299 
	gobjeù
->
¡yË
()->
£tWidth
(
L’gth
(
¡©ic_ÿ¡
<>(
thumbImage
->
width
(è* 
zoomLev–
), 
Fixed
));

300 
	gobjeù
->
¡yË
()->
£tHeight
(
L’gth
(
¡©ic_ÿ¡
<>(
thumbImage
->
height
(è* 
zoomLev–
), 
Fixed
));

	@RenderMediaControlsChromium.h

28 #iâdeà
R’d”MedŸCÚŒŞsChromium_h


29 
	#R’d”MedŸCÚŒŞsChromium_h


	)

31 
	~"R’d”Objeù.h
"

32 
	~"MedŸCÚŒŞEËm’ts.h
"

34 
Çme¥aû
 
	gWebCÜe
 {

36 
şass
 
	gHTMLMedŸEËm’t
;

37 şas 
	cR’d”MedŸCÚŒŞsChromium
 {

38 
	gpublic
:

39 
boŞ
 
shouldR’d”MedŸCÚŒŞP¬t
(
CÚŒŞP¬t
, 
EËm’t
*);

40 
boŞ
 
·štMedŸCÚŒŞsP¬t
(
MedŸCÚŒŞEËm’tTy³
, 
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

41 
adju¡MedŸSlid”ThumbSize
(
R’d”Objeù
*);

	@RenderMenuList.cpp

25 
	~"cÚfig.h
"

26 
	~"R’d”M’uLi¡.h
"

28 
	~"AXObjeùCache.h
"

29 
	~"Acûssib™yObjeù.h
"

30 
	~"CSSStyËS–eùÜ.h
"

31 
	~"F¿me.h
"

32 
	~"F¿meV›w.h
"

33 
	~"HTMLNames.h
"

34 
	~"NodeR’d”StyË.h
"

35 
	~"O±iÚEËm’t.h
"

36 
	~"O±iÚGroupEËm’t.h
"

37 
	~"PİupM’u.h
"

38 
	~"R’d”BR.h
"

39 
	~"R’d”SüŞlb¬.h
"

40 
	~"R’d”Theme.h
"

41 
	~"S–eùEËm’t.h
"

42 
	~<m©h.h
>

44 
usšg
 
Çme¥aû
 
	g¡d
;

46 
Çme¥aû
 
	gWebCÜe
 {

48 
usšg
 
Çme¥aû
 
	gHTMLNames
;

50 
	gR’d”M’uLi¡
::
R’d”M’uLi¡
(
EËm’t
* 
–em’t
)

51 : 
R’d”FËxibËBox
(
–em’t
)

52 , 
m_bu‰ÚText
(0)

53 , 
m_šÃrBlock
(0)

54 , 
m_İtiÚsChªged
(
Œue
)

55 , 
m_İtiÚsWidth
(0)

56 , 
m_Ï¡S–eùedIndex
(-1)

57 , 
m_pİup
(0)

58 , 
m_pİupIsVisibË
(
çl£
)

62 
	gR’d”M’uLi¡
::~
R’d”M’uLi¡
()

64 ià(
m_pİup
)

65 
m_pİup
->
discÚÃùCl›Á
();

66 
	gm_pİup
 = 0;

69 
	gR’d”M’uLi¡
::
ü—‹IÂ”Block
()

71 ià(
m_šÃrBlock
) {

72 
ASSERT
(
fœ¡Chd
(è=ğ
m_šÃrBlock
);

73 
ASSERT
(!
m_šÃrBlock
->
ÃxtSiblšg
());

78 
ASSERT
(!
fœ¡Chd
());

79 
	gm_šÃrBlock
 = 
ü—‹AnÚymousBlock
();

80 
adju¡IÂ”StyË
();

81 
	gR’d”FËxibËBox
::
addChd
(
m_šÃrBlock
);

84 
	gR’d”M’uLi¡
::
adju¡IÂ”StyË
()

86 
m_šÃrBlock
->
¡yË
()->
£tBoxFËx
(1.0f);

88 
	gm_šÃrBlock
->
¡yË
()->
£tPaddšgLeá
(
L’gth
(
theme
()->
pİupIÁ”ÇlPaddšgLeá
(¡yË()), 
Fixed
));

89 
	gm_šÃrBlock
->
¡yË
()->
£tPaddšgRight
(
L’gth
(
theme
()->
pİupIÁ”ÇlPaddšgRight
(¡yË()), 
Fixed
));

90 
	gm_šÃrBlock
->
¡yË
()->
£tPaddšgTİ
(
L’gth
(
theme
()->
pİupIÁ”ÇlPaddšgTİ
(¡yË()), 
Fixed
));

91 
	gm_šÃrBlock
->
¡yË
()->
£tPaddšgBÙtom
(
L’gth
(
theme
()->
pİupIÁ”ÇlPaddšgBÙtom
(¡yË()), 
Fixed
));

93 ià(
	gPİupM’u
::
™emWr™šgDœeùiÚIsN©u¿l
()) {

96 
m_šÃrBlock
->
¡yË
()->
£tTextAlign
(
LEFT
);

97 
TextDœeùiÚ
 
	gdœeùiÚ
 = (
m_bu‰ÚText
 && m_bu‰ÚText->
‹xt
()->
deçuÉWr™šgDœeùiÚ
(è=ğ
WTF
::
Unicode
::
RightToLeá
è? 
RTL
 : 
LTR
;

98 
	gm_šÃrBlock
->
¡yË
()->
£tDœeùiÚ
(
dœeùiÚ
);

102 
	gR’d”M’uLi¡
::
addChd
(
R’d”Objeù
* 
ÃwChd
, R’d”Objeù* 
befÜeChd
)

104 
ü—‹IÂ”Block
();

105 
	gm_šÃrBlock
->
addChd
(
ÃwChd
, 
befÜeChd
);

108 
	gR’d”M’uLi¡
::
»moveChd
(
R’d”Objeù
* 
ŞdChd
)

110 ià(
ŞdChd
 =ğ
m_šÃrBlock
 || !m_innerBlock) {

111 
R’d”FËxibËBox
::
»moveChd
(
ŞdChd
);

112 
	gm_šÃrBlock
 = 0;

114 
	gm_šÃrBlock
->
»moveChd
(
ŞdChd
);

117 
	gR’d”M’uLi¡
::
¡yËDidChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
)

119 
	gR’d”Block
::
¡yËDidChªge
(
diff
, 
ŞdStyË
);

121 ià(
	gm_bu‰ÚText
)

122 
	gm_bu‰ÚText
->
£tStyË
(
¡yË
());

123 ià(
	gm_šÃrBlock
)

124 
adju¡IÂ”StyË
();

126 
£tR•Ïûd
(
isIÆše
());

128 
boŞ
 
	gfÚtChªged
 = !
ŞdStyË
 || oldStyË->
fÚt
(è!ğ
¡yË
()->font();

129 ià(
	gfÚtChªged
)

130 
upd©eO±iÚsWidth
();

133 
	gR’d”M’uLi¡
::
upd©eO±iÚsWidth
()

135 
maxO±iÚWidth
 = 0;

136 cÚ¡ 
	gVeùÜ
<
	gEËm’t
*>& 
	gli¡I‹ms
 = 
toS–eùEËm’t
(
¡©ic_ÿ¡
<
EËm’t
*>(
node
()))->
li¡I‹ms
();

137 
	gsize
 = 
li¡I‹ms
.
size
();

138 
	gi
 = 0; i < 
	gsize
; ++i) {

139 
EËm’t
* 
	g–em’t
 = 
li¡I‹ms
[
i
];

140 
O±iÚEËm’t
* 
	gİtiÚEËm’t
 = 
toO±iÚEËm’t
(
–em’t
);

141 ià(!
	gİtiÚEËm’t
)

144 
SŒšg
 
	g‹xt
 = 
İtiÚEËm’t
->
‹xtInd’‹dToRe¥eùGroupLab–
();

145 ià(
theme
()->
pİupO±iÚSuµÜtsTextInd’t
()) {

147 
	gİtiÚWidth
 = 0;

148 ià(
R’d”StyË
* 
	gİtiÚStyË
 = 
–em’t
->
»nd”StyË
())

149 
İtiÚWidth
 +ğ
İtiÚStyË
->
‹xtInd’t
().
ÿlcMšV®ue
(0);

150 ià(!
	g‹xt
.
isEm±y
())

151 
	gİtiÚWidth
 +ğ
¡yË
()->
fÚt
().
æßtWidth
(
‹xt
);

152 
	gmaxO±iÚWidth
 = 
max
(
maxO±iÚWidth
, 
İtiÚWidth
);

153 } ià(!
	g‹xt
.
isEm±y
())

154 
	gmaxO±iÚWidth
 = 
max
(
maxO±iÚWidth
, 
¡yË
()->
fÚt
().
æßtWidth
(
‹xt
));

157 
	gwidth
 = 
¡©ic_ÿ¡
<>(
ûf
(
maxO±iÚWidth
));

158 ià(
	gm_İtiÚsWidth
 =ğ
width
)

161 
	gm_İtiÚsWidth
 = 
width
;

162 ià(
·»Á
())

163 
£tN“dsLayoutAndP»fWidthsReÿlc
();

166 
	gR’d”M’uLi¡
::
upd©eFromEËm’t
()

168 ià(
m_İtiÚsChªged
) {

169 
upd©eO±iÚsWidth
();

170 
	gm_İtiÚsChªged
 = 
çl£
;

173 ià(
	gm_pİupIsVisibË
)

174 
	gm_pİup
->
upd©eFromEËm’t
();

176 
£tTextFromO±iÚ
(
toS–eùEËm’t
(
¡©ic_ÿ¡
<
EËm’t
*>(
node
()))->
£ËùedIndex
());

179 
	gR’d”M’uLi¡
::
£tTextFromO±iÚ
(
İtiÚIndex
)

181 
S–eùEËm’t
* 
£Ëù
 = 
toS–eùEËm’t
(
¡©ic_ÿ¡
<
EËm’t
*>(
node
()));

182 cÚ¡ 
	gVeùÜ
<
	gEËm’t
*>& 
	gli¡I‹ms
 = 
£Ëù
->
li¡I‹ms
();

183 
	gsize
 = 
li¡I‹ms
.
size
();

185 
	gi
 = 
£Ëù
->
İtiÚToLi¡Index
(
İtiÚIndex
);

186 
SŒšg
 
	g‹xt
 = "";

187 ià(
	gi
 >ğ0 && 
i
 < 
size
) {

188 ià(
O±iÚEËm’t
* 
İtiÚEËm’t
 = 
toO±iÚEËm’t
(
li¡I‹ms
[
i
]))

189 
‹xt
 = 
İtiÚEËm’t
->
‹xtInd’‹dToRe¥eùGroupLab–
();

192 
£tText
(
‹xt
.
¡rWh™eS·û
());

195 
	gR’d”M’uLi¡
::
£tText
(cÚ¡ 
SŒšg
& 
s
)

197 ià(
s
.
isEm±y
()) {

198 ià(!
m_bu‰ÚText
 || !m_bu‰ÚText->
isBR
()) {

199 ià(
m_bu‰ÚText
)

200 
m_bu‰ÚText
->
de¡roy
();

201 
	gm_bu‰ÚText
 = 
Ãw
 (
»nd”A»Ç
()è
R’d”BR
(
docum’t
());

202 
	gm_bu‰ÚText
->
£tStyË
(
¡yË
());

203 
addChd
(
m_bu‰ÚText
);

206 ià(
	gm_bu‰ÚText
 && !m_bu‰ÚText->
isBR
())

207 
	gm_bu‰ÚText
->
£tText
(
s
.
im¶
());

209 ià(
	gm_bu‰ÚText
)

210 
	gm_bu‰ÚText
->
de¡roy
();

211 
	gm_bu‰ÚText
 = 
Ãw
 (
»nd”A»Ç
()è
R’d”Text
(
docum’t
(), 
s
.
im¶
());

212 
	gm_bu‰ÚText
->
£tStyË
(
¡yË
());

213 
addChd
(
m_bu‰ÚText
);

215 
adju¡IÂ”StyË
();

219 
SŒšg
 
	gR’d”M’uLi¡
::
‹xt
() const

221  
m_bu‰ÚText
 ? m_bu‰ÚText->
‹xt
() : 0;

224 
IÁReù
 
	gR’d”M’uLi¡
::
cÚŒŞClReù
(
tx
, 
ty
) const

229 
IÁReù
 
ou‹rBox
(
tx
 + 
bÜd”Leá
(è+ 
·ddšgLeá
(),

230 
ty
 + 
bÜd”Tİ
(è+ 
·ddšgTİ
(),

231 
cÚ‹ÁWidth
(),

232 
cÚ‹ÁHeight
());

234 
IÁReù
 
šÃrBox
(
tx
 + 
m_šÃrBlock
->
x
(è+ m_šÃrBlock->
·ddšgLeá
(),

235 
ty
 + 
m_šÃrBlock
->
y
(è+ m_šÃrBlock->
·ddšgTİ
(),

236 
m_šÃrBlock
->
cÚ‹ÁWidth
(),

237 
m_šÃrBlock
->
cÚ‹ÁHeight
());

239  
š‹r£ùiÚ
(
ou‹rBox
, 
šÃrBox
);

242 
	gR’d”M’uLi¡
::
ÿlcP»fWidths
()

244 
m_mšP»fWidth
 = 0;

245 
	gm_maxP»fWidth
 = 0;

247 ià(
¡yË
()->
width
().
isFixed
(è&& styË()->width().
v®ue
() > 0)

248 
	gm_mšP»fWidth
 = 
m_maxP»fWidth
 = 
ÿlcCÚ‹ÁBoxWidth
(
¡yË
()->
width
().
v®ue
());

250 
	gm_maxP»fWidth
 = 
max
(
m_İtiÚsWidth
, 
theme
()->
mšimumM’uLi¡Size
(
¡yË
())è+ 
	gm_šÃrBlock
->
·ddšgLeá
(è+ m_šÃrBlock->
·ddšgRight
();

252 ià(
¡yË
()->
mšWidth
().
isFixed
(è&& styË()->mšWidth().
v®ue
() > 0) {

253 
	gm_maxP»fWidth
 = 
max
(
m_maxP»fWidth
, 
ÿlcCÚ‹ÁBoxWidth
(
¡yË
()->
mšWidth
().
v®ue
()));

254 
	gm_mšP»fWidth
 = 
max
(
m_mšP»fWidth
, 
ÿlcCÚ‹ÁBoxWidth
(
¡yË
()->
mšWidth
().
v®ue
()));

255 } ià(
¡yË
()->
width
().
isP”ûÁ
(è|| (¡yË()->width().
isAuto
(è&& styË()->
height
().isPercent()))

256 
	gm_mšP»fWidth
 = 0;

258 
	gm_mšP»fWidth
 = 
m_maxP»fWidth
;

260 ià(
¡yË
()->
maxWidth
().
isFixed
(è&& styË()->maxWidth().
v®ue
(è!ğ
undefšedL’gth
) {

261 
m_maxP»fWidth
 = 
mš
(m_maxP»fWidth, 
ÿlcCÚ‹ÁBoxWidth
(
¡yË
()->
maxWidth
().
v®ue
()));

262 
	gm_mšP»fWidth
 = 
mš
(
m_mšP»fWidth
, 
ÿlcCÚ‹ÁBoxWidth
(
¡yË
()->
maxWidth
().
v®ue
()));

265 
	gtoAdd
 = 
·ddšgLeá
(è+ 
·ddšgRight
(è+ 
bÜd”Leá
(è+ 
bÜd”Right
();

266 
	gm_mšP»fWidth
 +ğ
toAdd
;

267 
	gm_maxP»fWidth
 +ğ
toAdd
;

269 
£tP»fWidthsDœty
(
çl£
);

272 
	gR’d”M’uLi¡
::
showPİup
()

274 ià(
m_pİupIsVisibË
)

280 
ü—‹IÂ”Block
();

281 ià(!
	gm_pİup
)

282 
	gm_pİup
 = 
PİupM’u
::
ü—‹
(
this
);

283 
S–eùEËm’t
* 
	g£Ëù
 = 
toS–eùEËm’t
(
¡©ic_ÿ¡
<
EËm’t
*>(
node
()));

284 
	gm_pİupIsVisibË
 = 
Œue
;

288 
FlßtPošt
 
	gabsTİLeá
 = 
loÿlToAbsŞu‹
(FlßtPošt(), 
çl£
, 
Œue
);

289 
IÁReù
 
	gabsBounds
 = 
absŞu‹BoundšgBoxReù
();

290 
	gabsBounds
.
£tLoÿtiÚ
(
roundedIÁPošt
(
absTİLeá
));

291 
	gm_pİup
->
show
(
absBounds
, 
docum’t
()->
v›w
(),

292 
£Ëù
->
İtiÚToLi¡Index
(£Ëù->
£ËùedIndex
()));

295 
	gR’d”M’uLi¡
::
hidePİup
()

297 ià(
m_pİup
)

298 
m_pİup
->
hide
();

301 
	gR’d”M’uLi¡
::
v®ueChªged
(
li¡Index
, 
boŞ
 
fœeOnChªge
)

305 
Docum’t
* 
	gdoc
 = 
¡©ic_ÿ¡
<
EËm’t
*>(
node
())->
docum’t
();

306 ià(!
	gdoc
 || doø!ğ
doc
->
äame
()->
docum’t
())

309 
S–eùEËm’t
* 
	g£Ëù
 = 
toS–eùEËm’t
(
¡©ic_ÿ¡
<
EËm’t
*>(
node
()));

310 
	g£Ëù
->
£tS–eùedIndexByU£r
(
£Ëù
->
li¡ToO±iÚIndex
(
li¡Index
), 
Œue
, 
fœeOnChªge
);

313 #ià
ENABLE
(
NO_LISTBOX_RENDERING
)

314 
	gR’d”M’uLi¡
::
li¡BoxS–eùI‹m
(
li¡Index
, 
boŞ
 
®lowMuÉlyS–eùiÚs
, boŞ 
shiá
, boŞ 
fœeOnChªgeNow
)

316 
S–eùEËm’t
* 
	g£Ëù
 = 
toS–eùEËm’t
(
¡©ic_ÿ¡
<
EËm’t
*>(
node
()));

317 
	g£Ëù
->
li¡BoxS–eùI‹m
(
£Ëù
->
li¡ToO±iÚIndex
(
li¡Index
), 
®lowMuÉlyS–eùiÚs
, 
shiá
, 
fœeOnChªgeNow
);

320 
boŞ
 
	gR’d”M’uLi¡
::
muÉË
()

322 
S–eùEËm’t
* 
£Ëù
 = 
toS–eùEËm’t
(
¡©ic_ÿ¡
<
EËm’t
*>(
node
()));

323  
	g£Ëù
->
muÉË
();

327 
	gR’d”M’uLi¡
::
didS‘S–eùedIndex
()

329 
šdex
 = 
£ËùedIndex
();

330 ià(
	gm_Ï¡S–eùedIndex
 =ğ
šdex
)

333 
	gm_Ï¡S–eùedIndex
 = 
šdex
;

335 ià(
	gAXObjeùCache
::
acûssib™yEÇbËd
())

336 
docum’t
()->
axObjeùCache
()->
po¡NÙifiÿtiÚ
(
this
, 
AXObjeùCache
::
AXM’uLi¡V®ueChªged
, 
Œue
, 
Po¡SynchrÚou¦y
);

339 
SŒšg
 
	gR’d”M’uLi¡
::
™emText
(
li¡Index
) const

341 
S–eùEËm’t
* 
£Ëù
 = 
toS–eùEËm’t
(
¡©ic_ÿ¡
<
EËm’t
*>(
node
()));

342 cÚ¡ 
	gVeùÜ
<
	gEËm’t
*>& 
	gli¡I‹ms
 = 
£Ëù
->
li¡I‹ms
();

343 ià(
	gli¡Index
 >ğ
li¡I‹ms
.
size
())

344  
SŒšg
();

345 
EËm’t
* 
	g–em’t
 = 
li¡I‹ms
[
li¡Index
];

346 ià(
O±iÚGroupEËm’t
* 
	gİtiÚGroupEËm’t
 = 
toO±iÚGroupEËm’t
(
–em’t
))

347  
İtiÚGroupEËm’t
->
groupLab–Text
();

348 ià(
O±iÚEËm’t
* 
	gİtiÚEËm’t
 = 
toO±iÚEËm’t
(
–em’t
))

349  
İtiÚEËm’t
->
‹xtInd’‹dToRe¥eùGroupLab–
();

350  
SŒšg
();

353 
SŒšg
 
	gR’d”M’uLi¡
::
™emAcûssib™yText
(
li¡Index
) const

356 
S–eùEËm’t
* 
£Ëù
 = 
toS–eùEËm’t
(
¡©ic_ÿ¡
<
EËm’t
*>(
node
()));

357 cÚ¡ 
	gVeùÜ
<
	gEËm’t
*>& 
	gli¡I‹ms
 = 
£Ëù
->
li¡I‹ms
();

358 ià(
	gli¡Index
 >ğ
li¡I‹ms
.
size
())

359  
SŒšg
();

361  
	gAcûssib™yObjeù
::
g‘A‰ribu‹
(
li¡I‹ms
[
li¡Index
], 
¬Ÿ_Ïb–A‰r
);

364 
SŒšg
 
	gR’d”M’uLi¡
::
™emToŞT
(
li¡Index
) const

366 
S–eùEËm’t
* 
£Ëù
 = 
toS–eùEËm’t
(
¡©ic_ÿ¡
<
EËm’t
*>(
node
()));

367 cÚ¡ 
	gVeùÜ
<
	gEËm’t
*>& 
	gli¡I‹ms
 = 
£Ëù
->
li¡I‹ms
();

368 ià(
	gli¡Index
 >ğ
li¡I‹ms
.
size
())

369  
SŒšg
();

370 
EËm’t
* 
	g–em’t
 = 
li¡I‹ms
[
li¡Index
];

371  
	g–em’t
->
t™Ë
();

374 
boŞ
 
	gR’d”M’uLi¡
::
™emIsEÇbËd
(
li¡Index
) const

376 
S–eùEËm’t
* 
£Ëù
 = 
toS–eùEËm’t
(
¡©ic_ÿ¡
<
EËm’t
*>(
node
()));

377 cÚ¡ 
	gVeùÜ
<
	gEËm’t
*>& 
	gli¡I‹ms
 = 
£Ëù
->
li¡I‹ms
();

378 ià(
	gli¡Index
 >ğ
li¡I‹ms
.
size
())

379  
çl£
;

380 
EËm’t
* 
	g–em’t
 = 
li¡I‹ms
[
li¡Index
];

381 ià(!
isO±iÚEËm’t
(
–em’t
))

382  
	gçl£
;

384 
boŞ
 
	ggroupEÇbËd
 = 
Œue
;

385 ià(
EËm’t
* 
	g·»ÁEËm’t
 = 
–em’t
->
·»ÁEËm’t
()) {

386 ià(
isO±iÚGroupEËm’t
(
·»ÁEËm’t
))

387 
groupEÇbËd
 = 
·»ÁEËm’t
->
isEÇbËdFÜmCÚŒŞ
();

389 ià(!
	ggroupEÇbËd
)

390  
	gçl£
;

392  
	g–em’t
->
isEÇbËdFÜmCÚŒŞ
();

395 
PİupM’uStyË
 
	gR’d”M’uLi¡
::
™emStyË
(
li¡Index
) const

397 
S–eùEËm’t
* 
£Ëù
 = 
toS–eùEËm’t
(
¡©ic_ÿ¡
<
EËm’t
*>(
node
()));

398 cÚ¡ 
	gVeùÜ
<
	gEËm’t
*>& 
	gli¡I‹ms
 = 
£Ëù
->
li¡I‹ms
();

399 ià(
	gli¡Index
 >ğ
li¡I‹ms
.
size
()) {

403 ià(!
li¡Index
)

404  
m’uStyË
();

407 
	gli¡Index
 = 0;

409 
EËm’t
* 
	g–em’t
 = 
li¡I‹ms
[
li¡Index
];

411 
R’d”StyË
* 
	g¡yË
 = 
–em’t
->
»nd”StyË
(è?ƒËm’t->»nd”StyË(è:ƒËm’t->
compu‹dStyË
();

412  
	g¡yË
 ? 
PİupM’uStyË
(
¡yË
->
cŞÜ
(), 
™emBackgroundCŞÜ
(
li¡Index
), styË->
fÚt
(), styË->
visib™y
(è=ğ
VISIBLE
, styË->
‹xtInd’t
(), styË->
dœeùiÚ
()è: 
m’uStyË
();

415 
CŞÜ
 
	gR’d”M’uLi¡
::
™emBackgroundCŞÜ
(
li¡Index
) const

417 
S–eùEËm’t
* 
£Ëù
 = 
toS–eùEËm’t
(
¡©ic_ÿ¡
<
EËm’t
*>(
node
()));

418 cÚ¡ 
	gVeùÜ
<
	gEËm’t
*>& 
	gli¡I‹ms
 = 
£Ëù
->
li¡I‹ms
();

419 ià(
	gli¡Index
 >ğ
li¡I‹ms
.
size
())

420  
¡yË
()->
backgroundCŞÜ
();

421 
EËm’t
* 
	g–em’t
 = 
li¡I‹ms
[
li¡Index
];

423 
CŞÜ
 
	gbackgroundCŞÜ
;

424 ià(
	g–em’t
->
»nd”StyË
())

425 
	gbackgroundCŞÜ
 = 
–em’t
->
»nd”StyË
()->
backgroundCŞÜ
();

427 ià(!
	gbackgroundCŞÜ
.
hasAÍha
())

428  
	gbackgroundCŞÜ
;

431 
	gbackgroundCŞÜ
 = 
¡yË
()->
backgroundCŞÜ
().
bËnd
(backgroundColor);

432 ià(!
	gbackgroundCŞÜ
.
hasAÍha
())

433  
	gbackgroundCŞÜ
;

436  
CŞÜ
(CŞÜ::
wh™e
).
bËnd
(
backgroundCŞÜ
);

439 
PİupM’uStyË
 
	gR’d”M’uLi¡
::
m’uStyË
() const

441 
R’d”StyË
* 
s
 = 
m_šÃrBlock
 ? m_šÃrBlock->
¡yË
() : style();

442  
PİupM’uStyË
(
s
->
cŞÜ
(), s->
backgroundCŞÜ
(), s->
fÚt
(), s->
visib™y
(è=ğ
VISIBLE
, s->
‹xtInd’t
(), s->
dœeùiÚ
());

445 
Ho¡Wšdow
* 
	gR’d”M’uLi¡
::
ho¡Wšdow
() const

447  
docum’t
()->
v›w
()->
ho¡Wšdow
();

450 
	gPassRefPŒ
<
	gSüŞlb¬
> 
	gR’d”M’uLi¡
::
ü—‹SüŞlb¬
(
SüŞlb¬Cl›Á
* 
ş›Á
, 
SüŞlb¬Or›Á©iÚ
 
Ü›Á©iÚ
, 
SüŞlb¬CÚŒŞSize
 
cÚŒŞSize
)

452 
	gRefPŒ
<
	gSüŞlb¬
> 
	gwidg‘
;

453 
boŞ
 
	ghasCu¡omSüŞlb¬StyË
 = 
¡yË
()->
hasP£udoStyË
(
SCROLLBAR
);

454 ià(
	ghasCu¡omSüŞlb¬StyË
)

455 
	gwidg‘
 = 
R’d”SüŞlb¬
::
ü—‹Cu¡omSüŞlb¬
(
ş›Á
, 
Ü›Á©iÚ
, 
this
);

457 
	gwidg‘
 = 
SüŞlb¬
::
ü—‹N©iveSüŞlb¬
(
ş›Á
, 
Ü›Á©iÚ
, 
cÚŒŞSize
);

458  
	gwidg‘
.
»Ëa£
();

461 
	gR’d”M’uLi¡
::
ş›ÁIn£tLeá
() const

466 
	gR’d”M’uLi¡
::
ş›ÁIn£tRight
() const

471 
	gR’d”M’uLi¡
::
ş›ÁPaddšgLeá
() const

473  
·ddšgLeá
();

476 cÚ¡ 
	g’dOfLšePaddšg
 = 2;

477 
	gR’d”M’uLi¡
::
ş›ÁPaddšgRight
() const

479 ià(
¡yË
()->
­³¬ªû
(è=ğ
M’uli¡P¬t
 || styË()->­³¬ªû(è=ğ
M’uli¡Bu‰ÚP¬t
) {

484  
’dOfLšePaddšg
;

489  
·ddšgRight
();

492 
	gR’d”M’uLi¡
::
li¡Size
() const

494 
S–eùEËm’t
* 
£Ëù
 = 
toS–eùEËm’t
(
¡©ic_ÿ¡
<
EËm’t
*>(
node
()));

495  
	g£Ëù
->
li¡I‹ms
().
size
();

498 
	gR’d”M’uLi¡
::
£ËùedIndex
() const

500 
S–eùEËm’t
* 
£Ëù
 = 
toS–eùEËm’t
(
¡©ic_ÿ¡
<
EËm’t
*>(
node
()));

501  
	g£Ëù
->
İtiÚToLi¡Index
(
£Ëù
->
£ËùedIndex
());

504 
	gR’d”M’uLi¡
::
pİupDidHide
()

506 
m_pİupIsVisibË
 = 
çl£
;

509 
boŞ
 
	gR’d”M’uLi¡
::
™emIsS•¬©Ü
(
li¡Index
) const

511 
S–eùEËm’t
* 
£Ëù
 = 
toS–eùEËm’t
(
¡©ic_ÿ¡
<
EËm’t
*>(
node
()));

512 cÚ¡ 
	gVeùÜ
<
	gEËm’t
*>& 
	gli¡I‹ms
 = 
£Ëù
->
li¡I‹ms
();

513 ià(
	gli¡Index
 >ğ
li¡I‹ms
.
size
())

514  
çl£
;

515 
EËm’t
* 
	g–em’t
 = 
li¡I‹ms
[
li¡Index
];

516  
	g–em’t
->
hasTagName
(
hrTag
);

519 
boŞ
 
	gR’d”M’uLi¡
::
™emIsLab–
(
li¡Index
) const

521 
S–eùEËm’t
* 
£Ëù
 = 
toS–eùEËm’t
(
¡©ic_ÿ¡
<
EËm’t
*>(
node
()));

522 cÚ¡ 
	gVeùÜ
<
	gEËm’t
*>& 
	gli¡I‹ms
 = 
£Ëù
->
li¡I‹ms
();

523 ià(
	gli¡Index
 >ğ
li¡I‹ms
.
size
())

524  
çl£
;

525 
EËm’t
* 
	g–em’t
 = 
li¡I‹ms
[
li¡Index
];

526  
isO±iÚGroupEËm’t
(
–em’t
);

529 
boŞ
 
	gR’d”M’uLi¡
::
™emIsS–eùed
(
li¡Index
) const

531 
S–eùEËm’t
* 
£Ëù
 = 
toS–eùEËm’t
(
¡©ic_ÿ¡
<
EËm’t
*>(
node
()));

532 cÚ¡ 
	gVeùÜ
<
	gEËm’t
*>& 
	gli¡I‹ms
 = 
£Ëù
->
li¡I‹ms
();

533 ià(
	gli¡Index
 >ğ
li¡I‹ms
.
size
())

534  
çl£
;

535 
EËm’t
* 
	g–em’t
 = 
li¡I‹ms
[
li¡Index
];

536 ià(
O±iÚEËm’t
* 
	gİtiÚEËm’t
 = 
toO±iÚEËm’t
(
–em’t
))

537  
İtiÚEËm’t
->
£Ëùed
();

538  
	gçl£
;

541 
	gR’d”M’uLi¡
::
£tTextFromI‹m
(
li¡Index
)

543 
S–eùEËm’t
* 
£Ëù
 = 
toS–eùEËm’t
(
¡©ic_ÿ¡
<
EËm’t
*>(
node
()));

544 
£tTextFromO±iÚ
(
£Ëù
->
li¡ToO±iÚIndex
(
li¡Index
));

547 
FÚtS–eùÜ
* 
	gR’d”M’uLi¡
::
fÚtS–eùÜ
() const

549  
docum’t
()->
¡yËS–eùÜ
()->
fÚtS–eùÜ
();

	@RenderMenuList.h

24 #iâdeà
R’d”M’uLi¡_h


25 
	#R’d”M’uLi¡_h


	)

27 
	~"PİupM’uCl›Á.h
"

28 
	~"R’d”FËxibËBox.h
"

30 #ià
PLATFORM
(
MAC
)

31 
	#POPUP_MENU_PULLS_DOWN
 0

	)

33 
	#POPUP_MENU_PULLS_DOWN
 1

	)

36 
Çme¥aû
 
	gWebCÜe
 {

38 
şass
 
	gPİupM’u
;

39 
şass
 
	gR’d”Text
;

41 #ià
ENABLE
(
NO_LISTBOX_RENDERING
)

42 
şass
 
	gR’d”M’uLi¡
 : 
public
 
R’d”FËxibËBox
, 
´iv©e
 
	gLi¡PİupM’uCl›Á
 {

44 
şass
 
	gR’d”M’uLi¡
 : 
public
 
R’d”FËxibËBox
, 
´iv©e
 
	gPİupM’uCl›Á
 {

47 
	gpublic
:

48 
R’d”M’uLi¡
(
EËm’t
*);

49 
	gvœtu®
 ~
R’d”M’uLi¡
();

51 
	gpublic
:

52 
boŞ
 
pİupIsVisibË
(ècÚ¡ {  
m_pİupIsVisibË
; }

53 
showPİup
();

54 
hidePİup
();

56 
£tO±iÚsChªged
(
boŞ
 
chªged
è{ 
	gm_İtiÚsChªged
 = changed; }

58 
didS‘S–eùedIndex
();

60 
SŒšg
 
‹xt
() const;

62 
	g´iv©e
:

63 
vœtu®
 
boŞ
 
isM’uLi¡
(ècÚ¡ {  
Œue
; }

65 
vœtu®
 
addChd
(
R’d”Objeù
* 
ÃwChd
, R’d”Objeù* 
befÜeChd
 = 0);

66 
vœtu®
 
»moveChd
(
R’d”Objeù
*);

67 
vœtu®
 
boŞ
 
ü—‹sAnÚymousW¿µ”
(ècÚ¡ {  
	gŒue
; }

68 
vœtu®
 
boŞ
 
ÿnHaveChd»n
(ècÚ¡ {  
	gçl£
; }

70 
vœtu®
 
upd©eFromEËm’t
();

72 
vœtu®
 
boŞ
 
hasCÚŒŞCl
(ècÚ¡ {  
	gŒue
; }

73 
vœtu®
 
IÁReù
 
cÚŒŞClReù
(
tx
, 
ty
) const;

75 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderMenuList"; }

77 
vœtu®
 
ÿlcP»fWidths
();

79 
vœtu®
 
¡yËDidChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
);

82 
vœtu®
 
SŒšg
 
™emText
(
li¡Index
) const;

83 
vœtu®
 
SŒšg
 
™emToŞT
(
li¡Index
) const;

84 
vœtu®
 
SŒšg
 
™emAcûssib™yText
(
li¡Index
) const;

85 
vœtu®
 
boŞ
 
™emIsEÇbËd
(
li¡Index
) const;

86 
vœtu®
 
PİupM’uStyË
 
™emStyË
(
li¡Index
) const;

87 
vœtu®
 
PİupM’uStyË
 
m’uStyË
() const;

88 
vœtu®
 
ş›ÁIn£tLeá
() const;

89 
vœtu®
 
ş›ÁIn£tRight
() const;

90 
vœtu®
 
ş›ÁPaddšgLeá
() const;

91 
vœtu®
 
ş›ÁPaddšgRight
() const;

92 
vœtu®
 
li¡Size
() const;

93 
vœtu®
 
£ËùedIndex
() const;

94 
vœtu®
 
pİupDidHide
();

95 
vœtu®
 
boŞ
 
™emIsS•¬©Ü
(
li¡Index
) const;

96 
vœtu®
 
boŞ
 
™emIsLab–
(
li¡Index
) const;

97 
vœtu®
 
boŞ
 
™emIsS–eùed
(
li¡Index
) const;

98 
vœtu®
 
£tTextFromI‹m
(
li¡Index
);

99 
vœtu®
 
boŞ
 
v®ueShouldChªgeOnHÙT¿ck
(ècÚ¡ {  
	gŒue
; }

100 
vœtu®
 
boŞ
 
shouldPİOv”
(ècÚ¡ {  !
	gPOPUP_MENU_PULLS_DOWN
; }

101 
vœtu®
 
v®ueChªged
(
li¡Index
, 
boŞ
 
fœeOnChªge
 = 
Œue
);

102 
vœtu®
 
FÚtS–eùÜ
* 
fÚtS–eùÜ
() const;

103 
vœtu®
 
Ho¡Wšdow
* 
ho¡Wšdow
() const;

104 
vœtu®
 
	gPassRefPŒ
<
	gSüŞlb¬
> 
ü—‹SüŞlb¬
(
SüŞlb¬Cl›Á
*, 
SüŞlb¬Or›Á©iÚ
, 
SüŞlb¬CÚŒŞSize
);

106 #ià
ENABLE
(
NO_LISTBOX_RENDERING
)

107 
vœtu®
 
li¡BoxS–eùI‹m
(
li¡Index
, 
boŞ
 
®lowMuÉlyS–eùiÚs
, boŞ 
shiá
, boŞ 
fœeOnChªgeNow
 = 
Œue
);

108 
vœtu®
 
boŞ
 
muÉË
();

111 
vœtu®
 
boŞ
 
hasLšeIfEm±y
(ècÚ¡ {  
	gŒue
; }

113 
CŞÜ
 
™emBackgroundCŞÜ
(
li¡Index
) const;

115 
ü—‹IÂ”Block
();

116 
adju¡IÂ”StyË
();

117 
£tText
(cÚ¡ 
SŒšg
&);

118 
£tTextFromO±iÚ
(
İtiÚIndex
);

119 
upd©eO±iÚsWidth
();

121 
R’d”Text
* 
	gm_bu‰ÚText
;

122 
R’d”Block
* 
	gm_šÃrBlock
;

124 
boŞ
 
	gm_İtiÚsChªged
;

125 
	gm_İtiÚsWidth
;

127 
	gm_Ï¡S–eùedIndex
;

129 
	gRefPŒ
<
	gPİupM’u
> 
	gm_pİup
;

130 
boŞ
 
	gm_pİupIsVisibË
;

133 
šlše
 
R’d”M’uLi¡
* 
toR’d”M’uLi¡
(
R’d”Objeù
* 
objeù
)

135 
ASSERT
(!
objeù
 || objeù->
isM’uLi¡
());

136  
	g¡©ic_ÿ¡
<
	gR’d”M’uLi¡
*>(
	gobjeù
);

140 
toR’d”M’uLi¡
(cÚ¡ 
R’d”M’uLi¡
*);

	@RenderObject.cpp

27 
	~"cÚfig.h
"

28 
	~"R’d”Objeù.h
"

30 
	~"AXObjeùCache.h
"

31 
	~"Chrome.h
"

32 
	~"CSSStyËS–eùÜ.h
"

33 
	~"FlßtQuad.h
"

34 
	~"F¿me.h
"

35 
	~"F¿meV›w.h
"

36 
	~"G¿phicsCÚ‹xt.h
"

37 
	~"HTMLNames.h
"

38 
	~"H™Te¡ResuÉ.h
"

39 
	~"Page.h
"

40 
	~"R’d”A»Ç.h
"

41 
	~"R’d”CouÁ”.h
"

42 
	~"R’d”FËxibËBox.h
"

43 
	~"R’d”ImageG’”©edCÚ‹Á.h
"

44 
	~"R’d”IÆše.h
"

45 
	~"R’d”Li¡I‹m.h
"

46 
	~"R’d”Ruby.h
"

47 
	~"R’d”RubyText.h
"

48 
	~"R’d”TabËC–l.h
"

49 
	~"R’d”TabËCŞ.h
"

50 
	~"R’d”TabËRow.h
"

51 
	~"R’d”Theme.h
"

52 
	~"R’d”V›w.h
"

53 
	~"T¿nsfÜmS‹.h
"

54 
	~"htmËd™šg.h
"

55 
	~<®gÜ™hm
>

56 
	~<¡dio.h
>

57 
	~<wtf/RefCouÁedL—kCouÁ”.h
>

58 
	~<wtf/Unu£dP¬am.h
>

60 #ià
USE
(
ACCELERATED_COMPOSITING
)

61 
	~"R’d”Lay”Compos™Ü.h
"

64 #ià
ENABLE
(
WML
)

65 
	~"WMLNames.h
"

68 #ià
ENABLE
(
SVG
)

69 
	~"R’d”SVGResourû.h
"

70 
	~"SVGR’d”SuµÜt.h
"

73 
usšg
 
Çme¥aû
 
	g¡d
;

75 
Çme¥aû
 
	gWebCÜe
 {

77 
usšg
 
Çme¥aû
 
	gHTMLNames
;

79 #iâdeà
NDEBUG


80 * 
	gba£OfR’d”ObjeùBešgD–‘ed
;

83 
boŞ
 
	gR’d”Objeù
::
s_afãùsP¬’tBlock
 = 
çl£
;

85 * 
	gR’d”Objeù
::
İ”©Ü
 
Ãw
(
size_t
 
sz
, 
R’d”A»Ç
* 
»nd”A»Ç
è
throw
()

87  
	g»nd”A»Ç
->
®loÿ‹
(
sz
);

90 
	gR’d”Objeù
::
İ”©Ü
 
d–‘e
(* 
±r
, 
size_t
 
sz
)

92 
ASSERT
(
ba£OfR’d”ObjeùBešgD–‘ed
 =ğ
±r
);

95 *(
	gsize_t
 *)
	g±r
 = 
sz
;

98 
R’d”Objeù
* 
	gR’d”Objeù
::
ü—‹Objeù
(
Node
* 
node
, 
R’d”StyË
* 
¡yË
)

100 
Docum’t
* 
	gdoc
 = 
node
->
docum’t
();

101 
R’d”A»Ç
* 
	g¬’a
 = 
doc
->
»nd”A»Ç
();

106 cÚ¡ 
CÚ‹ÁD©a
* 
	gcÚ‹ÁD©a
 = 
¡yË
->
cÚ‹ÁD©a
();

107 ià(
	gcÚ‹ÁD©a
 && !cÚ‹ÁD©a->
Ãxt
(è&& cÚ‹ÁD©a->
isImage
(è&& 
	gdoc
 !ğ
node
) {

108 
R’d”ImageG’”©edCÚ‹Á
* 
image
 = 
Ãw
 (
¬’a
èR’d”ImageG’”©edCÚ‹Á(
node
);

109 
	gimage
->
£tStyË
(
¡yË
);

110 ià(
StyËImage
* 
	g¡yËImage
 = 
cÚ‹ÁD©a
->
image
())

111 
image
->
£tStyËImage
(
¡yËImage
);

112  
	gimage
;

115 #ià
ENABLE
(
RUBY
)

116 ià(
	gnode
->
hasTagName
(
rubyTag
)) {

117 ià(
	g¡yË
->
di¥Ïy
(è=ğ
INLINE
)

118  
Ãw
 (
¬’a
è
R’d”RubyAsIÆše
(
node
);

119 ià(
	g¡yË
->
di¥Ïy
(è=ğ
BLOCK
)

120  
Ãw
 (
¬’a
è
R’d”RubyAsBlock
(
node
);

123 ià(
	gnode
->
hasTagName
(
¹Tag
è&& 
	g¡yË
->
di¥Ïy
(è=ğ
BLOCK
)

124  
Ãw
 (
¬’a
è
R’d”RubyText
(
node
);

127 
	g¡yË
->
di¥Ïy
()) {

128 
	gNONE
:

130 
	gINLINE
:

131  
Ãw
 (
¬’a
è
R’d”IÆše
(
node
);

132 
	gBLOCK
:

133 
INLINE_BLOCK
:

134 
RUN_IN
:

135 
COMPACT
:

136  
Ãw
 (
¬’a
è
R’d”Block
(
node
);

137 
	gLIST_ITEM
:

138  
Ãw
 (
¬’a
è
R’d”Li¡I‹m
(
node
);

139 
	gTABLE
:

140 
INLINE_TABLE
:

141  
Ãw
 (
¬’a
è
R’d”TabË
(
node
);

142 
	gTABLE_ROW_GROUP
:

143 
TABLE_HEADER_GROUP
:

144 
TABLE_FOOTER_GROUP
:

145  
Ãw
 (
¬’a
è
R’d”TabËSeùiÚ
(
node
);

146 
	gTABLE_ROW
:

147  
Ãw
 (
¬’a
è
R’d”TabËRow
(
node
);

148 
	gTABLE_COLUMN_GROUP
:

149 
TABLE_COLUMN
:

150  
Ãw
 (
¬’a
è
R’d”TabËCŞ
(
node
);

151 
	gTABLE_CELL
:

152  
Ãw
 (
¬’a
è
R’d”TabËC–l
(
node
);

153 
	gTABLE_CAPTION
:

154 #ià
ENABLE
(
WCSS
)

158 
WAP_MARQUEE
:

160  
Ãw
 (
¬’a
è
R’d”Block
(
node
);

161 
	gBOX
:

162 
INLINE_BOX
:

163  
Ãw
 (
¬’a
è
R’d”FËxibËBox
(
node
);

169 #iâdeà
NDEBUG


170 
	gWTF
::
RefCouÁedL—kCouÁ”
 
»nd”ObjeùCouÁ”
("RenderObject");

173 
	gR’d”Objeù
::
R’d”Objeù
(
Node
* 
node
)

174 : 
CachedResourûCl›Á
()

175 , 
m_¡yË
(0)

176 , 
m_node
(
node
)

177 , 
m_·»Á
(0)

178 , 
m_´evious
(0)

179 , 
m_Ãxt
(0)

180 #iâdeà
NDEBUG


181 , 
m_hasAXObjeù
(
çl£
)

182 , 
m_£tN“dsLayoutFÜbidd’
(
çl£
)

184 , 
m_ÃedsLayout
(
çl£
)

185 , 
m_ÃedsPos™iÚedMovem’tLayout
(
çl£
)

186 , 
m_nÜm®ChdN“dsLayout
(
çl£
)

187 , 
m_posChdN“dsLayout
(
çl£
)

188 , 
m_´efWidthsDœty
(
çl£
)

189 , 
m_æßtšg
(
çl£
)

190 , 
m_pos™iÚed
(
çl£
)

191 , 
m_»lPos™iÚed
(
çl£
)

192 , 
m_·štBackground
(
çl£
)

193 , 
m_isAnÚymous
(
node
 =ğnode->
docum’t
())

194 , 
m_isText
(
çl£
)

195 , 
m_isBox
(
çl£
)

196 , 
m_šlše
(
Œue
)

197 , 
m_»¶aûd
(
çl£
)

198 , 
m_isD¿ggšg
(
çl£
)

199 , 
m_hasLay”
(
çl£
)

200 , 
m_hasOv”æowCl
(
çl£
)

201 , 
m_hasT¿nsfÜm
(
çl£
)

202 , 
m_hasReæeùiÚ
(
çl£
)

203 , 
m_hasOv”rideSize
(
çl£
)

204 , 
m_hasCouÁ”NodeM­
(
çl£
)

205 , 
m_ev”HadLayout
(
çl£
)

206 , 
m_chd»nIÆše
(
çl£
)

207 , 
m_tİM¬gšQuœk
(
çl£
)

208 , 
m_bÙtomM¬gšQuœk
(
çl£
)

209 , 
m_hasM¬kupTrunÿtiÚ
(
çl£
)

210 , 
m_£ËùiÚS‹
(
S–eùiÚNÚe
)

211 , 
m_hasCŞumns
(
çl£
)

212 , 
m_ûÎWidthChªged
(
çl£
)

214 #iâdeà
NDEBUG


215 
	g»nd”ObjeùCouÁ”
.
šüem’t
();

217 
ASSERT
(
node
);

220 
	gR’d”Objeù
::~
R’d”Objeù
()

222 
ASSERT
(!
node
(è|| 
docum’tBešgDe¡royed
(è|| !
docum’t
()->
äame
()->
v›w
(è|| docum’t()->äame()->v›w()->
ÏyoutRoÙ
(è!ğ
this
);

223 #iâdeà
NDEBUG


224 
ASSERT
(!
m_hasAXObjeù
);

225 
	g»nd”ObjeùCouÁ”
.
deüem’t
();

229 
R’d”Theme
* 
	gR’d”Objeù
::
theme
() const

231 
ASSERT
(
docum’t
()->
·ge
());

233  
docum’t
()->
·ge
()->
theme
();

236 
boŞ
 
	gR’d”Objeù
::
isDesûndªtOf
(cÚ¡ 
R’d”Objeù
* 
obj
) const

238 cÚ¡ 
R’d”Objeù
* 
r
 = 
this
; 
	gr
;„ =„->
m_·»Á
) {

239 ià(
r
 =ğ
obj
)

240  
Œue
;

242  
	gçl£
;

245 
boŞ
 
	gR’d”Objeù
::
isBody
() const

247  
node
(è&&‚ode()->
hasTagName
(
bodyTag
);

250 
boŞ
 
	gR’d”Objeù
::
isHR
() const

252  
node
(è&&‚ode()->
hasTagName
(
hrTag
);

255 
boŞ
 
	gR’d”Objeù
::
isHTMLM¬qu“
() const

257  
node
(è&&‚ode()->
»nd””
(è=ğ
this
 &&‚ode()->
hasTagName
(
m¬qu“Tag
);

260 
upd©eLi¡M¬k”Numb”s
(
R’d”Objeù
* 
chd
)

262 
R’d”Objeù
* 
	gsiblšg
 = 
chd
; siblšg; siblšg = 
siblšg
->
ÃxtSiblšg
()) {

263 ià(
siblšg
->
isLi¡I‹m
())

264 
toR’d”Li¡I‹m
(
siblšg
)->
upd©eV®ue
();

268 
	gR’d”Objeù
::
addChd
(
R’d”Objeù
* 
ÃwChd
, R’d”Objeù* 
befÜeChd
)

270 
R’d”ObjeùChdLi¡
* 
	gchd»n
 = 
vœtu®Chd»n
();

271 
ASSERT
(
chd»n
);

272 ià(!
	gchd»n
)

275 
boŞ
 
	gÃedsTabË
 = 
çl£
;

277 ià(
	gÃwChd
->
isLi¡I‹m
())

278 
upd©eLi¡M¬k”Numb”s
(
befÜeChd
 ? befÜeChd : 
chd»n
->
Ï¡Chd
());

279 ià(
	gÃwChd
->
isTabËCŞ
(è&&‚ewChd->
¡yË
()->
di¥Ïy
(è=ğ
TABLE_COLUMN_GROUP
)

280 
ÃedsTabË
 = !
isTabË
();

281 ià(
	gÃwChd
->
isR’d”Block
(è&&‚ewChd->
¡yË
()->
di¥Ïy
(è=ğ
TABLE_CAPTION
)

282 
ÃedsTabË
 = !
isTabË
();

283 ià(
	gÃwChd
->
isTabËSeùiÚ
())

284 
	gÃedsTabË
 = !
isTabË
();

285 ià(
	gÃwChd
->
isTabËRow
())

286 
	gÃedsTabË
 = !
isTabËSeùiÚ
();

287 ià(
	gÃwChd
->
isTabËC–l
()) {

288 
	gÃedsTabË
 = !
isTabËRow
();

293 ià(
	gÃedsTabË
 && 
isTabËC–l
(è&& !
	gchd»n
->
fœ¡Chd
(è&& !
	gÃwChd
->isTableCell())

294 
	gÃedsTabË
 = 
çl£
;

297 ià(
	gÃedsTabË
) {

298 
R’d”TabË
* 
	gbË
;

299 
R’d”Objeù
* 
	gaá”Chd
 = 
befÜeChd
 ? befÜeChd->
´eviousSiblšg
(è: 
chd»n
->
Ï¡Chd
();

300 ià(
	gaá”Chd
 &&‡á”Chd->
isAnÚymous
(è&&‡á”Chd->
isTabË
())

301 
	gbË
 = 
toR’d”TabË
(
aá”Chd
);

303 
	gbË
 = 
Ãw
 (
»nd”A»Ç
()è
R’d”TabË
(
docum’t
() );

304 
	gRefPŒ
<
	gR’d”StyË
> 
	gÃwStyË
 = 
R’d”StyË
::
ü—‹
();

305 
	gÃwStyË
->
šh”™From
(
¡yË
());

306 
	gÃwStyË
->
£tDi¥Ïy
(
TABLE
);

307 
	gbË
->
£tStyË
(
ÃwStyË
.
»Ëa£
());

308 
addChd
(
bË
, 
befÜeChd
);

310 
	gbË
->
addChd
(
ÃwChd
);

313 
	gchd»n
->
š£¹ChdNode
(
this
, 
ÃwChd
, 
befÜeChd
);

315 
	gR’d”CouÁ”
::
»nd””SubŒ“A‰ached
(
ÃwChd
);

316 ià(
	gÃwChd
->
isText
(è&&‚ewChd->
¡yË
()->
‹xtT¿nsfÜm
(è=ğ
CAPITALIZE
) {

317 
RefPŒ
<
SŒšgIm¶
> 
‹xtToT¿nsfÜm
 = 
toR’d”Text
(
ÃwChd
)->
Üigš®Text
();

318 ià(
	g‹xtToT¿nsfÜm
)

319 
toR’d”Text
(
ÃwChd
)->
£tText
(
‹xtToT¿nsfÜm
.
»Ëa£
(), 
Œue
);

323 
	gR’d”Objeù
::
»moveChd
(
R’d”Objeù
* 
ŞdChd
)

325 
R’d”ObjeùChdLi¡
* 
chd»n
 = 
vœtu®Chd»n
();

326 
ASSERT
(
chd»n
);

327 ià(!
	gchd»n
)

333 ià(
	gŞdChd
->
isFlßtšgOrPos™iÚed
())

334 
toR’d”Box
(
ŞdChd
)->
»moveFlßtšgOrPos™iÚedChdFromBlockLi¡s
();

336 
	gchd»n
->
»moveChdNode
(
this
, 
ŞdChd
);

339 
R’d”Objeù
* 
	gR’d”Objeù
::
ÃxtInP»Ord”
() const

341 ià(
R’d”Objeù
* 
o
 = 
fœ¡Chd
())

342  
o
;

344  
ÃxtInP»Ord”Aá”Chd»n
();

381 
R’d”Objeù
* 
	gR’d”Objeù
::
ÃxtInP»Ord”Aá”Chd»n
() const

383 
R’d”Objeù
* 
o
;

384 ià(!(
	go
 = 
ÃxtSiblšg
())) {

385 
o
 = 
·»Á
();

386 
	go
 && !o->
ÃxtSiblšg
())

387 
	go
 = 
o
->
·»Á
();

388 ià(
	go
)

389 
	go
 = 
o
->
ÃxtSiblšg
();

392  
	go
;

395 
R’d”Objeù
* 
	gR’d”Objeù
::
ÃxtInP»Ord”
(R’d”Objeù* 
¡ayW™hš
) const

397 ià(
R’d”Objeù
* 
o
 = 
fœ¡Chd
())

398  
o
;

400  
ÃxtInP»Ord”Aá”Chd»n
(
¡ayW™hš
);

403 
R’d”Objeù
* 
	gR’d”Objeù
::
ÃxtInP»Ord”Aá”Chd»n
(R’d”Objeù* 
¡ayW™hš
) const

405 ià(
this
 =ğ
¡ayW™hš
)

408 cÚ¡ 
R’d”Objeù
* 
	gcu¼’t
 = 
this
;

409 
R’d”Objeù
* 
	gÃxt
;

410 !(
	gÃxt
 = 
cu¼’t
->
ÃxtSiblšg
())) {

411 
cu¼’t
 = cu¼’t->
·»Á
();

412 ià(!
	gcu¼’t
 || cu¼’ˆ=ğ
¡ayW™hš
)

415  
	gÃxt
;

418 
R’d”Objeù
* 
	gR’d”Objeù
::
´eviousInP»Ord”
() const

420 ià(
R’d”Objeù
* 
o
 = 
´eviousSiblšg
()) {

421 
o
->
Ï¡Chd
())

422 
o
 = o->
Ï¡Chd
();

423  
	go
;

426  
·»Á
();

429 
R’d”Objeù
* 
	gR’d”Objeù
::
chdAt
(
šdex
) const

431 
R’d”Objeù
* 
chd
 = 
fœ¡Chd
();

432 
	gi
 = 0; 
	gchd
 && i < 
	gšdex
; i++)

433 
	gchd
 = 
chd
->
ÃxtSiblšg
();

434  
	gchd
;

437 
R’d”Objeù
* 
	gR’d”Objeù
::
fœ¡L—fChd
() const

439 
R’d”Objeù
* 
r
 = 
fœ¡Chd
();

440 
	gr
) {

441 
R’d”Objeù
* 
	gn
 = 0;

442 
	gn
 = 
r
->
fœ¡Chd
();

443 ià(!
	gn
)

445 
	gr
 = 
n
;

447  
	gr
;

450 
R’d”Objeù
* 
	gR’d”Objeù
::
Ï¡L—fChd
() const

452 
R’d”Objeù
* 
r
 = 
Ï¡Chd
();

453 
	gr
) {

454 
R’d”Objeù
* 
	gn
 = 0;

455 
	gn
 = 
r
->
Ï¡Chd
();

456 ià(!
	gn
)

458 
	gr
 = 
n
;

460  
	gr
;

463 
addLay”s
(
R’d”Objeù
* 
obj
, 
R’d”Lay”
* 
·»ÁLay”
, R’d”Objeù*& 
ÃwObjeù
,

464 
R’d”Lay”
*& 
befÜeChd
)

466 ià(
	gobj
->
hasLay”
()) {

467 ià(!
	gbefÜeChd
 && 
	gÃwObjeù
) {

471 
	gbefÜeChd
 = 
ÃwObjeù
->
·»Á
()->
fšdNextLay”
(
·»ÁLay”
,‚ewObject);

472 
	gÃwObjeù
 = 0;

474 
	g·»ÁLay”
->
addChd
(
toR’d”BoxMod–Objeù
(
obj
)->
Ïy”
(), 
befÜeChd
);

478 
R’d”Objeù
* 
	gcu¼
 = 
obj
->
fœ¡Chd
(); cu¼; cu¼ = 
cu¼
->
ÃxtSiblšg
())

479 
addLay”s
(
cu¼
, 
·»ÁLay”
, 
ÃwObjeù
, 
befÜeChd
);

482 
	gR’d”Objeù
::
addLay”s
(
R’d”Lay”
* 
·»ÁLay”
, 
R’d”Objeù
* 
ÃwObjeù
)

484 ià(!
	g·»ÁLay”
)

487 
R’d”Objeù
* 
	gobjeù
 = 
ÃwObjeù
;

488 
R’d”Lay”
* 
	gbefÜeChd
 = 0;

489 
	gWebCÜe
::
addLay”s
(
this
, 
·»ÁLay”
, 
objeù
, 
befÜeChd
);

492 
	gR’d”Objeù
::
»moveLay”s
(
R’d”Lay”
* 
·»ÁLay”
)

494 ià(!
·»ÁLay”
)

497 ià(
hasLay”
()) {

498 
	g·»ÁLay”
->
»moveChd
(
toR’d”BoxMod–Objeù
(
this
)->
Ïy”
());

502 
R’d”Objeù
* 
	gcu¼
 = 
fœ¡Chd
(); cu¼; cu¼ = 
cu¼
->
ÃxtSiblšg
())

503 
cu¼
->
»moveLay”s
(
·»ÁLay”
);

506 
	gR’d”Objeù
::
moveLay”s
(
R’d”Lay”
* 
ŞdP¬’t
, R’d”Lay”* 
ÃwP¬’t
)

508 ià(!
	gÃwP¬’t
)

511 ià(
hasLay”
()) {

512 
R’d”Lay”
* 
	gÏy”
 = 
toR’d”BoxMod–Objeù
(
this
)->
Ïy”
();

513 
ASSERT
(
ŞdP¬’t
 =ğ
Ïy”
->
·»Á
());

514 ià(
	gŞdP¬’t
)

515 
	gŞdP¬’t
->
»moveChd
(
Ïy”
);

516 
	gÃwP¬’t
->
addChd
(
Ïy”
);

520 
R’d”Objeù
* 
	gcu¼
 = 
fœ¡Chd
(); cu¼; cu¼ = 
cu¼
->
ÃxtSiblšg
())

521 
cu¼
->
moveLay”s
(
ŞdP¬’t
, 
ÃwP¬’t
);

524 
R’d”Lay”
* 
	gR’d”Objeù
::
fšdNextLay”
(R’d”Lay”* 
·»ÁLay”
, 
R’d”Objeù
* 
¡¬tPošt
,

525 
boŞ
 
checkP¬’t
)

528 ià(!
	g·»ÁLay”
)

532 
R’d”Lay”
* 
	gourLay”
 = 
hasLay”
(è? 
toR’d”BoxMod–Objeù
(
this
)->
Ïy”
() : 0;

533 ià(
	gourLay”
 && ourLay”->
·»Á
(è=ğ
·»ÁLay”
)

534  
ourLay”
;

538 ià(!
	gourLay”
 || ourLay” =ğ
·»ÁLay”
) {

539 
R’d”Objeù
* 
cu¼
 = 
¡¬tPošt
 ? s¹Pošt->
ÃxtSiblšg
(è: 
fœ¡Chd
();

540 
	gcu¼
; cu¼ = 
cu¼
->
ÃxtSiblšg
()) {

541 
R’d”Lay”
* 
ÃxtLay”
 = 
cu¼
->
fšdNextLay”
(
·»ÁLay”
, 0, 
çl£
);

542 ià(
	gÃxtLay”
)

543  
	gÃxtLay”
;

549 ià(
	g·»ÁLay”
 =ğ
ourLay”
)

554 ià(
	gcheckP¬’t
 && 
·»Á
())

555  
·»Á
()->
fšdNextLay”
(
·»ÁLay”
, 
this
, 
Œue
);

560 
R’d”Lay”
* 
	gR’d”Objeù
::
’şosšgLay”
() const

562 cÚ¡ 
R’d”Objeù
* 
cu¼
 = 
this
;

563 
	gcu¼
) {

564 
R’d”Lay”
* 
	gÏy”
 = 
cu¼
->
hasLay”
(è? 
toR’d”BoxMod–Objeù
(cu¼)->
Ïy”
() : 0;

565 ià(
	gÏy”
)

566  
	gÏy”
;

567 
	gcu¼
 = 
cu¼
->
·»Á
();

572 
R’d”Lay”
* 
	gR’d”Objeù
::
’şosšgS–fPaštšgLay”
() const

574 cÚ¡ 
R’d”Objeù
* 
cu¼
 = 
this
;

575 
	gcu¼
) {

576 
R’d”Lay”
* 
	gÏy”
 = 
cu¼
->
hasLay”
(è? 
toR’d”BoxMod–Objeù
(cu¼)->
Ïy”
() : 0;

577 ià(
	gÏy”
 &&†ay”->
isS–fPaštšgLay”
())

578  
	gÏy”
;

579 
	gcu¼
 = 
cu¼
->
·»Á
();

584 
R’d”Box
* 
	gR’d”Objeù
::
’şosšgBox
() const

586 
R’d”Objeù
* 
cu¼
 = 
cÚ¡_ÿ¡
<R’d”Objeù*>(
this
);

587 
	gcu¼
) {

588 ià(
	gcu¼
->
isBox
())

589  
toR’d”Box
(
cu¼
);

590 
	gcu¼
 = 
cu¼
->
·»Á
();

593 
ASSERT_NOT_REACHED
();

597 
R’d”Block
* 
	gR’d”Objeù
::
fœ¡LšeBlock
() const

602 
	gR’d”Objeù
::
£tP»fWidthsDœty
(
boŞ
 
b
, boŞ 
m¬kP¬’ts
)

604 
boŞ
 
	g®»adyDœty
 = 
m_´efWidthsDœty
;

605 
	gm_´efWidthsDœty
 = 
b
;

606 ià(
	gb
 && !
	g®»adyDœty
 && 
	gm¬kP¬’ts
 && (
isText
(è|| (
¡yË
()->
pos™iÚ
(è!ğ
FixedPos™iÚ
 && styË()->pos™iÚ(è!ğ
AbsŞu‹Pos™iÚ
)))

607 
šv®id©eCÚš”P»fWidths
();

610 
	gR’d”Objeù
::
šv®id©eCÚš”P»fWidths
()

614 
R’d”Objeù
* 
o
 = 
isTabËC–l
(è? 
cÚššgBlock
(è: 
cÚš”
();

615 
	go
 && !o->
	gm_´efWidthsDœty
) {

618 
R’d”Objeù
* 
	gcÚš”
 = 
o
->
isTabËC–l
(è? o->
cÚššgBlock
(è: o->
cÚš”
();

619 ià(!
	gcÚš”
 && !
	go
->
isR’d”V›w
())

622 
	go
->
	gm_´efWidthsDœty
 = 
Œue
;

623 ià(
	go
->
¡yË
()->
pos™iÚ
(è=ğ
FixedPos™iÚ
 || 
o
->¡yË()->pos™iÚ(è=ğ
AbsŞu‹Pos™iÚ
)

627 
	go
 = 
cÚš”
;

631 
	gR’d”Objeù
::
£tLay”N“dsFuÎR•ašt
()

633 
ASSERT
(
hasLay”
());

634 
toR’d”BoxMod–Objeù
(
this
)->
Ïy”
()->
£tN“dsFuÎR•ašt
(
Œue
);

637 
R’d”Block
* 
	gR’d”Objeù
::
cÚššgBlock
() const

639 ià(
isTabËC–l
()) {

640 cÚ¡ 
R’d”TabËC–l
* 
ûÎ
 = 
toR’d”TabËC–l
(
this
);

641 ià(
·»Á
(è&& 
	gûÎ
->
£ùiÚ
())

642  
	gûÎ
->
bË
();

646 ià(
isR’d”V›w
())

647  
	gcÚ¡_ÿ¡
<
	gR’d”V›w
*>(
toR’d”V›w
(
this
));

649 
R’d”Objeù
* 
	go
 = 
·»Á
();

650 ià(!
isText
(è&& 
	gm_¡yË
->
pos™iÚ
(è=ğ
FixedPos™iÚ
) {

651 
o
 && !o->
isR’d”V›w
(è&& !(o->
hasT¿nsfÜm
(è&& o->
isR’d”Block
()))

652 
o
 = o->
·»Á
();

653 } ià(!
isText
(è&& 
	gm_¡yË
->
pos™iÚ
(è=ğ
AbsŞu‹Pos™iÚ
) {

654 
o
 && (o->
¡yË
()->
pos™iÚ
(è=ğ
SticPos™iÚ
 || (o->
isIÆše
(è&& !o->
isR•Ïûd
())è&& !o->
isR’d”V›w
(è&& !(o->
hasT¿nsfÜm
(è&& o->
isR’d”Block
())) {

660 ià(
o
->
¡yË
()->
pos™iÚ
(è=ğ
R–©ivePos™iÚ
 && o->
isIÆše
(è&& !o->
isR•Ïûd
())

661  
o
->
cÚššgBlock
();

662 #ià
ENABLE
(
SVG
)

663 ià(
	go
->
isSVGFÜeignObjeù
())

667 
	go
 = 
o
->
·»Á
();

670 
	go
 && ((o->
isIÆše
(è&& !o->
isR•Ïûd
()è|| o->
isTabËRow
(è|| o->
isTabËSeùiÚ
()

671 || 
	go
->
isTabËCŞ
(è|| o->
isF¿meS‘
(è|| o->
isMedŸ
()

672 #ià
ENABLE
(
SVG
)

673 || 
	go
->
isSVGCÚš”
(è|| o->
isSVGRoÙ
()

676 
	go
 = 
o
->
·»Á
();

679 ià(!
	go
 || !o->
isR’d”Block
())

682  
toR’d”Block
(
o
);

685 
boŞ
 
mu¡R•aštFlLay”s
(cÚ¡ 
R’d”Objeù
* 
»nd””
, cÚ¡ 
FlLay”
* 
Ïy”
)

688 ià(
	gÏy”
->
Ãxt
())

689  
	gŒue
;

692 
StyËImage
* 
	gimg
 = 
Ïy”
->
image
();

693 ià(!
	gimg
 || !img->
ÿnR’d”
(
»nd””
->
¡yË
()->
efãùiveZoom
()))

694  
	gçl£
;

696 ià(!
	gÏy”
->
xPos™iÚ
().
isZ”o
(è|| !Ïy”->
yPos™iÚ
().isZero())

697  
	gŒue
;

699 ià(
	gÏy”
->
size
().
	gty³
 =ğ
SizeL’gth
) {

700 ià(
Ïy”
->
size
().size.
width
().
isP”ûÁ
(è||†ay”->size().size.
height
().isPercent())

701  
Œue
;

702 } ià(
	gÏy”
->
size
().
	gty³
 =ğ
CÚš
 || 
Ïy”
->size().
ty³
 =ğ
Cov”
 || 
img
->
u£sImageCÚš”Size
())

703  
Œue
;

705  
	gçl£
;

708 
boŞ
 
	gR’d”Objeù
::
mu¡R•aštBackgroundOrBÜd”
() const

710 ià(
hasMask
(è&& 
mu¡R•aštFlLay”s
(
this
, 
¡yË
()->
maskLay”s
()))

711  
	gŒue
;

714 ià(!
hasBoxDecÜ©iÚs
())

715  
	gçl£
;

717 ià(
mu¡R•aštFlLay”s
(
this
, 
¡yË
()->
backgroundLay”s
()))

718  
	gŒue
;

721 ià(
¡yË
()->
hasBÜd”
()) {

723 
StyËImage
* 
	gbÜd”Image
 = 
¡yË
()->
bÜd”Image
().
image
();

724 
boŞ
 
	gshouldPaštBÜd”Image
 = 
bÜd”Image
 && bÜd”Image->
ÿnR’d”
(
¡yË
()->
efãùiveZoom
());

727 ià(
	gshouldPaštBÜd”Image
 && 
	gbÜd”Image
->
isLßded
())

728  
	gŒue
;

731  
	gçl£
;

734 
	gR’d”Objeù
::
d¿wLšeFÜBoxSide
(
G¿phicsCÚ‹xt
* 
g¿phicsCÚ‹xt
, 
x1
, 
y1
, 
x2
, 
y2
,

735 
BoxSide
 
s
, 
CŞÜ
 
c
, 
EBÜd”StyË
 
¡yË
,

736 
adjbw1
, 
adjbw2
)

738 
R’d”StyË
* 
	g¡yËToU£
 = 
this
->
¡yË
();

739 cÚ¡ 
	gFÚt
& 
	gfÚt
 = 
¡yËToU£
->
fÚt
();

740 
	g‹xt
[20];

741 if(
	gs
 =ğ
BSTİ
){

742 
¥rštf
(
‹xt
,"%d,%d",
x1
,
y1
);

743 
TextRun
 
‹xtRun
(
‹xt
,20);

744 
	gg¿phicsCÚ‹xt
->
d¿wText
(
fÚt
,
‹xtRun
,
IÁPošt
(
x1
,
y1
));

746 
¥rštf
(
‹xt
,"%d",
x2
-
x1
);

747 
TextRun
 
‹xtRun1
(
‹xt
,20);

748 
	gg¿phicsCÚ‹xt
->
d¿wText
(
fÚt
,
‹xtRun1
,
IÁPošt
((
x2
-
x1
)/2,
y1
));

749 }if(
	gs
 =ğ
BSLeá
){

750 
¥rštf
(
‹xt
,"%d",
y2
-
y1
);

751 
TextRun
 
‹xtRun
(
‹xt
,20);

752 
	gg¿phicsCÚ‹xt
->
d¿wText
(
fÚt
,
‹xtRun
,
IÁPošt
(
x1
-20,(
y2
-
y1
)/2));

755 
	gwidth
 = (
s
 =ğ
BSTİ
 || s =ğ
BSBÙtom
 ? 
y2
 - 
y1
 : 
x2
 - 
x1
);

757 ià(
	g¡yË
 =ğ
DOUBLE
 && 
width
 < 3)

758 
¡yË
 = 
SOLID
;

760 
	g¡yË
) {

761 
	gBNONE
:

762 
BHIDDEN
:

764 
	gDOTTED
:

765 
DASHED
:

766 
g¿phicsCÚ‹xt
->
£tSŒokeCŞÜ
(
c
, 
m_¡yË
->
cŞÜS·û
());

767 
	gg¿phicsCÚ‹xt
->
£tSŒokeThickÃss
(
width
);

768 
	gg¿phicsCÚ‹xt
->
£tSŒokeStyË
(
¡yË
 =ğ
DASHED
 ? 
DashedSŒoke
 : 
DÙ‹dSŒoke
);

770 ià(
	gwidth
 > 0)

771 
	gs
) {

772 
	gBSBÙtom
:

773 
BSTİ
:

774 
g¿phicsCÚ‹xt
->
d¿wLše
(
IÁPošt
(
x1
, (
y1
 + 
y2
è/ 2), IÁPošt(
x2
, (y1 + y2) / 2));

776 
	gBSRight
:

777 
BSLeá
:

778 
g¿phicsCÚ‹xt
->
d¿wLše
(
IÁPošt
((
x1
 + 
x2
è/ 2, 
y1
), IÁPošt((x1 + x2è/ 2, 
y2
));

782 
	gDOUBLE
: {

783 
thœd
 = (
width
 + 1) / 3;

785 ià(
	gadjbw1
 =ğ0 && 
adjbw2
 == 0) {

786 
g¿phicsCÚ‹xt
->
£tSŒokeStyË
(
NoSŒoke
);

787 
	gg¿phicsCÚ‹xt
->
£tFlCŞÜ
(
c
, 
m_¡yË
->
cŞÜS·û
());

788 
	gs
) {

789 
	gBSTİ
:

790 
BSBÙtom
:

791 
g¿phicsCÚ‹xt
->
d¿wReù
(
IÁReù
(
x1
, 
y1
, 
x2
 - x1, 
thœd
));

792 
	gg¿phicsCÚ‹xt
->
d¿wReù
(
IÁReù
(
x1
, 
y2
 - 
thœd
, 
x2
 - x1,hird));

794 
	gBSLeá
:

795 
g¿phicsCÚ‹xt
->
d¿wReù
(
IÁReù
(
x1
, 
y1
 + 1, 
thœd
, 
y2
 - y1 - 1));

796 
	gg¿phicsCÚ‹xt
->
d¿wReù
(
IÁReù
(
x2
 - 
thœd
, 
y1
 + 1,hœd, 
y2
 - y1 - 1));

798 
	gBSRight
:

799 
g¿phicsCÚ‹xt
->
d¿wReù
(
IÁReù
(
x1
, 
y1
 + 1, 
thœd
, 
y2
 - y1 - 1));

800 
	gg¿phicsCÚ‹xt
->
d¿wReù
(
IÁReù
(
x2
 - 
thœd
, 
y1
 + 1,hœd, 
y2
 - y1 - 1));

804 
	gadjbw1bigthœd
 = ((
adjbw1
 > 0) ?‡djbw1 + 1 :‡djbw1 - 1) / 3;

805 
	gadjbw2bigthœd
 = ((
adjbw2
 > 0) ?‡djbw2 + 1 :‡djbw2 - 1) / 3;

807 
	gs
) {

808 
	gBSTİ
:

809 
d¿wLšeFÜBoxSide
(
g¿phicsCÚ‹xt
, 
x1
 + 
max
((-
adjbw1
 * 2 + 1) / 3, 0),

810 
y1
, 
x2
 - 
max
((-
adjbw2
 * 2 + 1è/ 3, 0), y1 + 
thœd
,

811 
s
, 
c
, 
SOLID
, 
adjbw1bigthœd
, 
adjbw2bigthœd
);

812 
d¿wLšeFÜBoxSide
(
g¿phicsCÚ‹xt
, 
x1
 + 
max
((
adjbw1
 * 2 + 1) / 3, 0),

813 
y2
 - 
thœd
, 
x2
 - 
max
((
adjbw2
 * 2 + 1) / 3, 0), y2,

814 
s
, 
c
, 
SOLID
, 
adjbw1bigthœd
, 
adjbw2bigthœd
);

816 
	gBSLeá
:

817 
d¿wLšeFÜBoxSide
(
g¿phicsCÚ‹xt
, 
x1
, 
y1
 + 
max
((-
adjbw1
 * 2 + 1) / 3, 0),

818 
x1
 + 
thœd
, 
y2
 - 
max
((-
adjbw2
 * 2 + 1) / 3, 0),

819 
s
, 
c
, 
SOLID
, 
adjbw1bigthœd
, 
adjbw2bigthœd
);

820 
d¿wLšeFÜBoxSide
(
g¿phicsCÚ‹xt
, 
x2
 - 
thœd
, 
y1
 + 
max
((
adjbw1
 * 2 + 1) / 3, 0),

821 
x2
, 
y2
 - 
max
((
adjbw2
 * 2 + 1) / 3, 0),

822 
s
, 
c
, 
SOLID
, 
adjbw1bigthœd
, 
adjbw2bigthœd
);

824 
	gBSBÙtom
:

825 
d¿wLšeFÜBoxSide
(
g¿phicsCÚ‹xt
, 
x1
 + 
max
((
adjbw1
 * 2 + 1) / 3, 0),

826 
y1
, 
x2
 - 
max
((
adjbw2
 * 2 + 1è/ 3, 0), y1 + 
thœd
,

827 
s
, 
c
, 
SOLID
, 
adjbw1bigthœd
, 
adjbw2bigthœd
);

828 
d¿wLšeFÜBoxSide
(
g¿phicsCÚ‹xt
, 
x1
 + 
max
((-
adjbw1
 * 2 + 1) / 3, 0),

829 
y2
 - 
thœd
, 
x2
 - 
max
((-
adjbw2
 * 2 + 1) / 3, 0), y2,

830 
s
, 
c
, 
SOLID
, 
adjbw1bigthœd
, 
adjbw2bigthœd
);

832 
	gBSRight
:

833 
d¿wLšeFÜBoxSide
(
g¿phicsCÚ‹xt
, 
x1
, 
y1
 + 
max
((
adjbw1
 * 2 + 1) / 3, 0),

834 
x1
 + 
thœd
, 
y2
 - 
max
((
adjbw2
 * 2 + 1) / 3, 0),

835 
s
, 
c
, 
SOLID
, 
adjbw1bigthœd
, 
adjbw2bigthœd
);

836 
d¿wLšeFÜBoxSide
(
g¿phicsCÚ‹xt
, 
x2
 - 
thœd
, 
y1
 + 
max
((-
adjbw1
 * 2 + 1) / 3, 0),

837 
x2
, 
y2
 - 
max
((-
adjbw2
 * 2 + 1) / 3, 0),

838 
s
, 
c
, 
SOLID
, 
adjbw1bigthœd
, 
adjbw2bigthœd
);

846 
	gRIDGE
:

847 
GROOVE
:

849 
EBÜd”StyË
 
s1
;

850 
EBÜd”StyË
 
	gs2
;

851 ià(
	g¡yË
 =ğ
GROOVE
) {

852 
s1
 = 
INSET
;

853 
	gs2
 = 
OUTSET
;

855 
	gs1
 = 
OUTSET
;

856 
	gs2
 = 
INSET
;

859 
	gadjbw1bigh®f
 = ((
adjbw1
 > 0) ?‡djbw1 + 1 :‡djbw1 - 1) / 2;

860 
	gadjbw2bigh®f
 = ((
adjbw2
 > 0) ?‡djbw2 + 1 :‡djbw2 - 1) / 2;

862 
	gs
) {

863 
	gBSTİ
:

864 
d¿wLšeFÜBoxSide
(
g¿phicsCÚ‹xt
, 
x1
 + 
max
(-
adjbw1
, 0è/ 2, 
y1
, 
x2
 - max(-
adjbw2
, 0è/ 2, (y1 + 
y2
 + 1) / 2,

865 
s
, 
c
, 
s1
, 
adjbw1bigh®f
, 
adjbw2bigh®f
);

866 
d¿wLšeFÜBoxSide
(
g¿phicsCÚ‹xt
, 
x1
 + 
max
(
adjbw1
 + 1, 0è/ 2, (
y1
 + 
y2
 + 1è/ 2, 
x2
 - max(
adjbw2
 + 1, 0) / 2, y2,

867 
s
, 
c
, 
s2
, 
adjbw1
 / 2, 
adjbw2
 / 2);

869 
	gBSLeá
:

870 
d¿wLšeFÜBoxSide
(
g¿phicsCÚ‹xt
, 
x1
, 
y1
 + 
max
(-
adjbw1
, 0è/ 2, (x1 + 
x2
 + 1è/ 2, 
y2
 - max(-
adjbw2
, 0) / 2,

871 
s
, 
c
, 
s1
, 
adjbw1bigh®f
, 
adjbw2bigh®f
);

872 
d¿wLšeFÜBoxSide
(
g¿phicsCÚ‹xt
, (
x1
 + 
x2
 + 1è/ 2, 
y1
 + 
max
(
adjbw1
 + 1, 0è/ 2, x2, 
y2
 - max(
adjbw2
 + 1, 0) / 2,

873 
s
, 
c
, 
s2
, 
adjbw1
 / 2, 
adjbw2
 / 2);

875 
	gBSBÙtom
:

876 
d¿wLšeFÜBoxSide
(
g¿phicsCÚ‹xt
, 
x1
 + 
max
(
adjbw1
, 0è/ 2, 
y1
, 
x2
 - max(
adjbw2
, 0è/ 2, (y1 + 
y2
 + 1) / 2,

877 
s
, 
c
, 
s2
, 
adjbw1bigh®f
, 
adjbw2bigh®f
);

878 
d¿wLšeFÜBoxSide
(
g¿phicsCÚ‹xt
, 
x1
 + 
max
(-
adjbw1
 + 1, 0è/ 2, (
y1
 + 
y2
 + 1è/ 2, 
x2
 - max(-
adjbw2
 + 1, 0) / 2, y2,

879 
s
, 
c
, 
s1
, 
adjbw1
 / 2, 
adjbw2
 / 2);

881 
	gBSRight
:

882 
d¿wLšeFÜBoxSide
(
g¿phicsCÚ‹xt
, 
x1
, 
y1
 + 
max
(
adjbw1
, 0è/ 2, (x1 + 
x2
 + 1è/ 2, 
y2
 - max(
adjbw2
, 0) / 2,

883 
s
, 
c
, 
s2
, 
adjbw1bigh®f
, 
adjbw2bigh®f
);

884 
d¿wLšeFÜBoxSide
(
g¿phicsCÚ‹xt
, (
x1
 + 
x2
 + 1è/ 2, 
y1
 + 
max
(-
adjbw1
 + 1, 0è/ 2, x2, 
y2
 - max(-
adjbw2
 + 1, 0) / 2,

885 
s
, 
c
, 
s1
, 
adjbw1
 / 2, 
adjbw2
 / 2);

890 
	gINSET
:

891 ià(
s
 =ğ
BSTİ
 || s =ğ
BSLeá
)

892 
c
 = c.
d¬k
();

894 
	gOUTSET
:

895 ià(
¡yË
 =ğ
OUTSET
 && (
s
 =ğ
BSBÙtom
 || s =ğ
BSRight
))

896 
c
 = c.
d¬k
();

898 
	gSOLID
: {

899 
g¿phicsCÚ‹xt
->
£tSŒokeStyË
(
NoSŒoke
);

900 
	gg¿phicsCÚ‹xt
->
£tFlCŞÜ
(
c
, 
m_¡yË
->
cŞÜS·û
());

901 
ASSERT
(
x2
 >ğ
x1
);

902 
ASSERT
(
y2
 >ğ
y1
);

903 ià(!
	gadjbw1
 && !
	gadjbw2
) {

904 
	gg¿phicsCÚ‹xt
->
d¿wReù
(
IÁReù
(
x1
, 
y1
, 
x2
 - x1, 
y2
 - y1));

907 
FlßtPošt
 
	gquad
[4];

908 
	gs
) {

909 
	gBSTİ
:

910 
quad
[0] = 
FlßtPošt
(
x1
 + 
max
(-
adjbw1
, 0), 
y1
);

911 
	gquad
[1] = 
FlßtPošt
(
x1
 + 
max
(
adjbw1
, 0), 
y2
);

912 
	gquad
[2] = 
FlßtPošt
(
x2
 - 
max
(
adjbw2
, 0), 
y2
);

913 
	gquad
[3] = 
FlßtPošt
(
x2
 - 
max
(-
adjbw2
, 0), 
y1
);

915 
	gBSBÙtom
:

916 
quad
[0] = 
FlßtPošt
(
x1
 + 
max
(
adjbw1
, 0), 
y1
);

917 
	gquad
[1] = 
FlßtPošt
(
x1
 + 
max
(-
adjbw1
, 0), 
y2
);

918 
	gquad
[2] = 
FlßtPošt
(
x2
 - 
max
(-
adjbw2
, 0), 
y2
);

919 
	gquad
[3] = 
FlßtPošt
(
x2
 - 
max
(
adjbw2
, 0), 
y1
);

921 
	gBSLeá
:

922 
quad
[0] = 
FlßtPošt
(
x1
, 
y1
 + 
max
(-
adjbw1
, 0));

923 
	gquad
[1] = 
FlßtPošt
(
x1
, 
y2
 - 
max
(-
adjbw2
, 0));

924 
	gquad
[2] = 
FlßtPošt
(
x2
, 
y2
 - 
max
(
adjbw2
, 0));

925 
	gquad
[3] = 
FlßtPošt
(
x2
, 
y1
 + 
max
(
adjbw1
, 0));

927 
	gBSRight
:

928 
quad
[0] = 
FlßtPošt
(
x1
, 
y1
 + 
max
(
adjbw1
, 0));

929 
	gquad
[1] = 
FlßtPošt
(
x1
, 
y2
 - 
max
(
adjbw2
, 0));

930 
	gquad
[2] = 
FlßtPošt
(
x2
, 
y2
 - 
max
(-
adjbw2
, 0));

931 
	gquad
[3] = 
FlßtPošt
(
x2
, 
y1
 + 
max
(-
adjbw1
, 0));

934 
	gg¿phicsCÚ‹xt
->
d¿wCÚvexPŞygÚ
(4, 
quad
);

940 
	gR’d”Objeù
::
d¿wArcFÜBoxSide
(
G¿phicsCÚ‹xt
* 
g¿phicsCÚ‹xt
, 
x
, 
y
, 
thickÃss
, 
IÁSize
 
¿dius
,

941 
ªgËS¹
, 
ªgËS·n
, 
BoxSide
 
s
, 
CŞÜ
 
c
,

942 
EBÜd”StyË
 
¡yË
, 
boŞ
 
fœ¡CÜÃr
)

944 ià((
	g¡yË
 =ğ
DOUBLE
 && 
thickÃss
 / 2 < 3è|| ((
¡yË
 =ğ
RIDGE
 || styË =ğ
GROOVE
) &&hickness / 2 < 2))

945 
¡yË
 = 
SOLID
;

947 
	g¡yË
) {

948 
	gBNONE
:

949 
BHIDDEN
:

951 
	gDOTTED
:

952 
DASHED
:

953 
g¿phicsCÚ‹xt
->
£tSŒokeCŞÜ
(
c
, 
m_¡yË
->
cŞÜS·û
());

954 
	gg¿phicsCÚ‹xt
->
£tSŒokeStyË
(
¡yË
 =ğ
DOTTED
 ? 
DÙ‹dSŒoke
 : 
DashedSŒoke
);

955 
	gg¿phicsCÚ‹xt
->
£tSŒokeThickÃss
(
thickÃss
);

956 
	gg¿phicsCÚ‹xt
->
¡rokeArc
(
IÁReù
(
x
, 
y
, 
¿dius
.
width
(è* 2,„adius.
height
(è* 2), 
ªgËS¹
, 
ªgËS·n
);

958 
	gDOUBLE
: {

959 
thœd
 = 
thickÃss
 / 3.0f;

960 
	gšÃrThœd
 = (
thickÃss
 + 1.0f) / 6.0f;

961 
	gshiáFÜIÂ”
 = 
¡©ic_ÿ¡
<>(
šÃrThœd
 * 2.5f);

963 
	gou‹rY
 = 
y
;

964 
	gou‹rHeight
 = 
¿dius
.
height
() * 2;

965 
	gšÃrX
 = 
x
 + 
shiáFÜIÂ”
;

966 
	gšÃrY
 = 
y
 + 
shiáFÜIÂ”
;

967 
	gšÃrWidth
 = (
¿dius
.
width
(è- 
shiáFÜIÂ”
) * 2;

968 
	gšÃrHeight
 = (
¿dius
.
height
(è- 
shiáFÜIÂ”
) * 2;

969 ià(
	gšÃrThœd
 > 1 && (
	gs
 =ğ
BSTİ
 || (
fœ¡CÜÃr
 && (
s
 =ğ
BSLeá
 || s =ğ
BSRight
)))) {

970 
ou‹rHeight
 += 2;

971 
	gšÃrHeight
 += 2;

974 
	gg¿phicsCÚ‹xt
->
£tSŒokeStyË
(
SŞidSŒoke
);

975 
	gg¿phicsCÚ‹xt
->
£tSŒokeCŞÜ
(
c
, 
m_¡yË
->
cŞÜS·û
());

976 
	gg¿phicsCÚ‹xt
->
£tSŒokeThickÃss
(
thœd
);

977 
	gg¿phicsCÚ‹xt
->
¡rokeArc
(
IÁReù
(
x
, 
ou‹rY
, 
¿dius
.
width
(è* 2, 
ou‹rHeight
), 
ªgËS¹
, 
ªgËS·n
);

978 
	gg¿phicsCÚ‹xt
->
£tSŒokeThickÃss
(
šÃrThœd
 > 2 ? innerThird - 1 : innerThird);

979 
	gg¿phicsCÚ‹xt
->
¡rokeArc
(
IÁReù
(
šÃrX
, 
šÃrY
, 
šÃrWidth
, 
šÃrHeight
), 
ªgËS¹
, 
ªgËS·n
);

982 
	gGROOVE
:

983 
RIDGE
: {

984 
CŞÜ
 
c2
;

985 ià((
	g¡yË
 =ğ
RIDGE
 && (
s
 =ğ
BSTİ
 || s =ğ
BSLeá
)) ||

986 (
¡yË
 =ğ
GROOVE
 && (
s
 =ğ
BSBÙtom
 || s =ğ
BSRight
)))

987 
c2
 = 
c
.
d¬k
();

989 
	gc2
 = 
c
;

990 
	gc
 = 
c
.
d¬k
();

993 
	gg¿phicsCÚ‹xt
->
£tSŒokeStyË
(
SŞidSŒoke
);

994 
	gg¿phicsCÚ‹xt
->
£tSŒokeCŞÜ
(
c
, 
m_¡yË
->
cŞÜS·û
());

995 
	gg¿phicsCÚ‹xt
->
£tSŒokeThickÃss
(
thickÃss
);

996 
	gg¿phicsCÚ‹xt
->
¡rokeArc
(
IÁReù
(
x
, 
y
, 
¿dius
.
width
(è* 2,„adius.
height
(è* 2), 
ªgËS¹
, 
ªgËS·n
);

998 
	gh®fThickÃss
 = (
thickÃss
 + 1.0f) / 4.0f;

999 
	gshiáFÜIÂ”
 = 
¡©ic_ÿ¡
<>(
h®fThickÃss
 * 1.5f);

1000 
	gg¿phicsCÚ‹xt
->
£tSŒokeCŞÜ
(
c2
, 
m_¡yË
->
cŞÜS·û
());

1001 
	gg¿phicsCÚ‹xt
->
£tSŒokeThickÃss
(
h®fThickÃss
 > 2 ? halfThickness - 1 : halfThickness);

1002 
	gg¿phicsCÚ‹xt
->
¡rokeArc
(
IÁReù
(
x
 + 
shiáFÜIÂ”
, 
y
 + shiáFÜIÂ”, (
¿dius
.
width
() - shiftForInner) * 2,

1003 (
¿dius
.
height
(è- 
shiáFÜIÂ”
è* 2), 
ªgËS¹
, 
ªgËS·n
);

1006 
	gINSET
:

1007 ià(
s
 =ğ
BSTİ
 || s =ğ
BSLeá
)

1008 
c
 = c.
d¬k
();

1009 
	gOUTSET
:

1010 ià(
¡yË
 =ğ
OUTSET
 && (
s
 =ğ
BSBÙtom
 || s =ğ
BSRight
))

1011 
c
 = c.
d¬k
();

1012 
	gSOLID
:

1013 
g¿phicsCÚ‹xt
->
£tSŒokeStyË
(
SŞidSŒoke
);

1014 
	gg¿phicsCÚ‹xt
->
£tSŒokeCŞÜ
(
c
, 
m_¡yË
->
cŞÜS·û
());

1015 
	gg¿phicsCÚ‹xt
->
£tSŒokeThickÃss
(
thickÃss
);

1016 
	gg¿phicsCÚ‹xt
->
¡rokeArc
(
IÁReù
(
x
, 
y
, 
¿dius
.
width
(è* 2,„adius.
height
(è* 2), 
ªgËS¹
, 
ªgËS·n
);

1021 
	gR’d”Objeù
::
addPDFURLReù
(
G¿phicsCÚ‹xt
* 
cÚ‹xt
, cÚ¡ 
IÁReù
& 
»ù
)

1023 ià(
	g»ù
.
isEm±y
())

1025 
Node
* 
	gn
 = 
node
();

1026 ià(!
	gn
 || !n->
isLšk
(è|| !n->
isEËm’tNode
())

1028 cÚ¡ 
	gAtomicSŒšg
& 
	gh»f
 = 
¡©ic_ÿ¡
<
EËm’t
*>(
n
)->
g‘A‰ribu‹
(
h»fA‰r
);

1029 ià(
	gh»f
.
isNuÎ
())

1031 
	gcÚ‹xt
->
£tURLFÜReù
(
n
->
docum’t
()->
com¶‘eURL
(
h»f
), 
»ù
);

1034 
	gR’d”Objeù
::
·štOuše
(
G¿phicsCÚ‹xt
* 
g¿phicsCÚ‹xt
, 
tx
, 
ty
, 
w
, 
h
)

1036 ià(!
hasOuše
())

1039 
R’d”StyË
* 
	g¡yËToU£
 = 
¡yË
();

1040 
	gow
 = 
¡yËToU£
->
oušeWidth
();

1041 
EBÜd”StyË
 
	gos
 = 
¡yËToU£
->
oušeStyË
();

1043 
CŞÜ
 
	goc
 = 
¡yËToU£
->
vis™edD•’d’tCŞÜ
(
CSSPrİ”tyOušeCŞÜ
);

1045 
	goff£t
 = 
¡yËToU£
->
oušeOff£t
();

1047 ià(
	g¡yËToU£
->
oušeStyËIsAuto
(è|| 
hasOušeAÂÙ©iÚ
()) {

1048 ià(!
theme
()->
suµÜtsFocusRšg
(
¡yËToU£
)) {

1050 
	gVeùÜ
<
	gIÁReù
> 
	gfocusRšgReùs
;

1051 
addFocusRšgReùs
(
focusRšgReùs
, 
tx
, 
ty
);

1052 ià(
	g¡yËToU£
->
oušeStyËIsAuto
())

1053 
	gg¿phicsCÚ‹xt
->
d¿wFocusRšg
(
focusRšgReùs
, 
ow
, 
off£t
, 
oc
);

1055 
addPDFURLReù
(
g¿phicsCÚ‹xt
, 
uniÚReù
(
focusRšgReùs
));

1059 ià(
	g¡yËToU£
->
oušeStyËIsAuto
(è|| styËToU£->
oušeStyË
(è=ğ
BNONE
)

1062 
	gtx
 -ğ
off£t
;

1063 
	gty
 -ğ
off£t
;

1064 
	gw
 +ğ2 * 
off£t
;

1065 
	gh
 +ğ2 * 
off£t
;

1067 ià(
	gh
 < 0 || 
	gw
 < 0)

1070 
d¿wLšeFÜBoxSide
(
g¿phicsCÚ‹xt
, 
tx
 - 
ow
, 
ty
 - ow,x,y + 
h
 + ow, 
BSLeá
, 
oc
, 
os
, ow, ow);

1071 
d¿wLšeFÜBoxSide
(
g¿phicsCÚ‹xt
, 
tx
 - 
ow
, 
ty
 - ow,x + 
w
 + ow,y, 
BSTİ
, 
oc
, 
os
, ow, ow);

1072 
d¿wLšeFÜBoxSide
(
g¿phicsCÚ‹xt
, 
tx
 + 
w
, 
ty
 - 
ow
,x + w + ow,y + 
h
 + ow, 
BSRight
, 
oc
, 
os
, ow, ow);

1073 
d¿wLšeFÜBoxSide
(
g¿phicsCÚ‹xt
, 
tx
 - 
ow
, 
ty
 + 
h
,x + 
w
 + ow,y + h + ow, 
BSBÙtom
, 
oc
, 
os
, ow, ow);

1076 
IÁReù
 
	gR’d”Objeù
::
absŞu‹BoundšgBoxReù
(
boŞ
 
u£T¿nsfÜms
)

1078 ià(
u£T¿nsfÜms
) {

1079 
VeùÜ
<
FlßtQuad
> 
quads
;

1080 
absŞu‹Quads
(
quads
);

1082 
size_t
 
	gn
 = 
quads
.
size
();

1083 ià(!
	gn
)

1084  
IÁReù
();

1086 
IÁReù
 
	g»suÉ
 = 
quads
[0].
’şosšgBoundšgBox
();

1087 
size_t
 
	gi
 = 1; i < 
	gn
; ++i)

1088 
	g»suÉ
.
un™e
(
quads
[
i
].
’şosšgBoundšgBox
());

1089  
	g»suÉ
;

1092 
FlßtPošt
 
	gabsPos
 = 
loÿlToAbsŞu‹
();

1093 
	gVeùÜ
<
	gIÁReù
> 
	g»ùs
;

1094 
absŞu‹Reùs
(
»ùs
, 
absPos
.
x
(),‡bsPos.
y
());

1096 
size_t
 
	gn
 = 
»ùs
.
size
();

1097 ià(!
	gn
)

1098  
IÁReù
();

1100 
IÁReù
 
	g»suÉ
 = 
»ùs
[0];

1101 
size_t
 
	gi
 = 1; i < 
	gn
; ++i)

1102 
	g»suÉ
.
un™e
(
»ùs
[
i
]);

1103  
	g»suÉ
;

1106 
	gR’d”Objeù
::
absŞu‹FocusRšgQuads
(
VeùÜ
<
FlßtQuad
>& 
quads
)

1108 
VeùÜ
<
IÁReù
> 
»ùs
;

1113 
FlßtPošt
 
	gabsŞu‹Pošt
 = 
loÿlToAbsŞu‹
();

1114 
addFocusRšgReùs
(
»ùs
, 
absŞu‹Pošt
.
x
(),‡bsŞu‹Pošt.
y
());

1115 
size_t
 
	gcouÁ
 = 
»ùs
.
size
();

1116 
size_t
 
	gi
 = 0; i < 
	gcouÁ
; ++i) {

1117 
IÁReù
 
	g»ù
 = 
»ùs
[
i
];

1118 
	g»ù
.
move
(-
absŞu‹Pošt
.
x
(), -absŞu‹Pošt.
y
());

1119 
	gquads
.
­³nd
(
loÿlToAbsŞu‹Quad
(
FlßtQuad
(
»ù
)));

1123 
	gR’d”Objeù
::
addAbsŞu‹ReùFÜLay”
(
IÁReù
& 
»suÉ
)

1125 ià(
hasLay”
())

1126 
»suÉ
.
un™e
(
absŞu‹BoundšgBoxReù
());

1127 
R’d”Objeù
* 
	gcu¼’t
 = 
fœ¡Chd
(); cu¼’t; cu¼’ˆğ
cu¼’t
->
ÃxtSiblšg
())

1128 
cu¼’t
->
addAbsŞu‹ReùFÜLay”
(
»suÉ
);

1131 
IÁReù
 
	gR’d”Objeù
::
·štšgRoÙReù
(IÁReù& 
tİLev–Reù
)

1133 
IÁReù
 
»suÉ
 = 
absŞu‹BoundšgBoxReù
();

1134 
	gtİLev–Reù
 = 
»suÉ
;

1135 
R’d”Objeù
* 
	gcu¼’t
 = 
fœ¡Chd
(); cu¼’t; cu¼’ˆğ
cu¼’t
->
ÃxtSiblšg
())

1136 
cu¼’t
->
addAbsŞu‹ReùFÜLay”
(
»suÉ
);

1137  
	g»suÉ
;

1140 
	gR’d”Objeù
::
·št
(
PaštInfo
& , , )

1144 
R’d”BoxMod–Objeù
* 
	gR’d”Objeù
::
cÚš”FÜR•ašt
() const

1146 #ià
USE
(
ACCELERATED_COMPOSITING
)

1147 ià(
R’d”V›w
* 
v
 = 
v›w
()) {

1148 ià(
v
->
u£sCompos™šg
()) {

1149 
R’d”Lay”
* 
compLay”
 = 
’şosšgLay”
()->
’şosšgCompos™šgLay”
();

1150  
	gcompLay”
 ? compLay”->
»nd””
() : 0;

1158 
	gR’d”Objeù
::
»·štUsšgCÚš”
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, cÚ¡ 
IÁReù
& 
r
, 
boŞ
 
immedŸ‹
)

1160 ià(!
	g»·štCÚš”
 ||„•aštCÚš”->
isR’d”V›w
()) {

1161 
R’d”V›w
* 
	gv
 = 
»·štCÚš”
 ? 
toR’d”V›w
Ô•aštCÚš”è: 
v›w
();

1162 
	gv
->
»·štV›wReùªgË
(
r
, 
immedŸ‹
);

1164 #ià
USE
(
ACCELERATED_COMPOSITING
)

1165 
R’d”V›w
* 
	gv
 = 
v›w
();

1166 ià(
	gv
->
u£sCompos™šg
()) {

1167 
ASSERT
(
»·štCÚš”
->
hasLay”
(è&&„•aštCÚš”->
Ïy”
()->
isCompos™ed
());

1168 
	g»·štCÚš”
->
Ïy”
()->
£tBackšgN“dsR•aštInReù
(
r
);

1171 
ASSERT_NOT_REACHED
();

1176 
	gR’d”Objeù
::
»·št
(
boŞ
 
immedŸ‹
)

1179 
R’d”V›w
* 
v›w
;

1180 ià(!
isRoÙed
(&
v›w
))

1183 ià(
	gv›w
->
´štšg
())

1186 
R’d”BoxMod–Objeù
* 
	g»·štCÚš”
 = 
cÚš”FÜR•ašt
();

1187 
»·štUsšgCÚš”
(
»·štCÚš”
 ?„•aštCÚš” : 
v›w
, 
ş³dOv”æowReùFÜR•ašt
Ô•aštCÚš”), 
immedŸ‹
);

1190 
	gR’d”Objeù
::
»·štReùªgË
(cÚ¡ 
IÁReù
& 
r
, 
boŞ
 
immedŸ‹
)

1193 
R’d”V›w
* 
	gv›w
;

1194 ià(!
isRoÙed
(&
v›w
))

1197 ià(
	gv›w
->
´štšg
())

1200 
IÁReù
 
dœtyReù
(
r
);

1204 
	gdœtyReù
.
move
(
v›w
->
ÏyoutD–
());

1206 
R’d”BoxMod–Objeù
* 
	g»·štCÚš”
 = 
cÚš”FÜR•ašt
();

1207 
compu‹ReùFÜR•ašt
(
»·štCÚš”
, 
dœtyReù
);

1208 
»·štUsšgCÚš”
(
»·štCÚš”
 ?„•aštCÚš” : 
v›w
, 
dœtyReù
, 
immedŸ‹
);

1211 
boŞ
 
	gR’d”Objeù
::
»·štAá”LayoutIfN“ded
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, cÚ¡ 
IÁReù
& 
ŞdBounds
, cÚ¡ IÁReù& 
ŞdOušeBox
, cÚ¡ IÁReù* 
ÃwBoundsPŒ
, cÚ¡ IÁReù* 
ÃwOušeBoxReùPŒ
)

1213 
R’d”V›w
* 
	gv
 = 
v›w
();

1214 ià(
	gv
->
´štšg
())

1215  
	gçl£
;

1217 
ASSERT
(!
ÃwBoundsPŒ
 || *ÃwBoundsPŒ =ğ
ş³dOv”æowReùFÜR•ašt
(
»·štCÚš”
));

1218 
IÁReù
 
	gÃwBounds
 = 
ÃwBoundsPŒ
 ? *ÃwBoundsPŒ : 
ş³dOv”æowReùFÜR•ašt
(
»·štCÚš”
);

1219 
IÁReù
 
	gÃwOušeBox
;

1221 
boŞ
 
	gfuÎR•ašt
 = 
£lfN“dsLayout
();

1223 ià(!
	gfuÎR•ašt
 && 
¡yË
()->
bÜd”F™
(è=ğ
BÜd”F™Lšes
)

1224 
fuÎR•ašt
 = 
Œue
;

1225 ià(!
	gfuÎR•ašt
) {

1226 
ASSERT
(!
ÃwOušeBoxReùPŒ
 || *ÃwOušeBoxReùPŒ =ğ
oušeBoundsFÜR•ašt
(
»·štCÚš”
));

1227 
	gÃwOušeBox
 = 
ÃwOušeBoxReùPŒ
 ? *ÃwOušeBoxReùPŒ : 
oušeBoundsFÜR•ašt
(
»·štCÚš”
);

1228 ià(
	gÃwOušeBox
.
loÿtiÚ
(è!ğ
ŞdOušeBox
.loÿtiÚ(è|| (
mu¡R•aštBackgroundOrBÜd”
(è&& (
ÃwBounds
 !ğ
ŞdBounds
 || 
ÃwOušeBox
 != oldOutlineBox)))

1229 
fuÎR•ašt
 = 
Œue
;

1232 ià(!
	g»·štCÚš”
)

1233 
	g»·štCÚš”
 = 
v
;

1235 ià(
	gfuÎR•ašt
) {

1236 
»·štUsšgCÚš”
(
»·štCÚš”
, 
ŞdBounds
);

1237 ià(
	gÃwBounds
 !ğ
ŞdBounds
)

1238 
»·štUsšgCÚš”
(
»·štCÚš”
, 
ÃwBounds
);

1239  
	gŒue
;

1242 ià(
	gÃwBounds
 =ğ
ŞdBounds
 && 
ÃwOušeBox
 =ğ
ŞdOušeBox
)

1243  
çl£
;

1245 
	gd–Leá
 = 
ÃwBounds
.
x
(è- 
ŞdBounds
.x();

1246 ià(
	gd–Leá
 > 0)

1247 
»·štUsšgCÚš”
(
»·štCÚš”
, 
IÁReù
(
ŞdBounds
.
x
(), oldBounds.
y
(), 
d–Leá
, oldBounds.
height
()));

1248 ià(
	gd–Leá
 < 0)

1249 
»·štUsšgCÚš”
(
»·štCÚš”
, 
IÁReù
(
ÃwBounds
.
x
(),‚ewBounds.
y
(), -
d–Leá
,‚ewBounds.
height
()));

1251 
	gd–Right
 = 
ÃwBounds
.
right
(è- 
ŞdBounds
.right();

1252 ià(
	gd–Right
 > 0)

1253 
»·štUsšgCÚš”
(
»·štCÚš”
, 
IÁReù
(
ŞdBounds
.
right
(), 
ÃwBounds
.
y
(), 
d–Right
,‚ewBounds.
height
()));

1254 ià(
	gd–Right
 < 0)

1255 
»·štUsšgCÚš”
(
»·štCÚš”
, 
IÁReù
(
ÃwBounds
.
right
(), 
ŞdBounds
.
y
(), -
d–Right
, oldBounds.
height
()));

1257 
	gd–Tİ
 = 
ÃwBounds
.
y
(è- 
ŞdBounds
.y();

1258 ià(
	gd–Tİ
 > 0)

1259 
»·štUsšgCÚš”
(
»·štCÚš”
, 
IÁReù
(
ŞdBounds
.
x
(), oldBounds.
y
(), oldBounds.
width
(), 
d–Tİ
));

1260 ià(
	gd–Tİ
 < 0)

1261 
»·štUsšgCÚš”
(
»·štCÚš”
, 
IÁReù
(
ÃwBounds
.
x
(),‚ewBounds.
y
(),‚ewBounds.
width
(), -
d–Tİ
));

1263 
	gd–BÙtom
 = 
ÃwBounds
.
bÙtom
(è- 
ŞdBounds
.bottom();

1264 ià(
	gd–BÙtom
 > 0)

1265 
»·štUsšgCÚš”
(
»·štCÚš”
, 
IÁReù
(
ÃwBounds
.
x
(), 
ŞdBounds
.
bÙtom
(),‚ewBounds.
width
(), 
d–BÙtom
));

1266 ià(
	gd–BÙtom
 < 0)

1267 
»·štUsšgCÚš”
(
»·štCÚš”
, 
IÁReù
(
ŞdBounds
.
x
(), 
ÃwBounds
.
bÙtom
(), oldBounds.
width
(), -
d–BÙtom
));

1269 ià(
	gÃwOušeBox
 =ğ
ŞdOušeBox
)

1270  
çl£
;

1274 
R’d”StyË
* 
	goušeStyË
 = 
oušeStyËFÜR•ašt
();

1275 
	gow
 = 
oušeStyË
->
oušeSize
();

1276 
	gwidth
 = 
abs
(
ÃwOušeBox
.
width
(è- 
ŞdOušeBox
.width());

1277 ià(
	gwidth
) {

1278 
	gshadowLeá
;

1279 
	gshadowRight
;

1280 
¡yË
()->
g‘BoxShadowHÜizÚlEx‹Á
(
shadowLeá
, 
shadowRight
);

1282 
	gbÜd”Right
 = 
isBox
(è? 
toR’d”Box
(
this
)->
bÜd”Right
() : 0;

1283 
	gbÜd”Width
 = 
max
(-
oušeStyË
->
oušeOff£t
(), max(
bÜd”Right
, max(
¡yË
()->
bÜd”TİRightRadius
().
width
(), styË()->
bÜd”BÙtomRightRadius
().width()))è+ max(
ow
, 
shadowRight
);

1284 
IÁReù
 
rightReù
(
ÃwOušeBox
.
x
(è+ 
mš
ÒewOušeBox.
width
(), 
ŞdOušeBox
.width()è- 
bÜd”Width
,

1285 
ÃwOušeBox
.
y
(),

1286 
width
 + 
bÜd”Width
,

1287 
max
(
ÃwOušeBox
.
height
(), 
ŞdOušeBox
.height()));

1288 
	gright
 = 
mš
(
ÃwBounds
.
right
(), 
ŞdBounds
.right());

1289 ià(
	grightReù
.
x
(è< 
	gright
) {

1290 
	grightReù
.
£tWidth
(
mš
(
rightReù
.
width
(), 
right
 -„ightReù.
x
()));

1291 
»·štUsšgCÚš”
(
»·štCÚš”
, 
rightReù
);

1294 
	gheight
 = 
abs
(
ÃwOušeBox
.
height
(è- 
ŞdOušeBox
.height());

1295 ià(
	gheight
) {

1296 
	gshadowTİ
;

1297 
	gshadowBÙtom
;

1298 
¡yË
()->
g‘BoxShadowV”tiÿlEx‹Á
(
shadowTİ
, 
shadowBÙtom
);

1300 
	gbÜd”BÙtom
 = 
isBox
(è? 
toR’d”Box
(
this
)->
bÜd”BÙtom
() : 0;

1301 
	gbÜd”Height
 = 
max
(-
oušeStyË
->
oušeOff£t
(), max(
bÜd”BÙtom
, max(
¡yË
()->
bÜd”BÙtomLeáRadius
().
height
(), styË()->
bÜd”BÙtomRightRadius
().height()))è+ max(
ow
, 
shadowBÙtom
);

1302 
IÁReù
 
bÙtomReù
(
ÃwOušeBox
.
x
(),

1303 
mš
(
ÃwOušeBox
.
bÙtom
(), 
ŞdOušeBox
.bÙtom()è- 
bÜd”Height
,

1304 
max
(
ÃwOušeBox
.
width
(), 
ŞdOušeBox
.width()),

1305 
height
 + 
bÜd”Height
);

1306 
	gbÙtom
 = 
mš
(
ÃwBounds
.
bÙtom
(), 
ŞdBounds
.bottom());

1307 ià(
	gbÙtomReù
.
y
(è< 
	gbÙtom
) {

1308 
	gbÙtomReù
.
£tHeight
(
mš
(
bÙtomReù
.
height
(), 
bÙtom
 - bÙtomReù.
y
()));

1309 
»·štUsšgCÚš”
(
»·štCÚš”
, 
bÙtomReù
);

1312  
	gçl£
;

1315 
	gR’d”Objeù
::
»·štDuršgLayoutIfMoved
(cÚ¡ 
IÁReù
&)

1319 
R’d”Objeù
::
»·štOv”hªgšgFlßts
(
boŞ
)

1323 
boŞ
 
R’d”Objeù
::
checkFÜR•aštDuršgLayout
() const

1328  !
docum’t
()->
v›w
()->
ÃedsFuÎR•ašt
(è&& !
hasLay”
();

1331 
IÁReù
 
	gR’d”Objeù
::
»ùW™hOušeFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
oušeWidth
)

1333 
IÁReù
 
r
(
ş³dOv”æowReùFÜR•ašt
(
»·štCÚš”
));

1334 
	gr
.
šæ©e
(
oušeWidth
);

1335  
	gr
;

1338 
IÁReù
 
	gR’d”Objeù
::
ş³dOv”æowReùFÜR•ašt
(
R’d”BoxMod–Objeù
*)

1340 
ASSERT_NOT_REACHED
();

1341  
IÁReù
();

1344 
	gR’d”Objeù
::
compu‹ReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
IÁReù
& 
»ù
, 
boŞ
 
fixed
)

1346 ià(
	g»·štCÚš”
 =ğ
this
)

1349 ià(
R’d”Objeù
* 
	go
 = 
·»Á
()) {

1350 ià(
o
->
isBlockFlow
()) {

1351 
R’d”Block
* 
cb
 = 
toR’d”Block
(
o
);

1352 ià(
	gcb
->
hasCŞumns
())

1353 
	gcb
->
adju¡ReùFÜCŞumns
(
»ù
);

1356 ià(
	go
->
hasOv”æowCl
()) {

1360 
R’d”Box
* 
	gboxP¬’t
 = 
toR’d”Box
(
o
);

1362 
IÁReù
 
»·štReù
(
»ù
);

1363 
	g»·štReù
.
move
(-
boxP¬’t
->
Ïy”
()->
süŞËdCÚ‹ÁOff£t
());

1365 
IÁReù
 
boxReù
(0, 0, 
boxP¬’t
->
Ïy”
()->
width
(), boxP¬’t->Ïy”()->
height
());

1366 
	g»ù
 = 
š‹r£ùiÚ
(
»·štReù
, 
boxReù
);

1367 ià(
	g»ù
.
isEm±y
())

1371 
	go
->
compu‹ReùFÜR•ašt
(
»·štCÚš”
, 
»ù
, 
fixed
);

1375 
	gR’d”Objeù
::
dœtyLšesFromChªgedChd
(
R’d”Objeù
*)

1379 #iâdeà
NDEBUG


1381 
R’d”Objeù
::
showT»eFÜThis
() const

1383 ià(
node
())

1384 
node
()->
showT»eFÜThis
();

1387 
	gR’d”Objeù
::
showR’d”Objeù
() const

1389 
showR’d”Objeù
(0);

1392 
	gR’d”Objeù
::
showR’d”Objeù
(
´š‹dCh¬aù”s
) const

1396 ià(!
this
) {

1397 
åuts
("ÒuÎ)\n", 
¡d”r
);

1401 
	g´š‹dCh¬aù”s
 +ğ
årštf
(
¡d”r
, "% %p", 
»nd”Name
(), 
this
);

1403 ià(
node
()) {

1404 ià(
	g´š‹dCh¬aù”s
)

1405 ; 
	g´š‹dCh¬aù”s
 < 39;…rintedCharacters++)

1406 
åutc
(' ', 
¡d”r
);

1407 
åutc
('\t', 
¡d”r
);

1408 
node
()->
showNode
();

1410 
åutc
('\n', 
¡d”r
);

1413 
	gR’d”Objeù
::
showR’d”T»eAndM¬k
(cÚ¡ 
R’d”Objeù
* 
m¬kedObjeù1
, cÚ¡ * 
m¬kedLab–1
, cÚ¡ R’d”Objeù* 
m¬kedObjeù2
, cÚ¡ * 
m¬kedLab–2
, 
d•th
) const

1415 
	g´š‹dCh¬aù”s
 = 0;

1416 ià(
	gm¬kedObjeù1
 =ğ
this
 && 
m¬kedLab–1
)

1417 
´š‹dCh¬aù”s
 +ğ
årštf
(
¡d”r
, "%s", 
m¬kedLab–1
);

1418 ià(
	gm¬kedObjeù2
 =ğ
this
 && 
m¬kedLab–2
)

1419 
´š‹dCh¬aù”s
 +ğ
årštf
(
¡d”r
, "%s", 
m¬kedLab–2
);

1420 ; 
	g´š‹dCh¬aù”s
 < 
	gd•th
 * 2;…rintedCharacters++)

1421 
åutc
(' ', 
¡d”r
);

1423 
showR’d”Objeù
(
´š‹dCh¬aù”s
);

1424 ià(!
	gthis
)

1427 cÚ¡ 
R’d”Objeù
* 
	gchd
 = 
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
())

1428 
chd
->
showR’d”T»eAndM¬k
(
m¬kedObjeù1
, 
m¬kedLab–1
, 
m¬kedObjeù2
, 
m¬kedLab–2
, 
d•th
 + 1);

1433 
CŞÜ
 
	gR’d”Objeù
::
£ËùiÚBackgroundCŞÜ
() const

1435 
CŞÜ
 
cŞÜ
;

1436 ià(
¡yË
()->
u£rS–eù
(è!ğ
SELECT_NONE
) {

1437 
RefPŒ
<
R’d”StyË
> 
p£udoStyË
 = 
g‘UnÿchedP£udoStyË
(
SELECTION
);

1438 ià(
	gp£udoStyË
 &&…£udoStyË->
backgroundCŞÜ
().
isV®id
())

1439 
	gcŞÜ
 = 
p£udoStyË
->
backgroundCŞÜ
().
bËndW™hWh™e
();

1441 
	gcŞÜ
 = 
docum’t
()->
äame
()->
£ËùiÚ
()->
isFocu£dAndAùive
() ?

1442 
theme
()->
aùiveS–eùiÚBackgroundCŞÜ
() :

1443 
theme
()->
šaùiveS–eùiÚBackgroundCŞÜ
();

1446  
	gcŞÜ
;

1449 
CŞÜ
 
	gR’d”Objeù
::
£ËùiÚFÜegroundCŞÜ
() const

1451 
CŞÜ
 
cŞÜ
;

1452 ià(
¡yË
()->
u£rS–eù
(è=ğ
SELECT_NONE
)

1453  
cŞÜ
;

1455 ià(
	gRefPŒ
<
	gR’d”StyË
> 
	gp£udoStyË
 = 
g‘UnÿchedP£udoStyË
(
SELECTION
)) {

1456 
cŞÜ
 = 
p£udoStyË
->
‹xtFlCŞÜ
();

1457 ià(!
	gcŞÜ
.
isV®id
())

1458 
	gcŞÜ
 = 
p£udoStyË
->
cŞÜ
();

1460 
	gcŞÜ
 = 
docum’t
()->
äame
()->
£ËùiÚ
()->
isFocu£dAndAùive
() ?

1461 
theme
()->
aùiveS–eùiÚFÜegroundCŞÜ
() :

1462 
theme
()->
šaùiveS–eùiÚFÜegroundCŞÜ
();

1464  
	gcŞÜ
;

1467 #ià
ENABLE
(
DRAG_SUPPORT
)

1468 
Node
* 
	gR’d”Objeù
::
d¿ggabËNode
(
boŞ
 
dhtmlOK
, boŞ 
uaOK
, 
x
, 
y
, boŞ& 
dhtmlWlD¿g
) const

1470 ià(!
	gdhtmlOK
 && !
	guaOK
)

1473 cÚ¡ 
R’d”Objeù
* 
	gcu¼
 = 
this
; cu¼; cu¼ = 
cu¼
->
·»Á
()) {

1474 
Node
* 
–t
 = 
cu¼
->
node
();

1475 ià(
	g–t
 &&ƒÉ->
nodeTy³
(è=ğ
Node
::
TEXT_NODE
) {

1478 ià(
uaOK
 && 
v›w
()->
äameV›w
()->
äame
()->
ev’tHªdËr
()->
shouldD¿gAutoNode
(
cu¼
->
node
(), 
IÁPošt
(
x
, 
y
))) {

1479 
dhtmlWlD¿g
 = 
çl£
;

1480  
	gcu¼
->
node
();

1482 ià(
	g–t
->
ÿnS¹S–eùiÚ
())

1488 
EU£rD¿g
 
	gd¿gMode
 = 
cu¼
->
¡yË
()->
u£rD¿g
();

1489 ià(
	gdhtmlOK
 && 
	gd¿gMode
 =ğ
DRAG_ELEMENT
) {

1490 
dhtmlWlD¿g
 = 
Œue
;

1491  
	gcu¼
->
node
();

1493 ià(
	guaOK
 && 
	gd¿gMode
 =ğ
DRAG_AUTO


1494 && 
v›w
()->
äameV›w
()->
äame
()->
ev’tHªdËr
()->
shouldD¿gAutoNode
(
cu¼
->
node
(), 
IÁPošt
(
x
, 
y
))) {

1495 
	gdhtmlWlD¿g
 = 
çl£
;

1496  
	gcu¼
->
node
();

1504 
	gR’d”Objeù
::
£ËùiÚS¹End
(& 
¥os
, & 
•os
) const

1506 
v›w
()->
£ËùiÚS¹End
(
¥os
, 
•os
);

1509 
	gR’d”Objeù
::
hªdËDyÇmicFlßtPos™iÚChªge
()

1514 
£tIÆše
(
¡yË
()->
isDi¥ÏyIÆšeTy³
());

1515 ià(
isIÆše
(è!ğ
·»Á
()->
chd»nIÆše
()) {

1516 ià(!
isIÆše
())

1517 
toR’d”BoxMod–Objeù
(
·»Á
())->
chdBeÿmeNÚIÆše
(
this
);

1520 
R’d”Block
* 
	gblock
 = 
toR’d”Block
(
·»Á
())->
ü—‹AnÚymousBlock
();

1521 
R’d”ObjeùChdLi¡
* 
	gchdli¡
 = 
·»Á
()->
vœtu®Chd»n
();

1522 
	gchdli¡
->
š£¹ChdNode
(
·»Á
(), 
block
, 
this
);

1523 
	gblock
->
chd»n
()->
­³ndChdNode
(
block
, 
chdli¡
->
»moveChdNode
(
·»Á
(), 
this
));

1528 
	gR’d”Objeù
::
£tAnim©abËStyË
(
PassRefPŒ
<
R’d”StyË
> 
¡yË
)

1530 ià(!
isText
(è&& 
¡yË
)

1531 
£tStyË
(
ªim©iÚ
()->
upd©eAnim©iÚs
(
this
, 
¡yË
.
g‘
()));

1533 
£tStyË
(
¡yË
);

1536 
StyËDifã»nû
 
	gR’d”Objeù
::
adju¡StyËDifã»nû
(StyËDifã»nû 
diff
, 
cÚ‹xtS’s™ivePrİ”t›s
) const

1538 #ià
USE
(
ACCELERATED_COMPOSITING
)

1540 ià(
	gcÚ‹xtS’s™ivePrİ”t›s
 & 
	gCÚ‹xtS’s™ivePrİ”tyT¿nsfÜm
) {

1544 ià(!
isText
(è&& (!
hasLay”
(è|| !
toR’d”BoxMod–Objeù
(
this
)->
Ïy”
()->
isCompos™ed
()))

1545 
	gdiff
 = 
StyËDifã»nûLayout
;

1546 ià(
	gdiff
 < 
	gStyËDifã»nûRecompos™eLay”
)

1547 
	gdiff
 = 
StyËDifã»nûRecompos™eLay”
;

1552 ià(
	gcÚ‹xtS’s™ivePrİ”t›s
 & 
	gCÚ‹xtS’s™ivePrİ”tyO·c™y
) {

1553 ià(!
isText
(è&& (!
hasLay”
(è|| !
toR’d”BoxMod–Objeù
(
this
)->
Ïy”
()->
isCompos™ed
()))

1554 
	gdiff
 = 
StyËDifã»nûR•aštLay”
;

1555 ià(
	gdiff
 < 
	gStyËDifã»nûRecompos™eLay”
)

1556 
	gdiff
 = 
StyËDifã»nûRecompos™eLay”
;

1559 
UNUSED_PARAM
(
cÚ‹xtS’s™ivePrİ”t›s
);

1563 ià(
	gdiff
 =ğ
StyËDifã»nûR•aštLay”
 && !
hasLay”
())

1564 
diff
 = 
StyËDifã»nûR•ašt
;

1566  
	gdiff
;

1569 
	gR’d”Objeù
::
£tStyË
(
PassRefPŒ
<
R’d”StyË
> 
¡yË
)

1571 ià(
m_¡yË
 =ğ
¡yË
)

1574 
StyËDifã»nû
 
	gdiff
 = 
StyËDifã»nûEqu®
;

1575 
	gcÚ‹xtS’s™ivePrİ”t›s
 = 
CÚ‹xtS’s™ivePrİ”tyNÚe
;

1576 ià(
	gm_¡yË
)

1577 
	gdiff
 = 
m_¡yË
->
diff
(
¡yË
.
g‘
(), 
cÚ‹xtS’s™ivePrİ”t›s
);

1579 
	gdiff
 = 
adju¡StyËDifã»nû
(
diff
, 
cÚ‹xtS’s™ivePrİ”t›s
);

1581 
¡yËWlChªge
(
diff
, 
¡yË
.
g‘
());

1583 
	gRefPŒ
<
	gR’d”StyË
> 
	gŞdStyË
 = 
m_¡yË
.
»Ëa£
();

1584 
	gm_¡yË
 = 
¡yË
;

1586 
upd©eFlImages
(
ŞdStyË
 ? oldStyË->
backgroundLay”s
(è: 0, 
m_¡yË
 ? m_style->backgroundLayers() : 0);

1587 
upd©eFlImages
(
ŞdStyË
 ? oldStyË->
maskLay”s
(è: 0, 
m_¡yË
 ? m_style->maskLayers() : 0);

1589 
upd©eImage
(
ŞdStyË
 ? oldStyË->
bÜd”Image
().
image
(è: 0, 
m_¡yË
 ? m_style->borderImage().image() : 0);

1590 
upd©eImage
(
ŞdStyË
 ? oldStyË->
maskBoxImage
().
image
(è: 0, 
m_¡yË
 ? m_style->maskBoxImage().image() : 0);

1594 ià(
	gm_¡yË
->
oušeWidth
(è> 0 && m_¡yË->
oušeSize
(è> 
maxim®OušeSize
(
PaštPha£Ouše
))

1595 
toR’d”V›w
(
docum’t
()->
»nd””
())->
£tMaxim®OušeSize
(
m_¡yË
->
oušeSize
());

1597 
¡yËDidChªge
(
diff
, 
ŞdStyË
.
g‘
());

1599 ià(!
	gm_·»Á
 || 
isText
())

1604 
StyËDifã»nû
 
	gupd©edDiff
 = 
adju¡StyËDifã»nû
(
diff
, 
cÚ‹xtS’s™ivePrİ”t›s
);

1606 ià(
	gdiff
 <ğ
StyËDifã»nûLayoutPos™iÚedMovem’tOÆy
) {

1607 ià(
upd©edDiff
 =ğ
StyËDifã»nûLayout
)

1608 
£tN“dsLayoutAndP»fWidthsReÿlc
();

1609 ià(
	gupd©edDiff
 =ğ
StyËDifã»nûLayoutPos™iÚedMovem’tOÆy
)

1610 
£tN“dsPos™iÚedMovem’tLayout
();

1613 ià(
	gupd©edDiff
 =ğ
StyËDifã»nûR•aštLay”
 || 
upd©edDiff
 =ğ
StyËDifã»nûR•ašt
) {

1616 
»·št
();

1620 
	gR’d”Objeù
::
£tStyËIÁ”Çl
(
PassRefPŒ
<
R’d”StyË
> 
¡yË
)

1622 
m_¡yË
 = 
¡yË
;

1625 
	gR’d”Objeù
::
¡yËWlChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ÃwStyË
)

1627 ià(
	gm_¡yË
) {

1630 ià(
	gÃwStyË
) {

1631 
boŞ
 
	gvisib™yChªged
 = 
m_¡yË
->
visib™y
(è!ğ
ÃwStyË
->visibility()

1632 || 
m_¡yË
->
zIndex
(è!ğ
ÃwStyË
->zIndex()

1633 || 
m_¡yË
->
hasAutoZIndex
(è!ğ
ÃwStyË
->hasAutoZIndex();

1634 #ià
ENABLE
(
DASHBOARD_SUPPORT
)

1635 ià(
	gvisib™yChªged
)

1636 
docum’t
()->
£tDashbßrdRegiÚsDœty
(
Œue
);

1638 ià(
	gvisib™yChªged
 && 
	gAXObjeùCache
::
acûssib™yEÇbËd
())

1639 
docum’t
()->
axObjeùCache
()->
chd»nChªged
(
this
);

1642 ià(
	gm_¡yË
->
visib™y
(è!ğ
ÃwStyË
->visibility()) {

1643 ià(
R’d”Lay”
* 
l
 = 
’şosšgLay”
()) {

1644 ià(
ÃwStyË
->
visib™y
(è=ğ
VISIBLE
)

1645 
l
->
£tHasVisibËCÚ‹Á
(
Œue
);

1646 ià(
	gl
->
hasVisibËCÚ‹Á
(è&& (
	gthis
 =ğ
l
->
»nd””
(è||†->»nd””()->
¡yË
()->
visib™y
(è!ğ
VISIBLE
)) {

1647 
l
->
dœtyVisibËCÚ‹ÁStus
();

1648 ià(
	gdiff
 > 
	gStyËDifã»nûR•aštLay”
)

1649 
»·št
();

1655 ià(
	gm_·»Á
 && (
	gdiff
 =ğ
StyËDifã»nûR•ašt
 || 
ÃwStyË
->
oušeSize
(è< 
m_¡yË
->outlineSize()))

1656 
»·št
();

1657 ià(
isFlßtšg
(è&& (
	gm_¡yË
->
æßtšg
(è!ğ
ÃwStyË
->floating()))

1660 
toR’d”Box
(
this
)->
»moveFlßtšgOrPos™iÚedChdFromBlockLi¡s
();

1661 ià(
isPos™iÚed
(è&& (
	gm_¡yË
->
pos™iÚ
(è!ğ
ÃwStyË
->position()))

1664 
toR’d”Box
(
this
)->
»moveFlßtšgOrPos™iÚedChdFromBlockLi¡s
();

1666 
	gs_afãùsP¬’tBlock
 = 
isFlßtšgOrPos™iÚed
() &&

1667 (!
ÃwStyË
->
isFlßtšg
(è&&‚ewStyË->
pos™iÚ
(è!ğ
AbsŞu‹Pos™iÚ
 &&‚ewStyË->pos™iÚ(è!ğ
FixedPos™iÚ
)

1668 && 
·»Á
(è&& (·»Á()->
isBlockFlow
(è||…¬’t()->
isR’d”IÆše
());

1671 ià(
	gdiff
 =ğ
StyËDifã»nûLayout
 || 
diff
 =ğ
StyËDifã»nûLayoutPos™iÚedMovem’tOÆy
) {

1672 
m_æßtšg
 = 
çl£
;

1673 
	gm_pos™iÚed
 = 
çl£
;

1674 
	gm_»lPos™iÚed
 = 
çl£
;

1676 
	gm_·štBackground
 = 
çl£
;

1677 
	gm_hasOv”æowCl
 = 
çl£
;

1678 
	gm_hasT¿nsfÜm
 = 
çl£
;

1679 
	gm_hasReæeùiÚ
 = 
çl£
;

1681 
	gs_afãùsP¬’tBlock
 = 
çl£
;

1683 ià(
v›w
()->
äameV›w
()) {

1687 
boŞ
 
	gshouldBl™OnFixedBackgroundImage
 = 
çl£
;

1688 #ià
ENABLE
(
FAST_MOBILE_SCROLLING
)

1693 
	gshouldBl™OnFixedBackgroundImage
 = 
Œue
;

1696 
boŞ
 
	gÃwStyËSlowSüŞl
 = 
ÃwStyË
 && (ÃwStyË->
pos™iÚ
(è=ğ
FixedPos™iÚ


1697 || (!
shouldBl™OnFixedBackgroundImage
 && 
ÃwStyË
->
hasFixedBackgroundImage
()));

1698 
boŞ
 
	gŞdStyËSlowSüŞl
 = 
m_¡yË
 && (m_¡yË->
pos™iÚ
(è=ğ
FixedPos™iÚ


1699 || (!
shouldBl™OnFixedBackgroundImage
 && 
m_¡yË
->
hasFixedBackgroundImage
()));

1701 ià(
	gŞdStyËSlowSüŞl
 !ğ
ÃwStyËSlowSüŞl
) {

1702 ià(
ŞdStyËSlowSüŞl
)

1703 
v›w
()->
äameV›w
()->
»moveSlowR•aštObjeù
();

1704 ià(
	gÃwStyËSlowSüŞl
)

1705 
v›w
()->
äameV›w
()->
addSlowR•aštObjeù
();

1710 
	gR’d”Objeù
::
¡yËDidChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
)

1712 ià(
	gs_afãùsP¬’tBlock
)

1713 
hªdËDyÇmicFlßtPos™iÚChªge
();

1715 ià(!
	gm_·»Á
)

1718 ià(
	gdiff
 =ğ
StyËDifã»nûLayout
) {

1719 
R’d”CouÁ”
::
»nd””StyËChªged
(
this
, 
ŞdStyË
, 
m_¡yË
.
g‘
());

1726 ià(
	gm_ÃedsLayout
 && 
	gŞdStyË
->
pos™iÚ
(è!ğ
m_¡yË
->position())

1727 
m¬kCÚššgBlocksFÜLayout
();

1729 
£tN“dsLayoutAndP»fWidthsReÿlc
();

1730 } ià(
	gdiff
 =ğ
StyËDifã»nûLayoutPos™iÚedMovem’tOÆy
)

1731 
£tN“dsPos™iÚedMovem’tLayout
();

1737 
	gR’d”Objeù
::
upd©eFlImages
(cÚ¡ 
FlLay”
* 
ŞdLay”s
, cÚ¡ FlLay”* 
ÃwLay”s
)

1740 ià(
	gŞdLay”s
 && !ŞdLay”s->
Ãxt
(è&& 
	gÃwLay”s
 && !ÃwLay”s->Ãxt(è&& (ŞdLay”s->
image
(è=ğ
ÃwLay”s
->image()))

1744 cÚ¡ 
FlLay”
* 
	gcu¼New
 = 
ÃwLay”s
; cu¼New; cu¼New = 
cu¼New
->
Ãxt
()) {

1745 ià(
cu¼New
->
image
())

1746 
cu¼New
->
image
()->
addCl›Á
(
this
);

1749 cÚ¡ 
FlLay”
* 
	gcu¼Old
 = 
ŞdLay”s
; cu¼Old; cu¼Old = 
cu¼Old
->
Ãxt
()) {

1750 ià(
cu¼Old
->
image
())

1751 
cu¼Old
->
image
()->
»moveCl›Á
(
this
);

1755 
	gR’d”Objeù
::
upd©eImage
(
StyËImage
* 
ŞdImage
, StyËImage* 
ÃwImage
)

1757 ià(
	gŞdImage
 !ğ
ÃwImage
) {

1758 ià(
ŞdImage
)

1759 
ŞdImage
->
»moveCl›Á
(
this
);

1760 ià(
	gÃwImage
)

1761 
	gÃwImage
->
addCl›Á
(
this
);

1765 
IÁReù
 
	gR’d”Objeù
::
v›wReù
() const

1767  
v›w
()->
v›wReù
();

1770 
FlßtPošt
 
	gR’d”Objeù
::
loÿlToAbsŞu‹
(FlßtPošˆ
loÿlPošt
, 
boŞ
 
fixed
, boŞ 
u£T¿nsfÜms
) const

1772 
T¿nsfÜmS‹
 
ŒªsfÜmS‹
(T¿nsfÜmS‹::
AµlyT¿nsfÜmDœeùiÚ
, 
loÿlPošt
);

1773 
m­LoÿlToCÚš”
(0, 
fixed
, 
u£T¿nsfÜms
, 
ŒªsfÜmS‹
);

1774 
	gŒªsfÜmS‹
.
æ©‹n
();

1776  
	gŒªsfÜmS‹
.
Ï¡PÏÇrPošt
();

1779 
FlßtPošt
 
	gR’d”Objeù
::
absŞu‹ToLoÿl
(FlßtPošˆ
cÚš”Pošt
, 
boŞ
 
fixed
, boŞ 
u£T¿nsfÜms
) const

1781 
T¿nsfÜmS‹
 
ŒªsfÜmS‹
(T¿nsfÜmS‹::
UÇµlyInv”£T¿nsfÜmDœeùiÚ
, 
cÚš”Pošt
);

1782 
m­AbsŞu‹ToLoÿlPošt
(
fixed
, 
u£T¿nsfÜms
, 
ŒªsfÜmS‹
);

1783 
	gŒªsfÜmS‹
.
æ©‹n
();

1785  
	gŒªsfÜmS‹
.
Ï¡PÏÇrPošt
();

1788 
	gR’d”Objeù
::
m­LoÿlToCÚš”
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
boŞ
 
fixed
, boŞ 
u£T¿nsfÜms
, 
T¿nsfÜmS‹
& 
ŒªsfÜmS‹
) const

1790 ià(
	g»·štCÚš”
 =ğ
this
)

1793 
R’d”Objeù
* 
	go
 = 
·»Á
();

1794 ià(!
	go
)

1797 
IÁSize
 
	gcŞumnOff£t
;

1798 
	go
->
adju¡FÜCŞumns
(
cŞumnOff£t
, 
roundedIÁPošt
(
ŒªsfÜmS‹
.
m­³dPošt
()));

1799 ià(!
	gcŞumnOff£t
.
isZ”o
())

1800 
	gŒªsfÜmS‹
.
move
(
cŞumnOff£t
);

1802 ià(
	go
->
hasOv”æowCl
())

1803 
	gŒªsfÜmS‹
.
move
(-
toR’d”Box
(
o
)->
Ïy”
()->
süŞËdCÚ‹ÁOff£t
());

1805 
	go
->
m­LoÿlToCÚš”
(
»·štCÚš”
, 
fixed
, 
u£T¿nsfÜms
, 
ŒªsfÜmS‹
);

1808 
	gR’d”Objeù
::
m­AbsŞu‹ToLoÿlPošt
(
boŞ
 
fixed
, boŞ 
u£T¿nsfÜms
, 
T¿nsfÜmS‹
& 
ŒªsfÜmS‹
) const

1810 
R’d”Objeù
* 
	go
 = 
·»Á
();

1811 ià(
	go
) {

1812 
	go
->
m­AbsŞu‹ToLoÿlPošt
(
fixed
, 
u£T¿nsfÜms
, 
ŒªsfÜmS‹
);

1813 ià(
	go
->
hasOv”æowCl
())

1814 
	gŒªsfÜmS‹
.
move
(
toR’d”Box
(
o
)->
Ïy”
()->
süŞËdCÚ‹ÁOff£t
());

1818 
boŞ
 
	gR’d”Objeù
::
shouldU£T¿nsfÜmFromCÚš”
(cÚ¡ 
R’d”Objeù
* 
cÚš”Objeù
) const

1820 #ià
ENABLE
(3D
_RENDERING
)

1823  (
hasLay”
(è&& 
toR’d”BoxMod–Objeù
(
this
)->
Ïy”
()->
ŒªsfÜm
()è|| (
cÚš”Objeù
 && cÚš”Objeù->
¡yË
()->
hasP”¥eùive
());

1825 
UNUSED_PARAM
(
cÚš”Objeù
);

1826  
hasT¿nsfÜm
();

1830 
	gR’d”Objeù
::
g‘T¿nsfÜmFromCÚš”
(cÚ¡ 
R’d”Objeù
* 
cÚš”Objeù
, cÚ¡ 
IÁSize
& 
off£tInCÚš”
, 
T¿nsfÜm©iÚM©rix
& 
ŒªsfÜm
) const

1832 
	gŒªsfÜm
.
makeId’t™y
();

1833 
	gŒªsfÜm
.
Œª¦©e
(
off£tInCÚš”
.
width
(), off£tInCÚš”.
height
());

1834 
R’d”Lay”
* 
	gÏy”
;

1835 ià(
hasLay”
(è&& (
	gÏy”
 = 
toR’d”BoxMod–Objeù
(
this
)->
Ïy”
()è&&†ay”->
ŒªsfÜm
())

1836 
ŒªsfÜm
.
muÉLeá
(
Ïy”
->
cu¼’tT¿nsfÜm
());

1838 #ià
ENABLE
(3D
_RENDERING
)

1839 ià(
	gcÚš”Objeù
 && cÚš”Objeù->
hasLay”
(è&& cÚš”Objeù->
¡yË
()->
hasP”¥eùive
()) {

1841 
ASSERT
(
cÚš”Objeù
->
hasLay”
());

1842 
FlßtPošt
 
	g³r¥eùiveOrigš
 = 
toR’d”Box
(
cÚš”Objeù
)->
Ïy”
()->
³r¥eùiveOrigš
();

1844 
T¿nsfÜm©iÚM©rix
 
	g³r¥eùiveM©rix
;

1845 
	g³r¥eùiveM©rix
.
­¶yP”¥eùive
(
cÚš”Objeù
->
¡yË
()->
³r¥eùive
());

1847 
	gŒªsfÜm
.
Œª¦©eRight3d
(-
³r¥eùiveOrigš
.
x
(), -³r¥eùiveOrigš.
y
(), 0);

1848 
	gŒªsfÜm
.
muÉly
(
³r¥eùiveM©rix
);

1849 
	gŒªsfÜm
.
Œª¦©eRight3d
(
³r¥eùiveOrigš
.
x
(),…”¥eùiveOrigš.
y
(), 0);

1852 
UNUSED_PARAM
(
cÚš”Objeù
);

1856 
FlßtQuad
 
	gR’d”Objeù
::
loÿlToCÚš”Quad
(cÚ¡ FlßtQuad& 
loÿlQuad
, 
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
boŞ
 
fixed
) const

1860 
T¿nsfÜmS‹
 
ŒªsfÜmS‹
(T¿nsfÜmS‹::
AµlyT¿nsfÜmDœeùiÚ
, 
loÿlQuad
.
boundšgBox
().
ûÁ”
(), &localQuad);

1861 
m­LoÿlToCÚš”
(
»·štCÚš”
, 
fixed
, 
Œue
, 
ŒªsfÜmS‹
);

1862 
	gŒªsfÜmS‹
.
æ©‹n
();

1864  
	gŒªsfÜmS‹
.
Ï¡PÏÇrQuad
();

1867 
IÁSize
 
	gR’d”Objeù
::
off£tFromCÚš”
(
R’d”Objeù
* 
o
, cÚ¡ 
IÁPošt
& 
pošt
) const

1869 
ASSERT
(
o
 =ğ
cÚš”
());

1871 
IÁSize
 
	goff£t
;

1873 
	go
->
adju¡FÜCŞumns
(
off£t
, 
pošt
);

1875 ià(
	go
->
hasOv”æowCl
())

1876 
	goff£t
 -ğ
toR’d”Box
(
o
)->
Ïy”
()->
süŞËdCÚ‹ÁOff£t
();

1878  
	goff£t
;

1881 
IÁSize
 
	gR’d”Objeù
::
off£tFromAnû¡ÜCÚš”
(
R’d”Objeù
* 
cÚš”
) const

1883 
IÁSize
 
off£t
;

1884 
IÁPošt
 
	g»ã»nûPošt
;

1885 cÚ¡ 
R’d”Objeù
* 
	gcu¼CÚš”
 = 
this
;

1887 
R’d”Objeù
* 
	gÃxtCÚš”
 = 
cu¼CÚš”
->
cÚš”
();

1888 
ASSERT
(
ÃxtCÚš”
);

1889 ià(!
	gÃxtCÚš”
)

1891 
ASSERT
(!
cu¼CÚš”
->
hasT¿nsfÜm
());

1892 
IÁSize
 
	gcu¼’tOff£t
 = 
cu¼CÚš”
->
off£tFromCÚš”
(
ÃxtCÚš”
, 
»ã»nûPošt
);

1893 
	goff£t
 +ğ
cu¼’tOff£t
;

1894 
	g»ã»nûPošt
.
move
(
cu¼’tOff£t
);

1895 
	gcu¼CÚš”
 = 
ÃxtCÚš”
;

1896 } 
	gcu¼CÚš”
 !ğ
cÚš”
);

1898  
	goff£t
;

1901 
IÁReù
 
	gR’d”Objeù
::
loÿlC¬‘Reù
(
IÆšeBox
*, , * 
exŒaWidthToEndOfLše
)

1903 ià(
	gexŒaWidthToEndOfLše
)

1904 *
	gexŒaWidthToEndOfLše
 = 0;

1906  
IÁReù
();

1909 
R’d”V›w
* 
	gR’d”Objeù
::
v›w
() const

1911  
toR’d”V›w
(
docum’t
()->
»nd””
());

1914 
boŞ
 
	gR’d”Objeù
::
isRoÙed
(
R’d”V›w
** 
v›w
)

1916 
R’d”Objeù
* 
o
 = 
this
;

1917 
	go
->
·»Á
())

1918 
	go
 = 
o
->
·»Á
();

1920 ià(!
	go
->
isR’d”V›w
())

1921  
	gçl£
;

1923 ià(
	gv›w
)

1924 *
	gv›w
 = 
toR’d”V›w
(
o
);

1926  
	gŒue
;

1929 
boŞ
 
	gR’d”Objeù
::
hasOušeAÂÙ©iÚ
() const

1931  
node
(è&&‚ode()->
isLšk
(è&& 
docum’t
()->
´štšg
();

1934 
R’d”Objeù
* 
	gR’d”Objeù
::
cÚš”
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
boŞ
* 
»·štCÚš”Sk³d
) const

1936 ià(
	g»·štCÚš”Sk³d
)

1937 *
	g»·štCÚš”Sk³d
 = 
çl£
;

1948 
R’d”Objeù
* 
	go
 = 
·»Á
();

1950 ià(
isText
())

1951  
	go
;

1953 
EPos™iÚ
 
	gpos
 = 
m_¡yË
->
pos™iÚ
();

1954 ià(
	gpos
 =ğ
FixedPos™iÚ
) {

1963 
o
 && o->
·»Á
(è&& !(o->
hasT¿nsfÜm
(è&& o->
isR’d”Block
())) {

1964 ià(
»·štCÚš”Sk³d
 && 
o
 =ğ
»·štCÚš”
)

1965 *
»·štCÚš”Sk³d
 = 
Œue
;

1966 
	go
 = 
o
->
·»Á
();

1968 } ià(
	gpos
 =ğ
AbsŞu‹Pos™iÚ
) {

1972 
o
 && o->
¡yË
()->
pos™iÚ
(è=ğ
SticPos™iÚ
 && !o->
isR’d”V›w
(è&& !(o->
hasT¿nsfÜm
(è&& o->
isR’d”Block
())) {

1973 ià(
»·štCÚš”Sk³d
 && 
o
 =ğ
»·štCÚš”
)

1974 *
»·štCÚš”Sk³d
 = 
Œue
;

1975 
	go
 = 
o
->
·»Á
();

1979  
	go
;

1982 
boŞ
 
	gR’d”Objeù
::
isS–eùiÚBÜd”
() const

1984 
S–eùiÚS‹
 
¡
 = 
£ËùiÚS‹
();

1985  
	g¡
 =ğ
S–eùiÚS¹
 || 
¡
 =ğ
S–eùiÚEnd
 || sˆ=ğ
S–eùiÚBÙh
;

1988 
	gR’d”Objeù
::
de¡roy
()

1991 
R’d”ObjeùChdLi¡
* 
chd»n
 = 
vœtu®Chd»n
();

1992 ià(
	gchd»n
)

1993 
	gchd»n
->
de¡royLeáov”Chd»n
();

2000 
ASSERT
(
docum’t
()->
äame
());

2001 ià(
docum’t
()->
äame
(è&& docum’t()->äame()->
ev’tHªdËr
()->
autosüŞlR’d””
(è=ğ
this
)

2002 
docum’t
()->
äame
()->
ev’tHªdËr
()->
¡İAutosüŞlTim”
(
Œue
);

2004 ià(
	gm_hasCouÁ”NodeM­
)

2005 
	gR’d”CouÁ”
::
de¡royCouÁ”Nodes
(
this
);

2007 ià(
	gAXObjeùCache
::
acûssib™yEÇbËd
()) {

2008 
docum’t
()->
axObjeùCache
()->
chd»nChªged
(
this
->
·»Á
());

2009 
docum’t
()->
axObjeùCache
()->
»move
(
this
);

2011 
ªim©iÚ
()->
ÿnûlAnim©iÚs
(
this
);

2017 
»move
();

2021 ià(
hasLay”
()) {

2022 
£tHasLay”
(
çl£
);

2023 
toR’d”BoxMod–Objeù
(
this
)->
de¡royLay”
();

2025 
¬’aD–‘e
(
»nd”A»Ç
(), 
this
);

2028 
	gR’d”Objeù
::
¬’aD–‘e
(
R’d”A»Ç
* 
¬’a
, * 
ba£
)

2030 ià(
	gm_¡yË
) {

2031 cÚ¡ 
FlLay”
* 
	gbgLay”
 = 
m_¡yË
->
backgroundLay”s
(); bgLay”; bgLay” = 
bgLay”
->
Ãxt
()) {

2032 ià(
StyËImage
* 
backgroundImage
 = 
bgLay”
->
image
())

2033 
backgroundImage
->
»moveCl›Á
(
this
);

2036 cÚ¡ 
FlLay”
* 
	gmaskLay”
 = 
m_¡yË
->
maskLay”s
(); maskLay”; maskLay” = 
maskLay”
->
Ãxt
()) {

2037 ià(
StyËImage
* 
maskImage
 = 
maskLay”
->
image
())

2038 
maskImage
->
»moveCl›Á
(
this
);

2041 ià(
StyËImage
* 
	gbÜd”Image
 = 
m_¡yË
->
bÜd”Image
().
image
())

2042 
bÜd”Image
->
»moveCl›Á
(
this
);

2044 ià(
StyËImage
* 
	gmaskBoxImage
 = 
m_¡yË
->
maskBoxImage
().
image
())

2045 
maskBoxImage
->
»moveCl›Á
(
this
);

2048 #iâdeà
NDEBUG


2049 * 
	g§vedBa£
 = 
ba£OfR’d”ObjeùBešgD–‘ed
;

2050 
	gba£OfR’d”ObjeùBešgD–‘ed
 = 
ba£
;

2052 
d–‘e
 
	gthis
;

2053 #iâdeà
NDEBUG


2054 
	gba£OfR’d”ObjeùBešgD–‘ed
 = 
§vedBa£
;

2058 
	g¬’a
->
ä“
(*(
size_t
*)
ba£
, base);

2061 
VisibËPos™iÚ
 
	gR’d”Objeù
::
pos™iÚFÜCoÜdš©es
(
x
, 
y
)

2063  
pos™iÚFÜPošt
(
IÁPošt
(
x
, 
y
));

2066 
VisibËPos™iÚ
 
	gR’d”Objeù
::
pos™iÚFÜPošt
(cÚ¡ 
IÁPošt
&)

2068  
ü—‹VisibËPos™iÚ
(
ÿ»tMšOff£t
(), 
DOWNSTREAM
);

2071 
	gR’d”Objeù
::
upd©eD¿gS‹
(
boŞ
 
d¿gOn
)

2073 
boŞ
 
v®ueChªged
 = (
d¿gOn
 !ğ
m_isD¿ggšg
);

2074 
	gm_isD¿ggšg
 = 
d¿gOn
;

2075 ià(
	gv®ueChªged
 && 
¡yË
()->
afãùedByD¿gRuËs
())

2076 
node
()->
£tN“dsStyËReÿlc
();

2077 
R’d”Objeù
* 
	gcu¼
 = 
fœ¡Chd
(); cu¼; cu¼ = 
cu¼
->
ÃxtSiblšg
())

2078 
cu¼
->
upd©eD¿gS‹
(
d¿gOn
);

2081 
boŞ
 
	gR’d”Objeù
::
h™Te¡
(cÚ¡ 
H™Te¡Reque¡
& 
»que¡
, 
H™Te¡ResuÉ
& 
»suÉ
, cÚ¡ 
IÁPošt
& 
pošt
, 
tx
, 
ty
, 
H™Te¡F‹r
 
h™Te¡F‹r
)

2083 
boŞ
 
	gšside
 = 
çl£
;

2084 ià(
	gh™Te¡F‹r
 !ğ
H™Te¡S–f
) {

2086 
šside
 = 
nodeAtPošt
(
»que¡
, 
»suÉ
, 
pošt
.
x
(),…ošt.
y
(), 
tx
, 
ty
, 
H™Te¡FÜeground
);

2089 ià(!
	gšside
)

2090 
	gšside
 = 
nodeAtPošt
(
»que¡
, 
»suÉ
, 
pošt
.
x
(),…ošt.
y
(), 
tx
, 
ty
, 
H™Te¡Flßt
);

2093 ià(!
	gšside
)

2094 
	gšside
 = 
nodeAtPošt
(
»que¡
, 
»suÉ
, 
pošt
.
x
(),…ošt.
y
(), 
tx
, 
ty
, 
H™Te¡ChdBlockBackgrounds
);

2098 ià(
	gh™Te¡F‹r
 !ğ
H™Te¡Desûndªts
 && !
šside
)

2099 
šside
 = 
nodeAtPošt
(
»que¡
, 
»suÉ
, 
pošt
.
x
(),…ošt.
y
(), 
tx
, 
ty
, 
H™Te¡BlockBackground
);

2101  
	gšside
;

2104 
	gR’d”Objeù
::
upd©eH™Te¡ResuÉ
(
H™Te¡ResuÉ
& 
»suÉ
, cÚ¡ 
IÁPošt
& 
pošt
)

2106 ià(
	g»suÉ
.
šÃrNode
())

2109 
Node
* 
	gn
 = 
node
();

2110 ià(
	gn
) {

2111 
	g»suÉ
.
£tIÂ”Node
(
n
);

2112 ià(!
	g»suÉ
.
šÃrNÚSh¬edNode
())

2113 
	g»suÉ
.
£tIÂ”NÚSh¬edNode
(
n
);

2114 
	g»suÉ
.
£tLoÿlPošt
(
pošt
);

2118 
boŞ
 
	gR’d”Objeù
::
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, , , , , 
H™Te¡AùiÚ
)

2120  
	gçl£
;

2123 
	gR’d”Objeù
::
lšeHeight
(
boŞ
 
fœ¡Lše
, bool ) const

2125  
¡yË
(
fœ¡Lše
)->
compu‹dLšeHeight
();

2128 
	gR’d”Objeù
::
ba£lšePos™iÚ
(
boŞ
 
fœ¡Lše
, boŞ 
isRoÙLšeBox
) const

2130 cÚ¡ 
	gFÚt
& 
	gf
 = 
¡yË
(
fœ¡Lše
)->
fÚt
();

2131  
	gf
.
asûÁ
(è+ (
lšeHeight
(
fœ¡Lše
, 
isRoÙLšeBox
è- f.
height
()) / 2;

2134 
	gR’d”Objeù
::
scheduËR–ayout
()

2136 ià(
isR’d”V›w
()) {

2137 
F¿meV›w
* 
v›w
 = 
toR’d”V›w
(
this
)->
äameV›w
();

2138 ià(
	gv›w
)

2139 
	gv›w
->
scheduËR–ayout
();

2140 } ià(
·»Á
()) {

2141 
F¿meV›w
* 
	gv
 = 
v›w
(è? v›w()->
äameV›w
() : 0;

2142 ià(
	gv
)

2143 
	gv
->
scheduËR–ayoutOfSubŒ“
(
this
);

2147 
	gR’d”Objeù
::
Ïyout
()

2149 
ASSERT
(
ÃedsLayout
());

2150 
R’d”Objeù
* 
	gchd
 = 
fœ¡Chd
();

2151 
	gchd
) {

2152 
	gchd
->
ÏyoutIfN“ded
();

2153 
ASSERT
(!
chd
->
ÃedsLayout
());

2154 
	gchd
 = 
chd
->
ÃxtSiblšg
();

2156 
£tN“dsLayout
(
çl£
);

2159 
	gPassRefPŒ
<
	gR’d”StyË
> 
	gR’d”Objeù
::
unÿchedFœ¡LšeStyË
(
R’d”StyË
* 
¡yË
) const

2161 ià(!
docum’t
()->
u£sFœ¡LšeRuËs
())

2164 
ASSERT
(!
isText
());

2166 
	gRefPŒ
<
	gR’d”StyË
> 
	g»suÉ
;

2168 ià(
isBlockFlow
()) {

2169 ià(
R’d”Block
* 
	gfœ¡LšeBlock
 = 
this
->
fœ¡LšeBlock
())

2170 
»suÉ
 = 
fœ¡LšeBlock
->
g‘UnÿchedP£udoStyË
(
FIRST_LINE
, 
¡yË
, fœ¡LšeBlock =ğ
this
 ? style : 0);

2171 } ià(!
isAnÚymous
(è&& 
isR’d”IÆše
()) {

2172 
R’d”StyË
* 
	g·»ÁStyË
 = 
·»Á
()->
fœ¡LšeStyË
();

2173 ià(
	g·»ÁStyË
 !ğ
·»Á
()->
¡yË
())

2174 
»suÉ
 = 
g‘UnÿchedP£udoStyË
(
FIRST_LINE_INHERITED
, 
·»ÁStyË
, 
¡yË
);

2177  
	g»suÉ
.
»Ëa£
();

2180 
R’d”StyË
* 
	gR’d”Objeù
::
fœ¡LšeStyËSlowCa£
() const

2182 
ASSERT
(
docum’t
()->
u£sFœ¡LšeRuËs
());

2184 
R’d”StyË
* 
	g¡yË
 = 
m_¡yË
.
g‘
();

2185 cÚ¡ 
R’d”Objeù
* 
	g»nd””
 = 
isText
(è? 
·»Á
(è: 
this
;

2186 ià(
	g»nd””
->
isBlockFlow
()) {

2187 ià(
R’d”Block
* 
	gfœ¡LšeBlock
 = 
»nd””
->
fœ¡LšeBlock
())

2188 
¡yË
 = 
fœ¡LšeBlock
->
g‘CachedP£udoStyË
(
FIRST_LINE
, style);

2189 } ià(!
	g»nd””
->
isAnÚymous
(è&&„’d””->
isR’d”IÆše
()) {

2190 
R’d”StyË
* 
	g·»ÁStyË
 = 
»nd””
->
·»Á
()->
fœ¡LšeStyË
();

2191 ià(
	g·»ÁStyË
 !ğ
»nd””
->
·»Á
()->
¡yË
()) {

2193 
¡yË
->
£tHasP£udoStyË
(
FIRST_LINE_INHERITED
);

2194 
	g¡yË
 = 
»nd””
->
g‘CachedP£udoStyË
(
FIRST_LINE_INHERITED
, 
·»ÁStyË
);

2198  
	g¡yË
;

2201 
R’d”StyË
* 
	gR’d”Objeù
::
g‘CachedP£udoStyË
(
P£udoId
 
p£udo
, R’d”StyË* 
·»ÁStyË
) const

2203 ià(
	gp£udo
 < 
	gFIRST_INTERNAL_PSEUDOID
 && !
¡yË
()->
hasP£udoStyË
(
p£udo
))

2206 
R’d”StyË
* 
	gÿchedStyË
 = 
¡yË
()->
g‘CachedP£udoStyË
(
p£udo
);

2207 ià(
	gÿchedStyË
)

2208  
	gÿchedStyË
;

2210 
	gRefPŒ
<
	gR’d”StyË
> 
	g»suÉ
 = 
g‘UnÿchedP£udoStyË
(
p£udo
, 
·»ÁStyË
);

2211 ià(
	g»suÉ
)

2212  
¡yË
()->
addCachedP£udoStyË
(
»suÉ
.
»Ëa£
());

2216 
	gPassRefPŒ
<
	gR’d”StyË
> 
	gR’d”Objeù
::
g‘UnÿchedP£udoStyË
(
P£udoId
 
p£udo
, 
R’d”StyË
* 
·»ÁStyË
, R’d”StyË* 
ownStyË
) const

2218 ià(
	gp£udo
 < 
	gFIRST_INTERNAL_PSEUDOID
 && !
	gownStyË
 && !
¡yË
()->
hasP£udoStyË
(
p£udo
))

2221 ià(!
	g·»ÁStyË
) {

2222 
ASSERT
(!
ownStyË
);

2223 
	g·»ÁStyË
 = 
¡yË
();

2226 
Node
* 
	gn
 = 
node
();

2227 
	gn
 && !n->
isEËm’tNode
())

2228 
	gn
 = 
n
->
·»ÁNode
();

2229 ià(!
	gn
)

2232 
	gRefPŒ
<
	gR’d”StyË
> 
	g»suÉ
;

2233 ià(
	gp£udo
 =ğ
FIRST_LINE_INHERITED
) {

2234 
»suÉ
 = 
docum’t
()->
¡yËS–eùÜ
()->
¡yËFÜEËm’t
(
¡©ic_ÿ¡
<
EËm’t
*>(
n
), 
·»ÁStyË
, 
çl£
);

2235 
	g»suÉ
->
£tStyËTy³
(
FIRST_LINE_INHERITED
);

2237 
	g»suÉ
 = 
docum’t
()->
¡yËS–eùÜ
()->
p£udoStyËFÜEËm’t
(
p£udo
, 
¡©ic_ÿ¡
<
EËm’t
*>(
n
), 
·»ÁStyË
);

2238  
	g»suÉ
.
»Ëa£
();

2241 
CŞÜ
 
decÜ©iÚCŞÜ
(
R’d”Objeù
* 
»nd””
)

2243 
CŞÜ
 
	g»suÉ
;

2244 ià(
	g»nd””
->
¡yË
()->
‹xtSŒokeWidth
() > 0) {

2246 
	g»suÉ
 = 
»nd””
->
¡yË
()->
vis™edD•’d’tCŞÜ
(
CSSPrİ”tyWebk™TextSŒokeCŞÜ
);

2247 ià(
	g»suÉ
.
®pha
())

2248  
	g»suÉ
;

2251 
	g»suÉ
 = 
»nd””
->
¡yË
()->
vis™edD•’d’tCŞÜ
(
CSSPrİ”tyWebk™TextFlCŞÜ
);

2252  
	g»suÉ
;

2255 
	gR’d”Objeù
::
g‘TextDecÜ©iÚCŞÜs
(
decÜ©iÚs
, 
CŞÜ
& 
und”lše
, CŞÜ& 
ov”lše
,

2256 
CŞÜ
& 
lš‘hrough
, 
boŞ
 
quœksMode
)

2258 
R’d”Objeù
* 
	gcu¼
 = 
this
;

2260 
	gcu¼Decs
 = 
cu¼
->
¡yË
()->
‹xtDecÜ©iÚ
();

2261 ià(
	gcu¼Decs
) {

2262 ià(
	gcu¼Decs
 & 
	gUNDERLINE
) {

2263 
	gdecÜ©iÚs
 &ğ~
UNDERLINE
;

2264 
	gund”lše
 = 
decÜ©iÚCŞÜ
(
cu¼
);

2266 ià(
	gcu¼Decs
 & 
	gOVERLINE
) {

2267 
	gdecÜ©iÚs
 &ğ~
OVERLINE
;

2268 
	gov”lše
 = 
decÜ©iÚCŞÜ
(
cu¼
);

2270 ià(
	gcu¼Decs
 & 
	gLINE_THROUGH
) {

2271 
	gdecÜ©iÚs
 &ğ~
LINE_THROUGH
;

2272 
	glš‘hrough
 = 
decÜ©iÚCŞÜ
(
cu¼
);

2275 
	gcu¼
 = 
cu¼
->
·»Á
();

2276 ià(
	gcu¼
 && cu¼->
isR’d”Block
(è&& 
toR’d”Block
(
cu¼
)->
šlšeCÚtšu©iÚ
())

2277 
	gcu¼
 = 
toR’d”Block
(
cu¼
)->
šlšeCÚtšu©iÚ
();

2278 } 
	gcu¼
 && 
	gdecÜ©iÚs
 && (!
	gquœksMode
 || !cu¼->
node
() ||

2279 (!
	gcu¼
->
node
()->
hasTagName
(
aTag
è&& !cu¼->node()->hasTagName(
fÚtTag
))));

2282 ià(
	gdecÜ©iÚs
 && 
	gcu¼
) {

2283 ià(
	gdecÜ©iÚs
 & 
	gUNDERLINE
)

2284 
	gund”lše
 = 
decÜ©iÚCŞÜ
(
cu¼
);

2285 ià(
	gdecÜ©iÚs
 & 
	gOVERLINE
)

2286 
	gov”lše
 = 
decÜ©iÚCŞÜ
(
cu¼
);

2287 ià(
	gdecÜ©iÚs
 & 
	gLINE_THROUGH
)

2288 
	glš‘hrough
 = 
decÜ©iÚCŞÜ
(
cu¼
);

2292 #ià
ENABLE
(
DASHBOARD_SUPPORT
)

2293 
	gR’d”Objeù
::
addDashbßrdRegiÚs
(
VeùÜ
<
DashbßrdRegiÚV®ue
>& 
»giÚs
)

2296 ià(
¡yË
()->
visib™y
(è!ğ
VISIBLE
 || !
isBox
())

2299 
R’d”Box
* 
	gbox
 = 
toR’d”Box
(
this
);

2301 cÚ¡ 
	gVeùÜ
<
	gStyËDashbßrdRegiÚ
>& 
	g¡yËRegiÚs
 = 
¡yË
()->
dashbßrdRegiÚs
();

2302 
	gi
, 
	gcouÁ
 = 
¡yËRegiÚs
.
size
();

2303 
	gi
 = 0; i < 
	gcouÁ
; i++) {

2304 
StyËDashbßrdRegiÚ
 
	g¡yËRegiÚ
 = 
¡yËRegiÚs
[
i
];

2306 
	gw
 = 
box
->
width
();

2307 
	gh
 = 
box
->
height
();

2309 
DashbßrdRegiÚV®ue
 
	g»giÚ
;

2310 
	g»giÚ
.
	gÏb–
 = 
¡yËRegiÚ
.
Ïb–
;

2311 
	g»giÚ
.
	gbounds
 = 
IÁReù
(
¡yËRegiÚ
.
off£t
.
Ëá
().
v®ue
(),

2312 
¡yËRegiÚ
.
off£t
.
tİ
().
v®ue
(),

2313 
w
 - 
¡yËRegiÚ
.
off£t
.
Ëá
().
v®ue
(è- styËRegiÚ.off£t.
right
().value(),

2314 
h
 - 
¡yËRegiÚ
.
off£t
.
tİ
().
v®ue
(è- styËRegiÚ.off£t.
bÙtom
().value());

2315 
	g»giÚ
.
	gty³
 = 
¡yËRegiÚ
.
ty³
;

2317 
	g»giÚ
.
	gş
 = 
»giÚ
.
bounds
;

2318 
compu‹AbsŞu‹R•aštReù
(
»giÚ
.
ş
);

2319 ià(
	g»giÚ
.
	gş
.
height
() < 0) {

2320 
	g»giÚ
.
	gş
.
£tHeight
(0);

2321 
	g»giÚ
.
	gş
.
£tWidth
(0);

2324 
FlßtPošt
 
	gabsPos
 = 
loÿlToAbsŞu‹
();

2325 
	g»giÚ
.
	gbounds
.
£tX
(
absPos
.
x
(è+ 
¡yËRegiÚ
.
off£t
.
Ëá
().
v®ue
());

2326 
	g»giÚ
.
	gbounds
.
£tY
(
absPos
.
y
(è+ 
¡yËRegiÚ
.
off£t
.
tİ
().
v®ue
());

2328 ià(
docum’t
()->
äame
()) {

2329 
	g·geSÿËFaùÜ
 = 
docum’t
()->
äame
()->
·ge
()->
chrome
()->
sÿËFaùÜ
();

2330 ià(
	g·geSÿËFaùÜ
 != 1.0f) {

2331 
»giÚ
.
bounds
.
sÿË
(
·geSÿËFaùÜ
);

2332 
	g»giÚ
.
	gş
.
sÿË
(
·geSÿËFaùÜ
);

2336 
	g»giÚs
.
­³nd
(
»giÚ
);

2340 
	gR’d”Objeù
::
cŞËùDashbßrdRegiÚs
(
VeùÜ
<
DashbßrdRegiÚV®ue
>& 
»giÚs
)

2344 ià(
isText
())

2347 
addDashbßrdRegiÚs
(
»giÚs
);

2348 
R’d”Objeù
* 
	gcu¼
 = 
fœ¡Chd
(); cu¼; cu¼ = 
cu¼
->
ÃxtSiblšg
())

2349 
cu¼
->
cŞËùDashbßrdRegiÚs
(
»giÚs
);

2353 
boŞ
 
	gR’d”Objeù
::
wlR’d”Image
(
CachedImage
*)

2356 ià(
¡yË
()->
visib™y
(è!ğ
VISIBLE
)

2357  
çl£
;

2361  !
docum’t
()->
šPageCache
(è&& !docum’t()->
v›w
()->
isOffsü“n
();

2364 
	gR’d”Objeù
::
maxim®OušeSize
(
PaštPha£
 
p
) const

2366 ià(
p
 !ğ
PaštPha£Ouše
 &&… !ğ
PaštPha£S–fOuše
 &&… !ğ
PaštPha£ChdOušes
)

2368  
toR’d”V›w
(
docum’t
()->
»nd””
())->
maxim®OušeSize
();

2371 
	gR’d”Objeù
::
ÿ»tMšOff£t
() const

2376 
	gR’d”Objeù
::
ÿ»tMaxOff£t
() const

2378 ià(
isR•Ïûd
())

2379  
node
(è? 
max
(1U,‚ode()->
chdNodeCouÁ
()) : 1;

2380 ià(
isHR
())

2385 
	gR’d”Objeù
::
ÿ»tMaxR’d”edOff£t
() const

2390 
	gR’d”Objeù
::
´eviousOff£t
(
cu¼’t
) const

2392  
cu¼’t
 - 1;

2395 
	gR’d”Objeù
::
´eviousOff£tFÜBackw¬dD–‘iÚ
(
cu¼’t
) const

2397  
cu¼’t
 - 1;

2400 
	gR’d”Objeù
::
ÃxtOff£t
(
cu¼’t
) const

2402  
cu¼’t
 + 1;

2405 
	gR’d”Objeù
::
adju¡ReùFÜOušeAndShadow
(
IÁReù
& 
»ù
) const

2407 
oušeSize
 = 
oušeStyËFÜR•ašt
()->outlineSize();

2408 ià(cÚ¡ 
ShadowD©a
* 
	gboxShadow
 = 
¡yË
()->
boxShadow
()) {

2409 
shadowLeá
 = 0;

2410 
	gshadowRight
 = 0;

2411 
	gshadowTİ
 = 0;

2412 
	gshadowBÙtom
 = 0;

2415 ià(
	gboxShadow
->
¡yË
(è=ğ
NÜm®
) {

2416 
shadowLeá
 = 
mš
(
boxShadow
->
x
(è- boxShadow->
blur
(è- boxShadow->
¥»ad
(è- 
oušeSize
, shadowLeft);

2417 
	gshadowRight
 = 
max
(
boxShadow
->
x
(è+ boxShadow->
blur
(è+ boxShadow->
¥»ad
(è+ 
oušeSize
, 
shadowRight
);

2418 
	gshadowTİ
 = 
mš
(
boxShadow
->
y
(è- boxShadow->
blur
(è- boxShadow->
¥»ad
(è- 
oušeSize
, 
shadowTİ
);

2419 
	gshadowBÙtom
 = 
max
(
boxShadow
->
y
(è+ boxShadow->
blur
(è+ boxShadow->
¥»ad
(è+ 
oušeSize
, 
shadowBÙtom
);

2422 
	gboxShadow
 = 
boxShadow
->
Ãxt
();

2423 } 
	gboxShadow
);

2425 
	g»ù
.
move
(
shadowLeá
, 
shadowTİ
);

2426 
	g»ù
.
£tWidth
(
»ù
.
width
(è- 
shadowLeá
 + 
shadowRight
);

2427 
	g»ù
.
£tHeight
(
»ù
.
height
(è- 
shadowTİ
 + 
shadowBÙtom
);

2429 
	g»ù
.
šæ©e
(
oušeSize
);

2432 
Anim©iÚCÚŒŞËr
* 
	gR’d”Objeù
::
ªim©iÚ
() const

2434  
docum’t
()->
äame
()->
ªim©iÚ
();

2437 
	gR’d”Objeù
::
imageChªged
(
CachedImage
* 
image
, cÚ¡ 
IÁReù
* 
»ù
)

2439 
imageChªged
(
¡©ic_ÿ¡
<
W¿µedImagePŒ
>(
image
), 
»ù
);

2442 
R’d”BoxMod–Objeù
* 
	gR’d”Objeù
::
off£tP¬’t
() const

2448 ià(
isRoÙ
(è|| 
isBody
(è|| (
isPos™iÚed
(è&& 
¡yË
()->
pos™iÚ
(è=ğ
FixedPos™iÚ
))

2462 
boŞ
 
	gskTabËs
 = 
isPos™iÚed
(è|| 
isR–Pos™iÚed
();

2463 
	gcu¼Zoom
 = 
¡yË
()->
efãùiveZoom
();

2464 
R’d”Objeù
* 
	gcu¼
 = 
·»Á
();

2465 
	gcu¼
 && (!cu¼->
node
() ||

2466 (!
	gcu¼
->
isPos™iÚed
(è&& !cu¼->
isR–Pos™iÚed
(è&& !cu¼->
isBody
()))) {

2467 
Node
* 
	g–em’t
 = 
cu¼
->
node
();

2468 ià(!
	gskTabËs
 && 
	g–em’t
) {

2469 
boŞ
 
	gisTabËEËm’t
 = 
–em’t
->
hasTagName
(
bËTag
) ||

2470 
–em’t
->
hasTagName
(
tdTag
) ||

2471 
–em’t
->
hasTagName
(
thTag
);

2473 #ià
ENABLE
(
WML
)

2474 ià(!
	gisTabËEËm’t
 && 
	g–em’t
->
isWMLEËm’t
())

2475 
	gisTabËEËm’t
 = 
–em’t
->
hasTagName
(
WMLNames
::
bËTag
) ||

2476 
–em’t
->
hasTagName
(
WMLNames
::
tdTag
);

2479 ià(
	gisTabËEËm’t
)

2483 
	gÃwZoom
 = 
cu¼
->
¡yË
()->
efãùiveZoom
();

2484 ià(
	gcu¼Zoom
 !ğ
ÃwZoom
)

2486 
	gcu¼Zoom
 = 
ÃwZoom
;

2487 
	gcu¼
 = 
cu¼
->
·»Á
();

2489  
	gcu¼
 && cu¼->
isBoxMod–Objeù
(è? 
toR’d”BoxMod–Objeù
(
cu¼
) : 0;

2492 
VisibËPos™iÚ
 
	gR’d”Objeù
::
ü—‹VisibËPos™iÚ
(
off£t
, 
EAffš™y
 
affš™y
)

2495 ià(
Node
* 
	gnode
 = 
this
->
node
()) {

2496 ià(!
node
->
isCÚ‹ÁEd™abË
()) {

2498 
Pos™iÚ
 
pos™iÚ
(
node
, 
off£t
);

2499 
Pos™iÚ
 
	gÿndid©e
 = 
pos™iÚ
.
down¡»am
(Pos™iÚ::
CªCrossEd™šgBound¬y
);

2500 ià(
	gÿndid©e
.
node
()->
isCÚ‹ÁEd™abË
())

2501  
VisibËPos™iÚ
(
ÿndid©e
, 
affš™y
);

2502 
	gÿndid©e
 = 
pos™iÚ
.
up¡»am
(
Pos™iÚ
::
CªCrossEd™šgBound¬y
);

2503 ià(
	gÿndid©e
.
node
()->
isCÚ‹ÁEd™abË
())

2504  
VisibËPos™iÚ
(
ÿndid©e
, 
affš™y
);

2506  
VisibËPos™iÚ
(
node
, 
off£t
, 
affš™y
);

2515 
R’d”Objeù
* 
	gchd
 = 
this
;

2516 
R’d”Objeù
* 
	g·»Á
 = 
chd
->
·»Á
()) {

2518 
R’d”Objeù
* 
»nd””
 = 
chd
;

2519 (
	g»nd””
 = 
»nd””
->
ÃxtInP»Ord”
(
·»Á
))) {

2520 ià(
Node
* 
node
 = 
»nd””
->node())

2521  
VisibËPos™iÚ
(
node
, 0, 
DOWNSTREAM
);

2525 
	g»nd””
 = 
chd
;

2526 (
	g»nd””
 = 
»nd””
->
´eviousInP»Ord”
())) {

2527 ià(
»nd””
 =ğ
·»Á
)

2529 ià(
Node
* 
	gnode
 = 
»nd””
->
node
())

2530  
VisibËPos™iÚ
(
Ï¡D“pEd™šgPos™iÚFÜNode
(
node
), 
DOWNSTREAM
);

2534 ià(
Node
* 
	gnode
 = 
·»Á
->
node
())

2535  
VisibËPos™iÚ
(
node
, 0, 
DOWNSTREAM
);

2538 
	gchd
 = 
·»Á
;

2542  
VisibËPos™iÚ
();

2545 
VisibËPos™iÚ
 
	gR’d”Objeù
::
ü—‹VisibËPos™iÚ
(cÚ¡ 
Pos™iÚ
& 
pos™iÚ
)

2547 ià(
pos™iÚ
.
isNÙNuÎ
())

2548  
VisibËPos™iÚ
(
pos™iÚ
);

2550 
ASSERT
(!
node
());

2551  
ü—‹VisibËPos™iÚ
(0, 
DOWNSTREAM
);

2554 #ià
ENABLE
(
SVG
)

2555 cÚ¡ 
SVGR’d”Ba£
* 
	gR’d”Objeù
::
toSVGR’d”Ba£
() const

2557 
ASSERT_NOT_REACHED
();

2561 
R’d”SVGResourû
* 
	gR’d”Objeù
::
toR’d”SVGResourû
()

2563 
ASSERT_NOT_REACHED
();

2567 
FlßtReù
 
	gR’d”Objeù
::
objeùBoundšgBox
() const

2569 
ASSERT_NOT_REACHED
();

2570  
FlßtReù
();

2575 
FlßtReù
 
	gR’d”Objeù
::
»·štReùInLoÿlCoÜdš©es
() const

2577 
ASSERT_NOT_REACHED
();

2578  
FlßtReù
();

2581 
AffšeT¿nsfÜm
 
	gR’d”Objeù
::
loÿlT¿nsfÜm
() const

2583 cÚ¡ 
AffšeT¿nsfÜm
 
id’t™y
;

2584  
	gid’t™y
;

2587 cÚ¡ 
	gAffšeT¿nsfÜm
& 
	gR’d”Objeù
::
loÿlToP¬’tT¿nsfÜm
() const

2589 cÚ¡ 
AffšeT¿nsfÜm
 
id’t™y
;

2590  
	gid’t™y
;

2593 
boŞ
 
	gR’d”Objeù
::
nodeAtFlßtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, cÚ¡ 
FlßtPošt
&, 
H™Te¡AùiÚ
)

2595 
ASSERT_NOT_REACHED
();

2596  
	gçl£
;

2603 #iâdeà
NDEBUG


2605 
showT»e
(cÚ¡ 
WebCÜe
::
R’d”Objeù
* 
ro
)

2607 ià(
ro
)

2608 
ro
->
showT»eFÜThis
();

2611 
showR’d”T»e
(cÚ¡ 
WebCÜe
::
R’d”Objeù
* 
objeù1
)

2613 
showR’d”T»e
(
objeù1
, 0);

2616 
showR’d”T»e
(cÚ¡ 
WebCÜe
::
R’d”Objeù
* 
objeù1
, cÚ¡ WebCÜe::R’d”Objeù* 
objeù2
)

2618 ià(
objeù1
) {

2619 cÚ¡ 
WebCÜe
::
R’d”Objeù
* 
roÙ
 = 
objeù1
;

2620 
	groÙ
->
·»Á
())

2621 
	groÙ
 = 
roÙ
->
·»Á
();

2622 
	groÙ
->
showR’d”T»eAndM¬k
(
objeù1
, "*", 
objeù2
, "-", 0);

	@RenderObject.h

26 #iâdeà
R’d”Objeù_h


27 
	#R’d”Objeù_h


	)

29 
	~"AffšeT¿nsfÜm.h
"

30 
	~"CachedResourûCl›Á.h
"

31 
	~"Docum’t.h
"

32 
	~"EËm’t.h
"

33 
	~"FlßtQuad.h
"

34 
	~"R’d”ObjeùChdLi¡.h
"

35 
	~"R’d”StyË.h
"

36 
	~"TextAffš™y.h
"

37 
	~"T¿nsfÜm©iÚM©rix.h
"

38 
	~<wtf/Unu£dP¬am.h
>

40 
Çme¥aû
 
	gWebCÜe
 {

42 
şass
 
	gAnim©iÚCÚŒŞËr
;

43 
şass
 
	gH™Te¡ResuÉ
;

44 
şass
 
	gIÆšeBox
;

45 
şass
 
	gIÆšeFlowBox
;

46 
şass
 
	gOv”ÏpTe¡Reque¡Cl›Á
;

47 
şass
 
	gPos™iÚ
;

48 
şass
 
	gR’d”BoxMod–Objeù
;

49 
şass
 
	gR’d”IÆše
;

50 
şass
 
	gR’d”Block
;

51 
şass
 
	gR’d”Flow
;

52 
şass
 
	gR’d”Lay”
;

53 
şass
 
	gR’d”Theme
;

54 
şass
 
	gT¿nsfÜmS‹
;

55 
şass
 
	gVisibËPos™iÚ
;

56 #ià
ENABLE
(
SVG
)

57 
şass
 
	gR’d”SVGResourû
;

58 
şass
 
	gSVGR’d”Ba£
;

70 
	ePaštPha£
 {

71 
	gPaštPha£BlockBackground
,

72 
	gPaštPha£ChdBlockBackground
,

73 
	gPaštPha£ChdBlockBackgrounds
,

74 
	gPaštPha£Flßt
,

75 
	gPaštPha£FÜeground
,

76 
	gPaštPha£Ouše
,

77 
	gPaštPha£ChdOušes
,

78 
	gPaštPha£S–fOuše
,

79 
	gPaštPha£S–eùiÚ
,

80 
	gPaštPha£CŞÏp£dTabËBÜd”s
,

81 
	gPaštPha£TextCl
,

82 
	gPaštPha£Mask


85 
	ePaštBehaviÜFÏgs
 {

86 
	gPaštBehaviÜNÜm®
 = 0,

87 
	gPaštBehaviÜS–eùiÚOÆy
 = 1 << 0,

88 
	gPaštBehaviÜFÜûBÏckText
 = 1 << 1,

89 
	gPaštBehaviÜFÏ‰’Compos™šgLay”s
 = 1 << 2

91 
	tPaštBehaviÜ
;

93 
	eH™Te¡F‹r
 {

94 
	gH™Te¡AÎ
,

95 
	gH™Te¡S–f
,

96 
	gH™Te¡Desûndªts


99 
	eH™Te¡AùiÚ
 {

100 
	gH™Te¡BlockBackground
,

101 
	gH™Te¡ChdBlockBackground
,

102 
	gH™Te¡ChdBlockBackgrounds
,

103 
	gH™Te¡Flßt
,

104 
	gH™Te¡FÜeground


109 
	eBoxSide
 {

110 
	gBSTİ
,

111 
	gBSBÙtom
,

112 
	gBSLeá
,

113 
	gBSRight


116 cÚ¡ 
	gÿ»tWidth
 = 1;

118 #ià
ENABLE
(
DASHBOARD_SUPPORT
)

119 
	sDashbßrdRegiÚV®ue
 {

120 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
DashbßrdRegiÚV®ue
& 
o
) const

122  
ty³
 =ğ
o
.ty³ && 
bounds
 =ğo.bound && 
ş
 =ğo.ş && 
Ïb–
 == o.label;

124 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
DashbßrdRegiÚV®ue
& 
o
) const

126  !(*
this
 =ğ
o
);

129 
SŒšg
 
	gÏb–
;

130 
IÁReù
 
	gbounds
;

131 
IÁReù
 
	gş
;

132 
	gty³
;

137 şas 
	cR’d”Objeù
 : 
public
 
CachedResourûCl›Á
 {

138 
ä›nd
 
şass
 
R’d”Block
;

139 
ä›nd
 
şass
 
	gR’d”Box
;

140 
ä›nd
 
şass
 
	gR’d”Lay”
;

141 
ä›nd
 
şass
 
	gR’d”ObjeùChdLi¡
;

142 
ä›nd
 
şass
 
	gR’d”SVGCÚš”
;

143 
	gpublic
:

146 
R’d”Objeù
(
Node
*);

147 
	gvœtu®
 ~
R’d”Objeù
();

149 
R’d”Theme
* 
theme
() const;

151 
vœtu®
 cÚ¡ * 
»nd”Name
() const = 0;

153 
R’d”Objeù
* 
·»Á
(ècÚ¡ {  
	gm_·»Á
; }

154 
boŞ
 
isDesûndªtOf
(cÚ¡ 
R’d”Objeù
*) const;

156 
R’d”Objeù
* 
´eviousSiblšg
(ècÚ¡ {  
	gm_´evious
; }

157 
R’d”Objeù
* 
ÃxtSiblšg
(ècÚ¡ {  
	gm_Ãxt
; }

159 
R’d”Objeù
* 
fœ¡Chd
() const

161 ià(cÚ¡ 
R’d”ObjeùChdLi¡
* 
	gchd»n
 = 
vœtu®Chd»n
())

162  
chd»n
->
fœ¡Chd
();

165 
R’d”Objeù
* 
Ï¡Chd
() const

167 ià(cÚ¡ 
R’d”ObjeùChdLi¡
* 
	gchd»n
 = 
vœtu®Chd»n
())

168  
chd»n
->
Ï¡Chd
();

171 
vœtu®
 
R’d”ObjeùChdLi¡
* 
vœtu®Chd»n
() {  0; }

172 
vœtu®
 cÚ¡ 
R’d”ObjeùChdLi¡
* 
vœtu®Chd»n
() const {  0; }

174 
R’d”Objeù
* 
ÃxtInP»Ord”
() const;

175 
R’d”Objeù
* 
ÃxtInP»Ord”
(R’d”Objeù* 
¡ayW™hš
) const;

176 
R’d”Objeù
* 
ÃxtInP»Ord”Aá”Chd»n
() const;

177 
R’d”Objeù
* 
ÃxtInP»Ord”Aá”Chd»n
(R’d”Objeù* 
¡ayW™hš
) const;

178 
R’d”Objeù
* 
´eviousInP»Ord”
() const;

179 
R’d”Objeù
* 
chdAt
() const;

181 
R’d”Objeù
* 
fœ¡L—fChd
() const;

182 
R’d”Objeù
* 
Ï¡L—fChd
() const;

187 
R’d”Lay”
* 
’şosšgLay”
() const;

188 
R’d”Lay”
* 
’şosšgS–fPaštšgLay”
() const;

189 
addLay”s
(
R’d”Lay”
* 
·»ÁLay”
, 
R’d”Objeù
* 
ÃwObjeù
);

190 
»moveLay”s
(
R’d”Lay”
* 
·»ÁLay”
);

191 
moveLay”s
(
R’d”Lay”
* 
ŞdP¬’t
, R’d”Lay”* 
ÃwP¬’t
);

192 
R’d”Lay”
* 
fšdNextLay”
(R’d”Lay”* 
·»ÁLay”
, 
R’d”Objeù
* 
¡¬tPošt
, 
boŞ
 
checkP¬’t
 = 
Œue
);

195 
R’d”Box
* 
’şosšgBox
() const;

197 
vœtu®
 
boŞ
 
isEm±y
(ècÚ¡ {  
fœ¡Chd
() == 0; }

199 #iâdeà
NDEBUG


200 
£tHasAXObjeù
(
boŞ
 
æag
è{ 
	gm_hasAXObjeù
 = flag; }

201 
boŞ
 
hasAXObjeù
(ècÚ¡ {  
	gm_hasAXObjeù
; }

202 
boŞ
 
isS‘N“dsLayoutFÜbidd’
(ècÚ¡ {  
	gm_£tN“dsLayoutFÜbidd’
; }

203 
£tN“dsLayoutIsFÜbidd’
(
boŞ
 
æag
è{ 
	gm_£tN“dsLayoutFÜbidd’
 = flag; }

208 
vœtu®
 
R’d”Block
* 
fœ¡LšeBlock
() const;

213 
hªdËDyÇmicFlßtPos™iÚChªge
();

217 
vœtu®
 
boŞ
 
ÿnHaveChd»n
(ècÚ¡ {  
vœtu®Chd»n
(); }

218 
vœtu®
 
boŞ
 
isChdAÎowed
(
R’d”Objeù
*, 
R’d”StyË
*ècÚ¡ {  
	gŒue
; }

219 
vœtu®
 
addChd
(
R’d”Objeù
* 
ÃwChd
, R’d”Objeù* 
befÜeChd
 = 0);

220 
vœtu®
 
addChdIgnÜšgCÚtšu©iÚ
(
R’d”Objeù
* 
ÃwChd
, R’d”Objeù* 
befÜeChd
 = 0è{  
addChd
(newChild, beforeChild); }

221 
vœtu®
 
»moveChd
(
R’d”Objeù
*);

222 
vœtu®
 
boŞ
 
ü—‹sAnÚymousW¿µ”
(ècÚ¡ {  
	gçl£
; }

225 
	g´Ùeùed
:

228 
£tP»viousSiblšg
(
R’d”Objeù
* 
´evious
è{ 
m_´evious
 =…revious; }

229 
£tNextSiblšg
(
R’d”Objeù
* 
Ãxt
è{ 
	gm_Ãxt
 =‚ext; }

230 
£tP¬’t
(
R’d”Objeù
* 
·»Á
è{ 
	gm_·»Á
 =…arent; }

232 
	g´iv©e
:

233 
addAbsŞu‹ReùFÜLay”
(
IÁReù
& 
»suÉ
);

234 
£tLay”N“dsFuÎR•ašt
();

236 
	gpublic
:

237 #iâdeà
NDEBUG


238 
showT»eFÜThis
() const;

240 
showR’d”Objeù
() const;

243 
showR’d”Objeù
(
´š‹dCh¬aù”s
) const;

244 
showR’d”T»eAndM¬k
(cÚ¡ 
R’d”Objeù
* 
m¬kedObjeù1
 = 0, cÚ¡ * 
m¬kedLab–1
 = 0, cÚ¡ R’d”Objeù* 
m¬kedObjeù2
 = 0, cÚ¡ * 
m¬kedLab–2
 = 0, 
d•th
 = 0) const;

247 
R’d”Objeù
* 
ü—‹Objeù
(
Node
*, 
R’d”StyË
*);

251 * 
İ”©Ü
 
Ãw
(
size_t
, 
R’d”A»Ç
*è
throw
();

254 
İ”©Ü
 
d–‘e
(*, 
size_t
);

256 
	g´iv©e
:

258 * 
İ”©Ü
 
Ãw
(
size_t
è
throw
();

260 
	gpublic
:

261 
R’d”A»Ç
* 
»nd”A»Ç
(ècÚ¡ {  
docum’t
()->renderArena(); }

263 
vœtu®
 
boŞ
 
isAµËt
(ècÚ¡ {  
	gçl£
; }

264 
vœtu®
 
boŞ
 
isBR
(ècÚ¡ {  
	gçl£
; }

265 
vœtu®
 
boŞ
 
isBlockFlow
(ècÚ¡ {  
	gçl£
; }

266 
vœtu®
 
boŞ
 
isBoxMod–Objeù
(ècÚ¡ {  
	gçl£
; }

267 
vœtu®
 
boŞ
 
isCouÁ”
(ècÚ¡ {  
	gçl£
; }

268 
vœtu®
 
boŞ
 
isEmbeddedObjeù
(ècÚ¡ {  
	gçl£
; }

269 
vœtu®
 
boŞ
 
isF›ld£t
(ècÚ¡ {  
	gçl£
; }

270 
vœtu®
 
boŞ
 
isFeU¶ßdCÚŒŞ
(ècÚ¡ {  
	gçl£
; }

271 
vœtu®
 
boŞ
 
isF¿me
(ècÚ¡ {  
	gçl£
; }

272 
vœtu®
 
boŞ
 
isF¿meS‘
(ècÚ¡ {  
	gçl£
; }

273 
vœtu®
 
boŞ
 
isImage
(ècÚ¡ {  
	gçl£
; }

274 
vœtu®
 
boŞ
 
isIÆšeBlockOrIÆšeTabË
(ècÚ¡ {  
	gçl£
; }

275 
vœtu®
 
boŞ
 
isLi¡Box
(ècÚ¡ {  
	gçl£
; }

276 
vœtu®
 
boŞ
 
isLi¡I‹m
(ècÚ¡ {  
	gçl£
; }

277 
vœtu®
 
boŞ
 
isLi¡M¬k”
(ècÚ¡ {  
	gçl£
; }

278 
vœtu®
 
boŞ
 
isMedŸ
(ècÚ¡ {  
	gçl£
; }

279 
vœtu®
 
boŞ
 
isM’uLi¡
(ècÚ¡ {  
	gçl£
; }

280 #ià
ENABLE
(
PROGRESS_TAG
)

281 
vœtu®
 
boŞ
 
isProg»ss
(ècÚ¡ {  
	gçl£
; }

283 
vœtu®
 
boŞ
 
isR’d”Block
(ècÚ¡ {  
	gçl£
; }

284 
vœtu®
 
boŞ
 
isR’d”Bu‰Ú
(ècÚ¡ {  
	gçl£
; }

285 
vœtu®
 
boŞ
 
isR’d”Image
(ècÚ¡ {  
	gçl£
; }

286 
vœtu®
 
boŞ
 
isR’d”IÆše
(ècÚ¡ {  
	gçl£
; }

287 
vœtu®
 
boŞ
 
isR’d”P¬t
(ècÚ¡ {  
	gçl£
; }

288 
vœtu®
 
boŞ
 
isR’d”V›w
(ècÚ¡ {  
	gçl£
; }

289 
vœtu®
 
boŞ
 
isR•liÿ
(ècÚ¡ {  
	gçl£
; }

290 #ià
ENABLE
(
RUBY
)

291 
vœtu®
 
boŞ
 
isRuby
(ècÚ¡ {  
	gçl£
; }

292 
vœtu®
 
boŞ
 
isRubyBa£
(ècÚ¡ {  
	gçl£
; }

293 
vœtu®
 
boŞ
 
isRubyRun
(ècÚ¡ {  
	gçl£
; }

294 
vœtu®
 
boŞ
 
isRubyText
(ècÚ¡ {  
	gçl£
; }

296 
vœtu®
 
boŞ
 
isSlid”
(ècÚ¡ {  
	gçl£
; }

297 
vœtu®
 
boŞ
 
isTabË
(ècÚ¡ {  
	gçl£
; }

298 
vœtu®
 
boŞ
 
isTabËC–l
(ècÚ¡ {  
	gçl£
; }

299 
vœtu®
 
boŞ
 
isTabËCŞ
(ècÚ¡ {  
	gçl£
; }

300 
vœtu®
 
boŞ
 
isTabËRow
(ècÚ¡ {  
	gçl£
; }

301 
vœtu®
 
boŞ
 
isTabËSeùiÚ
(ècÚ¡ {  
	gçl£
; }

302 
vœtu®
 
boŞ
 
isTextCÚŒŞ
(ècÚ¡ {  
	gçl£
; }

303 
vœtu®
 
boŞ
 
isTextA»a
(ècÚ¡ {  
	gçl£
; }

304 
vœtu®
 
boŞ
 
isTextF›ld
(ècÚ¡ {  
	gçl£
; }

305 
vœtu®
 
boŞ
 
isVideo
(ècÚ¡ {  
	gçl£
; }

306 
vœtu®
 
boŞ
 
isWidg‘
(ècÚ¡ {  
	gçl£
; }

307 
vœtu®
 
boŞ
 
isCªvas
(ècÚ¡ {  
	gçl£
; }

309 
boŞ
 
isRoÙ
(ècÚ¡ {  
docum’t
()->
docum’tEËm’t
(è=ğ
m_node
; }

310 
boŞ
 
isBody
() const;

311 
boŞ
 
isHR
() const;

313 
boŞ
 
isHTMLM¬qu“
() const;

315 
šlše
 
boŞ
 
isAá”CÚ‹Á
() const;

316 
šlše
 
boŞ
 
isAá”CÚ‹Á
(cÚ¡ 
R’d”Objeù
* 
obj
è{  
	gobj
 && obj->isAfterContent(); }

318 
boŞ
 
chd»nIÆše
(ècÚ¡ {  
	gm_chd»nIÆše
; }

319 
£tChd»nIÆše
(
boŞ
 
b
 = 
Œue
è{ 
m_chd»nIÆše
 = b; }

320 
boŞ
 
hasCŞumns
(ècÚ¡ {  
	gm_hasCŞumns
; }

321 
£tHasCŞumns
(
boŞ
 
b
 = 
Œue
è{ 
m_hasCŞumns
 = b; }

322 
boŞ
 
ûÎWidthChªged
(ècÚ¡ {  
	gm_ûÎWidthChªged
; }

323 
£tC–lWidthChªged
(
boŞ
 
b
 = 
Œue
è{ 
m_ûÎWidthChªged
 = b; }

325 #ià
ENABLE
(
MATHML
)

326 
vœtu®
 
boŞ
 
isR’d”M©hMLBlock
(ècÚ¡ {  
	gçl£
; }

329 #ià
ENABLE
(
SVG
)

332 
vœtu®
 
boŞ
 
isSVGRoÙ
(ècÚ¡ {  
	gçl£
; }

333 
vœtu®
 
boŞ
 
isSVGCÚš”
(ècÚ¡ {  
	gçl£
; }

334 
vœtu®
 
boŞ
 
isSVGHidd’CÚš”
(ècÚ¡ {  
	gçl£
; }

335 
vœtu®
 
boŞ
 
isR’d”P©h
(ècÚ¡ {  
	gçl£
; }

336 
vœtu®
 
boŞ
 
isSVGText
(ècÚ¡ {  
	gçl£
; }

337 
vœtu®
 
boŞ
 
isSVGImage
(ècÚ¡ {  
	gçl£
; }

338 
vœtu®
 
boŞ
 
isSVGFÜeignObjeù
(ècÚ¡ {  
	gçl£
; }

339 
vœtu®
 
boŞ
 
isSVGResourû
(ècÚ¡ {  
	gçl£
; }

341 
vœtu®
 cÚ¡ 
SVGR’d”Ba£
* 
toSVGR’d”Ba£
() const;

342 
vœtu®
 
R’d”SVGResourû
* 
toR’d”SVGResourû
();

347 
vœtu®
 
£tN“dsT¿nsfÜmUpd©e
() { }

348 
vœtu®
 
£tN“dsBound¬›sUpd©e
() { }

356 
vœtu®
 
FlßtReù
 
objeùBoundšgBox
() const;

360 
vœtu®
 
FlßtReù
 
»·štReùInLoÿlCoÜdš©es
() const;

364 
vœtu®
 
AffšeT¿nsfÜm
 
loÿlT¿nsfÜm
() const;

368 
vœtu®
 cÚ¡ 
	gAffšeT¿nsfÜm
& 
loÿlToP¬’tT¿nsfÜm
() const;

373 
vœtu®
 
boŞ
 
nodeAtFlßtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, cÚ¡ 
FlßtPošt
& 
poštInP¬’t
, 
H™Te¡AùiÚ
);

376 
boŞ
 
isAnÚymous
(ècÚ¡ {  
	gm_isAnÚymous
; }

377 
£tIsAnÚymous
(
boŞ
 
b
è{ 
	gm_isAnÚymous
 = b; }

378 
boŞ
 
isAnÚymousBlock
() const

380  
	gm_isAnÚymous
 && 
¡yË
()->
di¥Ïy
(è=ğ
BLOCK
 && styË()->
¡yËTy³
(è=ğ
NOPSEUDO
 && !
isLi¡M¬k”
();

382 
boŞ
 
isIÆšeCÚtšu©iÚ
(ècÚ¡ {  (
node
(è?‚ode()->
»nd””
(è!ğ
this
 : 
çl£
è&& 
isR’d”IÆše
(); }

383 
boŞ
 
isFlßtšg
(ècÚ¡ {  
	gm_æßtšg
; }

384 
boŞ
 
isPos™iÚed
(ècÚ¡ {  
	gm_pos™iÚed
; }

385 
boŞ
 
isR–Pos™iÚed
(ècÚ¡ {  
	gm_»lPos™iÚed
; }

386 
boŞ
 
isText
(ècÚ¡ {  
	gm_isText
; }

387 
boŞ
 
isBox
(ècÚ¡ {  
	gm_isBox
; }

388 
boŞ
 
isIÆše
(ècÚ¡ {  
	gm_šlše
; }

389 
boŞ
 
isRunIn
(ècÚ¡ {  
¡yË
()->
di¥Ïy
(è=ğ
RUN_IN
; }

390 
boŞ
 
isD¿ggšg
(ècÚ¡ {  
	gm_isD¿ggšg
; }

391 
boŞ
 
isR•Ïûd
(ècÚ¡ {  
	gm_»¶aûd
; }

393 
boŞ
 
hasLay”
(ècÚ¡ {  
	gm_hasLay”
; }

395 
boŞ
 
hasBoxDecÜ©iÚs
(ècÚ¡ {  
	gm_·štBackground
; }

396 
boŞ
 
mu¡R•aštBackgroundOrBÜd”
() const;

398 
boŞ
 
ÃedsLayout
(ècÚ¡ {  
	gm_ÃedsLayout
 || 
	gm_nÜm®ChdN“dsLayout
 || 
	gm_posChdN“dsLayout
 || 
	gm_ÃedsPos™iÚedMovem’tLayout
; }

399 
boŞ
 
£lfN“dsLayout
(ècÚ¡ {  
	gm_ÃedsLayout
; }

400 
boŞ
 
ÃedsPos™iÚedMovem’tLayout
(ècÚ¡ {  
	gm_ÃedsPos™iÚedMovem’tLayout
; }

401 
boŞ
 
ÃedsPos™iÚedMovem’tLayoutOÆy
(ècÚ¡ {  
	gm_ÃedsPos™iÚedMovem’tLayout
 && !
	gm_ÃedsLayout
 && !
	gm_nÜm®ChdN“dsLayout
 && !
	gm_posChdN“dsLayout
; }

402 
boŞ
 
posChdN“dsLayout
(ècÚ¡ {  
	gm_posChdN“dsLayout
; }

403 
boŞ
 
nÜm®ChdN“dsLayout
(ècÚ¡ {  
	gm_nÜm®ChdN“dsLayout
; }

405 
boŞ
 
´efWidthsDœty
(ècÚ¡ {  
	gm_´efWidthsDœty
; }

407 
boŞ
 
isS–eùiÚBÜd”
() const;

409 
boŞ
 
hasCl
(ècÚ¡ {  
isPos™iÚed
(è&& 
¡yË
()->hasClip(); }

410 
boŞ
 
hasOv”æowCl
(ècÚ¡ {  
	gm_hasOv”æowCl
; }

412 
boŞ
 
hasT¿nsfÜm
(ècÚ¡ {  
	gm_hasT¿nsfÜm
; }

413 
boŞ
 
hasMask
(ècÚ¡ {  
¡yË
() && style()->hasMask(); }

415 
d¿wLšeFÜBoxSide
(
G¿phicsCÚ‹xt
*, 
x1
, 
y1
, 
x2
, 
y2
, 
BoxSide
,

416 
CŞÜ
, 
EBÜd”StyË
, 
adjbw1
, 
adjbw2
);

417 
d¿wArcFÜBoxSide
(
G¿phicsCÚ‹xt
*, 
x
, 
y
, 
thickÃss
, 
IÁSize
 
¿dius
, 
ªgËS¹
,

418 
ªgËS·n
, 
BoxSide
, 
CŞÜ
, 
EBÜd”StyË
, 
boŞ
 
fœ¡CÜÃr
);

420 
	gpublic
:

423 
R’d”StyË
* 
g‘CachedP£udoStyË
(
P£udoId
, R’d”StyË* 
·»ÁStyË
 = 0) const;

424 
	gPassRefPŒ
<
	gR’d”StyË
> 
g‘UnÿchedP£udoStyË
(
P£udoId
, 
R’d”StyË
* 
·»ÁStyË
 = 0, R’d”StyË* 
ownStyË
 = 0) const;

426 
vœtu®
 
upd©eD¿gS‹
(
boŞ
 
d¿gOn
);

428 
R’d”V›w
* 
v›w
() const;

431 
boŞ
 
isRoÙed
(
R’d”V›w
** = 0);

433 
Node
* 
node
(ècÚ¡ {  
	gm_isAnÚymous
 ? 0 : 
m_node
; }

434 
Docum’t
* 
docum’t
(ècÚ¡ {  
	gm_node
->document(); }

435 
£tNode
(
Node
* 
node
è{ 
	gm_node
 =‚ode; }

437 
boŞ
 
hasOušeAÂÙ©iÚ
() const;

438 
boŞ
 
hasOuše
(ècÚ¡ {  
¡yË
()->hasOuše(è|| 
hasOušeAÂÙ©iÚ
(); }

443 
R’d”Objeù
* 
cÚš”
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
 = 0, 
boŞ
* 
»·štCÚš”Sk³d
 = 0) const;

445 
vœtu®
 
R’d”Objeù
* 
hov”Anû¡Ü
(ècÚ¡ {  
·»Á
(); }

448 
R’d”BoxMod–Objeù
* 
off£tP¬’t
() const;

450 
m¬kCÚššgBlocksFÜLayout
(
boŞ
 
scheduËR–ayout
 = 
Œue
, 
R’d”Objeù
* 
ÃwRoÙ
 = 0);

451 
£tN“dsLayout
(
boŞ
 
b
, boŞ 
m¬kP¬’ts
 = 
Œue
);

452 
£tChdN“dsLayout
(
boŞ
 
b
, boŞ 
m¬kP¬’ts
 = 
Œue
);

453 
£tN“dsPos™iÚedMovem’tLayout
();

454 
£tP»fWidthsDœty
(
boŞ
, boŞ 
m¬kP¬’ts
 = 
Œue
);

455 
šv®id©eCÚš”P»fWidths
();

457 
£tN“dsLayoutAndP»fWidthsReÿlc
()

459 
£tN“dsLayout
(
Œue
);

460 
£tP»fWidthsDœty
(
Œue
);

463 
£tPos™iÚed
(
boŞ
 
b
 = 
Œue
è{ 
m_pos™iÚed
 = b; }

464 
£tR–Pos™iÚed
(
boŞ
 
b
 = 
Œue
è{ 
m_»lPos™iÚed
 = b; }

465 
£tFlßtšg
(
boŞ
 
b
 = 
Œue
è{ 
m_æßtšg
 = b; }

466 
£tIÆše
(
boŞ
 
b
 = 
Œue
è{ 
m_šlše
 = b; }

467 
£tHasBoxDecÜ©iÚs
(
boŞ
 
b
 = 
Œue
è{ 
m_·štBackground
 = b; }

468 
£tIsText
(è{ 
	gm_isText
 = 
Œue
; }

469 
£tIsBox
(è{ 
	gm_isBox
 = 
Œue
; }

470 
£tR•Ïûd
(
boŞ
 
b
 = 
Œue
è{ 
m_»¶aûd
 = b; }

471 
£tHasOv”æowCl
(
boŞ
 
b
 = 
Œue
è{ 
m_hasOv”æowCl
 = b; }

472 
£tHasLay”
(
boŞ
 
b
 = 
Œue
è{ 
m_hasLay”
 = b; }

473 
£tHasT¿nsfÜm
(
boŞ
 
b
 = 
Œue
è{ 
m_hasT¿nsfÜm
 = b; }

474 
£tHasReæeùiÚ
(
boŞ
 
b
 = 
Œue
è{ 
m_hasReæeùiÚ
 = b; }

476 
scheduËR–ayout
();

478 
upd©eFlImages
(cÚ¡ 
FlLay”
*, const FillLayer*);

479 
upd©eImage
(
StyËImage
*, StyleImage*);

482 
vœtu®
 
lšeHeight
(
boŞ
 
fœ¡Lše
, boŞ 
isRoÙLšeBox
 = 
çl£
) const;

485 
vœtu®
 
ba£lšePos™iÚ
(
boŞ
 
fœ¡Lše
, boŞ 
isRoÙLšeBox
 = 
çl£
) const;

487 
	gHashM­
<
	tOv”ÏpTe¡Reque¡Cl›Á
*, 
	tIÁReù
> 
	tOv”ÏpTe¡Reque¡M­
;

493 
	sPaštInfo
 {

494 
PaštInfo
(
G¿phicsCÚ‹xt
* 
ÃwCÚ‹xt
, cÚ¡ 
IÁReù
& 
ÃwReù
, 
PaštPha£
 
ÃwPha£
, 
boŞ
 
ÃwFÜûBÏckText
,

495 
R’d”Objeù
* 
ÃwPaštšgRoÙ
, 
Li¡HashS‘
<
R’d”IÆše
*>* 
ÃwOušeObjeùs
,

496 
Ov”ÏpTe¡Reque¡M­
* 
ov”ÏpTe¡Reque¡s
 = 0)

497 : 
cÚ‹xt
(
ÃwCÚ‹xt
)

498 , 
»ù
(
ÃwReù
)

499 , 
pha£
(
ÃwPha£
)

500 , 
fÜûBÏckText
(
ÃwFÜûBÏckText
)

501 , 
·štšgRoÙ
(
ÃwPaštšgRoÙ
)

502 , 
oušeObjeùs
(
ÃwOušeObjeùs
)

503 , 
ov”ÏpTe¡Reque¡s
(overlapTestRequests)

507 
G¿phicsCÚ‹xt
* 
	gcÚ‹xt
;

508 
IÁReù
 
	g»ù
;

509 
PaštPha£
 
	gpha£
;

510 
boŞ
 
	gfÜûBÏckText
;

511 
R’d”Objeù
* 
	g·štšgRoÙ
;

512 
	gLi¡HashS‘
<
	gR’d”IÆše
*>* 
	goušeObjeùs
;

513 
Ov”ÏpTe¡Reque¡M­
* 
	gov”ÏpTe¡Reque¡s
;

516 
vœtu®
 
·št
(
PaštInfo
&, 
tx
, 
ty
);

519 
vœtu®
 
Ïyout
();

522 
ÏyoutIfN“ded
(è{ ià(
ÃedsLayout
()è
Ïyout
(); }

526 
vœtu®
 
upd©eFromEËm’t
() { }

528 #ià
ENABLE
(
DASHBOARD_SUPPORT
)

529 
vœtu®
 
addDashbßrdRegiÚs
(
VeùÜ
<
DashbßrdRegiÚV®ue
>&);

530 
cŞËùDashbßrdRegiÚs
(
VeùÜ
<
DashbßrdRegiÚV®ue
>&);

533 
boŞ
 
h™Te¡
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, cÚ¡ 
IÁPošt
&, 
tx
, 
ty
, 
H™Te¡F‹r
 = 
H™Te¡AÎ
);

534 
vœtu®
 
boŞ
 
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, 
x
, 
y
, 
tx
, 
ty
, 
H™Te¡AùiÚ
);

535 
vœtu®
 
upd©eH™Te¡ResuÉ
(
H™Te¡ResuÉ
&, cÚ¡ 
IÁPošt
&);

537 
VisibËPos™iÚ
 
pos™iÚFÜCoÜdš©es
(
x
, 
y
);

538 
vœtu®
 
VisibËPos™iÚ
 
pos™iÚFÜPošt
(cÚ¡ 
IÁPošt
&);

539 
VisibËPos™iÚ
 
ü—‹VisibËPos™iÚ
(
off£t
, 
EAffš™y
);

540 
VisibËPos™iÚ
 
ü—‹VisibËPos™iÚ
(cÚ¡ 
Pos™iÚ
&);

542 
vœtu®
 
dœtyLšesFromChªgedChd
(
R’d”Objeù
*);

547 
£tAnim©abËStyË
(
PassRefPŒ
<
R’d”StyË
>);

550 
vœtu®
 
£tStyË
(
PassRefPŒ
<
R’d”StyË
>);

554 
£tStyËIÁ”Çl
(
PassRefPŒ
<
R’d”StyË
>);

557 
R’d”Block
* 
cÚššgBlock
() const;

561 
FlßtPošt
 
loÿlToAbsŞu‹
(FlßtPošˆ
loÿlPošt
 = FlßtPošt(), 
boŞ
 
fixed
 = 
çl£
, boŞ 
u£T¿nsfÜms
 = false) const;

562 
FlßtPošt
 
absŞu‹ToLoÿl
(FlßtPošt, 
boŞ
 
fixed
 = 
çl£
, boŞ 
u£T¿nsfÜms
 = false) const;

564 
FlßtQuad
 
loÿlToAbsŞu‹Quad
(cÚ¡ FlßtQuad& 
quad
, 
boŞ
 
fixed
 = 
çl£
) const

566  
loÿlToCÚš”Quad
(
quad
, 0, 
fixed
);

569 
FlßtQuad
 
loÿlToCÚš”Quad
(cÚ¡ FlßtQuad&, 
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
boŞ
 
fixed
 = 
çl£
) const;

573 
vœtu®
 
IÁSize
 
off£tFromCÚš”
(
R’d”Objeù
*, cÚ¡ 
IÁPošt
&) const;

575 
IÁSize
 
off£tFromAnû¡ÜCÚš”
(
R’d”Objeù
*) const;

577 
vœtu®
 
absŞu‹Reùs
(
VeùÜ
<
IÁReù
>&, , ) { }

579 
IÁReù
 
absŞu‹BoundšgBoxReù
(
boŞ
 
u£T¿nsfÜms
 = 
çl£
);

582 
vœtu®
 
absŞu‹Quads
(
VeùÜ
<
FlßtQuad
>&) { }

584 
absŞu‹FocusRšgQuads
(
VeùÜ
<
FlßtQuad
>&);

587 
IÁReù
 
·štšgRoÙReù
(IÁReù& 
tİLev–Reù
);

589 
vœtu®
 
mšP»fWidth
() const {  0; }

590 
vœtu®
 
maxP»fWidth
() const {  0; }

592 
R’d”StyË
* 
¡yË
(ècÚ¡ {  
	gm_¡yË
.
g‘
(); }

593 
R’d”StyË
* 
fœ¡LšeStyË
(ècÚ¡ {  
docum’t
()->
u£sFœ¡LšeRuËs
(è? 
fœ¡LšeStyËSlowCa£
(è: 
¡yË
(); }

594 
R’d”StyË
* 
¡yË
(
boŞ
 
fœ¡Lše
ècÚ¡ {  
	gfœ¡Lše
 ? 
fœ¡LšeStyË
() : style(); }

598 
	gPassRefPŒ
<
	gR’d”StyË
> 
unÿchedFœ¡LšeStyË
(
R’d”StyË
*) const;

602 
vœtu®
 
R’d”StyË
* 
oušeStyËFÜR•ašt
(ècÚ¡ {  
¡yË
(); }

604 
g‘TextDecÜ©iÚCŞÜs
(
decÜ©iÚs
, 
CŞÜ
& 
und”lše
, CŞÜ& 
ov”lše
,

605 
CŞÜ
& 
lš‘hrough
, 
boŞ
 
quœksMode
 = 
çl£
);

610 
R’d”BoxMod–Objeù
* 
cÚš”FÜR•ašt
() const;

613 
»·štUsšgCÚš”
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, cÚ¡ 
IÁReù
& 
r
, 
boŞ
 
immedŸ‹
 = 
çl£
);

617 
»·št
(
boŞ
 
immedŸ‹
 = 
çl£
);

620 
»·štReùªgË
(cÚ¡ 
IÁReù
&, 
boŞ
 
immedŸ‹
 = 
çl£
);

623 
boŞ
 
»·štAá”LayoutIfN“ded
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, cÚ¡ 
IÁReù
& 
ŞdBounds
, cÚ¡ IÁReù& 
ŞdOušeBox
, cÚ¡ IÁReù* 
ÃwBoundsPŒ
 = 0, cÚ¡ IÁReù* 
ÃwOušeBoxPŒ
 = 0);

626 
vœtu®
 
»·štDuršgLayoutIfMoved
(cÚ¡ 
IÁReù
& 
»ù
);

629 
vœtu®
 
»·štOv”hªgšgFlßts
(
boŞ
 
·štAÎDesûndªts
 = 
çl£
);

631 
boŞ
 
checkFÜR•aštDuršgLayout
() const;

635 
IÁReù
 
absŞu‹Cl³dOv”æowReù
()

637  
ş³dOv”æowReùFÜR•ašt
(0);

639 
vœtu®
 
IÁReù
 
ş³dOv”æowReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
);

640 
vœtu®
 
IÁReù
 
»ùW™hOušeFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
oušeWidth
);

644 
compu‹AbsŞu‹R•aštReù
(
IÁReù
& 
r
, 
boŞ
 
fixed
 = 
çl£
)

646  
compu‹ReùFÜR•ašt
(0, 
r
, 
fixed
);

650 
vœtu®
 
compu‹ReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
IÁReù
&, 
boŞ
 
fixed
 = 
çl£
);

654 
vœtu®
 
adju¡FÜCŞumns
(
IÁSize
&, cÚ¡ 
IÁPošt
&) const { }

656 
vœtu®
 
Ëngth
() const {  1; }

658 
boŞ
 
isFlßtšgOrPos™iÚed
(ècÚ¡ {  (
isFlßtšg
(è|| 
isPos™iÚed
()); }

660 
boŞ
 
isT¿n¥¬’t
(ècÚ¡ {  
¡yË
()->
İac™y
() < 1.0f; }

661 
İac™y
(ècÚ¡ {  
¡yË
()->opacity(); }

663 
boŞ
 
hasReæeùiÚ
(ècÚ¡ {  
	gm_hasReæeùiÚ
; }

666 
maxim®OušeSize
(
PaštPha£
) const;

668 
£tHasM¬kupTrunÿtiÚ
(
boŞ
 
b
 = 
Œue
è{ 
m_hasM¬kupTrunÿtiÚ
 = b; }

669 
boŞ
 
hasM¬kupTrunÿtiÚ
(ècÚ¡ {  
	gm_hasM¬kupTrunÿtiÚ
; }

671 
	eS–eùiÚS‹
 {

672 
	gS–eùiÚNÚe
,

673 
	gS–eùiÚS¹
,

674 
	gS–eùiÚInside
,

675 
	gS–eùiÚEnd
,

676 
	gS–eùiÚBÙh


681 
S–eùiÚS‹
 
£ËùiÚS‹
(ècÚ¡ {  
	g¡©ic_ÿ¡
<
	gS–eùiÚS‹
>(
	gm_£ËùiÚS‹
);; }

684 
vœtu®
 
£tS–eùiÚS‹
(
S–eùiÚS‹
 
¡©e
è{ 
	gm_£ËùiÚS‹
 = state; }

688 
IÁReù
 
£ËùiÚReù
(
boŞ
 
şToVisibËCÚ‹Á
 = 
Œue
è{  
£ËùiÚReùFÜR•ašt
(0, clipToVisibleContent); }

689 
vœtu®
 
IÁReù
 
£ËùiÚReùFÜR•ašt
(
R’d”BoxMod–Objeù
* , 
boŞ
 = 
Œue
) {  IntRect(); }

692 
vœtu®
 
boŞ
 
ÿnBeS–eùiÚL—f
(ècÚ¡ {  
	gçl£
; }

695 
boŞ
 
hasS–eùedChd»n
(ècÚ¡ {  
	gm_£ËùiÚS‹
 !ğ
S–eùiÚNÚe
; }

698 
CŞÜ
 
£ËùiÚBackgroundCŞÜ
() const;

699 
CŞÜ
 
£ËùiÚFÜegroundCŞÜ
() const;

702 
vœtu®
 
boŞ
 
shouldPaštS–eùiÚG­s
(ècÚ¡ {  
	gçl£
; }

704 #ià
ENABLE
(
DRAG_SUPPORT
)

705 
Node
* 
d¿ggabËNode
(
boŞ
 
dhtmlOK
, boŞ 
uaOK
, 
x
, 
y
, boŞ& 
dhtmlWlD¿g
) const;

714 
vœtu®
 
IÁReù
 
loÿlC¬‘Reù
(
IÆšeBox
*, 
ÿ»tOff£t
, * 
exŒaWidthToEndOfLše
 = 0);

716 
vœtu®
 
ÿlcV”tiÿlM¬gšs
() { }

717 
boŞ
 
isTİM¬gšQuœk
(ècÚ¡ {  
	gm_tİM¬gšQuœk
; }

718 
boŞ
 
isBÙtomM¬gšQuœk
(ècÚ¡ {  
	gm_bÙtomM¬gšQuœk
; }

719 
£tTİM¬gšQuœk
(
boŞ
 
b
 = 
Œue
è{ 
m_tİM¬gšQuœk
 = b; }

720 
£tBÙtomM¬gšQuœk
(
boŞ
 
b
 = 
Œue
è{ 
m_bÙtomM¬gšQuœk
 = b; }

724 
boŞ
 
docum’tBešgDe¡royed
() const;

726 
vœtu®
 
de¡roy
();

729 
vœtu®
 
boŞ
 
isFËxibËBox
(ècÚ¡ {  
	gçl£
; }

730 
vœtu®
 
boŞ
 
isFËxšgChd»n
(ècÚ¡ {  
	gçl£
; }

731 
vœtu®
 
boŞ
 
isSŒ‘chšgChd»n
(ècÚ¡ {  
	gçl£
; }

733 
vœtu®
 
ÿ»tMšOff£t
() const;

734 
vœtu®
 
ÿ»tMaxOff£t
() const;

735 
vœtu®
 
ÿ»tMaxR’d”edOff£t
() const;

737 
vœtu®
 
´eviousOff£t
(
cu¼’t
) const;

738 
vœtu®
 
´eviousOff£tFÜBackw¬dD–‘iÚ
(
cu¼’t
) const;

739 
vœtu®
 
ÃxtOff£t
(
cu¼’t
) const;

741 
vœtu®
 
imageChªged
(
CachedImage
*, cÚ¡ 
IÁReù
* = 0);

742 
vœtu®
 
imageChªged
(
W¿µedImagePŒ
, cÚ¡ 
IÁReù
* = 0) { }

743 
vœtu®
 
boŞ
 
wlR’d”Image
(
CachedImage
*);

745 
£ËùiÚS¹End
(& 
¥os
, & 
•os
) const;

747 
R’d”Objeù
* 
·štšgRoÙFÜChd»n
(
PaštInfo
& 
·štInfo
) const

750  (!
	g·štInfo
.
	g·štšgRoÙ
 ||…aštInfo.·štšgRoÙ =ğ
this
è? 0 : 
·štInfo
.
·štšgRoÙ
;

753 
boŞ
 
shouldPaštW™hšRoÙ
(
PaštInfo
& 
·štInfo
) const

755  !
	g·štInfo
.
	g·štšgRoÙ
 ||…aštInfo.·štšgRoÙ =ğ
this
;

758 
boŞ
 
hasOv”rideSize
(ècÚ¡ {  
	gm_hasOv”rideSize
; }

759 
£tHasOv”rideSize
(
boŞ
 
b
è{ 
	gm_hasOv”rideSize
 = b; }

761 
»move
(è{ ià(
·»Á
()è·»Á()->
»moveChd
(
this
); }

763 
Anim©iÚCÚŒŞËr
* 
ªim©iÚ
() const;

765 
boŞ
 
visibËToH™Te¡šg
(ècÚ¡ {  
¡yË
()->
visib™y
(è=ğ
VISIBLE
 && styË()->
poš‹rEv’ts
(è!ğ
PE_NONE
; }

769 
vœtu®
 
m­LoÿlToCÚš”
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
boŞ
 
u£T¿nsfÜms
, boŞ 
fixed
, 
T¿nsfÜmS‹
&) const;

770 
vœtu®
 
m­AbsŞu‹ToLoÿlPošt
(
boŞ
 
fixed
, boŞ 
u£T¿nsfÜms
, 
T¿nsfÜmS‹
&) const;

772 
boŞ
 
shouldU£T¿nsfÜmFromCÚš”
(cÚ¡ 
R’d”Objeù
* 
cÚš”
) const;

773 
g‘T¿nsfÜmFromCÚš”
(cÚ¡ 
R’d”Objeù
* 
cÚš”
, cÚ¡ 
IÁSize
& 
off£tInCÚš”
, 
T¿nsfÜm©iÚM©rix
&) const;

775 
vœtu®
 
addFocusRšgReùs
(
VeùÜ
<
IÁReù
>&, , ) { };

777 
IÁReù
 
absŞu‹OušeBounds
() const

779  
oušeBoundsFÜR•ašt
(0);

782 
	g´Ùeùed
:

784 
vœtu®
 
¡yËWlChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
* 
ÃwStyË
);

786 
vœtu®
 
¡yËDidChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
);

788 
·štOuše
(
G¿phicsCÚ‹xt
*, 
tx
, 
ty
, 
w
, 
h
);

789 
addPDFURLReù
(
G¿phicsCÚ‹xt
*, cÚ¡ 
IÁReù
&);

791 
vœtu®
 
IÁReù
 
v›wReù
() const;

793 
adju¡ReùFÜOušeAndShadow
(
IÁReù
&) const;

795 
¬’aD–‘e
(
R’d”A»Ç
*, * 
objeùBa£
);

797 
vœtu®
 
IÁReù
 
oušeBoundsFÜR•ašt
(
R’d”BoxMod–Objeù
* , 
IÁPošt
* = 0) const {  IntRect(); }

799 şas 
	cLayoutR•aš‹r
 {

800 
	gpublic
:

801 
LayoutR•aš‹r
(
R’d”Objeù
& 
objeù
, 
boŞ
 
checkFÜR•ašt
, cÚ¡ 
IÁReù
* 
ŞdBounds
 = 0)

802 : 
m_objeù
(
objeù
)

803 , 
m_»·štCÚš”
(0)

804 , 
m_checkFÜR•ašt
(
checkFÜR•ašt
)

806 ià(
	gm_checkFÜR•ašt
) {

807 
	gm_»·štCÚš”
 = 
m_objeù
.
cÚš”FÜR•ašt
();

808 
	gm_ŞdBounds
 = 
ŞdBounds
 ? *ŞdBound : 
m_objeù
.
ş³dOv”æowReùFÜR•ašt
(
m_»·štCÚš”
);

809 
	gm_ŞdOušeBox
 = 
m_objeù
.
oušeBoundsFÜR•ašt
(
m_»·štCÚš”
);

814 
boŞ
 
»·štAá”Layout
()

816  
	gm_checkFÜR•ašt
 ? 
	gm_objeù
.
»·štAá”LayoutIfN“ded
(
m_»·štCÚš”
, 
m_ŞdBounds
, 
m_ŞdOušeBox
è: 
çl£
;

819 
boŞ
 
checkFÜR•ašt
(ècÚ¡ {  
	gm_checkFÜR•ašt
; }

821 
	g´iv©e
:

822 
R’d”Objeù
& 
m_objeù
;

823 
R’d”BoxMod–Objeù
* 
	gm_»·štCÚš”
;

824 
IÁReù
 
	gm_ŞdBounds
;

825 
IÁReù
 
	gm_ŞdOušeBox
;

826 
boŞ
 
	gm_checkFÜR•ašt
;

829 
	g´iv©e
:

830 
R’d”StyË
* 
fœ¡LšeStyËSlowCa£
() const;

831 
StyËDifã»nû
 
adju¡StyËDifã»nû
(StyËDifã»nû, 
cÚ‹xtS’s™ivePrİ”t›s
) const;

833 
	gRefPŒ
<
	gR’d”StyË
> 
	gm_¡yË
;

835 
Node
* 
	gm_node
;

837 
R’d”Objeù
* 
	gm_·»Á
;

838 
R’d”Objeù
* 
	gm_´evious
;

839 
R’d”Objeù
* 
	gm_Ãxt
;

841 #iâdeà
NDEBUG


842 
boŞ
 
	gm_hasAXObjeù
;

843 
boŞ
 
	gm_£tN“dsLayoutFÜbidd’
 : 1;

847 
boŞ
 
	gm_ÃedsLayout
 : 1;

848 
boŞ
 
	gm_ÃedsPos™iÚedMovem’tLayout
 :1;

849 
boŞ
 
	gm_nÜm®ChdN“dsLayout
 : 1;

850 
boŞ
 
	gm_posChdN“dsLayout
 : 1;

851 
boŞ
 
	gm_´efWidthsDœty
 : 1;

852 
boŞ
 
	gm_æßtšg
 : 1;

854 
boŞ
 
	gm_pos™iÚed
 : 1;

855 
boŞ
 
	gm_»lPos™iÚed
 : 1;

856 
boŞ
 
	gm_·štBackground
 : 1;

859 
boŞ
 
	gm_isAnÚymous
 : 1;

860 
boŞ
 
	gm_isText
 : 1;

861 
boŞ
 
	gm_isBox
 : 1;

862 
boŞ
 
	gm_šlše
 : 1;

863 
boŞ
 
	gm_»¶aûd
 : 1;

864 
boŞ
 
	gm_isD¿ggšg
 : 1;

866 
boŞ
 
	gm_hasLay”
 : 1;

867 
boŞ
 
	gm_hasOv”æowCl
 : 1;

868 
boŞ
 
	gm_hasT¿nsfÜm
 : 1;

869 
boŞ
 
	gm_hasReæeùiÚ
 : 1;

871 
boŞ
 
	gm_hasOv”rideSize
 : 1;

873 
	gpublic
:

874 
boŞ
 
m_hasCouÁ”NodeM­
 : 1;

875 
boŞ
 
	gm_ev”HadLayout
 : 1;

877 
	g´iv©e
:

880 
boŞ
 
m_chd»nIÆše
 : 1;

881 
boŞ
 
	gm_tİM¬gšQuœk
 : 1;

882 
boŞ
 
	gm_bÙtomM¬gšQuœk
 : 1;

883 
boŞ
 
	gm_hasM¬kupTrunÿtiÚ
 : 1;

884 
	gm_£ËùiÚS‹
 : 3;

885 
boŞ
 
	gm_hasCŞumns
 : 1;

888 
boŞ
 
	gm_ûÎWidthChªged
 : 1;

890 
	g´iv©e
:

892 
boŞ
 
s_afãùsP¬’tBlock
;

895 
šlše
 
boŞ
 
	gR’d”Objeù
::
	$docum’tBešgDe¡royed
() const

897  !
	`docum’t
()->
	`»nd””
();

898 
	}
}

900 
šlše
 
boŞ
 
	gR’d”Objeù
::
	$isAá”CÚ‹Á
() const

902 ià(
	`¡yË
()->
	`¡yËTy³
(è!ğ
AFTER
)

903  
çl£
;

905 ià(
	`isText
(è&& !
	`isBR
())

906  
çl£
;

907  
Œue
;

908 
	}
}

910 
šlše
 
	gR’d”Objeù
::
	$£tN“dsLayout
(
boŞ
 
b
, boŞ 
m¬kP¬’ts
)

912 
boŞ
 
®»adyN“dedLayout
 = 
m_ÃedsLayout
;

913 
m_ÃedsLayout
 = 
b
;

914 ià(
b
) {

915 
	`ASSERT
(!
	`isS‘N“dsLayoutFÜbidd’
());

916 ià(!
®»adyN“dedLayout
) {

917 ià(
m¬kP¬’ts
)

918 
	`m¬kCÚššgBlocksFÜLayout
();

919 ià(
	`hasLay”
())

920 
	`£tLay”N“dsFuÎR•ašt
();

923 
m_ev”HadLayout
 = 
Œue
;

924 
m_posChdN“dsLayout
 = 
çl£
;

925 
m_nÜm®ChdN“dsLayout
 = 
çl£
;

926 
m_ÃedsPos™iÚedMovem’tLayout
 = 
çl£
;

928 
	}
}

930 
šlše
 
	gR’d”Objeù
::
	$£tChdN“dsLayout
(
boŞ
 
b
, boŞ 
m¬kP¬’ts
)

932 
boŞ
 
®»adyN“dedLayout
 = 
m_nÜm®ChdN“dsLayout
;

933 
m_nÜm®ChdN“dsLayout
 = 
b
;

934 ià(
b
) {

935 
	`ASSERT
(!
	`isS‘N“dsLayoutFÜbidd’
());

936 ià(!
®»adyN“dedLayout
 && 
m¬kP¬’ts
)

937 
	`m¬kCÚššgBlocksFÜLayout
();

939 
m_posChdN“dsLayout
 = 
çl£
;

940 
m_nÜm®ChdN“dsLayout
 = 
çl£
;

941 
m_ÃedsPos™iÚedMovem’tLayout
 = 
çl£
;

943 
	}
}

945 
šlše
 
	gR’d”Objeù
::
	$£tN“dsPos™iÚedMovem’tLayout
()

947 
boŞ
 
®»adyN“dedLayout
 = 
	`ÃedsLayout
();

948 
m_ÃedsPos™iÚedMovem’tLayout
 = 
Œue
;

949 ià(!
®»adyN“dedLayout
) {

950 
	`m¬kCÚššgBlocksFÜLayout
();

951 ià(
	`hasLay”
())

952 
	`£tLay”N“dsFuÎR•ašt
();

954 
	}
}

956 
šlše
 
boŞ
 
	$objeùIsR–ayoutBound¬y
(cÚ¡ 
R’d”Objeù
 *
obj
)

961  
obj
->
	`isTextCÚŒŞ
()

962 || (
obj
->
	`hasOv”æowCl
(è&& !obj->
	`¡yË
()->
	`width
().
	`isIÁršsicOrAuto
(è&& !obj->¡yË()->
	`height
().isIÁršsicOrAuto(è&& !obj->¡yË()->height().
	`isP”ûÁ
(è&& !obj->
	`isTabËC–l
())

963 #ià
	`ENABLE
(
SVG
)

964 || 
obj
->
	`isSVGRoÙ
()

967 
	}
}

969 
šlše
 
	gR’d”Objeù
::
	$m¬kCÚššgBlocksFÜLayout
(
boŞ
 
scheduËR–ayout
, 
R’d”Objeù
* 
ÃwRoÙ
)

971 
	`ASSERT
(!
scheduËR–ayout
 || !
ÃwRoÙ
);

973 
R’d”Objeù
* 
o
 = 
	`cÚš”
();

974 
R’d”Objeù
* 
Ï¡
 = 
this
;

976 
o
) {

979 
R’d”Objeù
* 
cÚš”
 = 
o
->
	`cÚš”
();

980 ià(!
cÚš”
 && !
o
->
	`isR’d”V›w
())

982 ià(!
Ï¡
->
	`isText
(è&& (Ï¡->
	`¡yË
()->
	`pos™iÚ
(è=ğ
FixedPos™iÚ
 ||†a¡->¡yË()->pos™iÚ(è=ğ
AbsŞu‹Pos™iÚ
)) {

983 ià((
Ï¡
->
	`¡yË
()->
	`tİ
().
	`isAuto
(è&&†a¡->¡yË()->
	`bÙtom
().isAuto()è||†a¡->¡yË()->tİ().
	`isStic
()) {

984 
R’d”Objeù
* 
·»Á
 = 
Ï¡
->
	`·»Á
();

985 ià(!
·»Á
->
	`nÜm®ChdN“dsLayout
()) {

986 
·»Á
->
	`£tChdN“dsLayout
(
Œue
, 
çl£
);

987 ià(
·»Á
 !ğ
ÃwRoÙ
)

988 
·»Á
->
	`m¬kCÚššgBlocksFÜLayout
(
scheduËR–ayout
, 
ÃwRoÙ
);

991 ià(
o
->
m_posChdN“dsLayout
)

993 
o
->
m_posChdN“dsLayout
 = 
Œue
;

994 
	`ASSERT
(!
o
->
	`isS‘N“dsLayoutFÜbidd’
());

996 ià(
o
->
m_nÜm®ChdN“dsLayout
)

998 
o
->
m_nÜm®ChdN“dsLayout
 = 
Œue
;

999 
	`ASSERT
(!
o
->
	`isS‘N“dsLayoutFÜbidd’
());

1002 ià(
o
 =ğ
ÃwRoÙ
)

1005 
Ï¡
 = 
o
;

1006 ià(
scheduËR–ayout
 && 
	`objeùIsR–ayoutBound¬y
(
Ï¡
))

1008 
o
 = 
cÚš”
;

1011 ià(
scheduËR–ayout
)

1012 
Ï¡
->
	`scheduËR–ayout
();

1013 
	}
}

1015 
šlše
 
	$makeM©rixR’d”abË
(
T¿nsfÜm©iÚM©rix
& 
m©rix
, 
boŞ
 
has3DR’d”šg
)

1017 #ià!
	`ENABLE
(3D
_RENDERING
)

1018 
	`UNUSED_PARAM
(
has3DR’d”šg
);

1019 
m©rix
.
	`makeAffše
();

1021 ià(!
has3DR’d”šg
)

1022 
m©rix
.
	`makeAffše
();

1024 
	}
}

1026 
šlše
 
	$adju¡FÜAbsŞu‹Zoom
(
v®ue
, 
R’d”Objeù
* 
»nd””
)

1028 
zoomFaùÜ
 = 
»nd””
->
	`¡yË
()->
	`efãùiveZoom
();

1029 ià(
zoomFaùÜ
 == 1)

1030  
v®ue
;

1032 ià(
zoomFaùÜ
 > 1)

1033 
v®ue
++;

1034  
¡©ic_ÿ¡
<>(
v®ue
 / 
zoomFaùÜ
);

1035 
	}
}

1037 
šlše
 
	$adju¡IÁReùFÜAbsŞu‹Zoom
(
IÁReù
& 
»ù
, 
R’d”Objeù
* 
»nd””
)

1039 
»ù
.
	`£tX
(
	`adju¡FÜAbsŞu‹Zoom
Ôeù.
	`x
(), 
»nd””
));

1040 
»ù
.
	`£tY
(
	`adju¡FÜAbsŞu‹Zoom
Ôeù.
	`y
(), 
»nd””
));

1041 
»ù
.
	`£tWidth
(
	`adju¡FÜAbsŞu‹Zoom
Ôeù.
	`width
(), 
»nd””
));

1042 
»ù
.
	`£tHeight
(
	`adju¡FÜAbsŞu‹Zoom
Ôeù.
	`height
(), 
»nd””
));

1043 
	}
}

1045 
šlše
 
FlßtPošt
 
	$adju¡FlßtPoštFÜAbsŞu‹Zoom
(cÚ¡ 
FlßtPošt
& 
pošt
, 
R’d”Objeù
* 
»nd””
)

1048 
zoomFaùÜ
 = 
»nd””
->
	`¡yË
()->
	`efãùiveZoom
();

1049 ià(
zoomFaùÜ
 == 1)

1050  
pošt
;

1051  
	`FlßtPošt
(
pošt
.
	`x
(è/ 
zoomFaùÜ
,…ošt.
	`y
() / zoomFactor);

1052 
	}
}

1054 
šlše
 
	$adju¡FlßtQuadFÜAbsŞu‹Zoom
(
FlßtQuad
& 
quad
, 
R’d”Objeù
* 
»nd””
)

1056 
quad
.
	`£tP1
(
	`adju¡FlßtPoštFÜAbsŞu‹Zoom
(quad.
	`p1
(), 
»nd””
));

1057 
quad
.
	`£tP2
(
	`adju¡FlßtPoštFÜAbsŞu‹Zoom
(quad.
	`p2
(), 
»nd””
));

1058 
quad
.
	`£tP3
(
	`adju¡FlßtPoštFÜAbsŞu‹Zoom
(quad.
	`p3
(), 
»nd””
));

1059 
quad
.
	`£tP4
(
	`adju¡FlßtPoštFÜAbsŞu‹Zoom
(quad.
	`p4
(), 
»nd””
));

1060 
	}
}

1064 #iâdeà
NDEBUG


1066 
showT»e
(cÚ¡ 
WebCÜe
::
R’d”Objeù
*);

1067 
showR’d”T»e
(cÚ¡ 
WebCÜe
::
R’d”Objeù
* 
objeù1
);

1070 
showR’d”T»e
(cÚ¡ 
WebCÜe
::
R’d”Objeù
* 
objeù1
, cÚ¡ WebCÜe::R’d”Objeù* 
objeù2
);

	@RenderObjectChildList.cpp

26 
	~"cÚfig.h
"

27 
	~"R’d”ObjeùChdLi¡.h
"

29 
	~"AXObjeùCache.h
"

30 
	~"R’d”Block.h
"

31 
	~"R’d”CouÁ”.h
"

32 
	~"R’d”ImageG’”©edCÚ‹Á.h
"

33 
	~"R’d”IÆše.h
"

34 
	~"R’d”Lay”.h
"

35 
	~"R’d”Li¡I‹m.h
"

36 
	~"R’d”StyË.h
"

37 
	~"R’d”TextF¿gm’t.h
"

38 
	~"R’d”V›w.h
"

40 
Çme¥aû
 
	gWebCÜe
 {

42 
upd©eLi¡M¬k”Numb”s
(
R’d”Objeù
* 
chd
)

44 
R’d”Objeù
* 
	gsiblšg
 = 
chd
; siblšg; siblšg = 
siblšg
->
ÃxtSiblšg
()) {

45 ià(
siblšg
->
isLi¡I‹m
())

46 
toR’d”Li¡I‹m
(
siblšg
)->
upd©eV®ue
();

50 
	gR’d”ObjeùChdLi¡
::
de¡royLeáov”Chd»n
()

52 
fœ¡Chd
()) {

53 ià(
fœ¡Chd
()->
isLi¡M¬k”
(è|| (fœ¡Chd()->
¡yË
()->
¡yËTy³
(è=ğ
FIRST_LETTER
 && !fœ¡Chd()->
isText
()))

54 
fœ¡Chd
()->
»move
();

57 ià(
fœ¡Chd
()->
node
())

58 
fœ¡Chd
()->
node
()->
£tR’d””
(0);

59 
fœ¡Chd
()->
de¡roy
();

64 
R’d”Objeù
* 
	gR’d”ObjeùChdLi¡
::
»moveChdNode
(R’d”Objeù* 
owÃr
, R’d”Objeù* 
ŞdChd
, 
boŞ
 
fuÎRemove
)

66 
ASSERT
(
ŞdChd
->
·»Á
(è=ğ
owÃr
);

71 ià(!
	gowÃr
->
docum’tBešgDe¡royed
(è&& 
	gfuÎRemove
 && 
	gŞdChd
->
	gm_ev”HadLayout
) {

72 
	gŞdChd
->
£tN“dsLayoutAndP»fWidthsReÿlc
();

73 
	gŞdChd
->
»·št
();

77 ià(
	gŞdChd
->
isBox
())

78 
toR’d”Box
(
ŞdChd
)->
d–‘eLšeBoxW¿µ”
();

80 ià(!
	gowÃr
->
docum’tBešgDe¡royed
(è&& 
	gfuÎRemove
) {

82 
R’d”Lay”
* 
	gÏy”
 = 0;

83 ià(
	gowÃr
->
¡yË
()->
visib™y
(è!ğ
VISIBLE
 && 
ŞdChd
->¡yË()->visib™y(è=ğVISIBLE && !ŞdChd->
hasLay”
()) {

84 
Ïy”
 = 
owÃr
->
’şosšgLay”
();

85 
	gÏy”
->
dœtyVisibËCÚ‹ÁStus
();

89 ià(
	gŞdChd
->
fœ¡Chd
(è|| oldChd->
hasLay”
()) {

90 ià(!
	gÏy”
)

91 
	gÏy”
 = 
owÃr
->
’şosšgLay”
();

92 
	gŞdChd
->
»moveLay”s
(
Ïy”
);

96 ià(
	gŞdChd
->
isLi¡I‹m
())

97 
upd©eLi¡M¬k”Numb”s
(
ŞdChd
->
ÃxtSiblšg
());

99 ià(
	gŞdChd
->
isPos™iÚed
(è&& 
	gowÃr
->
chd»nIÆše
())

100 
	gowÃr
->
dœtyLšesFromChªgedChd
(
ŞdChd
);

107 ià(!
	gowÃr
->
docum’tBešgDe¡royed
(è&& 
	gŞdChd
->
isS–eùiÚBÜd”
())

108 
	gowÃr
->
v›w
()->
ş—rS–eùiÚ
();

111 ià(
	gŞdChd
->
´eviousSiblšg
())

112 
	gŞdChd
->
´eviousSiblšg
()->
£tNextSiblšg
(
ŞdChd
->
ÃxtSiblšg
());

113 ià(
	gŞdChd
->
ÃxtSiblšg
())

114 
	gŞdChd
->
ÃxtSiblšg
()->
£tP»viousSiblšg
(
ŞdChd
->
´eviousSiblšg
());

116 ià(
fœ¡Chd
(è=ğ
ŞdChd
)

117 
£tFœ¡Chd
(
ŞdChd
->
ÃxtSiblšg
());

118 ià(
Ï¡Chd
(è=ğ
ŞdChd
)

119 
£tLa¡Chd
(
ŞdChd
->
´eviousSiblšg
());

121 
	gŞdChd
->
£tP»viousSiblšg
(0);

122 
	gŞdChd
->
£tNextSiblšg
(0);

123 
	gŞdChd
->
£tP¬’t
(0);

125 ià(
	gAXObjeùCache
::
acûssib™yEÇbËd
())

126 
owÃr
->
docum’t
()->
axObjeùCache
()->
chd»nChªged
(owner);

128  
	gŞdChd
;

131 
	gR’d”ObjeùChdLi¡
::
­³ndChdNode
(
R’d”Objeù
* 
owÃr
, R’d”Objeù* 
ÃwChd
, 
boŞ
 
fuÎAµ’d
)

133 
ASSERT
(
ÃwChd
->
·»Á
() == 0);

134 
ASSERT
(!
owÃr
->
isBlockFlow
(è|| (!
ÃwChd
->
isTabËSeùiÚ
(è&& !ÃwChd->
isTabËRow
(è&& !ÃwChd->
isTabËC–l
()));

136 
	gÃwChd
->
£tP¬’t
(
owÃr
);

137 
R’d”Objeù
* 
	glChd
 = 
Ï¡Chd
();

139 ià(
	glChd
) {

140 
	gÃwChd
->
£tP»viousSiblšg
(
lChd
);

141 
	glChd
->
£tNextSiblšg
(
ÃwChd
);

143 
£tFœ¡Chd
(
ÃwChd
);

145 
£tLa¡Chd
(
ÃwChd
);

147 ià(
	gfuÎAµ’d
) {

150 
R’d”Lay”
* 
	gÏy”
 = 0;

151 ià(
	gÃwChd
->
fœ¡Chd
(è||‚ewChd->
hasLay”
()) {

152 
	gÏy”
 = 
owÃr
->
’şosšgLay”
();

153 
	gÃwChd
->
addLay”s
(
Ïy”
, 
ÃwChd
);

158 ià(
	gowÃr
->
¡yË
()->
visib™y
(è!ğ
VISIBLE
 && 
ÃwChd
->¡yË()->visib™y(è=ğVISIBLE && !ÃwChd->
hasLay”
()) {

159 ià(!
Ïy”
)

160 
Ïy”
 = 
owÃr
->
’şosšgLay”
();

161 ià(
	gÏy”
)

162 
	gÏy”
->
£tHasVisibËCÚ‹Á
(
Œue
);

165 ià(!
	gÃwChd
->
isFlßtšgOrPos™iÚed
(è&& 
	gowÃr
->
chd»nIÆše
())

166 
	gowÃr
->
dœtyLšesFromChªgedChd
(
ÃwChd
);

169 
	gÃwChd
->
£tN“dsLayoutAndP»fWidthsReÿlc
();

170 ià(!
	gowÃr
->
nÜm®ChdN“dsLayout
())

171 
	gowÃr
->
£tChdN“dsLayout
(
Œue
);

173 ià(
	gAXObjeùCache
::
acûssib™yEÇbËd
())

174 
owÃr
->
docum’t
()->
axObjeùCache
()->
chd»nChªged
(owner);

177 
	gR’d”ObjeùChdLi¡
::
š£¹ChdNode
(
R’d”Objeù
* 
owÃr
, R’d”Objeù* 
chd
, R’d”Objeù* 
befÜeChd
, 
boŞ
 
fuÎIn£¹
)

179 ià(!
	gbefÜeChd
) {

180 
­³ndChdNode
(
owÃr
, 
chd
);

184 
ASSERT
(!
chd
->
·»Á
());

185 
	gbefÜeChd
->
·»Á
(è!ğ
owÃr
 && 
befÜeChd
->·»Á()->
isAnÚymousBlock
())

186 
befÜeChd
 = befÜeChd->
·»Á
();

187 
ASSERT
(
befÜeChd
->
·»Á
(è=ğ
owÃr
);

189 
ASSERT
(!
owÃr
->
isBlockFlow
(è|| (!
chd
->
isTabËSeùiÚ
(è&& !chd->
isTabËRow
(è&& !chd->
isTabËC–l
()));

191 ià(
	gbefÜeChd
 =ğ
fœ¡Chd
())

192 
£tFœ¡Chd
(
chd
);

194 
R’d”Objeù
* 
	g´ev
 = 
befÜeChd
->
´eviousSiblšg
();

195 
	gchd
->
£tNextSiblšg
(
befÜeChd
);

196 
	gbefÜeChd
->
£tP»viousSiblšg
(
chd
);

197 ià(
	g´ev
)

198 
	g´ev
->
£tNextSiblšg
(
chd
);

199 
	gchd
->
£tP»viousSiblšg
(
´ev
);

201 
	gchd
->
£tP¬’t
(
owÃr
);

203 ià(
	gfuÎIn£¹
) {

206 
R’d”Lay”
* 
	gÏy”
 = 0;

207 ià(
	gchd
->
fœ¡Chd
(è|| chd->
hasLay”
()) {

208 
	gÏy”
 = 
owÃr
->
’şosšgLay”
();

209 
	gchd
->
addLay”s
(
Ïy”
, 
chd
);

214 ià(
	gowÃr
->
¡yË
()->
visib™y
(è!ğ
VISIBLE
 && 
chd
->¡yË()->visib™y(è=ğVISIBLE && !chd->
hasLay”
()) {

215 ià(!
Ïy”
)

216 
Ïy”
 = 
owÃr
->
’şosšgLay”
();

217 ià(
	gÏy”
)

218 
	gÏy”
->
£tHasVisibËCÚ‹Á
(
Œue
);

222 ià(!
	gchd
->
isFlßtšg
(è&& 
	gowÃr
->
chd»nIÆše
())

223 
	gowÃr
->
dœtyLšesFromChªgedChd
(
chd
);

226 
	gchd
->
£tN“dsLayoutAndP»fWidthsReÿlc
();

227 ià(!
	gowÃr
->
nÜm®ChdN“dsLayout
())

228 
	gowÃr
->
£tChdN“dsLayout
(
Œue
);

230 ià(
	gAXObjeùCache
::
acûssib™yEÇbËd
())

231 
owÃr
->
docum’t
()->
axObjeùCache
()->
chd»nChªged
(owner);

234 
R’d”Objeù
* 
befÜeAá”CÚš”
(R’d”Objeù* 
cÚš”
, 
P£udoId
 
ty³
)

236 ià(
	gty³
 =ğ
BEFORE
) {

241 
R’d”Objeù
* 
fœ¡
 = 
cÚš”
;

244 
	gfœ¡
 = 
fœ¡
->
fœ¡Chd
();

245 
	gfœ¡
 && (fœ¡->
isLi¡M¬k”
(è|| (fœ¡->
isR’d”IÆše
(è&& fœ¡->
isRunIn
(è&& fœ¡->
isAnÚymous
())))

246 
	gfœ¡
 = 
fœ¡
->
ÃxtSiblšg
();

247 } 
	gfœ¡
 && fœ¡->
isAnÚymous
(è&& fœ¡->
¡yË
()->
¡yËTy³
(è=ğ
NOPSEUDO
);

249 ià(!
	gfœ¡
)

252 ià(
	gfœ¡
->
¡yË
()->
¡yËTy³
(è=ğ
ty³
)

253  
fœ¡
;

257 
	gfœ¡
 = 
cÚš”
->
fœ¡Chd
();

258 ià(!
	gfœ¡
->
isR’d”Block
())

260 
	gfœ¡
 && fœ¡->
isFlßtšgOrPos™iÚed
())

261 
	gfœ¡
 = 
fœ¡
->
ÃxtSiblšg
();

262 ià(
	gfœ¡
) {

263 
	gfœ¡
 = 
fœ¡
->
fœ¡Chd
();

265 
	gfœ¡
 && fœ¡->
isLi¡M¬k”
())

266 
	gfœ¡
 = 
fœ¡
->
ÃxtSiblšg
();

267 ià(
	gfœ¡
 && fœ¡->
¡yË
()->
¡yËTy³
(è=ğ
ty³
 && 
fœ¡
->
isR’d”IÆše
(è&& fœ¡->
isRunIn
(è&& fœ¡->
isAnÚymous
())

268  
fœ¡
;

273 ià(
	gty³
 =ğ
AFTER
) {

274 
R’d”Objeù
* 
Ï¡
 = 
cÚš”
;

276 
	gÏ¡
 = 
Ï¡
->
Ï¡Chd
();

277 } 
	gÏ¡
 &&†a¡->
isAnÚymous
(è&&†a¡->
¡yË
()->
¡yËTy³
(è=ğ
NOPSEUDO
 && !
Ï¡
->
isLi¡M¬k”
());

278 ià(
	gÏ¡
 &&†a¡->
¡yË
()->
¡yËTy³
(è!ğ
ty³
)

280  
	gÏ¡
;

283 
ASSERT_NOT_REACHED
();

287 
R’d”Objeù
* 
fšdBefÜeAá”P¬’t
(R’d”Objeù* 
objeù
)

290 ià(!(
	gobjeù
->
isTabË
(è|| objeù->
isTabËSeùiÚ
(è|| objeù->
isTabËRow
()))

291  
	gobjeù
;

293 
R’d”Objeù
* 
	gbefÜeAá”P¬’t
 = 
objeù
;

294 
	gbefÜeAá”P¬’t
 && !(befÜeAá”P¬’t->
isText
(è|| befÜeAá”P¬’t->
isImage
()))

295 
	gbefÜeAá”P¬’t
 = 
befÜeAá”P¬’t
->
fœ¡Chd
();

296  
	gbefÜeAá”P¬’t
;

299 
šv®id©eCouÁ”sInCÚš”
(
R’d”Objeù
* 
cÚš”
, cÚ¡ 
AtomicSŒšg
& 
id’tif›r
)

301 ià(!
	gcÚš”
)

303 
	gcÚš”
 = 
fšdBefÜeAá”P¬’t
(
cÚš”
);

304 ià(!
	gcÚš”
)

307 ià(
	gcÚš”
->
isCouÁ”
()) {

308 
toR’d”CouÁ”
(
cÚš”
)->
šv®id©e
(
id’tif›r
);

311 
R’d”Objeù
* 
	gcÚ‹Á
 = 
cÚš”
->
fœ¡Chd
(); cÚ‹Á; cÚ‹Á = 
cÚ‹Á
->
ÃxtSiblšg
()) {

312 ià(
cÚ‹Á
->
isCouÁ”
())

313 
toR’d”CouÁ”
(
cÚ‹Á
)->
šv®id©e
(
id’tif›r
);

317 
	gR’d”ObjeùChdLi¡
::
šv®id©eCouÁ”s
(
R’d”Objeù
* 
owÃr
, cÚ¡ 
AtomicSŒšg
& 
id’tif›r
)

319 
ASSERT
(!
owÃr
->
docum’tBešgDe¡royed
());

320 
šv®id©eCouÁ”sInCÚš”
(
befÜeAá”CÚš”
(
owÃr
, 
BEFORE
), 
id’tif›r
);

321 
šv®id©eCouÁ”sInCÚš”
(
befÜeAá”CÚš”
(
owÃr
, 
AFTER
), 
id’tif›r
);

324 
	gR’d”ObjeùChdLi¡
::
upd©eBefÜeAá”CÚ‹Á
(
R’d”Objeù
* 
owÃr
, 
P£udoId
 
ty³
, R’d”Objeù* 
¡yËdObjeù
)

327 
ASSERT
(
owÃr
->
docum’t
()->
u£sBefÜeAá”RuËs
());

330 ià(
	gowÃr
->
¡yË
()->
¡yËTy³
(è=ğ
BEFORE
 || 
owÃr
->¡yË()->¡yËTy³(è=ğ
AFTER
)

333 ià(!
	g¡yËdObjeù
)

334 
	g¡yËdObjeù
 = 
owÃr
;

336 
R’d”StyË
* 
	gp£udoEËm’tStyË
 = 
¡yËdObjeù
->
g‘CachedP£udoStyË
(
ty³
);

337 
R’d”Objeù
* 
	gchd
 = 
befÜeAá”CÚš”
(
owÃr
, 
ty³
);

340 
boŞ
 
	gŞdCÚ‹ÁP»£Á
 = 
chd
;

343 
boŞ
 
	gÃwCÚ‹ÁWª‹d
 = 
p£udoEËm’tStyË
 &&…£udoEËm’tStyË->
di¥Ïy
(è!ğ
NONE
;

347 ià(
	gÃwCÚ‹ÁWª‹d
 && 
	gty³
 =ğ
BEFORE
 && 
owÃr
->
isR’d”IÆše
(è&& 
toR’d”IÆše
(owÃr)->
isIÆšeCÚtšu©iÚ
())

348 
ÃwCÚ‹ÁWª‹d
 = 
çl£
;

352 ià(
	gÃwCÚ‹ÁWª‹d
 && 
	gty³
 =ğ
AFTER
 && 
owÃr
->
isR’d”IÆše
(è&& 
toR’d”IÆše
(owÃr)->
cÚtšu©iÚ
())

353 
ÃwCÚ‹ÁWª‹d
 = 
çl£
;

358 ià(
	gŞdCÚ‹ÁP»£Á
 && (!
	gÃwCÚ‹ÁWª‹d
 || 
	gNode
::
diff
(
chd
->
¡yË
(), 
p£udoEËm’tStyË
è=ğ
Node
::
D‘ach
)) {

360 ià(
chd
->
¡yË
()->
¡yËTy³
(è=ğ
ty³
) {

361 
ŞdCÚ‹ÁP»£Á
 = 
çl£
;

362 
	gchd
->
de¡roy
();

363 
	gchd
 = (
ty³
 =ğ
BEFORE
è? 
owÃr
->
vœtu®Chd»n
()->
fœ¡Chd
(è: owÃr->vœtu®Chd»n()->
Ï¡Chd
();

369 ià(!
	gÃwCÚ‹ÁWª‹d
)

372 ià(
	gowÃr
->
isR’d”IÆše
(è&& !
	gp£udoEËm’tStyË
->
isDi¥ÏyIÆšeTy³
(è&&…£udoEËm’tStyË->
æßtšg
(è=ğ
FNONE
 &&

373 !(
p£udoEËm’tStyË
->
pos™iÚ
(è=ğ
AbsŞu‹Pos™iÚ
 ||…£udoEËm’tStyË->pos™iÚ(è=ğ
FixedPos™iÚ
))

379 
p£udoEËm’tStyË
->
£tDi¥Ïy
(
INLINE
);

381 ià(
	gŞdCÚ‹ÁP»£Á
) {

382 ià(
	gchd
 && chd->
¡yË
()->
¡yËTy³
(è=ğ
ty³
) {

385 
chd
->
£tStyË
(
p£udoEËm’tStyË
);

387 
R’d”Objeù
* 
	gbefÜeAá”P¬’t
 = 
fšdBefÜeAá”P¬’t
(
chd
);

388 ià(!
	gbefÜeAá”P¬’t
)

393 
R’d”Objeù
* 
	gg’Chd
 = 
befÜeAá”P¬’t
->
fœ¡Chd
(); g’Chd; g’Chd = 
g’Chd
->
ÃxtSiblšg
()) {

394 ià(
g’Chd
->
isText
())

396 
g’Chd
->
£tStyË
(
p£udoEËm’tStyË
);

397 ià(
	gg’Chd
->
isImage
()) {

399 
	gRefPŒ
<
	gR’d”StyË
> 
	g¡yË
 = 
R’d”StyË
::
ü—‹
();

400 
	g¡yË
->
šh”™From
(
p£udoEËm’tStyË
);

401 
	gg’Chd
->
£tStyË
(
¡yË
.
»Ëa£
());

405 
ASSERT
(
g’Chd
->
isLi¡M¬k”
(è|| g’Chd->
¡yË
()->
¡yËTy³
(è=ğ
FIRST_LETTER
);

412 
R’d”Objeù
* 
	gš£¹BefÜe
 = (
ty³
 =ğ
BEFORE
è? 
owÃr
->
vœtu®Chd»n
()->
fœ¡Chd
() : 0;

416 
R’d”Objeù
* 
	gg’”©edCÚ‹ÁCÚš”
 = 0;

419 cÚ¡ 
CÚ‹ÁD©a
* 
	gcÚ‹Á
 = 
p£udoEËm’tStyË
->
cÚ‹ÁD©a
(); cÚ‹Á; cÚ‹Á = 
cÚ‹Á
->
Ãxt
()) {

420 
R’d”Objeù
* 
»nd””
 = 0;

421 
	gcÚ‹Á
->
ty³
()) {

422 
	gCONTENT_NONE
:

424 
	gCONTENT_TEXT
:

425 
»nd””
 = 
Ãw
 (
owÃr
->
»nd”A»Ç
()è
R’d”TextF¿gm’t
(owÃr->
docum’t
(è , 
cÚ‹Á
->
‹xt
());

426 
	g»nd””
->
£tStyË
(
p£udoEËm’tStyË
);

428 
	gCONTENT_OBJECT
: {

429 
R’d”ImageG’”©edCÚ‹Á
* 
image
 = 
Ãw
 (
owÃr
->
»nd”A»Ç
()èR’d”ImageG’”©edCÚ‹Á(owÃr->
docum’t
());

430 
	gRefPŒ
<
	gR’d”StyË
> 
	g¡yË
 = 
R’d”StyË
::
ü—‹
();

431 
	g¡yË
->
šh”™From
(
p£udoEËm’tStyË
);

432 
	gimage
->
£tStyË
(
¡yË
.
»Ëa£
());

433 ià(
StyËImage
* 
	g¡yËImage
 = 
cÚ‹Á
->
image
())

434 
image
->
£tStyËImage
(
¡yËImage
);

435 
	g»nd””
 = 
image
;

438 
	gCONTENT_COUNTER
:

439 
»nd””
 = 
Ãw
 (
owÃr
->
»nd”A»Ç
()è
R’d”CouÁ”
(owÃr->
docum’t
(), *
cÚ‹Á
->
couÁ”
());

440 
	g»nd””
->
£tStyË
(
p£udoEËm’tStyË
);

444 ià(
	g»nd””
) {

445 ià(!
	gg’”©edCÚ‹ÁCÚš”
) {

448 
	gg’”©edCÚ‹ÁCÚš”
 = 
R’d”Objeù
::
ü—‹Objeù
(
owÃr
->
docum’t
(), 
p£udoEËm’tStyË
);

449 
	gg’”©edCÚ‹ÁCÚš”
->
£tStyË
(
p£udoEËm’tStyË
);

450 
	gowÃr
->
addChd
(
g’”©edCÚ‹ÁCÚš”
, 
š£¹BefÜe
);

452 
	gg’”©edCÚ‹ÁCÚš”
->
addChd
(
»nd””
);

	@RenderObjectChildList.h

26 #iâdeà
R’d”ObjeùChdLi¡_h


27 
	#R’d”ObjeùChdLi¡_h


	)

29 
	~"R’d”StyËCÚ¡ªts.h
"

31 
Çme¥aû
 
	gWebCÜe
 {

33 
şass
 
	gAtomicSŒšg
;

34 
şass
 
	gR’d”Objeù
;

36 şas 
	cR’d”ObjeùChdLi¡
 {

37 
	gpublic
:

38 
R’d”ObjeùChdLi¡
()

39 : 
m_fœ¡Chd
(0)

40 , 
m_Ï¡Chd
(0)

44 
R’d”Objeù
* 
fœ¡Chd
(ècÚ¡ {  
	gm_fœ¡Chd
; }

45 
R’d”Objeù
* 
Ï¡Chd
(ècÚ¡ {  
	gm_Ï¡Chd
; }

49 
£tFœ¡Chd
(
R’d”Objeù
* 
chd
è{ 
	gm_fœ¡Chd
 = child; }

50 
£tLa¡Chd
(
R’d”Objeù
* 
chd
è{ 
	gm_Ï¡Chd
 = child; }

52 
de¡royLeáov”Chd»n
();

54 
R’d”Objeù
* 
»moveChdNode
(R’d”Objeù* 
owÃr
, R’d”Objeù*, 
boŞ
 
fuÎRemove
 = 
Œue
);

55 
­³ndChdNode
(
R’d”Objeù
* 
owÃr
, R’d”Objeù*, 
boŞ
 
fuÎAµ’d
 = 
Œue
);

56 
š£¹ChdNode
(
R’d”Objeù
* 
owÃr
, R’d”Objeù* 
chd
, R’d”Objeù* 
befÜe
, 
boŞ
 
fuÎIn£¹
 = 
Œue
);

58 
upd©eBefÜeAá”CÚ‹Á
(
R’d”Objeù
* 
owÃr
, 
P£udoId
 
ty³
, R’d”Objeù* 
¡yËdObjeù
 = 0);

59 
šv®id©eCouÁ”s
(
R’d”Objeù
* 
owÃr
, cÚ¡ 
AtomicSŒšg
& 
id’tif›r
);

61 
	g´iv©e
:

62 
R’d”Objeù
* 
m_fœ¡Chd
;

63 
R’d”Objeù
* 
	gm_Ï¡Chd
;

	@RenderOverflow.h

21 #iâdeà
R’d”Ov”æow_h


22 
	#R’d”Ov”æow_h


	)

24 
	~"IÁReù.h
"

25 
	~"¡dio.h
"

27 
	#PRINT_OVERFLOW


	)

29 
Çme¥aû
 
	gWebCÜe


50 şas 
	cR’d”Ov”æow
 : 
public
 
NÚcİyabË
 {

51 
public
:

52 
R’d”Ov”æow
(cÚ¡ 
IÁReù
& 
deçuÉReù
 = IntRect())

53 : 
m_tİLayoutOv”æow
(
deçuÉReù
.
y
())

54 , 
m_bÙtomLayoutOv”æow
(
deçuÉReù
.
bÙtom
())

55 , 
m_ËáLayoutOv”æow
(
deçuÉReù
.
x
())

56 , 
m_rightLayoutOv”æow
(
deçuÉReù
.
right
())

57 , 
m_tİVisu®Ov”æow
(
deçuÉReù
.
y
())

58 , 
m_bÙtomVisu®Ov”æow
(
deçuÉReù
.
bÙtom
())

59 , 
m_ËáVisu®Ov”æow
(
deçuÉReù
.
x
())

60 , 
m_rightVisu®Ov”æow
(
deçuÉReù
.
right
())

62 #ifdeà
PRINT_OVERFLOW


63 
´štf
("new overflow:");

64 
´štf
("tİ:%d bÙtom:%d†eá:%d„ight:%d\n",
deçuÉReù
.
y
(),deçuÉReù.
bÙtom
()

65 ,
deçuÉReù
.
x
(),deçuÉReù.
right
());

69 
tİLayoutOv”æow
(ècÚ¡ {  
	gm_tİLayoutOv”æow
; }

70 
bÙtomLayoutOv”æow
(ècÚ¡ {  
	gm_bÙtomLayoutOv”æow
; }

71 
ËáLayoutOv”æow
(ècÚ¡ {  
	gm_ËáLayoutOv”æow
; }

72 
rightLayoutOv”æow
(ècÚ¡ {  
	gm_rightLayoutOv”æow
; }

73 
IÁReù
 
ÏyoutOv”æowReù
() const;

75 
tİVisu®Ov”æow
(ècÚ¡ {  
	gm_tİVisu®Ov”æow
; }

76 
bÙtomVisu®Ov”æow
(ècÚ¡ {  
	gm_bÙtomVisu®Ov”æow
; }

77 
ËáVisu®Ov”æow
(ècÚ¡ {  
	gm_ËáVisu®Ov”æow
; }

78 
rightVisu®Ov”æow
(ècÚ¡ {  
	gm_rightVisu®Ov”æow
; }

79 
IÁReù
 
visu®Ov”æowReù
() const;

81 
IÁReù
 
visibËOv”æowReù
() const;

83 
£tTİLayoutOv”æow
(
ov”æow
è{ 
	gm_tİLayoutOv”æow
 = overflow; }

84 
£tBÙtomLayoutOv”æow
(
ov”æow
è{ 
	gm_bÙtomLayoutOv”æow
 = overflow; }

85 
£tLeáLayoutOv”æow
(
ov”æow
è{ 
	gm_ËáLayoutOv”æow
 = overflow; }

86 
£tRightLayoutOv”æow
(
ov”æow
è{ 
	gm_rightLayoutOv”æow
 = overflow; }

88 
£tTİVisu®Ov”æow
(
ov”æow
è{ 
	gm_tİVisu®Ov”æow
 = overflow; }

89 
£tBÙtomVisu®Ov”æow
(
ov”æow
è{ 
	gm_bÙtomVisu®Ov”æow
 = overflow; }

90 
£tLeáVisu®Ov”æow
(
ov”æow
è{ 
	gm_ËáVisu®Ov”æow
 = overflow; }

91 
£tRightVisu®Ov”æow
(
ov”æow
è{ 
	gm_rightVisu®Ov”æow
 = overflow; }

93 
move
(
dx
, 
dy
);

95 
addLayoutOv”æow
(cÚ¡ 
IÁReù
&);

96 
addVisu®Ov”æow
(cÚ¡ 
IÁReù
&);

98 
»£tLayoutOv”æow
(cÚ¡ 
IÁReù
& 
deçuÉReù
);

100 
	g´iv©e
:

101 
m_tİLayoutOv”æow
;

102 
	gm_bÙtomLayoutOv”æow
;

103 
	gm_ËáLayoutOv”æow
;

104 
	gm_rightLayoutOv”æow
;

106 
	gm_tİVisu®Ov”æow
;

107 
	gm_bÙtomVisu®Ov”æow
;

108 
	gm_ËáVisu®Ov”æow
;

109 
	gm_rightVisu®Ov”æow
;

112 
šlše
 
IÁReù
 
	gR’d”Ov”æow
::
	$ÏyoutOv”æowReù
() const

114  
	`IÁReù
(
m_ËáLayoutOv”æow
, 
m_tİLayoutOv”æow
, 
m_rightLayoutOv”æow
 - m_ËáLayoutOv”æow, 
m_bÙtomLayoutOv”æow
 - m_topLayoutOverflow);

115 
	}
}

117 
šlše
 
IÁReù
 
	gR’d”Ov”æow
::
	$visu®Ov”æowReù
() const

119  
	`IÁReù
(
m_ËáVisu®Ov”æow
, 
m_tİVisu®Ov”æow
, 
m_rightVisu®Ov”æow
 - m_ËáVisu®Ov”æow, 
m_bÙtomVisu®Ov”æow
 - m_topVisualOverflow);

120 
	}
}

122 
šlše
 
IÁReù
 
	gR’d”Ov”æow
::
	$visibËOv”æowReù
() const

124 
IÁReù
 
	`combšedReù
(
	`ÏyoutOv”æowReù
());

125 
combšedReù
.
	`un™e
(
	`visu®Ov”æowReù
());

126  
combšedReù
;

127 
	}
}

129 
šlše
 
	gR’d”Ov”æow
::
	$move
(
dx
, 
dy
)

131 
m_tİLayoutOv”æow
 +ğ
dy
;

132 
m_bÙtomLayoutOv”æow
 +ğ
dy
;

133 
m_ËáLayoutOv”æow
 +ğ
dx
;

134 
m_rightLayoutOv”æow
 +ğ
dx
;

136 
m_tİVisu®Ov”æow
 +ğ
dy
;

137 
m_bÙtomVisu®Ov”æow
 +ğ
dy
;

138 
m_ËáVisu®Ov”æow
 +ğ
dx
;

139 
m_rightVisu®Ov”æow
 +ğ
dx
;

140 
	}
}

142 
šlše
 
	gR’d”Ov”æow
::
	$addLayoutOv”æow
(cÚ¡ 
IÁReù
& 
»ù
)

144 #ifdeà
PRINT_OVERFLOW


145 
	`´štf
("add†ayout overflow:„ect x:%d y:%d width:%d height:%d\n",

146 
»ù
.
	`x
(),»ù.
	`y
(),»ù.
	`width
(),»ù.
	`height
());

147 
	`´štf
("Ügš®İ:%d bÙtom:%d†eá:%d„ight:%d\n",
m_tİLayoutOv”æow
,

148 
m_bÙtomLayoutOv”æow
,
m_ËáLayoutOv”æow
,
m_rightLayoutOv”æow
);

151 
m_tİLayoutOv”æow
 = 
¡d
::
	`mš
(
»ù
.
	`y
(), m_topLayoutOverflow);

152 
m_bÙtomLayoutOv”æow
 = 
¡d
::
	`max
(
»ù
.
	`bÙtom
(), m_bottomLayoutOverflow);

153 
m_ËáLayoutOv”æow
 = 
¡d
::
	`mš
(
»ù
.
	`x
(), m_leftLayoutOverflow);

154 
m_rightLayoutOv”æow
 = 
¡d
::
	`max
(
»ù
.
	`right
(), m_rightLayoutOverflow);

156 #ifdeà
PRINT_OVERFLOW


157 
	`´štf
("cu¼’ˆtİ:%d bÙtom:%d†eá:%d„ight:%d\n",
m_tİLayoutOv”æow
,

158 
m_bÙtomLayoutOv”æow
,
m_ËáLayoutOv”æow
,
m_rightLayoutOv”æow
);

160 
	}
}

162 
šlše
 
	gR’d”Ov”æow
::
	$addVisu®Ov”æow
(cÚ¡ 
IÁReù
& 
»ù
)

164 #ifdeà
PRINT_OVERFLOW


165 
	`´štf
("add visual overflow:„ect x:%d y:%d width:%d height:%d\n",

166 
»ù
.
	`x
(),»ù.
	`y
(),»ù.
	`width
(),»ù.
	`height
());

167 
	`´štf
("Ügš®İ:%d bÙtom:%d†eá:%d„ight:%d\n",
m_tİVisu®Ov”æow
,

168 
m_bÙtomVisu®Ov”æow
,
m_ËáVisu®Ov”æow
,
m_rightVisu®Ov”æow
);

171 
m_tİVisu®Ov”æow
 = 
¡d
::
	`mš
(
»ù
.
	`y
(), m_topVisualOverflow);

172 
m_bÙtomVisu®Ov”æow
 = 
¡d
::
	`max
(
»ù
.
	`bÙtom
(), m_bottomVisualOverflow);

173 
m_ËáVisu®Ov”æow
 = 
¡d
::
	`mš
(
»ù
.
	`x
(), m_leftVisualOverflow);

174 
m_rightVisu®Ov”æow
 = 
¡d
::
	`max
(
»ù
.
	`right
(), m_rightVisualOverflow);

176 #ifdeà
PRINT_OVERFLOW


177 
	`´štf
("cu¼’ˆtİ:%d bÙtom:%d†eá:%d„ight:%d\n",
m_tİVisu®Ov”æow
,

178 
m_bÙtomVisu®Ov”æow
,
m_ËáVisu®Ov”æow
,
m_rightVisu®Ov”æow
);

180 
	}
}

182 
šlše
 
	gR’d”Ov”æow
::
	$»£tLayoutOv”æow
(cÚ¡ 
IÁReù
& 
»ù
)

184 
m_tİLayoutOv”æow
 = 
»ù
.
	`y
();

185 
m_bÙtomLayoutOv”æow
 = 
»ù
.
	`bÙtom
();

186 
m_ËáLayoutOv”æow
 = 
»ù
.
	`x
();

187 
m_rightLayoutOv”æow
 = 
»ù
.
	`right
();

188 
	}
}

	@RenderPart.cpp

24 
	~"cÚfig.h
"

25 
	~"R’d”P¬t.h
"

27 
	~"R’d”V›w.h
"

28 
	~"F¿me.h
"

29 
	~"F¿meV›w.h
"

30 
	~"HTMLF¿meEËm’tBa£.h
"

32 
Çme¥aû
 
	gWebCÜe
 {

34 
	gR’d”P¬t
::
R’d”P¬t
(
EËm’t
* 
node
)

35 : 
R’d”Widg‘
(
node
)

36 , 
m_hasF®lbackCÚ‹Á
(
çl£
)

39 
£tIÆše
(
çl£
);

42 
	gR’d”P¬t
::~
R’d”P¬t
()

44 
ş—rWidg‘
();

47 
	gR’d”P¬t
::
£tWidg‘
(
PassRefPŒ
<
Widg‘
> 
widg‘
)

49 ià(
widg‘
 =ğ
this
->widget())

52 
	gR’d”Widg‘
::
£tWidg‘
(
widg‘
);

56 
v›wCË¬ed
();

59 
	gR’d”P¬t
::
ÏyoutW™hFÏ‰’šg
(
boŞ
 
fixedWidth
, boŞ 
fixedHeight
)

61 
F¿meV›w
* 
	gchdF¿meV›w
 = 
¡©ic_ÿ¡
<F¿meV›w*>(
widg‘
());

62 
R’d”V›w
* 
	gchdRoÙ
 = 
chdF¿meV›w
 ? 
¡©ic_ÿ¡
<R’d”V›w*>(chdF¿meV›w->
äame
()->
cÚ‹ÁR’d””
()) : 0;

65 ià(!
width
(è|| !
height
(è|| !
	gchdRoÙ
) {

66 
upd©eWidg‘Pos™iÚ
();

67 ià(
	gchdF¿meV›w
)

68 
	gchdF¿meV›w
->
Ïyout
();

69 
£tN“dsLayout
(
çl£
);

74 
upd©eWidg‘Pos™iÚ
();

75 ià(
	gchdRoÙ
->
´efWidthsDœty
())

76 
	gchdRoÙ
->
ÿlcP»fWidths
();

82 
HTMLF¿meEËm’tBa£
* 
	g–em’t
 = 
¡©ic_ÿ¡
<HTMLF¿meEËm’tBa£*>(
node
());

83 
boŞ
 
	gisSüŞÏbË
 = 
–em’t
->
süŞlšgMode
(è!ğ
SüŞlb¬AlwaysOff
;

86 
	ghBÜd”
 = 
bÜd”Leá
(è+ 
bÜd”Right
();

87 
	gvBÜd”
 = 
bÜd”Tİ
(è+ 
bÜd”BÙtom
();

90 ià(
	gisSüŞÏbË
 || !
	gfixedWidth
) {

91 
£tWidth
(
max
(
width
(), 
chdRoÙ
->
mšP»fWidth
(è+ 
hBÜd”
));

93 
upd©eWidg‘Pos™iÚ
();

94 
	gchdF¿meV›w
->
Ïyout
();

98 ià(
	gisSüŞÏbË
 || !
	gfixedHeight
 || 
	gchdRoÙ
->
isF¿meS‘
())

99 
£tHeight
(
max
(
height
(), 
chdF¿meV›w
->
cÚ‹ÁsHeight
(è+ 
vBÜd”
));

100 ià(
	gisSüŞÏbË
 || !
	gfixedWidth
 || 
	gchdRoÙ
->
isF¿meS‘
())

101 
£tWidth
(
max
(
width
(), 
chdF¿meV›w
->
cÚ‹ÁsWidth
(è+ 
hBÜd”
));

103 
upd©eWidg‘Pos™iÚ
();

105 
ASSERT
(!
chdF¿meV›w
->
ÏyoutP’dšg
());

106 
ASSERT
(!
chdRoÙ
->
ÃedsLayout
());

107 
ASSERT
(!
chdRoÙ
->
fœ¡Chd
(è|| !chdRoÙ->fœ¡Chd()->fœ¡Chd(è|| !chdRoÙ->fœ¡Chd()->fœ¡Chd()->
ÃedsLayout
());

109 
£tN“dsLayout
(
çl£
);

113 
	gR’d”P¬t
::
v›wCË¬ed
()

	@RenderPart.h

23 #iâdeà
R’d”P¬t_h


24 
	#R’d”P¬t_h


	)

26 
	~"R’d”Widg‘.h
"

28 
Çme¥aû
 
	gWebCÜe
 {

34 şas 
	cR’d”P¬t
 : 
public
 
R’d”Widg‘
 {

35 
public
:

36 
R’d”P¬t
(
EËm’t
*);

37 
	gvœtu®
 ~
R’d”P¬t
();

39 
boŞ
 
hasF®lbackCÚ‹Á
(ècÚ¡ {  
	gm_hasF®lbackCÚ‹Á
; }

41 
vœtu®
 
£tWidg‘
(
PassRefPŒ
<
Widg‘
>);

42 
vœtu®
 
v›wCË¬ed
();

44 
ÏyoutW™hFÏ‰’šg
(
boŞ
 
fixedWidth
, boŞ 
fixedHeight
);

46 
	g´Ùeùed
:

47 
boŞ
 
m_hasF®lbackCÚ‹Á
;

49 
	g´iv©e
:

50 
vœtu®
 
boŞ
 
isR’d”P¬t
(ècÚ¡ {  
Œue
; }

51 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderPart"; }

54 
šlše
 
R’d”P¬t
* 
	$toR’d”P¬t
(
R’d”Objeù
* 
objeù
)

56 
	`ASSERT
(!
objeù
 || objeù->
	`isR’d”P¬t
());

57  
¡©ic_ÿ¡
<
R’d”P¬t
*>(
objeù
);

58 
	}
}

61 
toR’d”P¬t
(cÚ¡ 
R’d”P¬t
*);

	@RenderPartObject.cpp

24 
	~"cÚfig.h
"

25 
	~"R’d”P¬tObjeù.h
"

27 
	~"F¿me.h
"

28 
	~"F¿meLßd”Cl›Á.h
"

29 
	~"HTMLEmbedEËm’t.h
"

30 
	~"HTMLIF¿meEËm’t.h
"

31 
	~"HTMLNames.h
"

32 
	~"HTMLObjeùEËm’t.h
"

33 
	~"HTMLP¬amEËm’t.h
"

34 
	~"MIMETy³Regi¡ry.h
"

35 
	~"Page.h
"

36 
	~"R’d”V›w.h
"

37 
	~"R’d”Widg‘PrÙeùÜ.h
"

38 
	~"S‘tšgs.h
"

39 
	~"Text.h
"

41 #ià
ENABLE
(
PLUGIN_PROXY_FOR_VIDEO
)

42 
	~"HTMLVideoEËm’t.h
"

45 
Çme¥aû
 
	gWebCÜe
 {

47 
usšg
 
Çme¥aû
 
	gHTMLNames
;

49 
	gR’d”P¬tObjeù
::
R’d”P¬tObjeù
(
EËm’t
* 
–em’t
)

50 : 
R’d”P¬t
(
–em’t
)

54 
boŞ
 
R’d”P¬tObjeù
::
æ©‹nF¿me
()

56 ià(!
node
(è|| !node()->
hasTagName
(
iäameTag
))

57  
çl£
;

59 
HTMLIF¿meEËm’t
* 
	g–em’t
 = 
¡©ic_ÿ¡
<HTMLIF¿meEËm’t*>(
node
());

60 
boŞ
 
	gisSüŞÏbË
 = 
–em’t
->
süŞlšgMode
(è!ğ
SüŞlb¬AlwaysOff
;

62 ià(!
	gisSüŞÏbË
 && 
¡yË
()->
width
().
isFixed
()

63 && 
¡yË
()->
height
().
isFixed
())

64  
	gçl£
;

66 
F¿me
* 
	gäame
 = 
–em’t
->
docum’t
()->
äame
();

67 
boŞ
 
	g’abËd
 = 
äame
 && f¿me->
£‰šgs
()->
äameFÏ‰’šgEÇbËd
();

69 ià(!
	g’abËd
 || !
	gäame
->
·ge
())

70  
	gçl£
;

72 
F¿meV›w
* 
	gv›w
 = 
äame
->
·ge
()->
mašF¿me
()->
v›w
();

73 ià(!
	gv›w
)

74  
	gçl£
;

77  
absŞu‹BoundšgBoxReù
().
š‹r£ùs
(
IÁReù
(
IÁPošt
(0, 0), 
v›w
->
cÚ‹ÁsSize
()));

80 
	gR’d”P¬tObjeù
::
ÿlcHeight
()

82 
R’d”P¬t
::
ÿlcHeight
();

83 ià(!
æ©‹nF¿me
())

86 
HTMLIF¿meEËm’t
* 
	gäame
 = 
¡©ic_ÿ¡
<HTMLIF¿meEËm’t*>(
node
());

87 
boŞ
 
	gisSüŞÏbË
 = 
äame
->
süŞlšgMode
(è!ğ
SüŞlb¬AlwaysOff
;

89 ià(
	gisSüŞÏbË
 || !
¡yË
()->
height
().
isFixed
()) {

90 
F¿meV›w
* 
	gv›w
 = 
¡©ic_ÿ¡
<F¿meV›w*>(
widg‘
());

91 
	gbÜd”
 = 
bÜd”Tİ
(è+ 
bÜd”BÙtom
();

92 
£tHeight
(
max
(
height
(), 
v›w
->
cÚ‹ÁsHeight
(è+ 
bÜd”
));

96 
	gR’d”P¬tObjeù
::
ÿlcWidth
()

98 
R’d”P¬t
::
ÿlcWidth
();

99 ià(!
æ©‹nF¿me
())

102 
HTMLIF¿meEËm’t
* 
	gäame
 = 
¡©ic_ÿ¡
<HTMLIF¿meEËm’t*>(
node
());

103 
boŞ
 
	gisSüŞÏbË
 = 
äame
->
süŞlšgMode
(è!ğ
SüŞlb¬AlwaysOff
;

105 ià(
	gisSüŞÏbË
 || !
¡yË
()->
width
().
isFixed
()) {

106 
F¿meV›w
* 
	gv›w
 = 
¡©ic_ÿ¡
<F¿meV›w*>(
widg‘
());

107 
	gbÜd”
 = 
bÜd”Leá
(è+ 
bÜd”Right
();

108 
£tWidth
(
max
(
width
(), 
v›w
->
cÚ‹ÁsWidth
(è+ 
bÜd”
));

112 
	gR’d”P¬tObjeù
::
Ïyout
()

114 
ASSERT
(
ÃedsLayout
());

116 
	gR’d”P¬t
::
ÿlcWidth
();

117 
	gR’d”P¬t
::
ÿlcHeight
();

119 ià(
æ©‹nF¿me
()) {

120 
ÏyoutW™hFÏ‰’šg
(
¡yË
()->
width
().
isFixed
(), styË()->
height
().isFixed());

124 
	gR’d”P¬t
::
Ïyout
();

126 
	gm_ov”æow
.
ş—r
();

127 
addShadowOv”æow
();

129 
£tN“dsLayout
(
çl£
);

132 
	gR’d”P¬tObjeù
::
v›wCË¬ed
()

134 ià(
node
(è&& 
widg‘
(è&& widg‘()->
isF¿meV›w
()) {

135 
F¿meV›w
* 
v›w
 = 
¡©ic_ÿ¡
<F¿meV›w*>(
widg‘
());

136 
	gm¬gšw
 = -1;

137 
	gm¬gšh
 = -1;

138 ià(
node
()->
hasTagName
(
iäameTag
)) {

139 
HTMLIF¿meEËm’t
* 
	gäame
 = 
¡©ic_ÿ¡
<HTMLIF¿meEËm’t*>(
node
());

140 
	gm¬gšw
 = 
äame
->
g‘M¬gšWidth
();

141 
	gm¬gšh
 = 
äame
->
g‘M¬gšHeight
();

143 ià(
	gm¬gšw
 != -1)

144 
v›w
->
£tM¬gšWidth
(
m¬gšw
);

145 ià(
	gm¬gšh
 != -1)

146 
v›w
->
£tM¬gšHeight
(
m¬gšh
);

	@RenderPartObject.h

23 #iâdeà
R’d”P¬tObjeù_h


24 
	#R’d”P¬tObjeù_h


	)

26 
	~"R’d”P¬t.h
"

28 
Çme¥aû
 
	gWebCÜe
 {

31 şas 
	cR’d”P¬tObjeù
 : 
public
 
R’d”P¬t
 {

32 
public
:

33 
R’d”P¬tObjeù
(
EËm’t
*);

35 
vœtu®
 
ÿlcHeight
();

36 
vœtu®
 
ÿlcWidth
();

38 
	g´iv©e
:

39 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderPartObject"; }

41 
vœtu®
 
Ïyout
();

43 
vœtu®
 
v›wCË¬ed
();

45 
boŞ
 
æ©‹nF¿me
();

48 
šlše
 
R’d”P¬tObjeù
* 
	$toR’d”P¬tObjeù
(
R’d”Objeù
* 
objeù
)

50 
	`ASSERT
(!
objeù
 || !
	`¡rcmp
(objeù->
	`»nd”Name
(), "RenderPartObject"));

51  
¡©ic_ÿ¡
<
R’d”P¬tObjeù
*>(
objeù
);

52 
	}
}

55 
toR’d”P¬tObjeù
(cÚ¡ 
R’d”P¬tObjeù
*);

	@RenderPath.cpp

24 
	~"cÚfig.h
"

26 #ià
ENABLE
(
SVG
)

27 
	~"R’d”P©h.h
"

29 
	~"FlßtPošt.h
"

30 
	~"FlßtQuad.h
"

31 
	~"G¿phicsCÚ‹xt.h
"

32 
	~"Poš‹rEv’tsH™RuËs.h
"

33 
	~"R’d”SVGCÚš”.h
"

34 
	~"R’d”SVGResourûM¬k”.h
"

35 
	~"SŒokeStyËAµl›r.h
"

36 
	~"SVGPaštS”v”.h
"

37 
	~"SVGR’d”SuµÜt.h
"

38 
	~"SVGStyËdT¿nsfÜmabËEËm’t.h
"

39 
	~"SVGT¿nsfÜmLi¡.h
"

40 
	~"SVGURIReã»nû.h
"

41 
	~<wtf/M©hExŒas.h
>

43 
Çme¥aû
 
	gWebCÜe
 {

45 şas 
	cBoundšgReùSŒokeStyËAµl›r
 : 
public
 
SŒokeStyËAµl›r
 {

46 
public
:

47 
BoundšgReùSŒokeStyËAµl›r
(cÚ¡ 
R’d”Objeù
* 
objeù
, 
R’d”StyË
* 
¡yË
)

48 : 
m_objeù
(
objeù
)

49 , 
m_¡yË
(
¡yË
)

51 
ASSERT
(
¡yË
);

52 
ASSERT
(
objeù
);

55 
¡rokeStyË
(
G¿phicsCÚ‹xt
* 
gc
)

57 
­¶ySŒokeStyËToCÚ‹xt
(
gc
, 
m_¡yË
, 
m_objeù
);

60 
	g´iv©e
:

61 cÚ¡ 
R’d”Objeù
* 
m_objeù
;

62 
R’d”StyË
* 
	gm_¡yË
;

65 
	gR’d”P©h
::
	$R’d”P©h
(
SVGStyËdT¿nsfÜmabËEËm’t
* 
node
)

66 : 
	`R’d”SVGMod–Objeù
(
node
)

67 , 
	`m_ÃedsBound¬›sUpd©e
(
çl£
)

68 , 
	`m_ÃedsP©hUpd©e
(
Œue
)

69 , 
	$m_ÃedsT¿nsfÜmUpd©e
(
Œue
)

71 
	}
}

73 
boŞ
 
	gR’d”P©h
::
	$flCÚšs
(cÚ¡ 
FlßtPošt
& 
pošt
, 
boŞ
 
»quœesFl
) const

75 ià(
m_·th
.
	`isEm±y
())

76  
çl£
;

78 ià(
»quœesFl
 && !
SVGPaštS”v”
::
	`flPaštS”v”
(
	`¡yË
(), 
this
))

79  
çl£
;

81  
m_·th
.
	`cÚšs
(
pošt
, 
	`¡yË
()->
	`svgStyË
()->
	`flRuË
());

82 
	}
}

84 
boŞ
 
	gR’d”P©h
::
	$¡rokeCÚšs
(cÚ¡ 
FlßtPošt
& 
pošt
, 
boŞ
 
»quœesSŒoke
) const

86 ià(
m_·th
.
	`isEm±y
())

87  
çl£
;

89 ià(
»quœesSŒoke
 && !
SVGPaštS”v”
::
	`¡rokePaštS”v”
(
	`¡yË
(), 
this
))

90  
çl£
;

92 
BoundšgReùSŒokeStyËAµl›r
 
	`¡rokeStyË
(
this
, 
	`¡yË
());

93  
m_·th
.
	`¡rokeCÚšs
(&
¡rokeStyË
, 
pošt
);

94 
	}
}

96 
FlßtReù
 
	gR’d”P©h
::
	$objeùBoundšgBox
() const

98 ià(
m_·th
.
	`isEm±y
())

99  
	`FlßtReù
();

101 ià(
m_ÿchedLoÿlFlBBox
.
	`isEm±y
())

102 
m_ÿchedLoÿlFlBBox
 = 
m_·th
.
	`boundšgReù
();

104  
m_ÿchedLoÿlFlBBox
;

105 
	}
}

107 
FlßtReù
 
	gR’d”P©h
::
	$¡rokeBoundšgBox
() const

109 ià(
m_·th
.
	`isEm±y
())

110  
	`FlßtReù
();

112 ià(!
m_ÿchedLoÿlSŒokeBBox
.
	`isEm±y
())

113  
m_ÿchedLoÿlSŒokeBBox
;

115 
m_ÿchedLoÿlSŒokeBBox
 = 
	`objeùBoundšgBox
();

116 ià(
	`¡yË
()->
	`svgStyË
()->
	`hasSŒoke
()) {

117 
BoundšgReùSŒokeStyËAµl›r
 
	`¡rokeStyË
(
this
, 
	`¡yË
());

118 
m_ÿchedLoÿlSŒokeBBox
.
	`un™e
(
m_·th
.
	`¡rokeBoundšgReù
(&
¡rokeStyË
));

121  
m_ÿchedLoÿlSŒokeBBox
;

122 
	}
}

124 
FlßtReù
 
	gR’d”P©h
::
	$m¬k”BoundšgBox
() const

126 ià(
m_·th
.
	`isEm±y
())

127  
	`FlßtReù
();

129 ià(
m_ÿchedLoÿlM¬k”BBox
.
	`isEm±y
())

130 
	`ÿlcuÏ‹M¬k”BoundsIfN“ded
();

132  
m_ÿchedLoÿlM¬k”BBox
;

133 
	}
}

135 
FlßtReù
 
	gR’d”P©h
::
	$»·štReùInLoÿlCoÜdš©es
() const

137 ià(
m_·th
.
	`isEm±y
())

138  
	`FlßtReù
();

141 ià(!
m_ÿchedLoÿlR•aštReù
.
	`isEm±y
())

142  
m_ÿchedLoÿlR•aštReù
;

146 
FlßtReù
 
»ù
 = 
	`f‹rBoundšgBoxFÜR’d””
(
this
);

147 ià(!
»ù
.
	`isEm±y
())

148 
m_ÿchedLoÿlR•aštReù
 = 
»ù
;

150 
m_ÿchedLoÿlR•aštReù
 = 
	`¡rokeBoundšgBox
();

151 
m_ÿchedLoÿlR•aštReù
.
	`un™e
(
	`m¬k”BoundšgBox
());

154 
»ù
 = 
	`ş³rBoundšgBoxFÜR’d””
(
this
);

155 ià(!
»ù
.
	`isEm±y
())

156 
m_ÿchedLoÿlR•aštReù
.
	`š‹r£ù
(
»ù
);

158 
»ù
 = 
	`mask”BoundšgBoxFÜR’d””
(
this
);

159 ià(!
»ù
.
	`isEm±y
())

160 
m_ÿchedLoÿlR•aštReù
.
	`š‹r£ù
(
»ù
);

162 
	`¡yË
()->
	`svgStyË
()->
	`šæ©eFÜShadow
(
m_ÿchedLoÿlR•aštReù
);

164  
m_ÿchedLoÿlR•aštReù
;

165 
	}
}

167 
	gR’d”P©h
::
	$Ïyout
()

169 
LayoutR•aš‹r
 
	`»·š‹r
(*
this
, 
	`checkFÜR•aštDuršgLayout
(è&& 
	`£lfN“dsLayout
());

170 
SVGStyËdT¿nsfÜmabËEËm’t
* 
–em’t
 = 
¡©ic_ÿ¡
<SVGStyËdT¿nsfÜmabËEËm’t*>(
	`node
());

175 ià(!
m_ÃedsP©hUpd©e
 && 
–em’t
->
	`hasR–©iveV®ues
())

176 
m_ÃedsP©hUpd©e
 = 
Œue
;

178 
boŞ
 
ÃedsUpd©e
 = 
m_ÃedsP©hUpd©e
 || 
m_ÃedsT¿nsfÜmUpd©e
 || 
m_ÃedsBound¬›sUpd©e
;

180 ià(
m_ÃedsBound¬›sUpd©e
)

181 
m_ÃedsBound¬›sUpd©e
 = 
çl£
;

183 ià(
m_ÃedsP©hUpd©e
) {

184 
m_·th
 = 
–em’t
->
	`toP©hD©a
();

185 
m_ÃedsP©hUpd©e
 = 
çl£
;

188 ià(
m_ÃedsT¿nsfÜmUpd©e
) {

189 
m_loÿlT¿nsfÜm
 = 
–em’t
->
	`ªim©edLoÿlT¿nsfÜm
();

190 
m_ÃedsT¿nsfÜmUpd©e
 = 
çl£
;

193 ià(
ÃedsUpd©e
)

194 
	`šv®id©eCachedBound¬›s
();

196 
»·š‹r
.
	`»·štAá”Layout
();

197 
	`£tN“dsLayout
(
çl£
);

198 
	}
}

200 
šlše
 
	$flAndSŒokeP©h
(cÚ¡ 
P©h
& 
·th
, 
G¿phicsCÚ‹xt
* 
cÚ‹xt
, 
R’d”StyË
* 
¡yË
, 
R’d”P©h
* 
objeù
)

202 
cÚ‹xt
->
	`begšP©h
();

204 
SVGPaštS”v”
* 
flPaštS”v”
 = SVGPaštS”v”::
	`flPaštS”v”
(
¡yË
, 
objeù
);

205 ià(
flPaštS”v”
) {

206 
cÚ‹xt
->
	`addP©h
(
·th
);

207 
flPaštS”v”
->
	`d¿w
(
cÚ‹xt
, 
objeù
, 
AµlyToFlT¬g‘Ty³
);

210 
SVGPaštS”v”
* 
¡rokePaštS”v”
 = SVGPaštS”v”::
	`¡rokePaštS”v”
(
¡yË
, 
objeù
);

211 ià(
¡rokePaštS”v”
) {

212 
cÚ‹xt
->
	`addP©h
(
·th
);

213 
¡rokePaštS”v”
->
	`d¿w
(
cÚ‹xt
, 
objeù
, 
AµlyToSŒokeT¬g‘Ty³
);

215 
	}
}

217 
	gR’d”P©h
::
	$·št
(
PaštInfo
& 
·štInfo
, , )

219 ià(
·štInfo
.
cÚ‹xt
->
	`·štšgDi§bËd
(è|| 
	`¡yË
()->
	`visib™y
(è=ğ
HIDDEN
 || 
m_·th
.
	`isEm±y
())

222 
FlßtReù
 
boundšgBox
 = 
	`»·štReùInLoÿlCoÜdš©es
();

223 
FlßtReù
 
nÚLoÿlBoundšgBox
 = 
m_loÿlT¿nsfÜm
.
	`m­Reù
(
boundšgBox
);

227 ià(!
nÚLoÿlBoundšgBox
.
	`š‹r£ùs
(
·štInfo
.
»ù
è&& !·štInfo.»ù.
	`isEm±y
())

230 
PaštInfo
 
	`chdPaštInfo
(
·štInfo
);

231 
boŞ
 
d¿wsOuše
 = 
	`¡yË
()->
	`oušeWidth
(è&& (
chdPaštInfo
.
pha£
 =ğ
PaštPha£Ouše
 || chdPaštInfo.pha£ =ğ
PaštPha£S–fOuše
);

232 ià(
d¿wsOuše
 || 
chdPaštInfo
.
pha£
 =ğ
PaštPha£FÜeground
) {

233 
chdPaštInfo
.
cÚ‹xt
->
	`§ve
();

234 
	`­¶yT¿nsfÜmToPaštInfo
(
chdPaštInfo
, 
m_loÿlT¿nsfÜm
);

235 
SVGResourûF‹r
* 
f‹r
 = 0;

237 ià(
chdPaštInfo
.
pha£
 =ğ
PaštPha£FÜeground
) {

238 
PaštInfo
 
	`§vedInfo
(
chdPaštInfo
);

240 ià(
	`´•¬eToR’d”SVGCÚ‹Á
(
this
, 
chdPaštInfo
, 
boundšgBox
, 
f‹r
)) {

241 ià(
	`¡yË
()->
	`svgStyË
()->
	`sh­eR’d”šg
(è=ğ
SR_CRISPEDGES
)

242 
chdPaštInfo
.
cÚ‹xt
->
	`£tShouldAÁŸlŸs
(
çl£
);

243 
	`flAndSŒokeP©h
(
m_·th
, 
chdPaštInfo
.
cÚ‹xt
, 
	`¡yË
(), 
this
);

245 ià(
¡©ic_ÿ¡
<
SVGStyËdEËm’t
*>(
	`node
())->
	`suµÜtsM¬k”s
())

246 
m_m¬k”LayoutInfo
.
	`d¿wM¬k”s
(
chdPaštInfo
);

248 
	`fšishR’d”SVGCÚ‹Á
(
this
, 
chdPaštInfo
, 
f‹r
, 
§vedInfo
.
cÚ‹xt
);

251 ià(
d¿wsOuše
)

252 
	`·štOuše
(
chdPaštInfo
.
cÚ‹xt
, 
¡©ic_ÿ¡
<>(
boundšgBox
.
	`x
()), stic_ÿ¡<>(boundšgBox.
	`y
()),

253 
¡©ic_ÿ¡
<>(
boundšgBox
.
	`width
()), stic_ÿ¡<>(boundšgBox.
	`height
()));

255 
chdPaštInfo
.
cÚ‹xt
->
	`»¡Üe
();

257 
	}
}

261 
	gR’d”P©h
::
addFocusRšgReùs
(
VeùÜ
<
IÁReù
>& 
»ùs
, , )

263 
IÁReù
 
	g»ù
 = 
’şosšgIÁReù
(
»·štReùInLoÿlCoÜdš©es
());

264 ià(!
	g»ù
.
isEm±y
())

265 
	g»ùs
.
­³nd
(
»ù
);

268 
boŞ
 
	gR’d”P©h
::
	$nodeAtFlßtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
& 
»suÉ
, cÚ¡ 
FlßtPošt
& 
poštInP¬’t
, 
H™Te¡AùiÚ
 
h™Te¡AùiÚ
)

271 ià(
h™Te¡AùiÚ
 !ğ
H™Te¡FÜeground
)

272  
çl£
;

274 
FlßtPošt
 
loÿlPošt
 = 
m_loÿlT¿nsfÜm
.
	`šv”£
().
	`m­Pošt
(
poštInP¬’t
);

276 
Poš‹rEv’tsH™RuËs
 
	`h™RuËs
(Poš‹rEv’tsH™RuËs::
SVG_PATH_HITTESTING
, 
	`¡yË
()->
	`poš‹rEv’ts
());

278 
boŞ
 
isVisibË
 = (
	`¡yË
()->
	`visib™y
(è=ğ
VISIBLE
);

279 ià(
isVisibË
 || !
h™RuËs
.
»quœeVisibË
) {

280 ià((
h™RuËs
.
ÿnH™SŒoke
 && (
	`¡yË
()->
	`svgStyË
()->
	`hasSŒoke
(è|| !h™RuËs.
»quœeSŒoke
è&& 
	`¡rokeCÚšs
(
loÿlPošt
, hitRules.requireStroke))

281 || (
h™RuËs
.
ÿnH™Fl
 && (
	`¡yË
()->
	`svgStyË
()->
	`hasFl
(è|| !h™RuËs.
»quœeFl
è&& 
	`flCÚšs
(
loÿlPošt
, hitRules.requireFill))) {

282 
	`upd©eH™Te¡ResuÉ
(
»suÉ
, 
	`roundedIÁPošt
(
loÿlPošt
));

283  
Œue
;

287  
çl£
;

288 
	}
}

290 
	gR’d”P©h
::
	$ÿlcuÏ‹M¬k”BoundsIfN“ded
() const

292 
Docum’t
* 
doc
 = 
	`docum’t
();

294 
SVGEËm’t
* 
svgEËm’t
 = 
¡©ic_ÿ¡
<SVGEËm’t*>(
	`node
());

295 
	`ASSERT
(
svgEËm’t
 && svgEËm’t->
	`docum’t
());

296 ià(!
svgEËm’t
->
	`isStyËd
())

299 
SVGStyËdEËm’t
* 
¡yËdEËm’t
 = 
¡©ic_ÿ¡
<SVGStyËdEËm’t*>(
svgEËm’t
);

300 ià(!
¡yËdEËm’t
->
	`suµÜtsM¬k”s
())

303 cÚ¡ 
SVGR’d”StyË
* 
svgStyË
 = 
	`¡yË
()->
	`svgStyË
();

304 
AtomicSŒšg
 
	`¡¬tM¬k”Id
(
svgStyË
->
	`¡¬tM¬k”
());

305 
AtomicSŒšg
 
	`midM¬k”Id
(
svgStyË
->
	`midM¬k”
());

306 
AtomicSŒšg
 
	`’dM¬k”Id
(
svgStyË
->
	`’dM¬k”
());

308 
R’d”SVGResourûM¬k”
* 
¡¬tM¬k”
 = 
g‘R’d”SVGResourûById
<R’d”SVGResourûM¬k”>(
doc
, 
¡¬tM¬k”Id
);

309 
R’d”SVGResourûM¬k”
* 
midM¬k”
 = 
g‘R’d”SVGResourûById
<R’d”SVGResourûM¬k”>(
doc
, 
midM¬k”Id
);

310 
R’d”SVGResourûM¬k”
* 
’dM¬k”
 = 
g‘R’d”SVGResourûById
<R’d”SVGResourûM¬k”>(
doc
, 
’dM¬k”Id
);

312 ià(!
¡¬tM¬k”
 && !
¡¬tM¬k”Id
.
	`isEm±y
())

313 
svgEËm’t
->
	`docum’t
()->
	`acûssSVGEx‹nsiÚs
()->
	`addP’dšgResourû
(
¡¬tM¬k”Id
, 
¡yËdEËm’t
);

314 ià(
¡¬tM¬k”
)

315 
¡¬tM¬k”
->
	`addCl›Á
(
this
);

317 ià(!
midM¬k”
 && !
midM¬k”Id
.
	`isEm±y
())

318 
svgEËm’t
->
	`docum’t
()->
	`acûssSVGEx‹nsiÚs
()->
	`addP’dšgResourû
(
midM¬k”Id
, 
¡yËdEËm’t
);

319 ià(
midM¬k”
)

320 
midM¬k”
->
	`addCl›Á
(
this
);

322 ià(!
’dM¬k”
 && !
’dM¬k”Id
.
	`isEm±y
())

323 
svgEËm’t
->
	`docum’t
()->
	`acûssSVGEx‹nsiÚs
()->
	`addP’dšgResourû
(
’dM¬k”Id
, 
¡yËdEËm’t
);

324 ià(
’dM¬k”
)

325 
’dM¬k”
->
	`addCl›Á
(
this
);

327 ià(!
¡¬tM¬k”
 && !
midM¬k”
 && !
’dM¬k”
)

330 
¡rokeWidth
 = 
SVGR’d”StyË
::
	`cssPrim™iveToL’gth
(
this
, 
svgStyË
->
	`¡rokeWidth
(), 1.0f);

331 
m_ÿchedLoÿlM¬k”BBox
 = 
m_m¬k”LayoutInfo
.
	`ÿlcuÏ‹Bound¬›s
(
¡¬tM¬k”
, 
midM¬k”
, 
’dM¬k”
, 
¡rokeWidth
, 
m_·th
);

332 
	}
}

334 
	gR’d”P©h
::
	$šv®id©eCachedBound¬›s
()

336 
m_ÿchedLoÿlR•aštReù
 = 
	`FlßtReù
();

337 
m_ÿchedLoÿlSŒokeBBox
 = 
	`FlßtReù
();

338 
m_ÿchedLoÿlFlBBox
 = 
	`FlßtReù
();

339 
m_ÿchedLoÿlM¬k”BBox
 = 
	`FlßtReù
();

340 
	}
}

342 
	gR’d”P©h
::
	$¡yËWlChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ÃwStyË
)

344 
	`šv®id©eCachedBound¬›s
();

345 
R’d”SVGMod–Objeù
::
	`¡yËWlChªge
(
diff
, 
ÃwStyË
);

346 
	}
}

	@RenderPath.h

24 #iâdeà
R’d”P©h_h


25 
	#R’d”P©h_h


	)

27 #ià
ENABLE
(
SVG
)

28 
	~"AffšeT¿nsfÜm.h
"

29 
	~"FlßtReù.h
"

30 
	~"R’d”SVGMod–Objeù.h
"

31 
	~"SVGM¬k”LayoutInfo.h
"

33 
Çme¥aû
 
	gWebCÜe
 {

35 
şass
 
	gFlßtPošt
;

36 
şass
 
	gR’d”SVGCÚš”
;

37 
şass
 
	gSVGStyËdT¿nsfÜmabËEËm’t
;

39 şas 
	cR’d”P©h
 : 
public
 
R’d”SVGMod–Objeù
 {

40 
public
:

41 
R’d”P©h
(
SVGStyËdT¿nsfÜmabËEËm’t
*);

43 cÚ¡ 
	gP©h
& 
·th
(ècÚ¡ {  
	gm_·th
; }

44 
£tN“dsBound¬›sUpd©e
(è{ 
	gm_ÃedsBound¬›sUpd©e
 = 
Œue
; }

45 
£tN“dsP©hUpd©e
(è{ 
	gm_ÃedsP©hUpd©e
 = 
Œue
; }

46 
vœtu®
 
£tN“dsT¿nsfÜmUpd©e
(è{ 
	gm_ÃedsT¿nsfÜmUpd©e
 = 
Œue
; }

48 
	g´iv©e
:

50 
boŞ
 
flCÚšs
(cÚ¡ 
FlßtPošt
&, boŞ 
»quœesFl
 = 
Œue
) const;

51 
boŞ
 
¡rokeCÚšs
(cÚ¡ 
FlßtPošt
&, boŞ 
»quœesSŒoke
 = 
Œue
) const;

53 
vœtu®
 
FlßtReù
 
objeùBoundšgBox
() const;

54 
vœtu®
 
FlßtReù
 
¡rokeBoundšgBox
() const;

55 
vœtu®
 
FlßtReù
 
m¬k”BoundšgBox
() const;

56 
vœtu®
 
FlßtReù
 
»·štReùInLoÿlCoÜdš©es
() const;

58 
vœtu®
 cÚ¡ 
	gAffšeT¿nsfÜm
& 
loÿlToP¬’tT¿nsfÜm
(ècÚ¡ {  
	gm_loÿlT¿nsfÜm
; }

60 
vœtu®
 
boŞ
 
isR’d”P©h
(ècÚ¡ {  
	gŒue
; }

61 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderPath"; }

63 
vœtu®
 
Ïyout
();

64 
vœtu®
 
·št
(
PaštInfo
&, 
·»ÁX
, 
·»ÁY
);

65 
vœtu®
 
addFocusRšgReùs
(
VeùÜ
<
IÁReù
>&, 
tx
, 
ty
);

67 
vœtu®
 
boŞ
 
nodeAtFlßtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, cÚ¡ 
FlßtPošt
& 
poštInP¬’t
, 
H™Te¡AùiÚ
);

68 
vœtu®
 
¡yËWlChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
*);

70 
ÿlcuÏ‹M¬k”BoundsIfN“ded
() const;

71 
šv®id©eCachedBound¬›s
();

73 
	g´iv©e
:

74 
vœtu®
 
AffšeT¿nsfÜm
 
loÿlT¿nsfÜm
(ècÚ¡ {  
m_loÿlT¿nsfÜm
; }

76 
boŞ
 
	gm_ÃedsBound¬›sUpd©e
 : 1;

77 
boŞ
 
	gm_ÃedsP©hUpd©e
 : 1;

78 
boŞ
 
	gm_ÃedsT¿nsfÜmUpd©e
 : 1;

80 
mubË
 
P©h
 
	gm_·th
;

81 
mubË
 
FlßtReù
 
	gm_ÿchedLoÿlFlBBox
;

82 
mubË
 
FlßtReù
 
	gm_ÿchedLoÿlSŒokeBBox
;

83 
mubË
 
FlßtReù
 
	gm_ÿchedLoÿlR•aštReù
;

84 
mubË
 
FlßtReù
 
	gm_ÿchedLoÿlM¬k”BBox
;

85 
mubË
 
SVGM¬k”LayoutInfo
 
	gm_m¬k”LayoutInfo
;

86 
AffšeT¿nsfÜm
 
	gm_loÿlT¿nsfÜm
;

89 
šlše
 
R’d”P©h
* 
	$toR’d”P©h
(
R’d”Objeù
* 
objeù
)

91 
	`ASSERT
(!
objeù
 || objeù->
	`isR’d”P©h
());

92  
¡©ic_ÿ¡
<
R’d”P©h
*>(
objeù
);

93 
	}
}

95 
šlše
 cÚ¡ 
R’d”P©h
* 
	$toR’d”P©h
(cÚ¡ 
R’d”Objeù
* 
objeù
)

97 
	`ASSERT
(!
objeù
 || objeù->
	`isR’d”P©h
());

98  
¡©ic_ÿ¡
<cÚ¡ 
R’d”P©h
*>(
objeù
);

99 
	}
}

102 
toR’d”P©h
(cÚ¡ 
R’d”P©h
*);

	@RenderProgress.cpp

21 
	~"cÚfig.h
"

22 #ià
ENABLE
(
PROGRESS_TAG
)

24 
	~"R’d”Prog»ss.h
"

26 
	~"HTMLProg»ssEËm’t.h
"

27 
	~"R’d”Theme.h
"

28 
	~<wtf/Cu¼’tTime.h
>

30 
usšg
 
Çme¥aû
 
	g¡d
;

32 
Çme¥aû
 
	gWebCÜe
 {

34 
usšg
 
Çme¥aû
 
	gHTMLNames
;

36 
	gR’d”Prog»ss
::
R’d”Prog»ss
(
HTMLProg»ssEËm’t
* 
–em’t
)

37 : 
R’d”Block
(
–em’t
)

38 , 
m_pos™iÚ
(-1)

39 , 
m_ªim©iÚS¹Time
(0)

40 , 
m_ªim©iÚR•—tIÁ”v®
(0)

41 , 
m_ªim©iÚDu¿tiÚ
(0)

42 , 
m_ªim©šg
(
çl£
)

43 , 
m_ªim©iÚTim”
(
this
, &
R’d”Prog»ss
::
ªim©iÚTim”Fœed
)

47 
R’d”Prog»ss
::
Ïyout
()

49 
ASSERT
(
ÃedsLayout
());

51 
LayoutR•aš‹r
 
»·š‹r
(*
this
, 
checkFÜR•aštDuršgLayout
());

53 
ÿlcWidth
();

54 
ÿlcHeight
();

56 
	gm_ov”æow
.
ş—r
();

58 
upd©eAnim©iÚS‹
();

60 
	g»·š‹r
.
»·štAá”Layout
();

62 
£tN“dsLayout
(
çl£
);

65 
	gR’d”Prog»ss
::
upd©eFromEËm’t
()

67 
HTMLProg»ssEËm’t
* 
–em’t
 = 
´og»ssEËm’t
();

68 ià(
	gm_pos™iÚ
 =ğ
–em’t
->
pos™iÚ
())

70 
	gm_pos™iÚ
 = 
–em’t
->
pos™iÚ
();

72 
upd©eAnim©iÚS‹
();

74 
»·št
();

77 
	gR’d”Prog»ss
::
ªim©iÚProg»ss
()

79  
m_ªim©šg
 ? (
fmod
((
cu¼’tTime
(è- 
m_ªim©iÚS¹Time
), 
m_ªim©iÚDu¿tiÚ
è/ 
	gm_ªim©iÚDu¿tiÚ
) : 0;

82 
	gR’d”Prog»ss
::
ªim©iÚTim”Fœed
(
Tim”
<
R’d”Prog»ss
>*)

84 
»·št
();

87 
	gR’d”Prog»ss
::
·št
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

89 ià(
	g·štInfo
.
	gpha£
 =ğ
PaštPha£BlockBackground
) {

90 ià(!
m_ªim©iÚTim”
.
isAùive
(è&& 
m_ªim©šg
)

91 
m_ªim©iÚTim”
.
¡¬tOÃShÙ
(
m_ªim©iÚR•—tIÁ”v®
);

94 
	gR’d”Block
::
·št
(
·štInfo
, 
tx
, 
ty
);

97 
	gR’d”Prog»ss
::
upd©eAnim©iÚS‹
()

99 
m_ªim©iÚDu¿tiÚ
 = 
theme
()->
ªim©iÚDu¿tiÚFÜProg»ssB¬
(
this
);

100 
	gm_ªim©iÚR•—tIÁ”v®
 = 
theme
()->
ªim©iÚR•—tIÁ”v®FÜProg»ssB¬
(
this
);

102 
boŞ
 
	gªim©šg
 = 
m_ªim©iÚDu¿tiÚ
 > 0;

103 ià(
	gªim©šg
 =ğ
m_ªim©šg
)

106 
	gm_ªim©šg
 = 
ªim©šg
;

107 ià(
	gm_ªim©šg
) {

108 
	gm_ªim©iÚS¹Time
 = 
cu¼’tTime
();

109 
	gm_ªim©iÚTim”
.
¡¬tOÃShÙ
(
m_ªim©iÚR•—tIÁ”v®
);

111 
	gm_ªim©iÚTim”
.
¡İ
();

114 
HTMLProg»ssEËm’t
* 
	gR’d”Prog»ss
::
´og»ssEËm’t
() const

116  
¡©ic_ÿ¡
<
HTMLProg»ssEËm’t
*>(
node
());

	@RenderProgress.h

21 #iâdeà
R’d”Prog»ss_h


22 
	#R’d”Prog»ss_h


	)

24 #ià
ENABLE
(
PROGRESS_TAG
)

25 
	~"R’d”Block.h
"

27 
Çme¥aû
 
	gWebCÜe
 {

29 
şass
 
	gHTMLProg»ssEËm’t
;

31 şas 
	cR’d”Prog»ss
 : 
public
 
R’d”Block
 {

32 
public
:

33 
R’d”Prog»ss
(
HTMLProg»ssEËm’t
*);

34 
pos™iÚ
(è{  
	gm_pos™iÚ
; }

35 
ªim©iÚProg»ss
();

37 
HTMLProg»ssEËm’t
* 
´og»ssEËm’t
() const;

39 
	g´iv©e
:

40 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderProgress"; }

41 
vœtu®
 
boŞ
 
isProg»ss
(ècÚ¡ {  
	gŒue
; }

42 
vœtu®
 
Ïyout
();

43 
vœtu®
 
upd©eFromEËm’t
();

44 
vœtu®
 
·št
(
PaštInfo
&, 
tx
, 
ty
);

46 
ªim©iÚTim”Fœed
(
Tim”
<
R’d”Prog»ss
>*);

47 
upd©eAnim©iÚS‹
();

49 
	gm_pos™iÚ
;

50 
	gm_ªim©iÚS¹Time
;

51 
	gm_ªim©iÚR•—tIÁ”v®
;

52 
	gm_ªim©iÚDu¿tiÚ
;

53 
boŞ
 
	gm_ªim©šg
;

54 
	gTim”
<
	gR’d”Prog»ss
> 
	gm_ªim©iÚTim”
;

57 
šlše
 
R’d”Prog»ss
* 
	$toR’d”Prog»ss
(
R’d”Objeù
* 
objeù
)

59 
	`ASSERT
(!
objeù
 || objeù->
	`isProg»ss
());

60  
¡©ic_ÿ¡
<
R’d”Prog»ss
*>(
objeù
);

61 
	}
}

64 
toR’d”Prog»ss
(cÚ¡ 
R’d”Prog»ss
*);

	@RenderReplaced.cpp

23 
	~"cÚfig.h
"

24 
	~"R’d”R•Ïûd.h
"

26 
	~"G¿phicsCÚ‹xt.h
"

27 
	~"R’d”Block.h
"

28 
	~"R’d”Lay”.h
"

29 
	~"R’d”Theme.h
"

30 
	~"R’d”V›w.h
"

31 
	~"VisibËPos™iÚ.h
"

33 
usšg
 
Çme¥aû
 
	g¡d
;

35 
Çme¥aû
 
	gWebCÜe
 {

37 cÚ¡ 
	gcDeçuÉWidth
 = 300;

38 cÚ¡ 
	gcDeçuÉHeight
 = 150;

40 
	gR’d”R•Ïûd
::
R’d”R•Ïûd
(
Node
* 
node
)

41 : 
R’d”Box
(
node
)

42 , 
m_šŒšsicSize
(
cDeçuÉWidth
, 
cDeçuÉHeight
)

44 
£tR•Ïûd
(
Œue
);

47 
	gR’d”R•Ïûd
::
R’d”R•Ïûd
(
Node
* 
node
, cÚ¡ 
IÁSize
& 
šŒšsicSize
)

48 : 
R’d”Box
(
node
)

49 , 
m_šŒšsicSize
(
šŒšsicSize
)

51 
£tR•Ïûd
(
Œue
);

54 
	gR’d”R•Ïûd
::~
R’d”R•Ïûd
()

58 
R’d”R•Ïûd
::
¡yËDidChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
)

60 
	gR’d”Box
::
¡yËDidChªge
(
diff
, 
ŞdStyË
);

62 
boŞ
 
	ghadStyË
 = (
ŞdStyË
 != 0);

63 
	gŞdZoom
 = 
hadStyË
 ? 
ŞdStyË
->
efãùiveZoom
(è: 
R’d”StyË
::
š™ŸlZoom
();

64 ià(
¡yË
(è&& styË()->
efãùiveZoom
(è!ğ
ŞdZoom
)

65 
šŒšsicSizeChªged
();

68 
	gR’d”R•Ïûd
::
Ïyout
()

70 
ASSERT
(
ÃedsLayout
());

72 
LayoutR•aš‹r
 
»·š‹r
(*
this
, 
checkFÜR•aštDuršgLayout
());

74 
£tHeight
(
mšimumR•ÏûdHeight
());

76 
ÿlcWidth
();

77 
ÿlcHeight
();

79 
	gm_ov”æow
.
ş—r
();

80 
addShadowOv”æow
();

82 
	g»·š‹r
.
»·štAá”Layout
();

84 
£tN“dsLayout
(
çl£
);

87 
	gR’d”R•Ïûd
::
šŒšsicSizeChªged
()

89 
sÿËdWidth
 = 
¡©ic_ÿ¡
<>(
cDeçuÉWidth
 * 
¡yË
()->
efãùiveZoom
());

90 
	gsÿËdHeight
 = 
¡©ic_ÿ¡
<>(
cDeçuÉHeight
 * 
¡yË
()->
efãùiveZoom
());

91 
	gm_šŒšsicSize
 = 
IÁSize
(
sÿËdWidth
, 
sÿËdHeight
);

92 
£tN“dsLayoutAndP»fWidthsReÿlc
();

95 
	gR’d”R•Ïûd
::
·št
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

97 ià(!
shouldPašt
(
·štInfo
, 
tx
, 
ty
))

100 
	gtx
 +ğ
x
();

101 
	gty
 +ğ
y
();

103 ià(
hasBoxDecÜ©iÚs
(è&& (
	g·štInfo
.
	gpha£
 =ğ
PaštPha£FÜeground
 || 
·štInfo
.
pha£
 =ğ
PaštPha£S–eùiÚ
))

104 
·štBoxDecÜ©iÚs
(
·štInfo
, 
tx
, 
ty
);

106 ià(
	g·štInfo
.
	gpha£
 =ğ
PaštPha£Mask
) {

107 
·štMask
(
·štInfo
, 
tx
, 
ty
);

111 ià((
	g·štInfo
.
	gpha£
 =ğ
PaštPha£Ouše
 || 
·štInfo
.
pha£
 =ğ
PaštPha£S–fOuše
è&& 
¡yË
()->
oušeWidth
())

112 
·štOuše
(
·štInfo
.
cÚ‹xt
, 
tx
, 
ty
, 
width
(), 
height
());

114 ià(
	g·štInfo
.
	gpha£
 !ğ
PaštPha£FÜeground
 && 
·štInfo
.
pha£
 !ğ
PaštPha£S–eùiÚ
)

117 ià(!
shouldPaštW™hšRoÙ
(
·štInfo
))

120 
boŞ
 
	gd¿wS–eùiÚTšt
 = 
£ËùiÚS‹
(è!ğ
S–eùiÚNÚe
 && !
docum’t
()->
´štšg
();

121 ià(
	g·štInfo
.
	gpha£
 =ğ
PaštPha£S–eùiÚ
) {

122 ià(
£ËùiÚS‹
(è=ğ
S–eùiÚNÚe
)

124 
	gd¿wS–eùiÚTšt
 = 
çl£
;

127 
boŞ
 
	gcom¶‘–yCl³dOut
 = 
çl£
;

128 ià(
¡yË
()->
hasBÜd”Radius
()) {

129 
IÁReù
 
	gbÜd”Reù
 = IÁReù(
tx
, 
ty
, 
width
(), 
height
());

131 ià(
	gbÜd”Reù
.
isEm±y
())

132 
	gcom¶‘–yCl³dOut
 = 
Œue
;

135 
	g·štInfo
.
	gcÚ‹xt
->
§ve
();

137 
IÁSize
 
	gtİLeá
, 
	gtİRight
, 
	gbÙtomLeá
, 
	gbÙtomRight
;

138 
¡yË
()->
g‘BÜd”RadiiFÜReù
(
bÜd”Reù
, 
tİLeá
, 
tİRight
, 
bÙtomLeá
, 
bÙtomRight
);

140 
	g·štInfo
.
	gcÚ‹xt
->
addRoundedReùCl
(
bÜd”Reù
, 
tİLeá
, 
tİRight
, 
bÙtomLeá
, 
bÙtomRight
);

144 ià(!
	gcom¶‘–yCl³dOut
) {

145 
·štR•Ïûd
(
·štInfo
, 
tx
, 
ty
);

147 ià(
¡yË
()->
hasBÜd”Radius
())

148 
	g·štInfo
.
	gcÚ‹xt
->
»¡Üe
();

153 ià(
	gd¿wS–eùiÚTšt
) {

154 
IÁReù
 
	g£ËùiÚPaštšgReù
 = 
loÿlS–eùiÚReù
();

155 
	g£ËùiÚPaštšgReù
.
move
(
tx
, 
ty
);

156 
	g·štInfo
.
	gcÚ‹xt
->
flReù
(
£ËùiÚPaštšgReù
, 
£ËùiÚBackgroundCŞÜ
(), 
¡yË
()->
cŞÜS·û
());

160 
boŞ
 
	gR’d”R•Ïûd
::
shouldPašt
(
PaštInfo
& 
·štInfo
, & 
tx
, & 
ty
)

162 ià(
	g·štInfo
.
	gpha£
 !ğ
PaštPha£FÜeground
 && 
·štInfo
.
pha£
 !ğ
PaštPha£Ouše
 &&…aštInfo.pha£ !ğ
PaštPha£S–fOuše


163 && 
·štInfo
.
pha£
 !ğ
PaštPha£S–eùiÚ
 &&…aštInfo.pha£ !ğ
PaštPha£Mask
)

164  
çl£
;

166 ià(!
shouldPaštW™hšRoÙ
(
·štInfo
))

167  
	gçl£
;

170 ià(
¡yË
()->
visib™y
(è!ğ
VISIBLE
)

171  
çl£
;

173 
	gcu¼’tTX
 = 
tx
 + 
x
();

174 
	gcu¼’tTY
 = 
ty
 + 
y
();

177 
	gtİ
 = 
cu¼’tTY
 + 
tİVisibËOv”æow
();

178 
	gbÙtom
 = 
cu¼’tTY
 + 
bÙtomVisibËOv”æow
();

179 ià(
isS–eùed
(è&& 
	gm_šlšeBoxW¿µ”
) {

180 
	g£lTİ
 = 
ty
 + 
m_šlšeBoxW¿µ”
->
roÙ
()->
£ËùiÚTİ
();

181 
	g£lBÙtom
 = 
ty
 + 
£lTİ
 + 
m_šlšeBoxW¿µ”
->
roÙ
()->
£ËùiÚHeight
();

182 
	gtİ
 = 
mš
(
£lTİ
, 
tİ
);

183 
	gbÙtom
 = 
max
(
£lBÙtom
, 
bÙtom
);

186 
	gos
 = 2 * 
maxim®OušeSize
(
·štInfo
.
pha£
);

187 ià(
	gcu¼’tTX
 + 
ËáVisibËOv”æow
(è>ğ
·štInfo
.
»ù
.
right
(è+ 
os
 || 
cu¼’tTX
 + 
rightVisibËOv”æow
(è<ğ·štInfo.»ù.
x
() - os)

188  
çl£
;

189 ià(
	gtİ
 >ğ
·štInfo
.
»ù
.
bÙtom
(è+ 
os
 || bÙtom <ğ·štInfo.»ù.
y
() - os)

190  
çl£
;

192  
	gŒue
;

195 
	gR’d”R•Ïûd
::
ÿlcP»fWidths
()

197 
ASSERT
(
´efWidthsDœty
());

199 
	g·ddšgAndBÜd”s
 = 
·ddšgLeá
(è+ 
·ddšgRight
(è+ 
bÜd”Leá
(è+ 
bÜd”Right
();

200 
	gwidth
 = 
ÿlcR•ÏûdWidth
(
çl£
è+ 
·ddšgAndBÜd”s
;

202 ià(
¡yË
()->
maxWidth
().
isFixed
(è&& styË()->maxWidth().
v®ue
(è!ğ
undefšedL’gth
)

203 
width
 = 
mš
(width, 
¡yË
()->
maxWidth
().
v®ue
(è+ (¡yË()->
boxSizšg
(è=ğ
CONTENT_BOX
 ? 
·ddšgAndBÜd”s
 : 0));

205 ià(
¡yË
()->
width
().
isP”ûÁ
(è|| (¡yË()->width().
isAuto
(è&& styË()->
height
().isPercent())) {

206 
	gm_mšP»fWidth
 = 0;

207 
	gm_maxP»fWidth
 = 
width
;

209 
	gm_mšP»fWidth
 = 
m_maxP»fWidth
 = 
width
;

211 
£tP»fWidthsDœty
(
çl£
);

214 
	gR’d”R•Ïûd
::
lšeHeight
(
boŞ
, bool) const

216  
height
(è+ 
m¬gšTİ
(è+ 
m¬gšBÙtom
();

219 
	gR’d”R•Ïûd
::
ba£lšePos™iÚ
(
boŞ
, bool) const

221  
height
(è+ 
m¬gšTİ
(è+ 
m¬gšBÙtom
();

224 
	gR’d”R•Ïûd
::
ÿ»tMaxR’d”edOff£t
() const

229 
VisibËPos™iÚ
 
	gR’d”R•Ïûd
::
pos™iÚFÜPošt
(cÚ¡ 
IÁPošt
& 
pošt
)

231 
IÆšeBox
* 
box
 = 
šlšeBoxW¿µ”
();

232 ià(!
	gbox
)

233  
ü—‹VisibËPos™iÚ
(0, 
DOWNSTREAM
);

237 
RoÙIÆšeBox
* 
	groÙ
 = 
box
->
roÙ
();

239 
	gtİ
 = 
roÙ
->
lšeTİ
();

240 
	gbÙtom
 = 
roÙ
->
ÃxtRoÙBox
(è?„oÙ->ÃxtRoÙBox()->
lšeTİ
(è:„oÙ->
lšeBÙtom
();

242 ià(
	gpošt
.
y
(è+ y(è< 
	gtİ
)

243  
ü—‹VisibËPos™iÚ
(
ÿ»tMšOff£t
(), 
DOWNSTREAM
);

245 ià(
	gpošt
.
y
(è+ y(è>ğ
bÙtom
)

246  
ü—‹VisibËPos™iÚ
(
ÿ»tMaxOff£t
(), 
DOWNSTREAM
);

248 ià(
node
()) {

249 ià(
	gpošt
.
x
(è<ğ
width
() / 2)

250  
ü—‹VisibËPos™iÚ
(0, 
DOWNSTREAM
);

251  
ü—‹VisibËPos™iÚ
(1, 
DOWNSTREAM
);

254  
	gR’d”Box
::
pos™iÚFÜPošt
(
pošt
);

257 
IÁReù
 
	gR’d”R•Ïûd
::
£ËùiÚReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
boŞ
 
şToVisibËCÚ‹Á
)

259 
ASSERT
(!
ÃedsLayout
());

261 ià(!
isS–eùed
())

262  
IÁReù
();

264 
IÁReù
 
	g»ù
 = 
loÿlS–eùiÚReù
();

265 ià(
	gşToVisibËCÚ‹Á
)

266 
compu‹ReùFÜR•ašt
(
»·štCÚš”
, 
»ù
);

268 
	g»ù
 = 
loÿlToCÚš”Quad
(
FlßtReù
(
»ù
), 
»·štCÚš”
).
’şosšgBoundšgBox
();

270  
	g»ù
;

273 
IÁReù
 
	gR’d”R•Ïûd
::
loÿlS–eùiÚReù
(
boŞ
 
checkWh‘h”S–eùed
) const

275 ià(
checkWh‘h”S–eùed
 && !
isS–eùed
())

276  
IÁReù
();

278 ià(!
	gm_šlšeBoxW¿µ”
)

280  
IÁReù
(0, 0, 
width
(), 
height
());

282 
R’d”Block
* 
	gcb
 = 
cÚššgBlock
();

283 ià(!
	gcb
)

284  
IÁReù
();

286 
RoÙIÆšeBox
* 
	groÙ
 = 
m_šlšeBoxW¿µ”
->
roÙ
();

287  
IÁReù
(0, 
roÙ
->
£ËùiÚTİ
(è- 
y
(), 
width
(),„oÙ->
£ËùiÚHeight
());

290 
	gR’d”R•Ïûd
::
£tS–eùiÚS‹
(
S–eùiÚS‹
 
s
)

292 
R’d”Box
::
£tS–eùiÚS‹
(
s
);

293 ià(
	gm_šlšeBoxW¿µ”
) {

294 
RoÙIÆšeBox
* 
	glše
 = 
m_šlšeBoxW¿µ”
->
roÙ
();

295 ià(
	glše
)

296 
	glše
->
£tHasS–eùedChd»n
(
isS–eùed
());

299 
cÚššgBlock
()->
£tS–eùiÚS‹
(
s
);

302 
boŞ
 
	gR’d”R•Ïûd
::
isS–eùed
() const

304 
S–eùiÚS‹
 
s
 = 
£ËùiÚS‹
();

305 ià(
	gs
 =ğ
S–eùiÚNÚe
)

306  
çl£
;

307 ià(
	gs
 =ğ
S–eùiÚInside
)

308  
Œue
;

310 
	g£ËùiÚS¹
, 
	g£ËùiÚEnd
;

311 
£ËùiÚS¹End
(
£ËùiÚS¹
, 
£ËùiÚEnd
);

312 ià(
	gs
 =ğ
S–eùiÚS¹
)

313  
£ËùiÚS¹
 == 0;

315 
	g’d
 = 
node
()->
hasChdNodes
(è?‚ode()->
chdNodeCouÁ
() : 1;

316 ià(
	gs
 =ğ
S–eùiÚEnd
)

317  
£ËùiÚEnd
 =ğ
’d
;

318 ià(
	gs
 =ğ
S–eùiÚBÙh
)

319  
£ËùiÚS¹
 =ğ0 && 
£ËùiÚEnd
 =ğ
’d
;

321 
ASSERT
(0);

322  
	gçl£
;

325 
IÁSize
 
	gR’d”R•Ïûd
::
šŒšsicSize
() const

327  
m_šŒšsicSize
;

330 
	gR’d”R•Ïûd
::
£tIÁršsicSize
(cÚ¡ 
IÁSize
& 
size
)

332 
m_šŒšsicSize
 = 
size
;

335 
IÁReù
 
	gR’d”R•Ïûd
::
ş³dOv”æowReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
)

337 ià(
¡yË
()->
visib™y
(è!ğ
VISIBLE
 && !
’şosšgLay”
()->
hasVisibËCÚ‹Á
())

338  
IÁReù
();

342 
IÁReù
 
	gr
 = 
uniÚReù
(
loÿlS–eùiÚReù
(
çl£
), 
visibËOv”æowReù
());

344 
R’d”V›w
* 
	gv
 = 
v›w
();

345 ià(
	gv
) {

348 
	gr
.
move
(
v
->
ÏyoutD–
());

351 ià(
¡yË
()) {

352 ià(
¡yË
()->
hasAµ—¿nû
())

354 
theme
()->
adju¡R•aštReù
(
this
, 
r
);

355 ià(
	gv
)

356 
	gr
.
šæ©e
(
¡yË
()->
oušeSize
());

358 
compu‹ReùFÜR•ašt
(
»·štCÚš”
, 
r
);

359  
	gr
;

	@RenderReplaced.h

22 #iâdeà
R’d”R•Ïûd_h


23 
	#R’d”R•Ïûd_h


	)

25 
	~"R’d”Box.h
"

27 
Çme¥aû
 
	gWebCÜe
 {

29 şas 
	cR’d”R•Ïûd
 : 
public
 
R’d”Box
 {

30 
public
:

31 
R’d”R•Ïûd
(
Node
*);

32 
R’d”R•Ïûd
(
Node
*, cÚ¡ 
IÁSize
& 
šŒšsicSize
);

33 
	gvœtu®
 ~
R’d”R•Ïûd
();

35 
	g´Ùeùed
:

36 
vœtu®
 
Ïyout
();

38 
vœtu®
 
IÁSize
 
šŒšsicSize
() const;

40 
vœtu®
 
£tS–eùiÚS‹
(
S–eùiÚS‹
);

42 
boŞ
 
isS–eùed
() const;

44 
vœtu®
 
¡yËDidChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
);

46 
£tIÁršsicSize
(cÚ¡ 
IÁSize
&);

47 
vœtu®
 
šŒšsicSizeChªged
();

49 
vœtu®
 
·št
(
PaštInfo
&, 
tx
, 
ty
);

50 
boŞ
 
shouldPašt
(
PaštInfo
&, & 
tx
, & 
ty
);

51 
IÁReù
 
loÿlS–eùiÚReù
(
boŞ
 
checkWh‘h”S–eùed
 = 
Œue
) const;

53 
	g´iv©e
:

54 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderReplaced"; }

56 
vœtu®
 
boŞ
 
ÿnHaveChd»n
(ècÚ¡ {  
	gçl£
; }

58 
vœtu®
 
lšeHeight
(
boŞ
 
fœ¡Lše
, boŞ 
isRoÙLšeBox
 = 
çl£
) const;

59 
vœtu®
 
ba£lšePos™iÚ
(
boŞ
 
fœ¡Lše
, boŞ 
isRoÙLšeBox
 = 
çl£
) const;

61 
vœtu®
 
ÿlcP»fWidths
();

63 
vœtu®
 
mšimumR•ÏûdHeight
() const {  0; }

65 
vœtu®
 
·štR•Ïûd
(
PaštInfo
&, , ) { }

67 
vœtu®
 
IÁReù
 
ş³dOv”æowReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
);

69 
vœtu®
 
ÿ»tMaxR’d”edOff£t
() const;

70 
vœtu®
 
VisibËPos™iÚ
 
pos™iÚFÜPošt
(cÚ¡ 
IÁPošt
&);

72 
vœtu®
 
boŞ
 
ÿnBeS–eùiÚL—f
(ècÚ¡ {  
	gŒue
; }

74 
vœtu®
 
IÁReù
 
£ËùiÚReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
boŞ
 
şToVisibËCÚ‹Á
 = 
Œue
);

76 
IÁSize
 
	gm_šŒšsicSize
;

	@RenderReplica.cpp

29 
	~"cÚfig.h
"

30 
	~"R’d”R•liÿ.h
"

32 
	~"R’d”Lay”.h
"

34 
Çme¥aû
 
	gWebCÜe
 {

36 
	gR’d”R•liÿ
::
R’d”R•liÿ
(
Node
* 
n
)

37 : 
R’d”Box
(
n
)

43 
£tR•Ïûd
(
Œue
);

46 
	gR’d”R•liÿ
::~
R’d”R•liÿ
()

49 
R’d”R•liÿ
::
Ïyout
()

51 
£tF¿meReù
(
·»ÁBox
()->
bÜd”BoxReù
());

52 
£tN“dsLayout
(
çl£
);

55 
	gR’d”R•liÿ
::
ÿlcP»fWidths
()

57 
m_mšP»fWidth
 = 
·»ÁBox
()->
width
();

58 
	gm_maxP»fWidth
 = 
m_mšP»fWidth
;

59 
£tP»fWidthsDœty
(
çl£
);

62 
	gR’d”R•liÿ
::
·št
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

64 ià(
	g·štInfo
.
	gpha£
 !ğ
PaštPha£FÜeground
 && 
·štInfo
.
pha£
 !ğ
PaštPha£Mask
)

67 
	gtx
 +ğ
x
();

68 
	gty
 +ğ
y
();

70 ià(
	g·štInfo
.
	gpha£
 =ğ
PaštPha£FÜeground
)

73 
Ïy”
()->
·»Á
()->
·štLay”
Öay”()->
ŒªsfÜm
(è?†ay”()->·»Á(è:†ay”()->
’şosšgT¿nsfÜmedAnû¡Ü
(),

74 
·štInfo
.
cÚ‹xt
,…aštInfo.
»ù
,

75 
PaštBehaviÜNÜm®
, 0, 0,

76 
R’d”Lay”
::
PaštLay”HaveT¿n¥¬’cy
 | R’d”Lay”::
PaštLay”Aµl›dT¿nsfÜm
 | R’d”Lay”::
PaštLay”TempÜ¬yClReùs
 | R’d”Lay”::
PaštLay”PaštšgReæeùiÚ
);

77 ià(
	g·štInfo
.
	gpha£
 =ğ
PaštPha£Mask
)

78 
·štMask
(
·štInfo
, 
tx
, 
ty
);

	@RenderReplica.h

29 #iâdeà
R’d”R•liÿ_h


30 
	#R’d”R•liÿ_h


	)

32 
	~"R’d”Box.h
"

34 
Çme¥aû
 
	gWebCÜe
 {

36 şas 
	cR’d”R•liÿ
 : 
public
 
R’d”Box
 {

37 
public
:

38 
R’d”R•liÿ
(
Node
*);

39 
	gvœtu®
 ~
R’d”R•liÿ
();

41 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderReplica"; }

43 
vœtu®
 
boŞ
 
»quœesLay”
(ècÚ¡ {  
	gŒue
; }

45 
vœtu®
 
Ïyout
();

46 
vœtu®
 
ÿlcP»fWidths
();

48 
vœtu®
 
·št
(
PaštInfo
&, 
tx
, 
ty
);

50 
	g´iv©e
:

51 
vœtu®
 
boŞ
 
isR•liÿ
(ècÚ¡ {  
Œue
; }

	@RenderRuby.cpp

31 
	~"cÚfig.h
"

33 #ià
ENABLE
(
RUBY
)

34 
	~"R’d”Ruby.h
"

36 
	~"R’d”RubyRun.h
"

38 
Çme¥aû
 
	gWebCÜe
 {

42 
R’d”RubyRun
* 
Ï¡RubyRun
(cÚ¡ 
R’d”Objeù
* 
ruby
)

44 
R’d”Objeù
* 
	gchd
 = 
ruby
->
Ï¡Chd
();

45 ià(
	gchd
 && 
	gruby
->
isAá”CÚ‹Á
(
chd
))

46 
	gchd
 = 
chd
->
´eviousSiblšg
();

47 
ASSERT
(!
chd
 || chd->
isRubyRun
());

48  
	g¡©ic_ÿ¡
<
	gR’d”RubyRun
*>(
	gchd
);

51 
šlše
 
R’d”RubyRun
* 
fšdRubyRunP¬’t
(
R’d”Objeù
* 
chd
)

53 
	gchd
 && !chd->
isRubyRun
())

54 
	gchd
 = 
chd
->
·»Á
();

55  
	g¡©ic_ÿ¡
<
	gR’d”RubyRun
*>(
	gchd
);

60 
	gR’d”RubyAsIÆše
::
R’d”RubyAsIÆše
(
Node
* 
node
)

61 : 
R’d”IÆše
(
node
)

65 
R’d”RubyAsIÆše
::~RenderRubyAsInline()

69 
boŞ
 
R’d”RubyAsIÆše
::
isChdAÎowed
(
R’d”Objeù
* 
chd
, 
R’d”StyË
*) const

71  
	gchd
->
isRubyText
()

72 || 
	gchd
->
isRubyRun
()

73 || 
	gchd
->
isIÆše
();

76 
	gR’d”RubyAsIÆše
::
addChd
(
R’d”Objeù
* 
chd
, R’d”Objeù* 
befÜeChd
)

81 ià(
	gchd
->
isRubyRun
()) {

82 
	gR’d”IÆše
::
addChd
(
chd
, 
befÜeChd
);

86 ià(
	gbefÜeChd
 && !
isAá”CÚ‹Á
(
befÜeChd
)) {

88 
ASSERT
(!
befÜeChd
->
isRubyRun
());

89 
R’d”RubyRun
* 
	grun
 = 
fšdRubyRunP¬’t
(
befÜeChd
);

90 
ASSERT
(
run
);

91 ià(
	grun
) {

92 
	grun
->
addChd
(
chd
, 
befÜeChd
);

95 
ASSERT
(
çl£
);

102 
R’d”RubyRun
* 
	gÏ¡Run
 = 
Ï¡RubyRun
(
this
);

103 ià(!
	gÏ¡Run
 ||†a¡Run->
hasRubyText
()) {

104 
	gÏ¡Run
 = 
R’d”RubyRun
::
¡©icC»©eRubyRun
(
this
);

105 
	gR’d”IÆše
::
addChd
(
Ï¡Run
);

107 
	gÏ¡Run
->
addChd
(
chd
);

110 
	gR’d”RubyAsIÆše
::
»moveChd
(
R’d”Objeù
* 
chd
)

114 ià(
chd
->
·»Á
(è=ğ
this
) {

115 
ASSERT
(
chd
->
isRubyRun
(è|| chd->
isAá”CÚ‹Á
());

116 
	gR’d”IÆše
::
»moveChd
(
chd
);

121 
R’d”RubyRun
* 
	grun
 = 
fšdRubyRunP¬’t
(
chd
);

122 
ASSERT
(
run
);

123 
	grun
->
»moveChd
(
chd
);

129 
	gR’d”RubyAsBlock
::
R’d”RubyAsBlock
(
Node
* 
node
)

130 : 
R’d”Block
(
node
)

134 
R’d”RubyAsBlock
::~RenderRubyAsBlock()

138 
boŞ
 
R’d”RubyAsBlock
::
isChdAÎowed
(
R’d”Objeù
* 
chd
, 
R’d”StyË
*) const

140  
	gchd
->
isRubyText
()

141 || 
	gchd
->
isRubyRun
()

142 || 
	gchd
->
isIÆše
();

145 
	gR’d”RubyAsBlock
::
addChd
(
R’d”Objeù
* 
chd
, R’d”Objeù* 
befÜeChd
)

150 ià(
	gchd
->
isRubyRun
()) {

151 
	gR’d”Block
::
addChd
(
chd
, 
befÜeChd
);

155 ià(
	gbefÜeChd
 && !
isAá”CÚ‹Á
(
befÜeChd
)) {

157 
ASSERT
(!
befÜeChd
->
isRubyRun
());

158 
R’d”Objeù
* 
	grun
 = 
befÜeChd
;

159 
	grun
 && !run->
isRubyRun
())

160 
	grun
 = 
run
->
·»Á
();

161 ià(
	grun
) {

162 
	grun
->
addChd
(
chd
, 
befÜeChd
);

165 
ASSERT
(
çl£
);

172 
R’d”RubyRun
* 
	gÏ¡Run
 = 
Ï¡RubyRun
(
this
);

173 ià(!
	gÏ¡Run
 ||†a¡Run->
hasRubyText
()) {

174 
	gÏ¡Run
 = 
R’d”RubyRun
::
¡©icC»©eRubyRun
(
this
);

175 
	gR’d”Block
::
addChd
(
Ï¡Run
);

177 
	gÏ¡Run
->
addChd
(
chd
);

180 
	gR’d”RubyAsBlock
::
»moveChd
(
R’d”Objeù
* 
chd
)

183 ià(
chd
->
·»Á
(è=ğ
this
) {

185 
R’d”Block
::
»moveChd
(
chd
);

190 
R’d”RubyRun
* 
	grun
 = 
fšdRubyRunP¬’t
(
chd
);

191 
ASSERT
(
run
);

192 
	grun
->
»moveChd
(
chd
);

	@RenderRuby.h

31 #iâdeà
R’d”Ruby_h


32 
	#R’d”Ruby_h


	)

34 #ià
ENABLE
(
RUBY
)

36 
	~"R’d”Block.h
"

37 
	~"R’d”IÆše.h
"

39 
Çme¥aû
 
	gWebCÜe
 {

54 şas 
	cR’d”RubyAsIÆše
 : 
public
 
R’d”IÆše
 {

55 
public
:

56 
R’d”RubyAsIÆše
(
Node
*);

57 
	gvœtu®
 ~
R’d”RubyAsIÆše
();

59 
vœtu®
 
boŞ
 
isChdAÎowed
(
R’d”Objeù
*, 
R’d”StyË
*) const;

60 
vœtu®
 
addChd
(
R’d”Objeù
* 
chd
, R’d”Objeù* 
befÜeChd
 = 0);

61 
vœtu®
 
»moveChd
(
R’d”Objeù
* 
chd
);

63 
	g´iv©e
:

64 
vœtu®
 
boŞ
 
isRuby
(ècÚ¡ {  
Œue
; }

65 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderRuby (inline)"; }

66 
vœtu®
 
boŞ
 
ü—‹sAnÚymousW¿µ”
(ècÚ¡ {  
	gŒue
; }

67 
vœtu®
 
»moveLeáov”AnÚymousBlock
(
R’d”Block
*è{ 
ASSERT_NOT_REACHED
(); }

71 şas 
	cR’d”RubyAsBlock
 : 
public
 
R’d”Block
 {

72 
public
:

73 
R’d”RubyAsBlock
(
Node
*);

74 
	gvœtu®
 ~
R’d”RubyAsBlock
();

76 
vœtu®
 
boŞ
 
isChdAÎowed
(
R’d”Objeù
*, 
R’d”StyË
*) const;

77 
vœtu®
 
addChd
(
R’d”Objeù
* 
chd
, R’d”Objeù* 
befÜeChd
 = 0);

78 
vœtu®
 
»moveChd
(
R’d”Objeù
* 
chd
);

80 
	g´iv©e
:

81 
vœtu®
 
boŞ
 
isRuby
(ècÚ¡ {  
Œue
; }

82 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderRuby (block)"; }

83 
vœtu®
 
boŞ
 
ü—‹sAnÚymousW¿µ”
(ècÚ¡ {  
	gŒue
; }

84 
vœtu®
 
»moveLeáov”AnÚymousBlock
(
R’d”Block
*è{ 
ASSERT_NOT_REACHED
(); }

	@RenderRubyBase.cpp

31 
	~"cÚfig.h
"

33 #ià
ENABLE
(
RUBY
)

34 
	~"R’d”RubyBa£.h
"

36 
Çme¥aû
 
	gWebCÜe
 {

38 
	gR’d”RubyBa£
::
R’d”RubyBa£
(
Node
* 
node
)

39 : 
R’d”Block
(
node
)

41 
£tIÆše
(
çl£
);

44 
	gR’d”RubyBa£
::~
R’d”RubyBa£
()

48 
boŞ
 
R’d”RubyBa£
::
isChdAÎowed
(
R’d”Objeù
* 
chd
, 
R’d”StyË
*) const

50  
	gchd
->
isIÆše
();

53 
boŞ
 
	gR’d”RubyBa£
::
hasOÆyW¿µedIÆšeChd»n
(
R’d”Objeù
* 
befÜeChd
) const

58 
R’d”Objeù
* 
chd
 = 
fœ¡Chd
(); 
	gchd
 !ğ
befÜeChd
; chd = chd->
ÃxtSiblšg
()) {

59 ià(!
chd
->
isFlßtšgOrPos™iÚed
(è&& !(chd->
isAnÚymousBlock
(è&& chd->
chd»nIÆše
()))

60  
çl£
;

62  
	gŒue
;

65 
	gR’d”RubyBa£
::
moveChd»n
(
R’d”RubyBa£
* 
toBa£
, 
R’d”Objeù
* 
äomBefÜeChd
)

69 
ASSERT
(
toBa£
);

75 
	gäomBefÜeChd
 && fromBefÜeChd->
·»Á
(è!ğ
this
)

76 
äomBefÜeChd
 = fromBefÜeChd->
·»Á
();

78 ià(
chd»nIÆše
())

79 
moveIÆšeChd»n
(
toBa£
, 
äomBefÜeChd
);

81 
moveBlockChd»n
(
toBa£
, 
äomBefÜeChd
);

83 
£tN“dsLayoutAndP»fWidthsReÿlc
();

84 
	gtoBa£
->
£tN“dsLayoutAndP»fWidthsReÿlc
();

87 
	gR’d”RubyBa£
::
moveIÆšeChd»n
(
R’d”RubyBa£
* 
toBa£
, 
R’d”Objeù
* 
äomBefÜeChd
)

89 
R’d”Block
* 
	gtoBlock
;

91 ià(
	gtoBa£
->
chd»nIÆše
()) {

93 
	gtoBlock
 = 
toBa£
;

97 
R’d”Objeù
* 
	gÏ¡Chd
 = 
toBa£
->
Ï¡Chd
();

98 ià(
	gÏ¡Chd
 &&†a¡Chd->
isAnÚymousBlock
(è&&†a¡Chd->
chd»nIÆše
())

99 
	gtoBlock
 = 
toR’d”Block
(
Ï¡Chd
);

101 
	gtoBlock
 = 
toBa£
->
ü—‹AnÚymousBlock
();

102 
	gtoBa£
->
chd»n
()->
­³ndChdNode
(
toBa£
, 
toBlock
);

106 
R’d”Objeù
* 
	gchd
 = 
fœ¡Chd
(); chd !ğ
äomBefÜeChd
; child = firstChild())

107 
moveChdTo
(
toBlock
,oBlock->
chd»n
(), 
chd
);

110 
	gR’d”RubyBa£
::
moveBlockChd»n
(
R’d”RubyBa£
* 
toBa£
, 
R’d”Objeù
* 
äomBefÜeChd
)

112 ià(
	gtoBa£
->
chd»nIÆše
()) {

114 ià(
hasOÆyW¿µedIÆšeChd»n
(
äomBefÜeChd
)) {

117 
R’d”Objeù
* 
	gchd
 = 
fœ¡Chd
(); chd !ğ
äomBefÜeChd
; child = firstChild()) {

118 ià(
chd
->
isAnÚymousBlock
()) {

119 
R’d”Block
* 
ªÚBlock
 = 
toR’d”Block
(
chd
);

120 
ASSERT
(
ªÚBlock
->
chd»nIÆše
());

121 
ASSERT
(!
ªÚBlock
->
šlšeCÚtšu©iÚ
());

122 
	gªÚBlock
->
moveAÎChd»nTo
(
toBa£
,oBa£->
chd»n
());

123 
	gªÚBlock
->
d–‘eLšeBoxT»e
();

124 
	gªÚBlock
->
de¡roy
();

126 
ASSERT
(
chd
->
isFlßtšgOrPos™iÚed
());

127 
moveChdTo
(
toBa£
,oBa£->
chd»n
(), 
chd
);

132 
	gtoBa£
->
makeChd»nNÚIÆše
();

134 
m”geBlockChd»n
(
toBa£
, 
äomBefÜeChd
);

138 ià(
hasOÆyW¿µedIÆšeChd»n
()) {

139 
R’d”Objeù
* 
	gÃxt
 = 0;

140 
R’d”Objeù
* 
	gchd
 = 
fœ¡Chd
(); chd; chd = 
Ãxt
) {

141 
Ãxt
 = 
chd
->
ÃxtSiblšg
();

142 ià(
	gchd
->
isFlßtšgOrPos™iÚed
())

144 
ASSERT
(
chd
->
isAnÚymousBlock
());

146 
R’d”Block
* 
	gªÚBlock
 = 
toR’d”Block
(
chd
);

147 
ASSERT
(
ªÚBlock
->
chd»nIÆše
());

148 
ASSERT
(!
ªÚBlock
->
šlšeCÚtšu©iÚ
());

150 
	gªÚBlock
->
moveAÎChd»nTo
(
this
, 
chd»n
(), 
ªÚBlock
);

151 
	gªÚBlock
->
d–‘eLšeBoxT»e
();

152 
	gªÚBlock
->
de¡roy
();

154 
£tChd»nIÆše
(
Œue
);

158 
m”geBlockChd»n
(
toBa£
, 
äomBefÜeChd
);

161 
	gR’d”RubyBa£
::
m”geBlockChd»n
(
R’d”RubyBa£
* 
toBa£
, 
R’d”Objeù
* 
äomBefÜeChd
)

164 
ASSERT
(!
chd»nIÆše
());

165 
ASSERT
(
toBa£
);

166 
ASSERT
(!
toBa£
->
chd»nIÆše
());

169 ià(
	gäomBefÜeChd
 !ğ
fœ¡Chd
())

173 
R’d”Objeù
* 
	gfœ¡ChdH”e
 = 
fœ¡Chd
();

174 
R’d”Objeù
* 
	gÏ¡ChdTh”e
 = 
toBa£
->
Ï¡Chd
();

175 ià(
	gfœ¡ChdH”e
 && fœ¡ChdH”e->
isAnÚymousBlock
(è&& fœ¡ChdH”e->
chd»nIÆše
()

176 && 
	gÏ¡ChdTh”e
 &&†a¡ChdTh”e->
isAnÚymousBlock
(è&&†a¡ChdTh”e->
chd»nIÆše
()) {

177 
R’d”Block
* 
	gªÚBlockH”e
 = 
toR’d”Block
(
fœ¡ChdH”e
);

178 
R’d”Block
* 
	gªÚBlockTh”e
 = 
toR’d”Block
(
Ï¡ChdTh”e
);

179 
	gªÚBlockH”e
->
moveAÎChd»nTo
(
ªÚBlockTh”e
,‡nÚBlockTh”e->
chd»n
());

180 
	gªÚBlockH”e
->
d–‘eLšeBoxT»e
();

181 
	gªÚBlockH”e
->
de¡roy
();

184 
R’d”Objeù
* 
	gchd
 = 
fœ¡Chd
(); chd !ğ
äomBefÜeChd
; child = firstChild())

185 
moveChdTo
(
toBa£
,oBa£->
chd»n
(), 
chd
);

	@RenderRubyBase.h

31 #iâdeà
R’d”RubyBa£_h


32 
	#R’d”RubyBa£_h


	)

34 #ià
ENABLE
(
RUBY
)

36 
	~"R’d”Block.h
"

38 
Çme¥aû
 
	gWebCÜe
 {

40 şas 
	cR’d”RubyBa£
 : 
public
 
R’d”Block
 {

41 
public
:

42 
R’d”RubyBa£
(
Node
*);

43 
	gvœtu®
 ~
R’d”RubyBa£
();

45 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderRubyBase (anonymous)"; }

47 
vœtu®
 
boŞ
 
isRubyBa£
(ècÚ¡ {  
	gŒue
; }

49 
vœtu®
 
boŞ
 
isChdAÎowed
(
R’d”Objeù
*, 
R’d”StyË
*) const;

51 
	g´iv©e
:

52 
boŞ
 
hasOÆyW¿µedIÆšeChd»n
(
R’d”Objeù
* 
befÜeChd
 = 0) const;

54 
moveChd»n
(
R’d”RubyBa£
* 
toBa£
, 
R’d”Objeù
* 
äomBefÜeChd
 = 0);

55 
moveIÆšeChd»n
(
R’d”RubyBa£
* 
toBa£
, 
R’d”Objeù
* 
äomBefÜeChd
 = 0);

56 
moveBlockChd»n
(
R’d”RubyBa£
* 
toBa£
, 
R’d”Objeù
* 
äomBefÜeChd
 = 0);

57 
m”geBlockChd»n
(
R’d”RubyBa£
* 
toBa£
, 
R’d”Objeù
* 
äomBefÜeChd
 = 0);

60 
ä›nd
 
şass
 
	gR’d”RubyRun
;

	@RenderRubyRun.cpp

31 
	~"cÚfig.h
"

33 #ià
ENABLE
(
RUBY
)

34 
	~"R’d”RubyRun.h
"

36 
	~"R’d”RubyBa£.h
"

37 
	~"R’d”RubyText.h
"

38 
	~"R’d”V›w.h
"

40 
usšg
 
Çme¥aû
 
	g¡d
;

42 
Çme¥aû
 
	gWebCÜe
 {

44 
	gR’d”RubyRun
::
R’d”RubyRun
(
Node
* 
node
)

45 : 
R’d”Block
(
node
)

46 , 
m_bešgDe¡royed
(
çl£
)

48 
£tR•Ïûd
(
Œue
);

49 
£tIÆše
(
Œue
);

52 
	gR’d”RubyRun
::~
R’d”RubyRun
()

56 
R’d”RubyRun
::
de¡roy
()

59 
m_bešgDe¡royed
 = 
Œue
;

60 
	gR’d”Block
::
de¡roy
();

63 
boŞ
 
	gR’d”RubyRun
::
hasRubyText
() const

67  
fœ¡Chd
(è&& fœ¡Chd()->
isRubyText
();

70 
boŞ
 
	gR’d”RubyRun
::
hasRubyBa£
() const

74  
Ï¡Chd
(è&&†a¡Chd()->
isRubyBa£
();

77 
boŞ
 
	gR’d”RubyRun
::
isEm±y
() const

79  !
hasRubyText
(è&& !
hasRubyBa£
();

82 
R’d”RubyText
* 
	gR’d”RubyRun
::
rubyText
() const

84 
R’d”Objeù
* 
chd
 = 
fœ¡Chd
();

85  
	gchd
 && chd->
isRubyText
(è? 
	g¡©ic_ÿ¡
<
	gR’d”RubyText
*>(child) : 0;

88 
R’d”RubyBa£
* 
	gR’d”RubyRun
::
rubyBa£
() const

90 
R’d”Objeù
* 
chd
 = 
Ï¡Chd
();

91  
	gchd
 && chd->
isRubyBa£
(è? 
	g¡©ic_ÿ¡
<
	gR’d”RubyBa£
*>(child) : 0;

94 
R’d”RubyBa£
* 
	gR’d”RubyRun
::
rubyBa£Saã
()

96 
R’d”RubyBa£
* 
ba£
 = 
rubyBa£
();

97 ià(!
	gba£
) {

98 
	gba£
 = 
ü—‹RubyBa£
();

99 
	gR’d”Block
::
addChd
(
ba£
);

101  
	gba£
;

104 
R’d”Block
* 
	gR’d”RubyRun
::
fœ¡LšeBlock
() const

109 
	gR’d”RubyRun
::
upd©eFœ¡L‘‹r
()

113 
boŞ
 
R’d”RubyRun
::
isChdAÎowed
(
R’d”Objeù
* 
chd
, 
R’d”StyË
*) const

115  
	gchd
->
isRubyText
(è|| chd->
isIÆše
();

118 
	gR’d”RubyRun
::
addChd
(
R’d”Objeù
* 
chd
, R’d”Objeù* 
befÜeChd
)

120 
ASSERT
(
chd
);

123 ià(
	gchd
->
isRubyText
()) {

124 ià(!
	gbefÜeChd
) {

126 
ASSERT
(!
hasRubyText
());

128 
	gR’d”Block
::
addChd
(
chd
, 
fœ¡Chd
());

129 } ià(
	gbefÜeChd
->
isRubyText
()) {

133 
ASSERT
(
befÜeChd
->
·»Á
(è=ğ
this
);

134 
R’d”Objeù
* 
	gruby
 = 
·»Á
();

135 
ASSERT
(
ruby
->
isRuby
());

136 
R’d”Block
* 
	gÃwRun
 = 
¡©icC»©eRubyRun
(
ruby
);

137 
	gruby
->
addChd
(
ÃwRun
, 
ÃxtSiblšg
());

142 
	gR’d”Block
::
addChd
(
chd
, 
befÜeChd
);

143 
	gR’d”Block
::
»moveChd
(
befÜeChd
);

144 
	gÃwRun
->
addChd
(
befÜeChd
);

146 
ASSERT
(
hasRubyBa£
());

149 
R’d”Objeù
* 
	gruby
 = 
·»Á
();

150 
R’d”RubyRun
* 
	gÃwRun
 = 
¡©icC»©eRubyRun
(
ruby
);

151 
	gruby
->
addChd
(
ÃwRun
, 
this
);

152 
	gÃwRun
->
addChd
(
chd
);

153 
rubyBa£Saã
()->
moveChd»n
(
ÃwRun
->rubyBa£Saã(), 
befÜeChd
);

158 ià(
	gbefÜeChd
 && befÜeChd->
isRubyText
())

159 
	gbefÜeChd
 = 0;

160 
rubyBa£Saã
()->
addChd
(
chd
, 
befÜeChd
);

164 
	gR’d”RubyRun
::
»moveChd
(
R’d”Objeù
* 
chd
)

168 ià(!
m_bešgDe¡royed
 && !
docum’tBešgDe¡royed
(è&& 
chd
->
isRubyText
()) {

169 
R’d”RubyBa£
* 
ba£
 = 
rubyBa£
();

170 
R’d”Objeù
* 
	grightNeighbour
 = 
ÃxtSiblšg
();

171 ià(
	gba£
 && 
	grightNeighbour
 &&„ightNeighbour->
isRubyRun
()) {

173 
R’d”RubyRun
* 
	grightRun
 = 
¡©ic_ÿ¡
<R’d”RubyRun*>(
rightNeighbour
);

174 
ASSERT
(
rightRun
->
hasRubyBa£
());

175 
R’d”RubyBa£
* 
	grightBa£
 = 
rightRun
->
rubyBa£Saã
();

177 
	grightBa£
->
moveChd»n
(
ba£
);

178 
moveChdTo
(
rightRun
,„ightRun->
chd»n
(), 
ba£
);

179 
	grightRun
->
moveChdTo
(
this
, 
chd»n
(), 
rightBa£
);

184 
	gR’d”Block
::
»moveChd
(
chd
);

186 ià(!
	gm_bešgDe¡royed
 && !
docum’tBešgDe¡royed
()) {

188 
R’d”Block
* 
	gba£
 = 
rubyBa£
();

189 ià(
	gba£
 && !ba£->
fœ¡Chd
()) {

190 
	gR’d”Block
::
»moveChd
(
ba£
);

191 
	gba£
->
d–‘eLšeBoxT»e
();

192 
	gba£
->
de¡roy
();

196 ià(
isEm±y
()) {

197 
·»Á
()->
»moveChd
(
this
);

198 
d–‘eLšeBoxT»e
();

199 
de¡roy
();

204 
R’d”RubyBa£
* 
	gR’d”RubyRun
::
ü—‹RubyBa£
() const

206 
R’d”RubyBa£
* 
rb
 = 
Ãw
 (
»nd”A»Ç
()èR’d”RubyBa£(
docum’t
() );

207 
	gRefPŒ
<
	gR’d”StyË
> 
	gÃwStyË
 = 
R’d”StyË
::
ü—‹
();

208 
	gÃwStyË
->
šh”™From
(
¡yË
());

209 
	gÃwStyË
->
£tDi¥Ïy
(
BLOCK
);

210 
	gÃwStyË
->
£tTextAlign
(
CENTER
);

211 
	grb
->
£tStyË
(
ÃwStyË
.
»Ëa£
());

212  
	grb
;

215 
R’d”RubyRun
* 
	gR’d”RubyRun
::
¡©icC»©eRubyRun
(cÚ¡ 
R’d”Objeù
* 
·»ÁRuby
)

217 
ASSERT
(
·»ÁRuby
 &&…¬’tRuby->
isRuby
());

218 
R’d”RubyRun
* 
	g¼
 = 
Ãw
 (
·»ÁRuby
->
»nd”A»Ç
()èR’d”RubyRunÕ¬’tRuby->
docum’t
() );

219 
	gRefPŒ
<
	gR’d”StyË
> 
	gÃwStyË
 = 
R’d”StyË
::
ü—‹
();

220 
	gÃwStyË
->
šh”™From
(
·»ÁRuby
->
¡yË
());

221 
	gÃwStyË
->
£tDi¥Ïy
(
INLINE_BLOCK
);

222 
	g¼
->
£tStyË
(
ÃwStyË
.
»Ëa£
());

223  
	g¼
;

	@RenderRubyRun.h

31 #iâdeà
R’d”RubyRun_h


32 
	#R’d”RubyRun_h


	)

34 #ià
ENABLE
(
RUBY
)

36 
	~"R’d”Block.h
"

38 
Çme¥aû
 
	gWebCÜe
 {

40 
şass
 
	gR’d”RubyBa£
;

41 
şass
 
	gR’d”RubyText
;

46 şas 
	cR’d”RubyRun
 : 
public
 
R’d”Block
 {

47 
public
:

48 
R’d”RubyRun
(
Node
*);

49 
	gvœtu®
 ~
R’d”RubyRun
();

51 
vœtu®
 
de¡roy
();

53 
boŞ
 
hasRubyText
() const;

54 
boŞ
 
hasRubyBa£
() const;

55 
boŞ
 
isEm±y
() const;

56 
R’d”RubyText
* 
rubyText
() const;

57 
R’d”RubyBa£
* 
rubyBa£
() const;

58 
R’d”RubyBa£
* 
rubyBa£Saã
();

60 
vœtu®
 
boŞ
 
isChdAÎowed
(
R’d”Objeù
*, 
R’d”StyË
*) const;

61 
vœtu®
 
addChd
(
R’d”Objeù
* 
chd
, R’d”Objeù* 
befÜeChd
 = 0);

62 
vœtu®
 
»moveChd
(
R’d”Objeù
* 
chd
);

64 
vœtu®
 
R’d”Block
* 
fœ¡LšeBlock
() const;

65 
vœtu®
 
upd©eFœ¡L‘‹r
();

67 
R’d”RubyRun
* 
¡©icC»©eRubyRun
(cÚ¡ 
R’d”Objeù
* 
·»ÁRuby
);

69 
	g´Ùeùed
:

70 
R’d”RubyBa£
* 
ü—‹RubyBa£
() const;

72 
	g´iv©e
:

73 
vœtu®
 
boŞ
 
isRubyRun
(ècÚ¡ {  
Œue
; }

74 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderRubyRun (anonymous)"; }

75 
vœtu®
 
boŞ
 
ü—‹sAnÚymousW¿µ”
(ècÚ¡ {  
	gŒue
; }

76 
vœtu®
 
»moveLeáov”AnÚymousBlock
(
R’d”Block
*) { }

78 
boŞ
 
	gm_bešgDe¡royed
;

	@RenderRubyText.cpp

31 
	~"cÚfig.h
"

33 #ià
ENABLE
(
RUBY
)

34 
	~"R’d”RubyText.h
"

36 
Çme¥aû
 
	gWebCÜe
 {

38 
	gR’d”RubyText
::
R’d”RubyText
(
Node
* 
node
)

39 : 
R’d”Block
(
node
)

43 
R’d”RubyText
::~RenderRubyText()

47 
boŞ
 
R’d”RubyText
::
isChdAÎowed
(
R’d”Objeù
* 
chd
, 
R’d”StyË
*) const

49  
	gchd
->
isIÆše
();

	@RenderRubyText.h

31 #iâdeà
R’d”RubyText_h


32 
	#R’d”RubyText_h


	)

34 #ià
ENABLE
(
RUBY
)

36 
	~"R’d”Block.h
"

38 
Çme¥aû
 
	gWebCÜe
 {

40 şas 
	cR’d”RubyText
 : 
public
 
R’d”Block
 {

41 
public
:

42 
R’d”RubyText
(
Node
*);

43 
	gvœtu®
 ~
R’d”RubyText
();

45 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderRubyText"; }

47 
vœtu®
 
boŞ
 
isRubyText
(ècÚ¡ {  
	gŒue
; }

49 
vœtu®
 
boŞ
 
isChdAÎowed
(
R’d”Objeù
*, 
R’d”StyË
*) const;

	@RenderSVGBlock.cpp

23 
	~"cÚfig.h
"

25 #ià
ENABLE
(
SVG
)

26 
	~"R’d”SVGBlock.h
"

28 
	~"SVGEËm’t.h
"

30 
Çme¥aû
 
	gWebCÜe
 {

32 
	gR’d”SVGBlock
::
R’d”SVGBlock
(
SVGEËm’t
* 
node
)

33 : 
R’d”Block
(
node
)

37 
R’d”SVGBlock
::
£tStyË
(
PassRefPŒ
<
R’d”StyË
> 
¡yË
)

39 
RefPŒ
<
R’d”StyË
> 
u£StyË
 = 
¡yË
;

42 ià(
	gu£StyË
->
isDi¥ÏyIÆšeTy³
()) {

43 
	gRefPŒ
<
	gR’d”StyË
> 
	gÃwStyË
 = 
R’d”StyË
::
ü—‹
();

44 
	gÃwStyË
->
šh”™From
(
u£StyË
.
g‘
());

45 
	gÃwStyË
->
£tDi¥Ïy
(
BLOCK
);

46 
	gu£StyË
 = 
ÃwStyË
.
»Ëa£
();

49 
	gR’d”Block
::
£tStyË
(
u£StyË
.
»Ëa£
());

52 
	gR’d”SVGBlock
::
upd©eBoxMod–InfoFromStyË
()

54 
R’d”Block
::
upd©eBoxMod–InfoFromStyË
();

68 
£tHasOv”æowCl
(
çl£
);

	@RenderSVGBlock.h

21 #iâdeà
R’d”SVGBlock_h


22 
	#R’d”SVGBlock_h


	)

24 #ià
ENABLE
(
SVG
)

25 
	~"R’d”Block.h
"

26 
	~"SVGR’d”SuµÜt.h
"

28 
Çme¥aû
 
	gWebCÜe
 {

30 
şass
 
	gSVGEËm’t
;

32 
şass
 
	gR’d”SVGBlock
 : 
public
 
R’d”Block
, 
´Ùeùed
 
	gSVGR’d”Ba£
 {

33 
	gpublic
:

34 
R’d”SVGBlock
(
SVGEËm’t
*);

36 
vœtu®
 cÚ¡ 
SVGR’d”Ba£
* 
toSVGR’d”Ba£
(ècÚ¡ {  
	gthis
; }

38 
	g´iv©e
:

39 
vœtu®
 
£tStyË
(
PassRefPŒ
<
R’d”StyË
>);

40 
vœtu®
 
upd©eBoxMod–InfoFromStyË
();

	@RenderSVGContainer.cpp

24 
	~"cÚfig.h
"

26 #ià
ENABLE
(
SVG
)

27 
	~"R’d”SVGCÚš”.h
"

29 
	~"G¿phicsCÚ‹xt.h
"

30 
	~"R’d”V›w.h
"

31 
	~"SVGR’d”SuµÜt.h
"

32 
	~"SVGResourûF‹r.h
"

33 
	~"SVGStyËdEËm’t.h
"

35 
Çme¥aû
 
	gWebCÜe
 {

37 
	gR’d”SVGCÚš”
::
R’d”SVGCÚš”
(
SVGStyËdEËm’t
* 
node
)

38 : 
R’d”SVGMod–Objeù
(
node
)

39 , 
m_d¿wsCÚ‹Ás
(
Œue
)

43 
boŞ
 
	gR’d”SVGCÚš”
::
d¿wsCÚ‹Ás
() const

45  
m_d¿wsCÚ‹Ás
;

48 
	gR’d”SVGCÚš”
::
£tD¿wsCÚ‹Ás
(
boŞ
 
d¿wsCÚ‹Ás
)

50 
m_d¿wsCÚ‹Ás
 = 
d¿wsCÚ‹Ás
;

53 
	gR’d”SVGCÚš”
::
Ïyout
()

55 
ASSERT
(
ÃedsLayout
());

56 
ASSERT
(!
v›w
()->
ÏyoutS‹EÇbËd
());

58 
ÿlcV›wpÜt
();

60 
LayoutR•aš‹r
 
»·š‹r
(*
this
, 
checkFÜR•aštDuršgLayout
(è|| 
£lfWlPašt
());

61 
ÿlcuÏ‹LoÿlT¿nsfÜm
();

63 
ÏyoutChd»n
(
this
, 
£lfN“dsLayout
());

64 
	g»·š‹r
.
»·štAá”Layout
();

66 
£tN“dsLayout
(
çl£
);

69 
boŞ
 
	gR’d”SVGCÚš”
::
£lfWlPašt
() const

71 #ià
ENABLE
(
FILTERS
)

72 cÚ¡ 
SVGR’d”StyË
* 
svgStyË
 = 
¡yË
()->svgStyle();

73 
SVGResourûF‹r
* 
	gf‹r
 = 
g‘F‹rById
(
docum’t
(), 
svgStyË
->
f‹r
(), 
this
);

74 ià(
	gf‹r
)

75  
	gŒue
;

77  
	gçl£
;

80 
	gR’d”SVGCÚš”
::
·št
(
PaštInfo
& 
·štInfo
, , )

82 ià(
	g·štInfo
.
	gcÚ‹xt
->
·štšgDi§bËd
(è|| !
d¿wsCÚ‹Ás
())

86 ià(!
fœ¡Chd
(è&& !
£lfWlPašt
())

89 
PaštInfo
 
chdPaštInfo
(
·štInfo
);

91 
	gchdPaštInfo
.
	gcÚ‹xt
->
§ve
();

94 
­¶yV›wpÜtCl
(
chdPaštInfo
);

96 
­¶yT¿nsfÜmToPaštInfo
(
chdPaštInfo
, 
loÿlToP¬’tT¿nsfÜm
());

98 
SVGResourûF‹r
* 
	gf‹r
 = 0;

99 
FlßtReù
 
	gboundšgBox
 = 
»·štReùInLoÿlCoÜdš©es
();

101 
boŞ
 
	gcÚtšueR’d”šg
 = 
Œue
;

102 ià(
	gchdPaštInfo
.
	gpha£
 =ğ
PaštPha£FÜeground
)

103 
cÚtšueR’d”šg
 = 
´•¬eToR’d”SVGCÚ‹Á
(
this
, 
chdPaštInfo
, 
boundšgBox
, 
f‹r
);

105 ià(
	gcÚtšueR’d”šg
) {

106 
	gchdPaštInfo
.
	g·štšgRoÙ
 = 
·štšgRoÙFÜChd»n
(
chdPaštInfo
);

107 
R’d”Objeù
* 
	gchd
 = 
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
())

108 
chd
->
·št
(
chdPaštInfo
, 0, 0);

111 ià(
	g·štInfo
.
	gpha£
 =ğ
PaštPha£FÜeground
)

112 
fšishR’d”SVGCÚ‹Á
(
this
, 
chdPaštInfo
, 
f‹r
, 
·štInfo
.
cÚ‹xt
);

114 
	gchdPaštInfo
.
	gcÚ‹xt
->
»¡Üe
();

121 
IÁReù
 
	g·štReùInP¬’t
 = 
’şosšgIÁReù
(
loÿlToP¬’tT¿nsfÜm
().
m­Reù
(
»·štReùInLoÿlCoÜdš©es
()));

122 ià((
	g·štInfo
.
	gpha£
 =ğ
PaštPha£Ouše
 || 
·štInfo
.
pha£
 =ğ
PaštPha£S–fOuše
è&& 
¡yË
()->
oušeWidth
(è&& styË()->
visib™y
(è=ğ
VISIBLE
)

123 
·štOuše
(
·štInfo
.
cÚ‹xt
, 
·štReùInP¬’t
.
x
(),…aštReùInP¬’t.
y
(),…aštReùInP¬’t.
width
(),…aštReùInP¬’t.
height
());

127 
	gR’d”SVGCÚš”
::
addFocusRšgReùs
(
VeùÜ
<
IÁReù
>& 
»ùs
, , )

129 
IÁReù
 
	g·štReùInP¬’t
 = 
’şosšgIÁReù
(
loÿlToP¬’tT¿nsfÜm
().
m­Reù
(
»·štReùInLoÿlCoÜdš©es
()));

130 ià(!
	g·štReùInP¬’t
.
isEm±y
())

131 
	g»ùs
.
­³nd
(
·štReùInP¬’t
);

134 
FlßtReù
 
	gR’d”SVGCÚš”
::
objeùBoundšgBox
() const

136  
compu‹CÚš”BoundšgBox
(
this
, 
çl£
);

139 
FlßtReù
 
	gR’d”SVGCÚš”
::
¡rokeBoundšgBox
() const

141  
compu‹CÚš”BoundšgBox
(
this
, 
Œue
);

146 
FlßtReù
 
	gR’d”SVGCÚš”
::
»·štReùInLoÿlCoÜdš©es
() const

148 
FlßtReù
 
»·štReù
 = 
compu‹CÚš”BoundšgBox
(
this
, 
Œue
);

150 
FlßtReù
 
	g»ù
 = 
f‹rBoundšgBoxFÜR’d””
(
this
);

151 ià(!
	g»ù
.
isEm±y
())

152 
	g»·štReù
 = 
»ù
;

154 
	g»ù
 = 
ş³rBoundšgBoxFÜR’d””
(
this
);

155 ià(!
	g»ù
.
isEm±y
())

156 
	g»·štReù
.
š‹r£ù
(
»ù
);

158 
	g»ù
 = 
mask”BoundšgBoxFÜR’d””
(
this
);

159 ià(!
	g»ù
.
isEm±y
())

160 
	g»·štReù
.
š‹r£ù
(
»ù
);

162 
¡yË
()->
svgStyË
()->
šæ©eFÜShadow
(
»·štReù
);

164  
	g»·štReù
;

167 
boŞ
 
	gR’d”SVGCÚš”
::
nodeAtFlßtPošt
(cÚ¡ 
H™Te¡Reque¡
& 
»que¡
, 
H™Te¡ResuÉ
& 
»suÉ
, cÚ¡ 
FlßtPošt
& 
poštInP¬’t
, 
H™Te¡AùiÚ
 
h™Te¡AùiÚ
)

170 ià(!
poštIsInsideV›wpÜtCl
(
poštInP¬’t
))

171  
	gçl£
;

173 
FlßtPošt
 
	gloÿlPošt
 = 
loÿlToP¬’tT¿nsfÜm
().
šv”£
().
m­Pošt
(
poštInP¬’t
);

175 
R’d”Objeù
* 
	gchd
 = 
Ï¡Chd
(); chd; chd = 
chd
->
´eviousSiblšg
()) {

176 ià(
chd
->
nodeAtFlßtPošt
(
»que¡
, 
»suÉ
, 
loÿlPošt
, 
h™Te¡AùiÚ
)) {

177 
upd©eH™Te¡ResuÉ
(
»suÉ
, 
roundedIÁPošt
(
loÿlPošt
));

178  
	gŒue
;

184  
	gçl£
;

	@RenderSVGContainer.h

23 #iâdeà
R’d”SVGCÚš”_h


24 
	#R’d”SVGCÚš”_h


	)

26 #ià
ENABLE
(
SVG
)

28 
	~"R’d”SVGMod–Objeù.h
"

30 
Çme¥aû
 
	gWebCÜe
 {

32 
şass
 
	gSVGEËm’t
;

34 şas 
	cR’d”SVGCÚš”
 : 
public
 
R’d”SVGMod–Objeù
 {

35 
public
:

36 
R’d”SVGCÚš”
(
SVGStyËdEËm’t
*);

38 cÚ¡ 
R’d”ObjeùChdLi¡
* 
chd»n
(ècÚ¡ {  &
	gm_chd»n
; }

39 
R’d”ObjeùChdLi¡
* 
chd»n
(è{  &
	gm_chd»n
; }

42 
£tD¿wsCÚ‹Ás
(
boŞ
);

43 
boŞ
 
d¿wsCÚ‹Ás
() const;

45 
vœtu®
 
·št
(
PaštInfo
&, 
·»ÁX
, 
·»ÁY
);

47 
	g´Ùeùed
:

48 
vœtu®
 
R’d”ObjeùChdLi¡
* 
vœtu®Chd»n
(è{  
chd»n
(); }

49 
vœtu®
 cÚ¡ 
R’d”ObjeùChdLi¡
* 
vœtu®Chd»n
(ècÚ¡ {  
chd»n
(); }

51 
vœtu®
 
boŞ
 
isSVGCÚš”
(ècÚ¡ {  
	gŒue
; }

52 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderSVGContainer"; }

54 
vœtu®
 
Ïyout
();

56 
vœtu®
 
addFocusRšgReùs
(
VeùÜ
<
IÁReù
>&, 
tx
, 
ty
);

58 
vœtu®
 
FlßtReù
 
objeùBoundšgBox
() const;

59 
vœtu®
 
FlßtReù
 
¡rokeBoundšgBox
() const;

60 
vœtu®
 
FlßtReù
 
»·štReùInLoÿlCoÜdš©es
() const;

62 
vœtu®
 
boŞ
 
nodeAtFlßtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, cÚ¡ 
FlßtPošt
& 
poštInP¬’t
, 
H™Te¡AùiÚ
);

65 
vœtu®
 
ÿlcuÏ‹LoÿlT¿nsfÜm
() { }

68 
vœtu®
 
ÿlcV›wpÜt
() { }

69 
vœtu®
 
­¶yV›wpÜtCl
(
PaštInfo
&) { }

70 
vœtu®
 
boŞ
 
poštIsInsideV›wpÜtCl
(cÚ¡ 
FlßtPošt
& ) {  
	gŒue
; }

72 
boŞ
 
£lfWlPašt
() const;

74 
	g´iv©e
:

75 
R’d”ObjeùChdLi¡
 
m_chd»n
;

76 
boŞ
 
	gm_d¿wsCÚ‹Ás
 : 1;

79 
šlše
 
R’d”SVGCÚš”
* 
	$toR’d”SVGCÚš”
(
R’d”Objeù
* 
objeù
)

82 
	`ASSERT
(!
objeù
 || (objeù->
	`isSVGCÚš”
(è&& 
	`¡rcmp
(objeù->
	`»nd”Name
(), "RenderSVGViewportContainer")));

83  
¡©ic_ÿ¡
<
R’d”SVGCÚš”
*>(
objeù
);

84 
	}
}

86 
šlše
 cÚ¡ 
R’d”SVGCÚš”
* 
	$toR’d”SVGCÚš”
(cÚ¡ 
R’d”Objeù
* 
objeù
)

89 
	`ASSERT
(!
objeù
 || (objeù->
	`isSVGCÚš”
(è&& 
	`¡rcmp
(objeù->
	`»nd”Name
(), "RenderSVGViewportContainer")));

90  
¡©ic_ÿ¡
<cÚ¡ 
R’d”SVGCÚš”
*>(
objeù
);

91 
	}
}

94 
toR’d”SVGCÚš”
(cÚ¡ 
R’d”SVGCÚš”
*);

	@RenderSVGGradientStop.cpp

23 
	~"cÚfig.h
"

25 #ià
ENABLE
(
SVG
)

26 
	~"R’d”SVGG¿d›ÁStİ.h
"

28 
	~"SVGG¿d›ÁEËm’t.h
"

29 
	~"SVGNames.h
"

30 
	~"SVGStİEËm’t.h
"

32 
Çme¥aû
 
	gWebCÜe
 {

34 
usšg
 
Çme¥aû
 
	gSVGNames
;

36 
	gR’d”SVGG¿d›ÁStİ
::
R’d”SVGG¿d›ÁStİ
(
SVGStİEËm’t
* 
–em’t
)

37 : 
R’d”Objeù
(
–em’t
)

41 
R’d”SVGG¿d›ÁStİ
::~RenderSVGGradientStop()

45 
R’d”SVGG¿d›ÁStİ
::
¡yËDidChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
)

47 
	gR’d”Objeù
::
¡yËDidChªge
(
diff
, 
ŞdStyË
);

51 ià(
SVGG¿d›ÁEËm’t
* 
	gg¿d›Á
 = 
g¿d›ÁEËm’t
()) {

52 ià(
SVGResourû
* 
»sourû
 = 
g¿d›Á
->
ÿnvasResourû
(
this
))

53 
»sourû
->
šv®id©e
();

57 
	gR’d”SVGG¿d›ÁStİ
::
Ïyout
()

59 
£tN“dsLayout
(
çl£
);

62 
SVGG¿d›ÁEËm’t
* 
	gR’d”SVGG¿d›ÁStİ
::
g¿d›ÁEËm’t
() const

64 
Node
* 
·»ÁNode
 = 
node
()->
·»Á
();

65 ià(
	g·»ÁNode
->
hasTagName
(
lš—rG¿d›ÁTag
è||…¬’tNode->hasTagName(
¿dŸlG¿d›ÁTag
))

66  
	g¡©ic_ÿ¡
<
	gSVGG¿d›ÁEËm’t
*>(
	g·»ÁNode
);

	@RenderSVGGradientStop.h

22 #iâdeà
R’d”SVGG¿d›ÁStİ_h


23 
	#R’d”SVGG¿d›ÁStİ_h


	)

25 #ià
ENABLE
(
SVG
)

26 
	~"R’d”Objeù.h
"

28 
Çme¥aû
 
	gWebCÜe
 {

30 
şass
 
	gSVGG¿d›ÁEËm’t
;

31 
şass
 
	gSVGStİEËm’t
;

34 şas 
	cR’d”SVGG¿d›ÁStİ
 : 
public
 
R’d”Objeù
 {

35 
public
:

36 
R’d”SVGG¿d›ÁStİ
(
SVGStİEËm’t
*);

37 
	gvœtu®
 ~
R’d”SVGG¿d›ÁStİ
();

39 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderSVGGradientStop"; }

41 
vœtu®
 
Ïyout
();

46 
vœtu®
 
IÁReù
 
ş³dOv”æowReùFÜR•ašt
(
R’d”BoxMod–Objeù
*) {  IntRect(); }

47 
vœtu®
 
FlßtReù
 
objeùBoundšgBox
() const {  FloatRect(); }

48 
vœtu®
 
FlßtReù
 
»·štReùInLoÿlCoÜdš©es
() const {  FloatRect(); }

50 
	g´Ùeùed
:

51 
vœtu®
 
¡yËDidChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
);

53 
	g´iv©e
:

54 
SVGG¿d›ÁEËm’t
* 
g¿d›ÁEËm’t
() const;

	@RenderSVGHiddenContainer.cpp

23 
	~"cÚfig.h
"

25 #ià
ENABLE
(
SVG
)

26 
	~"R’d”SVGHidd’CÚš”.h
"

28 
	~"R’d”P©h.h
"

29 
	~"SVGStyËdEËm’t.h
"

31 
Çme¥aû
 
	gWebCÜe
 {

33 
	gR’d”SVGHidd’CÚš”
::
R’d”SVGHidd’CÚš”
(
SVGStyËdEËm’t
* 
–em’t
)

34 : 
R’d”SVGCÚš”
(
–em’t
)

38 
R’d”SVGHidd’CÚš”
::
Ïyout
()

40 
ASSERT
(
ÃedsLayout
());

41 
ÏyoutChd»n
(
this
, 
£lfN“dsLayout
());

42 
£tN“dsLayout
(
çl£
);

45 
	gR’d”SVGHidd’CÚš”
::
·št
(
PaštInfo
&, , )

50 
IÁReù
 
	gR’d”SVGHidd’CÚš”
::
ş³dOv”æowReùFÜR•ašt
(
R’d”BoxMod–Objeù
* )

52  
IÁReù
();

55 
	gR’d”SVGHidd’CÚš”
::
absŞu‹Reùs
(
VeùÜ
<
IÁReù
>&, , )

60 
	gR’d”SVGHidd’CÚš”
::
absŞu‹Quads
(
VeùÜ
<
FlßtQuad
>&)

65 
boŞ
 
R’d”SVGHidd’CÚš”
::
nodeAtFlßtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, cÚ¡ 
FlßtPošt
&, 
H™Te¡AùiÚ
)

67  
	gçl£
;

70 
FlßtReù
 
	gR’d”SVGHidd’CÚš”
::
objeùBoundšgBox
() const

72  
FlßtReù
();

75 
FlßtReù
 
	gR’d”SVGHidd’CÚš”
::
»·štReùInLoÿlCoÜdš©es
() const

77  
FlßtReù
();

	@RenderSVGHiddenContainer.h

23 #iâdeà
R’d”SVGHidd’CÚš”_h


24 
	#R’d”SVGHidd’CÚš”_h


	)

26 #ià
ENABLE
(
SVG
)

28 
	~"R’d”SVGCÚš”.h
"

30 
Çme¥aû
 
	gWebCÜe
 {

32 
şass
 
	gSVGStyËdEËm’t
;

36 şas 
	cR’d”SVGHidd’CÚš”
 : 
public
 
R’d”SVGCÚš”
 {

37 
public
:

38 
R’d”SVGHidd’CÚš”
(
SVGStyËdEËm’t
*);

40 
	g´iv©e
:

41 
vœtu®
 
boŞ
 
isSVGHidd’CÚš”
(ècÚ¡ {  
Œue
; }

43 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderSVGHiddenContainer"; }

45 
vœtu®
 
boŞ
 
»quœesLay”
(ècÚ¡ {  
	gçl£
; }

47 
vœtu®
 
Ïyout
();

48 
vœtu®
 
·št
(
PaštInfo
&, 
·»ÁX
, 
·»ÁY
);

50 
vœtu®
 
IÁReù
 
ş³dOv”æowReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
);

51 
vœtu®
 
absŞu‹Reùs
(
VeùÜ
<
IÁReù
>& 
»ùs
, 
tx
, 
ty
);

52 
vœtu®
 
absŞu‹Quads
(
VeùÜ
<
FlßtQuad
>&);

54 
vœtu®
 
FlßtReù
 
objeùBoundšgBox
() const;

55 
vœtu®
 
FlßtReù
 
»·štReùInLoÿlCoÜdš©es
() const;

57 
vœtu®
 
boŞ
 
nodeAtFlßtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, cÚ¡ 
FlßtPošt
& 
poštInP¬’t
, 
H™Te¡AùiÚ
);

	@RenderSVGImage.cpp

25 
	~"cÚfig.h
"

27 #ià
ENABLE
(
SVG
)

28 
	~"R’d”SVGImage.h
"

30 
	~"A‰r.h
"

31 
	~"FlßtCÚv”siÚ.h
"

32 
	~"FlßtQuad.h
"

33 
	~"G¿phicsCÚ‹xt.h
"

34 
	~"Poš‹rEv’tsH™RuËs.h
"

35 
	~"R’d”Lay”.h
"

36 
	~"SVGImageEËm’t.h
"

37 
	~"SVGL’gth.h
"

38 
	~"SVGP»£rveA¥eùR©io.h
"

39 
	~"SVGR’d”SuµÜt.h
"

41 
Çme¥aû
 
	gWebCÜe
 {

43 
	gR’d”SVGImage
::
R’d”SVGImage
(
SVGImageEËm’t
* 
im¶
)

44 : 
R’d”Image
(
im¶
)

45 , 
m_ÃedsT¿nsfÜmUpd©e
(
Œue
)

49 
	gR’d”SVGImage
::
Ïyout
()

51 
ASSERT
(
ÃedsLayout
());

53 
LayoutR•aš‹r
 
»·š‹r
(*
this
, 
checkFÜR•aštDuršgLayout
());

54 
SVGImageEËm’t
* 
	gimage
 = 
¡©ic_ÿ¡
<SVGImageEËm’t*>(
node
());

56 ià(
	gm_ÃedsT¿nsfÜmUpd©e
) {

57 
	gm_loÿlT¿nsfÜm
 = 
image
->
ªim©edLoÿlT¿nsfÜm
();

58 
	gm_ÃedsT¿nsfÜmUpd©e
 = 
çl£
;

62 
£tHeight
(
”rÜOccu¼ed
(è? 
šŒšsicSize
().
height
() : 0);

64 
ÿlcWidth
();

65 
ÿlcHeight
();

67 
	gm_loÿlBounds
 = 
FlßtReù
(
image
->
x
().
v®ue
(image), image->
y
().v®ue(image), image->
width
().v®ue(image), image->
height
().value(image));

68 
	gm_ÿchedLoÿlR•aštReù
 = 
FlßtReù
();

70 
	g»·š‹r
.
»·štAá”Layout
();

72 
£tN“dsLayout
(
çl£
);

75 
	gR’d”SVGImage
::
·št
(
PaštInfo
& 
·štInfo
, , )

77 ià(
	g·štInfo
.
	gcÚ‹xt
->
·štšgDi§bËd
(è|| 
¡yË
()->
visib™y
(è=ğ
HIDDEN
)

80 
	g·štInfo
.
	gcÚ‹xt
->
§ve
();

81 
	g·štInfo
.
	gcÚ‹xt
->
cÚÿtCTM
(
loÿlToP¬’tT¿nsfÜm
());

83 ià(
	g·štInfo
.
	gpha£
 =ğ
PaštPha£FÜeground
) {

84 
SVGResourûF‹r
* 
f‹r
 = 0;

86 
PaštInfo
 
§vedInfo
(
·štInfo
);

88 ià(
´•¬eToR’d”SVGCÚ‹Á
(
this
, 
·štInfo
, 
m_loÿlBounds
, 
f‹r
)) {

89 
FlßtReù
 
	gde¡Reù
 = 
m_loÿlBounds
;

90 
FlßtReù
 
¤cReù
(0, 0, 
image
()->
width
(), image()->
height
());

92 
SVGImageEËm’t
* 
	gimageEÉ
 = 
¡©ic_ÿ¡
<SVGImageEËm’t*>(
node
());

93 ià(
	gimageEÉ
->
´e£rveA¥eùR©io
().
®ign
(è!ğ
SVGP»£rveA¥eùR©io
::
SVG_PRESERVEASPECTRATIO_NONE
)

94 
imageEÉ
->
´e£rveA¥eùR©io
().
ŒªsfÜmReù
(
de¡Reù
, 
¤cReù
);

96 
	g·štInfo
.
	gcÚ‹xt
->
d¿wImage
(
image
(), 
DeviûCŞÜS·û
, 
de¡Reù
, 
¤cReù
);

98 
fšishR’d”SVGCÚ‹Á
(
this
, 
·štInfo
, 
f‹r
, 
§vedInfo
.
cÚ‹xt
);

101 ià((
	g·štInfo
.
	gpha£
 =ğ
PaštPha£Ouše
 || 
·štInfo
.
pha£
 =ğ
PaštPha£S–fOuše
è&& 
¡yË
()->
oušeWidth
())

102 
·štOuše
(
·štInfo
.
cÚ‹xt
, 0, 0, 
width
(), 
height
());

104 
	g·štInfo
.
	gcÚ‹xt
->
»¡Üe
();

107 
	gR’d”SVGImage
::
de¡roy
()

109 
d”egi¡”FromResourûs
(
this
);

110 
	gR’d”Image
::
de¡roy
();

113 
boŞ
 
	gR’d”SVGImage
::
nodeAtFlßtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
& 
»suÉ
, cÚ¡ 
FlßtPošt
& 
poštInP¬’t
, 
H™Te¡AùiÚ
 
h™Te¡AùiÚ
)

116 ià(
	gh™Te¡AùiÚ
 !ğ
H™Te¡FÜeground
)

117  
çl£
;

119 
Poš‹rEv’tsH™RuËs
 
h™RuËs
(Poš‹rEv’tsH™RuËs::
SVG_IMAGE_HITTESTING
, 
¡yË
()->
poš‹rEv’ts
());

121 
boŞ
 
	gisVisibË
 = (
¡yË
()->
visib™y
(è=ğ
VISIBLE
);

122 ià(
	gisVisibË
 || !
	gh™RuËs
.
	g»quœeVisibË
) {

123 
FlßtPošt
 
	gloÿlPošt
 = 
loÿlToP¬’tT¿nsfÜm
().
šv”£
().
m­Pošt
(
poštInP¬’t
);

125 ià(
	gh™RuËs
.
	gÿnH™Fl
) {

126 ià(
	gm_loÿlBounds
.
cÚšs
(
loÿlPošt
)) {

127 
upd©eH™Te¡ResuÉ
(
»suÉ
, 
roundedIÁPošt
(
loÿlPošt
));

128  
	gŒue
;

133  
	gçl£
;

136 
boŞ
 
	gR’d”SVGImage
::
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, , , , , 
H™Te¡AùiÚ
)

138 
ASSERT_NOT_REACHED
();

139  
	gçl£
;

142 
FlßtReù
 
	gR’d”SVGImage
::
objeùBoundšgBox
() const

144  
m_loÿlBounds
;

147 
FlßtReù
 
	gR’d”SVGImage
::
»·štReùInLoÿlCoÜdš©es
() const

150 ià(!
m_ÿchedLoÿlR•aštReù
.
isEm±y
())

151  
m_ÿchedLoÿlR•aštReù
;

153 
	gm_ÿchedLoÿlR•aštReù
 = 
m_loÿlBounds
;

157 
FlßtReù
 
	g»ù
 = 
f‹rBoundšgBoxFÜR’d””
(
this
);

158 ià(!
	g»ù
.
isEm±y
())

159 
	gm_ÿchedLoÿlR•aštReù
 = 
»ù
;

161 
	g»ù
 = 
ş³rBoundšgBoxFÜR’d””
(
this
);

162 ià(!
	g»ù
.
isEm±y
())

163 
	gm_ÿchedLoÿlR•aštReù
.
š‹r£ù
(
»ù
);

165 
	g»ù
 = 
mask”BoundšgBoxFÜR’d””
(
this
);

166 ià(!
	g»ù
.
isEm±y
())

167 
	gm_ÿchedLoÿlR•aštReù
.
š‹r£ù
(
»ù
);

169 
¡yË
()->
svgStyË
()->
šæ©eFÜShadow
(
m_ÿchedLoÿlR•aštReù
);

171  
	gm_ÿchedLoÿlR•aštReù
;

174 
	gR’d”SVGImage
::
imageChªged
(
W¿µedImagePŒ
 
image
, cÚ¡ 
IÁReù
* 
»ù
)

176 
	gR’d”Image
::
imageChªged
(
image
, 
»ù
);

177 
»·št
();

180 
IÁReù
 
	gR’d”SVGImage
::
ş³dOv”æowReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
)

182  
SVGR’d”Ba£
::
ş³dOv”æowReùFÜR•ašt
(
this
, 
»·štCÚš”
);

185 
	gR’d”SVGImage
::
compu‹ReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
IÁReù
& 
»·štReù
, 
boŞ
 
fixed
)

187 
	gSVGR’d”Ba£
::
compu‹ReùFÜR•ašt
(
this
, 
»·štCÚš”
, 
»·štReù
, 
fixed
);

190 
	gR’d”SVGImage
::
m­LoÿlToCÚš”
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
boŞ
 
fixed
 , boŞ 
u£T¿nsfÜms
, 
T¿nsfÜmS‹
& 
ŒªsfÜmS‹
) const

192 
	gSVGR’d”Ba£
::
m­LoÿlToCÚš”
(
this
, 
»·štCÚš”
, 
fixed
, 
u£T¿nsfÜms
, 
ŒªsfÜmS‹
);

195 
	gR’d”SVGImage
::
addFocusRšgReùs
(
VeùÜ
<
IÁReù
>& 
»ùs
, , )

198 
IÁReù
 
	gcÚ‹ÁReù
 = 
’şosšgIÁReù
(
»·štReùInLoÿlCoÜdš©es
());

199 ià(!
	gcÚ‹ÁReù
.
isEm±y
())

200 
	g»ùs
.
­³nd
(
cÚ‹ÁReù
);

203 
	gR’d”SVGImage
::
absŞu‹Reùs
(
VeùÜ
<
IÁReù
>& 
»ùs
, , )

205 
	g»ùs
.
­³nd
(
absŞu‹Cl³dOv”æowReù
());

208 
	gR’d”SVGImage
::
absŞu‹Quads
(
VeùÜ
<
FlßtQuad
>& 
quads
)

210 
quads
.
­³nd
(
FlßtReù
(
absŞu‹Cl³dOv”æowReù
()));

	@RenderSVGImage.h

23 #iâdeà
R’d”SVGImage_h


24 
	#R’d”SVGImage_h


	)

26 #ià
ENABLE
(
SVG
)

27 
	~"AffšeT¿nsfÜm.h
"

28 
	~"FlßtReù.h
"

29 
	~"R’d”Image.h
"

30 
	~"SVGP»£rveA¥eùR©io.h
"

31 
	~"SVGR’d”SuµÜt.h
"

33 
Çme¥aû
 
	gWebCÜe
 {

35 
şass
 
	gSVGImageEËm’t
;

37 
şass
 
	gR’d”SVGImage
 : 
public
 
R’d”Image
, 
´Ùeùed
 
	gSVGR’d”Ba£
 {

38 
	gpublic
:

39 
R’d”SVGImage
(
SVGImageEËm’t
*);

41 
vœtu®
 
£tN“dsT¿nsfÜmUpd©e
(è{ 
	gm_ÃedsT¿nsfÜmUpd©e
 = 
Œue
; }

43 
	g´iv©e
:

44 
vœtu®
 cÚ¡ 
SVGR’d”Ba£
* 
toSVGR’d”Ba£
(ècÚ¡ {  
this
; }

45 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderSVGImage"; }

46 
vœtu®
 
boŞ
 
isSVGImage
(ècÚ¡ {  
	gŒue
; }

48 
vœtu®
 cÚ¡ 
	gAffšeT¿nsfÜm
& 
loÿlToP¬’tT¿nsfÜm
(ècÚ¡ {  
	gm_loÿlT¿nsfÜm
; }

50 
vœtu®
 
FlßtReù
 
objeùBoundšgBox
() const;

51 
vœtu®
 
FlßtReù
 
¡rokeBoundšgBox
(ècÚ¡ {  
	gm_loÿlBounds
; }

52 
vœtu®
 
FlßtReù
 
»·štReùInLoÿlCoÜdš©es
() const;

54 
vœtu®
 
IÁReù
 
ş³dOv”æowReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
);

55 
vœtu®
 
compu‹ReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
IÁReù
&, 
boŞ
 
fixed
 = 
çl£
);

57 
vœtu®
 
m­LoÿlToCÚš”
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
boŞ
 
u£T¿nsfÜms
, boŞ 
fixed
, 
T¿nsfÜmS‹
&) const;

59 
vœtu®
 
absŞu‹Reùs
(
VeùÜ
<
IÁReù
>&, 
tx
, 
ty
);

60 
vœtu®
 
absŞu‹Quads
(
VeùÜ
<
FlßtQuad
>&);

61 
vœtu®
 
addFocusRšgReùs
(
VeùÜ
<
IÁReù
>&, 
tx
, 
ty
);

63 
vœtu®
 
imageChªged
(
W¿µedImagePŒ
, cÚ¡ 
IÁReù
* = 0);

65 
vœtu®
 
Ïyout
();

66 
vœtu®
 
·št
(
PaštInfo
&, 
·»ÁX
, 
·»ÁY
);

68 
vœtu®
 
de¡roy
();

70 
vœtu®
 
boŞ
 
»quœesLay”
(ècÚ¡ {  
	gçl£
; }

72 
vœtu®
 
boŞ
 
nodeAtFlßtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, cÚ¡ 
FlßtPošt
& 
poštInP¬’t
, 
H™Te¡AùiÚ
);

73 
vœtu®
 
boŞ
 
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, 
x
, 
y
, 
tx
, 
ty
, 
H™Te¡AùiÚ
);

75 
vœtu®
 
AffšeT¿nsfÜm
 
loÿlT¿nsfÜm
(ècÚ¡ {  
	gm_loÿlT¿nsfÜm
; }

77 
boŞ
 
	gm_ÃedsT¿nsfÜmUpd©e
 : 1;

78 
AffšeT¿nsfÜm
 
	gm_loÿlT¿nsfÜm
;

79 
FlßtReù
 
	gm_loÿlBounds
;

80 
mubË
 
FlßtReù
 
	gm_ÿchedLoÿlR•aštReù
;

	@RenderSVGInline.cpp

24 
	~"cÚfig.h
"

26 #ià
ENABLE
(
SVG
)

27 
	~"R’d”SVGIÆše.h
"

29 
	~"FlßtQuad.h
"

30 
	~"R’d”Block.h
"

31 
	~"SVGIÆšeFlowBox.h
"

32 
	~"SVGIÆšeTextBox.h
"

33 
	~"SVGRoÙIÆšeBox.h
"

35 
Çme¥aû
 
	gWebCÜe
 {

37 
	gR’d”SVGIÆše
::
R’d”SVGIÆše
(
Node
* 
n
)

38 : 
R’d”IÆše
(
n
)

42 
IÆšeFlowBox
* 
R’d”SVGIÆše
::
ü—‹IÆšeFlowBox
()

44 
IÆšeFlowBox
* 
box
 = 
Ãw
 (
»nd”A»Ç
()è
SVGIÆšeFlowBox
(
this
);

45 
	gbox
->
£tHasVœtu®Height
();

46  
	gbox
;

49 
	gR’d”SVGIÆše
::
absŞu‹Reùs
(
VeùÜ
<
IÁReù
>& 
»ùs
, , )

51 
IÆšeFlowBox
* 
	gfœ¡Box
 = 
fœ¡LšeBox
();

53 
RoÙIÆšeBox
* 
	groÙBox
 = 
fœ¡Box
 ? fœ¡Box->
roÙ
() : 0;

54 
R’d”Box
* 
	gobjeù
 = 
roÙBox
 ?„oÙBox->
block
() : 0;

56 ià(!
	gobjeù
)

59 
	gxRef
 = 
objeù
->
x
();

60 
	gyRef
 = 
objeù
->
y
();

62 
IÆšeFlowBox
* 
	gcu¼
 = 
fœ¡Box
; cu¼; cu¼ = 
cu¼
->
ÃxtLšeBox
()) {

63 
FlßtReù
 
»ù
(
xRef
 + 
cu¼
->
x
(), 
yRef
 + cu¼->
y
(), cu¼->
width
(), cu¼->
height
());

64 
	g»ùs
.
­³nd
(
’şosšgIÁReù
(
loÿlToAbsŞu‹Quad
(
»ù
).
boundšgBox
()));

68 
FlßtReù
 
	gR’d”SVGIÆše
::
objeùBoundšgBox
() const

70 ià(cÚ¡ 
R’d”Objeù
* 
objeù
 = 
fšdTextRoÙObjeù
(
this
))

71  
objeù
->
objeùBoundšgBox
();

73  
FlßtReù
();

76 
FlßtReù
 
	gR’d”SVGIÆše
::
¡rokeBoundšgBox
() const

78 cÚ¡ 
R’d”Objeù
* 
objeù
 = 
fšdTextRoÙObjeù
(
this
);

79 
ASSERT
(
objeù
);

81 cÚ¡ 
SVGR’d”Ba£
* 
	g»nd””
 = 
objeù
->
toSVGR’d”Ba£
();

82 ià(!
	g»nd””
)

83  
FlßtReù
();

85  
	g»nd””
->
¡rokeBoundšgBox
();

88 
FlßtReù
 
	gR’d”SVGIÆše
::
»·štReùInLoÿlCoÜdš©es
() const

90 ià(cÚ¡ 
R’d”Objeù
* 
objeù
 = 
fšdTextRoÙObjeù
(
this
))

91  
objeù
->
»·štReùInLoÿlCoÜdš©es
();

93  
FlßtReù
();

96 
	gR’d”SVGIÆše
::
absŞu‹Quads
(
VeùÜ
<
FlßtQuad
>& 
quads
)

98 
IÆšeFlowBox
* 
fœ¡Box
 = 
fœ¡LšeBox
();

100 
RoÙIÆšeBox
* 
	groÙBox
 = 
fœ¡Box
 ? fœ¡Box->
roÙ
() : 0;

101 
R’d”Box
* 
	gobjeù
 = 
roÙBox
 ?„oÙBox->
block
() : 0;

103 ià(!
	gobjeù
)

106 
	gxRef
 = 
objeù
->
x
();

107 
	gyRef
 = 
objeù
->
y
();

109 
IÆšeFlowBox
* 
	gcu¼
 = 
fœ¡Box
; cu¼; cu¼ = 
cu¼
->
ÃxtLšeBox
()) {

110 
FlßtReù
 
»ù
(
xRef
 + 
cu¼
->
x
(), 
yRef
 + cu¼->
y
(), cu¼->
width
(), cu¼->
height
());

111 
	gquads
.
­³nd
(
loÿlToAbsŞu‹Quad
(
»ù
));

	@RenderSVGInline.h

24 #iâdeà
R’d”SVGIÆše_h


25 
	#R’d”SVGIÆše_h


	)

27 #ià
ENABLE
(
SVG
)

28 
	~"R’d”IÆše.h
"

30 
	~"SVGR’d”SuµÜt.h
"

32 
Çme¥aû
 
	gWebCÜe
 {

34 
şass
 
	gR’d”SVGIÆše
 : 
public
 
R’d”IÆše
, 
´Ùeùed
 
	gSVGR’d”Ba£
 {

35 
	gpublic
:

36 
R’d”SVGIÆše
(
Node
*);

38 
vœtu®
 cÚ¡ 
SVGR’d”Ba£
* 
toSVGR’d”Ba£
(ècÚ¡ {  
	gthis
; }

40 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderSVGInline"; }

41 
vœtu®
 
boŞ
 
»quœesLay”
(ècÚ¡ {  
	gçl£
; }

44 
vœtu®
 
absŞu‹Reùs
(
VeùÜ
<
IÁReù
>& 
»ùs
, 
tx
, 
ty
);

45 
vœtu®
 
absŞu‹Quads
(
VeùÜ
<
FlßtQuad
>&);

52 
vœtu®
 
FlßtReù
 
objeùBoundšgBox
() const;

53 
vœtu®
 
FlßtReù
 
¡rokeBoundšgBox
() const;

54 
vœtu®
 
FlßtReù
 
»·štReùInLoÿlCoÜdš©es
() const;

56 
	g´iv©e
:

57 
vœtu®
 
IÆšeFlowBox
* 
ü—‹IÆšeFlowBox
();

	@RenderSVGInlineText.cpp

26 
	~"cÚfig.h
"

28 #ià
ENABLE
(
SVG
)

29 
	~"R’d”SVGIÆšeText.h
"

31 
	~"FlßtCÚv”siÚ.h
"

32 
	~"FlßtQuad.h
"

33 
	~"R’d”Block.h
"

34 
	~"R’d”SVGRoÙ.h
"

35 
	~"SVGIÆšeTextBox.h
"

36 
	~"SVGRoÙIÆšeBox.h
"

37 
	~"VisibËPos™iÚ.h
"

39 
Çme¥aû
 
	gWebCÜe
 {

41 
šlše
 
boŞ
 
isChdOfHidd’CÚš”
(
R’d”Objeù
* 
¡¬t
)

43 
	g¡¬t
) {

44 ià(
	g¡¬t
->
isSVGHidd’CÚš”
())

45  
	gŒue
;

47 
	g¡¬t
 = 
¡¬t
->
·»Á
();

50  
	gçl£
;

53 
	gR’d”SVGIÆšeText
::
R’d”SVGIÆšeText
(
Node
* 
n
, 
PassRefPŒ
<
SŒšgIm¶
> 
¡r
)

54 : 
R’d”Text
(
n
, 
¡r
)

59 
	gR’d”SVGIÆšeText
::
¡yËDidChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
)

62 
	gR’d”Objeù
::
¡yËDidChªge
(
diff
, 
ŞdStyË
);

65 ià(
	gRefPŒ
<
	gSŒšgIm¶
> 
	g‹xtToT¿nsfÜm
 = 
Üigš®Text
())

66 
£tText
(
‹xtToT¿nsfÜm
.
»Ëa£
(), 
Œue
);

69 
	gR’d”SVGIÆšeText
::
absŞu‹Reùs
(
VeùÜ
<
IÁReù
>& 
»ùs
, , )

71 
	g»ùs
.
­³nd
(
compu‹R•aštReùFÜRªge
(0, 0, 
‹xtL’gth
()));

74 
	gR’d”SVGIÆšeText
::
absŞu‹Quads
(
VeùÜ
<
FlßtQuad
>& 
quads
)

76 
quads
.
­³nd
(
compu‹R•aštQuadFÜRªge
(0, 0, 
‹xtL’gth
()));

79 
IÁReù
 
	gR’d”SVGIÆšeText
::
£ËùiÚReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
boŞ
 )

81 
ASSERT
(!
ÃedsLayout
());

83 ià(
£ËùiÚS‹
(è=ğ
S–eùiÚNÚe
)

84  
IÁReù
();

87 ià(
isChdOfHidd’CÚš”
(
this
))

88  
IÁReù
();

92 
	g¡¬tPos
, 
	g’dPos
;

93 ià(
£ËùiÚS‹
(è=ğ
S–eùiÚInside
) {

95 
¡¬tPos
 = 0;

96 
	g’dPos
 = 
‹xtL’gth
();

98 
£ËùiÚS¹End
(
¡¬tPos
, 
’dPos
);

99 ià(
£ËùiÚS‹
(è=ğ
S–eùiÚS¹
)

100 
’dPos
 = 
‹xtL’gth
();

101 ià(
£ËùiÚS‹
(è=ğ
S–eùiÚEnd
)

102 
¡¬tPos
 = 0;

105 ià(
	g¡¬tPos
 =ğ
’dPos
)

106  
IÁReù
();

108  
compu‹R•aštReùFÜRªge
(
»·štCÚš”
, 
¡¬tPos
, 
’dPos
);

111 
IÁReù
 
	gR’d”SVGIÆšeText
::
compu‹R•aštReùFÜRªge
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
¡¬tPos
, 
’dPos
)

113 
FlßtQuad
 
	g»·štQuad
 = 
compu‹R•aštQuadFÜRªge
(
»·štCÚš”
, 
¡¬tPos
, 
’dPos
);

114  
’şosšgIÁReù
(
»·štQuad
.
boundšgBox
());

117 
FlßtQuad
 
	gR’d”SVGIÆšeText
::
compu‹R•aštQuadFÜRªge
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
¡¬tPos
, 
’dPos
)

119 
R’d”Block
* 
	gcb
 = 
cÚššgBlock
();

120 ià(!
	gcb
 || !cb->
cÚš”
())

121  
FlßtQuad
();

123 
R’d”SVGRoÙ
* 
	groÙ
 = 
fšdSVGRoÙObjeù
(
·»Á
());

124 ià(!
	groÙ
)

125  
FlßtQuad
();

127 
IÁReù
 
	g»ù
;

128 
IÆšeTextBox
* 
	gbox
 = 
fœ¡TextBox
(); box; box = 
box
->
ÃxtTextBox
())

129 
»ù
.
un™e
(
box
->
£ËùiÚReù
(0, 0, 
¡¬tPos
, 
’dPos
));

131  
loÿlToCÚš”Quad
(
FlßtQuad
(
»ù
), 
»·štCÚš”
);

134 
IÆšeTextBox
* 
	gR’d”SVGIÆšeText
::
ü—‹TextBox
()

136 
IÆšeTextBox
* 
box
 = 
Ãw
 (
»nd”A»Ç
()è
SVGIÆšeTextBox
(
this
);

137 
	gbox
->
£tHasVœtu®Height
();

138  
	gbox
;

141 
IÁReù
 
	gR’d”SVGIÆšeText
::
loÿlC¬‘Reù
(
IÆšeBox
*, , *)

145  
IÁReù
();

148 
VisibËPos™iÚ
 
	gR’d”SVGIÆšeText
::
pos™iÚFÜPošt
(cÚ¡ 
IÁPošt
& 
pošt
)

150 
SVGIÆšeTextBox
* 
‹xtBox
 = 
¡©ic_ÿ¡
<SVGIÆšeTextBox*>(
fœ¡TextBox
());

152 ià(!
	g‹xtBox
 || 
‹xtL’gth
() == 0)

153  
ü—‹VisibËPos™iÚ
(0, 
DOWNSTREAM
);

155 
SVGRoÙIÆšeBox
* 
	groÙBox
 = 
‹xtBox
->
svgRoÙIÆšeBox
();

156 
R’d”Block
* 
	gobjeù
 = 
roÙBox
 ?„oÙBox->
block
() : 0;

158 ià(!
	gobjeù
)

159  
ü—‹VisibËPos™iÚ
(0, 
DOWNSTREAM
);

161 
	gşo£¡Off£tInBox
 = 0;

169 
SVGIÆšeTextBox
* 
	gbox
 = 
‹xtBox
; box; box = 
¡©ic_ÿ¡
<SVGIÆšeTextBox*>(
box
->
ÃxtTextBox
())) {

170 ià(
box
->
svgCh¬aù”H™sPos™iÚ
(
pošt
.
x
(è+ 
objeù
->x(),…ošt.
y
(è+ objeù->y(), 
şo£¡Off£tInBox
)) {

172 ià(
box
->
dœeùiÚ
(è=ğ
LTR
) {

173 ià(
şo£¡Off£tInBox
 <ğ(è
box
->
’d
() + 1)

176 ià(
	gşo£¡Off£tInBox
 > (è
	gbox
->
¡¬t
())

182  
ü—‹VisibËPos™iÚ
(
şo£¡Off£tInBox
, 
DOWNSTREAM
);

185 
	gR’d”SVGIÆšeText
::
de¡roy
()

187 ià(!
docum’tBešgDe¡royed
()) {

188 
£tN“dsLayoutAndP»fWidthsReÿlc
();

189 
»·št
();

191 
	gR’d”Text
::
de¡roy
();

	@RenderSVGInlineText.h

25 #iâdeà
R’d”SVGIÆšeText_h


26 
	#R’d”SVGIÆšeText_h


	)

28 #ià
ENABLE
(
SVG
)

30 
	~"R’d”Text.h
"

32 
Çme¥aû
 
	gWebCÜe
 {

33 şas 
	cR’d”SVGIÆšeText
 : 
public
 
R’d”Text
 {

34 
public
:

35 
R’d”SVGIÆšeText
(
Node
*, 
PassRefPŒ
<
SŒšgIm¶
>);

37 
	g´iv©e
:

38 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderSVGInlineText"; }

40 
vœtu®
 
¡yËDidChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
*);

44 
vœtu®
 
FlßtReù
 
objeùBoundšgBox
() const {  FloatRect(); }

46 
vœtu®
 
absŞu‹Reùs
(
VeùÜ
<
IÁReù
>& 
»ùs
, 
tx
, 
ty
);

47 
vœtu®
 
absŞu‹Quads
(
VeùÜ
<
FlßtQuad
>&);

49 
vœtu®
 
boŞ
 
»quœesLay”
(ècÚ¡ {  
	gçl£
; }

50 
vœtu®
 
IÁReù
 
£ËùiÚReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
boŞ
 
şToVisibËCÚ‹Á
 = 
Œue
);

51 
vœtu®
 
boŞ
 
isSVGText
(ècÚ¡ {  
	gŒue
; }

53 
vœtu®
 
IÁReù
 
loÿlC¬‘Reù
(
IÆšeBox
*, 
ÿ»tOff£t
, * 
exŒaWidthToEndOfLše
 = 0);

54 
vœtu®
 
VisibËPos™iÚ
 
pos™iÚFÜPošt
(cÚ¡ 
IÁPošt
&);

56 
vœtu®
 
de¡roy
();

58 
vœtu®
 
IÆšeTextBox
* 
ü—‹TextBox
();

59 
IÁReù
 
compu‹R•aštReùFÜRªge
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
¡¬tPos
, 
’dPos
);

60 
FlßtQuad
 
compu‹R•aštQuadFÜRªge
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
¡¬tPos
, 
’dPos
);

	@RenderSVGModelObject.cpp

31 
	~"cÚfig.h
"

33 #ià
ENABLE
(
SVG
)

34 
	~"R’d”SVGMod–Objeù.h
"

36 
	~"G¿phicsCÚ‹xt.h
"

37 
	~"R’d”Lay”.h
"

38 
	~"R’d”V›w.h
"

39 
	~"SVGStyËdEËm’t.h
"

41 
Çme¥aû
 
	gWebCÜe
 {

43 
	gR’d”SVGMod–Objeù
::
R’d”SVGMod–Objeù
(
SVGStyËdEËm’t
* 
node
)

44 : 
R’d”Objeù
(
node
)

48 
IÁReù
 
R’d”SVGMod–Objeù
::
ş³dOv”æowReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
)

50  
SVGR’d”Ba£
::
ş³dOv”æowReùFÜR•ašt
(
this
, 
»·štCÚš”
);

53 
	gR’d”SVGMod–Objeù
::
compu‹ReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
IÁReù
& 
»·štReù
, 
boŞ
 
fixed
)

55 
	gSVGR’d”Ba£
::
compu‹ReùFÜR•ašt
(
this
, 
»·štCÚš”
, 
»·štReù
, 
fixed
);

58 
	gR’d”SVGMod–Objeù
::
m­LoÿlToCÚš”
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
boŞ
 
fixed
 , boŞ 
u£T¿nsfÜms
, 
T¿nsfÜmS‹
& 
ŒªsfÜmS‹
) const

60 
	gSVGR’d”Ba£
::
m­LoÿlToCÚš”
(
this
, 
»·štCÚš”
, 
fixed
, 
u£T¿nsfÜms
, 
ŒªsfÜmS‹
);

66 
IÁReù
 
	gR’d”SVGMod–Objeù
::
oušeBoundsFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
IÁPošt
*) const

68 
IÁReù
 
	gbox
 = 
’şosšgIÁReù
(
»·štReùInLoÿlCoÜdš©es
());

69 
adju¡ReùFÜOušeAndShadow
(
box
);

71 
FlßtQuad
 
	gcÚš”R–©iveQuad
 = 
loÿlToCÚš”Quad
(
FlßtReù
(
box
), 
»·štCÚš”
);

72  
	gcÚš”R–©iveQuad
.
’şosšgBoundšgBox
();

75 
	gR’d”SVGMod–Objeù
::
absŞu‹Reùs
(
VeùÜ
<
IÁReù
>& 
»ùs
, , )

77 
	g»ùs
.
­³nd
(
absŞu‹Cl³dOv”æowReù
());

80 
	gR’d”SVGMod–Objeù
::
absŞu‹Quads
(
VeùÜ
<
FlßtQuad
>& 
quads
)

82 
quads
.
­³nd
(
absŞu‹Cl³dOv”æowReù
());

85 
	gR’d”SVGMod–Objeù
::
de¡roy
()

87 
d”egi¡”FromResourûs
(
this
);

88 
	gR’d”Objeù
::
de¡roy
();

91 
boŞ
 
	gR’d”SVGMod–Objeù
::
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, , , , , 
H™Te¡AùiÚ
)

93 
ASSERT_NOT_REACHED
();

94  
	gçl£
;

	@RenderSVGModelObject.h

31 #iâdeà
R’d”SVGMod–Objeù_h


32 
	#R’d”SVGMod–Objeù_h


	)

34 #ià
ENABLE
(
SVG
)

36 
	~"R’d”Objeù.h
"

37 
	~"SVGR’d”SuµÜt.h
"

39 
Çme¥aû
 
	gWebCÜe
 {

46 
şass
 
	gSVGStyËdEËm’t
;

48 
şass
 
	gR’d”SVGMod–Objeù
 : 
public
 
R’d”Objeù
, 
´Ùeùed
 
	gSVGR’d”Ba£
 {

49 
	gpublic
:

50 
R’d”SVGMod–Objeù
(
SVGStyËdEËm’t
*);

52 
vœtu®
 cÚ¡ 
SVGR’d”Ba£
* 
toSVGR’d”Ba£
(ècÚ¡ {  
	gthis
; }

54 
vœtu®
 
boŞ
 
»quœesLay”
(ècÚ¡ {  
	gçl£
; }

56 
vœtu®
 
IÁReù
 
ş³dOv”æowReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
);

57 
vœtu®
 
compu‹ReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
IÁReù
&, 
boŞ
 
fixed
 = 
çl£
);

58 
vœtu®
 
IÁReù
 
oušeBoundsFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
IÁPošt
*) const;

60 
vœtu®
 
absŞu‹Reùs
(
VeùÜ
<
IÁReù
>& 
»ùs
, 
tx
, 
ty
);

61 
vœtu®
 
absŞu‹Quads
(
VeùÜ
<
FlßtQuad
>&);

63 
vœtu®
 
de¡roy
();

65 
vœtu®
 
m­LoÿlToCÚš”
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
boŞ
 
u£T¿nsfÜms
, boŞ 
fixed
, 
T¿nsfÜmS‹
&) const;

67 
	g´iv©e
:

69 
boŞ
 
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
& 
»que¡
, 
H™Te¡ResuÉ
& 
»suÉ
, 
xInCÚš”
, 
yInCÚš”
, 
dxP¬’tToCÚš”
, 
dyP¬’tToCÚš”
, 
H™Te¡AùiÚ
 
h™Te¡AùiÚ
);

	@RenderSVGResource.h

21 #iâdeà
R’d”SVGResourû_h


22 
	#R’d”SVGResourû_h


	)

24 #ià
ENABLE
(
SVG
)

25 
	~"FlßtReù.h
"

26 
	~"R’d”SVGHidd’CÚš”.h
"

28 
Çme¥aû
 
	gWebCÜe
 {

30 
	eR’d”SVGResourûTy³
 {

31 
	gMask”ResourûTy³
,

32 
	gM¬k”ResourûTy³
,

33 
	gCl³rResourûTy³


36 şas 
	cR’d”SVGResourû
 : 
public
 
R’d”SVGHidd’CÚš”
 {

37 
public
:

38 
R’d”SVGResourû
(
SVGStyËdEËm’t
* 
node
è: 
R’d”SVGHidd’CÚš”
(node) { }

40 
‹m¶©e
<
şass
 
R’d””
>

41 
R’d””
* 
ÿ¡
()

43 ià(
R’d””
::
s_»sourûTy³
 =ğ
»sourûTy³
())

44  
¡©ic_ÿ¡
<
R’d””
*>(
this
);

49 
vœtu®
 
R’d”SVGResourû
* 
toR’d”SVGResourû
(è{  
	gthis
; }

50 
vœtu®
 
boŞ
 
isSVGResourû
(ècÚ¡ {  
	gŒue
; }

51 
vœtu®
 
boŞ
 
d¿wsCÚ‹Ás
(è{  
	gçl£
; }

53 
vœtu®
 
šv®id©eCl›Ás
() = 0;

54 
vœtu®
 
šv®id©eCl›Á
(
R’d”Objeù
*) = 0;

56 
vœtu®
 
boŞ
 
­¶yResourû
(
R’d”Objeù
*, 
G¿phicsCÚ‹xt
*) = 0;

57 
vœtu®
 
FlßtReù
 
»sourûBoundšgBox
(const FloatRect&) const = 0;

59 
vœtu®
 
R’d”SVGResourûTy³
 
»sourûTy³
() const = 0;

62 
	g‹m¶©e
<
ty³Çme
 
	gR’d””
>

63 
R’d””
* 
	$g‘R’d”SVGResourûById
(
Docum’t
* 
docum’t
, cÚ¡ 
AtomicSŒšg
& 
id
)

65 ià(
id
.
	`isEm±y
())

68 
EËm’t
* 
–em’t
 = 
docum’t
->
	`g‘EËm’tById
(
id
);

69 ià(!
–em’t
 || !–em’t->
	`isSVGEËm’t
())

72 
R’d”Objeù
* 
»nd””
 = 
–em’t
->
	`»nd””
();

73 ià(!
»nd””
)

76 
R’d”SVGResourû
* 
»nd”Resourû
 = 
»nd””
->
	`toR’d”SVGResourû
();

77 ià(!
»nd”Resourû
)

80  
»nd”Resourû
->
ÿ¡
<
R’d””
>();

81 
	}
}

	@RenderSVGResourceClipper.cpp

23 
	~"cÚfig.h
"

24 
	~"R’d”SVGResourûCl³r.h
"

26 
	~"AffšeT¿nsfÜm.h
"

27 
	~"FlßtReù.h
"

28 
	~"G¿phicsCÚ‹xt.h
"

29 
	~"R’d”SVGResourû.h
"

30 
	~"SVGClP©hEËm’t.h
"

31 
	~"SVGEËm’t.h
"

32 
	~"SVGR’d”SuµÜt.h
"

33 
	~"SVGStyËdEËm’t.h
"

34 
	~"SVGStyËdT¿nsfÜmabËEËm’t.h
"

35 
	~"SVGUn™Ty³s.h
"

37 
Çme¥aû
 
	gWebCÜe
 {

39 
R’d”SVGResourûTy³
 
	gR’d”SVGResourûCl³r
::
s_»sourûTy³
 = 
Cl³rResourûTy³
;

41 
	gR’d”SVGResourûCl³r
::
R’d”SVGResourûCl³r
(
SVGStyËdEËm’t
* 
node
)

42 : 
R’d”SVGResourû
(
node
)

46 
R’d”SVGResourûCl³r
::~RenderSVGResourceClipper()

48 
m_ş³r
.
ş—r
();

51 
	gR’d”SVGResourûCl³r
::
šv®id©eCl›Ás
()

53 
HashS‘
<
R’d”Objeù
*>::
cÚ¡_™”©Ü
 
’d
 = 
m_ş³r
.end();

54 
	gHashS‘
<
	gR’d”Objeù
*>::
cÚ¡_™”©Ü
 
™
 = 
m_ş³r
.
begš
(); 
	g™
 !ğ
’d
; ++it) {

55 
R’d”Objeù
* 
	g»nd””
 = *
™
;

56 
	g»nd””
->
£tN“dsBound¬›sUpd©e
();

57 
	g»nd””
->
£tN“dsLayout
(
Œue
);

60 
	gm_ş³r
.
ş—r
();

63 
	gR’d”SVGResourûCl³r
::
šv®id©eCl›Á
(
R’d”Objeù
* 
objeù
)

65 
ASSERT
(
objeù
);

71 ià(!
	gm_ş³r
.
cÚšs
(
objeù
))

74 
	gm_ş³r
.
»move
(
objeù
);

77 
boŞ
 
	gR’d”SVGResourûCl³r
::
­¶yResourû
(
R’d”Objeù
* 
objeù
, 
G¿phicsCÚ‹xt
* 
cÚ‹xt
)

79 
ASSERT
(
objeù
);

80 
ASSERT
(
cÚ‹xt
);

82 
	gm_ş³r
.
add
(
objeù
);

84 
	gcÚ‹xt
->
begšP©h
();

86 
AffšeT¿nsfÜm
 
	gobbT¿nsfÜm
;

87 
FlßtReù
 
	gobjeùBoundšgBox
 = 
objeù
->
objeùBoundšgBox
();

88 
boŞ
 
	gbbox
 = 
¡©ic_ÿ¡
<
SVGClP©hEËm’t
*>(
node
())->
şP©hUn™s
(è=ğ
SVGUn™Ty³s
::
SVG_UNIT_TYPE_OBJECTBOUNDINGBOX
;

89 ià(
	gbbox
) {

90 
	gobbT¿nsfÜm
.
Œª¦©e
(
objeùBoundšgBox
.
x
(), objeùBoundšgBox.
y
());

91 
	gobbT¿nsfÜm
.
sÿËNÚUnifÜm
(
objeùBoundšgBox
.
width
(), objeùBoundšgBox.
height
());

94 
boŞ
 
	ghasClP©h
 = 
çl£
;

95 
WšdRuË
 
	gşRuË
 = 
RULE_EVENODD
;

96 
Node
* 
	gchdNode
 = 
node
()->
fœ¡Chd
(); chdNode; chdNodğ
chdNode
->
ÃxtSiblšg
()) {

97 ià(!
chdNode
->
isSVGEËm’t
(è|| !
¡©ic_ÿ¡
<
SVGEËm’t
*>(chdNode)->
isStyËdT¿nsfÜmabË
())

99 
SVGStyËdT¿nsfÜmabËEËm’t
* 
	g¡yËd
 = 
¡©ic_ÿ¡
<SVGStyËdT¿nsfÜmabËEËm’t*>(
chdNode
);

100 
R’d”StyË
* 
	g¡yË
 = 
¡yËd
->
»nd””
(è? styËd->»nd””()->
¡yË
() : 0;

101 ià(!
	g¡yË
 || styË->
di¥Ïy
(è=ğ
NONE
)

103 
P©h
 
	g·thD©a
 = 
¡yËd
->
toClP©h
();

104 ià(
	g·thD©a
.
isEm±y
())

106 ià(
	gbbox
)

107 
	g·thD©a
.
ŒªsfÜm
(
obbT¿nsfÜm
);

108 
	ghasClP©h
 = 
Œue
;

109 
	gcÚ‹xt
->
addP©h
(
·thD©a
);

110 
	gşRuË
 = 
¡yË
->
svgStyË
()->
şRuË
();

113 ià(!
	ghasClP©h
) {

114 
P©h
 
	gşP©h
;

115 
	gşP©h
.
addReù
(
FlßtReù
());

116 
	gcÚ‹xt
->
addP©h
(
şP©h
);

123 
	gcÚ‹xt
->
şP©h
(
şRuË
);

125  
	gŒue
;

128 
FlßtReù
 
	gR’d”SVGResourûCl³r
::
»sourûBoundšgBox
(cÚ¡ FlßtReù& 
objeùBoundšgBox
) const

130 
FlßtReù
 
şReù
;

131 
Node
* 
	gchdNode
 = 
node
()->
fœ¡Chd
(); chdNode; chdNodğ
chdNode
->
ÃxtSiblšg
()) {

132 ià(!
chdNode
->
isSVGEËm’t
(è|| !
¡©ic_ÿ¡
<
SVGEËm’t
*>(chdNode)->
isStyËdT¿nsfÜmabË
())

134 
SVGStyËdT¿nsfÜmabËEËm’t
* 
	g¡yËd
 = 
¡©ic_ÿ¡
<SVGStyËdT¿nsfÜmabËEËm’t*>(
chdNode
);

135 
R’d”StyË
* 
	g¡yË
 = 
¡yËd
->
»nd””
(è? styËd->»nd””()->
¡yË
() : 0;

136 ià(!
	g¡yË
 || styË->
di¥Ïy
(è=ğ
NONE
)

138 
	gşReù
.
un™e
(
¡yËd
->
»nd””
()->
objeùBoundšgBox
());

141 ià(
	gşReù
.
isEm±y
())

142  
FlßtReù
();

144 ià(
	g¡©ic_ÿ¡
<
	gSVGClP©hEËm’t
*>(
node
())->
şP©hUn™s
(è=ğ
SVGUn™Ty³s
::
SVG_UNIT_TYPE_OBJECTBOUNDINGBOX
) {

145 
AffšeT¿nsfÜm
 
obbT¿nsfÜm
;

146 
	gobbT¿nsfÜm
.
Œª¦©e
(
objeùBoundšgBox
.
x
(), objeùBoundšgBox.
y
());

147 
	gobbT¿nsfÜm
.
sÿËNÚUnifÜm
(
objeùBoundšgBox
.
width
(), objeùBoundšgBox.
height
());

148  
	gobbT¿nsfÜm
.
m­Reù
(
şReù
);

151  
	gşReù
;

	@RenderSVGResourceClipper.h

21 #iâdeà
R’d”SVGResourûCl³r_h


22 
	#R’d”SVGResourûCl³r_h


	)

24 #ià
ENABLE
(
SVG
)

25 
	~"FlßtReù.h
"

26 
	~"G¿phicsCÚ‹xt.h
"

27 
	~"R’d”SVGResourû.h
"

28 
	~"SVGClP©hEËm’t.h
"

29 
	~"SVGUn™Ty³s.h
"

31 
	~<wtf/HashS‘.h
>

33 
Çme¥aû
 
	gWebCÜe
 {

35 şas 
	cR’d”SVGResourûCl³r
 : 
public
 
R’d”SVGResourû
 {

37 
public
:

38 
R’d”SVGResourûCl³r
(
SVGStyËdEËm’t
*);

39 
	gvœtu®
 ~
R’d”SVGResourûCl³r
();

41 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderSVGResourceClipper"; }

43 
vœtu®
 
šv®id©eCl›Ás
();

44 
vœtu®
 
šv®id©eCl›Á
(
R’d”Objeù
*);

46 
vœtu®
 
boŞ
 
­¶yResourû
(
R’d”Objeù
*, 
G¿phicsCÚ‹xt
*);

47 
vœtu®
 
FlßtReù
 
»sourûBoundšgBox
(const FloatRect&) const;

49 
vœtu®
 
R’d”SVGResourûTy³
 
»sourûTy³
(ècÚ¡ {  
	gCl³rResourûTy³
; }

51 
	gSVGUn™Ty³s
::
SVGUn™Ty³
 
şP©hUn™s
(ècÚ¡ {  
toUn™Ty³
(
¡©ic_ÿ¡
<
SVGClP©hEËm’t
*>(
node
())->clipPathUnits()); }

53 
R’d”SVGResourûTy³
 
	gs_»sourûTy³
;

54 
	g´iv©e
:

55 
HashS‘
<
R’d”Objeù
*> 
m_ş³r
;

	@RenderSVGResourceMarker.cpp

23 
	~"cÚfig.h
"

24 
	~"R’d”SVGResourûM¬k”.h
"

26 
	~"G¿phicsCÚ‹xt.h
"

27 
	~"R’d”SVGCÚš”.h
"

28 
	~"SVGEËm’t.h
"

29 
	~"SVGM¬k”EËm’t.h
"

30 
	~"SVGR’d”SuµÜt.h
"

31 
	~"SVGStyËdEËm’t.h
"

32 
	~"SVGStyËdT¿nsfÜmabËEËm’t.h
"

34 
Çme¥aû
 
	gWebCÜe
 {

36 
R’d”SVGResourûTy³
 
	gR’d”SVGResourûM¬k”
::
s_»sourûTy³
 = 
M¬k”ResourûTy³
;

38 
	gR’d”SVGResourûM¬k”
::
R’d”SVGResourûM¬k”
(
SVGStyËdEËm’t
* 
node
)

39 : 
R’d”SVGResourû
(
node
)

43 
R’d”SVGResourûM¬k”
::~RenderSVGResourceMarker()

45 
m_m¬k”
.
ş—r
();

48 
	gR’d”SVGResourûM¬k”
::
Ïyout
()

53 
R’d”SVGCÚš”
::
Ïyout
();

56 
	gR’d”SVGResourûM¬k”
::
addCl›Á
(cÚ¡ 
R’d”Objeù
* 
objeù
)

58 
m_m¬k”
.
add
(
objeù
);

61 
	gR’d”SVGResourûM¬k”
::
šv®id©eCl›Ás
()

63 cÚ¡ 
HashS‘
<cÚ¡ 
R’d”Objeù
*>::
cÚ¡_™”©Ü
 
’d
 = 
m_m¬k”
.end();

64 
	gHashS‘
<cÚ¡ 
	gR’d”Objeù
*>::
cÚ¡_™”©Ü
 
™
 = 
m_m¬k”
.
begš
(); 
	g™
 !ğ
’d
; ++it) {

65 
R’d”Objeù
* 
	g»nd””
 = 
cÚ¡_ÿ¡
<R’d”Objeù*>(*
™
);

66 
	g»nd””
->
£tN“dsBound¬›sUpd©e
();

67 
	g»nd””
->
£tN“dsLayout
(
Œue
);

70 
	gm_m¬k”
.
ş—r
();

73 
	gR’d”SVGResourûM¬k”
::
šv®id©eCl›Á
(
R’d”Objeù
* 
objeù
)

75 
ASSERT
(
objeù
);

81 ià(!
	gm_m¬k”
.
cÚšs
(
objeù
))

84 
	gm_m¬k”
.
»move
(
objeù
);

87 
	gR’d”SVGResourûM¬k”
::
­¶yV›wpÜtCl
(
PaštInfo
& 
·štInfo
)

89 ià(
SVGR’d”Ba£
::
isOv”æowHidd’
(
this
))

90 
·štInfo
.
cÚ‹xt
->
ş
(
m_v›wpÜt
);

93 
FlßtReù
 
	gR’d”SVGResourûM¬k”
::
m¬k”Bound¬›s
(cÚ¡ 
AffšeT¿nsfÜm
& 
m¬k”T¿nsfÜm©iÚ
) const

95 
FlßtReù
 
coÜdš©es
 = 
R’d”SVGCÚš”
::
»·štReùInLoÿlCoÜdš©es
();

98 
	gcoÜdš©es
 = 
loÿlToP¬’tT¿nsfÜm
().
m­Reù
(
coÜdš©es
);

100  
	gm¬k”T¿nsfÜm©iÚ
.
m­Reù
(
coÜdš©es
);

103 cÚ¡ 
	gAffšeT¿nsfÜm
& 
	gR’d”SVGResourûM¬k”
::
loÿlToP¬’tT¿nsfÜm
() const

105 
AffšeT¿nsfÜm
 
v›wpÜtT¿n¦©iÚ
(
v›wpÜtT¿nsfÜm
());

106 
	gm_loÿlToP¬’tT¿nsfÜm
 = 
v›wpÜtT¿n¦©iÚ
.
Œª¦©eRight
(
m_v›wpÜt
.
x
(), m_v›wpÜt.
y
());

107  
	gm_loÿlToP¬’tT¿nsfÜm
;

112 
FlßtPošt
 
	gR’d”SVGResourûM¬k”
::
»ã»nûPošt
() const

114 
SVGM¬k”EËm’t
* 
m¬k”
 = 
¡©ic_ÿ¡
<SVGM¬k”EËm’t*>(
node
());

115 
ASSERT
(
m¬k”
);

117  
FlßtPošt
(
m¬k”
->
»fX
().
v®ue
(m¬k”), m¬k”->
»fY
().value(marker));

120 
	gR’d”SVGResourûM¬k”
::
ªgË
() const

122 
SVGM¬k”EËm’t
* 
m¬k”
 = 
¡©ic_ÿ¡
<SVGM¬k”EËm’t*>(
node
());

123 
ASSERT
(
m¬k”
);

125 
	gªgË
 = -1;

126 ià(
	gm¬k”
->
Ü›ÁTy³
(è=ğ
SVGM¬k”EËm’t
::
SVG_MARKER_ORIENT_ANGLE
)

127 
ªgË
 = 
m¬k”
->
Ü›ÁAngË
().
v®ue
();

129  
	gªgË
;

132 
AffšeT¿nsfÜm
 
	gR’d”SVGResourûM¬k”
::
m¬k”T¿nsfÜm©iÚ
(cÚ¡ 
FlßtPošt
& 
Üigš
, 
autoAngË
, 
¡rokeWidth
) const

134 
SVGM¬k”EËm’t
* 
	gm¬k”
 = 
¡©ic_ÿ¡
<SVGM¬k”EËm’t*>(
node
());

135 
ASSERT
(
m¬k”
);

137 
	gm¬k”AngË
 = 
ªgË
();

138 
boŞ
 
	gu£SŒokeWidth
 = (
m¬k”
->
m¬k”Un™s
(è=ğ
SVGM¬k”EËm’t
::
SVG_MARKERUNITS_STROKEWIDTH
);

140 
AffšeT¿nsfÜm
 
	gŒªsfÜm
;

141 
	gŒªsfÜm
.
Œª¦©e
(
Üigš
.
x
(), origš.
y
());

142 
	gŒªsfÜm
.
rÙ©e
(
m¬k”AngË
 =ğ-1 ? 
autoAngË
 : markerAngle);

143 
	gŒªsfÜm
 = 
m¬k”CÚ‹ÁT¿nsfÜm©iÚ
(
ŒªsfÜm
, 
»ã»nûPošt
(), 
u£SŒokeWidth
 ? 
¡rokeWidth
 : -1);

144  
	gŒªsfÜm
;

147 
	gR’d”SVGResourûM¬k”
::
d¿w
(
R’d”Objeù
::
PaštInfo
& 
·štInfo
, cÚ¡ 
AffšeT¿nsfÜm
& 
ŒªsfÜm
)

149 
DEFINE_STATIC_LOCAL
(
HashS‘
<
R’d”SVGResourûM¬k”
*>, 
cu¼’yD¿wšgM¬k”s
, ());

152 ià(
	gcu¼’yD¿wšgM¬k”s
.
cÚšs
(
this
))

155 
	gcu¼’yD¿wšgM¬k”s
.
add
(
this
);

156 
	gR’d”Objeù
::
PaštInfo
 
šfo
(
·štInfo
);

157 
	gšfo
.
	gcÚ‹xt
->
§ve
();

158 
­¶yT¿nsfÜmToPaštInfo
(
šfo
, 
ŒªsfÜm
);

159 
	gR’d”SVGCÚš”
::
·št
(
šfo
, 0, 0);

160 
	gšfo
.
	gcÚ‹xt
->
»¡Üe
();

162 
	gcu¼’yD¿wšgM¬k”s
.
»move
(
this
);

165 
AffšeT¿nsfÜm
 
	gR’d”SVGResourûM¬k”
::
m¬k”CÚ‹ÁT¿nsfÜm©iÚ
(cÚ¡ AffšeT¿nsfÜm& 
cÚ‹ÁT¿nsfÜm©iÚ
, cÚ¡ 
FlßtPošt
& 
Üigš
, 
¡rokeWidth
) const

168 
FlßtPošt
 
	gm­³dOrigš
 = 
v›wpÜtT¿nsfÜm
().
m­Pošt
(
Üigš
);

170 
AffšeT¿nsfÜm
 
	gŒªsfÜm©iÚ
 = 
cÚ‹ÁT¿nsfÜm©iÚ
;

171 ià(
	g¡rokeWidth
 != -1)

172 
ŒªsfÜm©iÚ
.
sÿËNÚUnifÜm
(
¡rokeWidth
, strokeWidth);

174 
	gŒªsfÜm©iÚ
.
Œª¦©e
(-
m­³dOrigš
.
x
(), -m­³dOrigš.
y
());

175  
	gŒªsfÜm©iÚ
;

178 
AffšeT¿nsfÜm
 
	gR’d”SVGResourûM¬k”
::
v›wpÜtT¿nsfÜm
() const

180 
SVGM¬k”EËm’t
* 
m¬k”
 = 
¡©ic_ÿ¡
<SVGM¬k”EËm’t*>(
node
());

181 
ASSERT
(
m¬k”
);

183  
	gm¬k”
->
v›wBoxToV›wT¿nsfÜm
(
m_v›wpÜt
.
width
(), m_v›wpÜt.
height
());

186 
	gR’d”SVGResourûM¬k”
::
ÿlcV›wpÜt
()

188 ià(!
£lfN“dsLayout
())

191 
SVGM¬k”EËm’t
* 
	gm¬k”
 = 
¡©ic_ÿ¡
<SVGM¬k”EËm’t*>(
node
());

192 
ASSERT
(
m¬k”
);

194 
	gw
 = 
m¬k”
->
m¬k”Width
().
v®ue
(marker);

195 
	gh
 = 
m¬k”
->
m¬k”Height
().
v®ue
(marker);

196 
	gm_v›wpÜt
 = 
FlßtReù
(0, 0, 
w
, 
h
);

	@RenderSVGResourceMarker.h

21 #iâdeà
R’d”SVGResourûM¬k”_h


22 
	#R’d”SVGResourûM¬k”_h


	)

24 #ià
ENABLE
(
SVG
)

25 
	~"FlßtReù.h
"

26 
	~"R’d”Objeù.h
"

27 
	~"R’d”SVGResourû.h
"

28 
	~"SVGM¬k”EËm’t.h
"

29 
	~"SVGStyËdEËm’t.h
"

31 
	~<wtf/HashS‘.h
>

33 
Çme¥aû
 
	gWebCÜe
 {

35 
şass
 
	gAffšeT¿nsfÜm
;

37 şas 
	cR’d”SVGResourûM¬k”
 : 
public
 
R’d”SVGResourû
 {

39 
public
:

40 
R’d”SVGResourûM¬k”
(
SVGStyËdEËm’t
*);

41 
	gvœtu®
 ~
R’d”SVGResourûM¬k”
();

43 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderSVGResourceMarker"; }

45 
addCl›Á
(cÚ¡ 
R’d”Objeù
*);

46 
vœtu®
 
šv®id©eCl›Ás
();

47 
vœtu®
 
šv®id©eCl›Á
(
R’d”Objeù
*);

49 
d¿w
(
R’d”Objeù
::
PaštInfo
&, cÚ¡ 
AffšeT¿nsfÜm
&);

52 
FlßtReù
 
m¬k”Bound¬›s
(cÚ¡ 
AffšeT¿nsfÜm
& 
m¬k”T¿nsfÜm©iÚ
) const;

54 
vœtu®
 
­¶yV›wpÜtCl
(
PaštInfo
&);

55 
vœtu®
 
Ïyout
();

56 
vœtu®
 
ÿlcV›wpÜt
();

58 
vœtu®
 cÚ¡ 
	gAffšeT¿nsfÜm
& 
loÿlToP¬’tT¿nsfÜm
() const;

59 
AffšeT¿nsfÜm
 
m¬k”T¿nsfÜm©iÚ
(cÚ¡ 
FlßtPošt
& 
Üigš
, 
ªgË
, 
¡rokeWidth
) const;

61 
vœtu®
 
boŞ
 
­¶yResourû
(
R’d”Objeù
*, 
G¿phicsCÚ‹xt
*è{  
	gçl£
; }

62 
vœtu®
 
FlßtReù
 
»sourûBoundšgBox
(const FloatRect&) const {  FloatRect(); }

64 
FlßtPošt
 
»ã»nûPošt
() const;

65 
ªgË
() const;

66 
	gSVGM¬k”EËm’t
::
SVGM¬k”Un™sTy³
 
m¬k”Un™s
(ècÚ¡ {  
¡©ic_ÿ¡
<
SVGM¬k”EËm’t
::SVGM¬k”Un™sTy³>(¡©ic_ÿ¡<SVGM¬k”EËm’t*>(
node
())->markerUnits()); }

68 
vœtu®
 
R’d”SVGResourûTy³
 
»sourûTy³
(ècÚ¡ {  
	gs_»sourûTy³
; }

69 
R’d”SVGResourûTy³
 
	gs_»sourûTy³
;

71 
	g´iv©e
:

74 
AffšeT¿nsfÜm
 
m¬k”CÚ‹ÁT¿nsfÜm©iÚ
(cÚ¡ AffšeT¿nsfÜm& 
cÚ‹ÁT¿nsfÜm©iÚ
, cÚ¡ 
FlßtPošt
& 
Üigš
, 
¡rokeWidth
 = -1) const;

76 
AffšeT¿nsfÜm
 
v›wpÜtT¿nsfÜm
() const;

79 
	gHashS‘
<cÚ¡ 
	gR’d”Objeù
*> 
	gm_m¬k”
;

81 
mubË
 
AffšeT¿nsfÜm
 
	gm_loÿlToP¬’tT¿nsfÜm
;

82 
FlßtReù
 
	gm_v›wpÜt
;

	@RenderSVGResourceMasker.cpp

21 
	~"cÚfig.h
"

22 
	~"R’d”SVGResourûMask”.h
"

24 
	~"AffšeT¿nsfÜm.h
"

25 
	~"CªvasPix–A¼ay.h
"

26 
	~"EËm’t.h
"

27 
	~"FlßtPošt.h
"

28 
	~"FlßtReù.h
"

29 
	~"G¿phicsCÚ‹xt.h
"

30 
	~"Image.h
"

31 
	~"ImageBufãr.h
"

32 
	~"ImageD©a.h
"

33 
	~"IÁReù.h
"

34 
	~"R’d”SVGResourû.h
"

35 
	~"SVGEËm’t.h
"

36 
	~"SVGMaskEËm’t.h
"

37 
	~"SVGStyËdEËm’t.h
"

38 
	~"SVGUn™Ty³s.h
"

39 
	~<wtf/VeùÜ.h
>

41 
Çme¥aû
 
	gWebCÜe
 {

43 
R’d”SVGResourûTy³
 
	gR’d”SVGResourûMask”
::
s_»sourûTy³
 = 
Mask”ResourûTy³
;

45 
	gR’d”SVGResourûMask”
::
R’d”SVGResourûMask”
(
SVGStyËdEËm’t
* 
node
)

46 : 
R’d”SVGResourû
(
node
)

50 
R’d”SVGResourûMask”
::~RenderSVGResourceMasker()

52 
d–‘eAÎV®ues
(
m_mask”
);

53 
	gm_mask”
.
ş—r
();

56 
	gR’d”SVGResourûMask”
::
šv®id©eCl›Ás
()

58 
HashM­
<
R’d”Objeù
*, 
	gMask”D©a
*>::
cÚ¡_™”©Ü
 
’d
 = 
m_mask”
.end();

59 
	gHashM­
<
	gR’d”Objeù
*, 
	gMask”D©a
*>::
cÚ¡_™”©Ü
 
™
 = 
m_mask”
.
begš
(); 
	g™
 !ğ
’d
; ++it) {

60 
R’d”Objeù
* 
	g»nd””
 = 
™
->
fœ¡
;

61 
	g»nd””
->
£tN“dsBound¬›sUpd©e
();

62 
	g»nd””
->
£tN“dsLayout
(
Œue
);

65 
d–‘eAÎV®ues
(
m_mask”
);

66 
	gm_mask”
.
ş—r
();

69 
	gR’d”SVGResourûMask”
::
šv®id©eCl›Á
(
R’d”Objeù
* 
objeù
)

71 
ASSERT
(
objeù
);

77 ià(!
	gm_mask”
.
cÚšs
(
objeù
))

80 
d–‘e
 
	gm_mask”
.
ke
(
objeù
);

83 
boŞ
 
	gR’d”SVGResourûMask”
::
­¶yResourû
(
R’d”Objeù
* 
objeù
, 
G¿phicsCÚ‹xt
* 
cÚ‹xt
)

85 
ASSERT
(
objeù
);

86 
ASSERT
(
cÚ‹xt
);

88 ià(!
	gm_mask”
.
cÚšs
(
objeù
))

89 
	gm_mask”
.
£t
(
objeù
, 
Ãw
 
Mask”D©a
);

91 
Mask”D©a
* 
	gmask”D©a
 = 
m_mask”
.
g‘
(
objeù
);

92 ià(!
	gmask”D©a
->
	gmaskImage
 && !mask”D©a->
	gem±yMask
) {

93 
SVGMaskEËm’t
* 
	gmaskEËm’t
 = 
¡©ic_ÿ¡
<SVGMaskEËm’t*>(
node
());

94 ià(!
	gmaskEËm’t
)

95  
	gçl£
;

97 
ü—‹MaskImage
(
mask”D©a
, 
maskEËm’t
, 
objeù
);

100 ià(!
	gmask”D©a
->
	gmaskImage
)

101  
	gçl£
;

103 
	gcÚ‹xt
->
şToImageBufãr
(
mask”D©a
->
maskReù
, mask”D©a->
maskImage
.
g‘
());

104  
	gŒue
;

107 
FlßtReù
 
	gR’d”SVGResourûMask”
::
»sourûBoundšgBox
(cÚ¡ FlßtReù& 
objeùBoundšgBox
) const

109 ià(
SVGMaskEËm’t
* 
–em’t
 = 
¡©ic_ÿ¡
<SVGMaskEËm’t*>(
node
()))

110  
–em’t
->
maskBoundšgBox
(
objeùBoundšgBox
);

112  
FlßtReù
();

115 
	gR’d”SVGResourûMask”
::
ü—‹MaskImage
(
Mask”D©a
* 
mask”D©a
, cÚ¡ 
SVGMaskEËm’t
* 
maskEËm’t
, 
R’d”Objeù
* 
objeù
)

117 
FlßtReù
 
	gobjeùBoundšgBox
 = 
objeù
->
objeùBoundšgBox
();

120 
	gmask”D©a
->
	gmaskReù
 = 
objeù
->
»·štReùInLoÿlCoÜdš©es
();

121 ià(
	gmask”D©a
->
	gmaskReù
.
isEm±y
()) {

122 
	gmask”D©a
->
	gem±yMask
 = 
Œue
;

127 
FlßtReù
 
	g»·štReù
;

128 
	gVeùÜ
<
	gR’d”Objeù
*> 
	g»nd””Li¡
;

129 
Node
* 
	gnode
 = 
maskEËm’t
->
fœ¡Chd
();‚ode;‚odğ
node
->
ÃxtSiblšg
()) {

130 
R’d”Objeù
* 
»nd””
 = 
node
->renderer();

131 ià(!
	gnode
->
isSVGEËm’t
(è|| !
	g¡©ic_ÿ¡
<
	gSVGEËm’t
*>Òode)->
isStyËd
(è|| !
	g»nd””
)

134 
	g»nd””Li¡
.
­³nd
(
»nd””
);

135 
	g»·štReù
.
un™e
(
»nd””
->
loÿlToP¬’tT¿nsfÜm
().
m­Reù
Ô’d””->
»·štReùInLoÿlCoÜdš©es
()));

138 
AffšeT¿nsfÜm
 
	gcÚ‹xtT¿nsfÜm
;

140 ià(
	gmaskEËm’t
->
maskCÚ‹ÁUn™s
(è=ğ
SVGUn™Ty³s
::
SVG_UNIT_TYPE_OBJECTBOUNDINGBOX
) {

141 
cÚ‹xtT¿nsfÜm
.
sÿËNÚUnifÜm
(
objeùBoundšgBox
.
width
(), objeùBoundšgBox.
height
());

142 
FlßtPošt
 
	gcÚ‹xtAdju¡m’t
 = 
»·štReù
.
loÿtiÚ
();

143 
	g»·štReù
 = 
cÚ‹xtT¿nsfÜm
.
m­Reù
(
»·štReù
);

144 
	g»·štReù
.
move
(
objeùBoundšgBox
.
x
(), objeùBoundšgBox.
y
());

145 
	gcÚ‹xtT¿nsfÜm
.
Œª¦©e
(-
cÚ‹xtAdju¡m’t
.
x
(), -cÚ‹xtAdju¡m’t.
y
());

147 
	g»·štReù
.
š‹r£ù
(
mask”D©a
->
maskReù
);

148 
	gmask”D©a
->
	gmaskReù
 = 
»·štReù
;

149 
IÁReù
 
	gmaskImageReù
 = 
’şosšgIÁReù
(
mask”D©a
->
maskReù
);

151 
	gmaskImageReù
.
£tLoÿtiÚ
(
IÁPošt
());

154 ià(!
	gmaskImageReù
.
width
(è|| !maskImageReù.
height
()) {

155 
	gmask”D©a
->
	gem±yMask
 = 
Œue
;

162 
	gmask”D©a
->
	gmaskImage
 = 
ImageBufãr
::
ü—‹
(
maskImageReù
.
size
(), 
Lš—rRGB
);

163 ià(!
	gmask”D©a
->
	gmaskImage
)

166 
G¿phicsCÚ‹xt
* 
	gmaskImageCÚ‹xt
 = 
mask”D©a
->
maskImage
->
cÚ‹xt
();

167 
ASSERT
(
maskImageCÚ‹xt
);

169 
	gmaskImageCÚ‹xt
->
§ve
();

171 ià(
	gmaskEËm’t
->
maskCÚ‹ÁUn™s
(è=ğ
SVGUn™Ty³s
::
SVG_UNIT_TYPE_USERSPACEONUSE
)

172 
maskImageCÚ‹xt
->
Œª¦©e
(-
mask”D©a
->
maskReù
.
x
(), -mask”D©a->maskReù.
y
());

173 
	gmaskImageCÚ‹xt
->
cÚÿtCTM
(
cÚ‹xtT¿nsfÜm
);

176 
	gVeùÜ
<
	gR’d”Objeù
*>::
™”©Ü
 
’d
 = 
»nd””Li¡
.end();

177 
	gVeùÜ
<
	gR’d”Objeù
*>::
™”©Ü
 
™
 = 
»nd””Li¡
.
begš
(); 
	g™
 !ğ
’d
; it++)

178 
»nd”SubŒ“ToImage
(
mask”D©a
->
maskImage
.
g‘
(), *
™
);

180 
	gmaskImageCÚ‹xt
->
»¡Üe
();

183 
	gRefPŒ
<
	gImageD©a
> 
imageD©a
(
mask”D©a
->
maskImage
->
g‘UnmuÉl›dImageD©a
(
maskImageReù
));

184 
CªvasPix–A¼ay
* 
¤cPix–A¼ay
(
imageD©a
->
d©a
());

186 
	gpix–Off£t
 = 0;…ix–Off£ˆ< 
	g¤cPix–A¼ay
->
Ëngth
();…ixelOffset += 4) {

187 
a
 = 
¤cPix–A¼ay
->
g‘
(
pix–Off£t
 + 3);

188 ià(!
	ga
)

190 
	gr
 = 
¤cPix–A¼ay
->
g‘
(
pix–Off£t
);

191 
	gg
 = 
¤cPix–A¼ay
->
g‘
(
pix–Off£t
 + 1);

192 
	gb
 = 
¤cPix–A¼ay
->
g‘
(
pix–Off£t
 + 2);

194 
	gluma
 = (
r
 * 0.2125 + 
g
 * 0.7154 + 
b
 * 0.0721è* (()
a
 / 255.0);

195 
	g¤cPix–A¼ay
->
£t
(
pix–Off£t
 + 3, 
luma
);

198 
	gmask”D©a
->
	gmaskImage
->
putUnmuÉl›dImageD©a
(
imageD©a
.
g‘
(), 
maskImageReù
, 
IÁPošt
());

	@RenderSVGResourceMasker.h

21 #iâdeà
R’d”SVGResourûMask”_h


22 
	#R’d”SVGResourûMask”_h


	)

24 #ià
ENABLE
(
SVG
)

25 
	~"FlßtReù.h
"

26 
	~"G¿phicsCÚ‹xt.h
"

27 
	~"ImageBufãr.h
"

28 
	~"IÁSize.h
"

29 
	~"R’d”SVGResourû.h
"

30 
	~"SVGMaskEËm’t.h
"

31 
	~"SVGUn™Ty³s.h
"

33 
	~<wtf/HashM­.h
>

34 
	~<wtf/OwnPŒ.h
>

36 
Çme¥aû
 
	gWebCÜe
 {

38 
	sMask”D©a
 {

39 
Mask”D©a
(
FlßtReù
 
»ù
 = FlßtReù(), 
boŞ
 
em±yObjeù
 = 
çl£
)

40 : 
maskReù
(
»ù
)

41 , 
em±yMask
(
em±yObjeù
)

45 
	gOwnPŒ
<
	gImageBufãr
> 
	gmaskImage
;

46 
FlßtReù
 
	gmaskReù
;

47 
boŞ
 
	gem±yMask
;

50 şas 
	cR’d”SVGResourûMask”
 : 
public
 
R’d”SVGResourû
 {

52 
public
:

53 
R’d”SVGResourûMask”
(
SVGStyËdEËm’t
*);

54 
	gvœtu®
 ~
R’d”SVGResourûMask”
();

56 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderSVGResourceMasker"; }

58 
vœtu®
 
šv®id©eCl›Ás
();

59 
vœtu®
 
šv®id©eCl›Á
(
R’d”Objeù
*);

61 
vœtu®
 
boŞ
 
­¶yResourû
(
R’d”Objeù
*, 
G¿phicsCÚ‹xt
*);

62 
vœtu®
 
FlßtReù
 
»sourûBoundšgBox
(const FloatRect&) const;

64 
	gSVGUn™Ty³s
::
SVGUn™Ty³
 
maskUn™s
(ècÚ¡ {  
toUn™Ty³
(
¡©ic_ÿ¡
<
SVGMaskEËm’t
*>(
node
())->maskUnits()); }

65 
	gSVGUn™Ty³s
::
SVGUn™Ty³
 
maskCÚ‹ÁUn™s
(ècÚ¡ {  
toUn™Ty³
(
¡©ic_ÿ¡
<
SVGMaskEËm’t
*>(
node
())->maskContentUnits()); }

67 
vœtu®
 
R’d”SVGResourûTy³
 
»sourûTy³
(ècÚ¡ {  
	gs_»sourûTy³
; }

68 
R’d”SVGResourûTy³
 
	gs_»sourûTy³
;

70 
	g´iv©e
:

71 
ü—‹MaskImage
(
Mask”D©a
*, cÚ¡ 
SVGMaskEËm’t
*, 
R’d”Objeù
*);

73 
	gHashM­
<
	gR’d”Objeù
*, 
	gMask”D©a
*> 
	gm_mask”
;

	@RenderSVGRoot.cpp

23 
	~"cÚfig.h
"

25 #ià
ENABLE
(
SVG
)

26 
	~"R’d”SVGRoÙ.h
"

28 
	~"G¿phicsCÚ‹xt.h
"

29 
	~"R’d”SVGCÚš”.h
"

30 
	~"R’d”V›w.h
"

31 
	~"SVGL’gth.h
"

32 
	~"SVGR’d”SuµÜt.h
"

33 
	~"SVGSVGEËm’t.h
"

34 
	~"SVGStyËdEËm’t.h
"

35 
	~"T¿nsfÜmS‹.h
"

37 #ià
ENABLE
(
FILTERS
)

38 
	~"SVGResourûF‹r.h
"

41 
usšg
 
Çme¥aû
 
	g¡d
;

43 
Çme¥aû
 
	gWebCÜe
 {

45 
	gR’d”SVGRoÙ
::
R’d”SVGRoÙ
(
SVGStyËdEËm’t
* 
node
)

46 : 
R’d”Box
(
node
)

48 
£tR•Ïûd
(
Œue
);

51 
	gR’d”SVGRoÙ
::
lšeHeight
(
boŞ
, bool) const

53  
height
(è+ 
m¬gšTİ
(è+ 
m¬gšBÙtom
();

56 
	gR’d”SVGRoÙ
::
ba£lšePos™iÚ
(
boŞ
, bool) const

58  
height
(è+ 
m¬gšTİ
(è+ 
m¬gšBÙtom
();

61 
	gR’d”SVGRoÙ
::
ÿlcP»fWidths
()

63 
ASSERT
(
´efWidthsDœty
());

65 
	g·ddšgAndBÜd”s
 = 
·ddšgLeá
(è+ 
·ddšgRight
(è+ 
bÜd”Leá
(è+ 
bÜd”Right
();

66 
	gwidth
 = 
ÿlcR•ÏûdWidth
(
çl£
è+ 
·ddšgAndBÜd”s
;

68 ià(
¡yË
()->
maxWidth
().
isFixed
(è&& styË()->maxWidth().
v®ue
(è!ğ
undefšedL’gth
)

69 
width
 = 
mš
(width, 
¡yË
()->
maxWidth
().
v®ue
(è+ (¡yË()->
boxSizšg
(è=ğ
CONTENT_BOX
 ? 
·ddšgAndBÜd”s
 : 0));

71 ià(
¡yË
()->
width
().
isP”ûÁ
(è|| (¡yË()->width().
isAuto
(è&& styË()->
height
().isPercent())) {

72 
	gm_mšP»fWidth
 = 0;

73 
	gm_maxP»fWidth
 = 
width
;

75 
	gm_mšP»fWidth
 = 
m_maxP»fWidth
 = 
width
;

77 
£tP»fWidthsDœty
(
çl£
);

80 
	gR’d”SVGRoÙ
::
ÿlcR•ÏûdWidth
(
boŞ
 
šşudeMaxWidth
) const

82 
»¶aûdWidth
 = 
R’d”Box
::
ÿlcR•ÏûdWidth
(
šşudeMaxWidth
);

83 ià(!
¡yË
()->
width
().
isP”ûÁ
())

84  
	g»¶aûdWidth
;

87 
SVGSVGEËm’t
* 
	gsvg
 = 
¡©ic_ÿ¡
<SVGSVGEËm’t*>(
node
());

88  
	g¡©ic_ÿ¡
<>(
roundf
(
»¶aûdWidth
 * 
svg
->
cu¼’tSÿË
()));

91 
	gR’d”SVGRoÙ
::
ÿlcR•ÏûdHeight
() const

93 
»¶aûdHeight
 = 
R’d”Box
::
ÿlcR•ÏûdHeight
();

94 ià(!
¡yË
()->
height
().
isP”ûÁ
())

95  
	g»¶aûdHeight
;

98 
SVGSVGEËm’t
* 
	gsvg
 = 
¡©ic_ÿ¡
<SVGSVGEËm’t*>(
node
());

99  
	g¡©ic_ÿ¡
<>(
roundf
(
»¶aûdHeight
 * 
svg
->
cu¼’tSÿË
()));

102 
	gR’d”SVGRoÙ
::
Ïyout
()

104 
ASSERT
(
ÃedsLayout
());

107 
v›w
()->
di§bËLayoutS‹
();

109 
boŞ
 
	gÃedsLayout
 = 
£lfN“dsLayout
();

110 
LayoutR•aš‹r
 
»·š‹r
(*
this
, 
checkFÜR•aštDuršgLayout
(è&& 
ÃedsLayout
);

112 
IÁSize
 
ŞdSize
(
width
(), 
height
());

113 
ÿlcWidth
();

114 
ÿlcHeight
();

116 
ÿlcV›wpÜt
();

120 
SVGSVGEËm’t
* 
	gsvg
 = 
¡©ic_ÿ¡
<SVGSVGEËm’t*>(
node
());

121 
ÏyoutChd»n
(
this
, 
ÃedsLayout
 || (
svg
->
hasR–©iveV®ues
(è&& 
ŞdSize
 !ğ
size
()));

122 
	g»·š‹r
.
»·štAá”Layout
();

124 
v›w
()->
’abËLayoutS‹
();

125 
£tN“dsLayout
(
çl£
);

128 
boŞ
 
	gR’d”SVGRoÙ
::
£lfWlPašt
() const

130 #ià
ENABLE
(
FILTERS
)

131 cÚ¡ 
SVGR’d”StyË
* 
svgStyË
 = 
¡yË
()->svgStyle();

132 
SVGResourûF‹r
* 
	gf‹r
 = 
g‘F‹rById
(
docum’t
(), 
svgStyË
->
f‹r
(), 
this
);

133 ià(
	gf‹r
)

134  
	gŒue
;

136  
	gçl£
;

139 
	gR’d”SVGRoÙ
::
·št
(
PaštInfo
& 
·štInfo
, 
·»ÁX
, 
·»ÁY
)

141 ià(
	g·štInfo
.
	gcÚ‹xt
->
·štšgDi§bËd
())

144 
IÁPošt
 
·»ÁOrigšInCÚš”
(
·»ÁX
, 
·»ÁY
);

145 
IÁPošt
 
	gbÜd”BoxOrigšInCÚš”
 = 
·»ÁOrigšInCÚš”
 + 
·»ÁOrigšToBÜd”Box
();

147 ià(
hasBoxDecÜ©iÚs
(è&& (
	g·štInfo
.
	gpha£
 =ğ
PaštPha£FÜeground
 || 
·štInfo
.
pha£
 =ğ
PaštPha£S–eùiÚ
))

148 
·štBoxDecÜ©iÚs
(
·štInfo
, 
bÜd”BoxOrigšInCÚš”
.
x
(), bÜd”BoxOrigšInCÚš”.
y
());

151 ià(
	gm_v›wpÜtSize
.
isEm±y
())

155 ià(!
fœ¡Chd
(è&& !
£lfWlPašt
())

159 
	gR’d”Objeù
::
PaštInfo
 
chdPaštInfo
(
·štInfo
);

160 
	gchdPaštInfo
.
	gcÚ‹xt
->
§ve
();

163 
	gchdPaštInfo
.
	gcÚ‹xt
->
ş
(
ov”æowClReù
(
bÜd”BoxOrigšInCÚš”
.
x
(), bÜd”BoxOrigšInCÚš”.
y
()));

167 
­¶yT¿nsfÜmToPaštInfo
(
chdPaštInfo
, 
loÿlToR•aštCÚš”T¿nsfÜm
(
·»ÁOrigšInCÚš”
));

169 
SVGResourûF‹r
* 
	gf‹r
 = 0;

170 
FlßtReù
 
	gboundšgBox
 = 
»·štReùInLoÿlCoÜdš©es
();

172 
boŞ
 
	gcÚtšueR’d”šg
 = 
Œue
;

173 ià(
	gchdPaštInfo
.
	gpha£
 =ğ
PaštPha£FÜeground
)

174 
cÚtšueR’d”šg
 = 
´•¬eToR’d”SVGCÚ‹Á
(
this
, 
chdPaštInfo
, 
boundšgBox
, 
f‹r
);

176 ià(
	gcÚtšueR’d”šg
)

177 
	gR’d”Box
::
·št
(
chdPaštInfo
, 0, 0);

179 ià(
	gchdPaštInfo
.
	gpha£
 =ğ
PaštPha£FÜeground
)

180 
fšishR’d”SVGCÚ‹Á
(
this
, 
chdPaštInfo
, 
f‹r
, 
·štInfo
.
cÚ‹xt
);

182 
	gchdPaštInfo
.
	gcÚ‹xt
->
»¡Üe
();

184 ià((
	g·štInfo
.
	gpha£
 =ğ
PaštPha£Ouše
 || 
·štInfo
.
pha£
 =ğ
PaštPha£S–fOuše
è&& 
¡yË
()->
oušeWidth
(è&& styË()->
visib™y
(è=ğ
VISIBLE
)

185 
·štOuše
(
·štInfo
.
cÚ‹xt
, 
bÜd”BoxOrigšInCÚš”
.
x
(), bÜd”BoxOrigšInCÚš”.
y
(), 
width
(), 
height
());

188 
	gR’d”SVGRoÙ
::
de¡roy
()

190 
d”egi¡”FromResourûs
(
this
);

191 
	gR’d”Box
::
de¡roy
();

194 
	gR’d”SVGRoÙ
::
ÿlcV›wpÜt
()

196 
SVGSVGEËm’t
* 
svg
 = 
¡©ic_ÿ¡
<SVGSVGEËm’t*>(
node
());

198 ià(!
£lfN“dsLayout
(è&& !
	gsvg
->
hasR–©iveV®ues
())

201 ià(!
	gsvg
->
hasS‘CÚš”Size
()) {

204 
	gm_v›wpÜtSize
 = 
FlßtSize
(
width
(), 
height
());

211 
SVGL’gth
 
	gwidth
 = 
svg
->
width
();

212 
SVGL’gth
 
	gheight
 = 
svg
->
height
();

213 
	gm_v›wpÜtSize
 = 
FlßtSize
(
width
.
un™Ty³
(è=ğ
L’gthTy³P”ûÁage
 ? 
svg
->
»ÏtiveWidthV®ue
(è: width.
v®ue
(svg),

214 
height
.
un™Ty³
(è=ğ
L’gthTy³P”ûÁage
 ? 
svg
->
»ÏtiveHeightV®ue
(è: height.
v®ue
(svg));

219 
AffšeT¿nsfÜm
 
	gR’d”SVGRoÙ
::
loÿlToBÜd”BoxT¿nsfÜm
() const

221 
IÁSize
 
bÜd”AndPaddšg
 = 
bÜd”OrigšToCÚ‹ÁBox
();

222 
SVGSVGEËm’t
* 
	gsvg
 = 
¡©ic_ÿ¡
<SVGSVGEËm’t*>(
node
());

223 
	gsÿË
 = 
svg
->
cu¼’tSÿË
();

224 
FlßtPošt
 
	gŒª¦©e
 = 
svg
->
cu¼’tT¿n¦©e
();

225 
AffšeT¿nsfÜm
 
ùm
(
sÿË
, 0, 0, sÿË, 
bÜd”AndPaddšg
.
width
(è+ 
Œª¦©e
.
x
(), bÜd”AndPaddšg.
height
(è+¿n¦©e.
y
());

226  
	gsvg
->
v›wBoxToV›wT¿nsfÜm
(
width
(è/ 
sÿË
, 
height
(è/ sÿËè* 
	gùm
;

229 
IÁSize
 
	gR’d”SVGRoÙ
::
·»ÁOrigšToBÜd”Box
() const

231  
IÁSize
(
x
(), 
y
());

234 
IÁSize
 
	gR’d”SVGRoÙ
::
bÜd”OrigšToCÚ‹ÁBox
() const

236  
IÁSize
(
bÜd”Leá
(è+ 
·ddšgLeá
(), 
bÜd”Tİ
(è+ 
·ddšgTİ
());

239 
AffšeT¿nsfÜm
 
	gR’d”SVGRoÙ
::
loÿlToR•aštCÚš”T¿nsfÜm
(cÚ¡ 
IÁPošt
& 
·»ÁOrigšInCÚš”
) const

241 
AffšeT¿nsfÜm
 
·»ÁToCÚš”
(
loÿlToP¬’tT¿nsfÜm
());

242  
	g·»ÁToCÚš”
.
Œª¦©eRight
(
·»ÁOrigšInCÚš”
.
x
(),…¬’tOrigšInCÚš”.
y
());

245 cÚ¡ 
	gAffšeT¿nsfÜm
& 
	gR’d”SVGRoÙ
::
loÿlToP¬’tT¿nsfÜm
() const

247 
IÁSize
 
·»ÁToBÜd”BoxOff£t
 = 
·»ÁOrigšToBÜd”Box
();

249 
AffšeT¿nsfÜm
 
bÜd”BoxOrigšToP¬’tOrigš
(
loÿlToBÜd”BoxT¿nsfÜm
());

250 
	gbÜd”BoxOrigšToP¬’tOrigš
.
Œª¦©eRight
(
·»ÁToBÜd”BoxOff£t
.
width
(),…¬’tToBÜd”BoxOff£t.
height
());

252 
	gm_loÿlToP¬’tT¿nsfÜm
 = 
bÜd”BoxOrigšToP¬’tOrigš
;

253  
	gm_loÿlToP¬’tT¿nsfÜm
;

256 
FlßtReù
 
	gR’d”SVGRoÙ
::
objeùBoundšgBox
() const

258  
compu‹CÚš”BoundšgBox
(
this
, 
çl£
);

261 
FlßtReù
 
	gR’d”SVGRoÙ
::
»·štReùInLoÿlCoÜdš©es
() const

264 
FlßtReù
 
»·štReù
 = 
compu‹CÚš”BoundšgBox
(
this
, 
Œue
);

265 
¡yË
()->
svgStyË
()->
šæ©eFÜShadow
(
»·štReù
);

266  
	g»·štReù
;

269 
AffšeT¿nsfÜm
 
	gR’d”SVGRoÙ
::
loÿlT¿nsfÜm
() const

271  
AffšeT¿nsfÜm
();

274 
	gR’d”SVGRoÙ
::
compu‹ReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
IÁReù
& 
»·štReù
, 
boŞ
 
fixed
)

278 
	g»·štReù
 = 
loÿlToBÜd”BoxT¿nsfÜm
().
m­Reù
(
»·štReù
);

281 
	g»·štReù
.
š‹r£ù
(
’şosšgIÁReù
(
FlßtReù
(
FlßtPošt
(), 
m_v›wpÜtSize
)));

283 
¡yË
()->
svgStyË
()->
šæ©eFÜShadow
(
»·štReù
);

284 
	gR’d”Box
::
compu‹ReùFÜR•ašt
(
»·štCÚš”
, 
»·štReù
, 
fixed
);

287 
	gR’d”SVGRoÙ
::
m­LoÿlToCÚš”
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
boŞ
 
fixed
 , boŞ 
u£T¿nsfÜms
, 
T¿nsfÜmS‹
& 
ŒªsfÜmS‹
) const

289 
ASSERT
(!
fixed
);

290 
ASSERT
(
u£T¿nsfÜms
);

293 
	gŒªsfÜmS‹
.
­¶yT¿nsfÜm
(
loÿlToBÜd”BoxT¿nsfÜm
());

294 
	gR’d”Box
::
m­LoÿlToCÚš”
(
»·štCÚš”
, 
fixed
, 
u£T¿nsfÜms
, 
ŒªsfÜmS‹
);

297 
boŞ
 
	gR’d”SVGRoÙ
::
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
& 
»que¡
, 
H™Te¡ResuÉ
& 
»suÉ
, 
_x
, 
_y
, 
_tx
, 
_ty
, 
H™Te¡AùiÚ
 
h™Te¡AùiÚ
)

299 
IÁPošt
 
poštInCÚš”
(
_x
, 
_y
);

300 
IÁSize
 
cÚš”ToP¬’tOff£t
(
_tx
, 
_ty
);

302 
IÁPošt
 
	gpoštInP¬’t
 = 
poštInCÚš”
 - 
cÚš”ToP¬’tOff£t
;

303 
IÁPošt
 
	gpoštInBÜd”Box
 = 
poštInP¬’t
 - 
·»ÁOrigšToBÜd”Box
();

306 
IÁPošt
 
	gpoštInCÚ‹ÁBox
 = 
poštInBÜd”Box
 - 
bÜd”OrigšToCÚ‹ÁBox
();

307 ià(!
cÚ‹ÁBoxReù
().
cÚšs
(
poštInCÚ‹ÁBox
))

308  
	gçl£
;

310 
IÁPošt
 
	gloÿlPošt
 = 
loÿlToP¬’tT¿nsfÜm
().
šv”£
().
m­Pošt
(
poštInP¬’t
);

312 
R’d”Objeù
* 
	gchd
 = 
Ï¡Chd
(); chd; chd = 
chd
->
´eviousSiblšg
()) {

313 ià(
chd
->
nodeAtFlßtPošt
(
»que¡
, 
»suÉ
, 
loÿlPošt
, 
h™Te¡AùiÚ
)) {

315 
upd©eH™Te¡ResuÉ
(
»suÉ
, 
poštInBÜd”Box
);

316  
	gŒue
;

322  
	gçl£
;

	@RenderSVGRoot.h

23 #iâdeà
R’d”SVGRoÙ_h


24 
	#R’d”SVGRoÙ_h


	)

26 #ià
ENABLE
(
SVG
)

27 
	~"R’d”Box.h
"

28 
	~"FlßtReù.h
"

29 
	~"SVGR’d”SuµÜt.h
"

31 
Çme¥aû
 
	gWebCÜe
 {

33 
şass
 
	gSVGStyËdEËm’t
;

34 
şass
 
	gAffšeT¿nsfÜm
;

36 
şass
 
	gR’d”SVGRoÙ
 : 
public
 
R’d”Box
, 
´Ùeùed
 
	gSVGR’d”Ba£
 {

37 
	gpublic
:

38 
R’d”SVGRoÙ
(
SVGStyËdEËm’t
*);

40 cÚ¡ 
R’d”ObjeùChdLi¡
* 
chd»n
(ècÚ¡ {  &
	gm_chd»n
; }

41 
R’d”ObjeùChdLi¡
* 
chd»n
(è{  &
	gm_chd»n
; }

43 
	g´iv©e
:

44 
vœtu®
 
R’d”ObjeùChdLi¡
* 
vœtu®Chd»n
(è{  
chd»n
(); }

45 
vœtu®
 cÚ¡ 
R’d”ObjeùChdLi¡
* 
vœtu®Chd»n
(ècÚ¡ {  
chd»n
(); }

47 
vœtu®
 
boŞ
 
isSVGRoÙ
(ècÚ¡ {  
	gŒue
; }

48 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderSVGRoot"; }

50 
vœtu®
 
lšeHeight
(
boŞ
 
b
, boŞ 
isRoÙLšeBox
 = 
çl£
) const;

51 
vœtu®
 
ba£lšePos™iÚ
(
boŞ
 
b
, boŞ 
isRoÙLšeBox
 = 
çl£
) const;

52 
vœtu®
 
ÿlcP»fWidths
();

53 
vœtu®
 
ÿlcR•ÏûdWidth
(
boŞ
 
šşudeMaxWidth
 = 
Œue
) const;

54 
vœtu®
 
ÿlcR•ÏûdHeight
() const;

55 
vœtu®
 
Ïyout
();

56 
vœtu®
 
·št
(
PaštInfo
&, 
·»ÁX
, 
·»ÁY
);

58 
vœtu®
 
de¡roy
();

60 
vœtu®
 cÚ¡ 
	gAffšeT¿nsfÜm
& 
loÿlToP¬’tT¿nsfÜm
() const;

62 
boŞ
 
flCÚšs
(cÚ¡ 
FlßtPošt
&) const;

63 
boŞ
 
¡rokeCÚšs
(cÚ¡ 
FlßtPošt
&) const;

65 
vœtu®
 
FlßtReù
 
objeùBoundšgBox
() const;

66 
vœtu®
 
FlßtReù
 
¡rokeBoundšgBox
(ècÚ¡ {  
compu‹CÚš”BoundšgBox
(
this
, 
Œue
); }

67 
vœtu®
 
FlßtReù
 
»·štReùInLoÿlCoÜdš©es
() const;

70 
vœtu®
 
AffšeT¿nsfÜm
 
loÿlT¿nsfÜm
() const;

72 
vœtu®
 
boŞ
 
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, 
x
, 
y
, 
tx
, 
ty
, 
H™Te¡AùiÚ
);

74 
vœtu®
 
compu‹ReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
IÁReù
& 
»·štReù
, 
boŞ
 
fixed
);

76 
vœtu®
 
m­LoÿlToCÚš”
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
boŞ
 
u£T¿nsfÜms
, boŞ 
fixed
, 
T¿nsfÜmS‹
&) const;

78 
ÿlcV›wpÜt
();

80 
boŞ
 
£lfWlPašt
() const;

82 
IÁSize
 
·»ÁOrigšToBÜd”Box
() const;

83 
IÁSize
 
bÜd”OrigšToCÚ‹ÁBox
() const;

84 
AffšeT¿nsfÜm
 
loÿlToR•aštCÚš”T¿nsfÜm
(cÚ¡ 
IÁPošt
& 
·»ÁOrigšInCÚš”
) const;

85 
AffšeT¿nsfÜm
 
loÿlToBÜd”BoxT¿nsfÜm
() const;

87 
R’d”ObjeùChdLi¡
 
	gm_chd»n
;

88 
FlßtSize
 
	gm_v›wpÜtSize
;

89 
mubË
 
AffšeT¿nsfÜm
 
	gm_loÿlToP¬’tT¿nsfÜm
;

92 
šlše
 
R’d”SVGRoÙ
* 
toR’d”SVGRoÙ
(
R’d”Objeù
* 
objeù
)

94 
ASSERT
(!
objeù
 || objeù->
isSVGRoÙ
());

95  
	g¡©ic_ÿ¡
<
	gR’d”SVGRoÙ
*>(
	gobjeù
);

98 
šlše
 cÚ¡ 
R’d”SVGRoÙ
* 
toR’d”SVGRoÙ
(cÚ¡ 
R’d”Objeù
* 
objeù
)

100 
ASSERT
(!
objeù
 || objeù->
isSVGRoÙ
());

101  
	g¡©ic_ÿ¡
<cÚ¡ 
	gR’d”SVGRoÙ
*>(
	gobjeù
);

105 
toR’d”SVGRoÙ
(cÚ¡ 
R’d”SVGRoÙ
*);

	@RenderSVGShadowTreeRootContainer.cpp

20 
	~"cÚfig.h
"

22 #ià
ENABLE
(
SVG
)

23 
	~"R’d”SVGShadowT»eRoÙCÚš”.h
"

25 
	~"Mou£Ev’t.h
"

26 
	~"SVGShadowT»eEËm’ts.h
"

27 
	~"SVGU£EËm’t.h
"

29 
Çme¥aû
 
	gWebCÜe
 {

31 
	gR’d”SVGShadowT»eRoÙCÚš”
::
R’d”SVGShadowT»eRoÙCÚš”
(
SVGU£EËm’t
* 
node
)

32 : 
R’d”SVGT¿nsfÜmabËCÚš”
(
node
)

33 , 
m_»ü—‹T»e
(
çl£
)

37 
	gR’d”SVGShadowT»eRoÙCÚš”
::~
R’d”SVGShadowT»eRoÙCÚš”
()

39 ià(
m_shadowRoÙ
 && m_shadowRoÙ->
©ched
())

40 
m_shadowRoÙ
->
d‘ach
();

43 
	gR’d”SVGShadowT»eRoÙCÚš”
::
upd©eStyË
(
Node
::
StyËChªge
 
chªge
)

45 ià(
m_shadowRoÙ
 && m_shadowRoÙ->
©ched
())

46 
m_shadowRoÙ
->
»ÿlcStyË
(
chªge
);

49 
	gR’d”SVGShadowT»eRoÙCÚš”
::
upd©eFromEËm’t
()

51 
boŞ
 
hadExi¡šgT»e
 = 
m_shadowRoÙ
;

53 
SVGU£EËm’t
* 
	gu£EËm’t
 = 
¡©ic_ÿ¡
<SVGU£EËm’t*>(
node
());

54 ià(!
	gm_shadowRoÙ
) {

55 
ASSERT
(!
m_»ü—‹T»e
);

56 
	gm_shadowRoÙ
 = 
Ãw
 
SVGShadowT»eRoÙEËm’t
(
docum’t
(), 
u£EËm’t
);

57 
	gu£EËm’t
->
budP’dšgResourû
();

60 
ASSERT
(
m_shadowRoÙ
->
shadowP¬’tNode
(è=ğ
u£EËm’t
);

62 
boŞ
 
	gshouldReü—‹T»e
 = 
m_»ü—‹T»e
;

63 ià(
	gm_»ü—‹T»e
) {

64 
ASSERT
(
hadExi¡šgT»e
);

66 ià(
	gm_shadowRoÙ
->
©ched
())

67 
	gm_shadowRoÙ
->
d‘ach
();

69 
	gm_shadowRoÙ
->
»moveAÎChd»n
();

70 
	gm_»ü—‹T»e
 = 
çl£
;

76 ià((
	gshouldReü—‹T»e
 || !
	ghadExi¡šgT»e
è&& !
	gu£EËm’t
->
isP’dšgResourû
()) {

77 
	gu£EËm’t
->
budShadowAndIn¡ªûT»e
(
m_shadowRoÙ
.
g‘
());

80 
	gm_shadowRoÙ
->
©chEËm’t
(
¡yË
(), 
»nd”A»Ç
());

83 
Node
* 
	gchd
 = 
m_shadowRoÙ
->
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
())

84 
chd
->
©ch
();

87 
ASSERT
(!
m_»ü—‹T»e
);

88 
	gR’d”SVGT¿nsfÜmabËCÚš”
::
upd©eFromEËm’t
();

91 
	gR’d”SVGShadowT»eRoÙCÚš”
::
¡yËDidChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
)

93 
	gR’d”SVGT¿nsfÜmabËCÚš”
::
¡yËDidChªge
(
diff
, 
ŞdStyË
);

95 ià(
R’d”Objeù
* 
	gshadowRoÙR’d””
 = 
m_shadowRoÙ
 ? m_shadowRoÙ->
»nd””
() : 0)

96 
shadowRoÙR’d””
->
£tStyË
(
¡yË
());

	@RenderSVGShadowTreeRootContainer.h

20 #iâdeà
R’d”SVGShadowT»eRoÙCÚš”_h


21 
	#R’d”SVGShadowT»eRoÙCÚš”_h


	)

23 #ià
ENABLE
(
SVG
)

24 
	~"R’d”SVGT¿nsfÜmabËCÚš”.h
"

26 
Çme¥aû
 
	gWebCÜe
 {

28 
şass
 
	gSVGU£EËm’t
;

29 
şass
 
	gSVGShadowT»eRoÙEËm’t
;

31 şas 
	cR’d”SVGShadowT»eRoÙCÚš”
 : 
public
 
R’d”SVGT¿nsfÜmabËCÚš”
 {

32 
public
:

33 
R’d”SVGShadowT»eRoÙCÚš”
(
SVGU£EËm’t
*);

34 
	gvœtu®
 ~
R’d”SVGShadowT»eRoÙCÚš”
();

36 
m¬kShadowT»eFÜReü—tiÚ
(è{ 
	gm_»ü—‹T»e
 = 
Œue
; }

37 
upd©eStyË
(
Node
::
StyËChªge
);

38 
vœtu®
 
upd©eFromEËm’t
();

40 
	g´iv©e
:

41 
vœtu®
 
¡yËDidChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
);

43 
boŞ
 
	gm_»ü—‹T»e
;

44 
	gRefPŒ
<
	gSVGShadowT»eRoÙEËm’t
> 
	gm_shadowRoÙ
;

	@RenderSVGTSpan.cpp

24 
	~"cÚfig.h
"

26 #ià
ENABLE
(
SVG
)

27 
	~"R’d”SVGTS·n.h
"

29 
Çme¥aû
 
	gWebCÜe
 {

31 
	gR’d”SVGTS·n
::
R’d”SVGTS·n
(
Node
* 
n
)

32 : 
R’d”SVGIÆše
(
n
)

	@RenderSVGTSpan.h

23 #iâdeà
R’d”SVGTS·n_h


24 
	#R’d”SVGTS·n_h


	)

26 #ià
ENABLE
(
SVG
)

27 
	~"R’d”SVGIÆše.h
"

29 
Çme¥aû
 
	gWebCÜe
 {

30 şas 
	cR’d”SVGTS·n
 : 
public
 
R’d”SVGIÆše
 {

31 
public
:

32 
R’d”SVGTS·n
(
Node
*);

33 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderSVGTSpan"; }

	@RenderSVGText.cpp

28 
	~"cÚfig.h
"

30 #ià
ENABLE
(
SVG
)

31 
	~"R’d”SVGText.h
"

33 
	~"FlßtCÚv”siÚ.h
"

34 
	~"FlßtQuad.h
"

35 
	~"G¿phicsCÚ‹xt.h
"

36 
	~"Poš‹rEv’tsH™RuËs.h
"

37 
	~"R’d”Lay”.h
"

38 
	~"R’d”SVGRoÙ.h
"

39 
	~"SVGL’gthLi¡.h
"

40 
	~"SVGR’d”SuµÜt.h
"

41 
	~"SVGResourûF‹r.h
"

42 
	~"SVGRoÙIÆšeBox.h
"

43 
	~"SVGTextEËm’t.h
"

44 
	~"SVGT¿nsfÜmLi¡.h
"

45 
	~"SVGURIReã»nû.h
"

46 
	~"Sim¶eFÚtD©a.h
"

48 
Çme¥aû
 
	gWebCÜe
 {

50 
	gR’d”SVGText
::
R’d”SVGText
(
SVGTextEËm’t
* 
node
)

51 : 
R’d”SVGBlock
(
node
)

52 , 
m_ÃedsT¿nsfÜmUpd©e
(
Œue
)

56 
IÁReù
 
	gR’d”SVGText
::
ş³dOv”æowReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
)

58  
SVGR’d”Ba£
::
ş³dOv”æowReùFÜR•ašt
(
this
, 
»·štCÚš”
);

61 
	gR’d”SVGText
::
compu‹ReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
IÁReù
& 
»·štReù
, 
boŞ
 
fixed
)

63 
	gSVGR’d”Ba£
::
compu‹ReùFÜR•ašt
(
this
, 
»·štCÚš”
, 
»·štReù
, 
fixed
);

66 
	gR’d”SVGText
::
m­LoÿlToCÚš”
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
boŞ
 
fixed
 , boŞ 
u£T¿nsfÜms
, 
T¿nsfÜmS‹
& 
ŒªsfÜmS‹
) const

68 
	gSVGR’d”Ba£
::
m­LoÿlToCÚš”
(
this
, 
»·štCÚš”
, 
fixed
, 
u£T¿nsfÜms
, 
ŒªsfÜmS‹
);

71 
	gR’d”SVGText
::
Ïyout
()

73 
ASSERT
(
ÃedsLayout
());

74 
LayoutR•aš‹r
 
»·š‹r
(*
this
, 
checkFÜR•aštDuršgLayout
());

77 
SVGTextEËm’t
* 
	g‹xt
 = 
¡©ic_ÿ¡
<SVGTextEËm’t*>(
node
());

78 
	gxOff£t
 = ()(
‹xt
->
x
()->
g‘Fœ¡
().
v®ue
(text));

79 
	gyOff£t
 = ()(
‹xt
->
y
()->
g‘Fœ¡
().
v®ue
(text));

80 
£tLoÿtiÚ
(
xOff£t
, 
yOff£t
);

82 ià(
	gm_ÃedsT¿nsfÜmUpd©e
) {

83 
	gm_loÿlT¿nsfÜm
 = 
‹xt
->
ªim©edLoÿlT¿nsfÜm
();

84 
	gm_ÃedsT¿nsfÜmUpd©e
 = 
çl£
;

87 
	gR’d”Block
::
Ïyout
();

89 
	g»·š‹r
.
»·štAá”Layout
();

90 
£tN“dsLayout
(
çl£
);

93 
RoÙIÆšeBox
* 
	gR’d”SVGText
::
ü—‹RoÙIÆšeBox
()

95 
RoÙIÆšeBox
* 
box
 = 
Ãw
 (
»nd”A»Ç
()è
SVGRoÙIÆšeBox
(
this
);

96 
	gbox
->
£tHasVœtu®Height
();

97  
	gbox
;

100 
boŞ
 
	gR’d”SVGText
::
nodeAtFlßtPošt
(cÚ¡ 
H™Te¡Reque¡
& 
»que¡
, 
H™Te¡ResuÉ
& 
»suÉ
, cÚ¡ 
FlßtPošt
& 
poštInP¬’t
, 
H™Te¡AùiÚ
 
h™Te¡AùiÚ
)

102 
Poš‹rEv’tsH™RuËs
 
h™RuËs
(Poš‹rEv’tsH™RuËs::
SVG_TEXT_HITTESTING
, 
¡yË
()->
poš‹rEv’ts
());

103 
boŞ
 
	gisVisibË
 = (
¡yË
()->
visib™y
(è=ğ
VISIBLE
);

104 ià(
	gisVisibË
 || !
	gh™RuËs
.
	g»quœeVisibË
) {

105 ià((
	gh™RuËs
.
	gÿnH™SŒoke
 && (
¡yË
()->
svgStyË
()->
hasSŒoke
(è|| !h™RuËs.
	g»quœeSŒoke
))

106 || (
	gh™RuËs
.
	gÿnH™Fl
 && (
¡yË
()->
svgStyË
()->
hasFl
(è|| !h™RuËs.
	g»quœeFl
))) {

107 
FlßtPošt
 
	gloÿlPošt
 = 
loÿlToP¬’tT¿nsfÜm
().
šv”£
().
m­Pošt
(
poštInP¬’t
);

108  
	gR’d”Block
::
nodeAtPošt
(
»que¡
, 
»suÉ
, ()
loÿlPošt
.
x
(), (îoÿlPošt.
y
(), 0, 0, 
h™Te¡AùiÚ
);

112  
	gçl£
;

115 
	gR’d”SVGText
::
de¡roy
()

117 
d”egi¡”FromResourûs
(
this
);

118 
	gR’d”SVGBlock
::
de¡roy
();

121 
boŞ
 
	gR’d”SVGText
::
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, , , , , 
H™Te¡AùiÚ
)

123 
ASSERT_NOT_REACHED
();

124  
	gçl£
;

127 
	gR’d”SVGText
::
absŞu‹Reùs
(
VeùÜ
<
IÁReù
>& 
»ùs
, , )

129 
R’d”SVGRoÙ
* 
	groÙ
 = 
fšdSVGRoÙObjeù
(
·»Á
());

130 ià(!
	groÙ
)

135 
IÆšeFlowBox
* 
	gæow
 = 
fœ¡LšeBox
(); flow; flow = 
æow
->
ÃxtLšeBox
()) {

136 
IÆšeBox
* 
box
 = 
æow
->
fœ¡Chd
(); 
	gbox
; box = box->
ÃxtOnLše
()) {

137 
FlßtReù
 
boxReù
(
box
->
x
(), box->
y
(), box->
width
(), box->
height
());

140 
	g»ùs
.
­³nd
(
’şosšgIÁReù
(
loÿlToAbsŞu‹Quad
(
boxReù
).
boundšgBox
()));

145 
	gR’d”SVGText
::
absŞu‹Quads
(
VeùÜ
<
FlßtQuad
>& 
quads
)

147 
R’d”SVGRoÙ
* 
roÙ
 = 
fšdSVGRoÙObjeù
(
·»Á
());

148 ià(!
	groÙ
)

153 
IÆšeFlowBox
* 
	gæow
 = 
fœ¡LšeBox
(); flow; flow = 
æow
->
ÃxtLšeBox
()) {

154 
IÆšeBox
* 
box
 = 
æow
->
fœ¡Chd
(); 
	gbox
; box = box->
ÃxtOnLše
()) {

155 
FlßtReù
 
boxReù
(
box
->
x
(), box->
y
(), box->
width
(), box->
height
());

158 
	gquads
.
­³nd
(
loÿlToAbsŞu‹Quad
(
boxReù
));

163 
	gR’d”SVGText
::
·št
(
PaštInfo
& 
·štInfo
, , )

165 
PaštInfo
 
pi
(
·štInfo
);

166 
	gpi
.
	gcÚ‹xt
->
§ve
();

167 
­¶yT¿nsfÜmToPaštInfo
(
pi
, 
loÿlToP¬’tT¿nsfÜm
());

168 
	gR’d”Block
::
·št
(
pi
, 0, 0);

169 
	gpi
.
	gcÚ‹xt
->
»¡Üe
();

172 
FlßtReù
 
	gR’d”SVGText
::
objeùBoundšgBox
() const

174 
FlßtReù
 
boundšgBox
;

176 
IÆšeFlowBox
* 
	gæow
 = 
fœ¡LšeBox
(); flow; flow = 
æow
->
ÃxtLšeBox
()) {

177 
IÆšeBox
* 
box
 = 
æow
->
fœ¡Chd
(); 
	gbox
; box = box->
ÃxtOnLše
())

178 
boundšgBox
.
un™e
(
FlßtReù
(
box
->
x
(), box->
y
(), box->
width
(), box->
height
()));

181 
	gboundšgBox
.
move
(
x
(), 
y
());

182  
	gboundšgBox
;

185 
FlßtReù
 
	gR’d”SVGText
::
¡rokeBoundšgBox
() const

187 
FlßtReù
 
»·štReù
 = 
objeùBoundšgBox
();

190 ià(
¡yË
()->
svgStyË
()->
hasSŒoke
()) {

191 
	g¡rokeWidth
 = 
SVGR’d”StyË
::
cssPrim™iveToL’gth
(
this
, 
¡yË
()->
svgStyË
()->
¡rokeWidth
(), 1.0f);

193 #ià
ENABLE
(
SVG_FONTS
)

194 cÚ¡ 
	gFÚt
& 
	gfÚt
 = 
¡yË
()->
fÚt
();

195 ià(
	gfÚt
.
´im¬yFÚt
()->
isSVGFÚt
()) {

196 
	gsÿË
 = 
fÚt
.
un™sP”Em
(è> 0 ? fÚt.
size
() / font.unitsPerEm() : 0.0f;

198 ià(
	gsÿË
 != 0.0f)

199 
¡rokeWidth
 /ğ
sÿË
;

203 
	g»·štReù
.
šæ©e
(
¡rokeWidth
);

206  
	g»·štReù
;

209 
FlßtReù
 
	gR’d”SVGText
::
»·štReùInLoÿlCoÜdš©es
() const

211 
FlßtReù
 
»·štReù
 = 
¡rokeBoundšgBox
();

215 
FlßtReù
 
	g»ù
 = 
f‹rBoundšgBoxFÜR’d””
(
this
);

216 ià(!
	g»ù
.
isEm±y
())

217 
	g»·štReù
 = 
»ù
;

219 
	g»ù
 = 
ş³rBoundšgBoxFÜR’d””
(
this
);

220 ià(!
	g»ù
.
isEm±y
())

221 
	g»·štReù
.
š‹r£ù
(
»ù
);

223 
	g»ù
 = 
mask”BoundšgBoxFÜR’d””
(
this
);

224 ià(!
	g»ù
.
isEm±y
())

225 
	g»·štReù
.
š‹r£ù
(
»ù
);

227 
¡yË
()->
svgStyË
()->
šæ©eFÜShadow
(
»·štReù
);

229  
	g»·štReù
;

	@RenderSVGText.h

24 #iâdeà
R’d”SVGText_h


25 
	#R’d”SVGText_h


	)

27 #ià
ENABLE
(
SVG
)

29 
	~"AffšeT¿nsfÜm.h
"

30 
	~"R’d”SVGBlock.h
"

32 
Çme¥aû
 
	gWebCÜe
 {

34 
şass
 
	gSVGTextEËm’t
;

36 şas 
	cR’d”SVGText
 : 
public
 
R’d”SVGBlock
 {

37 
public
:

38 
R’d”SVGText
(
SVGTextEËm’t
* 
node
);

40 
vœtu®
 
£tN“dsT¿nsfÜmUpd©e
(è{ 
	gm_ÃedsT¿nsfÜmUpd©e
 = 
Œue
; }

42 
	g´iv©e
:

43 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderSVGText"; }

45 
vœtu®
 cÚ¡ 
SVGR’d”Ba£
* 
toSVGR’d”Ba£
(ècÚ¡ {  
	gthis
; }

47 
vœtu®
 
boŞ
 
isSVGText
(ècÚ¡ {  
	gŒue
; }

49 
vœtu®
 cÚ¡ 
	gAffšeT¿nsfÜm
& 
loÿlToP¬’tT¿nsfÜm
(ècÚ¡ {  
	gm_loÿlT¿nsfÜm
; }

51 
vœtu®
 
·št
(
PaštInfo
&, 
tx
, 
ty
);

52 
vœtu®
 
boŞ
 
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, 
x
, 
y
, 
tx
, 
ty
, 
H™Te¡AùiÚ
);

53 
vœtu®
 
boŞ
 
nodeAtFlßtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, cÚ¡ 
FlßtPošt
& 
poštInP¬’t
, 
H™Te¡AùiÚ
);

55 
vœtu®
 
boŞ
 
»quœesLay”
(ècÚ¡ {  
	gçl£
; }

56 
vœtu®
 
Ïyout
();

58 
vœtu®
 
de¡roy
();

60 
vœtu®
 
absŞu‹Reùs
(
VeùÜ
<
IÁReù
>&, 
tx
, 
ty
);

61 
vœtu®
 
absŞu‹Quads
(
VeùÜ
<
FlßtQuad
>&);

63 
vœtu®
 
IÁReù
 
ş³dOv”æowReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
);

64 
vœtu®
 
compu‹ReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
IÁReù
&, 
boŞ
 
fixed
 = 
çl£
);

66 
vœtu®
 
m­LoÿlToCÚš”
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
boŞ
 
u£T¿nsfÜms
, boŞ 
fixed
, 
T¿nsfÜmS‹
&) const;

68 
vœtu®
 
FlßtReù
 
objeùBoundšgBox
() const;

69 
vœtu®
 
FlßtReù
 
¡rokeBoundšgBox
() const;

70 
vœtu®
 
FlßtReù
 
»·štReùInLoÿlCoÜdš©es
() const;

72 
vœtu®
 
AffšeT¿nsfÜm
 
loÿlT¿nsfÜm
(ècÚ¡ {  
	gm_loÿlT¿nsfÜm
; }

74 
vœtu®
 
RoÙIÆšeBox
* 
ü—‹RoÙIÆšeBox
();

76 
boŞ
 
	gm_ÃedsT¿nsfÜmUpd©e
 : 1;

77 
AffšeT¿nsfÜm
 
	gm_loÿlT¿nsfÜm
;

	@RenderSVGTextPath.cpp

23 
	~"cÚfig.h
"

25 #ià
ENABLE
(
SVG
)

26 
	~"R’d”SVGTextP©h.h
"

28 
	~"FlßtQuad.h
"

29 
	~"R’d”Block.h
"

30 
	~"SVGIÆšeTextBox.h
"

31 
	~"SVGP©hEËm’t.h
"

32 
	~"SVGRoÙIÆšeBox.h
"

33 
	~"SVGTextP©hEËm’t.h
"

34 
	~"SVGT¿nsfÜmLi¡.h
"

36 
Çme¥aû
 
	gWebCÜe
 {

38 
	gR’d”SVGTextP©h
::
R’d”SVGTextP©h
(
Node
* 
n
)

39 : 
R’d”SVGIÆše
(
n
)

40 , 
m_¡¬tOff£t
(0.0f)

41 , 
m_exaùAlignm’t
(
Œue
)

42 , 
m_¡»tchM‘hod
(
çl£
)

46 
P©h
 
	gR’d”SVGTextP©h
::
ÏyoutP©h
() const

48 
SVGTextP©hEËm’t
* 
‹xtP©hEËm’t
 = 
¡©ic_ÿ¡
<SVGTextP©hEËm’t*>(
node
());

49 
SŒšg
 
	g·thId
 = 
SVGURIReã»nû
::
g‘T¬g‘
(
‹xtP©hEËm’t
->
h»f
());

50 
EËm’t
* 
	grg‘EËm’t
 = 
‹xtP©hEËm’t
->
docum’t
()->
g‘EËm’tById
(
·thId
);

51 ià(!
	grg‘EËm’t
 || !rg‘EËm’t->
hasTagName
(
SVGNames
::
·thTag
))

52  
P©h
();

54 
SVGP©hEËm’t
* 
	g·thEËm’t
 = 
¡©ic_ÿ¡
<SVGP©hEËm’t*>(
rg‘EËm’t
);

56 
P©h
 
	g·thD©a
 = 
·thEËm’t
->
toP©hD©a
();

62 
	g·thD©a
.
ŒªsfÜm
(
·thEËm’t
->
ªim©edLoÿlT¿nsfÜm
());

63  
	g·thD©a
;

66 
	gR’d”SVGTextP©h
::
¡¬tOff£t
() const

68  
¡©ic_ÿ¡
<
SVGTextP©hEËm’t
*>(
node
())->
¡¬tOff£t
().
v®ueAsP”ûÁage
();

71 
boŞ
 
	gR’d”SVGTextP©h
::
exaùAlignm’t
() const

73  
¡©ic_ÿ¡
<
SVGTextP©hEËm’t
*>(
node
())->
¥acšg
(è=ğ
SVG_TEXTPATH_SPACINGTYPE_EXACT
;

76 
boŞ
 
	gR’d”SVGTextP©h
::
¡»tchM‘hod
() const

78  
¡©ic_ÿ¡
<
SVGTextP©hEËm’t
*>(
node
())->
m‘hod
(è=ğ
SVG_TEXTPATH_METHODTYPE_STRETCH
;

	@RenderSVGTextPath.h

24 #iâdeà
R’d”SVGTextP©h_h


25 
	#R’d”SVGTextP©h_h


	)

27 #ià
ENABLE
(
SVG
)

28 
	~"R’d”SVGIÆše.h
"

30 
Çme¥aû
 
	gWebCÜe
 {

32 şas 
	cR’d”SVGTextP©h
 : 
public
 
R’d”SVGIÆše
 {

33 
public
:

34 
R’d”SVGTextP©h
(
Node
*);

36 
P©h
 
ÏyoutP©h
() const;

37 
¡¬tOff£t
() const;

38 
boŞ
 
exaùAlignm’t
() const;

39 
boŞ
 
¡»tchM‘hod
() const;

41 
	g´iv©e
:

42 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderSVGTextPath"; }

44 
	gm_¡¬tOff£t
;

46 
boŞ
 
	gm_exaùAlignm’t
 : 1;

47 
boŞ
 
	gm_¡»tchM‘hod
 : 1;

49 
P©h
 
	gm_ÏyoutP©h
;

52 
šlše
 
R’d”SVGTextP©h
* 
	$toR’d”SVGTextP©h
(
R’d”Objeù
* 
objeù
)

54 
	`ASSERT
(!
objeù
 || !
	`¡rcmp
(objeù->
	`»nd”Name
(), "RenderSVGTextPath"));

55  
¡©ic_ÿ¡
<
R’d”SVGTextP©h
*>(
objeù
);

56 
	}
}

59 
toR’d”SVGTextP©h
(cÚ¡ 
R’d”SVGTextP©h
*);

	@RenderSVGTransformableContainer.cpp

22 
	~"cÚfig.h
"

24 #ià
ENABLE
(
SVG
)

25 
	~"R’d”SVGT¿nsfÜmabËCÚš”.h
"

27 
	~"SVGShadowT»eEËm’ts.h
"

28 
	~"SVGStyËdT¿nsfÜmabËEËm’t.h
"

30 
Çme¥aû
 
	gWebCÜe
 {

32 
	gR’d”SVGT¿nsfÜmabËCÚš”
::
R’d”SVGT¿nsfÜmabËCÚš”
(
SVGStyËdT¿nsfÜmabËEËm’t
* 
node
)

33 : 
R’d”SVGCÚš”
(
node
)

34 , 
m_ÃedsT¿nsfÜmUpd©e
(
Œue
)

38 
	gR’d”SVGT¿nsfÜmabËCÚš”
::
ÿlcuÏ‹LoÿlT¿nsfÜm
()

40 
SVGStyËdT¿nsfÜmabËEËm’t
* 
–em’t
 = 
¡©ic_ÿ¡
<SVGStyËdT¿nsfÜmabËEËm’t*>(
node
());

42 
boŞ
 
	gÃedsUpd©e
 = 
m_ÃedsT¿nsfÜmUpd©e
;

43 ià(
	gÃedsUpd©e
) {

44 
	gm_loÿlT¿nsfÜm
 = 
–em’t
->
ªim©edLoÿlT¿nsfÜm
();

45 
	gm_ÃedsT¿nsfÜmUpd©e
 = 
çl£
;

48 ià(!
	g–em’t
->
hasTagName
(
SVGNames
::
gTag
è|| !
¡©ic_ÿ¡
<
SVGGEËm’t
*>(
–em’t
)->
isShadowT»eCÚš”EËm’t
())

51 
FlßtSize
 
	gŒª¦©iÚ
 = 
¡©ic_ÿ¡
<
SVGShadowT»eCÚš”EËm’t
*>(
–em’t
)->
cÚš”T¿n¦©iÚ
();

52 ià(
	gŒª¦©iÚ
.
width
(è=ğ0 && 
Œª¦©iÚ
.
height
() == 0)

56 ià(!
	gÃedsUpd©e
)

57 
	gm_loÿlT¿nsfÜm
 = 
–em’t
->
ªim©edLoÿlT¿nsfÜm
();

59 
	gm_loÿlT¿nsfÜm
.
Œª¦©e
(
Œª¦©iÚ
.
width
(),¿n¦©iÚ.
height
());

	@RenderSVGTransformableContainer.h

21 #iâdeà
R’d”SVGT¿nsfÜmabËCÚš”_h


22 
	#R’d”SVGT¿nsfÜmabËCÚš”_h


	)

24 #ià
ENABLE
(
SVG
)

25 
	~"R’d”SVGCÚš”.h
"

27 
Çme¥aû
 
	gWebCÜe
 {

29 
şass
 
	gSVGStyËdT¿nsfÜmabËEËm’t
;

30 şas 
	cR’d”SVGT¿nsfÜmabËCÚš”
 : 
public
 
R’d”SVGCÚš”
 {

31 
public
:

32 
R’d”SVGT¿nsfÜmabËCÚš”
(
SVGStyËdT¿nsfÜmabËEËm’t
*);

34 
vœtu®
 cÚ¡ 
	gAffšeT¿nsfÜm
& 
loÿlToP¬’tT¿nsfÜm
(ècÚ¡ {  
	gm_loÿlT¿nsfÜm
; }

35 
vœtu®
 
£tN“dsT¿nsfÜmUpd©e
(è{ 
	gm_ÃedsT¿nsfÜmUpd©e
 = 
Œue
; }

37 
	g´iv©e
:

38 
vœtu®
 
ÿlcuÏ‹LoÿlT¿nsfÜm
();

39 
vœtu®
 
AffšeT¿nsfÜm
 
loÿlT¿nsfÜm
(ècÚ¡ {  
	gm_loÿlT¿nsfÜm
; }

41 
boŞ
 
	gm_ÃedsT¿nsfÜmUpd©e
 : 1;

42 
AffšeT¿nsfÜm
 
	gm_loÿlT¿nsfÜm
;

	@RenderSVGViewportContainer.cpp

24 
	~"cÚfig.h
"

26 #ià
ENABLE
(
SVG
)

27 
	~"R’d”SVGV›wpÜtCÚš”.h
"

29 
	~"G¿phicsCÚ‹xt.h
"

30 
	~"R’d”V›w.h
"

31 
	~"SVGSVGEËm’t.h
"

33 
Çme¥aû
 
	gWebCÜe
 {

35 
	gR’d”SVGV›wpÜtCÚš”
::
R’d”SVGV›wpÜtCÚš”
(
SVGStyËdEËm’t
* 
node
)

36 : 
R’d”SVGCÚš”
(
node
)

40 
R’d”SVGV›wpÜtCÚš”
::
­¶yV›wpÜtCl
(
PaštInfo
& 
·štInfo
)

42 ià(
SVGR’d”Ba£
::
isOv”æowHidd’
(
this
))

43 
·štInfo
.
cÚ‹xt
->
ş
(
m_v›wpÜt
);

46 
	gR’d”SVGV›wpÜtCÚš”
::
ÿlcV›wpÜt
()

48 
SVGEËm’t
* 
svg–em
 = 
¡©ic_ÿ¡
<SVGEËm’t*>(
node
());

49 ià(
	gsvg–em
->
hasTagName
(
SVGNames
::
svgTag
)) {

50 
SVGSVGEËm’t
* 
svg
 = 
¡©ic_ÿ¡
<SVGSVGEËm’t*>(
node
());

52 ià(!
£lfN“dsLayout
(è&& !
	gsvg
->
hasR–©iveV®ues
())

55 
	gx
 = 
svg
->
x
().
v®ue
(svg);

56 
	gy
 = 
svg
->
y
().
v®ue
(svg);

57 
	gw
 = 
svg
->
width
().
v®ue
(svg);

58 
	gh
 = 
svg
->
height
().
v®ue
(svg);

59 
	gm_v›wpÜt
 = 
FlßtReù
(
x
, 
y
, 
w
, 
h
);

63 
AffšeT¿nsfÜm
 
	gR’d”SVGV›wpÜtCÚš”
::
v›wpÜtT¿nsfÜm
() const

65 ià(
node
()->
hasTagName
(
SVGNames
::
svgTag
)) {

66 
SVGSVGEËm’t
* 
svg
 = 
¡©ic_ÿ¡
<SVGSVGEËm’t*>(
node
());

67  
	gsvg
->
v›wBoxToV›wT¿nsfÜm
(
m_v›wpÜt
.
width
(), m_v›wpÜt.
height
());

70  
AffšeT¿nsfÜm
();

73 cÚ¡ 
	gAffšeT¿nsfÜm
& 
	gR’d”SVGV›wpÜtCÚš”
::
loÿlToP¬’tT¿nsfÜm
() const

75 
AffšeT¿nsfÜm
 
v›wpÜtT¿n¦©iÚ
(
v›wpÜtT¿nsfÜm
());

76 
	gm_loÿlToP¬’tT¿nsfÜm
 = 
v›wpÜtT¿n¦©iÚ
.
Œª¦©eRight
(
m_v›wpÜt
.
x
(), m_v›wpÜt.
y
());

77  
	gm_loÿlToP¬’tT¿nsfÜm
;

82 
boŞ
 
	gR’d”SVGV›wpÜtCÚš”
::
poštIsInsideV›wpÜtCl
(cÚ¡ 
FlßtPošt
& 
poštInP¬’t
)

85 ià(!
SVGR’d”Ba£
::
isOv”æowHidd’
(
this
))

86  
Œue
;

88  
	gm_v›wpÜt
.
cÚšs
(
poštInP¬’t
);

	@RenderSVGViewportContainer.h

23 #iâdeà
R’d”SVGV›wpÜtCÚš”_h


24 
	#R’d”SVGV›wpÜtCÚš”_h


	)

26 #ià
ENABLE
(
SVG
)

27 
	~"R’d”SVGCÚš”.h
"

29 
Çme¥aû
 
	gWebCÜe
 {

33 şas 
	cR’d”SVGV›wpÜtCÚš”
 : 
public
 
R’d”SVGCÚš”
 {

34 
public
:

35 
R’d”SVGV›wpÜtCÚš”
(
SVGStyËdEËm’t
*);

37 
	g´iv©e
:

38 
vœtu®
 
boŞ
 
isSVGCÚš”
(ècÚ¡ {  
Œue
; }

39 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderSVGViewportContainer"; }

41 
AffšeT¿nsfÜm
 
v›wpÜtT¿nsfÜm
() const;

42 
vœtu®
 cÚ¡ 
	gAffšeT¿nsfÜm
& 
loÿlToP¬’tT¿nsfÜm
() const;

44 
vœtu®
 
ÿlcV›wpÜt
();

46 
vœtu®
 
­¶yV›wpÜtCl
(
PaštInfo
&);

47 
vœtu®
 
boŞ
 
poštIsInsideV›wpÜtCl
(cÚ¡ 
FlßtPošt
& 
poštInP¬’t
);

49 
FlßtReù
 
	gm_v›wpÜt
;

50 
mubË
 
AffšeT¿nsfÜm
 
	gm_loÿlToP¬’tT¿nsfÜm
;

53 
šlše
 
R’d”SVGV›wpÜtCÚš”
* 
	$toR’d”SVGV›wpÜtCÚš”
(
R’d”Objeù
* 
objeù
)

55 
	`ASSERT
(!
objeù
 || !
	`¡rcmp
(objeù->
	`»nd”Name
(), "RenderSVGViewportContainer"));

56  
¡©ic_ÿ¡
<
R’d”SVGV›wpÜtCÚš”
*>(
objeù
);

57 
	}
}

60 
toR’d”SVGV›wpÜtCÚš”
(cÚ¡ 
R’d”SVGV›wpÜtCÚš”
*);

	@RenderScrollbar.cpp

26 
	~"cÚfig.h
"

27 
	~"R’d”SüŞlb¬.h
"

29 
	~"R’d”SüŞlb¬P¬t.h
"

30 
	~"R’d”SüŞlb¬Theme.h
"

32 
Çme¥aû
 
	gWebCÜe
 {

34 
	gPassRefPŒ
<
	gSüŞlb¬
> 
	gR’d”SüŞlb¬
::
ü—‹Cu¡omSüŞlb¬
(
SüŞlb¬Cl›Á
* 
ş›Á
, 
SüŞlb¬Or›Á©iÚ
 
Ü›Á©iÚ
, 
R’d”Box
* 
»nd””
)

36  
adİtRef
(
Ãw
 
R’d”SüŞlb¬
(
ş›Á
, 
Ü›Á©iÚ
, 
»nd””
));

39 
	gR’d”SüŞlb¬
::
R’d”SüŞlb¬
(
SüŞlb¬Cl›Á
* 
ş›Á
, 
SüŞlb¬Or›Á©iÚ
 
Ü›Á©iÚ
, 
R’d”Box
* 
»nd””
)

40 : 
SüŞlb¬
(
ş›Á
, 
Ü›Á©iÚ
, 
ReguÏrSüŞlb¬
, 
R’d”SüŞlb¬Theme
::
»nd”SüŞlb¬Theme
())

41 , 
m_owÃr
(
»nd””
)

46 
upd©eSüŞlb¬P¬t
(
SüŞlb¬BGP¬t
);

47 
R’d”SüŞlb¬P¬t
* 
	g·¹
 = 
m_·¹s
.
g‘
(
SüŞlb¬BGP¬t
);

48 ià(!
	g·¹
)

51 
	g·¹
->
Ïyout
();

52 
£tF¿meReù
(
IÁReù
(0, 0, 
·¹
->
width
(),…¬t->
height
()));

55 
	gR’d”SüŞlb¬
::~
R’d”SüŞlb¬
()

57 
ASSERT
(
m_·¹s
.
isEm±y
());

60 
	gR’d”SüŞlb¬
::
£tP¬’t
(
SüŞlV›w
* 
·»Á
)

62 
SüŞlb¬
::
£tP¬’t
(
·»Á
);

63 ià(!
	g·»Á
) {

65 
upd©eSüŞlb¬P¬ts
(
Œue
);

69 
	gR’d”SüŞlb¬
::
£tEÇbËd
(
boŞ
 
e
)

71 
boŞ
 
wasEÇbËd
 = 
’abËd
();

72 
	gSüŞlb¬
::
£tEÇbËd
(
e
);

73 ià(
	gwasEÇbËd
 !ğ
e
)

74 
upd©eSüŞlb¬P¬ts
();

77 
	gR’d”SüŞlb¬
::
¡yËChªged
()

79 
upd©eSüŞlb¬P¬ts
();

82 
	gR’d”SüŞlb¬
::
·št
(
G¿phicsCÚ‹xt
* 
cÚ‹xt
, cÚ¡ 
IÁReù
& 
damageReù
)

84 ià(
	gcÚ‹xt
->
upd©šgCÚŒŞTšts
()) {

85 
upd©eSüŞlb¬P¬ts
();

88 
	gSüŞlb¬
::
·št
(
cÚ‹xt
, 
damageReù
);

91 
	gR’d”SüŞlb¬
::
£tHov”edP¬t
(
SüŞlb¬P¬t
 
·¹
)

93 ià(
·¹
 =ğ
m_hov”edP¬t
)

96 
SüŞlb¬P¬t
 
	gŞdP¬t
 = 
m_hov”edP¬t
;

97 
	gm_hov”edP¬t
 = 
·¹
;

99 
upd©eSüŞlb¬P¬t
(
ŞdP¬t
);

100 
upd©eSüŞlb¬P¬t
(
m_hov”edP¬t
);

102 
upd©eSüŞlb¬P¬t
(
SüŞlb¬BGP¬t
);

103 
upd©eSüŞlb¬P¬t
(
T¿ckBGP¬t
);

106 
	gR’d”SüŞlb¬
::
£tP»s£dP¬t
(
SüŞlb¬P¬t
 
·¹
)

108 
SüŞlb¬P¬t
 
ŞdP¬t
 = 
m_´es£dP¬t
;

109 
	gSüŞlb¬
::
£tP»s£dP¬t
(
·¹
);

111 
upd©eSüŞlb¬P¬t
(
ŞdP¬t
);

112 
upd©eSüŞlb¬P¬t
(
·¹
);

114 
upd©eSüŞlb¬P¬t
(
SüŞlb¬BGP¬t
);

115 
upd©eSüŞlb¬P¬t
(
T¿ckBGP¬t
);

118 
SüŞlb¬P¬t
 
	gs_¡yËResŞveP¬t
;

119 
R’d”SüŞlb¬
* 
	gs_¡yËResŞveSüŞlb¬
;

121 
R’d”SüŞlb¬
* 
	gR’d”SüŞlb¬
::
süŞlb¬FÜStyËResŞve
()

123  
s_¡yËResŞveSüŞlb¬
;

126 
SüŞlb¬P¬t
 
	gR’d”SüŞlb¬
::
·¹FÜStyËResŞve
()

128  
s_¡yËResŞveP¬t
;

131 
	gPassRefPŒ
<
	gR’d”StyË
> 
	gR’d”SüŞlb¬
::
g‘SüŞlb¬P£udoStyË
(
SüŞlb¬P¬t
 
·¹Ty³
, 
P£udoId
 
p£udoId
)

133 
	gs_¡yËResŞveP¬t
 = 
·¹Ty³
;

134 
	gs_¡yËResŞveSüŞlb¬
 = 
this
;

135 
	gRefPŒ
<
	gR’d”StyË
> 
	g»suÉ
 = 
m_owÃr
->
g‘UnÿchedP£udoStyË
(
p£udoId
, m_owÃr->
¡yË
());

136 
	gs_¡yËResŞveP¬t
 = 
NoP¬t
;

137 
	gs_¡yËResŞveSüŞlb¬
 = 0;

138  
	g»suÉ
;

141 
	gR’d”SüŞlb¬
::
upd©eSüŞlb¬P¬ts
(
boŞ
 
de¡roy
)

143 
upd©eSüŞlb¬P¬t
(
SüŞlb¬BGP¬t
, 
de¡roy
);

144 
upd©eSüŞlb¬P¬t
(
BackBu‰ÚS¹P¬t
, 
de¡roy
);

145 
upd©eSüŞlb¬P¬t
(
FÜw¬dBu‰ÚS¹P¬t
, 
de¡roy
);

146 
upd©eSüŞlb¬P¬t
(
BackT¿ckP¬t
, 
de¡roy
);

147 
upd©eSüŞlb¬P¬t
(
ThumbP¬t
, 
de¡roy
);

148 
upd©eSüŞlb¬P¬t
(
FÜw¬dT¿ckP¬t
, 
de¡roy
);

149 
upd©eSüŞlb¬P¬t
(
BackBu‰ÚEndP¬t
, 
de¡roy
);

150 
upd©eSüŞlb¬P¬t
(
FÜw¬dBu‰ÚEndP¬t
, 
de¡roy
);

151 
upd©eSüŞlb¬P¬t
(
T¿ckBGP¬t
, 
de¡roy
);

153 ià(
	gde¡roy
)

157 
boŞ
 
	gisHÜizÚl
 = 
Ü›Á©iÚ
(è=ğ
HÜizÚlSüŞlb¬
;

158 
	gŞdThickÃss
 = 
isHÜizÚl
 ? 
height
(è: 
width
();

159 
	gÃwThickÃss
 = 0;

160 
R’d”SüŞlb¬P¬t
* 
	g·¹
 = 
m_·¹s
.
g‘
(
SüŞlb¬BGP¬t
);

161 ià(
	g·¹
) {

162 
	g·¹
->
Ïyout
();

163 
	gÃwThickÃss
 = 
isHÜizÚl
 ? 
·¹
->
height
(è:…¬t->
width
();

166 ià(
	gÃwThickÃss
 !ğ
ŞdThickÃss
) {

167 
£tF¿meReù
(
IÁReù
(
x
(), 
y
(), 
isHÜizÚl
 ? 
width
(è: 
ÃwThickÃss
, isHÜizÚÈ?‚ewThickÃs : 
height
()));

168 
	gm_owÃr
->
£tChdN“dsLayout
(
Œue
);

172 
P£udoId
 
p£udoFÜSüŞlb¬P¬t
(
SüŞlb¬P¬t
 
·¹
)

174 
	g·¹
) {

175 
	gBackBu‰ÚS¹P¬t
:

176 
FÜw¬dBu‰ÚS¹P¬t
:

177 
BackBu‰ÚEndP¬t
:

178 
FÜw¬dBu‰ÚEndP¬t
:

179  
SCROLLBAR_BUTTON
;

180 
	gBackT¿ckP¬t
:

181 
FÜw¬dT¿ckP¬t
:

182  
SCROLLBAR_TRACK_PIECE
;

183 
	gThumbP¬t
:

184  
SCROLLBAR_THUMB
;

185 
	gT¿ckBGP¬t
:

186  
SCROLLBAR_TRACK
;

187 
	gSüŞlb¬BGP¬t
:

188  
SCROLLBAR
;

189 
	gNoP¬t
:

190 
AÎP¬ts
:

193 
ASSERT_NOT_REACHED
();

194  
	gSCROLLBAR
;

197 
	gR’d”SüŞlb¬
::
upd©eSüŞlb¬P¬t
(
SüŞlb¬P¬t
 
·¹Ty³
, 
boŞ
 
de¡roy
)

199 ià(
	g·¹Ty³
 =ğ
NoP¬t
)

202 
	gRefPŒ
<
	gR’d”StyË
> 
	g·¹StyË
 = !
de¡roy
 ? 
g‘SüŞlb¬P£udoStyË
(
·¹Ty³
, 
p£udoFÜSüŞlb¬P¬t
(partType)) : 0;

204 
boŞ
 
	gÃedR’d””
 = !
de¡roy
 && 
·¹StyË
 &&…¬tStyË->
di¥Ïy
(è!ğ
NONE
 &&…¬tStyË->
visib™y
(è=ğ
VISIBLE
;

206 ià(
	gÃedR’d””
 && 
	g·¹StyË
->
di¥Ïy
(è!ğ
BLOCK
) {

208 
SüŞlb¬Bu‰ÚsPÏûm’t
 
bu‰ÚsPÏûm’t
 = 
theme
()->buttonsPlacement();

209 
	g·¹Ty³
) {

210 
	gBackBu‰ÚS¹P¬t
:

211 
ÃedR’d””
 = (
bu‰ÚsPÏûm’t
 =ğ
SüŞlb¬Bu‰ÚsSšgË
 || bu‰ÚsPÏûm’ˆ=ğ
SüŞlb¬Bu‰ÚsDoubËS¹
 ||

212 
bu‰ÚsPÏûm’t
 =ğ
SüŞlb¬Bu‰ÚsDoubËBÙh
);

214 
	gFÜw¬dBu‰ÚS¹P¬t
:

215 
ÃedR’d””
 = (
bu‰ÚsPÏûm’t
 =ğ
SüŞlb¬Bu‰ÚsDoubËS¹
 || bu‰ÚsPÏûm’ˆ=ğ
SüŞlb¬Bu‰ÚsDoubËBÙh
);

217 
	gBackBu‰ÚEndP¬t
:

218 
ÃedR’d””
 = (
bu‰ÚsPÏûm’t
 =ğ
SüŞlb¬Bu‰ÚsDoubËEnd
 || bu‰ÚsPÏûm’ˆ=ğ
SüŞlb¬Bu‰ÚsDoubËBÙh
);

220 
	gFÜw¬dBu‰ÚEndP¬t
:

221 
ÃedR’d””
 = (
bu‰ÚsPÏûm’t
 =ğ
SüŞlb¬Bu‰ÚsSšgË
 || bu‰ÚsPÏûm’ˆ=ğ
SüŞlb¬Bu‰ÚsDoubËEnd
 ||

222 
bu‰ÚsPÏûm’t
 =ğ
SüŞlb¬Bu‰ÚsDoubËBÙh
);

229 
R’d”SüŞlb¬P¬t
* 
	g·¹R’d””
 = 
m_·¹s
.
g‘
(
·¹Ty³
);

230 ià(!
	g·¹R’d””
 && 
	gÃedR’d””
) {

231 
	g·¹R’d””
 = 
Ãw
 (
m_owÃr
->
»nd”A»Ç
()è
R’d”SüŞlb¬P¬t
(m_owÃr->
docum’t
(), 
this
, 
·¹Ty³
);

232 
	gm_·¹s
.
£t
(
·¹Ty³
, 
·¹R’d””
);

233 } ià(
	g·¹R’d””
 && !
	gÃedR’d””
) {

234 
	gm_·¹s
.
»move
(
·¹Ty³
);

235 
	g·¹R’d””
->
de¡roy
();

236 
	g·¹R’d””
 = 0;

239 ià(
	g·¹R’d””
)

240 
	g·¹R’d””
->
£tStyË
(
·¹StyË
.
»Ëa£
());

243 
	gR’d”SüŞlb¬
::
·štP¬t
(
G¿phicsCÚ‹xt
* 
g¿phicsCÚ‹xt
, 
SüŞlb¬P¬t
 
·¹Ty³
, cÚ¡ 
IÁReù
& 
»ù
)

245 
R’d”SüŞlb¬P¬t
* 
	g·¹R’d””
 = 
m_·¹s
.
g‘
(
·¹Ty³
);

246 ià(!
	g·¹R’d””
)

248 
	g·¹R’d””
->
·štIÁoReù
(
g¿phicsCÚ‹xt
, 
x
(), 
y
(), 
»ù
);

251 
IÁReù
 
	gR’d”SüŞlb¬
::
bu‰ÚReù
(
SüŞlb¬P¬t
 
·¹Ty³
)

253 
R’d”SüŞlb¬P¬t
* 
·¹R’d””
 = 
m_·¹s
.
g‘
(
·¹Ty³
);

254 ià(!
	g·¹R’d””
)

255  
IÁReù
();

257 
	g·¹R’d””
->
Ïyout
();

259 
boŞ
 
	gisHÜizÚl
 = 
Ü›Á©iÚ
(è=ğ
HÜizÚlSüŞlb¬
;

260 ià(
	g·¹Ty³
 =ğ
BackBu‰ÚS¹P¬t
)

261  
IÁReù
(
x
(), 
y
(), 
isHÜizÚl
 ? 
·¹R’d””
->
width
(è: width(), isHÜizÚÈ? 
height
() :…artRenderer->height());

262 ià(
	g·¹Ty³
 =ğ
FÜw¬dBu‰ÚEndP¬t
)

263  
IÁReù
(
isHÜizÚl
 ? 
x
(è+ 
width
(è- 
·¹R’d””
->width() : x(),

265 
isHÜizÚl
 ? 
y
(è: y(è+ 
height
(è- 
·¹R’d””
->height(),

266 
isHÜizÚl
 ? 
·¹R’d””
->
width
() : width(),

267 
isHÜizÚl
 ? 
height
(è: 
·¹R’d””
->height());

269 ià(
	g·¹Ty³
 =ğ
FÜw¬dBu‰ÚS¹P¬t
) {

270 
IÁReù
 
´eviousBu‰Ú
 = 
bu‰ÚReù
(
BackBu‰ÚS¹P¬t
);

271  
IÁReù
(
isHÜizÚl
 ? 
x
(è+ 
´eviousBu‰Ú
.
width
() : x(),

272 
isHÜizÚl
 ? 
y
(è: y(è+ 
´eviousBu‰Ú
.
height
(),

273 
isHÜizÚl
 ? 
·¹R’d””
->
width
() : width(),

274 
isHÜizÚl
 ? 
height
(è: 
·¹R’d””
->height());

277 
IÁReù
 
	gfŞlowšgBu‰Ú
 = 
bu‰ÚReù
(
FÜw¬dBu‰ÚEndP¬t
);

278  
IÁReù
(
isHÜizÚl
 ? 
x
(è+ 
width
(è- 
fŞlowšgBu‰Ú
.width(è- 
·¹R’d””
->width() : x(),

279 
isHÜizÚl
 ? 
y
(è: y(è+ 
height
(è- 
fŞlowšgBu‰Ú
.height(è- 
·¹R’d””
->height(),

280 
isHÜizÚl
 ? 
·¹R’d””
->
width
() : width(),

281 
isHÜizÚl
 ? 
height
(è: 
·¹R’d””
->height());

284 
IÁReù
 
	gR’d”SüŞlb¬
::
ŒackReù
(
¡¬tL’gth
, 
’dL’gth
)

286 
R’d”SüŞlb¬P¬t
* 
	g·¹
 = 
m_·¹s
.
g‘
(
T¿ckBGP¬t
);

287 ià(
	g·¹
)

288 
	g·¹
->
Ïyout
();

290 ià(
Ü›Á©iÚ
(è=ğ
HÜizÚlSüŞlb¬
) {

291 
m¬gšLeá
 = 
·¹
 ?…art->marginLeft() : 0;

292 
	gm¬gšRight
 = 
·¹
 ?…¬t->
m¬gšRight
() : 0;

293 
	g¡¬tL’gth
 +ğ
m¬gšLeá
;

294 
	g’dL’gth
 +ğ
m¬gšRight
;

295 
	gtÙ®L’gth
 = 
¡¬tL’gth
 + 
’dL’gth
;

296  
IÁReù
(
x
(è+ 
¡¬tL’gth
, 
y
(), 
width
(è- 
tÙ®L’gth
, 
height
());

299 
	gm¬gšTİ
 = 
·¹
 ?…¬t->
m¬gšTİ
() : 0;

300 
	gm¬gšBÙtom
 = 
·¹
 ?…¬t->
m¬gšBÙtom
() : 0;

301 
	g¡¬tL’gth
 +ğ
m¬gšTİ
;

302 
	g’dL’gth
 +ğ
m¬gšBÙtom
;

303 
	gtÙ®L’gth
 = 
¡¬tL’gth
 + 
’dL’gth
;

305  
IÁReù
(
x
(), 
y
(è+ 
¡¬tL’gth
, 
width
(), 
height
(è- 
tÙ®L’gth
);

308 
IÁReù
 
	gR’d”SüŞlb¬
::
ŒackP›ûReùW™hM¬gšs
(
SüŞlb¬P¬t
 
·¹Ty³
, cÚ¡ IÁReù& 
ŞdReù
)

310 
R’d”SüŞlb¬P¬t
* 
	g·¹R’d””
 = 
m_·¹s
.
g‘
(
·¹Ty³
);

311 ià(!
	g·¹R’d””
)

312  
	gŞdReù
;

314 
	g·¹R’d””
->
Ïyout
();

316 
IÁReù
 
	g»ù
 = 
ŞdReù
;

317 ià(
Ü›Á©iÚ
(è=ğ
HÜizÚlSüŞlb¬
) {

318 
»ù
.
£tX
Ôeù.
x
(è+ 
·¹R’d””
->
m¬gšLeá
());

319 
	g»ù
.
£tWidth
(
»ù
.
width
(è- (
·¹R’d””
->
m¬gšLeá
(è+…¬tR’d””->
m¬gšRight
()));

321 
	g»ù
.
£tY
(
»ù
.
y
(è+ 
·¹R’d””
->
m¬gšTİ
());

322 
	g»ù
.
£tHeight
(
»ù
.
height
(è- (
·¹R’d””
->
m¬gšTİ
(è+…¬tR’d””->
m¬gšBÙtom
()));

324  
	g»ù
;

327 
	gR’d”SüŞlb¬
::
mšimumThumbL’gth
()

329 
R’d”SüŞlb¬P¬t
* 
·¹R’d””
 = 
m_·¹s
.
g‘
(
ThumbP¬t
);

330 ià(!
	g·¹R’d””
)

332 
	g·¹R’d””
->
Ïyout
();

333  
Ü›Á©iÚ
(è=ğ
HÜizÚlSüŞlb¬
 ? 
·¹R’d””
->
width
(è:…¬tR’d””->
height
();

	@RenderScrollbar.h

26 #iâdeà
R’d”SüŞlb¬_h


27 
	#R’d”SüŞlb¬_h


	)

29 
	~"R’d”StyËCÚ¡ªts.h
"

30 
	~"SüŞlb¬.h
"

31 
	~<wtf/HashM­.h
>

33 
Çme¥aû
 
	gWebCÜe
 {

35 
şass
 
	gR’d”Box
;

36 
şass
 
	gR’d”SüŞlb¬P¬t
;

37 
şass
 
	gR’d”StyË
;

39 şas 
	cR’d”SüŞlb¬
 : 
public
 
SüŞlb¬
 {

40 
´Ùeùed
:

41 
R’d”SüŞlb¬
(
SüŞlb¬Cl›Á
*, 
SüŞlb¬Or›Á©iÚ
, 
R’d”Box
*);

43 
	gpublic
:

44 
ä›nd
 
şass
 
SüŞlb¬
;

45 
	gPassRefPŒ
<
	gSüŞlb¬
> 
ü—‹Cu¡omSüŞlb¬
(
SüŞlb¬Cl›Á
*, 
SüŞlb¬Or›Á©iÚ
, 
R’d”Box
*);

46 
	gvœtu®
 ~
R’d”SüŞlb¬
();

48 
SüŞlb¬P¬t
 
·¹FÜStyËResŞve
();

49 
R’d”SüŞlb¬
* 
süŞlb¬FÜStyËResŞve
();

51 
R’d”Box
* 
ownšgR’d””
(ècÚ¡ {  
	gm_owÃr
; }

53 
·štP¬t
(
G¿phicsCÚ‹xt
*, 
SüŞlb¬P¬t
, cÚ¡ 
IÁReù
&);

55 
IÁReù
 
bu‰ÚReù
(
SüŞlb¬P¬t
);

56 
IÁReù
 
ŒackReù
(
¡¬tL’gth
, 
’dL’gth
);

57 
IÁReù
 
ŒackP›ûReùW™hM¬gšs
(
SüŞlb¬P¬t
, const IntRect&);

59 
mšimumThumbL’gth
();

61 
	g´iv©e
:

62 
vœtu®
 
£tP¬’t
(
SüŞlV›w
*);

63 
vœtu®
 
£tEÇbËd
(
boŞ
);

65 
vœtu®
 
·št
(
G¿phicsCÚ‹xt
*, cÚ¡ 
IÁReù
& 
damageReù
);

67 
vœtu®
 
£tHov”edP¬t
(
SüŞlb¬P¬t
);

68 
vœtu®
 
£tP»s£dP¬t
(
SüŞlb¬P¬t
);

70 
vœtu®
 
¡yËChªged
();

72 
vœtu®
 
boŞ
 
isCu¡omSüŞlb¬
(ècÚ¡ {  
	gŒue
; }

74 
upd©eSüŞlb¬P¬ts
(
boŞ
 
de¡roy
 = 
çl£
);

76 
	gPassRefPŒ
<
	gR’d”StyË
> 
g‘SüŞlb¬P£udoStyË
(
SüŞlb¬P¬t
, 
P£udoId
);

77 
upd©eSüŞlb¬P¬t
(
SüŞlb¬P¬t
, 
boŞ
 
de¡roy
 = 
çl£
);

79 
R’d”Box
* 
	gm_owÃr
;

80 
	gHashM­
<, 
	gR’d”SüŞlb¬P¬t
*> 
	gm_·¹s
;

83 
šlše
 
R’d”SüŞlb¬
* 
	$toR’d”SüŞlb¬
(
SüŞlb¬
* 
süŞlb¬
)

85 
	`ASSERT
(!
süŞlb¬
 || süŞlb¬->
	`isCu¡omSüŞlb¬
());

86  
¡©ic_ÿ¡
<
R’d”SüŞlb¬
*>(
süŞlb¬
);

87 
	}
}

90 
toR’d”SüŞlb¬
(cÚ¡ 
R’d”SüŞlb¬
*);

	@RenderScrollbarPart.cpp

26 
	~"cÚfig.h
"

27 
	~"R’d”SüŞlb¬P¬t.h
"

28 
	~"R’d”SüŞlb¬.h
"

29 
	~"R’d”SüŞlb¬Theme.h
"

30 
	~"R’d”V›w.h
"

32 
usšg
 
Çme¥aû
 
	g¡d
;

34 
Çme¥aû
 
	gWebCÜe
 {

36 
	gR’d”SüŞlb¬P¬t
::
R’d”SüŞlb¬P¬t
(
Node
* 
node
, 
R’d”SüŞlb¬
* 
süŞlb¬
, 
SüŞlb¬P¬t
 
·¹
)

37 : 
R’d”Block
(
node
)

38 , 
m_süŞlb¬
(
süŞlb¬
)

39 , 
m_·¹
(
·¹
)

43 
	gR’d”SüŞlb¬P¬t
::~
R’d”SüŞlb¬P¬t
()

47 
R’d”SüŞlb¬P¬t
::
Ïyout
()

49 
£tLoÿtiÚ
(
IÁPošt
());

50 ià(
	gm_süŞlb¬
->
Ü›Á©iÚ
(è=ğ
HÜizÚlSüŞlb¬
)

51 
ÏyoutHÜizÚlP¬t
();

53 
ÏyoutV”tiÿlP¬t
();

55 
£tN“dsLayout
(
çl£
);

58 
	gR’d”SüŞlb¬P¬t
::
ÏyoutHÜizÚlP¬t
()

60 ià(
m_·¹
 =ğ
SüŞlb¬BGP¬t
) {

61 
£tWidth
(
m_süŞlb¬
->
width
());

62 
compu‹SüŞlb¬Height
();

64 
compu‹SüŞlb¬Width
();

65 
£tHeight
(
m_süŞlb¬
->
height
());

69 
	gR’d”SüŞlb¬P¬t
::
ÏyoutV”tiÿlP¬t
()

71 ià(
m_·¹
 =ğ
SüŞlb¬BGP¬t
) {

72 
compu‹SüŞlb¬Width
();

73 
£tHeight
(
m_süŞlb¬
->
height
());

75 
£tWidth
(
m_süŞlb¬
->
width
());

76 
compu‹SüŞlb¬Height
();

80 
ÿlcSüŞlb¬ThickÃssUsšg
(cÚ¡ 
L’gth
& 
l
, 
cÚššgL’gth
)

82 ià(
	gl
.
isIÁršsicOrAuto
())

83  
	gSüŞlb¬Theme
::
ÇtiveTheme
()->
süŞlb¬ThickÃss
();

84  
	gl
.
ÿlcMšV®ue
(
cÚššgL’gth
);

87 
	gR’d”SüŞlb¬P¬t
::
compu‹SüŞlb¬Width
()

89 
visibËSize
 = 
m_süŞlb¬
->
ownšgR’d””
()->
width
(è- m_süŞlb¬->ownšgR’d””()->
bÜd”Leá
(è- m_süŞlb¬->ownšgR’d””()->
bÜd”Right
();

90 
	gw
 = 
ÿlcSüŞlb¬ThickÃssUsšg
(
¡yË
()->
width
(), 
visibËSize
);

91 
	gmšWidth
 = 
ÿlcSüŞlb¬ThickÃssUsšg
(
¡yË
()->
mšWidth
(), 
visibËSize
);

92 
	gmaxWidth
 = 
¡yË
()->
maxWidth
().
isUndefšed
(è? 
w
 : 
ÿlcSüŞlb¬ThickÃssUsšg
(¡yË()->maxWidth(), 
visibËSize
);

93 
£tWidth
(
max
(
mšWidth
, 
mš
(
maxWidth
, 
w
)));

96 
	gm_m¬gšLeá
 = 
¡yË
()->
m¬gšLeá
().
ÿlcMšV®ue
(
visibËSize
);

97 
	gm_m¬gšRight
 = 
¡yË
()->
m¬gšRight
().
ÿlcMšV®ue
(
visibËSize
);

100 
	gR’d”SüŞlb¬P¬t
::
compu‹SüŞlb¬Height
()

102 
visibËSize
 = 
m_süŞlb¬
->
ownšgR’d””
()->
height
(è- m_süŞlb¬->ownšgR’d””()->
bÜd”Tİ
(è- m_süŞlb¬->ownšgR’d””()->
bÜd”BÙtom
();

103 
	gh
 = 
ÿlcSüŞlb¬ThickÃssUsšg
(
¡yË
()->
height
(), 
visibËSize
);

104 
	gmšHeight
 = 
ÿlcSüŞlb¬ThickÃssUsšg
(
¡yË
()->
mšHeight
(), 
visibËSize
);

105 
	gmaxHeight
 = 
¡yË
()->
maxHeight
().
isUndefšed
(è? 
h
 : 
ÿlcSüŞlb¬ThickÃssUsšg
(¡yË()->maxHeight(), 
visibËSize
);

106 
£tHeight
(
max
(
mšHeight
, 
mš
(
maxHeight
, 
h
)));

109 
	gm_m¬gšTİ
 = 
¡yË
()->
m¬gšTİ
().
ÿlcMšV®ue
(
visibËSize
);

110 
	gm_m¬gšBÙtom
 = 
¡yË
()->
m¬gšBÙtom
().
ÿlcMšV®ue
(
visibËSize
);

113 
	gR’d”SüŞlb¬P¬t
::
ÿlcP»fWidths
()

115 ià(!
´efWidthsDœty
())

118 
	gm_mšP»fWidth
 = 
m_maxP»fWidth
 = 0;

120 
£tP»fWidthsDœty
(
çl£
);

123 
	gR’d”SüŞlb¬P¬t
::
¡yËWlChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ÃwStyË
)

125 
	gR’d”Block
::
¡yËWlChªge
(
diff
, 
ÃwStyË
);

126 
£tIÆše
(
çl£
);

129 
	gR’d”SüŞlb¬P¬t
::
¡yËDidChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
)

131 
	gR’d”Block
::
¡yËDidChªge
(
diff
, 
ŞdStyË
);

132 
£tIÆše
(
çl£
);

133 
£tPos™iÚed
(
çl£
);

134 
£tFlßtšg
(
çl£
);

135 
£tHasOv”æowCl
(
çl£
);

136 ià(
	gŞdStyË
 && 
	gm_süŞlb¬
 && 
	gm_·¹
 !ğ
NoP¬t
 && 
diff
 >ğ
StyËDifã»nûR•ašt
)

137 
m_süŞlb¬
->
theme
()->
šv®id©eP¬t
(m_süŞlb¬, 
m_·¹
);

140 
	gR’d”SüŞlb¬P¬t
::
imageChªged
(
W¿µedImagePŒ
 
image
, cÚ¡ 
IÁReù
* 
»ù
)

142 ià(
	gm_süŞlb¬
 && 
	gm_·¹
 !ğ
NoP¬t
)

143 
m_süŞlb¬
->
theme
()->
šv®id©eP¬t
(m_süŞlb¬, 
m_·¹
);

145 ià(
F¿meV›w
* 
	gäameV›w
 = 
v›w
()->
äameV›w
()) {

146 ià(
äameV›w
->
isF¿meV›wSüŞlCÜÃr
(
this
)) {

147 
äameV›w
->
šv®id©eSüŞlCÜÃr
();

152 
	gR’d”Block
::
imageChªged
(
image
, 
»ù
);

156 
	gR’d”SüŞlb¬P¬t
::
·štIÁoReù
(
G¿phicsCÚ‹xt
* 
g¿phicsCÚ‹xt
, 
tx
, 
ty
, cÚ¡ 
IÁReù
& 
»ù
)

159 
£tLoÿtiÚ
(
»ù
.
x
(è- 
tx
,„eù.
y
(è- 
ty
);

160 
£tWidth
(
»ù
.
width
());

161 
£tHeight
(
»ù
.
height
());

163 ià(
	gg¿phicsCÚ‹xt
->
·štšgDi§bËd
())

167 
	gR’d”Objeù
::
PaštInfo
 
·štInfo
(
g¿phicsCÚ‹xt
, 
»ù
, 
PaštPha£BlockBackground
, 
çl£
, 0, 0);

168 
·št
(
·štInfo
, 
tx
, 
ty
);

169 
	g·štInfo
.
	gpha£
 = 
PaštPha£ChdBlockBackgrounds
;

170 
·št
(
·štInfo
, 
tx
, 
ty
);

171 
	g·štInfo
.
	gpha£
 = 
PaštPha£Flßt
;

172 
·št
(
·štInfo
, 
tx
, 
ty
);

173 
	g·štInfo
.
	gpha£
 = 
PaštPha£FÜeground
;

174 
·št
(
·štInfo
, 
tx
, 
ty
);

175 
	g·štInfo
.
	gpha£
 = 
PaštPha£Ouše
;

176 
·št
(
·štInfo
, 
tx
, 
ty
);

	@RenderScrollbarPart.h

26 #iâdeà
R’d”SüŞlb¬P¬t_h


27 
	#R’d”SüŞlb¬P¬t_h


	)

29 
	~"R’d”Block.h
"

30 
	~"SüŞlTy³s.h
"

32 
Çme¥aû
 
	gWebCÜe
 {

34 
şass
 
	gR’d”SüŞlb¬
;

36 şas 
	cR’d”SüŞlb¬P¬t
 : 
public
 
R’d”Block
 {

37 
public
:

38 
R’d”SüŞlb¬P¬t
(
Node
*, 
R’d”SüŞlb¬
* = 0, 
SüŞlb¬P¬t
 = 
NoP¬t
);

39 
	gvœtu®
 ~
R’d”SüŞlb¬P¬t
();

41 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderScrollbarPart"; }

43 
vœtu®
 
boŞ
 
»quœesLay”
(ècÚ¡ {  
	gçl£
; }

45 
vœtu®
 
Ïyout
();

46 
vœtu®
 
ÿlcP»fWidths
();

48 
·štIÁoReù
(
G¿phicsCÚ‹xt
*, 
tx
, 
ty
, cÚ¡ 
IÁReù
&);

50 
	g´Ùeùed
:

51 
vœtu®
 
¡yËWlChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ÃwStyË
);

52 
vœtu®
 
¡yËDidChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
);

53 
vœtu®
 
imageChªged
(
W¿µedImagePŒ
, cÚ¡ 
IÁReù
* = 0);

55 
	g´iv©e
:

56 
ÏyoutHÜizÚlP¬t
();

57 
ÏyoutV”tiÿlP¬t
();

59 
compu‹SüŞlb¬Width
();

60 
compu‹SüŞlb¬Height
();

62 
R’d”SüŞlb¬
* 
	gm_süŞlb¬
;

63 
SüŞlb¬P¬t
 
	gm_·¹
;

	@RenderScrollbarTheme.cpp

26 
	~"cÚfig.h
"

27 
	~"R’d”SüŞlb¬Theme.h
"

28 
	~"R’d”SüŞlb¬.h
"

29 
	~<wtf/StdLibExŒas.h
>

31 
Çme¥aû
 
	gWebCÜe
 {

33 
R’d”SüŞlb¬Theme
* 
	gR’d”SüŞlb¬Theme
::
»nd”SüŞlb¬Theme
()

35 
DEFINE_STATIC_LOCAL
(
R’d”SüŞlb¬Theme
, 
theme
, ());

36  &
	gtheme
;

39 
	gR’d”SüŞlb¬Theme
::
bu‰ÚSizesAlÚgT¿ckAxis
(
SüŞlb¬
* 
süŞlb¬
, & 
befÜeSize
, & 
aá”Size
)

41 
IÁReù
 
	gfœ¡Bu‰Ú
 = 
backBu‰ÚReù
(
süŞlb¬
, 
BackBu‰ÚS¹P¬t
);

42 
IÁReù
 
	g£cÚdBu‰Ú
 = 
fÜw¬dBu‰ÚReù
(
süŞlb¬
, 
FÜw¬dBu‰ÚS¹P¬t
);

43 
IÁReù
 
	gthœdBu‰Ú
 = 
backBu‰ÚReù
(
süŞlb¬
, 
BackBu‰ÚEndP¬t
);

44 
IÁReù
 
	gfou¹hBu‰Ú
 = 
fÜw¬dBu‰ÚReù
(
süŞlb¬
, 
FÜw¬dBu‰ÚEndP¬t
);

45 ià(
	gsüŞlb¬
->
Ü›Á©iÚ
(è=ğ
HÜizÚlSüŞlb¬
) {

46 
befÜeSize
 = 
fœ¡Bu‰Ú
.
width
(è+ 
£cÚdBu‰Ú
.width();

47 
	gaá”Size
 = 
thœdBu‰Ú
.
width
(è+ 
fou¹hBu‰Ú
.width();

49 
	gbefÜeSize
 = 
fœ¡Bu‰Ú
.
height
(è+ 
£cÚdBu‰Ú
.height();

50 
	gaá”Size
 = 
thœdBu‰Ú
.
height
(è+ 
fou¹hBu‰Ú
.height();

54 
boŞ
 
	gR’d”SüŞlb¬Theme
::
hasBu‰Ús
(
SüŞlb¬
* 
süŞlb¬
)

56 
¡¬tSize
;

57 
	g’dSize
;

58 
bu‰ÚSizesAlÚgT¿ckAxis
(
süŞlb¬
, 
¡¬tSize
, 
’dSize
);

59  (
	g¡¬tSize
 + 
	g’dSize
è<ğ(
süŞlb¬
->
Ü›Á©iÚ
(è=ğ
HÜizÚlSüŞlb¬
 ? süŞlb¬->
width
(è: süŞlb¬->
height
());

62 
boŞ
 
	gR’d”SüŞlb¬Theme
::
hasThumb
(
SüŞlb¬
* 
süŞlb¬
)

64  
ŒackL’gth
(
süŞlb¬
è- 
thumbL’gth
(scrollbar) >= 0;

67 
	gR’d”SüŞlb¬Theme
::
mšimumThumbL’gth
(
SüŞlb¬
* 
süŞlb¬
)

69  
toR’d”SüŞlb¬
(
süŞlb¬
)->
mšimumThumbL’gth
();

72 
IÁReù
 
	gR’d”SüŞlb¬Theme
::
backBu‰ÚReù
(
SüŞlb¬
* 
süŞlb¬
, 
SüŞlb¬P¬t
 
·¹Ty³
, 
boŞ
)

74  
toR’d”SüŞlb¬
(
süŞlb¬
)->
bu‰ÚReù
(
·¹Ty³
);

77 
IÁReù
 
	gR’d”SüŞlb¬Theme
::
fÜw¬dBu‰ÚReù
(
SüŞlb¬
* 
süŞlb¬
, 
SüŞlb¬P¬t
 
·¹Ty³
, 
boŞ
)

79  
toR’d”SüŞlb¬
(
süŞlb¬
)->
bu‰ÚReù
(
·¹Ty³
);

82 
IÁReù
 
	gR’d”SüŞlb¬Theme
::
ŒackReù
(
SüŞlb¬
* 
süŞlb¬
, 
boŞ
)

84 ià(!
hasBu‰Ús
(
süŞlb¬
))

85  
	gsüŞlb¬
->
äameReù
();

87 
	g¡¬tL’gth
;

88 
	g’dL’gth
;

89 
bu‰ÚSizesAlÚgT¿ckAxis
(
süŞlb¬
, 
¡¬tL’gth
, 
’dL’gth
);

91  
toR’d”SüŞlb¬
(
süŞlb¬
)->
ŒackReù
(
¡¬tL’gth
, 
’dL’gth
);

94 
IÁReù
 
	gR’d”SüŞlb¬Theme
::
cÚ¡¿šT¿ckReùToT¿ckP›ûs
(
SüŞlb¬
* 
süŞlb¬
, cÚ¡ IÁReù& 
»ù
)

96 
IÁReù
 
	gbackReù
 = 
toR’d”SüŞlb¬
(
süŞlb¬
)->
ŒackP›ûReùW™hM¬gšs
(
BackT¿ckP¬t
, 
»ù
);

97 
IÁReù
 
	gfÜw¬dReù
 = 
toR’d”SüŞlb¬
(
süŞlb¬
)->
ŒackP›ûReùW™hM¬gšs
(
FÜw¬dT¿ckP¬t
, 
»ù
);

98 
IÁReù
 
	g»suÉ
 = 
»ù
;

99 ià(
	gsüŞlb¬
->
Ü›Á©iÚ
(è=ğ
HÜizÚlSüŞlb¬
) {

100 
»suÉ
.
£tX
(
backReù
.
x
());

101 
	g»suÉ
.
£tWidth
(
fÜw¬dReù
.
right
(è- 
backReù
.
x
());

103 
	g»suÉ
.
£tY
(
backReù
.
y
());

104 
	g»suÉ
.
£tHeight
(
fÜw¬dReù
.
bÙtom
(è- 
backReù
.
y
());

106  
	g»suÉ
;

109 
	gR’d”SüŞlb¬Theme
::
·štSüŞlCÜÃr
(
SüŞlV›w
*, 
G¿phicsCÚ‹xt
* 
cÚ‹xt
, cÚ¡ 
IÁReù
& 
cÜÃrReù
)

112 
	gcÚ‹xt
->
flReù
(
cÜÃrReù
, 
CŞÜ
::
wh™e
, 
DeviûCŞÜS·û
);

115 
	gR’d”SüŞlb¬Theme
::
·štSüŞlb¬Background
(
G¿phicsCÚ‹xt
* 
cÚ‹xt
, 
SüŞlb¬
* 
süŞlb¬
)

117 
toR’d”SüŞlb¬
(
süŞlb¬
)->
·štP¬t
(
cÚ‹xt
, 
SüŞlb¬BGP¬t
, süŞlb¬->
äameReù
());

120 
	gR’d”SüŞlb¬Theme
::
·štT¿ckBackground
(
G¿phicsCÚ‹xt
* 
cÚ‹xt
, 
SüŞlb¬
* 
süŞlb¬
, cÚ¡ 
IÁReù
& 
»ù
)

122 
toR’d”SüŞlb¬
(
süŞlb¬
)->
·štP¬t
(
cÚ‹xt
, 
T¿ckBGP¬t
, 
»ù
);

125 
	gR’d”SüŞlb¬Theme
::
·štT¿ckP›û
(
G¿phicsCÚ‹xt
* 
cÚ‹xt
, 
SüŞlb¬
* 
süŞlb¬
, cÚ¡ 
IÁReù
& 
»ù
, 
SüŞlb¬P¬t
 
·¹
)

127 
toR’d”SüŞlb¬
(
süŞlb¬
)->
·štP¬t
(
cÚ‹xt
, 
·¹
, 
»ù
);

130 
	gR’d”SüŞlb¬Theme
::
·štBu‰Ú
(
G¿phicsCÚ‹xt
* 
cÚ‹xt
, 
SüŞlb¬
* 
süŞlb¬
, cÚ¡ 
IÁReù
& 
»ù
, 
SüŞlb¬P¬t
 
·¹
)

132 
toR’d”SüŞlb¬
(
süŞlb¬
)->
·štP¬t
(
cÚ‹xt
, 
·¹
, 
»ù
);

135 
	gR’d”SüŞlb¬Theme
::
·štThumb
(
G¿phicsCÚ‹xt
* 
cÚ‹xt
, 
SüŞlb¬
* 
süŞlb¬
, cÚ¡ 
IÁReù
& 
»ù
)

137 
toR’d”SüŞlb¬
(
süŞlb¬
)->
·štP¬t
(
cÚ‹xt
, 
ThumbP¬t
, 
»ù
);

	@RenderScrollbarTheme.h

26 #iâdeà
R’d”SüŞlb¬Theme_h


27 
	#R’d”SüŞlb¬Theme_h


	)

29 
	~"SüŞlb¬ThemeCompos™e.h
"

31 
Çme¥aû
 
	gWebCÜe
 {

33 
şass
 
	gPÏtfÜmMou£Ev’t
;

34 
şass
 
	gSüŞlb¬
;

35 
şass
 
	gSüŞlV›w
;

37 şas 
	cR’d”SüŞlb¬Theme
 : 
public
 
SüŞlb¬ThemeCompos™e
 {

38 
public
:

39 
vœtu®
 ~
R’d”SüŞlb¬Theme
() {};

41 
vœtu®
 
süŞlb¬ThickÃss
(
SüŞlb¬CÚŒŞSize
 
cÚŒŞSize
è{  
	gSüŞlb¬Theme
::
ÇtiveTheme
()->scrollbarThickness(controlSize); }

43 
vœtu®
 
SüŞlb¬Bu‰ÚsPÏûm’t
 
bu‰ÚsPÏûm’t
(ècÚ¡ {  
	gSüŞlb¬Theme
::
ÇtiveTheme
()->buttonsPlacement(); }

45 
vœtu®
 
boŞ
 
suµÜtsCÚŒŞTšts
(ècÚ¡ {  
	gŒue
; }

47 
vœtu®
 
·štSüŞlCÜÃr
(
SüŞlV›w
*, 
G¿phicsCÚ‹xt
* 
cÚ‹xt
, cÚ¡ 
IÁReù
& 
cÜÃrReù
);

49 
vœtu®
 
boŞ
 
shouldC’‹rOnThumb
(
SüŞlb¬
* 
süŞlb¬
, cÚ¡ 
PÏtfÜmMou£Ev’t
& 
ev’t
è{  
	gSüŞlb¬Theme
::
ÇtiveTheme
()->shouldCenterOnThumb(scrollbar,ƒvent); }

51 
vœtu®
 
š™ŸlAutosüŞlTim”D–ay
(è{  
	gSüŞlb¬Theme
::
ÇtiveTheme
()->initialAutoscrollTimerDelay(); }

52 
vœtu®
 
autosüŞlTim”D–ay
(è{  
	gSüŞlb¬Theme
::
ÇtiveTheme
()->autoscrollTimerDelay(); }

54 
vœtu®
 
»gi¡”SüŞlb¬
(
SüŞlb¬
* 
süŞlb¬
è{  
	gSüŞlb¬Theme
::
ÇtiveTheme
()->registerScrollbar(scrollbar); }

55 
vœtu®
 
uÄegi¡”SüŞlb¬
(
SüŞlb¬
* 
süŞlb¬
è{  
	gSüŞlb¬Theme
::
ÇtiveTheme
()->unregisterScrollbar(scrollbar); }

57 
vœtu®
 
mšimumThumbL’gth
(
SüŞlb¬
*);

59 
bu‰ÚSizesAlÚgT¿ckAxis
(
SüŞlb¬
* 
süŞlb¬
, & 
befÜeSize
, & 
aá”Size
);

61 
R’d”SüŞlb¬Theme
* 
»nd”SüŞlb¬Theme
();

63 
	g´Ùeùed
:

64 
vœtu®
 
boŞ
 
hasBu‰Ús
(
SüŞlb¬
*);

65 
vœtu®
 
boŞ
 
hasThumb
(
SüŞlb¬
*);

67 
vœtu®
 
IÁReù
 
backBu‰ÚReù
(
SüŞlb¬
*, 
SüŞlb¬P¬t
, 
boŞ
 
·štšg
 = 
çl£
);

68 
vœtu®
 
IÁReù
 
fÜw¬dBu‰ÚReù
(
SüŞlb¬
*, 
SüŞlb¬P¬t
, 
boŞ
 
·štšg
 = 
çl£
);

69 
vœtu®
 
IÁReù
 
ŒackReù
(
SüŞlb¬
*, 
boŞ
 
·štšg
 = 
çl£
);

71 
vœtu®
 
·štSüŞlb¬Background
(
G¿phicsCÚ‹xt
*, 
SüŞlb¬
*);

72 
vœtu®
 
·štT¿ckBackground
(
G¿phicsCÚ‹xt
*, 
SüŞlb¬
*, cÚ¡ 
IÁReù
&);

73 
vœtu®
 
·štT¿ckP›û
(
G¿phicsCÚ‹xt
*, 
SüŞlb¬
*, cÚ¡ 
IÁReù
&, 
SüŞlb¬P¬t
);

74 
vœtu®
 
·štBu‰Ú
(
G¿phicsCÚ‹xt
*, 
SüŞlb¬
*, cÚ¡ 
IÁReù
&, 
SüŞlb¬P¬t
);

75 
vœtu®
 
·štThumb
(
G¿phicsCÚ‹xt
*, 
SüŞlb¬
*, cÚ¡ 
IÁReù
&);

77 
vœtu®
 
IÁReù
 
cÚ¡¿šT¿ckReùToT¿ckP›ûs
(
SüŞlb¬
*, const IntRect&);

	@RenderSelectionInfo.h

25 #iâdeà
S–eùiÚInfo_h


26 
	#S–eùiÚInfo_h


	)

28 
	~"IÁReù.h
"

29 
	~"R’d”Box.h
"

31 
Çme¥aû
 
	gWebCÜe
 {

33 şas 
	cR’d”S–eùiÚInfoBa£
 : 
public
 
NÚcİyabË
 {

34 
public
:

35 
R’d”S–eùiÚInfoBa£
()

36 : 
m_objeù
(0)

37 , 
m_»·štCÚš”
(0)

38 , 
m_¡©e
(
R’d”Objeù
::
S–eùiÚNÚe
)

42 
R’d”S–eùiÚInfoBa£
(
R’d”Objeù
* 
o
)

43 : 
m_objeù
(
o
)

44 , 
m_»·štCÚš”
(
o
->
cÚš”FÜR•ašt
())

45 , 
m_¡©e
(
o
->
£ËùiÚS‹
())

49 
R’d”Objeù
* 
objeù
(ècÚ¡ {  
	gm_objeù
; }

50 
R’d”BoxMod–Objeù
* 
»·štCÚš”
(ècÚ¡ {  
	gm_»·štCÚš”
; }

51 
	gR’d”Objeù
::
S–eùiÚS‹
 
¡©e
(ècÚ¡ {  
m_¡©e
; }

53 
	g´Ùeùed
:

54 
R’d”Objeù
* 
m_objeù
;

55 
R’d”BoxMod–Objeù
* 
	gm_»·štCÚš”
;

56 
	gR’d”Objeù
::
S–eùiÚS‹
 
m_¡©e
;

60 şas 
	cR’d”S–eùiÚInfo
 : 
public
 
R’d”S–eùiÚInfoBa£
 {

61 
public
:

62 
R’d”S–eùiÚInfo
(
R’d”Objeù
* 
o
, 
boŞ
 
şToVisibËCÚ‹Á
)

63 : 
R’d”S–eùiÚInfoBa£
(
o
)

64 , 
m_»ù
(
o
->
ÃedsLayout
(è? 
IÁReù
(è: o->
£ËùiÚReùFÜR•ašt
(
m_»·štCÚš”
, 
şToVisibËCÚ‹Á
))

68 
»·št
()

70 
	gm_objeù
->
»·štUsšgCÚš”
(
m_»·štCÚš”
, 
m_»ù
);

73 
IÁReù
 
»ù
(ècÚ¡ {  
	gm_»ù
; }

75 
	g´iv©e
:

76 
IÁReù
 
m_»ù
;

81 şas 
	cR’d”BlockS–eùiÚInfo
 : 
public
 
R’d”S–eùiÚInfoBa£
 {

82 
public
:

83 
R’d”BlockS–eùiÚInfo
(
R’d”Block
* 
b
)

84 : 
R’d”S–eùiÚInfoBa£
(
b
)

85 , 
m_»ùs
(
b
->
ÃedsLayout
(è? 
G­Reùs
(è: 
block
()->
£ËùiÚG­ReùsFÜR•ašt
(
m_»·štCÚš”
))

89 
»·št
()

91 
m_objeù
->
»·štUsšgCÚš”
(
m_»·štCÚš”
, 
m_»ùs
);

94 
R’d”Block
* 
block
(ècÚ¡ {  
toR’d”Block
(
m_objeù
); }

95 
G­Reùs
 
»ùs
(ècÚ¡ {  
	gm_»ùs
; }

97 
	g´iv©e
:

98 
G­Reùs
 
m_»ùs
;

	@RenderSlider.cpp

21 
	~"cÚfig.h
"

22 
	~"R’d”Slid”.h
"

24 
	~"CSSPrİ”tyNames.h
"

25 
	~"Docum’t.h
"

26 
	~"Ev’t.h
"

27 
	~"Ev’tHªdËr.h
"

28 
	~"Ev’tNames.h
"

29 
	~"F¿me.h
"

30 
	~"HTMLIÅutEËm’t.h
"

31 
	~"HTMLDivEËm’t.h
"

32 
	~"HTMLNames.h
"

33 
	~"MedŸCÚŒŞEËm’ts.h
"

34 
	~"Mou£Ev’t.h
"

35 
	~"R’d”Lay”.h
"

36 
	~"R’d”Theme.h
"

37 
	~"R’d”V›w.h
"

38 
	~"S‹pRªge.h
"

39 
	~<wtf/M©hExŒas.h
>

41 
usšg
 
	g¡d
::
mš
;

43 
Çme¥aû
 
	gWebCÜe
 {

45 
usšg
 
Çme¥aû
 
	gHTMLNames
;

47 cÚ¡ 
	gdeçuÉT¿ckL’gth
 = 129;

50 
¦id”Pos™iÚ
(
HTMLIÅutEËm’t
* 
–em’t
)

52 
S‹pRªge
 
¿nge
(
–em’t
);

53  
	g¿nge
.
´İÜtiÚFromV®ue
(
¿nge
.
v®ueFromEËm’t
(
–em’t
));

56 şas 
	cSlid”ThumbEËm’t
 : 
public
 
HTMLDivEËm’t
 {

57 
public
:

58 
Slid”ThumbEËm’t
(
Docum’t
*, 
Node
* 
shadowP¬’t
);

60 
boŞ
 
šD¿gMode
(ècÚ¡ {  
	gm_šD¿gMode
; }

62 
vœtu®
 
deçuÉEv’tHªdËr
(
Ev’t
*);

63 
vœtu®
 
d‘ach
();

65 
	g´iv©e
:

66 
vœtu®
 
boŞ
 
isShadowNode
(ècÚ¡ {  
Œue
; }

67 
vœtu®
 
Node
* 
shadowP¬’tNode
(è{  
	gm_shadowP¬’t
; }

69 
FlßtPošt
 
	gm_off£tToThumb
;

70 
Node
* 
	gm_shadowP¬’t
;

71 
boŞ
 
	gm_šD¿gMode
;

74 
	gSlid”ThumbEËm’t
::
	$Slid”ThumbEËm’t
(
Docum’t
* 
docum’t
, 
Node
* 
shadowP¬’t
)

75 : 
	`HTMLDivEËm’t
(
divTag
, 
docum’t
)

76 , 
	`m_shadowP¬’t
(
shadowP¬’t
)

77 , 
	$m_šD¿gMode
(
çl£
)

79 
	}
}

81 
	gSlid”ThumbEËm’t
::
	$deçuÉEv’tHªdËr
(
Ev’t
* 
ev’t
)

83 ià(!
ev’t
->
	`isMou£Ev’t
()) {

84 
HTMLDivEËm’t
::
	`deçuÉEv’tHªdËr
(
ev’t
);

88 
Mou£Ev’t
* 
mou£Ev’t
 = 
¡©ic_ÿ¡
<Mou£Ev’t*>(
ev’t
);

89 
boŞ
 
isLeáBu‰Ú
 = 
mou£Ev’t
->
	`bu‰Ú
(è=ğ
LeáBu‰Ú
;

90 cÚ¡ 
AtomicSŒšg
& 
ev’tTy³
 = 
ev’t
->
	`ty³
();

92 ià(
ev’tTy³
 =ğ
	`ev’tNames
().
mou£downEv’t
 && 
isLeáBu‰Ú
) {

93 ià(
	`docum’t
()->
	`äame
(è&& 
	`»nd””
()) {

94 
R’d”Slid”
* 
¦id”
 = 
	`toR’d”Slid”
(
	`»nd””
()->
	`·»Á
());

95 ià(
¦id”
) {

96 ià(
¦id”
->
	`mou£Ev’tIsInThumb
(
mou£Ev’t
)) {

99 
m_off£tToThumb
 = 
¦id”
->
	`mou£Ev’tOff£tToThumb
(
mou£Ev’t
);

103 
m_off£tToThumb
.
	`£tX
(0);

104 
m_off£tToThumb
.
	`£tY
(0);

107 
m_šD¿gMode
 = 
Œue
;

108 
	`docum’t
()->
	`äame
()->
	`ev’tHªdËr
()->
	`£tC­turšgMou£Ev’tsNode
(
m_shadowP¬’t
);

109 
ev’t
->
	`£tDeçuÉHªdËd
();

113 } ià(
ev’tTy³
 =ğ
	`ev’tNames
().
mou£upEv’t
 && 
isLeáBu‰Ú
) {

114 ià(
m_šD¿gMode
) {

115 ià(
F¿me
* 
äame
 = 
	`docum’t
()->
	`äame
())

116 
äame
->
	`ev’tHªdËr
()->
	`£tC­turšgMou£Ev’tsNode
(0);

117 
m_šD¿gMode
 = 
çl£
;

118 
ev’t
->
	`£tDeçuÉHªdËd
();

121 } ià(
ev’tTy³
 =ğ
	`ev’tNames
().
mou£moveEv’t
) {

122 ià(
m_šD¿gMode
 && 
	`»nd””
(è&&„’d””()->
	`·»Á
()) {

123 
R’d”Slid”
* 
¦id”
 = 
	`toR’d”Slid”
(
	`»nd””
()->
	`·»Á
());

124 ià(
¦id”
) {

125 
FlßtPošt
 
curPošt
 = 
¦id”
->
	`absŞu‹ToLoÿl
(
mou£Ev’t
->
	`absŞu‹LoÿtiÚ
(), 
çl£
, 
Œue
);

126 
IÁPošt
 
	`ev’tOff£t
(
curPošt
.
	`x
(è+ 
m_off£tToThumb
.x(), curPošt.
	`y
() + m_offsetToThumb.y());

127 
¦id”
->
	`£tV®ueFÜPos™iÚ
(¦id”->
	`pos™iÚFÜOff£t
(
ev’tOff£t
));

128 
ev’t
->
	`£tDeçuÉHªdËd
();

134 
HTMLDivEËm’t
::
	`deçuÉEv’tHªdËr
(
ev’t
);

135 
	}
}

137 
	gSlid”ThumbEËm’t
::
	$d‘ach
()

139 ià(
m_šD¿gMode
) {

140 ià(
F¿me
* 
äame
 = 
	`docum’t
()->
	`äame
())

141 
äame
->
	`ev’tHªdËr
()->
	`£tC­turšgMou£Ev’tsNode
(0);

143 
HTMLDivEËm’t
::
	`d‘ach
();

144 
	}
}

146 
	gR’d”Slid”
::
	$R’d”Slid”
(
HTMLIÅutEËm’t
* 
–em’t
)

147 : 
	$R’d”Block
(
–em’t
)

149 
	}
}

151 
R’d”Slid”
::~
	$R’d”Slid”
()

153 ià(
m_thumb
)

154 
m_thumb
->
	`d‘ach
();

155 
	}
}

157 
	gR’d”Slid”
::
	$ba£lšePos™iÚ
(
boŞ
, bool) const

159  
	`height
(è+ 
	`m¬gšTİ
();

160 
	}
}

162 
	gR’d”Slid”
::
	$ÿlcP»fWidths
()

164 
m_mšP»fWidth
 = 0;

165 
m_maxP»fWidth
 = 0;

167 ià(
	`¡yË
()->
	`width
().
	`isFixed
(è&& styË()->width().
	`v®ue
() > 0)

168 
m_mšP»fWidth
 = 
m_maxP»fWidth
 = 
	`ÿlcCÚ‹ÁBoxWidth
(
	`¡yË
()->
	`width
().
	`v®ue
());

170 
m_maxP»fWidth
 = 
deçuÉT¿ckL’gth
 * 
	`¡yË
()->
	`efãùiveZoom
();

172 ià(
	`¡yË
()->
	`mšWidth
().
	`isFixed
(è&& styË()->mšWidth().
	`v®ue
() > 0) {

173 
m_maxP»fWidth
 = 
	`max
(m_maxP»fWidth, 
	`ÿlcCÚ‹ÁBoxWidth
(
	`¡yË
()->
	`mšWidth
().
	`v®ue
()));

174 
m_mšP»fWidth
 = 
	`max
(m_mšP»fWidth, 
	`ÿlcCÚ‹ÁBoxWidth
(
	`¡yË
()->
	`mšWidth
().
	`v®ue
()));

175 } ià(
	`¡yË
()->
	`width
().
	`isP”ûÁ
(è|| (¡yË()->width().
	`isAuto
(è&& styË()->
	`height
().isPercent()))

176 
m_mšP»fWidth
 = 0;

178 
m_mšP»fWidth
 = 
m_maxP»fWidth
;

180 ià(
	`¡yË
()->
	`maxWidth
().
	`isFixed
(è&& styË()->maxWidth().
	`v®ue
(è!ğ
undefšedL’gth
) {

181 
m_maxP»fWidth
 = 
	`mš
(m_maxP»fWidth, 
	`ÿlcCÚ‹ÁBoxWidth
(
	`¡yË
()->
	`maxWidth
().
	`v®ue
()));

182 
m_mšP»fWidth
 = 
	`mš
(m_mšP»fWidth, 
	`ÿlcCÚ‹ÁBoxWidth
(
	`¡yË
()->
	`maxWidth
().
	`v®ue
()));

185 
toAdd
 = 
	`·ddšgLeá
(è+ 
	`·ddšgRight
(è+ 
	`bÜd”Leá
(è+ 
	`bÜd”Right
();

186 
m_mšP»fWidth
 +ğ
toAdd
;

187 
m_maxP»fWidth
 +ğ
toAdd
;

189 
	`£tP»fWidthsDœty
(
çl£
);

190 
	}
}

192 
	gR’d”Slid”
::
	$¡yËDidChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
)

194 
R’d”Block
::
	`¡yËDidChªge
(
diff
, 
ŞdStyË
);

196 ià(
m_thumb
)

197 
m_thumb
->
	`»nd””
()->
	`£tStyË
(
	`ü—‹ThumbStyË
(
	`¡yË
()));

199 
	`£tR•Ïûd
(
	`isIÆše
());

200 
	}
}

202 
	gPassRefPŒ
<
	gR’d”StyË
> 
	gR’d”Slid”
::
	$ü—‹ThumbStyË
(cÚ¡ 
R’d”StyË
* 
·»ÁStyË
)

204 
RefPŒ
<
R’d”StyË
> 
¡yË
;

205 
R’d”StyË
* 
p£udoStyË
 = 
	`g‘CachedP£udoStyË
(
SLIDER_THUMB
);

206 ià(
p£udoStyË
)

208 
¡yË
 = 
R’d”StyË
::
	`şÚe
(
p£udoStyË
);

210 
¡yË
 = 
R’d”StyË
::
	`ü—‹
();

212 ià(
·»ÁStyË
)

213 
¡yË
->
	`šh”™From
(
·»ÁStyË
);

215 
¡yË
->
	`£tDi¥Ïy
(
BLOCK
);

217 ià(
·»ÁStyË
->
	`­³¬ªû
(è=ğ
Slid”V”tiÿlP¬t
)

218 
¡yË
->
	`£tAµ—¿nû
(
Slid”ThumbV”tiÿlP¬t
);

219 ià(
·»ÁStyË
->
	`­³¬ªû
(è=ğ
Slid”HÜizÚlP¬t
)

220 
¡yË
->
	`£tAµ—¿nû
(
Slid”ThumbHÜizÚlP¬t
);

221 ià(
·»ÁStyË
->
	`­³¬ªû
(è=ğ
MedŸSlid”P¬t
)

222 
¡yË
->
	`£tAµ—¿nû
(
MedŸSlid”ThumbP¬t
);

223 ià(
·»ÁStyË
->
	`­³¬ªû
(è=ğ
MedŸVŞumeSlid”P¬t
)

224 
¡yË
->
	`£tAµ—¿nû
(
MedŸVŞumeSlid”ThumbP¬t
);

226  
¡yË
.
	`»Ëa£
();

227 
	}
}

229 
IÁReù
 
	gR’d”Slid”
::
	$thumbReù
()

231 ià(!
m_thumb
)

232  
	`IÁReù
();

234 
IÁReù
 
thumbReù
;

235 
R’d”Box
* 
thumb
 = 
	`toR’d”Box
(
m_thumb
->
	`»nd””
());

237 
thumbReù
.
	`£tWidth
(
thumb
->
	`¡yË
()->
	`width
().
	`ÿlcMšV®ue
(
	`cÚ‹ÁWidth
()));

238 
thumbReù
.
	`£tHeight
(
thumb
->
	`¡yË
()->
	`height
().
	`ÿlcMšV®ue
(
	`cÚ‹ÁHeight
()));

240 
äaùiÚ
 = 
	`¦id”Pos™iÚ
(
¡©ic_ÿ¡
<
HTMLIÅutEËm’t
*>(
	`node
()));

241 
IÁReù
 
cÚ‹ÁReù
 = 
	`cÚ‹ÁBoxReù
();

242 ià(
	`¡yË
()->
	`­³¬ªû
(è=ğ
Slid”V”tiÿlP¬t
 || styË()->­³¬ªû(è=ğ
MedŸVŞumeSlid”P¬t
) {

243 
thumbReù
.
	`£tX
(
cÚ‹ÁReù
.
	`x
(è+ (cÚ‹ÁReù.
	`width
() -humbRect.width()) / 2);

244 
thumbReù
.
	`£tY
(
cÚ‹ÁReù
.
	`y
(è+ 
¡©ic_ÿ¡
<>(
	`Ãxá”
((cÚ‹ÁReù.
	`height
(è-humbReù.height()è+ 1, 0è* (1 - 
äaùiÚ
)));

246 
thumbReù
.
	`£tX
(
cÚ‹ÁReù
.
	`x
(è+ 
¡©ic_ÿ¡
<>(
	`Ãxá”
((cÚ‹ÁReù.
	`width
(è-humbReù.width()è+ 1, 0è* 
äaùiÚ
));

247 
thumbReù
.
	`£tY
(
cÚ‹ÁReù
.
	`y
(è+ (cÚ‹ÁReù.
	`height
() -humbRect.height()) / 2);

250  
thumbReù
;

251 
	}
}

253 
	gR’d”Slid”
::
	$Ïyout
()

255 
	`ASSERT
(
	`ÃedsLayout
());

257 
R’d”Box
* 
thumb
 = 
m_thumb
 ? 
	`toR’d”Box
(m_thumb->
	`»nd””
()) : 0;

259 
IÁSize
 
	`ba£Size
(
	`bÜd”Leá
(è+ 
	`·ddšgLeá
(è+ 
	`·ddšgRight
(è+ 
	`bÜd”Right
(),

260 
	`bÜd”Tİ
(è+ 
	`·ddšgTİ
(è+ 
	`·ddšgBÙtom
(è+ 
	`bÜd”BÙtom
());

262 ià(
thumb
) {

264 ià(
thumb
->
	`¡yË
()->
	`hasAµ—¿nû
()) {

266 
	`theme
()->
	`adju¡Slid”ThumbSize
(
thumb
);

269 
ba£Size
.
	`ex·nd
(
thumb
->
	`¡yË
()->
	`width
().
	`ÿlcMšV®ue
(0),humb->¡yË()->
	`height
().calcMinValue(0));

272 
LayoutR•aš‹r
 
	`»·š‹r
(*
this
, 
	`checkFÜR•aštDuršgLayout
());

274 
IÁSize
 
ŞdSize
 = 
	`size
();

276 
	`£tSize
(
ba£Size
);

277 
	`ÿlcWidth
();

278 
	`ÿlcHeight
();

280 ià(
thumb
) {

281 ià(
ŞdSize
 !ğ
	`size
())

282 
thumb
->
	`£tChdN“dsLayout
(
Œue
, 
çl£
);

284 
LayoutS‹Mašš”
 
	`¡©ePush”
(
	`v›w
(), 
this
, 
	`size
());

286 
IÁReù
 
ŞdThumbReù
 = 
thumb
->
	`äameReù
();

288 
thumb
->
	`ÏyoutIfN“ded
();

290 
IÁReù
 
»ù
 = 
	`thumbReù
();

291 
thumb
->
	`£tF¿meReù
(
»ù
);

292 ià(
thumb
->
	`checkFÜR•aštDuršgLayout
())

293 
thumb
->
	`»·štDuršgLayoutIfMoved
(
ŞdThumbReù
);

295 
¡©ePush”
.
	`pİ
();

296 
	`addOv”æowFromChd
(
thumb
);

299 
»·š‹r
.
	`»·štAá”Layout
();

301 
	`£tN“dsLayout
(
çl£
);

302 
	}
}

304 
	gR’d”Slid”
::
	$upd©eFromEËm’t
()

307 ià(!
m_thumb
) {

308 
m_thumb
 = 
Ãw
 
	`Slid”ThumbEËm’t
(
	`docum’t
(), 
	`node
());

309 
RefPŒ
<
R’d”StyË
> 
thumbStyË
 = 
	`ü—‹ThumbStyË
(
	`¡yË
());

310 
m_thumb
->
	`£tR’d””
(m_thumb->
	`ü—‹R’d””
(
	`»nd”A»Ç
(), 
thumbStyË
.
	`g‘
()));

311 
m_thumb
->
	`»nd””
()->
	`£tStyË
(
thumbStyË
.
	`»Ëa£
());

312 
m_thumb
->
	`£tA‰ached
();

313 
m_thumb
->
	`£tInDocum’t
(
Œue
);

314 
	`addChd
(
m_thumb
->
	`»nd””
());

316 
	`£tN“dsLayout
(
Œue
);

317 
	}
}

319 
boŞ
 
	gR’d”Slid”
::
	$mou£Ev’tIsInThumb
(
Mou£Ev’t
* 
evt
)

321 ià(!
m_thumb
 || !m_thumb->
	`»nd””
())

322  
çl£
;

324 #ià
	`ENABLE
(
VIDEO
)

325 ià(
	`¡yË
()->
	`­³¬ªû
(è=ğ
MedŸSlid”P¬t
 || styË()->­³¬ªû(è=ğ
MedŸVŞumeSlid”P¬t
) {

326 
MedŸCÚŒŞIÅutEËm’t
 *
¦id”Thumb
 = 
¡©ic_ÿ¡
<MedŸCÚŒŞIÅutEËm’t*>(
m_thumb
->
	`»nd””
()->
	`node
());

327  
¦id”Thumb
->
	`h™Te¡
(
evt
->
	`absŞu‹LoÿtiÚ
());

331 
FlßtPošt
 
loÿlPošt
 = 
m_thumb
->
	`»nd”Box
()->
	`absŞu‹ToLoÿl
(
evt
->
	`absŞu‹LoÿtiÚ
(), 
çl£
, 
Œue
);

332 
IÁReù
 
thumbBounds
 = 
m_thumb
->
	`»nd”Box
()->
	`bÜd”BoxReù
();

333  
thumbBounds
.
	`cÚšs
(
	`roundedIÁPošt
(
loÿlPošt
));

334 
	}
}

336 
FlßtPošt
 
	gR’d”Slid”
::
	$mou£Ev’tOff£tToThumb
(
Mou£Ev’t
* 
evt
)

338 
	`ASSERT
(
m_thumb
 && m_thumb->
	`»nd””
());

339 
FlßtPošt
 
loÿlPošt
 = 
m_thumb
->
	`»nd”Box
()->
	`absŞu‹ToLoÿl
(
evt
->
	`absŞu‹LoÿtiÚ
(), 
çl£
, 
Œue
);

340 
IÁReù
 
thumbBounds
 = 
m_thumb
->
	`»nd”Box
()->
	`bÜd”BoxReù
();

341 
FlßtPošt
 
off£t
;

342 
off£t
.
	`£tX
(
thumbBounds
.
	`x
(è+humbBounds.
	`width
(è/ 2 - 
loÿlPošt
.x());

343 
off£t
.
	`£tY
(
thumbBounds
.
	`y
(è+humbBounds.
	`height
(è/ 2 - 
loÿlPošt
.y());

344  
off£t
;

345 
	}
}

347 
	gR’d”Slid”
::
	$£tV®ueFÜPos™iÚ
(
pos™iÚ
)

349 ià(!
m_thumb
 || !m_thumb->
	`»nd””
())

352 
HTMLIÅutEËm’t
* 
–em’t
 = 
¡©ic_ÿ¡
<HTMLIÅutEËm’t*>(
	`node
());

355 
S‹pRªge
 
	`¿nge
(
–em’t
);

356 
äaùiÚ
 = 
¡©ic_ÿ¡
<>(
pos™iÚ
è/ 
	`ŒackSize
();

357 ià(
	`¡yË
()->
	`­³¬ªû
(è=ğ
Slid”V”tiÿlP¬t
 || styË()->­³¬ªû(è=ğ
MedŸVŞumeSlid”P¬t
)

358 
äaùiÚ
 = 1 - fraction;

359 
v®ue
 = 
¿nge
.
	`şampV®ue
Ôªge.
	`v®ueFromPrİÜtiÚ
(
äaùiÚ
));

360 
–em’t
->
	`£tV®ueFromR’d””
(
HTMLIÅutEËm’t
::
	`£rŸlizeFÜNumb”Ty³
(
v®ue
));

363 ià(
pos™iÚ
 !ğ
	`cu¼’tPos™iÚ
()) {

364 
	`£tN“dsLayout
(
Œue
);

368 
–em’t
->
	`di¥©chFÜmCÚŒŞChªgeEv’t
();

370 
	}
}

372 
	gR’d”Slid”
::
	$pos™iÚFÜOff£t
(cÚ¡ 
IÁPošt
& 
p
)

374 ià(!
m_thumb
 || !m_thumb->
	`»nd””
())

377 
pos™iÚ
;

378 ià(
	`¡yË
()->
	`­³¬ªû
(è=ğ
Slid”V”tiÿlP¬t
 || styË()->­³¬ªû(è=ğ
MedŸVŞumeSlid”P¬t
)

379 
pos™iÚ
 = 
p
.
	`y
(è- 
m_thumb
->
	`»nd”Box
()->
	`height
() / 2;

381 
pos™iÚ
 = 
p
.
	`x
(è- 
m_thumb
->
	`»nd”Box
()->
	`width
() / 2;

383  
	`max
(0, 
	`mš
(
pos™iÚ
, 
	`ŒackSize
()));

384 
	}
}

386 
	gR’d”Slid”
::
	$cu¼’tPos™iÚ
()

388 
	`ASSERT
(
m_thumb
);

389 
	`ASSERT
(
m_thumb
->
	`»nd””
());

391 ià(
	`¡yË
()->
	`­³¬ªû
(è=ğ
Slid”V”tiÿlP¬t
 || styË()->­³¬ªû(è=ğ
MedŸVŞumeSlid”P¬t
)

392  
	`toR’d”Box
(
m_thumb
->
	`»nd””
())->
	`y
(è- 
	`cÚ‹ÁBoxReù
().y();

393  
	`toR’d”Box
(
m_thumb
->
	`»nd””
())->
	`x
(è- 
	`cÚ‹ÁBoxReù
().x();

394 
	}
}

396 
	gR’d”Slid”
::
	$ŒackSize
()

398 
	`ASSERT
(
m_thumb
);

399 
	`ASSERT
(
m_thumb
->
	`»nd””
());

401 ià(
	`¡yË
()->
	`­³¬ªû
(è=ğ
Slid”V”tiÿlP¬t
 || styË()->­³¬ªû(è=ğ
MedŸVŞumeSlid”P¬t
)

402  
	`cÚ‹ÁHeight
(è- 
m_thumb
->
	`»nd”Box
()->
	`height
();

403  
	`cÚ‹ÁWidth
(è- 
m_thumb
->
	`»nd”Box
()->
	`width
();

404 
	}
}

406 
	gR’d”Slid”
::
	$fÜw¬dEv’t
(
Ev’t
* 
ev’t
)

408 ià(
ev’t
->
	`isMou£Ev’t
()) {

409 
Mou£Ev’t
* 
mou£Ev’t
 = 
¡©ic_ÿ¡
<Mou£Ev’t*>(
ev’t
);

410 ià(
ev’t
->
	`ty³
(è=ğ
	`ev’tNames
().
mou£downEv’t
 && 
mou£Ev’t
->
	`bu‰Ú
(è=ğ
LeáBu‰Ú
) {

411 ià(!
	`mou£Ev’tIsInThumb
(
mou£Ev’t
)) {

412 
IÁPošt
 
ev’tOff£t
 = 
	`roundedIÁPošt
(
	`absŞu‹ToLoÿl
(
mou£Ev’t
->
	`absŞu‹LoÿtiÚ
(), 
çl£
, 
Œue
));

413 
	`£tV®ueFÜPos™iÚ
(
	`pos™iÚFÜOff£t
(
ev’tOff£t
));

418 
m_thumb
->
	`deçuÉEv’tHªdËr
(
ev’t
);

419 
	}
}

421 
boŞ
 
	gR’d”Slid”
::
	$šD¿gMode
() const

423  
m_thumb
 && m_thumb->
	`šD¿gMode
();

424 
	}
}

	@RenderSlider.h

21 #iâdeà
R’d”Slid”_h


22 
	#R’d”Slid”_h


	)

24 
	~"R’d”Block.h
"

26 
Çme¥aû
 
	gWebCÜe
 {

28 
şass
 
	gHTMLIÅutEËm’t
;

29 
şass
 
	gMou£Ev’t
;

30 
şass
 
	gSlid”ThumbEËm’t
;

32 şas 
	cR’d”Slid”
 : 
public
 
R’d”Block
 {

33 
public
:

34 
R’d”Slid”
(
HTMLIÅutEËm’t
*);

35 
	gvœtu®
 ~
R’d”Slid”
();

37 
fÜw¬dEv’t
(
Ev’t
*);

38 
boŞ
 
šD¿gMode
() const;

39 
IÁReù
 
thumbReù
();

41 
	g´iv©e
:

42 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderSlider"; }

43 
vœtu®
 
boŞ
 
isSlid”
(ècÚ¡ {  
	gŒue
; }

45 
vœtu®
 
ba£lšePos™iÚ
(
boŞ
, bool) const;

46 
vœtu®
 
ÿlcP»fWidths
();

47 
vœtu®
 
Ïyout
();

48 
vœtu®
 
upd©eFromEËm’t
();

50 
boŞ
 
mou£Ev’tIsInThumb
(
Mou£Ev’t
*);

51 
FlßtPošt
 
mou£Ev’tOff£tToThumb
(
Mou£Ev’t
*);

53 
£tV®ueFÜPos™iÚ
(
pos™iÚ
);

54 
£tPos™iÚFromV®ue
();

55 
pos™iÚFÜOff£t
(cÚ¡ 
IÁPošt
&);

57 
cu¼’tPos™iÚ
();

59 
vœtu®
 
¡yËDidChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
);

61 
	gPassRefPŒ
<
	gR’d”StyË
> 
ü—‹ThumbStyË
(cÚ¡ 
R’d”StyË
* 
·»ÁStyË
);

63 
ŒackSize
();

65 
	gRefPŒ
<
	gSlid”ThumbEËm’t
> 
	gm_thumb
;

67 
ä›nd
 
şass
 
	gSlid”ThumbEËm’t
;

70 
šlše
 
R’d”Slid”
* 
	$toR’d”Slid”
(
R’d”Objeù
* 
objeù
)

72 
	`ASSERT
(!
objeù
 || objeù->
	`isSlid”
());

73  
¡©ic_ÿ¡
<
R’d”Slid”
*>(
objeù
);

74 
	}
}

77 
toR’d”Slid”
(cÚ¡ 
R’d”Slid”
*);

	@RenderTable.cpp

26 
	~"cÚfig.h
"

27 
	~"R’d”TabË.h
"

29 
	~"AutoTabËLayout.h
"

30 
	~"D–‘eBu‰ÚCÚŒŞËr.h
"

31 
	~"Docum’t.h
"

32 
	~"FixedTabËLayout.h
"

33 
	~"F¿meV›w.h
"

34 
	~"HTMLNames.h
"

35 
	~"R’d”Lay”.h
"

36 
	~"R’d”TabËC–l.h
"

37 
	~"R’d”TabËCŞ.h
"

38 
	~"R’d”TabËSeùiÚ.h
"

39 
	~"R’d”V›w.h
"

41 
usšg
 
Çme¥aû
 
	g¡d
;

43 
Çme¥aû
 
	gWebCÜe
 {

45 
usšg
 
Çme¥aû
 
	gHTMLNames
;

47 
	gR’d”TabË
::
R’d”TabË
(
Node
* 
node
)

48 : 
R’d”Block
(
node
)

49 , 
m_ÿ±iÚ
(0)

50 , 
m_h—d
(0)

51 , 
m_foÙ
(0)

52 , 
m_fœ¡Body
(0)

53 , 
m_cu¼’tBÜd”
(0)

54 , 
m_hasCŞEËm’ts
(
çl£
)

55 , 
m_ÃedsSeùiÚReÿlc
(0)

56 , 
m_hS·cšg
(0)

57 , 
m_vS·cšg
(0)

58 , 
m_bÜd”Leá
(0)

59 , 
m_bÜd”Right
(0)

61 
	gm_cŞumnPos
.
fl
(0, 2);

62 
	gm_cŞumns
.
fl
(
CŞumnSŒuù
(), 1);

65 
	gR’d”TabË
::
¡yËDidChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
)

67 
	gR’d”Block
::
¡yËDidChªge
(
diff
, 
ŞdStyË
);

69 
ETabËLayout
 
	gŞdTabËLayout
 = 
ŞdStyË
 ? oldStyË->
bËLayout
(è: 
TAUTO
;

72 
	gm_hS·cšg
 = 
cŞÏp£BÜd”s
(è? 0 : 
¡yË
()->
hÜizÚlBÜd”S·cšg
();

73 
	gm_vS·cšg
 = 
cŞÏp£BÜd”s
(è? 0 : 
¡yË
()->
v”tiÿlBÜd”S·cšg
();

74 
	gm_cŞumnPos
[0] = 
m_hS·cšg
;

76 ià(!
	gm_bËLayout
 || 
¡yË
()->
bËLayout
(è!ğ
ŞdTabËLayout
) {

79 ià(
¡yË
()->
bËLayout
(è=ğ
TFIXED
 && !¡yË()->
width
().
isAuto
())

80 
m_bËLayout
.
£t
(
Ãw
 
FixedTabËLayout
(
this
));

82 
	gm_bËLayout
.
£t
(
Ãw
 
AutoTabËLayout
(
this
));

86 
šlše
 
»£tSeùiÚPoš‹rIfNÙBefÜe
(
R’d”TabËSeùiÚ
*& 
±r
, 
R’d”Objeù
* 
befÜe
)

88 ià(!
	gbefÜe
 || !
	g±r
)

90 
R’d”Objeù
* 
	go
 = 
befÜe
->
´eviousSiblšg
();

91 
	go
 && o !ğ
±r
)

92 
o
 = o->
´eviousSiblšg
();

93 ià(!
	go
)

94 
	g±r
 = 0;

97 
	gR’d”TabË
::
addChd
(
R’d”Objeù
* 
chd
, R’d”Objeù* 
befÜeChd
)

100 ià(!
	gbefÜeChd
 && 
isAá”CÚ‹Á
(
Ï¡Chd
()))

101 
	gbefÜeChd
 = 
Ï¡Chd
();

103 
boŞ
 
	gw¿pInAnÚymousSeùiÚ
 = !
chd
->
isPos™iÚed
();

105 ià(
	gchd
->
isR’d”Block
(è&& chd->
¡yË
()->
di¥Ïy
(è=ğ
TABLE_CAPTION
) {

107 ià(
befÜeChd
 && 
m_ÿ±iÚ
) {

108 
R’d”Objeù
* 
o
 = 
befÜeChd
->
´eviousSiblšg
();

109 
	go
 && o !ğ
m_ÿ±iÚ
)

110 
o
 = o->
´eviousSiblšg
();

111 ià(!
	go
)

112 
	gm_ÿ±iÚ
 = 0;

114 ià(!
	gm_ÿ±iÚ
)

115 
	gm_ÿ±iÚ
 = 
toR’d”Block
(
chd
);

116 
	gw¿pInAnÚymousSeùiÚ
 = 
çl£
;

117 } ià(
	gchd
->
isTabËCŞ
()) {

118 
	gm_hasCŞEËm’ts
 = 
Œue
;

119 
	gw¿pInAnÚymousSeùiÚ
 = 
çl£
;

120 } ià(
	gchd
->
isTabËSeùiÚ
()) {

121 
	gchd
->
¡yË
()->
di¥Ïy
()) {

122 
	gTABLE_HEADER_GROUP
:

123 
»£tSeùiÚPoš‹rIfNÙBefÜe
(
m_h—d
, 
befÜeChd
);

124 ià(!
	gm_h—d
) {

125 
	gm_h—d
 = 
toR’d”TabËSeùiÚ
(
chd
);

127 
»£tSeùiÚPoš‹rIfNÙBefÜe
(
m_fœ¡Body
, 
befÜeChd
);

128 ià(!
	gm_fœ¡Body
)

129 
	gm_fœ¡Body
 = 
toR’d”TabËSeùiÚ
(
chd
);

131 
	gw¿pInAnÚymousSeùiÚ
 = 
çl£
;

133 
	gTABLE_FOOTER_GROUP
:

134 
»£tSeùiÚPoš‹rIfNÙBefÜe
(
m_foÙ
, 
befÜeChd
);

135 ià(!
	gm_foÙ
) {

136 
	gm_foÙ
 = 
toR’d”TabËSeùiÚ
(
chd
);

137 
	gw¿pInAnÚymousSeùiÚ
 = 
çl£
;

141 
	gTABLE_ROW_GROUP
:

142 
»£tSeùiÚPoš‹rIfNÙBefÜe
(
m_fœ¡Body
, 
befÜeChd
);

143 ià(!
	gm_fœ¡Body
)

144 
	gm_fœ¡Body
 = 
toR’d”TabËSeùiÚ
(
chd
);

145 
	gw¿pInAnÚymousSeùiÚ
 = 
çl£
;

148 
ASSERT_NOT_REACHED
();

150 } ià(
	gchd
->
isTabËC–l
(è|| chd->
isTabËRow
())

151 
	gw¿pInAnÚymousSeùiÚ
 = 
Œue
;

153 
	gw¿pInAnÚymousSeùiÚ
 = 
Œue
;

155 ià(!
	gw¿pInAnÚymousSeùiÚ
) {

157 
	gbefÜeChd
 && !befÜeChd->
isTabËSeùiÚ
(è&& !befÜeChd->
isTabËCŞ
(è&& befÜeChd->
¡yË
()->
di¥Ïy
(è!ğ
TABLE_CAPTION
)

158 
befÜeChd
 = befÜeChd->
·»Á
();

160 
	gR’d”Box
::
addChd
(
chd
, 
befÜeChd
);

164 ià(!
	gbefÜeChd
 && 
Ï¡Chd
(è&&†a¡Chd()->
isTabËSeùiÚ
(è&&†a¡Chd()->
isAnÚymous
()) {

165 
Ï¡Chd
()->
addChd
(
chd
);

169 
R’d”Objeù
* 
	gÏ¡Box
 = 
befÜeChd
;

170 
	gÏ¡Box
 &&†a¡Box->
·»Á
()->
isAnÚymous
(è&& !Ï¡Box->
isTabËSeùiÚ
(è&&†a¡Box->
¡yË
()->
di¥Ïy
(è!ğ
TABLE_CAPTION
 && 
Ï¡Box
->¡yË()->di¥Ïy(è!ğ
TABLE_COLUMN_GROUP
)

171 
Ï¡Box
 =†a¡Box->
·»Á
();

172 ià(
	gÏ¡Box
 &&†a¡Box->
isAnÚymous
(è&& !
isAá”CÚ‹Á
(
Ï¡Box
)) {

173 
	gÏ¡Box
->
addChd
(
chd
, 
befÜeChd
);

177 ià(
	gbefÜeChd
 && !befÜeChd->
isTabËSeùiÚ
(è&& befÜeChd->
¡yË
()->
di¥Ïy
(è!ğ
TABLE_CAPTION
 && 
befÜeChd
->¡yË()->di¥Ïy(è!ğ
TABLE_COLUMN_GROUP
)

178 
befÜeChd
 = 0;

179 
R’d”TabËSeùiÚ
* 
	g£ùiÚ
 = 
Ãw
 (
»nd”A»Ç
()èR’d”TabËSeùiÚ(
docum’t
() );

180 
	gRefPŒ
<
	gR’d”StyË
> 
	gÃwStyË
 = 
R’d”StyË
::
ü—‹
();

181 
	gÃwStyË
->
šh”™From
(
¡yË
());

182 
	gÃwStyË
->
£tDi¥Ïy
(
TABLE_ROW_GROUP
);

183 
	g£ùiÚ
->
£tStyË
(
ÃwStyË
.
»Ëa£
());

184 
addChd
(
£ùiÚ
, 
befÜeChd
);

185 
	g£ùiÚ
->
addChd
(
chd
);

188 
	gR’d”TabË
::
»moveChd
(
R’d”Objeù
* 
ŞdChd
)

190 
R’d”Box
::
»moveChd
(
ŞdChd
);

191 
£tN“dsSeùiÚReÿlc
();

194 
	gR’d”TabË
::
ÿlcWidth
()

196 ià(
isPos™iÚed
())

197 
ÿlcAbsŞu‹HÜizÚl
();

199 
R’d”Block
* 
	gcb
 = 
cÚššgBlock
();

200 
	gavaabËWidth
 = 
cb
->
avaabËWidth
();

202 
L’gthTy³
 
	gwidthTy³
 = 
¡yË
()->
width
().
ty³
();

203 ià(
	gwidthTy³
 > 
	gR–©ive
 && 
¡yË
()->
width
().
isPos™ive
()) {

205 
£tWidth
(
¡yË
()->
width
().
ÿlcMšV®ue
(
avaabËWidth
));

206 
£tWidth
(
max
(
mšP»fWidth
(), 
width
()));

210 
	gavaabËWidth
 = 
cb
->
lšeWidth
(
y
(), 
çl£
);

213 
	gm¬gšTÙ®
 = 0;

214 ià(!
¡yË
()->
m¬gšLeá
().
isAuto
())

215 
	gm¬gšTÙ®
 +ğ
¡yË
()->
m¬gšLeá
().
ÿlcV®ue
(
avaabËWidth
);

216 ià(!
¡yË
()->
m¬gšRight
().
isAuto
())

217 
	gm¬gšTÙ®
 +ğ
¡yË
()->
m¬gšRight
().
ÿlcV®ue
(
avaabËWidth
);

220 
	gavaCÚ‹ÁWidth
 = 
max
(0, 
avaabËWidth
 - 
m¬gšTÙ®
);

223 
£tWidth
(
mš
(
avaCÚ‹ÁWidth
, 
maxP»fWidth
()));

226 
£tWidth
(
max
(
width
(), 
mšP»fWidth
()));

229 
	gm_m¬gšRight
 = 0;

230 
	gm_m¬gšLeá
 = 0;

231 
ÿlcHÜizÚlM¬gšs
(
¡yË
()->
m¬gšLeá
(), styË()->
m¬gšRight
(), 
avaabËWidth
);

234 
	gR’d”TabË
::
Ïyout
()

236 
ASSERT
(
ÃedsLayout
());

238 ià(
ÏyoutOÆyPos™iÚedObjeùs
())

241 
»ÿlcSeùiÚsIfN“ded
();

243 
LayoutR•aš‹r
 
»·š‹r
(*
this
, 
checkFÜR•aštDuršgLayout
());

244 
LayoutS‹Mašš”
 
¡©ePush”
(
v›w
(), 
this
, 
IÁSize
(
x
(), 
y
()));

246 
£tHeight
(0);

247 
	gm_ov”æow
.
ş—r
();

249 
š™MaxM¬gšV®ues
();

251 
	gŞdWidth
 = 
width
();

252 
ÿlcWidth
();

254 ià(
	gm_ÿ±iÚ
 && 
width
(è!ğ
ŞdWidth
)

255 
m_ÿ±iÚ
->
£tN“dsLayout
(
Œue
, 
çl£
);

262 
	gm_bËLayout
->
Ïyout
();

264 
£tC–lWidths
();

267 
	gÿlcuÏ‹dHeight
 = 0;

268 
	gŞdTabËTİ
 = 
m_ÿ±iÚ
 ? m_ÿ±iÚ->
height
(è+ m_ÿ±iÚ->
m¬gšTİ
(è+ m_ÿ±iÚ->
m¬gšBÙtom
() : 0;

270 
boŞ
 
	gcŞÏpsšg
 = 
cŞÏp£BÜd”s
();

272 
R’d”Objeù
* 
	gchd
 = 
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
()) {

273 ià(
chd
->
isTabËSeùiÚ
()) {

274 
chd
->
ÏyoutIfN“ded
();

275 
R’d”TabËSeùiÚ
* 
	g£ùiÚ
 = 
toR’d”TabËSeùiÚ
(
chd
);

276 
	gÿlcuÏ‹dHeight
 +ğ
£ùiÚ
->
ÿlcRowHeight
();

277 ià(
	gcŞÏpsšg
)

278 
	g£ùiÚ
->
»ÿlcOu‹rBÜd”
();

279 
ASSERT
(!
£ùiÚ
->
ÃedsLayout
());

280 } ià(
	gchd
->
isTabËCŞ
()) {

281 
	gchd
->
ÏyoutIfN“ded
();

282 
ASSERT
(!
chd
->
ÃedsLayout
());

287 ià(
	gm_ÿ±iÚ
)

288 
	gm_ÿ±iÚ
->
ÏyoutIfN“ded
();

293 
boŞ
 
	g£ùiÚMoved
 = 
çl£
;

294 
	gmovedSeùiÚTİ
 = 0;

297 ià(
	gm_ÿ±iÚ
 && m_ÿ±iÚ->
¡yË
()->
ÿ±iÚSide
(è!ğ
CAPBOTTOM
) {

298 
IÁReù
 
ÿ±iÚReù
(
m_ÿ±iÚ
->
x
(), m_ÿ±iÚ->
y
(), m_ÿ±iÚ->
width
(), m_ÿ±iÚ->
height
());

300 
	gm_ÿ±iÚ
->
£tLoÿtiÚ
(
m_ÿ±iÚ
->
m¬gšLeá
(), 
height
());

301 ià(!
£lfN“dsLayout
(è&& 
	gm_ÿ±iÚ
->
checkFÜR•aštDuršgLayout
())

302 
	gm_ÿ±iÚ
->
»·štDuršgLayoutIfMoved
(
ÿ±iÚReù
);

304 
£tHeight
(
height
(è+ 
m_ÿ±iÚ
->height(è+ m_ÿ±iÚ->
m¬gšTİ
(è+ m_ÿ±iÚ->
m¬gšBÙtom
());

306 ià(
height
(è!ğ
ŞdTabËTİ
) {

307 
£ùiÚMoved
 = 
Œue
;

308 
	gmovedSeùiÚTİ
 = 
mš
(
height
(), 
ŞdTabËTİ
);

312 
	gbpTİ
 = 
bÜd”Tİ
(è+ (
cŞÏpsšg
 ? 0 : 
·ddšgTİ
());

313 
	gbpBÙtom
 = 
bÜd”BÙtom
(è+ (
cŞÏpsšg
 ? 0 : 
·ddšgBÙtom
());

315 
£tHeight
(
height
(è+ 
bpTİ
);

317 ià(!
isPos™iÚed
())

318 
ÿlcHeight
();

320 
L’gth
 
	gh
 = 
¡yË
()->
height
();

321 
	gth
 = 0;

322 ià(
	gh
.
isFixed
())

324 
	gth
 = 
h
.
v®ue
(è- (
bpTİ
 + 
bpBÙtom
);

325 ià(
	gh
.
isP”ûÁ
())

326 
	gth
 = 
ÿlcP”ûÁageHeight
(
h
);

327 
	gth
 = 
max
(0, 
th
);

329 
R’d”Objeù
* 
	gchd
 = 
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
()) {

330 ià(
chd
->
isTabËSeùiÚ
())

332 
toR’d”TabËSeùiÚ
(
chd
)->
ÏyoutRows
(chd =ğ
m_fœ¡Body
 ? 
max
(0, 
th
 - 
ÿlcuÏ‹dHeight
) : 0);

335 ià(!
	gm_fœ¡Body
 && 
	gth
 > 
	gÿlcuÏ‹dHeight
 && !
¡yË
()->
htmlHacks
()) {

338 
£tHeight
(
height
(è+ 
th
);

341 
	gbl
 = 
bÜd”Leá
();

342 ià(!
	gcŞÏpsšg
)

343 
	gbl
 +ğ
·ddšgLeá
();

346 
R’d”TabËSeùiÚ
* 
	g£ùiÚ
 = 
m_h—d
 ? m_h—d : (
m_fœ¡Body
 ? m_fœ¡Body : 
m_foÙ
);

347 
	g£ùiÚ
) {

348 ià(!
	g£ùiÚMoved
 && 
	g£ùiÚ
->
y
(è!ğ
height
()) {

349 
£ùiÚMoved
 = 
Œue
;

350 
	gmovedSeùiÚTİ
 = 
mš
(
height
(), 
£ùiÚ
->
y
()è+ 
	g£ùiÚ
->
tİVisibËOv”æow
();

352 
	g£ùiÚ
->
£tLoÿtiÚ
(
bl
, 
height
());

354 
£tHeight
(
height
(è+ 
£ùiÚ
->height());

355 
	g£ùiÚ
 = 
£ùiÚB–ow
(
£ùiÚ
);

358 
£tHeight
(
height
(è+ 
bpBÙtom
);

360 ià(
	gm_ÿ±iÚ
 && m_ÿ±iÚ->
¡yË
()->
ÿ±iÚSide
(è=ğ
CAPBOTTOM
) {

361 
IÁReù
 
ÿ±iÚReù
(
m_ÿ±iÚ
->
x
(), m_ÿ±iÚ->
y
(), m_ÿ±iÚ->
width
(), m_ÿ±iÚ->
height
());

363 
	gm_ÿ±iÚ
->
£tLoÿtiÚ
(
m_ÿ±iÚ
->
m¬gšLeá
(), 
height
());

364 ià(!
£lfN“dsLayout
(è&& 
	gm_ÿ±iÚ
->
checkFÜR•aštDuršgLayout
())

365 
	gm_ÿ±iÚ
->
»·štDuršgLayoutIfMoved
(
ÿ±iÚReù
);

367 
£tHeight
(
height
(è+ 
m_ÿ±iÚ
->height(è+ m_ÿ±iÚ->
m¬gšTİ
(è+ m_ÿ±iÚ->
m¬gšBÙtom
());

370 ià(
isPos™iÚed
())

371 
ÿlcHeight
();

375 
ÏyoutPos™iÚedObjeùs
(
Œue
);

378 
	grightBÜd”Ov”æow
 = 
width
(è+ (
cŞÏpsšg
 ? 
ou‹rBÜd”Right
(è- 
bÜd”Right
() : 0);

379 
	gËáBÜd”Ov”æow
 = 
cŞÏpsšg
 ? 
bÜd”Leá
(è- 
ou‹rBÜd”Leá
() : 0;

380 
	gbÙtomBÜd”Ov”æow
 = 
height
(è+ (
cŞÏpsšg
 ? 
ou‹rBÜd”BÙtom
(è- 
bÜd”BÙtom
() : 0);

381 
	gtİBÜd”Ov”æow
 = 
cŞÏpsšg
 ? 
bÜd”Tİ
(è- 
ou‹rBÜd”Tİ
() : 0;

382 
addLayoutOv”æow
(
IÁReù
(
ËáBÜd”Ov”æow
, 
tİBÜd”Ov”æow
, 
rightBÜd”Ov”æow
 -†eáBÜd”Ov”æow, 
bÙtomBÜd”Ov”æow
 -opBorderOverflow));

385 
addShadowOv”æow
();

388 ià(
	gm_ÿ±iÚ
)

389 
addOv”æowFromChd
(
m_ÿ±iÚ
);

392 
R’d”Objeù
* 
	gchd
 = 
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
()) {

393 ià(
chd
->
isTabËSeùiÚ
()) {

394 
R’d”TabËSeùiÚ
* 
£ùiÚ
 = 
toR’d”TabËSeùiÚ
(
chd
);

395 
addOv”æowFromChd
(
£ùiÚ
);

399 
	g¡©ePush”
.
pİ
();

401 
boŞ
 
	gdidFuÎR•ašt
 = 
»·š‹r
.
»·štAá”Layout
();

403 ià(!
	gdidFuÎR•ašt
 && 
	g£ùiÚMoved
)

404 
»·štReùªgË
(
IÁReù
(
ËáVisibËOv”æow
(), 
movedSeùiÚTİ
, 
rightVisibËOv”æow
(è-†eáVisibËOv”æow(), 
bÙtomVisibËOv”æow
() - movedSectionTop));

406 
£tN“dsLayout
(
çl£
);

409 
	gR’d”TabË
::
£tC–lWidths
()

411 
R’d”Objeù
* 
chd
 = 
fœ¡Chd
(); 
	gchd
; chd = chd->
ÃxtSiblšg
()) {

412 ià(
chd
->
isTabËSeùiÚ
())

413 
toR’d”TabËSeùiÚ
(
chd
)->
£tC–lWidths
();

417 
	gR’d”TabË
::
·št
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

419 
	gtx
 +ğ
x
();

420 
	gty
 +ğ
y
();

422 
PaštPha£
 
	g·štPha£
 = 
·štInfo
.
pha£
;

424 
	gos
 = 2 * 
maxim®OušeSize
(
·štPha£
);

425 ià(
	gty
 + 
tİVisibËOv”æow
(è>ğ
·štInfo
.
»ù
.
bÙtom
(è+ 
os
 || 
ty
 + 
bÙtomVisibËOv”æow
(è<ğ·štInfo.»ù.
y
() - os)

427 ià(
	gtx
 + 
ËáVisibËOv”æow
(è>ğ
·štInfo
.
»ù
.
right
(è+ 
os
 || 
tx
 + 
rightVisibËOv”æow
(è<ğ·štInfo.»ù.
x
() - os)

430 
boŞ
 
	gpushedCl
 = 
pushCÚ‹ÁsCl
(
·štInfo
, 
tx
, 
ty
);

431 
·štObjeù
(
·štInfo
, 
tx
, 
ty
);

432 ià(
	gpushedCl
)

433 
pİCÚ‹ÁsCl
(
·štInfo
, 
·štPha£
, 
tx
, 
ty
);

436 
	gR’d”TabË
::
·štObjeù
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

438 
PaštPha£
 
	g·štPha£
 = 
·štInfo
.
pha£
;

439 ià((
	g·štPha£
 =ğ
PaštPha£BlockBackground
 || 
·štPha£
 =ğ
PaštPha£ChdBlockBackground
è&& 
hasBoxDecÜ©iÚs
(è&& 
¡yË
()->
visib™y
(è=ğ
VISIBLE
)

440 
·štBoxDecÜ©iÚs
(
·štInfo
, 
tx
, 
ty
);

442 ià(
	g·štPha£
 =ğ
PaštPha£Mask
) {

443 
·štMask
(
·štInfo
, 
tx
, 
ty
);

448 ià(
	g·štPha£
 =ğ
PaštPha£BlockBackground
)

452 ià(
	g·štPha£
 =ğ
PaštPha£ChdBlockBackgrounds
)

453 
·štPha£
 = 
PaštPha£ChdBlockBackground
;

455 
PaštInfo
 
šfo
(
·štInfo
);

456 
	gšfo
.
	gpha£
 = 
·štPha£
;

457 
	gšfo
.
	g·štšgRoÙ
 = 
·štšgRoÙFÜChd»n
(
·štInfo
);

459 
R’d”Objeù
* 
	gchd
 = 
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
()) {

460 ià(
chd
->
isBox
(è&& !
toR’d”Box
(chd)->
hasS–fPaštšgLay”
(è&& (chd->
isTabËSeùiÚ
(è|| chd =ğ
m_ÿ±iÚ
))

461 
chd
->
·št
(
šfo
, 
tx
, 
ty
);

464 ià(
cŞÏp£BÜd”s
(è&& 
	g·štPha£
 =ğ
PaštPha£ChdBlockBackground
 && 
¡yË
()->
visib™y
(è=ğ
VISIBLE
) {

468 
šfo
.
pha£
 = 
PaštPha£CŞÏp£dTabËBÜd”s
;

469 
	gR’d”TabËC–l
::
CŞÏp£dBÜd”StyËs
 
bÜd”StyËs
;

470 
R’d”Objeù
* 
	g¡İ
 = 
ÃxtInP»Ord”Aá”Chd»n
();

471 
R’d”Objeù
* 
	go
 = 
fœ¡Chd
(); o && o !ğ
¡İ
; o = 
o
->
ÃxtInP»Ord”
())

472 ià(
o
->
isTabËC–l
())

473 
toR’d”TabËC–l
(
o
)->
cŞËùBÜd”StyËs
(
bÜd”StyËs
);

474 
	gR’d”TabËC–l
::
sÜtBÜd”StyËs
(
bÜd”StyËs
);

475 
size_t
 
	gcouÁ
 = 
bÜd”StyËs
.
size
();

476 
size_t
 
	gi
 = 0; i < 
	gcouÁ
; ++i) {

477 
	gm_cu¼’tBÜd”
 = &
bÜd”StyËs
[
i
];

478 
R’d”Objeù
* 
	gchd
 = 
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
())

479 ià(
chd
->
isTabËSeùiÚ
())

480 
chd
->
·št
(
šfo
, 
tx
, 
ty
);

482 
	gm_cu¼’tBÜd”
 = 0;

486 
	gR’d”TabË
::
·štBoxDecÜ©iÚs
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

488 ià(!
shouldPaštW™hšRoÙ
(
·štInfo
))

491 
	gw
 = 
width
();

492 
	gh
 = 
height
();

495 ià(
	gm_ÿ±iÚ
) {

496 
	gÿ±iÚHeight
 = (
m_ÿ±iÚ
->
height
(è+ m_ÿ±iÚ->
m¬gšBÙtom
(è+ m_ÿ±iÚ->
m¬gšTİ
());

497 
	gh
 -ğ
ÿ±iÚHeight
;

498 ià(
	gm_ÿ±iÚ
->
¡yË
()->
ÿ±iÚSide
(è!ğ
CAPBOTTOM
)

499 
ty
 +ğ
ÿ±iÚHeight
;

502 
·štBoxShadow
(
·štInfo
.
cÚ‹xt
, 
tx
, 
ty
, 
w
, 
h
, 
¡yË
(), 
NÜm®
);

504 
·štFlLay”s
(
·štInfo
, 
¡yË
()->
backgroundCŞÜ
(), styË()->
backgroundLay”s
(), 
tx
, 
ty
, 
w
, 
h
);

505 
·štBoxShadow
(
·štInfo
.
cÚ‹xt
, 
tx
, 
ty
, 
w
, 
h
, 
¡yË
(), 
In£t
);

507 ià(
¡yË
()->
hasBÜd”
(è&& !
cŞÏp£BÜd”s
())

508 
·štBÜd”
(
·štInfo
.
cÚ‹xt
, 
tx
, 
ty
, 
w
, 
h
, 
¡yË
());

511 
	gR’d”TabË
::
·štMask
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

513 ià(
¡yË
()->
visib™y
(è!ğ
VISIBLE
 || 
·štInfo
.
pha£
 !ğ
PaštPha£Mask
)

516 
	gw
 = 
width
();

517 
	gh
 = 
height
();

520 ià(
	gm_ÿ±iÚ
) {

521 
	gÿ±iÚHeight
 = (
m_ÿ±iÚ
->
height
(è+ m_ÿ±iÚ->
m¬gšBÙtom
(è+ m_ÿ±iÚ->
m¬gšTİ
());

522 
	gh
 -ğ
ÿ±iÚHeight
;

523 ià(
	gm_ÿ±iÚ
->
¡yË
()->
ÿ±iÚSide
(è!ğ
CAPBOTTOM
)

524 
ty
 +ğ
ÿ±iÚHeight
;

527 
·štMaskImages
(
·štInfo
, 
tx
, 
ty
, 
w
, 
h
);

530 
	gR’d”TabË
::
ÿlcP»fWidths
()

532 
ASSERT
(
´efWidthsDœty
());

534 
»ÿlcSeùiÚsIfN“ded
();

535 
»ÿlcHÜizÚlBÜd”s
();

537 
	gm_bËLayout
->
ÿlcP»fWidths
(
m_mšP»fWidth
, 
m_maxP»fWidth
);

539 ià(
	gm_ÿ±iÚ
)

540 
	gm_mšP»fWidth
 = 
max
(
m_mšP»fWidth
, 
m_ÿ±iÚ
->
mšP»fWidth
());

542 
£tP»fWidthsDœty
(
çl£
);

545 
	gR’d”TabË
::
¥l™CŞumn
(
pos
, 
fœ¡S·n
)

548 
	gŞdSize
 = 
m_cŞumns
.
size
();

549 
	gm_cŞumns
.
grow
(
ŞdSize
 + 1);

550 
	gŞdS·n
 = 
m_cŞumns
[
pos
].
¥ª
;

551 
ASSERT
(
ŞdS·n
 > 
fœ¡S·n
);

552 
	gm_cŞumns
[
pos
].
	g¥ª
 = 
fœ¡S·n
;

553 
memmove
(
m_cŞumns
.
d©a
(è+ 
pos
 + 1, m_cŞumns.d©a(è+…os, (
ŞdSize
 -…osè* (
CŞumnSŒuù
));

554 
	gm_cŞumns
[
pos
 + 1].
	g¥ª
 = 
ŞdS·n
 - 
fœ¡S·n
;

557 
R’d”Objeù
* 
	gchd
 = 
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
()) {

558 ià(
chd
->
isTabËSeùiÚ
())

559 
toR’d”TabËSeùiÚ
(
chd
)->
¥l™CŞumn
(
pos
, 
ŞdSize
 + 1);

562 
	gm_cŞumnPos
.
grow
(
numEffCŞs
() + 1);

563 
£tN“dsLayoutAndP»fWidthsReÿlc
();

566 
	gR’d”TabË
::
­³ndCŞumn
(
¥ª
)

569 
pos
 = 
m_cŞumns
.
size
();

570 
	gÃwSize
 = 
pos
 + 1;

571 
	gm_cŞumns
.
grow
(
ÃwSize
);

572 
	gm_cŞumns
[
pos
].
	g¥ª
 = 
¥ª
;

575 
R’d”Objeù
* 
	gchd
 = 
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
()) {

576 ià(
chd
->
isTabËSeùiÚ
())

577 
toR’d”TabËSeùiÚ
(
chd
)->
­³ndCŞumn
(
pos
);

580 
	gm_cŞumnPos
.
grow
(
numEffCŞs
() + 1);

581 
£tN“dsLayoutAndP»fWidthsReÿlc
();

584 
R’d”TabËCŞ
* 
	gR’d”TabË
::
ÃxtCŞEËm’t
(R’d”TabËCŞ* 
cu¼’t
) const

586 
R’d”Objeù
* 
Ãxt
 = 
cu¼’t
->
fœ¡Chd
();

587 ià(!
	gÃxt
)

588 
	gÃxt
 = 
cu¼’t
->
ÃxtSiblšg
();

589 ià(!
	gÃxt
 && 
	gcu¼’t
->
·»Á
()->
isTabËCŞ
())

590 
	gÃxt
 = 
cu¼’t
->
·»Á
()->
ÃxtSiblšg
();

592 
	gÃxt
) {

593 ià(
	gÃxt
->
isTabËCŞ
())

594  
toR’d”TabËCŞ
(
Ãxt
);

595 ià(
	gÃxt
 !ğ
m_ÿ±iÚ
)

597 
	gÃxt
 = 
Ãxt
->
ÃxtSiblšg
();

603 
R’d”TabËCŞ
* 
	gR’d”TabË
::
cŞEËm’t
(
cŞ
, 
boŞ
* 
¡¬tEdge
, boŞ* 
’dEdge
) const

605 ià(!
	gm_hasCŞEËm’ts
)

607 
R’d”Objeù
* 
	gchd
 = 
fœ¡Chd
();

608 
	gcCŞ
 = 0;

610 
	gchd
) {

611 ià(
	gchd
->
isTabËCŞ
())

613 ià(
	gchd
 !ğ
m_ÿ±iÚ
)

615 
	gchd
 = 
chd
->
ÃxtSiblšg
();

617 ià(!
	gchd
)

620 
R’d”TabËCŞ
* 
	gcŞEËm
 = 
toR’d”TabËCŞ
(
chd
);

621 
	gcŞEËm
) {

622 
	g¥ª
 = 
cŞEËm
->
¥ª
();

623 ià(!
	gcŞEËm
->
fœ¡Chd
()) {

624 
	g¡¬tCŞ
 = 
cCŞ
;

625 
	g’dCŞ
 = 
cCŞ
 + 
¥ª
 - 1;

626 
	gcCŞ
 +ğ
¥ª
;

627 ià(
	gcCŞ
 > 
	gcŞ
) {

628 ià(
	g¡¬tEdge
)

629 *
	g¡¬tEdge
 = 
¡¬tCŞ
 =ğ
cŞ
;

630 ià(
	g’dEdge
)

631 *
	g’dEdge
 = 
’dCŞ
 =ğ
cŞ
;

632  
	gcŞEËm
;

635 
	gcŞEËm
 = 
ÃxtCŞEËm’t
(
cŞEËm
);

641 
	gR’d”TabË
::
»ÿlcSeùiÚs
() const

643 
m_ÿ±iÚ
 = 0;

644 
	gm_h—d
 = 0;

645 
	gm_foÙ
 = 0;

646 
	gm_fœ¡Body
 = 0;

647 
	gm_hasCŞEËm’ts
 = 
çl£
;

650 
R’d”Objeù
* 
	gchd
 = 
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
()) {

651 
chd
->
¡yË
()->
di¥Ïy
()) {

652 
TABLE_CAPTION
:

653 ià(!
m_ÿ±iÚ
 && 
chd
->
isR’d”Block
()) {

654 
m_ÿ±iÚ
 = 
toR’d”Block
(
chd
);

655 
	gm_ÿ±iÚ
->
£tN“dsLayout
(
Œue
);

658 
	gTABLE_COLUMN
:

659 
TABLE_COLUMN_GROUP
:

660 
m_hasCŞEËm’ts
 = 
Œue
;

662 
	gTABLE_HEADER_GROUP
:

663 ià(
chd
->
isTabËSeùiÚ
()) {

664 
R’d”TabËSeùiÚ
* 
£ùiÚ
 = 
toR’d”TabËSeùiÚ
(
chd
);

665 ià(!
	gm_h—d
)

666 
	gm_h—d
 = 
£ùiÚ
;

667 ià(!
	gm_fœ¡Body
)

668 
	gm_fœ¡Body
 = 
£ùiÚ
;

669 
	g£ùiÚ
->
»ÿlcC–lsIfN“ded
();

672 
	gTABLE_FOOTER_GROUP
:

673 ià(
chd
->
isTabËSeùiÚ
()) {

674 
R’d”TabËSeùiÚ
* 
£ùiÚ
 = 
toR’d”TabËSeùiÚ
(
chd
);

675 ià(!
	gm_foÙ
)

676 
	gm_foÙ
 = 
£ùiÚ
;

677 ià(!
	gm_fœ¡Body
)

678 
	gm_fœ¡Body
 = 
£ùiÚ
;

679 
	g£ùiÚ
->
»ÿlcC–lsIfN“ded
();

682 
	gTABLE_ROW_GROUP
:

683 ià(
chd
->
isTabËSeùiÚ
()) {

684 
R’d”TabËSeùiÚ
* 
£ùiÚ
 = 
toR’d”TabËSeùiÚ
(
chd
);

685 ià(!
	gm_fœ¡Body
)

686 
	gm_fœ¡Body
 = 
£ùiÚ
;

687 
	g£ùiÚ
->
»ÿlcC–lsIfN“ded
();

696 
	gmaxCŞs
 = 0;

697 
R’d”Objeù
* 
	gchd
 = 
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
()) {

698 ià(
chd
->
isTabËSeùiÚ
()) {

699 
R’d”TabËSeùiÚ
* 
£ùiÚ
 = 
toR’d”TabËSeùiÚ
(
chd
);

700 
	g£ùiÚCŞs
 = 
£ùiÚ
->
numCŞumns
();

701 ià(
	g£ùiÚCŞs
 > 
	gmaxCŞs
)

702 
	gmaxCŞs
 = 
£ùiÚCŞs
;

706 
	gm_cŞumns
.
»size
(
maxCŞs
);

707 
	gm_cŞumnPos
.
»size
(
maxCŞs
 + 1);

709 
ASSERT
(
£lfN“dsLayout
());

711 
	gm_ÃedsSeùiÚReÿlc
 = 
çl£
;

714 
	gR’d”TabË
::
ÿlcBÜd”Leá
() const

716 ià(
cŞÏp£BÜd”s
()) {

718 ià(!
numEffCŞs
())

721 
	gbÜd”Width
 = 0;

723 cÚ¡ 
	gBÜd”V®ue
& 
	gtb
 = 
¡yË
()->
bÜd”Leá
();

724 ià(
	gtb
.
¡yË
(è=ğ
BHIDDEN
)

726 ià(
	gtb
.
¡yË
(è> 
	gBHIDDEN
)

727 
	gbÜd”Width
 = 
tb
.
width
();

729 
	gËámo¡CŞumn
 = 
¡yË
()->
dœeùiÚ
(è=ğ
RTL
 ? 
numEffCŞs
() - 1 : 0;

730 
R’d”TabËCŞ
* 
	gcŞGroup
 = 
cŞEËm’t
(
Ëámo¡CŞumn
);

731 ià(
	gcŞGroup
) {

732 cÚ¡ 
	gBÜd”V®ue
& 
	ggb
 = 
¡yË
()->
bÜd”Leá
();

733 ià(
	ggb
.
¡yË
(è=ğ
BHIDDEN
)

735 ià(
	ggb
.
¡yË
(è> 
	gBHIDDEN
)

736 
	gbÜd”Width
 = 
max
(
bÜd”Width
, 
¡©ic_ÿ¡
<>(
gb
.
width
()));

739 
R’d”TabËSeùiÚ
* 
	gfœ¡NÚEm±ySeùiÚ
 = 
m_h—d
 ? m_h—d : (
m_fœ¡Body
 ? m_fœ¡Body : 
m_foÙ
);

740 ià(
	gfœ¡NÚEm±ySeùiÚ
 && !fœ¡NÚEm±ySeùiÚ->
numRows
())

741 
	gfœ¡NÚEm±ySeùiÚ
 = 
£ùiÚB–ow
(
fœ¡NÚEm±ySeùiÚ
, 
Œue
);

743 ià(
	gfœ¡NÚEm±ySeùiÚ
) {

744 cÚ¡ 
	gBÜd”V®ue
& 
	gsb
 = 
fœ¡NÚEm±ySeùiÚ
->
¡yË
()->
bÜd”Leá
();

745 ià(
	gsb
.
¡yË
(è=ğ
BHIDDEN
)

748 ià(
	gsb
.
¡yË
(è> 
	gBHIDDEN
)

749 
	gbÜd”Width
 = 
max
(
bÜd”Width
, 
¡©ic_ÿ¡
<>(
sb
.
width
()));

751 cÚ¡ 
	gR’d”TabËSeùiÚ
::
C–lSŒuù
& 
cs
 = 
fœ¡NÚEm±ySeùiÚ
->
ûÎAt
(0, 
Ëámo¡CŞumn
);

753 ià(
	gcs
.
	gûÎ
) {

754 cÚ¡ 
	gBÜd”V®ue
& 
	gcb
 = 
cs
.
ûÎ
->
¡yË
()->
bÜd”Leá
();

755 ià(
	gcb
.
¡yË
(è=ğ
BHIDDEN
)

758 cÚ¡ 
	gBÜd”V®ue
& 
	grb
 = 
cs
.
ûÎ
->
·»Á
()->
¡yË
()->
bÜd”Leá
();

759 ià(
	grb
.
¡yË
(è=ğ
BHIDDEN
)

762 ià(
	gcb
.
¡yË
(è> 
	gBHIDDEN
)

763 
	gbÜd”Width
 = 
max
(
bÜd”Width
, 
¡©ic_ÿ¡
<>(
cb
.
width
()));

764 ià(
	grb
.
¡yË
(è> 
	gBHIDDEN
)

765 
	gbÜd”Width
 = 
max
(
bÜd”Width
, 
¡©ic_ÿ¡
<>(
rb
.
width
()));

768  
	gbÜd”Width
 / 2;

770  
	gR’d”Block
::
bÜd”Leá
();

773 
	gR’d”TabË
::
ÿlcBÜd”Right
() const

775 ià(
cŞÏp£BÜd”s
()) {

777 ià(!
numEffCŞs
())

780 
	gbÜd”Width
 = 0;

782 cÚ¡ 
	gBÜd”V®ue
& 
	gtb
 = 
¡yË
()->
bÜd”Right
();

783 ià(
	gtb
.
¡yË
(è=ğ
BHIDDEN
)

785 ià(
	gtb
.
¡yË
(è> 
	gBHIDDEN
)

786 
	gbÜd”Width
 = 
tb
.
width
();

788 
	grightmo¡CŞumn
 = 
¡yË
()->
dœeùiÚ
(è=ğ
RTL
 ? 0 : 
numEffCŞs
() - 1;

789 
R’d”TabËCŞ
* 
	gcŞGroup
 = 
cŞEËm’t
(
rightmo¡CŞumn
);

790 ià(
	gcŞGroup
) {

791 cÚ¡ 
	gBÜd”V®ue
& 
	ggb
 = 
¡yË
()->
bÜd”Right
();

792 ià(
	ggb
.
¡yË
(è=ğ
BHIDDEN
)

794 ià(
	ggb
.
¡yË
(è> 
	gBHIDDEN
)

795 
	gbÜd”Width
 = 
max
(
bÜd”Width
, 
¡©ic_ÿ¡
<>(
gb
.
width
()));

798 
R’d”TabËSeùiÚ
* 
	gfœ¡NÚEm±ySeùiÚ
 = 
m_h—d
 ? m_h—d : (
m_fœ¡Body
 ? m_fœ¡Body : 
m_foÙ
);

799 ià(
	gfœ¡NÚEm±ySeùiÚ
 && !fœ¡NÚEm±ySeùiÚ->
numRows
())

800 
	gfœ¡NÚEm±ySeùiÚ
 = 
£ùiÚB–ow
(
fœ¡NÚEm±ySeùiÚ
, 
Œue
);

802 ià(
	gfœ¡NÚEm±ySeùiÚ
) {

803 cÚ¡ 
	gBÜd”V®ue
& 
	gsb
 = 
fœ¡NÚEm±ySeùiÚ
->
¡yË
()->
bÜd”Right
();

804 ià(
	gsb
.
¡yË
(è=ğ
BHIDDEN
)

807 ià(
	gsb
.
¡yË
(è> 
	gBHIDDEN
)

808 
	gbÜd”Width
 = 
max
(
bÜd”Width
, 
¡©ic_ÿ¡
<>(
sb
.
width
()));

810 cÚ¡ 
	gR’d”TabËSeùiÚ
::
C–lSŒuù
& 
cs
 = 
fœ¡NÚEm±ySeùiÚ
->
ûÎAt
(0, 
rightmo¡CŞumn
);

812 ià(
	gcs
.
	gûÎ
) {

813 cÚ¡ 
	gBÜd”V®ue
& 
	gcb
 = 
cs
.
ûÎ
->
¡yË
()->
bÜd”Right
();

814 ià(
	gcb
.
¡yË
(è=ğ
BHIDDEN
)

817 cÚ¡ 
	gBÜd”V®ue
& 
	grb
 = 
cs
.
ûÎ
->
·»Á
()->
¡yË
()->
bÜd”Right
();

818 ià(
	grb
.
¡yË
(è=ğ
BHIDDEN
)

821 ià(
	gcb
.
¡yË
(è> 
	gBHIDDEN
)

822 
	gbÜd”Width
 = 
max
(
bÜd”Width
, 
¡©ic_ÿ¡
<>(
cb
.
width
()));

823 ià(
	grb
.
¡yË
(è> 
	gBHIDDEN
)

824 
	gbÜd”Width
 = 
max
(
bÜd”Width
, 
¡©ic_ÿ¡
<>(
rb
.
width
()));

827  (
	gbÜd”Width
 + 1) / 2;

829  
	gR’d”Block
::
bÜd”Right
();

832 
	gR’d”TabË
::
»ÿlcHÜizÚlBÜd”s
()

834 
m_bÜd”Leá
 = 
ÿlcBÜd”Leá
();

835 
	gm_bÜd”Right
 = 
ÿlcBÜd”Right
();

838 
	gR’d”TabË
::
bÜd”Tİ
() const

840 ià(
cŞÏp£BÜd”s
())

841  
ou‹rBÜd”Tİ
();

842  
	gR’d”Block
::
bÜd”Tİ
();

845 
	gR’d”TabË
::
bÜd”BÙtom
() const

847 ià(
cŞÏp£BÜd”s
())

848  
ou‹rBÜd”BÙtom
();

849  
	gR’d”Block
::
bÜd”BÙtom
();

852 
	gR’d”TabË
::
ou‹rBÜd”Tİ
() const

854 ià(!
cŞÏp£BÜd”s
())

856 
	gbÜd”Width
 = 0;

857 
R’d”TabËSeùiÚ
* 
	gtİSeùiÚ
;

858 ià(
	gm_h—d
)

859 
	gtİSeùiÚ
 = 
m_h—d
;

860 ià(
	gm_fœ¡Body
)

861 
	gtİSeùiÚ
 = 
m_fœ¡Body
;

862 ià(
	gm_foÙ
)

863 
	gtİSeùiÚ
 = 
m_foÙ
;

865 
	gtİSeùiÚ
 = 0;

866 ià(
	gtİSeùiÚ
) {

867 
	gbÜd”Width
 = 
tİSeùiÚ
->
ou‹rBÜd”Tİ
();

868 ià(
	gbÜd”Width
 == -1)

871 cÚ¡ 
	gBÜd”V®ue
& 
	gtb
 = 
¡yË
()->
bÜd”Tİ
();

872 ià(
	gtb
.
¡yË
(è=ğ
BHIDDEN
)

874 ià(
	gtb
.
¡yË
(è> 
	gBHIDDEN
)

875 
	gbÜd”Width
 = 
max
(
bÜd”Width
, 
¡©ic_ÿ¡
<>(
tb
.
width
() / 2));

876  
	gbÜd”Width
;

879 
	gR’d”TabË
::
ou‹rBÜd”BÙtom
() const

881 ià(!
cŞÏp£BÜd”s
())

883 
	gbÜd”Width
 = 0;

884 
R’d”TabËSeùiÚ
* 
	gbÙtomSeùiÚ
;

885 ià(
	gm_foÙ
)

886 
	gbÙtomSeùiÚ
 = 
m_foÙ
;

888 
R’d”Objeù
* 
	gchd
;

889 
	gchd
 = 
Ï¡Chd
(); chd && !chd->
isTabËSeùiÚ
(); chd = 
chd
->
´eviousSiblšg
()) { }

890 
bÙtomSeùiÚ
 = 
chd
 ? 
toR’d”TabËSeùiÚ
(child) : 0;

892 ià(
	gbÙtomSeùiÚ
) {

893 
	gbÜd”Width
 = 
bÙtomSeùiÚ
->
ou‹rBÜd”BÙtom
();

894 ià(
	gbÜd”Width
 == -1)

897 cÚ¡ 
	gBÜd”V®ue
& 
	gtb
 = 
¡yË
()->
bÜd”BÙtom
();

898 ià(
	gtb
.
¡yË
(è=ğ
BHIDDEN
)

900 ià(
	gtb
.
¡yË
(è> 
	gBHIDDEN
)

901 
	gbÜd”Width
 = 
max
(
bÜd”Width
, 
¡©ic_ÿ¡
<>((
tb
.
width
() + 1) / 2));

902  
	gbÜd”Width
;

905 
	gR’d”TabË
::
ou‹rBÜd”Leá
() const

907 ià(!
cŞÏp£BÜd”s
())

910 
	gbÜd”Width
 = 0;

912 cÚ¡ 
	gBÜd”V®ue
& 
	gtb
 = 
¡yË
()->
bÜd”Leá
();

913 ià(
	gtb
.
¡yË
(è=ğ
BHIDDEN
)

915 ià(
	gtb
.
¡yË
(è> 
	gBHIDDEN
)

916 
	gbÜd”Width
 = 
tb
.
width
() / 2;

918 
boŞ
 
	g®lHidd’
 = 
Œue
;

919 
R’d”Objeù
* 
	gchd
 = 
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
()) {

920 ià(!
chd
->
isTabËSeùiÚ
())

922 
	gsw
 = 
toR’d”TabËSeùiÚ
(
chd
)->
ou‹rBÜd”Leá
();

923 ià(
	gsw
 == -1)

926 
	g®lHidd’
 = 
çl£
;

927 
	gbÜd”Width
 = 
max
(
bÜd”Width
, 
sw
);

929 ià(
	g®lHidd’
)

932  
	gbÜd”Width
;

935 
	gR’d”TabË
::
ou‹rBÜd”Right
() const

937 ià(!
cŞÏp£BÜd”s
())

940 
	gbÜd”Width
 = 0;

942 cÚ¡ 
	gBÜd”V®ue
& 
	gtb
 = 
¡yË
()->
bÜd”Right
();

943 ià(
	gtb
.
¡yË
(è=ğ
BHIDDEN
)

945 ià(
	gtb
.
¡yË
(è> 
	gBHIDDEN
)

946 
	gbÜd”Width
 = (
tb
.
width
() + 1) / 2;

948 
boŞ
 
	g®lHidd’
 = 
Œue
;

949 
R’d”Objeù
* 
	gchd
 = 
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
()) {

950 ià(!
chd
->
isTabËSeùiÚ
())

952 
	gsw
 = 
toR’d”TabËSeùiÚ
(
chd
)->
ou‹rBÜd”Right
();

953 ià(
	gsw
 == -1)

956 
	g®lHidd’
 = 
çl£
;

957 
	gbÜd”Width
 = 
max
(
bÜd”Width
, 
sw
);

959 ià(
	g®lHidd’
)

962  
	gbÜd”Width
;

965 
R’d”TabËSeùiÚ
* 
	gR’d”TabË
::
£ùiÚAbove
(cÚ¡ R’d”TabËSeùiÚ* 
£ùiÚ
, 
boŞ
 
skEm±ySeùiÚs
) const

967 
»ÿlcSeùiÚsIfN“ded
();

969 ià(
	g£ùiÚ
 =ğ
m_h—d
)

972 
R’d”Objeù
* 
	g´evSeùiÚ
 = 
£ùiÚ
 =ğ
m_foÙ
 ? 
Ï¡Chd
(è: seùiÚ->
´eviousSiblšg
();

973 
	g´evSeùiÚ
) {

974 ià(
	g´evSeùiÚ
->
isTabËSeùiÚ
(è&&…»vSeùiÚ !ğ
m_h—d
 && 
´evSeùiÚ
 !ğ
m_foÙ
 && (!
skEm±ySeùiÚs
 || 
toR’d”TabËSeùiÚ
Õ»vSeùiÚ)->
numRows
()))

976 
	g´evSeùiÚ
 = 
´evSeùiÚ
->
´eviousSiblšg
();

978 ià(!
	g´evSeùiÚ
 && 
	gm_h—d
 && (!
	gskEm±ySeùiÚs
 || m_h—d->
numRows
()))

979 
	g´evSeùiÚ
 = 
m_h—d
;

980  
toR’d”TabËSeùiÚ
(
´evSeùiÚ
);

983 
R’d”TabËSeùiÚ
* 
	gR’d”TabË
::
£ùiÚB–ow
(cÚ¡ R’d”TabËSeùiÚ* 
£ùiÚ
, 
boŞ
 
skEm±ySeùiÚs
) const

985 
»ÿlcSeùiÚsIfN“ded
();

987 ià(
	g£ùiÚ
 =ğ
m_foÙ
)

990 
R’d”Objeù
* 
	gÃxtSeùiÚ
 = 
£ùiÚ
 =ğ
m_h—d
 ? 
fœ¡Chd
(è: seùiÚ->
ÃxtSiblšg
();

991 
	gÃxtSeùiÚ
) {

992 ià(
	gÃxtSeùiÚ
->
isTabËSeùiÚ
(è&&‚extSeùiÚ !ğ
m_h—d
 && 
ÃxtSeùiÚ
 !ğ
m_foÙ
 && (!
skEm±ySeùiÚs
 || 
toR’d”TabËSeùiÚ
ÒextSeùiÚ)->
numRows
()))

994 
	gÃxtSeùiÚ
 = 
ÃxtSeùiÚ
->
ÃxtSiblšg
();

996 ià(!
	gÃxtSeùiÚ
 && 
	gm_foÙ
 && (!
	gskEm±ySeùiÚs
 || m_foÙ->
numRows
()))

997 
	gÃxtSeùiÚ
 = 
m_foÙ
;

998  
toR’d”TabËSeùiÚ
(
ÃxtSeùiÚ
);

1001 
R’d”TabËC–l
* 
	gR’d”TabË
::
ûÎAbove
(cÚ¡ R’d”TabËC–l* 
ûÎ
) const

1003 
»ÿlcSeùiÚsIfN“ded
();

1006 
	gr
 = 
ûÎ
->
row
();

1007 
R’d”TabËSeùiÚ
* 
	g£ùiÚ
 = 0;

1008 
	grAbove
 = 0;

1009 ià(
	gr
 > 0) {

1011 
	g£ùiÚ
 = 
ûÎ
->
£ùiÚ
();

1012 
	grAbove
 = 
r
 - 1;

1014 
	g£ùiÚ
 = 
£ùiÚAbove
(
ûÎ
->
£ùiÚ
(), 
Œue
);

1015 ià(
	g£ùiÚ
)

1016 
	grAbove
 = 
£ùiÚ
->
numRows
() - 1;

1020 ià(
	g£ùiÚ
) {

1021 
	geffCŞ
 = 
cŞToEffCŞ
(
ûÎ
->
cŞ
());

1022 
	gR’d”TabËSeùiÚ
::
C–lSŒuù
 
aboveC–l
;

1025 
	gaboveC–l
 = 
£ùiÚ
->
ûÎAt
(
rAbove
, 
effCŞ
);

1026 
	geffCŞ
--;

1027 } !
	gaboveC–l
.
	gûÎ
 &&‡boveC–l.
	gšCŞS·n
 && 
	geffCŞ
 >= 0);

1028  
	gaboveC–l
.
	gûÎ
;

1033 
R’d”TabËC–l
* 
	gR’d”TabË
::
ûÎB–ow
(cÚ¡ R’d”TabËC–l* 
ûÎ
) const

1035 
»ÿlcSeùiÚsIfN“ded
();

1038 
	gr
 = 
ûÎ
->
row
(è+ c–l->
rowS·n
() - 1;

1039 
R’d”TabËSeùiÚ
* 
	g£ùiÚ
 = 0;

1040 
	grB–ow
 = 0;

1041 ià(
	gr
 < 
	gûÎ
->
£ùiÚ
()->
numRows
() - 1) {

1043 
	g£ùiÚ
 = 
ûÎ
->
£ùiÚ
();

1044 
	grB–ow
 = 
r
 + 1;

1046 
	g£ùiÚ
 = 
£ùiÚB–ow
(
ûÎ
->
£ùiÚ
(), 
Œue
);

1047 ià(
	g£ùiÚ
)

1048 
	grB–ow
 = 0;

1052 ià(
	g£ùiÚ
) {

1053 
	geffCŞ
 = 
cŞToEffCŞ
(
ûÎ
->
cŞ
());

1054 
	gR’d”TabËSeùiÚ
::
C–lSŒuù
 
b–owC–l
;

1057 
	gb–owC–l
 = 
£ùiÚ
->
ûÎAt
(
rB–ow
, 
effCŞ
);

1058 
	geffCŞ
--;

1059 } !
	gb–owC–l
.
	gûÎ
 && b–owC–l.
	gšCŞS·n
 && 
	geffCŞ
 >= 0);

1060  
	gb–owC–l
.
	gûÎ
;

1065 
R’d”TabËC–l
* 
	gR’d”TabË
::
ûÎBefÜe
(cÚ¡ R’d”TabËC–l* 
ûÎ
) const

1067 
»ÿlcSeùiÚsIfN“ded
();

1069 
R’d”TabËSeùiÚ
* 
	g£ùiÚ
 = 
ûÎ
->
£ùiÚ
();

1070 
	geffCŞ
 = 
cŞToEffCŞ
(
ûÎ
->
cŞ
());

1071 ià(!
	geffCŞ
)

1075 
	gR’d”TabËSeùiÚ
::
C–lSŒuù
 
´evC–l
;

1077 
	g´evC–l
 = 
£ùiÚ
->
ûÎAt
(
ûÎ
->
row
(), 
effCŞ
 - 1);

1078 
	geffCŞ
--;

1079 } !
	g´evC–l
.
	gûÎ
 &&…»vC–l.
	gšCŞS·n
 && 
	geffCŞ
 >= 0);

1080  
	g´evC–l
.
	gûÎ
;

1083 
R’d”TabËC–l
* 
	gR’d”TabË
::
ûÎAá”
(cÚ¡ R’d”TabËC–l* 
ûÎ
) const

1085 
»ÿlcSeùiÚsIfN“ded
();

1087 
	geffCŞ
 = 
cŞToEffCŞ
(
ûÎ
->
cŞ
(è+ c–l->
cŞS·n
());

1088 ià(
	geffCŞ
 >ğ
numEffCŞs
())

1090  
	gûÎ
->
£ùiÚ
()->
ûÎAt
(
ûÎ
->
row
(), 
effCŞ
).cell;

1093 
R’d”Block
* 
	gR’d”TabË
::
fœ¡LšeBlock
() const

1098 
	gR’d”TabË
::
upd©eFœ¡L‘‹r
()

1102 
R’d”TabË
::
fœ¡LšeBoxBa£lše
() const

1104 
R’d”TabËSeùiÚ
* 
fœ¡NÚEm±ySeùiÚ
 = 
m_h—d
 ? m_h—d : (
m_fœ¡Body
 ? m_fœ¡Body : 
m_foÙ
);

1105 ià(
	gfœ¡NÚEm±ySeùiÚ
 && !fœ¡NÚEm±ySeùiÚ->
numRows
())

1106 
	gfœ¡NÚEm±ySeùiÚ
 = 
£ùiÚB–ow
(
fœ¡NÚEm±ySeùiÚ
, 
Œue
);

1108 ià(!
	gfœ¡NÚEm±ySeùiÚ
)

1111  
	gfœ¡NÚEm±ySeùiÚ
->
y
(è+ fœ¡NÚEm±ySeùiÚ->
fœ¡LšeBoxBa£lše
();

1114 
IÁReù
 
	gR’d”TabË
::
ov”æowClReù
(
tx
, 
ty
)

1116 
IÁReù
 
	g»ù
 = 
R’d”Block
::
ov”æowClReù
(
tx
, 
ty
);

1124 ià(
	gm_ÿ±iÚ
) {

1125 
	g»ù
.
£tHeight
(
height
());

1126 
	g»ù
.
£tY
(
ty
);

1129  
	g»ù
;

1132 
boŞ
 
	gR’d”TabË
::
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
& 
»que¡
, 
H™Te¡ResuÉ
& 
»suÉ
, 
xPos
, 
yPos
, 
tx
, 
ty
, 
H™Te¡AùiÚ
 
aùiÚ
)

1134 
	gtx
 +ğ
x
();

1135 
	gty
 +ğ
y
();

1138 ià(!
hasOv”æowCl
(è|| 
ov”æowClReù
(
tx
, 
ty
).
cÚšs
(
xPos
, 
yPos
)) {

1139 
R’d”Objeù
* 
	gchd
 = 
Ï¡Chd
(); chd; chd = 
chd
->
´eviousSiblšg
()) {

1140 ià(
chd
->
isBox
(è&& !
toR’d”Box
(chd)->
hasS–fPaštšgLay”
(è&& (chd->
isTabËSeùiÚ
(è|| chd =ğ
m_ÿ±iÚ
) &&

1141 
chd
->
nodeAtPošt
(
»que¡
, 
»suÉ
, 
xPos
, 
yPos
, 
tx
, 
ty
, 
aùiÚ
)) {

1142 
upd©eH™Te¡ResuÉ
(
»suÉ
, 
IÁPošt
(
xPos
 - 
tx
, 
yPos
 - 
ty
));

1143  
	gŒue
;

1149 ià(
visibËToH™Te¡šg
(è&& (
	gaùiÚ
 =ğ
H™Te¡BlockBackground
 || 
aùiÚ
 =ğ
H™Te¡ChdBlockBackground
è&& 
IÁReù
(
tx
, 
ty
, 
width
(), 
height
()).
cÚšs
(
xPos
, 
yPos
)) {

1150 
upd©eH™Te¡ResuÉ
(
»suÉ
, 
IÁPošt
(
xPos
 - 
tx
, 
yPos
 - 
ty
));

1151  
	gŒue
;

1154  
	gçl£
;

	@RenderTable.h

25 #iâdeà
R’d”TabË_h


26 
	#R’d”TabË_h


	)

28 
	~"R’d”Block.h
"

29 
	~<wtf/VeùÜ.h
>

31 
Çme¥aû
 
	gWebCÜe
 {

33 
şass
 
	gR’d”TabËCŞ
;

34 
şass
 
	gR’d”TabËC–l
;

35 
şass
 
	gR’d”TabËSeùiÚ
;

36 
şass
 
	gTabËLayout
;

38 şas 
	cR’d”TabË
 : 
public
 
R’d”Block
 {

39 
public
:

40 
R’d”TabË
(
Node
*);

42 
g‘CŞumnPos
(
cŞ
ècÚ¡ {  
	gm_cŞumnPos
[col]; }

44 
hBÜd”S·cšg
(ècÚ¡ {  
	gm_hS·cšg
; }

45 
vBÜd”S·cšg
(ècÚ¡ {  
	gm_vS·cšg
; }

47 
boŞ
 
cŞÏp£BÜd”s
(ècÚ¡ {  
¡yË
()->
bÜd”CŞÏp£
(); }

48 
bÜd”Leá
(ècÚ¡ {  
	gm_bÜd”Leá
; }

49 
bÜd”Right
(ècÚ¡ {  
	gm_bÜd”Right
; }

50 
bÜd”Tİ
() const;

51 
bÜd”BÙtom
() const;

53 cÚ¡ 
	gCŞÜ
& 
bgCŞÜ
(ècÚ¡ {  
¡yË
()->
backgroundCŞÜ
(); }

55 
ou‹rBÜd”Tİ
() const;

56 
ou‹rBÜd”BÙtom
() const;

57 
ou‹rBÜd”Leá
() const;

58 
ou‹rBÜd”Right
() const;

60 
ÿlcBÜd”Leá
() const;

61 
ÿlcBÜd”Right
() const;

62 
»ÿlcHÜizÚlBÜd”s
();

64 
vœtu®
 
addChd
(
R’d”Objeù
* 
chd
, R’d”Objeù* 
befÜeChd
 = 0);

66 
	sCŞumnSŒuù
 {

68 
	gWidthUndefšed
 = 0xffff

71 
CŞumnSŒuù
()

72 : 
¥ª
(1)

73 , 
width
(
WidthUndefšed
)

77 
	g¥ª
;

78 
	gwidth
;

81 
	gVeùÜ
<
	gCŞumnSŒuù
>& 
cŞumns
(è{  
	gm_cŞumns
; }

82 
	gVeùÜ
<>& 
cŞumnPos™iÚs
(è{  
	gm_cŞumnPos
; }

83 
R’d”TabËSeùiÚ
* 
h—d”
(ècÚ¡ {  
	gm_h—d
; }

84 
R’d”TabËSeùiÚ
* 
foÙ”
(ècÚ¡ {  
	gm_foÙ
; }

85 
R’d”TabËSeùiÚ
* 
fœ¡Body
(ècÚ¡ {  
	gm_fœ¡Body
; }

87 
¥l™CŞumn
(
pos
, 
fœ¡S·n
);

88 
­³ndCŞumn
(
¥ª
);

89 
numEffCŞs
(ècÚ¡ {  
	gm_cŞumns
.
size
(); }

90 
¥ªOfEffCŞ
(
effCŞ
ècÚ¡ {  
	gm_cŞumns
[effCŞ].
	g¥ª
; }

92 
cŞToEffCŞ
(
cŞ
) const

94 
	gi
 = 0;

95 
	geffCŞ
 = 
numEffCŞs
();

96 
	gc
 = 0; c < 
	gcŞ
 && 
	gi
 < 
	geffCŞ
; ++i)

97 
	gc
 +ğ
m_cŞumns
[
i
].
¥ª
;

98  
	gi
;

101 
effCŞToCŞ
(
effCŞ
) const

103 
	gc
 = 0;

104 
	gi
 = 0; i < 
	geffCŞ
; i++)

105 
	gc
 +ğ
m_cŞumns
[
i
].
¥ª
;

106  
	gc
;

109 
bÜd”sPaddšgAndS·cšg
() const

111  
bÜd”Leá
(è+ 
bÜd”Right
() +

112 (
cŞÏp£BÜd”s
(è? 0 : (
·ddšgLeá
(è+ 
·ddšgRight
(è+ (
numEffCŞs
(è+ 1è* 
hBÜd”S·cšg
()));

115 
R’d”TabËCŞ
* 
cŞEËm’t
(
cŞ
, 
boŞ
* 
¡¬tEdge
 = 0, boŞ* 
’dEdge
 = 0) const;

116 
R’d”TabËCŞ
* 
ÃxtCŞEËm’t
(R’d”TabËCŞ* 
cu¼’t
) const;

118 
boŞ
 
ÃedsSeùiÚReÿlc
(ècÚ¡ {  
	gm_ÃedsSeùiÚReÿlc
; }

119 
£tN“dsSeùiÚReÿlc
()

121 ià(
docum’tBešgDe¡royed
())

123 
	gm_ÃedsSeùiÚReÿlc
 = 
Œue
;

124 
£tN“dsLayout
(
Œue
);

127 
R’d”TabËSeùiÚ
* 
£ùiÚAbove
(cÚ¡ R’d”TabËSeùiÚ*, 
boŞ
 
skEm±ySeùiÚs
 = 
çl£
) const;

128 
R’d”TabËSeùiÚ
* 
£ùiÚB–ow
(cÚ¡ R’d”TabËSeùiÚ*, 
boŞ
 
skEm±ySeùiÚs
 = 
çl£
) const;

130 
R’d”TabËC–l
* 
ûÎAbove
(const RenderTableCell*) const;

131 
R’d”TabËC–l
* 
ûÎB–ow
(const RenderTableCell*) const;

132 
R’d”TabËC–l
* 
ûÎBefÜe
(const RenderTableCell*) const;

133 
R’d”TabËC–l
* 
ûÎAá”
(const RenderTableCell*) const;

135 cÚ¡ 
CŞÏp£dBÜd”V®ue
* 
cu¼’tBÜd”StyË
(ècÚ¡ {  
	gm_cu¼’tBÜd”
; }

137 
boŞ
 
hasSeùiÚs
(ècÚ¡ {  
	gm_h—d
 || 
	gm_foÙ
 || 
	gm_fœ¡Body
; }

139 
»ÿlcSeùiÚsIfN“ded
() const

141 ià(
	gm_ÃedsSeùiÚReÿlc
)

142 
»ÿlcSeùiÚs
();

145 
	g´Ùeùed
:

146 
vœtu®
 
¡yËDidChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
);

148 
	g´iv©e
:

149 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderTable"; }

151 
vœtu®
 
boŞ
 
isTabË
(ècÚ¡ {  
	gŒue
; }

153 
vœtu®
 
boŞ
 
avoidsFlßts
(ècÚ¡ {  
	gŒue
; }

155 
vœtu®
 
»moveChd
(
R’d”Objeù
* 
ŞdChd
);

157 
vœtu®
 
·št
(
PaštInfo
&, 
tx
, 
ty
);

158 
vœtu®
 
·štObjeù
(
PaštInfo
&, 
tx
, 
ty
);

159 
vœtu®
 
·štBoxDecÜ©iÚs
(
PaštInfo
&, 
tx
, 
ty
);

160 
vœtu®
 
·štMask
(
PaštInfo
&, 
tx
, 
ty
);

161 
vœtu®
 
Ïyout
();

162 
vœtu®
 
ÿlcP»fWidths
();

163 
vœtu®
 
boŞ
 
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, 
xPos
, 
yPos
, 
tx
, 
ty
, 
H™Te¡AùiÚ
);

165 
vœtu®
 
fœ¡LšeBoxBa£lše
() const;

167 
vœtu®
 
R’d”Block
* 
fœ¡LšeBlock
() const;

168 
vœtu®
 
upd©eFœ¡L‘‹r
();

170 
vœtu®
 
£tC–lWidths
();

172 
vœtu®
 
ÿlcWidth
();

174 
vœtu®
 
IÁReù
 
ov”æowClReù
(
tx
, 
ty
);

176 
»ÿlcSeùiÚs
() const;

178 
mubË
 
	gVeùÜ
<> 
	gm_cŞumnPos
;

179 
mubË
 
	gVeùÜ
<
	gCŞumnSŒuù
> 
	gm_cŞumns
;

181 
mubË
 
R’d”Block
* 
	gm_ÿ±iÚ
;

182 
mubË
 
R’d”TabËSeùiÚ
* 
	gm_h—d
;

183 
mubË
 
R’d”TabËSeùiÚ
* 
	gm_foÙ
;

184 
mubË
 
R’d”TabËSeùiÚ
* 
	gm_fœ¡Body
;

186 
	gOwnPŒ
<
	gTabËLayout
> 
	gm_bËLayout
;

188 cÚ¡ 
CŞÏp£dBÜd”V®ue
* 
	gm_cu¼’tBÜd”
;

190 
mubË
 
boŞ
 
	gm_hasCŞEËm’ts
 : 1;

191 
mubË
 
boŞ
 
	gm_ÃedsSeùiÚReÿlc
 : 1;

193 
	gm_hS·cšg
;

194 
	gm_vS·cšg
;

195 
	gm_bÜd”Leá
;

196 
	gm_bÜd”Right
;

199 
šlše
 
R’d”TabË
* 
	$toR’d”TabË
(
R’d”Objeù
* 
objeù
)

201 
	`ASSERT
(!
objeù
 || objeù->
	`isTabË
());

202  
¡©ic_ÿ¡
<
R’d”TabË
*>(
objeù
);

203 
	}
}

205 
šlše
 cÚ¡ 
R’d”TabË
* 
	$toR’d”TabË
(cÚ¡ 
R’d”Objeù
* 
objeù
)

207 
	`ASSERT
(!
objeù
 || objeù->
	`isTabË
());

208  
¡©ic_ÿ¡
<cÚ¡ 
R’d”TabË
*>(
objeù
);

209 
	}
}

212 
toR’d”TabË
(cÚ¡ 
R’d”TabË
*);

	@RenderTableCell.cpp

25 
	~"cÚfig.h
"

26 
	~"R’d”TabËC–l.h
"

28 
	~"FlßtQuad.h
"

29 
	~"G¿phicsCÚ‹xt.h
"

30 
	~"HTMLNames.h
"

31 
	~"HTMLTabËC–lEËm’t.h
"

32 
	~"R’d”TabËCŞ.h
"

33 
	~"R’d”V›w.h
"

34 
	~"T¿nsfÜmS‹.h
"

36 
usšg
 
Çme¥aû
 
	g¡d
;

38 
Çme¥aû
 
	gWebCÜe
 {

40 
usšg
 
Çme¥aû
 
	gHTMLNames
;

42 
	gR’d”TabËC–l
::
R’d”TabËC–l
(
Node
* 
node
)

43 : 
R’d”Block
(
node
)

44 , 
m_row
(-1)

45 , 
m_cŞumn
(-1)

46 , 
m_rowS·n
(1)

47 , 
m_cŞumnS·n
(1)

48 , 
m_šŒšsicPaddšgTİ
(0)

49 , 
m_šŒšsicPaddšgBÙtom
(0)

50 , 
m_³rûÁageHeight
(0)

52 
upd©eFromEËm’t
();

55 
	gR’d”TabËC–l
::
de¡roy
()

57 
R’d”TabËSeùiÚ
* 
»ÿlcSeùiÚ
 = 
·»Á
(è? 
£ùiÚ
() : 0;

59 
	gR’d”Block
::
de¡roy
();

61 ià(
	g»ÿlcSeùiÚ
)

62 
	g»ÿlcSeùiÚ
->
£tN“dsC–lReÿlc
();

65 
	gR’d”TabËC–l
::
upd©eFromEËm’t
()

67 
Node
* 
n
 = 
node
();

68 ià(
	gn
 && (n->
hasTagName
(
tdTag
è||‚->hasTagName(
thTag
))) {

69 
HTMLTabËC–lEËm’t
* 
	gtc
 = 
¡©ic_ÿ¡
<HTMLTabËC–lEËm’t*>(
n
);

70 
	gŞdRS·n
 = 
m_rowS·n
;

71 
	gŞdCS·n
 = 
m_cŞumnS·n
;

73 
	gm_cŞumnS·n
 = 
tc
->
cŞS·n
();

74 
	gm_rowS·n
 = 
tc
->
rowS·n
();

75 ià((
	gŞdRS·n
 !ğ
m_rowS·n
 || 
ŞdCS·n
 !ğ
m_cŞumnS·n
è&& 
¡yË
(è&& 
·»Á
()) {

76 
£tN“dsLayoutAndP»fWidthsReÿlc
();

77 ià(
£ùiÚ
())

78 
£ùiÚ
()->
£tN“dsC–lReÿlc
();

83 
L’gth
 
	gR’d”TabËC–l
::
¡yËOrCŞWidth
() const

85 
L’gth
 
w
 = 
¡yË
()->
width
();

86 ià(!
	gw
.
isAuto
())

87  
	gw
;

89 
R’d”TabËCŞ
* 
	gbËCŞ
 = 
bË
()->
cŞEËm’t
(
cŞ
());

91 ià(
	gbËCŞ
) {

92 
	gcŞS·nCouÁ
 = 
cŞS·n
();

94 
L’gth
 
	gcŞWidthSum
 = L’gth(0, 
Fixed
);

95 
	gi
 = 1; i <ğ
cŞS·nCouÁ
; i++) {

96 
L’gth
 
	gcŞWidth
 = 
bËCŞ
->
¡yË
()->
width
();

100 ià(!
	gcŞWidth
.
isFixed
()) {

101 ià(
	gcŞS·nCouÁ
 > 1)

102  
	gw
;

103  
	gcŞWidth
;

106 
	gcŞWidthSum
 = 
L’gth
(
cŞWidthSum
.
v®ue
(è+ 
cŞWidth
.v®ue(), 
Fixed
);

108 
	gbËCŞ
 = 
bË
()->
ÃxtCŞEËm’t
(
bËCŞ
);

110 ià(!
	gbËCŞ
)

117 ià(
	gcŞWidthSum
.
isFixed
(è&& cŞWidthSum.
v®ue
() > 0)

118 
	gcŞWidthSum
 = 
L’gth
(
max
(0, 
cŞWidthSum
.
v®ue
(è- 
bÜd”Leá
(è- 
bÜd”Right
(è- 
·ddšgLeá
(è- 
·ddšgRight
()), 
Fixed
);

119  
	gcŞWidthSum
;

122  
	gw
;

125 
	gR’d”TabËC–l
::
ÿlcP»fWidths
()

130 
bË
()->
»ÿlcSeùiÚsIfN“ded
();

132 
	gR’d”Block
::
ÿlcP»fWidths
();

133 ià(
node
(è&& 
¡yË
()->
autoW¿p
()) {

135 
L’gth
 
	gw
 = 
¡yËOrCŞWidth
();

136 
SŒšg
 
	gnow¿p
 = 
¡©ic_ÿ¡
<
EËm’t
*>(
node
())->
g‘A‰ribu‹
(
now¿pA‰r
);

137 ià(!
	gnow¿p
.
isNuÎ
(è&& 
	gw
.
isFixed
())

143 
	gm_mšP»fWidth
 = 
max
(
w
.
v®ue
(), 
m_mšP»fWidth
);

147 
	gR’d”TabËC–l
::
ÿlcWidth
()

151 
R’d”TabËC–l
::
upd©eWidth
(
w
)

153 ià(
w
 !ğ
width
()) {

154 
£tWidth
(
w
);

155 
£tC–lWidthChªged
(
Œue
);

159 
	gR’d”TabËC–l
::
Ïyout
()

161 
ÏyoutBlock
(
ûÎWidthChªged
());

162 
£tC–lWidthChªged
(
çl£
);

165 
	gR’d”TabËC–l
::
·ddšgTİ
(
boŞ
 
šşudeIÁršsicPaddšg
) const

167  
R’d”Block
::
·ddšgTİ
(è+ (
šşudeIÁršsicPaddšg
 ? 
šŒšsicPaddšgTİ
() : 0);

170 
	gR’d”TabËC–l
::
·ddšgBÙtom
(
boŞ
 
šşudeIÁršsicPaddšg
) const

172  
R’d”Block
::
·ddšgBÙtom
(è+ (
šşudeIÁršsicPaddšg
 ? 
šŒšsicPaddšgBÙtom
() : 0);

175 
	gR’d”TabËC–l
::
£tOv”rideSize
(
size
)

177 
ş—rIÁršsicPaddšg
();

178 
	gR’d”Block
::
£tOv”rideSize
(
size
);

181 
IÁSize
 
	gR’d”TabËC–l
::
off£tFromCÚš”
(
R’d”Objeù
* 
o
, cÚ¡ 
IÁPošt
& 
pošt
) const

183 
ASSERT
(
o
 =ğ
cÚš”
());

185 
IÁSize
 
	goff£t
 = 
R’d”Block
::
off£tFromCÚš”
(
o
, 
pošt
);

186 ià(
·»Á
())

187 
	goff£t
.
ex·nd
(-
·»ÁBox
()->
x
(), -·»ÁBox()->
y
());

189  
	goff£t
;

192 
IÁReù
 
	gR’d”TabËC–l
::
ş³dOv”æowReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
)

198 ià(!
bË
()->
cŞÏp£BÜd”s
(è||abË()->
ÃedsSeùiÚReÿlc
())

199  
R’d”Block
::
ş³dOv”æowReùFÜR•ašt
(
»·štCÚš”
);

201 
boŞ
 
	g¹l
 = 
bË
()->
¡yË
()->
dœeùiÚ
(è=ğ
RTL
;

202 
	goušeSize
 = 
¡yË
()->
oušeSize
();

203 
	gËá
 = 
max
(
bÜd”H®fLeá
(
Œue
), 
oušeSize
);

204 
	gright
 = 
max
(
bÜd”H®fRight
(
Œue
), 
oušeSize
);

205 
	gtİ
 = 
max
(
bÜd”H®fTİ
(
Œue
), 
oušeSize
);

206 
	gbÙtom
 = 
max
(
bÜd”H®fBÙtom
(
Œue
), 
oušeSize
);

207 ià((
	gËá
 && !
	g¹l
è|| (
	gright
 &&„tl)) {

208 ià(
R’d”TabËC–l
* 
	gbefÜe
 = 
bË
()->
ûÎBefÜe
(
this
)) {

209 
tİ
 = 
max
Ñİ, 
befÜe
->
bÜd”H®fTİ
(
Œue
));

210 
	gbÙtom
 = 
max
(
bÙtom
, 
befÜe
->
bÜd”H®fBÙtom
(
Œue
));

213 ià((
	gËá
 && 
	g¹l
è|| (
	gright
 && !rtl)) {

214 ià(
R’d”TabËC–l
* 
	gaá”
 = 
bË
()->
ûÎAá”
(
this
)) {

215 
tİ
 = 
max
Ñİ, 
aá”
->
bÜd”H®fTİ
(
Œue
));

216 
	gbÙtom
 = 
max
(
bÙtom
, 
aá”
->
bÜd”H®fBÙtom
(
Œue
));

219 ià(
	gtİ
) {

220 ià(
R’d”TabËC–l
* 
	gabove
 = 
bË
()->
ûÎAbove
(
this
)) {

221 
Ëá
 = 
max
Öeá, 
above
->
bÜd”H®fLeá
(
Œue
));

222 
	gright
 = 
max
(
right
, 
above
->
bÜd”H®fRight
(
Œue
));

225 ià(
	gbÙtom
) {

226 ià(
R’d”TabËC–l
* 
	gb–ow
 = 
bË
()->
ûÎB–ow
(
this
)) {

227 
Ëá
 = 
max
Öeá, 
b–ow
->
bÜd”H®fLeá
(
Œue
));

228 
	gright
 = 
max
(
right
, 
b–ow
->
bÜd”H®fRight
(
Œue
));

231 
	gËá
 = 
max
(
Ëá
, -
ËáVisibËOv”æow
());

232 
	gtİ
 = 
max
(
tİ
, -
tİVisibËOv”æow
());

233 
IÁReù
 
r
(-
Ëá
, - 
tİ
,†eá + 
max
(
width
(è+ 
right
, 
rightVisibËOv”æow
()),İ + max(
height
(è+ 
bÙtom
, 
bÙtomVisibËOv”æow
()));

235 ià(
R’d”V›w
* 
	gv
 = 
v›w
()) {

238 
r
.
move
(
v
->
ÏyoutD–
());

240 
compu‹ReùFÜR•ašt
(
»·štCÚš”
, 
r
);

241  
	gr
;

244 
	gR’d”TabËC–l
::
compu‹ReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
IÁReù
& 
r
, 
boŞ
 
fixed
)

246 ià(
	g»·štCÚš”
 =ğ
this
)

248 
	gr
.
£tY
(
r
.
y
());

249 
R’d”V›w
* 
	gv
 = 
v›w
();

250 ià((!
	gv
 || !v->
ÏyoutS‹EÇbËd
(è|| 
	g»·štCÚš”
è&& 
·»Á
())

251 
	gr
.
move
(-
·»ÁBox
()->
x
(), -·»ÁBox()->
y
());

252 
	gR’d”Block
::
compu‹ReùFÜR•ašt
(
»·štCÚš”
, 
r
, 
fixed
);

255 
	gR’d”TabËC–l
::
ba£lšePos™iÚ
(
boŞ
 
fœ¡Lše
, boŞ 
isRoÙLšeBox
) const

257 ià(
	gisRoÙLšeBox
)

258  
	gR’d”Box
::
ba£lšePos™iÚ
(
fœ¡Lše
, 
isRoÙLšeBox
);

263 
	gfœ¡LšeBa£lše
 = 
fœ¡LšeBoxBa£lše
();

264 ià(
	gfœ¡LšeBa£lše
 != -1)

265  
fœ¡LšeBa£lše
;

266  
·ddšgTİ
(è+ 
bÜd”Tİ
(è+ 
cÚ‹ÁHeight
();

269 
	gR’d”TabËC–l
::
¡yËWlChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ÃwStyË
)

271 ià(
·»Á
(è&& 
£ùiÚ
(è&& 
¡yË
(è&& styË()->
height
(è!ğ
ÃwStyË
->height())

272 
£ùiÚ
()->
£tN“dsC–lReÿlc
();

274 
ASSERT
(
ÃwStyË
->
di¥Ïy
(è=ğ
TABLE_CELL
);

276 
	gR’d”Block
::
¡yËWlChªge
(
diff
, 
ÃwStyË
);

279 
	gR’d”TabËC–l
::
¡yËDidChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
)

281 
	gR’d”Block
::
¡yËDidChªge
(
diff
, 
ŞdStyË
);

282 
£tHasBoxDecÜ©iÚs
(
Œue
);

298 
CŞÏp£dBÜd”V®ue
 
com·»BÜd”s
(cÚ¡ CŞÏp£dBÜd”V®ue& 
bÜd”1
, cÚ¡ CŞÏp£dBÜd”V®ue& 
bÜd”2
)

301 ià(!
	gbÜd”2
.
exi¡s
())

302  
	gbÜd”1
;

303 ià(!
	gbÜd”1
.
exi¡s
())

304  
	gbÜd”2
;

307 ià(
	gbÜd”1
.
¡yË
(è=ğ
BHIDDEN
 || 
bÜd”2
.style() == BHIDDEN)

308  
CŞÏp£dBÜd”V®ue
();

311 ià(
	gbÜd”2
.
¡yË
(è=ğ
BNONE
)

312  
bÜd”1
;

313 ià(
	gbÜd”1
.
¡yË
(è=ğ
BNONE
)

314  
bÜd”2
;

317 ià(
	gbÜd”1
.
width
(è!ğ
bÜd”2
.width())

318  
bÜd”1
.
width
(è> 
bÜd”2
.width() ? border1 : border2;

321 ià(
	gbÜd”1
.
¡yË
(è!ğ
bÜd”2
.style())

322  
bÜd”1
.
¡yË
(è> 
bÜd”2
.style() ? border1 : border2;

325  
	gbÜd”1
.
´eûd’û
(è>ğ
bÜd”2
.´eûd’û(è? 
bÜd”1
 : border2;

328 
CŞÏp£dBÜd”V®ue
 
	gR’d”TabËC–l
::
cŞÏp£dLeáBÜd”
(
boŞ
 
¹l
) const

330 
R’d”TabË
* 
bËEÉ
 = 
bË
();

331 
boŞ
 
	gËámo¡CŞumn
;

332 ià(!
	g¹l
)

333 
	gËámo¡CŞumn
 = 
cŞ
() == 0;

335 
	geffCŞ
 = 
bËEÉ
->
cŞToEffCŞ
(
cŞ
(è+ 
cŞS·n
() - 1);

336 
	gËámo¡CŞumn
 = 
effCŞ
 =ğ
bËEÉ
->
numEffCŞs
() - 1;

341 
	gËá
 = 
CSSPrİ”tyBÜd”LeáCŞÜ
;

342 
	gright
 = 
CSSPrİ”tyBÜd”RightCŞÜ
;

343 
CŞÏp£dBÜd”V®ue
 
»suÉ
(&
¡yË
()->
bÜd”Leá
(), styË()->
vis™edD•’d’tCŞÜ
(
Ëá
), 
BCELL
);

346 
R’d”TabËC–l
* 
	g´evC–l
 = 
¹l
 ? 
bËEÉ
->
ûÎAá”
(
this
è:abËEÉ->
ûÎBefÜe
(this);

347 ià(
	g´evC–l
) {

348 
CŞÏp£dBÜd”V®ue
 
	g´evC–lBÜd”
 = CŞÏp£dBÜd”V®ue(&
´evC–l
->
¡yË
()->
bÜd”Right
(),…»vC–l->¡yË()->
vis™edD•’d’tCŞÜ
(
right
), 
BCELL
);

349 
	g»suÉ
 = 
¹l
 ? 
com·»BÜd”s
(
»suÉ
, 
´evC–lBÜd”
) : compareBorders(prevCellBorder,„esult);

350 ià(!
	g»suÉ
.
exi¡s
())

351  
	g»suÉ
;

352 } ià(
	gËámo¡CŞumn
) {

354 
	g»suÉ
 = 
com·»BÜd”s
(
»suÉ
, 
CŞÏp£dBÜd”V®ue
(&
·»Á
()->
¡yË
()->
bÜd”Leá
(),…¬’t()->¡yË()->
vis™edD•’d’tCŞÜ
(
Ëá
), 
BROW
));

355 ià(!
	g»suÉ
.
exi¡s
())

356  
	g»suÉ
;

359 
	g»suÉ
 = 
com·»BÜd”s
(
»suÉ
, 
CŞÏp£dBÜd”V®ue
(&
£ùiÚ
()->
¡yË
()->
bÜd”Leá
(), seùiÚ()->¡yË()->
vis™edD•’d’tCŞÜ
(
Ëá
), 
BROWGROUP
));

360 ià(!
	g»suÉ
.
exi¡s
())

361  
	g»suÉ
;

365 
boŞ
 
	g¡¬tCŞEdge
;

366 
boŞ
 
	g’dCŞEdge
;

367 
R’d”TabËCŞ
* 
	gcŞEÉ
 = 
bËEÉ
->
cŞEËm’t
(
cŞ
(è+ (
¹l
 ? 
cŞS·n
(è- 1 : 0), &
¡¬tCŞEdge
, &
’dCŞEdge
);

368 ià(
	gcŞEÉ
 && (!
	g¹l
 ? 
	g¡¬tCŞEdge
 : 
’dCŞEdge
)) {

369 
»suÉ
 = 
com·»BÜd”s
ÔesuÉ, 
CŞÏp£dBÜd”V®ue
(&
cŞEÉ
->
¡yË
()->
bÜd”Leá
(), cŞEÉ->¡yË()->
vis™edD•’d’tCŞÜ
(
Ëá
), 
BCOL
));

370 ià(!
	g»suÉ
.
exi¡s
())

371  
	g»suÉ
;

372 ià(
	gcŞEÉ
->
·»Á
()->
isTabËCŞ
(è&& (!
	g¹l
 ? !cŞEÉ->
´eviousSiblšg
(è: !
cŞEÉ
->
ÃxtSiblšg
())) {

373 
»suÉ
 = 
com·»BÜd”s
ÔesuÉ, 
CŞÏp£dBÜd”V®ue
(&
cŞEÉ
->
·»Á
()->
¡yË
()->
bÜd”Leá
(), cŞEÉ->·»Á()->¡yË()->
vis™edD•’d’tCŞÜ
(
Ëá
), 
BCOLGROUP
));

374 ià(!
	g»suÉ
.
exi¡s
())

375  
	g»suÉ
;

380 ià(!
	gËámo¡CŞumn
) {

381 
	gcŞEÉ
 = 
bËEÉ
->
cŞEËm’t
(
cŞ
(è+ (
¹l
 ? 
cŞS·n
(è: -1), &
¡¬tCŞEdge
, &
’dCŞEdge
);

382 ià(
	gcŞEÉ
 && (!
	g¹l
 ? 
	g’dCŞEdge
 : 
¡¬tCŞEdge
)) {

383 
CŞÏp£dBÜd”V®ue
 
rightBÜd”
 = CŞÏp£dBÜd”V®ue(&
cŞEÉ
->
¡yË
()->
bÜd”Right
(), cŞEÉ->¡yË()->
vis™edD•’d’tCŞÜ
(
right
), 
BCOL
);

384 
	g»suÉ
 = 
¹l
 ? 
com·»BÜd”s
(
»suÉ
, 
rightBÜd”
) : compareBorders(rightBorder,„esult);

385 ià(!
	g»suÉ
.
exi¡s
())

386  
	g»suÉ
;

390 
	g»suÉ
 = 
com·»BÜd”s
(
»suÉ
, 
CŞÏp£dBÜd”V®ue
(&
bËEÉ
->
¡yË
()->
bÜd”Leá
(),abËEÉ->¡yË()->
vis™edD•’d’tCŞÜ
(
Ëá
), 
BTABLE
));

391 ià(!
	g»suÉ
.
exi¡s
())

392  
	g»suÉ
;

395  
	g»suÉ
;

398 
CŞÏp£dBÜd”V®ue
 
	gR’d”TabËC–l
::
cŞÏp£dRightBÜd”
(
boŞ
 
¹l
) const

400 
R’d”TabË
* 
bËEÉ
 = 
bË
();

401 
boŞ
 
	grightmo¡CŞumn
;

402 ià(
	g¹l
)

403 
	grightmo¡CŞumn
 = 
cŞ
() == 0;

405 
	geffCŞ
 = 
bËEÉ
->
cŞToEffCŞ
(
cŞ
(è+ 
cŞS·n
() - 1);

406 
	grightmo¡CŞumn
 = 
effCŞ
 =ğ
bËEÉ
->
numEffCŞs
() - 1;

411 
	gËá
 = 
CSSPrİ”tyBÜd”LeáCŞÜ
;

412 
	gright
 = 
CSSPrİ”tyBÜd”RightCŞÜ
;

413 
CŞÏp£dBÜd”V®ue
 
	g»suÉ
 = CŞÏp£dBÜd”V®ue(&
¡yË
()->
bÜd”Right
(), styË()->
vis™edD•’d’tCŞÜ
(
right
), 
BCELL
);

416 ià(!
	grightmo¡CŞumn
) {

417 
R’d”TabËC–l
* 
	gÃxtC–l
 = 
¹l
 ? 
bËEÉ
->
ûÎBefÜe
(
this
è:abËEÉ->
ûÎAá”
(this);

418 ià(
	gÃxtC–l
 &&‚extC–l->
¡yË
()) {

419 
CŞÏp£dBÜd”V®ue
 
	gËáBÜd”
 = CŞÏp£dBÜd”V®ue(&
ÃxtC–l
->
¡yË
()->
bÜd”Leá
(),‚extC–l->¡yË()->
vis™edD•’d’tCŞÜ
(
Ëá
), 
BCELL
);

420 
	g»suÉ
 = 
¹l
 ? 
com·»BÜd”s
(
ËáBÜd”
, 
»suÉ
) : compareBorders(result,†eftBorder);

421 ià(!
	g»suÉ
.
exi¡s
())

422  
	g»suÉ
;

426 
	g»suÉ
 = 
com·»BÜd”s
(
»suÉ
, 
CŞÏp£dBÜd”V®ue
(&
·»Á
()->
¡yË
()->
bÜd”Right
(),…¬’t()->¡yË()->
vis™edD•’d’tCŞÜ
(
right
), 
BROW
));

427 ià(!
	g»suÉ
.
exi¡s
())

428  
	g»suÉ
;

431 
	g»suÉ
 = 
com·»BÜd”s
(
»suÉ
, 
CŞÏp£dBÜd”V®ue
(&
£ùiÚ
()->
¡yË
()->
bÜd”Right
(), seùiÚ()->¡yË()->
vis™edD•’d’tCŞÜ
(
right
), 
BROWGROUP
));

432 ià(!
	g»suÉ
.
exi¡s
())

433  
	g»suÉ
;

437 
boŞ
 
	g¡¬tCŞEdge
;

438 
boŞ
 
	g’dCŞEdge
;

439 
R’d”TabËCŞ
* 
	gcŞEÉ
 = 
bËEÉ
->
cŞEËm’t
(
cŞ
(è+ (
¹l
 ? 0 : 
cŞS·n
(è- 1), &
¡¬tCŞEdge
, &
’dCŞEdge
);

440 ià(
	gcŞEÉ
 && (!
	g¹l
 ? 
	g’dCŞEdge
 : 
¡¬tCŞEdge
)) {

441 
»suÉ
 = 
com·»BÜd”s
ÔesuÉ, 
CŞÏp£dBÜd”V®ue
(&
cŞEÉ
->
¡yË
()->
bÜd”Right
(), cŞEÉ->¡yË()->
vis™edD•’d’tCŞÜ
(
right
), 
BCOL
));

442 ià(!
	g»suÉ
.
exi¡s
())

443  
	g»suÉ
;

444 ià(
	gcŞEÉ
->
·»Á
()->
isTabËCŞ
(è&& (!
	g¹l
 ? !cŞEÉ->
ÃxtSiblšg
(è: !
cŞEÉ
->
´eviousSiblšg
())) {

445 
»suÉ
 = 
com·»BÜd”s
ÔesuÉ, 
CŞÏp£dBÜd”V®ue
(&
cŞEÉ
->
·»Á
()->
¡yË
()->
bÜd”Right
(), cŞEÉ->·»Á()->¡yË()->
vis™edD•’d’tCŞÜ
(
right
), 
BCOLGROUP
));

446 ià(!
	g»suÉ
.
exi¡s
())

447  
	g»suÉ
;

452 ià(!
	grightmo¡CŞumn
) {

453 
	gcŞEÉ
 = 
bËEÉ
->
cŞEËm’t
(
cŞ
(è+ (
¹l
 ? -1 : 
cŞS·n
()), &
¡¬tCŞEdge
, &
’dCŞEdge
);

454 ià(
	gcŞEÉ
 && (!
	g¹l
 ? 
	g¡¬tCŞEdge
 : 
’dCŞEdge
)) {

455 
CŞÏp£dBÜd”V®ue
 
ËáBÜd”
 = CŞÏp£dBÜd”V®ue(&
cŞEÉ
->
¡yË
()->
bÜd”Leá
(), cŞEÉ->¡yË()->
vis™edD•’d’tCŞÜ
(
Ëá
), 
BCOL
);

456 
	g»suÉ
 = 
¹l
 ? 
com·»BÜd”s
(
ËáBÜd”
, 
»suÉ
) : compareBorders(result,†eftBorder);

457 ià(!
	g»suÉ
.
exi¡s
())

458  
	g»suÉ
;

462 
	g»suÉ
 = 
com·»BÜd”s
(
»suÉ
, 
CŞÏp£dBÜd”V®ue
(&
bËEÉ
->
¡yË
()->
bÜd”Right
(),abËEÉ->¡yË()->
vis™edD•’d’tCŞÜ
(
right
), 
BTABLE
));

463 ià(!
	g»suÉ
.
exi¡s
())

464  
	g»suÉ
;

467  
	g»suÉ
;

470 
CŞÏp£dBÜd”V®ue
 
	gR’d”TabËC–l
::
cŞÏp£dTİBÜd”
() const

474 
tİ
 = 
CSSPrİ”tyBÜd”TİCŞÜ
;

475 
	gbÙtom
 = 
CSSPrİ”tyBÜd”BÙtomCŞÜ
;

476 
CŞÏp£dBÜd”V®ue
 
	g»suÉ
 = CŞÏp£dBÜd”V®ue(&
¡yË
()->
bÜd”Tİ
(), styË()->
vis™edD•’d’tCŞÜ
(
tİ
), 
BCELL
);

478 
R’d”TabËC–l
* 
	g´evC–l
 = 
bË
()->
ûÎAbove
(
this
);

479 ià(
	g´evC–l
) {

481 
	g»suÉ
 = 
com·»BÜd”s
(
CŞÏp£dBÜd”V®ue
(&
´evC–l
->
¡yË
()->
bÜd”BÙtom
(),…»vC–l->¡yË()->
vis™edD•’d’tCŞÜ
(
bÙtom
), 
BCELL
), 
»suÉ
);

482 ià(!
	g»suÉ
.
exi¡s
())

483  
	g»suÉ
;

487 
	g»suÉ
 = 
com·»BÜd”s
(
»suÉ
, 
CŞÏp£dBÜd”V®ue
(&
·»Á
()->
¡yË
()->
bÜd”Tİ
(),…¬’t()->¡yË()->
vis™edD•’d’tCŞÜ
(
tİ
), 
BROW
));

488 ià(!
	g»suÉ
.
exi¡s
())

489  
	g»suÉ
;

492 ià(
	g´evC–l
) {

493 
R’d”Objeù
* 
	g´evRow
 = 0;

494 ià(
	g´evC–l
->
£ùiÚ
() == section())

495 
´evRow
 = 
·»Á
()->
´eviousSiblšg
();

497 
	g´evRow
 = 
´evC–l
->
£ùiÚ
()->
Ï¡Chd
();

499 ià(
	g´evRow
) {

500 
	g»suÉ
 = 
com·»BÜd”s
(
CŞÏp£dBÜd”V®ue
(&
´evRow
->
¡yË
()->
bÜd”BÙtom
(),…»vRow->¡yË()->
vis™edD•’d’tCŞÜ
(
bÙtom
), 
BROW
), 
»suÉ
);

501 ià(!
	g»suÉ
.
exi¡s
())

502  
	g»suÉ
;

507 
R’d”TabËSeùiÚ
* 
	gcu¼SeùiÚ
 = 
£ùiÚ
();

508 ià(!
row
()) {

510 
	g»suÉ
 = 
com·»BÜd”s
(
»suÉ
, 
CŞÏp£dBÜd”V®ue
(&
cu¼SeùiÚ
->
¡yË
()->
bÜd”Tİ
(), cu¼SeùiÚ->¡yË()->
vis™edD•’d’tCŞÜ
(
tİ
), 
BROWGROUP
));

511 ià(!
	g»suÉ
.
exi¡s
())

512  
	g»suÉ
;

515 
	gcu¼SeùiÚ
 = 
bË
()->
£ùiÚAbove
(
cu¼SeùiÚ
);

516 ià(
	gcu¼SeùiÚ
) {

517 
	g»suÉ
 = 
com·»BÜd”s
(
CŞÏp£dBÜd”V®ue
(&
cu¼SeùiÚ
->
¡yË
()->
bÜd”BÙtom
(), cu¼SeùiÚ->¡yË()->
vis™edD•’d’tCŞÜ
(
bÙtom
), 
BROWGROUP
), 
»suÉ
);

518 ià(!
	g»suÉ
.
exi¡s
())

519  
	g»suÉ
;

523 ià(!
	gcu¼SeùiÚ
) {

525 
R’d”TabËCŞ
* 
	gcŞEÉ
 = 
bË
()->
cŞEËm’t
(
cŞ
());

526 ià(
	gcŞEÉ
) {

527 
	g»suÉ
 = 
com·»BÜd”s
(
»suÉ
, 
CŞÏp£dBÜd”V®ue
(&
cŞEÉ
->
¡yË
()->
bÜd”Tİ
(), cŞEÉ->¡yË()->
vis™edD•’d’tCŞÜ
(
tİ
), 
BCOL
));

528 ià(!
	g»suÉ
.
exi¡s
())

529  
	g»suÉ
;

530 ià(
	gcŞEÉ
->
·»Á
()->
isTabËCŞ
()) {

531 
	g»suÉ
 = 
com·»BÜd”s
(
»suÉ
, 
CŞÏp£dBÜd”V®ue
(&
cŞEÉ
->
·»Á
()->
¡yË
()->
bÜd”Tİ
(), cŞEÉ->·»Á()->¡yË()->
vis™edD•’d’tCŞÜ
(
tİ
), 
BCOLGROUP
));

532 ià(!
	g»suÉ
.
exi¡s
())

533  
	g»suÉ
;

538 
R’d”TabË
* 
	g’şosšgTabË
 = 
bË
();

539 
	g»suÉ
 = 
com·»BÜd”s
(
»suÉ
, 
CŞÏp£dBÜd”V®ue
(&
’şosšgTabË
->
¡yË
()->
bÜd”Tİ
(),ƒnşosšgTabË->¡yË()->
vis™edD•’d’tCŞÜ
(
tİ
), 
BTABLE
));

540 ià(!
	g»suÉ
.
exi¡s
())

541  
	g»suÉ
;

544  
	g»suÉ
;

547 
CŞÏp£dBÜd”V®ue
 
	gR’d”TabËC–l
::
cŞÏp£dBÙtomBÜd”
() const

551 
tİ
 = 
CSSPrİ”tyBÜd”TİCŞÜ
;

552 
	gbÙtom
 = 
CSSPrİ”tyBÜd”BÙtomCŞÜ
;

553 
CŞÏp£dBÜd”V®ue
 
	g»suÉ
 = CŞÏp£dBÜd”V®ue(&
¡yË
()->
bÜd”BÙtom
(), styË()->
vis™edD•’d’tCŞÜ
(
bÙtom
), 
BCELL
);

555 
R’d”TabËC–l
* 
	gÃxtC–l
 = 
bË
()->
ûÎB–ow
(
this
);

556 ià(
	gÃxtC–l
) {

558 
	g»suÉ
 = 
com·»BÜd”s
(
»suÉ
, 
CŞÏp£dBÜd”V®ue
(&
ÃxtC–l
->
¡yË
()->
bÜd”Tİ
(),‚extC–l->¡yË()->
vis™edD•’d’tCŞÜ
(
tİ
), 
BCELL
));

559 ià(!
	g»suÉ
.
exi¡s
())

560  
	g»suÉ
;

564 
	g»suÉ
 = 
com·»BÜd”s
(
»suÉ
, 
CŞÏp£dBÜd”V®ue
(&
·»Á
()->
¡yË
()->
bÜd”BÙtom
(),…¬’t()->¡yË()->
vis™edD•’d’tCŞÜ
(
bÙtom
), 
BROW
));

565 ià(!
	g»suÉ
.
exi¡s
())

566  
	g»suÉ
;

569 ià(
	gÃxtC–l
) {

570 
	g»suÉ
 = 
com·»BÜd”s
(
»suÉ
, 
CŞÏp£dBÜd”V®ue
(&
ÃxtC–l
->
·»Á
()->
¡yË
()->
bÜd”Tİ
(),‚extC–l->·»Á()->¡yË()->
vis™edD•’d’tCŞÜ
(
tİ
), 
BROW
));

571 ià(!
	g»suÉ
.
exi¡s
())

572  
	g»suÉ
;

576 
R’d”TabËSeùiÚ
* 
	gcu¼SeùiÚ
 = 
£ùiÚ
();

577 ià(
row
(è+ 
rowS·n
(è>ğ
cu¼SeùiÚ
->
numRows
()) {

579 
»suÉ
 = 
com·»BÜd”s
ÔesuÉ, 
CŞÏp£dBÜd”V®ue
(&
cu¼SeùiÚ
->
¡yË
()->
bÜd”BÙtom
(), cu¼SeùiÚ->¡yË()->
vis™edD•’d’tCŞÜ
(
bÙtom
), 
BROWGROUP
));

580 ià(!
	g»suÉ
.
exi¡s
())

581  
	g»suÉ
;

584 
	gcu¼SeùiÚ
 = 
bË
()->
£ùiÚB–ow
(
cu¼SeùiÚ
);

585 ià(
	gcu¼SeùiÚ
) {

586 
	g»suÉ
 = 
com·»BÜd”s
(
»suÉ
, 
CŞÏp£dBÜd”V®ue
(&
cu¼SeùiÚ
->
¡yË
()->
bÜd”Tİ
(), cu¼SeùiÚ->¡yË()->
vis™edD•’d’tCŞÜ
(
tİ
), 
BROWGROUP
));

587 ià(!
	g»suÉ
.
exi¡s
())

588  
	g»suÉ
;

592 ià(!
	gcu¼SeùiÚ
) {

594 
R’d”TabËCŞ
* 
	gcŞEÉ
 = 
bË
()->
cŞEËm’t
(
cŞ
());

595 ià(
	gcŞEÉ
) {

596 
	g»suÉ
 = 
com·»BÜd”s
(
»suÉ
, 
CŞÏp£dBÜd”V®ue
(&
cŞEÉ
->
¡yË
()->
bÜd”BÙtom
(), cŞEÉ->¡yË()->
vis™edD•’d’tCŞÜ
(
bÙtom
), 
BCOL
));

597 ià(!
	g»suÉ
.
exi¡s
()) „esult;

598 ià(
	gcŞEÉ
->
·»Á
()->
isTabËCŞ
()) {

599 
	g»suÉ
 = 
com·»BÜd”s
(
»suÉ
, 
CŞÏp£dBÜd”V®ue
(&
cŞEÉ
->
·»Á
()->
¡yË
()->
bÜd”BÙtom
(), cŞEÉ->·»Á()->¡yË()->
vis™edD•’d’tCŞÜ
(
bÙtom
), 
BCOLGROUP
));

600 ià(!
	g»suÉ
.
exi¡s
())

601  
	g»suÉ
;

606 
R’d”TabË
* 
	g’şosšgTabË
 = 
bË
();

607 
	g»suÉ
 = 
com·»BÜd”s
(
»suÉ
, 
CŞÏp£dBÜd”V®ue
(&
’şosšgTabË
->
¡yË
()->
bÜd”BÙtom
(),ƒnşosšgTabË->¡yË()->
vis™edD•’d’tCŞÜ
(
bÙtom
), 
BTABLE
));

608 ià(!
	g»suÉ
.
exi¡s
())

609  
	g»suÉ
;

612  
	g»suÉ
;

615 
	gR’d”TabËC–l
::
bÜd”Leá
() const

617  
bË
()->
cŞÏp£BÜd”s
(è? 
bÜd”H®fLeá
(
çl£
è: 
R’d”Block
::
bÜd”Leá
();

620 
	gR’d”TabËC–l
::
bÜd”Right
() const

622  
bË
()->
cŞÏp£BÜd”s
(è? 
bÜd”H®fRight
(
çl£
è: 
R’d”Block
::
bÜd”Right
();

625 
	gR’d”TabËC–l
::
bÜd”Tİ
() const

627  
bË
()->
cŞÏp£BÜd”s
(è? 
bÜd”H®fTİ
(
çl£
è: 
R’d”Block
::
bÜd”Tİ
();

630 
	gR’d”TabËC–l
::
bÜd”BÙtom
() const

632  
bË
()->
cŞÏp£BÜd”s
(è? 
bÜd”H®fBÙtom
(
çl£
è: 
R’d”Block
::
bÜd”BÙtom
();

635 
	gR’d”TabËC–l
::
bÜd”H®fLeá
(
boŞ
 
ou‹r
) const

637 
CŞÏp£dBÜd”V®ue
 
bÜd”
 = 
cŞÏp£dLeáBÜd”
(
bË
()->
¡yË
()->
dœeùiÚ
(è=ğ
RTL
);

638 ià(
	gbÜd”
.
exi¡s
())

639  (
	gbÜd”
.
width
(è+ (
	gou‹r
 ? 0 : 1)) / 2;

643 
	gR’d”TabËC–l
::
bÜd”H®fRight
(
boŞ
 
ou‹r
) const

645 
CŞÏp£dBÜd”V®ue
 
bÜd”
 = 
cŞÏp£dRightBÜd”
(
bË
()->
¡yË
()->
dœeùiÚ
(è=ğ
RTL
);

646 ià(
	gbÜd”
.
exi¡s
())

647  (
	gbÜd”
.
width
(è+ (
	gou‹r
 ? 1 : 0)) / 2;

651 
	gR’d”TabËC–l
::
bÜd”H®fTİ
(
boŞ
 
ou‹r
) const

653 
CŞÏp£dBÜd”V®ue
 
bÜd”
 = 
cŞÏp£dTİBÜd”
();

654 ià(
	gbÜd”
.
exi¡s
())

655  (
	gbÜd”
.
width
(è+ (
	gou‹r
 ? 0 : 1)) / 2;

659 
	gR’d”TabËC–l
::
bÜd”H®fBÙtom
(
boŞ
 
ou‹r
) const

661 
CŞÏp£dBÜd”V®ue
 
bÜd”
 = 
cŞÏp£dBÙtomBÜd”
();

662 ià(
	gbÜd”
.
exi¡s
())

663  (
	gbÜd”
.
width
(è+ (
	gou‹r
 ? 1 : 0)) / 2;

667 
	gR’d”TabËC–l
::
·št
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

669 ià(
	g·štInfo
.
	gpha£
 =ğ
PaštPha£CŞÏp£dTabËBÜd”s
 && 
¡yË
()->
visib™y
(è=ğ
VISIBLE
) {

670 ià(!
shouldPaštW™hšRoÙ
(
·štInfo
))

673 
	gtx
 +ğ
x
();

674 
	gty
 +ğ
y
();

675 
	gos
 = 2 * 
maxim®OušeSize
(
·štInfo
.
pha£
);

676 ià(
	gty
 - 
bË
()->
ou‹rBÜd”Tİ
(è< 
	g·štInfo
.
	g»ù
.
bÙtom
(è+ 
	gos
 &&

677 
	gty
 + 
height
(è+ 
bË
()->
ou‹rBÜd”BÙtom
(è> 
	g·štInfo
.
	g»ù
.
y
(è- 
	gos
)

678 
·štCŞÏp£dBÜd”
(
·štInfo
.
cÚ‹xt
, 
tx
, 
ty
, 
width
(), 
height
());

682 
	gR’d”Block
::
·št
(
·štInfo
, 
tx
, 
ty
);

685 
EBÜd”StyË
 
cŞÏp£dBÜd”StyË
(EBÜd”StyË 
¡yË
)

687 ià(
	g¡yË
 =ğ
OUTSET
)

688  
GROOVE
;

689 ià(
	g¡yË
 =ğ
INSET
)

690  
RIDGE
;

691  
	g¡yË
;

694 
	sCŞÏp£dBÜd”
 {

695 
CŞÏp£dBÜd”V®ue
 
	gbÜd”V®ue
;

696 
BoxSide
 
	gside
;

697 
boŞ
 
	gshouldPašt
;

698 
	gx1
;

699 
	gy1
;

700 
	gx2
;

701 
	gy2
;

702 
EBÜd”StyË
 
	g¡yË
;

705 şas 
	cCŞÏp£dBÜd”s
 {

706 
	gpublic
:

707 
CŞÏp£dBÜd”s
()

708 : 
m_couÁ
(0)

712 
addBÜd”
(cÚ¡ 
CŞÏp£dBÜd”V®ue
& 
bÜd”V®ue
, 
BoxSide
 
bÜd”Side
, 
boŞ
 
shouldPašt
,

713 
x1
, 
y1
, 
x2
, 
y2
, 
EBÜd”StyË
 
bÜd”StyË
)

715 ià(
	gbÜd”V®ue
.
exi¡s
(è&& 
	gshouldPašt
) {

716 
	gm_bÜd”s
[
m_couÁ
].
	gbÜd”V®ue
 = 
bÜd”V®ue
;

717 
	gm_bÜd”s
[
m_couÁ
].
	gside
 = 
bÜd”Side
;

718 
	gm_bÜd”s
[
m_couÁ
].
	gshouldPašt
 = 
shouldPašt
;

719 
	gm_bÜd”s
[
m_couÁ
].
	gx1
 = 
x1
;

720 
	gm_bÜd”s
[
m_couÁ
].
	gx2
 = 
x2
;

721 
	gm_bÜd”s
[
m_couÁ
].
	gy1
 = 
y1
;

722 
	gm_bÜd”s
[
m_couÁ
].
	gy2
 = 
y2
;

723 
	gm_bÜd”s
[
m_couÁ
].
	g¡yË
 = 
bÜd”StyË
;

724 
	gm_couÁ
++;

728 
CŞÏp£dBÜd”
* 
ÃxtBÜd”
()

730 
	gi
 = 0; i < 
	gm_couÁ
; i++) {

731 ià(
	gm_bÜd”s
[
i
].
	gbÜd”V®ue
.
exi¡s
(è&& m_bÜd”s[i].
	gshouldPašt
) {

732 
	gm_bÜd”s
[
i
].
	gshouldPašt
 = 
çl£
;

733  &
	gm_bÜd”s
[
i
];

740 
CŞÏp£dBÜd”
 
	gm_bÜd”s
[4];

741 
	gm_couÁ
;

744 
addBÜd”StyË
(
R’d”TabËC–l
::
CŞÏp£dBÜd”StyËs
& 
bÜd”StyËs
, 
CŞÏp£dBÜd”V®ue
 
bÜd”V®ue
)

746 ià(!
	gbÜd”V®ue
.
exi¡s
())

748 
size_t
 
	gcouÁ
 = 
bÜd”StyËs
.
size
();

749 
size_t
 
	gi
 = 0; i < 
	gcouÁ
; ++i)

750 ià(
	gbÜd”StyËs
[
i
] =ğ
bÜd”V®ue
)

752 
	gbÜd”StyËs
.
­³nd
(
bÜd”V®ue
);

755 
	gR’d”TabËC–l
::
	$cŞËùBÜd”StyËs
(
CŞÏp£dBÜd”StyËs
& 
bÜd”StyËs
) const

757 
boŞ
 
¹l
 = 
	`bË
()->
	`¡yË
()->
	`dœeùiÚ
(è=ğ
RTL
;

758 
	`addBÜd”StyË
(
bÜd”StyËs
, 
	`cŞÏp£dLeáBÜd”
(
¹l
));

759 
	`addBÜd”StyË
(
bÜd”StyËs
, 
	`cŞÏp£dRightBÜd”
(
¹l
));

760 
	`addBÜd”StyË
(
bÜd”StyËs
, 
	`cŞÏp£dTİBÜd”
());

761 
	`addBÜd”StyË
(
bÜd”StyËs
, 
	`cŞÏp£dBÙtomBÜd”
());

762 
	}
}

764 
	$com·»BÜd”StyËsFÜQSÜt
(cÚ¡ * 
·
, cÚ¡ * 
pb
)

766 cÚ¡ 
CŞÏp£dBÜd”V®ue
* 
a
 = 
¡©ic_ÿ¡
<cÚ¡ CŞÏp£dBÜd”V®ue*>(
·
);

767 cÚ¡ 
CŞÏp£dBÜd”V®ue
* 
b
 = 
¡©ic_ÿ¡
<cÚ¡ CŞÏp£dBÜd”V®ue*>(
pb
);

768 ià(*
a
 =ğ*
b
)

770 
CŞÏp£dBÜd”V®ue
 
bÜd”W™hHigh”P»ûd’û
 = 
	`com·»BÜd”s
(*
a
, *
b
);

771 ià(*
a
 =ğ
bÜd”W™hHigh”P»ûd’û
)

774 
	}
}

776 
	gR’d”TabËC–l
::
	$sÜtBÜd”StyËs
(
CŞÏp£dBÜd”StyËs
& 
bÜd”StyËs
)

778 
	`qsÜt
(
bÜd”StyËs
.
	`d©a
(), bÜd”StyËs.
	`size
(), (
CŞÏp£dBÜd”V®ue
),

779 
com·»BÜd”StyËsFÜQSÜt
);

780 
	}
}

782 
	gR’d”TabËC–l
::
	$·štCŞÏp£dBÜd”
(
G¿phicsCÚ‹xt
* 
g¿phicsCÚ‹xt
, 
tx
, 
ty
, 
w
, 
h
)

784 ià(!
	`bË
()->
	`cu¼’tBÜd”StyË
())

787 
boŞ
 
¹l
 = 
	`bË
()->
	`¡yË
()->
	`dœeùiÚ
(è=ğ
RTL
;

788 
CŞÏp£dBÜd”V®ue
 
ËáV®
 = 
	`cŞÏp£dLeáBÜd”
(
¹l
);

789 
CŞÏp£dBÜd”V®ue
 
rightV®
 = 
	`cŞÏp£dRightBÜd”
(
¹l
);

790 
CŞÏp£dBÜd”V®ue
 
tİV®
 = 
	`cŞÏp£dTİBÜd”
();

791 
CŞÏp£dBÜd”V®ue
 
bÙtomV®
 = 
	`cŞÏp£dBÙtomBÜd”
();

794 
tİWidth
 = 
tİV®
.
	`width
();

795 
bÙtomWidth
 = 
bÙtomV®
.
	`width
();

796 
ËáWidth
 = 
ËáV®
.
	`width
();

797 
rightWidth
 = 
rightV®
.
	`width
();

799 
tx
 -ğ
ËáWidth
 / 2;

800 
ty
 -ğ
tİWidth
 / 2;

801 
w
 +ğ
ËáWidth
 / 2 + (
rightWidth
 + 1) / 2;

802 
h
 +ğ
tİWidth
 / 2 + (
bÙtomWidth
 + 1) / 2;

804 
EBÜd”StyË
 
tİStyË
 = 
	`cŞÏp£dBÜd”StyË
(
tİV®
.
	`¡yË
());

805 
EBÜd”StyË
 
bÙtomStyË
 = 
	`cŞÏp£dBÜd”StyË
(
bÙtomV®
.
	`¡yË
());

806 
EBÜd”StyË
 
ËáStyË
 = 
	`cŞÏp£dBÜd”StyË
(
ËáV®
.
	`¡yË
());

807 
EBÜd”StyË
 
rightStyË
 = 
	`cŞÏp£dBÜd”StyË
(
rightV®
.
	`¡yË
());

809 
boŞ
 
»nd”Tİ
 = 
tİStyË
 > 
BHIDDEN
 && !
tİV®
.
	`isT¿n¥¬’t
();

810 
boŞ
 
»nd”BÙtom
 = 
bÙtomStyË
 > 
BHIDDEN
 && !
bÙtomV®
.
	`isT¿n¥¬’t
();

811 
boŞ
 
»nd”Leá
 = 
ËáStyË
 > 
BHIDDEN
 && !
ËáV®
.
	`isT¿n¥¬’t
();

812 
boŞ
 
»nd”Right
 = 
rightStyË
 > 
BHIDDEN
 && !
rightV®
.
	`isT¿n¥¬’t
();

816 
CŞÏp£dBÜd”s
 
bÜd”s
;

817 
bÜd”s
.
	`addBÜd”
(
tİV®
, 
BSTİ
, 
»nd”Tİ
, 
tx
, 
ty
,x + 
w
,y + 
tİWidth
, 
tİStyË
);

818 
bÜd”s
.
	`addBÜd”
(
bÙtomV®
, 
BSBÙtom
, 
»nd”BÙtom
, 
tx
, 
ty
 + 
h
 - 
bÙtomWidth
,x + 
w
,y + h, 
bÙtomStyË
);

819 
bÜd”s
.
	`addBÜd”
(
ËáV®
, 
BSLeá
, 
»nd”Leá
, 
tx
, 
ty
,x + 
ËáWidth
,y + 
h
, 
ËáStyË
);

820 
bÜd”s
.
	`addBÜd”
(
rightV®
, 
BSRight
, 
»nd”Right
, 
tx
 + 
w
 - 
rightWidth
, 
ty
,x + w,y + 
h
, 
rightStyË
);

822 
CŞÏp£dBÜd”
* 
bÜd”
 = 
bÜd”s
.
	`ÃxtBÜd”
(); border; border = borders.nextBorder()) {

823 ià(
bÜd”
->
bÜd”V®ue
 =ğ*
	`bË
()->
	`cu¼’tBÜd”StyË
())

824 
	`d¿wLšeFÜBoxSide
(
g¿phicsCÚ‹xt
, 
bÜd”
->
x1
, bÜd”->
y1
, bÜd”->
x2
, bÜd”->
y2
, bÜd”->
side
,

825 
bÜd”
->
bÜd”V®ue
.
	`cŞÜ
(), bÜd”->
¡yË
, 0, 0);

827 
	}
}

829 
	gR’d”TabËC–l
::
	$·štBackgroundsBehšdC–l
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
, 
R’d”Objeù
* 
backgroundObjeù
)

831 ià(!
	`shouldPaštW™hšRoÙ
(
·štInfo
))

834 ià(!
backgroundObjeù
)

837 ià(
	`¡yË
()->
	`visib™y
(è!ğ
VISIBLE
)

840 
R’d”TabË
* 
bËEÉ
 = 
	`bË
();

841 ià(!
bËEÉ
->
	`cŞÏp£BÜd”s
(è&& 
	`¡yË
()->
	`em±yC–ls
(è=ğ
HIDE
 && !
	`fœ¡Chd
())

844 ià(
backgroundObjeù
 !ğ
this
) {

845 
tx
 +ğ
	`x
();

846 
ty
 +ğ
	`y
();

849 
w
 = 
	`width
();

850 
h
 = 
	`height
();

852 
CŞÜ
 
c
 = 
backgroundObjeù
->
	`¡yË
()->
	`backgroundCŞÜ
();

853 cÚ¡ 
FlLay”
* 
bgLay”
 = 
backgroundObjeù
->
	`¡yË
()->
	`backgroundLay”s
();

855 ià(
bgLay”
->
	`hasImage
(è|| 
c
.
	`isV®id
()) {

858 
boŞ
 
shouldCl
 = 
backgroundObjeù
->
	`hasLay”
(è&& (backgroundObjeù =ğ
this
 || backgroundObjeù =ğ
	`·»Á
()è&& 
bËEÉ
->
	`cŞÏp£BÜd”s
();

859 ià(
shouldCl
) {

860 
IÁReù
 
	`şReù
(
tx
 + 
	`bÜd”Leá
(), 
ty
 + 
	`bÜd”Tİ
(),

861 
w
 - 
	`bÜd”Leá
(è- 
	`bÜd”Right
(), 
h
 - 
	`bÜd”Tİ
(è- 
	`bÜd”BÙtom
());

862 
·štInfo
.
cÚ‹xt
->
	`§ve
();

863 
·štInfo
.
cÚ‹xt
->
	`ş
(
şReù
);

865 
	`·štFlLay”s
(
·štInfo
, 
c
, 
bgLay”
, 
tx
, 
ty
, 
w
, 
h
, 
Compos™eSourûOv”
, 
backgroundObjeù
);

866 ià(
shouldCl
)

867 
·štInfo
.
cÚ‹xt
->
	`»¡Üe
();

869 
	}
}

871 
	gR’d”TabËC–l
::
	$·štBoxDecÜ©iÚs
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

873 ià(!
	`shouldPaštW™hšRoÙ
(
·štInfo
))

876 
R’d”TabË
* 
bËEÉ
 = 
	`bË
();

877 ià(!
bËEÉ
->
	`cŞÏp£BÜd”s
(è&& 
	`¡yË
()->
	`em±yC–ls
(è=ğ
HIDE
 && !
	`fœ¡Chd
())

880 
w
 = 
	`width
();

881 
h
 = 
	`height
();

883 ià(
	`¡yË
()->
	`boxShadow
())

884 
	`·štBoxShadow
(
·štInfo
.
cÚ‹xt
, 
tx
, 
ty
, 
w
, 
h
, 
	`¡yË
(), 
NÜm®
);

887 
	`·štBackgroundsBehšdC–l
(
·štInfo
, 
tx
, 
ty
, 
this
);

888 ià(
	`¡yË
()->
	`boxShadow
())

889 
	`·štBoxShadow
(
·štInfo
.
cÚ‹xt
, 
tx
, 
ty
, 
w
, 
h
, 
	`¡yË
(), 
In£t
);

891 ià(!
	`¡yË
()->
	`hasBÜd”
(è|| 
bËEÉ
->
	`cŞÏp£BÜd”s
())

894 
	`·štBÜd”
(
·štInfo
.
cÚ‹xt
, 
tx
, 
ty
, 
w
, 
h
, 
	`¡yË
());

895 
	}
}

897 
	gR’d”TabËC–l
::
	$·štMask
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

899 ià(
	`¡yË
()->
	`visib™y
(è!ğ
VISIBLE
 || 
·štInfo
.
pha£
 !ğ
PaštPha£Mask
)

902 
R’d”TabË
* 
bËEÉ
 = 
	`bË
();

903 ià(!
bËEÉ
->
	`cŞÏp£BÜd”s
(è&& 
	`¡yË
()->
	`em±yC–ls
(è=ğ
HIDE
 && !
	`fœ¡Chd
())

906 
w
 = 
	`width
();

907 
h
 = 
	`height
();

909 
	`·štMaskImages
(
·štInfo
, 
tx
, 
ty
, 
w
, 
h
);

910 
	}
}

	@RenderTableCell.h

25 #iâdeà
R’d”TabËC–l_h


26 
	#R’d”TabËC–l_h


	)

28 
	~"R’d”TabËSeùiÚ.h
"

30 
Çme¥aû
 
	gWebCÜe
 {

32 şas 
	cR’d”TabËC–l
 : 
public
 
R’d”Block
 {

33 
public
:

34 
R’d”TabËC–l
(
Node
*);

37 
ûÎIndex
() const {  0; }

38 
£tC–lIndex
() { }

40 
cŞS·n
(ècÚ¡ {  
	gm_cŞumnS·n
; }

41 
£tCŞS·n
(
c
è{ 
	gm_cŞumnS·n
 = c; }

43 
rowS·n
(ècÚ¡ {  
	gm_rowS·n
; }

44 
£tRowS·n
(
r
è{ 
	gm_rowS·n
 =„; }

46 
cŞ
(ècÚ¡ {  
	gm_cŞumn
; }

47 
£tCŞ
(
cŞ
è{ 
	gm_cŞumn
 = col; }

48 
row
(ècÚ¡ {  
	gm_row
; }

49 
£tRow
(
row
è{ 
	gm_row
 =„ow; }

51 
R’d”TabËSeùiÚ
* 
£ùiÚ
(ècÚ¡ {  
toR’d”TabËSeùiÚ
(
·»Á
()->parent()); }

52 
R’d”TabË
* 
bË
(ècÚ¡ {  
toR’d”TabË
(
·»Á
()->parent()->parent()); }

54 
L’gth
 
¡yËOrCŞWidth
() const;

56 
vœtu®
 
ÿlcP»fWidths
();

58 
upd©eWidth
();

60 
bÜd”Leá
() const;

61 
bÜd”Right
() const;

62 
bÜd”Tİ
() const;

63 
bÜd”BÙtom
() const;

65 
bÜd”H®fLeá
(
boŞ
 
ou‹r
) const;

66 
bÜd”H®fRight
(
boŞ
 
ou‹r
) const;

67 
bÜd”H®fTİ
(
boŞ
 
ou‹r
) const;

68 
bÜd”H®fBÙtom
(
boŞ
 
ou‹r
) const;

70 
CŞÏp£dBÜd”V®ue
 
cŞÏp£dLeáBÜd”
(
boŞ
 
¹l
) const;

71 
CŞÏp£dBÜd”V®ue
 
cŞÏp£dRightBÜd”
(
boŞ
 
¹l
) const;

72 
CŞÏp£dBÜd”V®ue
 
cŞÏp£dTİBÜd”
() const;

73 
CŞÏp£dBÜd”V®ue
 
cŞÏp£dBÙtomBÜd”
() const;

75 
	gVeùÜ
<
	tCŞÏp£dBÜd”V®ue
, 100> 
	tCŞÏp£dBÜd”StyËs
;

76 
cŞËùBÜd”StyËs
(
CŞÏp£dBÜd”StyËs
&) const;

77 
sÜtBÜd”StyËs
(
CŞÏp£dBÜd”StyËs
&);

79 
vœtu®
 
upd©eFromEËm’t
();

81 
vœtu®
 
Ïyout
();

83 
vœtu®
 
·št
(
PaštInfo
&, 
tx
, 
ty
);

85 
·štBackgroundsBehšdC–l
(
PaštInfo
&, 
tx
, 
ty
, 
R’d”Objeù
* 
backgroundObjeù
);

87 
vœtu®
 
ba£lšePos™iÚ
(
boŞ
 
fœ¡Lše
 = 
çl£
, boŞ 
isRoÙLšeBox
 = false) const;

89 
£tIÁršsicPaddšgTİ
(
p
è{ 
	gm_šŒšsicPaddšgTİ
 =…; }

90 
£tIÁršsicPaddšgBÙtom
(
p
è{ 
	gm_šŒšsicPaddšgBÙtom
 =…; }

91 
£tIÁršsicPaddšg
(
tİ
, 
bÙtom
è{ 
£tIÁršsicPaddšgTİ
Ñİ); 
£tIÁršsicPaddšgBÙtom
(bottom); }

92 
ş—rIÁršsicPaddšg
(è{ 
£tIÁršsicPaddšg
(0, 0); }

94 
šŒšsicPaddšgTİ
(ècÚ¡ {  
	gm_šŒšsicPaddšgTİ
; }

95 
šŒšsicPaddšgBÙtom
(ècÚ¡ {  
	gm_šŒšsicPaddšgBÙtom
; }

97 
vœtu®
 
·ddšgTİ
(
boŞ
 
šşudeIÁršsicPaddšg
 = 
Œue
) const;

98 
vœtu®
 
·ddšgBÙtom
(
boŞ
 
šşudeIÁršsicPaddšg
 = 
Œue
) const;

100 
vœtu®
 
£tOv”rideSize
();

102 
boŞ
 
hasVisibËOv”æow
(ècÚ¡ {  
	gm_ov”æow
; }

104 
	g´Ùeùed
:

105 
vœtu®
 
¡yËWlChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
* 
ÃwStyË
);

106 
vœtu®
 
¡yËDidChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
);

108 
	g´iv©e
:

109 
vœtu®
 cÚ¡ * 
»nd”Name
(ècÚ¡ {  
isAnÚymous
() ? "RenderTableCell (anonymous)" : "RenderTableCell"; }

111 
vœtu®
 
boŞ
 
isTabËC–l
(ècÚ¡ {  
	gŒue
; }

113 
vœtu®
 
de¡roy
();

115 
vœtu®
 
boŞ
 
»quœesLay”
(ècÚ¡ {  
isPos™iÚed
(è|| 
isT¿n¥¬’t
(è|| 
hasOv”æowCl
(è|| 
hasT¿nsfÜm
(è|| 
hasMask
(è|| 
hasReæeùiÚ
(); }

117 
vœtu®
 
ÿlcWidth
();

119 
vœtu®
 
·štBoxDecÜ©iÚs
(
PaštInfo
&, 
tx
, 
ty
);

120 
vœtu®
 
·štMask
(
PaštInfo
&, 
tx
, 
ty
);

122 
vœtu®
 
IÁSize
 
off£tFromCÚš”
(
R’d”Objeù
*, cÚ¡ 
IÁPošt
&) const;

123 
vœtu®
 
IÁReù
 
ş³dOv”æowReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
);

124 
vœtu®
 
compu‹ReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
IÁReù
&, 
boŞ
 
fixed
 = 
çl£
);

126 
·štCŞÏp£dBÜd”
(
G¿phicsCÚ‹xt
*, 
x
, 
y
, 
w
, 
h
);

128 
	gm_row
;

129 
	gm_cŞumn
;

130 
	gm_rowS·n
;

131 
	gm_cŞumnS·n
;

132 
	gm_šŒšsicPaddšgTİ
;

133 
	gm_šŒšsicPaddšgBÙtom
;

134 
	gm_³rûÁageHeight
;

137 
šlše
 
R’d”TabËC–l
* 
	$toR’d”TabËC–l
(
R’d”Objeù
* 
objeù
)

139 
	`ASSERT
(!
objeù
 || objeù->
	`isTabËC–l
());

140  
¡©ic_ÿ¡
<
R’d”TabËC–l
*>(
objeù
);

141 
	}
}

143 
šlše
 cÚ¡ 
R’d”TabËC–l
* 
	$toR’d”TabËC–l
(cÚ¡ 
R’d”Objeù
* 
objeù
)

145 
	`ASSERT
(!
objeù
 || objeù->
	`isTabËC–l
());

146  
¡©ic_ÿ¡
<cÚ¡ 
R’d”TabËC–l
*>(
objeù
);

147 
	}
}

150 
toR’d”TabËC–l
(cÚ¡ 
R’d”TabËC–l
*);

	@RenderTableCol.cpp

26 
	~"cÚfig.h
"

27 
	~"R’d”TabËCŞ.h
"

29 
	~"CachedImage.h
"

30 
	~"HTMLNames.h
"

31 
	~"HTMLTabËCŞEËm’t.h
"

32 
	~"R’d”TabË.h
"

34 
Çme¥aû
 
	gWebCÜe
 {

36 
usšg
 
Çme¥aû
 
	gHTMLNames
;

38 
	gR’d”TabËCŞ
::
R’d”TabËCŞ
(
Node
* 
node
)

39 : 
R’d”Box
(
node
)

40 , 
m_¥ª
(1)

43 
£tIÆše
(
Œue
);

44 
upd©eFromEËm’t
();

47 
	gR’d”TabËCŞ
::
upd©eFromEËm’t
()

49 
ŞdS·n
 = 
m_¥ª
;

50 
Node
* 
	gn
 = 
node
();

51 ià(
	gn
 && (n->
hasTagName
(
cŞTag
è||‚->hasTagName(
cŞgroupTag
))) {

52 
HTMLTabËCŞEËm’t
* 
	gtc
 = 
¡©ic_ÿ¡
<HTMLTabËCŞEËm’t*>(
n
);

53 
	gm_¥ª
 = 
tc
->
¥ª
();

55 
	gm_¥ª
 = !(
¡yË
(è&& styË()->
di¥Ïy
(è=ğ
TABLE_COLUMN_GROUP
);

56 ià(
	gm_¥ª
 !ğ
ŞdS·n
 && 
¡yË
(è&& 
·»Á
())

57 
£tN“dsLayoutAndP»fWidthsReÿlc
();

60 
boŞ
 
	gR’d”TabËCŞ
::
isChdAÎowed
(
R’d”Objeù
* 
chd
, 
R’d”StyË
* 
¡yË
) const

62  !
	gchd
->
isText
(è&& 
	g¡yË
 && (¡yË->
di¥Ïy
(è=ğ
TABLE_COLUMN
);

65 
boŞ
 
	gR’d”TabËCŞ
::
ÿnHaveChd»n
() const

69  
¡yË
()->
di¥Ïy
(è=ğ
TABLE_COLUMN_GROUP
;

72 
IÁReù
 
	gR’d”TabËCŞ
::
ş³dOv”æowReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
)

79 
R’d”TabË
* 
·»ÁTabË
 = 
bË
();

80 ià(!
	g·»ÁTabË
)

81  
IÁReù
();

82  
	g·»ÁTabË
->
ş³dOv”æowReùFÜR•ašt
(
»·štCÚš”
);

85 
	gR’d”TabËCŞ
::
imageChªged
(
W¿µedImagePŒ
, cÚ¡ 
IÁReù
*)

88 
»·št
();

91 
	gR’d”TabËCŞ
::
ÿlcP»fWidths
()

93 
£tP»fWidthsDœty
(
çl£
);

95 
R’d”Objeù
* 
	gchd
 = 
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
())

96 
chd
->
£tP»fWidthsDœty
(
çl£
);

99 
R’d”TabË
* 
	gR’d”TabËCŞ
::
bË
() const

101 
R’d”Objeù
* 
bË
 = 
·»Á
();

102 ià(
	gbË
 && !bË->
isTabË
())

103 
	gbË
 = 
bË
->
·»Á
();

104  
	gbË
 &&abË->
isTabË
(è? 
toR’d”TabË
(
bË
) : 0;

	@RenderTableCol.h

26 #iâdeà
R’d”TabËCŞ_h


27 
	#R’d”TabËCŞ_h


	)

29 
	~"R’d”Box.h
"

31 
Çme¥aû
 
	gWebCÜe
 {

33 
şass
 
	gR’d”TabË
;

35 şas 
	cR’d”TabËCŞ
 : 
public
 
R’d”Box
 {

36 
public
:

37 
R’d”TabËCŞ
(
Node
*);

39 cÚ¡ 
R’d”ObjeùChdLi¡
* 
chd»n
(ècÚ¡ {  &
	gm_chd»n
; }

40 
R’d”ObjeùChdLi¡
* 
chd»n
(è{  &
	gm_chd»n
; }

42 
vœtu®
 
ÿlcP»fWidths
();

44 
¥ª
(ècÚ¡ {  
	gm_¥ª
; }

45 
£tS·n
(
¥ª
è{ 
	gm_¥ª
 = span; }

47 
	g´iv©e
:

48 
vœtu®
 
R’d”ObjeùChdLi¡
* 
vœtu®Chd»n
(è{  
chd»n
(); }

49 
vœtu®
 cÚ¡ 
R’d”ObjeùChdLi¡
* 
vœtu®Chd»n
(ècÚ¡ {  
chd»n
(); }

51 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderTableCol"; }

52 
vœtu®
 
boŞ
 
isTabËCŞ
(ècÚ¡ {  
	gŒue
; }

53 
vœtu®
 
lšeHeight
(
boŞ
) const {  0; }

54 
vœtu®
 
upd©eFromEËm’t
();

56 
vœtu®
 
boŞ
 
isChdAÎowed
(
R’d”Objeù
*, 
R’d”StyË
*) const;

57 
vœtu®
 
boŞ
 
ÿnHaveChd»n
() const;

58 
vœtu®
 
boŞ
 
»quœesLay”
(ècÚ¡ {  
	gçl£
; }

60 
vœtu®
 
IÁReù
 
ş³dOv”æowReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
);

61 
vœtu®
 
imageChªged
(
W¿µedImagePŒ
, cÚ¡ 
IÁReù
* = 0);

63 
R’d”TabË
* 
bË
() const;

65 
R’d”ObjeùChdLi¡
 
	gm_chd»n
;

66 
	gm_¥ª
;

69 
šlše
 
R’d”TabËCŞ
* 
	$toR’d”TabËCŞ
(
R’d”Objeù
* 
objeù
)

71 
	`ASSERT
(!
objeù
 || objeù->
	`isTabËCŞ
());

72  
¡©ic_ÿ¡
<
R’d”TabËCŞ
*>(
objeù
);

73 
	}
}

75 
šlše
 cÚ¡ 
R’d”TabËCŞ
* 
	$toR’d”TabËCŞ
(cÚ¡ 
R’d”Objeù
* 
objeù
)

77 
	`ASSERT
(!
objeù
 || objeù->
	`isTabËCŞ
());

78  
¡©ic_ÿ¡
<cÚ¡ 
R’d”TabËCŞ
*>(
objeù
);

79 
	}
}

82 
toR’d”TabËCŞ
(cÚ¡ 
R’d”TabËCŞ
*);

	@RenderTableRow.cpp

25 
	~"cÚfig.h
"

26 
	~"R’d”TabËRow.h
"

28 
	~"CachedImage.h
"

29 
	~"Docum’t.h
"

30 
	~"HTMLNames.h
"

31 
	~"R’d”TabËC–l.h
"

32 
	~"R’d”V›w.h
"

34 
Çme¥aû
 
	gWebCÜe
 {

36 
usšg
 
Çme¥aû
 
	gHTMLNames
;

38 
	gR’d”TabËRow
::
R’d”TabËRow
(
Node
* 
node
)

39 : 
R’d”Box
(
node
)

42 
£tIÆše
(
çl£
);

45 
	gR’d”TabËRow
::
de¡roy
()

47 
R’d”TabËSeùiÚ
* 
»ÿlcSeùiÚ
 = 
£ùiÚ
();

49 
	gR’d”Box
::
de¡roy
();

51 ià(
	g»ÿlcSeùiÚ
)

52 
	g»ÿlcSeùiÚ
->
£tN“dsC–lReÿlc
();

55 
	gR’d”TabËRow
::
¡yËWlChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ÃwStyË
)

57 ià(
£ùiÚ
(è&& 
¡yË
(è&& styË()->
height
(è!ğ
ÃwStyË
->height())

58 
£ùiÚ
()->
£tN“dsC–lReÿlc
();

60 
ASSERT
(
ÃwStyË
->
di¥Ïy
(è=ğ
TABLE_ROW
);

62 
	gR’d”Box
::
¡yËWlChªge
(
diff
, 
ÃwStyË
);

65 
	gR’d”TabËRow
::
addChd
(
R’d”Objeù
* 
chd
, R’d”Objeù* 
befÜeChd
)

68 ià(!
	gbefÜeChd
 && 
isAá”CÚ‹Á
(
Ï¡Chd
()))

69 
	gbefÜeChd
 = 
Ï¡Chd
();

71 ià(!
	gchd
->
isTabËC–l
()) {

72 
R’d”Objeù
* 
	gÏ¡
 = 
befÜeChd
;

73 ià(!
	gÏ¡
)

74 
	gÏ¡
 = 
Ï¡Chd
();

75 ià(
	gÏ¡
 &&†a¡->
isAnÚymous
(è&&†a¡->
isTabËC–l
()) {

76 
	gÏ¡
->
addChd
(
chd
);

81 ià(
	gÏ¡
 && !Ï¡->
isTabËC–l
(è&&†a¡->
·»Á
(è&&†a¡->·»Á()->
isAnÚymous
()) {

82 
	gÏ¡
->
·»Á
()->
addChd
(
chd
, 
befÜeChd
);

86 
R’d”TabËC–l
* 
	gûÎ
 = 
Ãw
 (
»nd”A»Ç
()èR’d”TabËC–l(
docum’t
() );

87 
	gRefPŒ
<
	gR’d”StyË
> 
	gÃwStyË
 = 
R’d”StyË
::
ü—‹
();

88 
	gÃwStyË
->
šh”™From
(
¡yË
());

89 
	gÃwStyË
->
£tDi¥Ïy
(
TABLE_CELL
);

90 
	gûÎ
->
£tStyË
(
ÃwStyË
.
»Ëa£
());

91 
addChd
(
ûÎ
, 
befÜeChd
);

92 
	gûÎ
->
addChd
(
chd
);

97 
	gbefÜeChd
 && befÜeChd->
·»Á
(è!ğ
this
)

98 
befÜeChd
 = befÜeChd->
·»Á
();

100 
R’d”TabËC–l
* 
	gûÎ
 = 
toR’d”TabËC–l
(
chd
);

103 ià(
·»Á
())

104 
£ùiÚ
()->
addC–l
(
ûÎ
, 
this
);

106 
ASSERT
(!
befÜeChd
 || befÜeChd->
isTabËC–l
());

107 
	gR’d”Box
::
addChd
(
ûÎ
, 
befÜeChd
);

109 ià(
	gbefÜeChd
 || 
ÃxtSiblšg
())

110 
£ùiÚ
()->
£tN“dsC–lReÿlc
();

113 
	gR’d”TabËRow
::
Ïyout
()

115 
ASSERT
(
ÃedsLayout
());

118 
LayoutS‹Mašš”
 
¡©ePush”
(
v›w
(), 
this
, 
IÁSize
());

120 
R’d”Objeù
* 
	gchd
 = 
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
()) {

121 ià(
chd
->
isTabËC–l
()) {

122 
R’d”TabËC–l
* 
ûÎ
 = 
toR’d”TabËC–l
(
chd
);

123 ià(
	gchd
->
ÃedsLayout
()) {

124 
	gûÎ
->
ÿlcV”tiÿlM¬gšs
();

125 
	gûÎ
->
Ïyout
();

135 ià(
£lfN“dsLayout
(è&& 
checkFÜR•aštDuršgLayout
()) {

136 
R’d”Objeù
* 
	gchd
 = 
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
()) {

137 ià(
chd
->
isTabËC–l
())

138 
chd
->
»·št
();

142 
	g¡©ePush”
.
pİ
();

143 
£tN“dsLayout
(
çl£
);

146 
IÁReù
 
	gR’d”TabËRow
::
ş³dOv”æowReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
)

148 
ASSERT
(
·»Á
());

150 ià(
	g»·štCÚš”
 =ğ
this
)

151  
R’d”Box
::
ş³dOv”æowReùFÜR•ašt
(
»·štCÚš”
);

157 ià(
R’d”TabË
* 
	g·»ÁTabË
 = 
bË
())

158  
·»ÁTabË
->
ş³dOv”æowReùFÜR•ašt
(
»·štCÚš”
);

160  
IÁReù
();

164 
boŞ
 
	gR’d”TabËRow
::
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
& 
»que¡
, 
H™Te¡ResuÉ
& 
»suÉ
, 
x
, 
y
, 
tx
, 
ty
, 
H™Te¡AùiÚ
 
aùiÚ
)

168 
R’d”Objeù
* 
	gchd
 = 
Ï¡Chd
(); chd; chd = 
chd
->
´eviousSiblšg
()) {

173 ià(
chd
->
isTabËC–l
(è&& !
toR’d”Box
(chd)->
hasS–fPaštšgLay”
(è&& chd->
nodeAtPošt
(
»que¡
, 
»suÉ
, 
x
, 
y
, 
tx
, 
ty
, 
aùiÚ
)) {

174 
upd©eH™Te¡ResuÉ
(
»suÉ
, 
IÁPošt
(
x
 - 
tx
, 
y
 - 
ty
));

175  
	gŒue
;

179  
	gçl£
;

182 
	gR’d”TabËRow
::
·št
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

184 
ASSERT
(
hasS–fPaštšgLay”
());

185 ià(!
Ïy”
())

187 
R’d”Objeù
* 
	gchd
 = 
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
()) {

188 ià(
chd
->
isTabËC–l
()) {

190 ià(
·štInfo
.
pha£
 =ğ
PaštPha£BlockBackground
 ||…aštInfo.pha£ =ğ
PaštPha£ChdBlockBackground
) {

191 
R’d”TabËC–l
* 
ûÎ
 = 
toR’d”TabËC–l
(
chd
);

192 
	gûÎ
->
·štBackgroundsBehšdC–l
(
·štInfo
, 
tx
, 
ty
, 
this
);

194 ià(!
toR’d”Box
(
chd
)->
hasS–fPaštšgLay”
())

195 
	gchd
->
·št
(
·štInfo
, 
tx
, 
ty
);

200 
	gR’d”TabËRow
::
imageChªged
(
W¿µedImagePŒ
, cÚ¡ 
IÁReù
*)

203 
»·št
();

	@RenderTableRow.h

25 #iâdeà
R’d”TabËRow_h


26 
	#R’d”TabËRow_h


	)

28 
	~"R’d”TabËSeùiÚ.h
"

30 
Çme¥aû
 
	gWebCÜe
 {

32 şas 
	cR’d”TabËRow
 : 
public
 
R’d”Box
 {

33 
public
:

34 
R’d”TabËRow
(
Node
*);

36 cÚ¡ 
R’d”ObjeùChdLi¡
* 
chd»n
(ècÚ¡ {  &
	gm_chd»n
; }

37 
R’d”ObjeùChdLi¡
* 
chd»n
(è{  &
	gm_chd»n
; }

39 
R’d”TabËSeùiÚ
* 
£ùiÚ
(ècÚ¡ {  
toR’d”TabËSeùiÚ
(
·»Á
()); }

40 
R’d”TabË
* 
bË
(ècÚ¡ {  
toR’d”TabË
(
·»Á
()->parent()); }

42 
	g´iv©e
:

43 
vœtu®
 
R’d”ObjeùChdLi¡
* 
vœtu®Chd»n
(è{  
chd»n
(); }

44 
vœtu®
 cÚ¡ 
R’d”ObjeùChdLi¡
* 
vœtu®Chd»n
(ècÚ¡ {  
chd»n
(); }

46 
vœtu®
 cÚ¡ * 
»nd”Name
(ècÚ¡ {  
isAnÚymous
() ? "RenderTableRow (anonymous)" : "RenderTableRow"; }

48 
vœtu®
 
boŞ
 
isTabËRow
(ècÚ¡ {  
	gŒue
; }

50 
vœtu®
 
de¡roy
();

52 
vœtu®
 
addChd
(
R’d”Objeù
* 
chd
, R’d”Objeù* 
befÜeChd
 = 0);

53 
vœtu®
 
lšeHeight
(
boŞ
, bool) const {  0; }

54 
vœtu®
 
Ïyout
();

55 
vœtu®
 
IÁReù
 
ş³dOv”æowReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
);

56 
vœtu®
 
boŞ
 
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, 
x
, 
y
, 
tx
, 
ty
, 
H™Te¡AùiÚ
);

59 
vœtu®
 
boŞ
 
»quœesLay”
(ècÚ¡ {  
isT¿n¥¬’t
(è|| 
hasOv”æowCl
(è|| 
hasT¿nsfÜm
(è|| 
hasMask
(); }

61 
vœtu®
 
·št
(
PaštInfo
&, 
tx
, 
ty
);

63 
vœtu®
 
imageChªged
(
W¿µedImagePŒ
, cÚ¡ 
IÁReù
* = 0);

65 
vœtu®
 
¡yËWlChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
* 
ÃwStyË
);

67 
R’d”ObjeùChdLi¡
 
	gm_chd»n
;

70 
šlše
 
R’d”TabËRow
* 
	$toR’d”TabËRow
(
R’d”Objeù
* 
objeù
)

72 
	`ASSERT
(!
objeù
 || objeù->
	`isTabËRow
());

73  
¡©ic_ÿ¡
<
R’d”TabËRow
*>(
objeù
);

74 
	}
}

76 
šlše
 cÚ¡ 
R’d”TabËRow
* 
	$toR’d”TabËRow
(cÚ¡ 
R’d”Objeù
* 
objeù
)

78 
	`ASSERT
(!
objeù
 || objeù->
	`isTabËRow
());

79  
¡©ic_ÿ¡
<cÚ¡ 
R’d”TabËRow
*>(
objeù
);

80 
	}
}

83 
toR’d”TabËRow
(cÚ¡ 
R’d”TabËRow
*);

	@RenderTableSection.cpp

26 
	~"cÚfig.h
"

27 
	~"R’d”TabËSeùiÚ.h
"

29 
	~"CachedImage.h
"

30 
	~"Docum’t.h
"

31 
	~"HTMLNames.h
"

32 
	~"R’d”TabËC–l.h
"

33 
	~"R’d”TabËCŞ.h
"

34 
	~"R’d”TabËRow.h
"

35 
	~"R’d”V›w.h
"

36 
	~<lim™s
>

37 
	~<wtf/VeùÜ.h
>

39 
usšg
 
Çme¥aû
 
	g¡d
;

41 
Çme¥aû
 
	gWebCÜe
 {

43 
usšg
 
Çme¥aû
 
	gHTMLNames
;

45 
šlše
 
£tRowHeightToRowStyËHeightIfNÙR–©ive
(
R’d”TabËSeùiÚ
::
RowSŒuù
* 
row
)

47 
ASSERT
(
row
 &&„ow->
rowR’d””
);

48 
	grow
->
	gheight
 = 
row
->
rowR’d””
->
¡yË
()->
height
();

49 ià(
	grow
->
	gheight
.
isR–©ive
())

50 
	grow
->
	gheight
 = 
L’gth
();

53 
	gR’d”TabËSeùiÚ
::
R’d”TabËSeùiÚ
(
Node
* 
node
)

54 : 
R’d”Box
(
node
)

55 , 
m_gridRows
(0)

56 , 
m_cCŞ
(0)

57 , 
m_cRow
(-1)

58 , 
m_ou‹rBÜd”Leá
(0)

59 , 
m_ou‹rBÜd”Right
(0)

60 , 
m_ou‹rBÜd”Tİ
(0)

61 , 
m_ou‹rBÜd”BÙtom
(0)

62 , 
m_ÃedsC–lReÿlc
(
çl£
)

63 , 
m_hasOv”æowšgC–l
(
çl£
)

66 
£tIÆše
(
çl£
);

69 
	gR’d”TabËSeùiÚ
::~
R’d”TabËSeùiÚ
()

71 
ş—rGrid
();

74 
	gR’d”TabËSeùiÚ
::
de¡roy
()

76 
R’d”TabË
* 
»ÿlcTabË
 = 
bË
();

78 
	gR’d”Box
::
de¡roy
();

82 ià(
	g»ÿlcTabË
)

83 
	g»ÿlcTabË
->
£tN“dsSeùiÚReÿlc
();

86 
	gR’d”TabËSeùiÚ
::
addChd
(
R’d”Objeù
* 
chd
, R’d”Objeù* 
befÜeChd
)

89 ià(!
	gbefÜeChd
 && 
isAá”CÚ‹Á
(
Ï¡Chd
()))

90 
	gbefÜeChd
 = 
Ï¡Chd
();

92 ià(!
	gchd
->
isTabËRow
()) {

93 
R’d”Objeù
* 
	gÏ¡
 = 
befÜeChd
;

94 ià(!
	gÏ¡
)

95 
	gÏ¡
 = 
Ï¡Chd
();

96 ià(
	gÏ¡
 &&†a¡->
isAnÚymous
()) {

97 
	gÏ¡
->
addChd
(
chd
);

103 
R’d”Objeù
* 
	gÏ¡Box
 = 
Ï¡
;

104 
	gÏ¡Box
 &&†a¡Box->
·»Á
()->
isAnÚymous
(è&& !Ï¡Box->
isTabËRow
())

105 
	gÏ¡Box
 = 
Ï¡Box
->
·»Á
();

106 ià(
	gÏ¡Box
 &&†a¡Box->
isAnÚymous
()) {

107 
	gÏ¡Box
->
addChd
(
chd
, 
befÜeChd
);

111 
R’d”Objeù
* 
	grow
 = 
Ãw
 (
»nd”A»Ç
()è
R’d”TabËRow
(
docum’t
() );

112 
	gRefPŒ
<
	gR’d”StyË
> 
	gÃwStyË
 = 
R’d”StyË
::
ü—‹
();

113 
	gÃwStyË
->
šh”™From
(
¡yË
());

114 
	gÃwStyË
->
£tDi¥Ïy
(
TABLE_ROW
);

115 
	grow
->
£tStyË
(
ÃwStyË
.
»Ëa£
());

116 
addChd
(
row
, 
befÜeChd
);

117 
	grow
->
addChd
(
chd
);

121 ià(
	gbefÜeChd
)

122 
£tN“dsC–lReÿlc
();

124 ++
	gm_cRow
;

125 
	gm_cCŞ
 = 0;

128 ià(!
’su»Rows
(
m_cRow
 + 1))

131 
	gm_grid
[
m_cRow
].
	growR’d””
 = 
toR’d”TabËRow
(
chd
);

133 ià(!
	gbefÜeChd
)

134 
£tRowHeightToRowStyËHeightIfNÙR–©ive
(&
m_grid
[
m_cRow
]);

137 
	gbefÜeChd
 && befÜeChd->
·»Á
(è!ğ
this
)

138 
befÜeChd
 = befÜeChd->
·»Á
();

140 
ASSERT
(!
befÜeChd
 || befÜeChd->
isTabËRow
());

141 
	gR’d”Box
::
addChd
(
chd
, 
befÜeChd
);

144 
	gR’d”TabËSeùiÚ
::
»moveChd
(
R’d”Objeù
* 
ŞdChd
)

146 
£tN“dsC–lReÿlc
();

147 
	gR’d”Box
::
»moveChd
(
ŞdChd
);

150 
boŞ
 
	gR’d”TabËSeùiÚ
::
’su»Rows
(
numRows
)

152 
nRows
 = 
m_gridRows
;

153 ià(
	gnumRows
 > 
	gnRows
) {

154 ià(
	gnumRows
 > 
	g¡©ic_ÿ¡
<>(
	gm_grid
.
size
())) {

155 
size_t
 
	gmaxSize
 = 
num”ic_lim™s
<size_t>::
max
(è/ (
RowSŒuù
);

156 ià(
	g¡©ic_ÿ¡
<
	gsize_t
>(
	gnumRows
è> 
	gmaxSize
)

157  
	gçl£
;

158 
	gm_grid
.
grow
(
numRows
);

160 
	gm_gridRows
 = 
numRows
;

161 
	gnCŞs
 = 
max
(1, 
bË
()->
numEffCŞs
());

162 
C–lSŒuù
 
	gem±yC–lSŒuù
;

163 
	gem±yC–lSŒuù
.
	gûÎ
 = 0;

164 
	gem±yC–lSŒuù
.
	gšCŞS·n
 = 
çl£
;

165 
	gr
 = 
nRows
;„ < 
	gnumRows
;„++) {

166 
	gm_grid
[
r
].
	grow
 = 
Ãw
 
Row
(
nCŞs
);

167 
	gm_grid
[
r
].
	grow
->
fl
(
em±yC–lSŒuù
);

168 
	gm_grid
[
r
].
	growR’d””
 = 0;

169 
	gm_grid
[
r
].
	gba£lše
 = 0;

170 
	gm_grid
[
r
].
	gheight
 = 
L’gth
();

174  
	gŒue
;

177 
	gR’d”TabËSeùiÚ
::
addC–l
(
R’d”TabËC–l
* 
ûÎ
, 
R’d”TabËRow
* 
row
)

179 
	grS·n
 = 
ûÎ
->
rowS·n
();

180 
	gcS·n
 = 
ûÎ
->
cŞS·n
();

181 
	gVeùÜ
<
	gR’d”TabË
::
CŞumnSŒuù
>& 
cŞumns
 = 
bË
()->columns();

182 
	gnCŞs
 = 
cŞumns
.
size
();

191 
	gm_cCŞ
 < 
	gnCŞs
 && (
ûÎAt
(
m_cRow
, 
m_cCŞ
).
	gûÎ
 || c–lAt(m_cRow, m_cCŞ).
	gšCŞS·n
))

192 
	gm_cCŞ
++;

194 ià(
	grS·n
 == 1) {

196 
L’gth
 
height
 = 
ûÎ
->
¡yË
()->height();

197 ià(
	gheight
.
isPos™ive
(è|| (height.
isR–©ive
(è&& height.
v®ue
() >= 0)) {

198 
L’gth
 
cRowHeight
 = 
m_grid
[
m_cRow
].
height
;

199 
	gheight
.
ty³
()) {

200 
	gP”ûÁ
:

201 ià(!(
cRowHeight
.
isP”ûÁ
()) ||

202 (
cRowHeight
.
isP”ûÁ
(è&& cRowHeight.
¿wV®ue
(è< 
height
.rawValue()))

203 
m_grid
[
m_cRow
].
height
 = height;

205 
	gFixed
:

206 ià(
cRowHeight
.
ty³
(è< 
P”ûÁ
 ||

207 (
cRowHeight
.
isFixed
(è&& cRowHeight.
v®ue
(è< 
height
.value()))

208 
m_grid
[
m_cRow
].
height
 = height;

210 
	gR–©ive
:

218 ià(!
’su»Rows
(
m_cRow
 + 
rS·n
))

221 
	gm_grid
[
m_cRow
].
	growR’d””
 = 
row
;

223 
	gcŞ
 = 
m_cCŞ
;

225 
C–lSŒuù
 
	gcu¼’tC–l
;

226 
	gcu¼’tC–l
.
	gûÎ
 = 
ûÎ
;

227 
	gcu¼’tC–l
.
	gšCŞS·n
 = 
çl£
;

228 
	gcS·n
) {

229 
	gcu¼’tS·n
;

230 ià(
	gm_cCŞ
 >ğ
nCŞs
) {

231 
bË
()->
­³ndCŞumn
(
cS·n
);

232 
	gcu¼’tS·n
 = 
cS·n
;

234 ià(
	gcS·n
 < 
	gcŞumns
[
m_cCŞ
].
	g¥ª
)

235 
bË
()->
¥l™CŞumn
(
m_cCŞ
, 
cS·n
);

236 
	gcu¼’tS·n
 = 
cŞumns
[
m_cCŞ
].
¥ª
;

239 
	gr
 = 0;„ < 
	grS·n
;„++) {

240 
	gC–lSŒuù
& 
	gc
 = 
ûÎAt
(
m_cRow
 + 
r
, 
m_cCŞ
);

241 ià(!
	gc
.
	gûÎ
)

242 
	gc
.
	gûÎ
 = 
cu¼’tC–l
.
ûÎ
;

243 ià(
	gcu¼’tC–l
.
	gšCŞS·n
)

244 
	gc
.
	gšCŞS·n
 = 
Œue
;

246 
	gm_cCŞ
++;

247 
	gcS·n
 -ğ
cu¼’tS·n
;

248 
	gcu¼’tC–l
.
	gûÎ
 = 0;

249 
	gcu¼’tC–l
.
	gšCŞS·n
 = 
Œue
;

251 
	gûÎ
->
£tRow
(
m_cRow
);

252 
	gûÎ
->
£tCŞ
(
bË
()->
effCŞToCŞ
(
cŞ
));

255 
	gR’d”TabËSeùiÚ
::
£tC–lWidths
()

257 
VeùÜ
<>& 
cŞumnPos
 = 
bË
()->
cŞumnPos™iÚs
();

259 
LayoutS‹Mašš”
 
¡©ePush”
(
v›w
());

261 
	gi
 = 0; i < 
	gm_gridRows
; i++) {

262 
	gRow
& 
	grow
 = *
m_grid
[
i
].
row
;

263 
	gcŞs
 = 
row
.
size
();

264 
	gj
 = 0; j < 
	gcŞs
; j++) {

265 
C–lSŒuù
 
	gcu¼’t
 = 
row
[
j
];

266 
R’d”TabËC–l
* 
	gûÎ
 = 
cu¼’t
.
ûÎ
;

268 ià(!
	gûÎ
)

270 
	g’dCŞ
 = 
j
;

271 
	gc¥ª
 = 
ûÎ
->
cŞS·n
();

272 
	gc¥ª
 && 
	g’dCŞ
 < 
	gcŞs
) {

273 
	gc¥ª
 -ğ
bË
()->
cŞumns
()[
’dCŞ
].
¥ª
;

274 
	g’dCŞ
++;

276 
	gw
 = 
cŞumnPos
[
’dCŞ
] - cŞumnPos[
j
] - 
bË
()->
hBÜd”S·cšg
();

277 
	gŞdWidth
 = 
ûÎ
->
width
();

278 ià(
	gw
 !ğ
ŞdWidth
) {

279 
ûÎ
->
£tN“dsLayout
(
Œue
);

280 ià(!
bË
()->
£lfN“dsLayout
(è&& 
	gûÎ
->
checkFÜR•aštDuršgLayout
()) {

281 ià(!
	g¡©ePush”
.
didPush
()) {

284 
	g¡©ePush”
.
push
(
this
, 
IÁSize
(
x
(), 
y
()));

286 
	gûÎ
->
»·št
();

288 
	gûÎ
->
upd©eWidth
(
w
);

293 
	g¡©ePush”
.
pİ
();

296 
	gR’d”TabËSeùiÚ
::
ÿlcRowHeight
()

298 #iâdeà
NDEBUG


299 
£tN“dsLayoutIsFÜbidd’
(
Œue
);

302 
ASSERT
(!
ÃedsLayout
());

304 
R’d”TabËC–l
* 
	gûÎ
;

306 
	g¥acšg
 = 
bË
()->
vBÜd”S·cšg
();

308 
LayoutS‹Mašš”
 
¡©ePush”
(
v›w
());

310 
	gm_rowPos
.
»size
(
m_gridRows
 + 1);

311 
	gm_rowPos
[0] = 
¥acšg
;

313 
	gr
 = 0;„ < 
	gm_gridRows
;„++) {

314 
	gm_rowPos
[
r
 + 1] = 0;

315 
	gm_grid
[
r
].
	gba£lše
 = 0;

316 
	gba£lše
 = 0;

317 
	gbdesc
 = 0;

318 
	gch
 = 
m_grid
[
r
].
height
.
ÿlcMšV®ue
(0);

319 
	gpos
 = 
m_rowPos
[
r
] + 
ch
 + (
m_grid
[r].
rowR’d””
 ? 
¥acšg
 : 0);

321 
	gm_rowPos
[
r
 + 1] = 
max
(
m_rowPos
[¸+ 1], 
pos
);

323 
Row
* 
	grow
 = 
m_grid
[
r
].
row
;

324 
	gtÙ®CŞs
 = 
row
->
size
();

326 
	gc
 = 0; c < 
	gtÙ®CŞs
; c++) {

327 
C–lSŒuù
 
	gcu¼’t
 = 
ûÎAt
(
r
, 
c
);

328 
	gûÎ
 = 
cu¼’t
.
ûÎ
;

329 ià(!
	gûÎ
 || 
	gcu¼’t
.
	gšCŞS·n
)

331 ià(
	gr
 < 
	gm_gridRows
 - 1 && 
ûÎAt
(
r
 + 1, 
c
).
	gûÎ
 =ğ
ûÎ
)

334 
	gšdx
 = 
max
(
r
 - 
ûÎ
->
rowS·n
() + 1, 0);

336 ià(
	gûÎ
->
ov”rideSize
() != -1) {

337 ià(!
¡©ePush”
.
didPush
()) {

340 
¡©ePush”
.
push
(
this
, 
IÁSize
(
x
(), 
y
()));

342 
	gûÎ
->
£tOv”rideSize
(-1);

343 
	gûÎ
->
£tChdN“dsLayout
(
Œue
, 
çl£
);

344 
	gûÎ
->
ÏyoutIfN“ded
();

347 
	gadju¡edPaddšgTİ
 = 
ûÎ
->
·ddšgTİ
(è- c–l->
šŒšsicPaddšgTİ
();

348 
	gadju¡edPaddšgBÙtom
 = 
ûÎ
->
·ddšgBÙtom
(è- c–l->
šŒšsicPaddšgBÙtom
();

349 
	gadju¡edHeight
 = 
ûÎ
->
height
(è- (ûÎ->
šŒšsicPaddšgTİ
(è+ c–l->
šŒšsicPaddšgBÙtom
());

353 
	gch
 = 
ûÎ
->
¡yË
()->
height
().
ÿlcV®ue
(0) +

354 (
ûÎ
->
¡yË
()->
htmlHacks
(è? 0 : (
adju¡edPaddšgTİ
 + 
adju¡edPaddšgBÙtom
 +

355 
ûÎ
->
bÜd”Tİ
(è+ c–l->
bÜd”BÙtom
()));

356 
	gch
 = 
max
(
ch
, 
adju¡edHeight
);

358 
	gpos
 = 
m_rowPos
[
šdx
] + 
ch
 + (
m_grid
[
r
].
rowR’d””
 ? 
¥acšg
 : 0);

360 
	gm_rowPos
[
r
 + 1] = 
max
(
m_rowPos
[¸+ 1], 
pos
);

363 
EV”tiÿlAlign
 
	gva
 = 
ûÎ
->
¡yË
()->
v”tiÿlAlign
();

364 ià(
	gva
 =ğ
BASELINE
 || 
va
 =ğ
TEXT_BOTTOM
 || v¨=ğ
TEXT_TOP
 || v¨=ğ
SUPER
 || v¨=ğ
SUB
) {

365 
b
 = 
ûÎ
->
ba£lšePos™iÚ
();

366 ià(
	gb
 > 
	gûÎ
->
bÜd”Tİ
(è+ c–l->
·ddšgTİ
()) {

367 
	gba£lše
 = 
max
(
ba£lše
, 
b
 - 
ûÎ
->
šŒšsicPaddšgTİ
());

368 
	gbdesc
 = 
max
(
bdesc
, 
m_rowPos
[
šdx
] + 
ch
 - (
b
 - 
ûÎ
->
šŒšsicPaddšgTİ
()));

374 ià(
	gba£lše
) {

376 
	gm_rowPos
[
r
 + 1] = 
max
(
m_rowPos
[¸+ 1], 
ba£lše
 + 
bdesc
 + (
m_grid
[r].
rowR’d””
 ? 
¥acšg
 : 0));

377 
	gm_grid
[
r
].
	gba£lše
 = 
ba£lše
;

380 
	gm_rowPos
[
r
 + 1] = 
max
(
m_rowPos
[r + 1], m_rowPos[r]);

383 #iâdeà
NDEBUG


384 
£tN“dsLayoutIsFÜbidd’
(
çl£
);

387 
ASSERT
(!
ÃedsLayout
());

389 
	g¡©ePush”
.
pİ
();

391  
	gm_rowPos
[
m_gridRows
];

394 
	gR’d”TabËSeùiÚ
::
Ïyout
()

396 
ASSERT
(
ÃedsLayout
());

398 
LayoutS‹Mašš”
 
¡©ePush”
(
v›w
(), 
this
, 
IÁSize
(
x
(), 
y
()));

399 
R’d”Objeù
* 
	gchd
 = 
chd»n
()->
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
()) {

400 ià(
chd
->
isTabËRow
()) {

401 
chd
->
ÏyoutIfN“ded
();

402 
ASSERT
(!
chd
->
ÃedsLayout
());

405 
	g¡©ePush”
.
pİ
();

406 
£tN“dsLayout
(
çl£
);

409 
	gR’d”TabËSeùiÚ
::
ÏyoutRows
(
toAdd
)

411 #iâdeà
NDEBUG


412 
£tN“dsLayoutIsFÜbidd’
(
Œue
);

415 
ASSERT
(!
ÃedsLayout
());

417 
	grHeight
;

418 
	gršdx
;

419 
	gtÙ®Rows
 = 
m_gridRows
;

422 
£tWidth
(
bË
()->
cÚ‹ÁWidth
());

423 
	gm_ov”æow
.
ş—r
();

424 
	gm_hasOv”æowšgC–l
 = 
çl£
;

426 ià(
	gtoAdd
 && 
	gtÙ®Rows
 && (
	gm_rowPos
[
tÙ®Rows
] || !
ÃxtSiblšg
())) {

427 
	gtÙ®Height
 = 
m_rowPos
[
tÙ®Rows
] + 
toAdd
;

429 
	gdh
 = 
toAdd
;

430 
	gtÙ®P”ûÁ
 = 0;

431 
	gnumAuto
 = 0;

432 
	gr
 = 0;„ < 
	gtÙ®Rows
;„++) {

433 ià(
	gm_grid
[
r
].
	gheight
.
isAuto
())

434 
	gnumAuto
++;

435 ià(
	gm_grid
[
r
].
	gheight
.
isP”ûÁ
())

436 
	gtÙ®P”ûÁ
 +ğ
m_grid
[
r
].
height
.
¿wV®ue
();

438 ià(
	gtÙ®P”ûÁ
) {

440 
	gadd
 = 0;

441 
	gtÙ®P”ûÁ
 = 
mš
(
tÙ®P”ûÁ
, 100 * 
³rûÁSÿËFaùÜ
);

442 
	grh
 = 
m_rowPos
[1] - m_rowPos[0];

443 
	gr
 = 0;„ < 
	gtÙ®Rows
;„++) {

444 ià(
	gtÙ®P”ûÁ
 > 0 && 
	gm_grid
[
r
].
	gheight
.
isP”ûÁ
()) {

445 
	gtoAdd
 = 
mš
(
dh
, (
tÙ®Height
 * 
m_grid
[
r
].
height
.
¿wV®ue
(è/ (100 * 
³rûÁSÿËFaùÜ
)è- 
rh
);

448 
	gtoAdd
 = 
max
(0, 
toAdd
);

449 
	gadd
 +ğ
toAdd
;

450 
	gdh
 -ğ
toAdd
;

451 
	gtÙ®P”ûÁ
 -ğ
m_grid
[
r
].
height
.
¿wV®ue
();

453 ià(
	gr
 < 
	gtÙ®Rows
 - 1)

454 
	grh
 = 
m_rowPos
[
r
 + 2] - m_rowPos[r + 1];

455 
	gm_rowPos
[
r
 + 1] +ğ
add
;

458 ià(
	gnumAuto
) {

460 
	gadd
 = 0;

461 
	gr
 = 0;„ < 
	gtÙ®Rows
;„++) {

462 ià(
	gnumAuto
 > 0 && 
	gm_grid
[
r
].
	gheight
.
isAuto
()) {

463 
	gtoAdd
 = 
dh
 / 
numAuto
;

464 
	gadd
 +ğ
toAdd
;

465 
	gdh
 -ğ
toAdd
;

466 
	gnumAuto
--;

468 
	gm_rowPos
[
r
 + 1] +ğ
add
;

471 ià(
	gdh
 > 0 && 
	gm_rowPos
[
tÙ®Rows
]) {

473 
	gtÙ
 = 
m_rowPos
[
tÙ®Rows
];

474 
	gadd
 = 0;

475 
	g´ev
 = 
m_rowPos
[0];

476 
	gr
 = 0;„ < 
	gtÙ®Rows
;„++) {

478 
	gadd
 +ğ
dh
 * (
m_rowPos
[
r
 + 1] - 
´ev
è/ 
tÙ
;

479 
	g´ev
 = 
m_rowPos
[
r
 + 1];

480 
	gm_rowPos
[
r
 + 1] +ğ
add
;

485 
	gh¥acšg
 = 
bË
()->
hBÜd”S·cšg
();

486 
	gv¥acšg
 = 
bË
()->
vBÜd”S·cšg
();

487 
	gnEffCŞs
 = 
bË
()->
numEffCŞs
();

489 
LayoutS‹Mašš”
 
¡©ePush”
(
v›w
(), 
this
, 
IÁSize
(
x
(), 
y
()));

491 
	gr
 = 0;„ < 
	gtÙ®Rows
;„++) {

493 ià(
R’d”TabËRow
* 
	growR’d””
 = 
m_grid
[
r
].
rowR’d””
) {

494 
rowR’d””
->
£tLoÿtiÚ
(0, 
m_rowPos
[
r
]);

495 
	growR’d””
->
£tWidth
(
width
());

496 
	growR’d””
->
£tHeight
(
m_rowPos
[
r
 + 1] - m_rowPos[r] - 
v¥acšg
);

499 
	gc
 = 0; c < 
	gnEffCŞs
; c++) {

500 
R’d”TabËC–l
* 
	gûÎ
 = 
ûÎAt
(
r
, 
c
).cell;

502 ià(!
	gûÎ
)

504 ià(
	gr
 < 
	gtÙ®Rows
 - 1 && 
	gûÎ
 =ğ
ûÎAt
(
r
 + 1, 
c
).cell)

507 
	gršdx
 = 
max
(0, 
r
 - 
ûÎ
->
rowS·n
() + 1);

509 
	grHeight
 = 
m_rowPos
[
r
 + 1] - m_rowPos[
ršdx
] - 
v¥acšg
;

524 
boŞ
 
	gûÎChd»nFËx
 = 
çl£
;

525 
boŞ
 
	gæexAÎChd»n
 = 
ûÎ
->
¡yË
()->
height
().
isFixed
() ||

526 (!
bË
()->
¡yË
()->
height
().
isAuto
(è&& 
rHeight
 !ğ
ûÎ
->height());

528 
R’d”Objeù
* 
	go
 = 
ûÎ
->
fœ¡Chd
(); o; o = 
o
->
ÃxtSiblšg
()) {

529 ià(!
o
->
isText
(è&& o->
¡yË
()->
height
().
isP”ûÁ
(è&& (
æexAÎChd»n
 || o->
isR•Ïûd
(è|| (o->
isBox
(è&& 
toR’d”Box
(o)->
süŞlsOv”æow
()))) {

531 ià(!
o
->
isTabË
(è|| 
toR’d”TabË
(o)->
hasSeùiÚs
()) {

532 
o
->
£tN“dsLayout
(
Œue
, 
çl£
);

533 
	gûÎChd»nFËx
 = 
Œue
;

538 ià(
	gHashS‘
<
	gR’d”Box
*>* 
	g³rûÁHeightDesûndªts
 = 
ûÎ
->
³rûÁHeightDesûndªts
()) {

539 
HashS‘
<
R’d”Box
*>::
™”©Ü
 
’d
 = 
³rûÁHeightDesûndªts
->end();

540 
	gHashS‘
<
	gR’d”Box
*>::
™”©Ü
 
™
 = 
³rûÁHeightDesûndªts
->
begš
(); 
	g™
 !ğ
’d
; ++it) {

541 
R’d”Box
* 
	gbox
 = *
™
;

542 ià(!
	gbox
->
isR•Ïûd
(è&& !box->
süŞlsOv”æow
(è&& !
	gæexAÎChd»n
)

545 
	gbox
 !ğ
ûÎ
) {

546 ià(
box
->
nÜm®ChdN“dsLayout
())

548 
	gbox
->
£tChdN“dsLayout
(
Œue
, 
çl£
);

549 
	gbox
 = 
box
->
cÚššgBlock
();

550 
ASSERT
(
box
);

551 ià(!
	gbox
)

554 
	gûÎChd»nFËx
 = 
Œue
;

558 ià(
	gûÎChd»nFËx
) {

559 
	gûÎ
->
£tChdN“dsLayout
(
Œue
, 
çl£
);

563 
	gûÎ
->
£tOv”rideSize
(
max
(0,

564 
rHeight
 - 
ûÎ
->
bÜd”Tİ
(è- c–l->
·ddšgTİ
() -

565 
ûÎ
->
bÜd”BÙtom
(è- c–l->
·ddšgBÙtom
()));

566 
	gûÎ
->
ÏyoutIfN“ded
();

569 
EV”tiÿlAlign
 
	gva
 = 
ûÎ
->
¡yË
()->
v”tiÿlAlign
();

570 ià(
	gva
 =ğ
BASELINE
 || 
va
 =ğ
TEXT_BOTTOM
 || v¨=ğ
TEXT_TOP
 || v¨=ğ
SUPER
 || v¨=ğ
SUB
) {

571 
b
 = 
ûÎ
->
ba£lšePos™iÚ
();

572 ià(
	gb
 > 
	gûÎ
->
bÜd”Tİ
(è+ c–l->
·ddšgTİ
())

573 
	gm_grid
[
r
].
	gba£lše
 = 
max
(
m_grid
[r].
ba£lše
, 
b
);

577 
	gŞdTe
 = 
ûÎ
->
šŒšsicPaddšgTİ
();

578 
	gŞdBe
 = 
ûÎ
->
šŒšsicPaddšgBÙtom
();

579 
	gheightW™houtIÁršsicPaddšg
 = 
ûÎ
->
height
(è- 
ŞdTe
 - 
ŞdBe
;

581 
	g‹
 = 0;

582 
	gûÎ
->
¡yË
()->
v”tiÿlAlign
()) {

583 
	gSUB
:

584 
SUPER
:

585 
TEXT_TOP
:

586 
TEXT_BOTTOM
:

587 
BASELINE
: {

588 
b
 = 
ûÎ
->
ba£lšePos™iÚ
();

589 ià(
	gb
 > 
	gûÎ
->
bÜd”Tİ
(è+ c–l->
·ddšgTİ
())

590 
	g‹
 = 
g‘Ba£lše
(
r
è- (
b
 - 
ŞdTe
);

593 
	gTOP
:

594 
‹
 = 0;

596 
	gMIDDLE
:

597 
‹
 = (
rHeight
 - 
heightW™houtIÁršsicPaddšg
) / 2;

599 
	gBOTTOM
:

600 
‹
 = 
rHeight
 - 
heightW™houtIÁršsicPaddšg
;

606 
	gbe
 = 
rHeight
 - 
heightW™houtIÁršsicPaddšg
 - 
‹
;

607 
	gûÎ
->
£tIÁršsicPaddšgTİ
(
‹
);

608 
	gûÎ
->
£tIÁršsicPaddšgBÙtom
(
be
);

609 ià(
	g‹
 !ğ
ŞdTe
 || 
be
 !ğ
ŞdBe
) {

610 
ûÎ
->
£tN“dsLayout
(
Œue
, 
çl£
);

611 
	gûÎ
->
ÏyoutIfN“ded
();

614 ià((
	g‹
 !ğ
ŞdTe
 || 
be
 > 
ŞdBe
è&& !
bË
()->
£lfN“dsLayout
(è&& 
ûÎ
->
checkFÜR•aštDuršgLayout
())

615 
ûÎ
->
»·št
();

617 
IÁReù
 
ŞdC–lReù
(
ûÎ
->
x
(), c–l->
y
(è, c–l->
width
(), c–l->
height
());

619 ià(
¡yË
()->
dœeùiÚ
(è=ğ
RTL
) {

620 
ûÎ
->
£tLoÿtiÚ
(
bË
()->
cŞumnPos™iÚs
()[
nEffCŞs
] -abË()->cŞumnPos™iÚs()[bË()->
cŞToEffCŞ
(ûÎ->
cŞ
(è+ c–l->
cŞS·n
())] + 
h¥acšg
, 
m_rowPos
[
ršdx
]);

622 
	gûÎ
->
£tLoÿtiÚ
(
bË
()->
cŞumnPos™iÚs
()[
c
] + 
h¥acšg
, 
m_rowPos
[
ršdx
]);

627 ià(!
bË
()->
£lfN“dsLayout
(è&& 
	gûÎ
->
checkFÜR•aštDuršgLayout
())

628 
	gûÎ
->
»·štDuršgLayoutIfMoved
(
ŞdC–lReù
);

632 #iâdeà
NDEBUG


633 
£tN“dsLayoutIsFÜbidd’
(
çl£
);

636 
ASSERT
(!
ÃedsLayout
());

638 
£tHeight
(
m_rowPos
[
tÙ®Rows
]);

641 
	gr
 = 0;„ < 
	gtÙ®Rows
;„++) {

642 
	gc
 = 0; c < 
	gnEffCŞs
; c++) {

643 
R’d”TabËC–l
* 
	gûÎ
 = 
ûÎAt
(
r
, 
c
).cell;

644 ià(!
	gûÎ
)

646 ià(
	gr
 < 
	gtÙ®Rows
 - 1 && 
	gûÎ
 =ğ
ûÎAt
(
r
 + 1, 
c
).cell)

648 
addOv”æowFromChd
(
ûÎ
);

649 
	gm_hasOv”æowšgC–l
 |ğ
ûÎ
->
hasVisibËOv”æow
();

653 
	g¡©ePush”
.
pİ
();

654  
height
();

657 
	gR’d”TabËSeùiÚ
::
lowe¡Pos™iÚ
(
boŞ
 
šşudeOv”æowIÁ”iÜ
, boŞ 
šşudeS–f
) const

659 
	gbÙtom
 = 
R’d”Box
::
lowe¡Pos™iÚ
(
šşudeOv”æowIÁ”iÜ
, 
šşudeS–f
);

660 ià(!
	gšşudeOv”æowIÁ”iÜ
 && 
hasOv”æowCl
())

661  
	gbÙtom
;

663 
R’d”Objeù
* 
	grow
 = 
fœ¡Chd
();„ow;„ow = 
row
->
ÃxtSiblšg
()) {

664 
R’d”Objeù
* 
cu¼
 = 
row
->
fœ¡Chd
(); 
	gcu¼
; cu¼ = cu¼->
ÃxtSiblšg
()) {

665 ià(
cu¼
->
isTabËC–l
()) {

666 
R’d”TabËC–l
* 
ûÎ
 = 
toR’d”TabËC–l
(
cu¼
);

667 
	gbÙtom
 = 
max
(
bÙtom
, 
ûÎ
->
y
(è+ c–l->
lowe¡Pos™iÚ
(
çl£
));

672  
	gbÙtom
;

675 
	gR’d”TabËSeùiÚ
::
rightmo¡Pos™iÚ
(
boŞ
 
šşudeOv”æowIÁ”iÜ
, boŞ 
šşudeS–f
) const

677 
	gright
 = 
R’d”Box
::
rightmo¡Pos™iÚ
(
šşudeOv”æowIÁ”iÜ
, 
šşudeS–f
);

678 ià(!
	gšşudeOv”æowIÁ”iÜ
 && 
hasOv”æowCl
())

679  
	gright
;

681 
R’d”Objeù
* 
	grow
 = 
fœ¡Chd
();„ow;„ow = 
row
->
ÃxtSiblšg
()) {

682 
R’d”Objeù
* 
cu¼
 = 
row
->
fœ¡Chd
(); 
	gcu¼
; cu¼ = cu¼->
ÃxtSiblšg
()) {

683 ià(
cu¼
->
isTabËC–l
()) {

684 
R’d”TabËC–l
* 
ûÎ
 = 
toR’d”TabËC–l
(
cu¼
);

685 
	gright
 = 
max
(
right
, 
ûÎ
->
x
(è+ c–l->
rightmo¡Pos™iÚ
(
çl£
));

690  
	gright
;

693 
	gR’d”TabËSeùiÚ
::
Ëámo¡Pos™iÚ
(
boŞ
 
šşudeOv”æowIÁ”iÜ
, boŞ 
šşudeS–f
) const

695 
	gËá
 = 
R’d”Box
::
Ëámo¡Pos™iÚ
(
šşudeOv”æowIÁ”iÜ
, 
šşudeS–f
);

696 ià(!
	gšşudeOv”æowIÁ”iÜ
 && 
hasOv”æowCl
())

697  
	gËá
;

699 
R’d”Objeù
* 
	grow
 = 
fœ¡Chd
();„ow;„ow = 
row
->
ÃxtSiblšg
()) {

700 
R’d”Objeù
* 
cu¼
 = 
row
->
fœ¡Chd
(); 
	gcu¼
; cu¼ = cu¼->
ÃxtSiblšg
()) {

701 ià(
cu¼
->
isTabËC–l
()) {

702 
R’d”TabËC–l
* 
ûÎ
 = 
toR’d”TabËC–l
(
cu¼
);

703 
	gËá
 = 
mš
(
Ëá
, 
ûÎ
->
x
(è+ c–l->
Ëámo¡Pos™iÚ
(
çl£
));

708  
	gËá
;

711 
	gR’d”TabËSeùiÚ
::
ÿlcOu‹rBÜd”Tİ
() const

713 
tÙ®CŞs
 = 
bË
()->
numEffCŞs
();

714 ià(!
	gm_gridRows
 || !
	gtÙ®CŞs
)

717 
	gbÜd”Width
 = 0;

719 cÚ¡ 
	gBÜd”V®ue
& 
	gsb
 = 
¡yË
()->
bÜd”Tİ
();

720 ià(
	gsb
.
¡yË
(è=ğ
BHIDDEN
)

722 ià(
	gsb
.
¡yË
(è> 
	gBHIDDEN
)

723 
	gbÜd”Width
 = 
sb
.
width
();

725 cÚ¡ 
	gBÜd”V®ue
& 
	grb
 = 
fœ¡Chd
()->
¡yË
()->
bÜd”Tİ
();

726 ià(
	grb
.
¡yË
(è=ğ
BHIDDEN
)

728 ià(
	grb
.
¡yË
(è> 
	gBHIDDEN
 &&„b.
width
(è> 
	gbÜd”Width
)

729 
	gbÜd”Width
 = 
rb
.
width
();

731 
boŞ
 
	g®lHidd’
 = 
Œue
;

732 
	gc
 = 0; c < 
	gtÙ®CŞs
; c++) {

733 cÚ¡ 
	gC–lSŒuù
& 
	gcu¼’t
 = 
ûÎAt
(0, 
c
);

734 ià(
	gcu¼’t
.
	gšCŞS·n
 || !cu¼’t.
	gûÎ
)

736 cÚ¡ 
	gBÜd”V®ue
& 
	gcb
 = 
cu¼’t
.
ûÎ
->
¡yË
()->
bÜd”Tİ
();

738 
R’d”TabËCŞ
* 
	gcŞGroup
 = 
bË
()->
cŞEËm’t
(
c
);

739 ià(
	gcŞGroup
) {

740 cÚ¡ 
	gBÜd”V®ue
& 
	ggb
 = 
cŞGroup
->
¡yË
()->
bÜd”Tİ
();

741 ià(
	ggb
.
¡yË
(è=ğ
BHIDDEN
 || 
cb
.style() == BHIDDEN)

744 
	g®lHidd’
 = 
çl£
;

745 ià(
	ggb
.
¡yË
(è> 
	gBHIDDEN
 && gb.
width
(è> 
	gbÜd”Width
)

746 
	gbÜd”Width
 = 
gb
.
width
();

747 ià(
	gcb
.
¡yË
(è> 
	gBHIDDEN
 && cb.
width
(è> 
	gbÜd”Width
)

748 
	gbÜd”Width
 = 
cb
.
width
();

750 ià(
	gcb
.
¡yË
(è=ğ
BHIDDEN
)

753 
	g®lHidd’
 = 
çl£
;

754 ià(
	gcb
.
¡yË
(è> 
	gBHIDDEN
 && cb.
width
(è> 
	gbÜd”Width
)

755 
	gbÜd”Width
 = 
cb
.
width
();

758 ià(
	g®lHidd’
)

761  
	gbÜd”Width
 / 2;

764 
	gR’d”TabËSeùiÚ
::
ÿlcOu‹rBÜd”BÙtom
() const

766 
tÙ®CŞs
 = 
bË
()->
numEffCŞs
();

767 ià(!
	gm_gridRows
 || !
	gtÙ®CŞs
)

770 
	gbÜd”Width
 = 0;

772 cÚ¡ 
	gBÜd”V®ue
& 
	gsb
 = 
¡yË
()->
bÜd”BÙtom
();

773 ià(
	gsb
.
¡yË
(è=ğ
BHIDDEN
)

775 ià(
	gsb
.
¡yË
(è> 
	gBHIDDEN
)

776 
	gbÜd”Width
 = 
sb
.
width
();

778 cÚ¡ 
	gBÜd”V®ue
& 
	grb
 = 
Ï¡Chd
()->
¡yË
()->
bÜd”BÙtom
();

779 ià(
	grb
.
¡yË
(è=ğ
BHIDDEN
)

781 ià(
	grb
.
¡yË
(è> 
	gBHIDDEN
 &&„b.
width
(è> 
	gbÜd”Width
)

782 
	gbÜd”Width
 = 
rb
.
width
();

784 
boŞ
 
	g®lHidd’
 = 
Œue
;

785 
	gc
 = 0; c < 
	gtÙ®CŞs
; c++) {

786 cÚ¡ 
	gC–lSŒuù
& 
	gcu¼’t
 = 
ûÎAt
(
m_gridRows
 - 1, 
c
);

787 ià(
	gcu¼’t
.
	gšCŞS·n
 || !cu¼’t.
	gûÎ
)

789 cÚ¡ 
	gBÜd”V®ue
& 
	gcb
 = 
cu¼’t
.
ûÎ
->
¡yË
()->
bÜd”BÙtom
();

791 
R’d”TabËCŞ
* 
	gcŞGroup
 = 
bË
()->
cŞEËm’t
(
c
);

792 ià(
	gcŞGroup
) {

793 cÚ¡ 
	gBÜd”V®ue
& 
	ggb
 = 
cŞGroup
->
¡yË
()->
bÜd”BÙtom
();

794 ià(
	ggb
.
¡yË
(è=ğ
BHIDDEN
 || 
cb
.style() == BHIDDEN)

797 
	g®lHidd’
 = 
çl£
;

798 ià(
	ggb
.
¡yË
(è> 
	gBHIDDEN
 && gb.
width
(è> 
	gbÜd”Width
)

799 
	gbÜd”Width
 = 
gb
.
width
();

800 ià(
	gcb
.
¡yË
(è> 
	gBHIDDEN
 && cb.
width
(è> 
	gbÜd”Width
)

801 
	gbÜd”Width
 = 
cb
.
width
();

803 ià(
	gcb
.
¡yË
(è=ğ
BHIDDEN
)

806 
	g®lHidd’
 = 
çl£
;

807 ià(
	gcb
.
¡yË
(è> 
	gBHIDDEN
 && cb.
width
(è> 
	gbÜd”Width
)

808 
	gbÜd”Width
 = 
cb
.
width
();

811 ià(
	g®lHidd’
)

814  (
	gbÜd”Width
 + 1) / 2;

817 
	gR’d”TabËSeùiÚ
::
ÿlcOu‹rBÜd”Leá
(
boŞ
 
¹l
) const

819 
tÙ®CŞs
 = 
bË
()->
numEffCŞs
();

820 ià(!
	gm_gridRows
 || !
	gtÙ®CŞs
)

823 
	gbÜd”Width
 = 0;

825 cÚ¡ 
	gBÜd”V®ue
& 
	gsb
 = 
¡yË
()->
bÜd”Leá
();

826 ià(
	gsb
.
¡yË
(è=ğ
BHIDDEN
)

828 ià(
	gsb
.
¡yË
(è> 
	gBHIDDEN
)

829 
	gbÜd”Width
 = 
sb
.
width
();

831 
	gËámo¡CŞumn
 = 
¹l
 ? 
tÙ®CŞs
 - 1 : 0;

832 
R’d”TabËCŞ
* 
	gcŞGroup
 = 
bË
()->
cŞEËm’t
(
Ëámo¡CŞumn
);

833 ià(
	gcŞGroup
) {

834 cÚ¡ 
	gBÜd”V®ue
& 
	ggb
 = 
cŞGroup
->
¡yË
()->
bÜd”Leá
();

835 ià(
	ggb
.
¡yË
(è=ğ
BHIDDEN
)

837 ià(
	ggb
.
¡yË
(è> 
	gBHIDDEN
 && gb.
width
(è> 
	gbÜd”Width
)

838 
	gbÜd”Width
 = 
gb
.
width
();

841 
boŞ
 
	g®lHidd’
 = 
Œue
;

842 
	gr
 = 0;„ < 
	gm_gridRows
;„++) {

843 cÚ¡ 
	gC–lSŒuù
& 
	gcu¼’t
 = 
ûÎAt
(
r
, 
Ëámo¡CŞumn
);

844 ià(!
	gcu¼’t
.
	gûÎ
)

847 cÚ¡ 
	gBÜd”V®ue
& 
	gcb
 = 
cu¼’t
.
ûÎ
->
¡yË
()->
bÜd”Leá
();

848 cÚ¡ 
	gBÜd”V®ue
& 
	grb
 = 
cu¼’t
.
ûÎ
->
·»Á
()->
¡yË
()->
bÜd”Leá
();

849 ià(
	gcb
.
¡yË
(è=ğ
BHIDDEN
 || 
rb
.style() == BHIDDEN)

852 
	g®lHidd’
 = 
çl£
;

853 ià(
	gcb
.
¡yË
(è> 
	gBHIDDEN
 && cb.
width
(è> 
	gbÜd”Width
)

854 
	gbÜd”Width
 = 
cb
.
width
();

855 ià(
	grb
.
¡yË
(è> 
	gBHIDDEN
 &&„b.
width
(è> 
	gbÜd”Width
)

856 
	gbÜd”Width
 = 
rb
.
width
();

858 ià(
	g®lHidd’
)

861  
	gbÜd”Width
 / 2;

864 
	gR’d”TabËSeùiÚ
::
ÿlcOu‹rBÜd”Right
(
boŞ
 
¹l
) const

866 
tÙ®CŞs
 = 
bË
()->
numEffCŞs
();

867 ià(!
	gm_gridRows
 || !
	gtÙ®CŞs
)

870 
	gbÜd”Width
 = 0;

872 cÚ¡ 
	gBÜd”V®ue
& 
	gsb
 = 
¡yË
()->
bÜd”Right
();

873 ià(
	gsb
.
¡yË
(è=ğ
BHIDDEN
)

875 ià(
	gsb
.
¡yË
(è> 
	gBHIDDEN
)

876 
	gbÜd”Width
 = 
sb
.
width
();

878 
	grightmo¡CŞumn
 = 
¹l
 ? 0 : 
tÙ®CŞs
 - 1;

879 
R’d”TabËCŞ
* 
	gcŞGroup
 = 
bË
()->
cŞEËm’t
(
rightmo¡CŞumn
);

880 ià(
	gcŞGroup
) {

881 cÚ¡ 
	gBÜd”V®ue
& 
	ggb
 = 
cŞGroup
->
¡yË
()->
bÜd”Right
();

882 ià(
	ggb
.
¡yË
(è=ğ
BHIDDEN
)

884 ià(
	ggb
.
¡yË
(è> 
	gBHIDDEN
 && gb.
width
(è> 
	gbÜd”Width
)

885 
	gbÜd”Width
 = 
gb
.
width
();

888 
boŞ
 
	g®lHidd’
 = 
Œue
;

889 
	gr
 = 0;„ < 
	gm_gridRows
;„++) {

890 cÚ¡ 
	gC–lSŒuù
& 
	gcu¼’t
 = 
ûÎAt
(
r
, 
rightmo¡CŞumn
);

891 ià(!
	gcu¼’t
.
	gûÎ
)

894 cÚ¡ 
	gBÜd”V®ue
& 
	gcb
 = 
cu¼’t
.
ûÎ
->
¡yË
()->
bÜd”Right
();

895 cÚ¡ 
	gBÜd”V®ue
& 
	grb
 = 
cu¼’t
.
ûÎ
->
·»Á
()->
¡yË
()->
bÜd”Right
();

896 ià(
	gcb
.
¡yË
(è=ğ
BHIDDEN
 || 
rb
.style() == BHIDDEN)

899 
	g®lHidd’
 = 
çl£
;

900 ià(
	gcb
.
¡yË
(è> 
	gBHIDDEN
 && cb.
width
(è> 
	gbÜd”Width
)

901 
	gbÜd”Width
 = 
cb
.
width
();

902 ià(
	grb
.
¡yË
(è> 
	gBHIDDEN
 &&„b.
width
(è> 
	gbÜd”Width
)

903 
	gbÜd”Width
 = 
rb
.
width
();

905 ià(
	g®lHidd’
)

908  (
	gbÜd”Width
 + 1) / 2;

911 
	gR’d”TabËSeùiÚ
::
»ÿlcOu‹rBÜd”
()

913 
boŞ
 
¹l
 = 
bË
()->
¡yË
()->
dœeùiÚ
(è=ğ
RTL
;

914 
	gm_ou‹rBÜd”Tİ
 = 
ÿlcOu‹rBÜd”Tİ
();

915 
	gm_ou‹rBÜd”BÙtom
 = 
ÿlcOu‹rBÜd”BÙtom
();

916 
	gm_ou‹rBÜd”Leá
 = 
ÿlcOu‹rBÜd”Leá
(
¹l
);

917 
	gm_ou‹rBÜd”Right
 = 
ÿlcOu‹rBÜd”Right
(
¹l
);

920 
	gR’d”TabËSeùiÚ
::
fœ¡LšeBoxBa£lše
() const

922 ià(!
m_gridRows
)

925 
	gfœ¡LšeBa£lše
 = 
m_grid
[0].
ba£lše
;

926 ià(
	gfœ¡LšeBa£lše
)

927  
	gfœ¡LšeBa£lše
 + 
	gm_rowPos
[0];

929 
	gfœ¡LšeBa£lše
 = -1;

930 
Row
* 
	gfœ¡Row
 = 
m_grid
[0].
row
;

931 
size_t
 
	gi
 = 0; i < 
	gfœ¡Row
->
size
(); ++i) {

932 
R’d”TabËC–l
* 
	gûÎ
 = 
fœ¡Row
->
©
(
i
).
ûÎ
;

933 ià(
	gûÎ
)

934 
	gfœ¡LšeBa£lše
 = 
max
(
fœ¡LšeBa£lše
, 
ûÎ
->
y
(è+ c–l->
·ddšgTİ
(è+ c–l->
bÜd”Tİ
(è+ c–l->
cÚ‹ÁHeight
());

937  
	gfœ¡LšeBa£lše
;

940 
	gR’d”TabËSeùiÚ
::
·št
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

945 ià(
ÃedsLayout
())

948 
	gtÙ®Rows
 = 
m_gridRows
;

949 
	gtÙ®CŞs
 = 
bË
()->
cŞumns
().
size
();

951 ià(!
	gtÙ®Rows
 || !
	gtÙ®CŞs
)

954 
	gtx
 +ğ
x
();

955 
	gty
 +ğ
y
();

957 
PaštPha£
 
	gpha£
 = 
·štInfo
.
pha£
;

958 
boŞ
 
	gpushedCl
 = 
pushCÚ‹ÁsCl
(
·štInfo
, 
tx
, 
ty
);

959 
·štObjeù
(
·štInfo
, 
tx
, 
ty
);

960 ià(
	gpushedCl
)

961 
pİCÚ‹ÁsCl
(
·štInfo
, 
pha£
, 
tx
, 
ty
);

964 
	gR’d”TabËSeùiÚ
::
·štObjeù
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

968 
	gtÙ®Rows
 = 
m_gridRows
;

969 
	gtÙ®CŞs
 = 
bË
()->
cŞumns
().
size
();

971 
PaštPha£
 
	g·štPha£
 = 
·štInfo
.
pha£
;

972 
	gx
 = 
·štInfo
.
»ù
.
x
();

973 
	gy
 = 
·štInfo
.
»ù
.
y
();

974 
	gw
 = 
·štInfo
.
»ù
.
width
();

975 
	gh
 = 
·štInfo
.
»ù
.
height
();

977 
	gos
 = 2 * 
maxim®OušeSize
(
·štPha£
);

978 
	g¡¬Œow
 = 0;

979 
	g’drow
 = 
tÙ®Rows
;

982 ià(!
	gm_hasOv”æowšgC–l
) {

983 ; 
	g¡¬Œow
 < 
	gtÙ®Rows
; startrow++) {

984 ià(
	gty
 + 
	gm_rowPos
[
¡¬Œow
 + 1] >ğ
y
 - 
os
)

987 ià(
	g¡¬Œow
 =ğ
tÙ®Rows
 && 
ty
 + 
m_rowPos
[tÙ®Rows] + 
bË
()->
ou‹rBÜd”BÙtom
(è>ğ
y
 - 
os
)

988 
¡¬Œow
--;

990 ; 
	g’drow
 > 0;ƒndrow--) {

991 ià(
	gty
 + 
	gm_rowPos
[
’drow
 - 1] <ğ
y
 + 
h
 + 
os
)

994 ià(!
	g’drow
 && 
	gty
 + 
	gm_rowPos
[0] - 
bË
()->
ou‹rBÜd”Tİ
(è<ğ
y
 + 
h
 + 
os
)

995 
’drow
++;

998 
	g¡¬tcŞ
 = 0;

999 
	g’dcŞ
 = 
tÙ®CŞs
;

1001 ià(!
	gm_hasOv”æowšgC–l
 && 
¡yË
()->
dœeùiÚ
(è=ğ
LTR
) {

1002 ; 
	g¡¬tcŞ
 < 
	gtÙ®CŞs
; startcol++) {

1003 ià(
	gtx
 + 
bË
()->
cŞumnPos™iÚs
()[
¡¬tcŞ
 + 1] >ğ
x
 - 
os
)

1006 ià(
	g¡¬tcŞ
 =ğ
tÙ®CŞs
 && 
tx
 + 
bË
()->
cŞumnPos™iÚs
()[tÙ®CŞs] +abË()->
ou‹rBÜd”Right
(è>ğ
x
 - 
os
)

1007 
¡¬tcŞ
--;

1009 ; 
	g’dcŞ
 > 0;ƒndcol--) {

1010 ià(
	gtx
 + 
bË
()->
cŞumnPos™iÚs
()[
’dcŞ
 - 1] <ğ
x
 + 
w
 + 
os
)

1013 ià(!
	g’dcŞ
 && 
	gtx
 + 
bË
()->
cŞumnPos™iÚs
()[0] -abË()->
ou‹rBÜd”Leá
(è<ğ
y
 + 
w
 + 
os
)

1014 
’dcŞ
++;

1017 ià(
	g¡¬tcŞ
 < 
	g’dcŞ
) {

1019 
	gr
 = 
¡¬Œow
;„ < 
	g’drow
;„++) {

1020 
	gc
 = 
¡¬tcŞ
;

1022 
	gc
 && 
ûÎAt
(
r
, 
c
).
	gšCŞS·n
)

1023 
	gc
--;

1024 ; 
	gc
 < 
	g’dcŞ
; c++) {

1025 
C–lSŒuù
 
	gcu¼’t
 = 
ûÎAt
(
r
, 
c
);

1026 
R’d”TabËC–l
* 
	gûÎ
 = 
cu¼’t
.
ûÎ
;

1031 ià(!
	gûÎ
 || (
	gr
 > 
	g¡¬Œow
 && (
ûÎAt
(
r
 - 1, 
c
).ûÎ =ğ
ûÎ
)))

1034 
R’d”TabËRow
* 
	grow
 = 
toR’d”TabËRow
(
ûÎ
->
·»Á
());

1036 ià(
	g·štPha£
 =ğ
PaštPha£BlockBackground
 || 
·štPha£
 =ğ
PaštPha£ChdBlockBackground
) {

1039 
R’d”Objeù
* 
cŞ
 = 
bË
()->
cŞEËm’t
(
c
);

1040 
R’d”Objeù
* 
	gcŞGroup
 = 0;

1041 ià(
	gcŞ
 && cŞ->
·»Á
()->
¡yË
()->
di¥Ïy
(è=ğ
TABLE_COLUMN_GROUP
)

1042 
cŞGroup
 = 
cŞ
->
·»Á
();

1049 
	gûÎ
->
·štBackgroundsBehšdC–l
(
·štInfo
, 
tx
, 
ty
, 
cŞGroup
);

1050 
	gûÎ
->
·štBackgroundsBehšdC–l
(
·štInfo
, 
tx
, 
ty
, 
cŞ
);

1053 
	gûÎ
->
·štBackgroundsBehšdC–l
(
·štInfo
, 
tx
, 
ty
, 
this
);

1057 ià(!
	grow
->
hasS–fPaštšgLay”
())

1058 
	gûÎ
->
·štBackgroundsBehšdC–l
(
·štInfo
, 
tx
, 
ty
, 
row
);

1061 ià((!
	gûÎ
->
hasS–fPaštšgLay”
(è&& !
	grow
->hasS–fPaštšgLay”()è|| 
	g·štInfo
.
	gpha£
 =ğ
PaštPha£CŞÏp£dTabËBÜd”s
)

1062 
ûÎ
->
·št
(
·štInfo
, 
tx
, 
ty
);

1068 
	gR’d”TabËSeùiÚ
::
imageChªged
(
W¿µedImagePŒ
, cÚ¡ 
IÁReù
*)

1071 
»·št
();

1074 
	gR’d”TabËSeùiÚ
::
»ÿlcC–ls
()

1076 
m_cCŞ
 = 0;

1077 
	gm_cRow
 = -1;

1078 
ş—rGrid
();

1079 
	gm_gridRows
 = 0;

1081 
R’d”Objeù
* 
	grow
 = 
fœ¡Chd
();„ow;„ow = 
row
->
ÃxtSiblšg
()) {

1082 ià(
row
->
isTabËRow
()) {

1083 
m_cRow
++;

1084 
	gm_cCŞ
 = 0;

1085 ià(!
’su»Rows
(
m_cRow
 + 1))

1088 
R’d”TabËRow
* 
	gbËRow
 = 
toR’d”TabËRow
(
row
);

1089 
	gm_grid
[
m_cRow
].
	growR’d””
 = 
bËRow
;

1090 
£tRowHeightToRowStyËHeightIfNÙR–©ive
(&
m_grid
[
m_cRow
]);

1092 
R’d”Objeù
* 
	gûÎ
 = 
row
->
fœ¡Chd
(); c–l; c–Èğ
ûÎ
->
ÃxtSiblšg
()) {

1093 ià(
ûÎ
->
isTabËC–l
())

1094 
addC–l
(
toR’d”TabËC–l
(
ûÎ
), 
bËRow
);

1098 
	gm_ÃedsC–lReÿlc
 = 
çl£
;

1099 
£tN“dsLayout
(
Œue
);

1102 
	gR’d”TabËSeùiÚ
::
ş—rGrid
()

1104 
rows
 = 
m_gridRows
;

1105 
	grows
--)

1106 
d–‘e
 
	gm_grid
[
rows
].
	grow
;

1109 
	gR’d”TabËSeùiÚ
::
numCŞumns
() const

1111 
»suÉ
 = 0;

1113 
	gr
 = 0;„ < 
	gm_gridRows
; ++r) {

1114 
	gc
 = 
»suÉ
; c < 
bË
()->
numEffCŞs
(); ++c) {

1115 cÚ¡ 
	gC–lSŒuù
& 
	gûÎ
 = 
ûÎAt
(
r
, 
c
);

1116 ià(
	gûÎ
.ûÎ || c–l.
	gšCŞS·n
)

1117 
	g»suÉ
 = 
c
;

1121  
	g»suÉ
 + 1;

1124 
	gR’d”TabËSeùiÚ
::
­³ndCŞumn
(
pos
)

1126 
row
 = 0; 
	grow
 < 
	gm_gridRows
; ++row) {

1127 
	gm_grid
[
row
].
	grow
->
»size
(
pos
 + 1);

1128 
	gC–lSŒuù
& 
	gc
 = 
ûÎAt
(
row
, 
pos
);

1129 
	gc
.
	gûÎ
 = 0;

1130 
	gc
.
	gšCŞS·n
 = 
çl£
;

1134 
	gR’d”TabËSeùiÚ
::
¥l™CŞumn
(
pos
, 
ÃwSize
)

1136 ià(
	gm_cCŞ
 > 
	gpos
)

1137 
	gm_cCŞ
++;

1138 
	grow
 = 0;„ow < 
	gm_gridRows
; ++row) {

1139 
	gm_grid
[
row
].
	grow
->
»size
(
ÃwSize
);

1140 
	gRow
& 
	gr
 = *
m_grid
[
row
].row;

1141 
memmove
(
r
.
d©a
(è+ 
pos
 + 1,„.d©a(è+…os, (
ÃwSize
 - 1 -…osè* (
C–lSŒuù
));

1142 
	gr
[
pos
 + 1].
	gûÎ
 = 0;

1143 
	gr
[
pos
 + 1].
	gšCŞS·n
 = 
r
[pos].
šCŞS·n
 ||„[pos].
ûÎ
;

1148 
boŞ
 
	gR’d”TabËSeùiÚ
::
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
& 
»que¡
, 
H™Te¡ResuÉ
& 
»suÉ
, 
xPos
, 
yPos
, 
tx
, 
ty
, 
H™Te¡AùiÚ
 
aùiÚ
)

1152 
	gtx
 +ğ
x
();

1153 
	gty
 +ğ
y
();

1155 ià(
hasOv”æowCl
(è&& !
ov”æowClReù
(
tx
, 
ty
).
cÚšs
(
xPos
, 
yPos
))

1156  
	gçl£
;

1158 
R’d”Objeù
* 
	gchd
 = 
Ï¡Chd
(); chd; chd = 
chd
->
´eviousSiblšg
()) {

1163 ià(
chd
->
isBox
(è&& !
toR’d”Box
(chd)->
hasS–fPaštšgLay”
(è&& chd->
nodeAtPošt
(
»que¡
, 
»suÉ
, 
xPos
, 
yPos
, 
tx
, 
ty
, 
aùiÚ
)) {

1164 
upd©eH™Te¡ResuÉ
(
»suÉ
, 
IÁPošt
(
xPos
 - 
tx
, 
yPos
 - 
ty
));

1165  
	gŒue
;

1169  
	gçl£
;

	@RenderTableSection.h

25 #iâdeà
R’d”TabËSeùiÚ_h


26 
	#R’d”TabËSeùiÚ_h


	)

28 
	~"R’d”TabË.h
"

29 
	~<wtf/VeùÜ.h
>

31 
Çme¥aû
 
	gWebCÜe
 {

33 
şass
 
	gR’d”TabËC–l
;

34 
şass
 
	gR’d”TabËRow
;

36 şas 
	cR’d”TabËSeùiÚ
 : 
public
 
R’d”Box
 {

37 
public
:

38 
R’d”TabËSeùiÚ
(
Node
*);

39 
	gvœtu®
 ~
R’d”TabËSeùiÚ
();

41 cÚ¡ 
R’d”ObjeùChdLi¡
* 
chd»n
(ècÚ¡ {  &
	gm_chd»n
; }

42 
R’d”ObjeùChdLi¡
* 
chd»n
(è{  &
	gm_chd»n
; }

44 
vœtu®
 
addChd
(
R’d”Objeù
* 
chd
, R’d”Objeù* 
befÜeChd
 = 0);

46 
vœtu®
 
fœ¡LšeBoxBa£lše
() const;

48 
addC–l
(
R’d”TabËC–l
*, 
R’d”TabËRow
* 
row
);

50 
£tC–lWidths
();

51 
ÿlcRowHeight
();

52 
ÏyoutRows
(
height
);

54 
R’d”TabË
* 
bË
(ècÚ¡ {  
toR’d”TabË
(
·»Á
()); }

56 
	sC–lSŒuù
 {

57 
R’d”TabËC–l
* 
	gûÎ
;

58 
boŞ
 
	gšCŞS·n
;

61 
	gVeùÜ
<
	tC–lSŒuù
> 
	tRow
;

63 
	sRowSŒuù
 {

64 
Row
* 
	grow
;

65 
R’d”TabËRow
* 
	growR’d””
;

66 
	gba£lše
;

67 
L’gth
 
	gheight
;

70 
	gC–lSŒuù
& 
ûÎAt
(
row
, 
cŞ
è{  (*
	gm_grid
[row].
	grow
)[col]; }

71 cÚ¡ 
	gC–lSŒuù
& 
ûÎAt
(
row
, 
cŞ
ècÚ¡ {  (*
	gm_grid
[row].
	grow
)[col]; }

73 
­³ndCŞumn
(
pos
);

74 
¥l™CŞumn
(
pos
, 
ÃwSize
);

76 
ÿlcOu‹rBÜd”Tİ
() const;

77 
ÿlcOu‹rBÜd”BÙtom
() const;

78 
ÿlcOu‹rBÜd”Leá
(
boŞ
 
¹l
) const;

79 
ÿlcOu‹rBÜd”Right
(
boŞ
 
¹l
) const;

80 
»ÿlcOu‹rBÜd”
();

82 
ou‹rBÜd”Tİ
(ècÚ¡ {  
	gm_ou‹rBÜd”Tİ
; }

83 
ou‹rBÜd”BÙtom
(ècÚ¡ {  
	gm_ou‹rBÜd”BÙtom
; }

84 
ou‹rBÜd”Leá
(ècÚ¡ {  
	gm_ou‹rBÜd”Leá
; }

85 
ou‹rBÜd”Right
(ècÚ¡ {  
	gm_ou‹rBÜd”Right
; }

87 
numRows
(ècÚ¡ {  
	gm_gridRows
; }

88 
numCŞumns
() const;

89 
»ÿlcC–ls
();

90 
»ÿlcC–lsIfN“ded
()

92 ià(
	gm_ÃedsC–lReÿlc
)

93 
»ÿlcC–ls
();

96 
boŞ
 
ÃedsC–lReÿlc
(ècÚ¡ {  
	gm_ÃedsC–lReÿlc
; }

97 
£tN“dsC–lReÿlc
()

99 
	gm_ÃedsC–lReÿlc
 = 
Œue
;

100 
bË
()->
£tN“dsSeùiÚReÿlc
();

103 
g‘Ba£lše
(
row
è{  
	gm_grid
[row].
	gba£lše
; }

105 
	g´iv©e
:

106 
vœtu®
 
R’d”ObjeùChdLi¡
* 
vœtu®Chd»n
(è{  
chd»n
(); }

107 
vœtu®
 cÚ¡ 
R’d”ObjeùChdLi¡
* 
vœtu®Chd»n
(ècÚ¡ {  
chd»n
(); }

109 
vœtu®
 cÚ¡ * 
»nd”Name
(ècÚ¡ {  
isAnÚymous
() ? "RenderTableSection (anonymous)" : "RenderTableSection"; }

111 
vœtu®
 
boŞ
 
isTabËSeùiÚ
(ècÚ¡ {  
	gŒue
; }

113 
vœtu®
 
de¡roy
();

115 
vœtu®
 
Ïyout
();

117 
vœtu®
 
»moveChd
(
R’d”Objeù
* 
ŞdChd
);

119 
vœtu®
 
lowe¡Pos™iÚ
(
boŞ
 
šşudeOv”æowIÁ”iÜ
, boŞ 
šşudeS–f
) const;

120 
vœtu®
 
rightmo¡Pos™iÚ
(
boŞ
 
šşudeOv”æowIÁ”iÜ
, boŞ 
šşudeS–f
) const;

121 
vœtu®
 
Ëámo¡Pos™iÚ
(
boŞ
 
šşudeOv”æowIÁ”iÜ
, boŞ 
šşudeS–f
) const;

123 
vœtu®
 
·št
(
PaštInfo
&, 
tx
, 
ty
);

124 
vœtu®
 
·štObjeù
(
PaštInfo
&, 
tx
, 
ty
);

126 
vœtu®
 
imageChªged
(
W¿µedImagePŒ
, cÚ¡ 
IÁReù
* = 0);

128 
vœtu®
 
boŞ
 
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, 
x
, 
y
, 
tx
, 
ty
, 
H™Te¡AùiÚ
);

130 
vœtu®
 
lšeHeight
(
boŞ
, bool) const {  0; }

132 
boŞ
 
’su»Rows
();

133 
ş—rGrid
();

135 
R’d”ObjeùChdLi¡
 
	gm_chd»n
;

137 
	gVeùÜ
<
	gRowSŒuù
> 
	gm_grid
;

138 
	gVeùÜ
<> 
	gm_rowPos
;

140 
	gm_gridRows
;

143 
	gm_cCŞ
;

144 
	gm_cRow
;

146 
	gm_ou‹rBÜd”Leá
;

147 
	gm_ou‹rBÜd”Right
;

148 
	gm_ou‹rBÜd”Tİ
;

149 
	gm_ou‹rBÜd”BÙtom
;

151 
boŞ
 
	gm_ÃedsC–lReÿlc
;

152 
boŞ
 
	gm_hasOv”æowšgC–l
;

155 
šlše
 
R’d”TabËSeùiÚ
* 
	$toR’d”TabËSeùiÚ
(
R’d”Objeù
* 
objeù
)

157 
	`ASSERT
(!
objeù
 || objeù->
	`isTabËSeùiÚ
());

158  
¡©ic_ÿ¡
<
R’d”TabËSeùiÚ
*>(
objeù
);

159 
	}
}

161 
šlše
 cÚ¡ 
R’d”TabËSeùiÚ
* 
	$toR’d”TabËSeùiÚ
(cÚ¡ 
R’d”Objeù
* 
objeù
)

163 
	`ASSERT
(!
objeù
 || objeù->
	`isTabËSeùiÚ
());

164  
¡©ic_ÿ¡
<cÚ¡ 
R’d”TabËSeùiÚ
*>(
objeù
);

165 
	}
}

168 
toR’d”TabËSeùiÚ
(cÚ¡ 
R’d”TabËSeùiÚ
*);

	@RenderText.cpp

25 
	~"cÚfig.h
"

26 
	~"R’d”Text.h
"

28 
	~"AXObjeùCache.h
"

29 
	~"Ch¬aù”Names.h
"

30 
	~"EÎsisBox.h
"

31 
	~"FlßtQuad.h
"

32 
	~"F¿meV›w.h
"

33 
	~"IÆšeTextBox.h
"

34 
	~"Rªge.h
"

35 
	~"R’d”A»Ç.h
"

36 
	~"R’d”Block.h
"

37 
	~"R’d”Lay”.h
"

38 
	~"R’d”V›w.h
"

39 
	~"SŒšgBufãr.h
"

40 
	~"Text.h
"

41 
	~"TextB»akI‹¿tÜ.h
"

42 
	~"VisibËPos™iÚ.h
"

43 
	~"b»ak_lšes.h
"

44 
	~<wtf/AlwaysIÆše.h
>

46 
usšg
 
Çme¥aû
 
	g¡d
;

47 
usšg
 
Çme¥aû
 
	gWTF
;

48 
usšg
 
Çme¥aû
 
	gUnicode
;

50 
Çme¥aû
 
	gWebCÜe
 {

52 
makeC­™®ized
(
SŒšg
* 
¡ršg
, 
UCh¬
 
´evious
)

54 ià(
	g¡ršg
->
isNuÎ
())

57 
	gËngth
 = 
¡ršg
->
Ëngth
();

58 cÚ¡ 
UCh¬
* 
	gch¬aù”s
 = 
¡ršg
->
ch¬aù”s
();

60 
SŒšgBufãr
 
¡ršgW™hP»vious
(
Ëngth
 + 1);

61 
	g¡ršgW™hP»vious
[0] = 
´evious
 =ğ
noB»akS·û
 ? ' ' :…revious;

62 
	gi
 = 1; i < 
	gËngth
 + 1; i++) {

64 ià(
	gch¬aù”s
[
i
 - 1] =ğ
noB»akS·û
)

65 
¡ršgW™hP»vious
[
i
] = ' ';

67 
	g¡ršgW™hP»vious
[
i
] = 
ch¬aù”s
[i - 1];

70 
TextB»akI‹¿tÜ
* 
	gbound¬y
 = 
wÜdB»akI‹¿tÜ
(
¡ršgW™hP»vious
.
ch¬aù”s
(), 
Ëngth
 + 1);

71 ià(!
	gbound¬y
)

74 
SŒšgBufãr
 
d©a
(
Ëngth
);

76 
št32_t
 
	g’dOfWÜd
;

77 
št32_t
 
	g¡¬tOfWÜd
 = 
‹xtB»akFœ¡
(
bound¬y
);

78 
	g’dOfWÜd
 = 
‹xtB»akNext
(
bound¬y
);ƒndOfWÜd !ğ
TextB»akDÚe
; 
	g¡¬tOfWÜd
 = 
’dOfWÜd
,ƒndOfWord =extBreakNext(boundary)) {

79 ià(
¡¬tOfWÜd
 != 0)

80 
d©a
[
¡¬tOfWÜd
 - 1] = 
ch¬aù”s
[¡¬tOfWÜd - 1] =ğ
noB»akS·û
 ?‚oB»akS·û : 
toT™ËCa£
(
¡ršgW™hP»vious
[startOfWord]);

81 
	gi
 = 
¡¬tOfWÜd
 + 1; i < 
	g’dOfWÜd
; i++)

82 
	gd©a
[
i
 - 1] = 
ch¬aù”s
[i - 1];

85 *
	g¡ršg
 = 
SŒšg
::
adİt
(
d©a
);

88 
	gR’d”Text
::
R’d”Text
(
Node
* 
node
, 
PassRefPŒ
<
SŒšgIm¶
> 
¡r
)

89 : 
R’d”Objeù
(
node
)

90 , 
m_mšWidth
(-1)

91 , 
m_‹xt
(
docum’t
()->
di¥ÏySŒšgModif›dByEncodšg
(
¡r
))

92 , 
m_fœ¡TextBox
(0)

93 , 
m_Ï¡TextBox
(0)

94 , 
m_maxWidth
(-1)

95 , 
m_begšMšWidth
(0)

96 , 
m_’dMšWidth
(0)

97 , 
m_hasTab
(
çl£
)

98 , 
m_lšesDœty
(
çl£
)

99 , 
m_cÚšsRev”£dText
(
çl£
)

100 , 
m_isAÎASCII
(
m_‹xt
.
cÚšsOÆyASCII
())

101 , 
m_knownToHaveNoOv”æowAndNoF®lbackFÚts
(
çl£
)

103 
ASSERT
(
m_‹xt
);

105 
£tIsText
();

110 
v›w
()->
äameV›w
()->
£tIsVisu®lyNÚEm±y
();

113 #iâdeà
NDEBUG


115 
	gR’d”Text
::~
R’d”Text
()

117 
ASSERT
(!
m_fœ¡TextBox
);

118 
ASSERT
(!
m_Ï¡TextBox
);

123 cÚ¡ * 
	gR’d”Text
::
»nd”Name
() const

128 
boŞ
 
	gR’d”Text
::
isTextF¿gm’t
() const

130  
çl£
;

133 
boŞ
 
	gR’d”Text
::
isWÜdB»ak
() const

135  
çl£
;

138 
	gR’d”Text
::
¡yËDidChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
)

144 ià(
	gdiff
 =ğ
StyËDifã»nûLayout
) {

145 
£tN“dsLayoutAndP»fWidthsReÿlc
();

146 
	gm_knownToHaveNoOv”æowAndNoF®lbackFÚts
 = 
çl£
;

149 
ETextT¿nsfÜm
 
	gŞdT¿nsfÜm
 = 
ŞdStyË
 ? oldStyË->
‹xtT¿nsfÜm
(è: 
TTNONE
;

150 
ETextSecur™y
 
	gŞdSecur™y
 = 
ŞdStyË
 ? oldStyË->
‹xtSecur™y
(è: 
TSNONE
;

152 ià(
	gŞdT¿nsfÜm
 !ğ
¡yË
()->
‹xtT¿nsfÜm
(è|| 
ŞdSecur™y
 !ğ¡yË()->
‹xtSecur™y
()) {

153 ià(
RefPŒ
<
SŒšgIm¶
> 
‹xtToT¿nsfÜm
 = 
Üigš®Text
())

154 
£tText
(
‹xtToT¿nsfÜm
.
»Ëa£
(), 
Œue
);

158 
	gR’d”Text
::
de¡roy
()

160 ià(!
docum’tBešgDe¡royed
()) {

161 ià(
fœ¡TextBox
()) {

162 ià(
isBR
()) {

163 
RoÙIÆšeBox
* 
Ãxt
 = 
fœ¡TextBox
()->
roÙ
()->
ÃxtRoÙBox
();

164 ià(
	gÃxt
)

165 
	gÃxt
->
m¬kDœty
();

167 
IÆšeTextBox
* 
	gbox
 = 
fœ¡TextBox
(); box; box = 
box
->
ÃxtTextBox
())

168 
box
->
»move
();

169 } ià(
·»Á
())

170 
·»Á
()->
dœtyLšesFromChªgedChd
(
this
);

172 
d–‘eTextBoxes
();

173 
	gR’d”Objeù
::
de¡roy
();

176 
	gR’d”Text
::
exŒaùTextBox
(
IÆšeTextBox
* 
box
)

178 
checkCÚsi¡’cy
();

180 
	gm_Ï¡TextBox
 = 
box
->
´evTextBox
();

181 ià(
	gbox
 =ğ
m_fœ¡TextBox
)

182 
m_fœ¡TextBox
 = 0;

183 ià(
	gbox
->
´evTextBox
())

184 
	gbox
->
´evTextBox
()->
£tNextTextBox
(0);

185 
	gbox
->
£tP»viousTextBox
(0);

186 
IÆšeTextBox
* 
	gcu¼
 = 
box
; cu¼; cu¼ = 
cu¼
->
ÃxtTextBox
())

187 
cu¼
->
£tExŒaùed
();

189 
checkCÚsi¡’cy
();

192 
	gR’d”Text
::
©chTextBox
(
IÆšeTextBox
* 
box
)

194 
checkCÚsi¡’cy
();

196 ià(
	gm_Ï¡TextBox
) {

197 
	gm_Ï¡TextBox
->
£tNextTextBox
(
box
);

198 
	gbox
->
£tP»viousTextBox
(
m_Ï¡TextBox
);

200 
	gm_fœ¡TextBox
 = 
box
;

201 
IÆšeTextBox
* 
	gÏ¡
 = 
box
;

202 
IÆšeTextBox
* 
	gcu¼
 = 
box
; cu¼; cu¼ = 
cu¼
->
ÃxtTextBox
()) {

203 
cu¼
->
£tExŒaùed
(
çl£
);

204 
	gÏ¡
 = 
cu¼
;

206 
	gm_Ï¡TextBox
 = 
Ï¡
;

208 
checkCÚsi¡’cy
();

211 
	gR’d”Text
::
»moveTextBox
(
IÆšeTextBox
* 
box
)

213 
checkCÚsi¡’cy
();

215 ià(
	gbox
 =ğ
m_fœ¡TextBox
)

216 
m_fœ¡TextBox
 = 
box
->
ÃxtTextBox
();

217 ià(
	gbox
 =ğ
m_Ï¡TextBox
)

218 
m_Ï¡TextBox
 = 
box
->
´evTextBox
();

219 ià(
	gbox
->
ÃxtTextBox
())

220 
	gbox
->
ÃxtTextBox
()->
£tP»viousTextBox
(
box
->
´evTextBox
());

221 ià(
	gbox
->
´evTextBox
())

222 
	gbox
->
´evTextBox
()->
£tNextTextBox
(
box
->
ÃxtTextBox
());

224 
checkCÚsi¡’cy
();

227 
	gR’d”Text
::
d–‘eTextBoxes
()

229 ià(
fœ¡TextBox
()) {

230 
R’d”A»Ç
* 
¬’a
 = 
»nd”A»Ç
();

231 
IÆšeTextBox
* 
	gÃxt
;

232 
IÆšeTextBox
* 
	gcu¼
 = 
fœ¡TextBox
(); cu¼; cu¼ = 
Ãxt
) {

233 
Ãxt
 = 
cu¼
->
ÃxtTextBox
();

234 
	gcu¼
->
de¡roy
(
¬’a
);

236 
	gm_fœ¡TextBox
 = 
m_Ï¡TextBox
 = 0;

240 
	gPassRefPŒ
<
	gSŒšgIm¶
> 
	gR’d”Text
::
Üigš®Text
() const

242 
Node
* 
e
 = 
node
();

243  
	ge
 ? 
	g¡©ic_ÿ¡
<
	gText
*>Ó)->
d©aIm¶
() : 0;

246 
	gR’d”Text
::
absŞu‹Reùs
(
VeùÜ
<
IÁReù
>& 
»ùs
, 
tx
, 
ty
)

248 
IÆšeTextBox
* 
	gbox
 = 
fœ¡TextBox
(); box; box = 
box
->
ÃxtTextBox
())

249 
»ùs
.
­³nd
(
IÁReù
(
tx
 + 
box
->
x
(), 
ty
 + box->
y
(), box->
width
(), box->
height
()));

252 
	gR’d”Text
::
absŞu‹ReùsFÜRªge
(
VeùÜ
<
IÁReù
>& 
»ùs
, 
¡¬t
, 
’d
, 
boŞ
 
u£S–eùiÚHeight
)

259 
ASSERT
(
’d
 =ğ
UINT_MAX
 ||ƒnd <ğ
INT_MAX
);

260 
ASSERT
(
¡¬t
 <ğ
INT_MAX
);

261 
	g¡¬t
 = 
mš
(
¡¬t
, 
¡©ic_ÿ¡
<>(
INT_MAX
));

262 
	g’d
 = 
mš
(
’d
, 
¡©ic_ÿ¡
<>(
INT_MAX
));

264 
IÆšeTextBox
* 
	gbox
 = 
fœ¡TextBox
(); box; box = 
box
->
ÃxtTextBox
()) {

266 ià(
¡¬t
 <ğ
box
->¡¬t(è&& box->
’d
() <ƒnd) {

267 
IÁReù
 
r
 = IÁReù(
box
->
x
(), box->
y
(), box->
width
(), box->
height
());

268 ià(
	gu£S–eùiÚHeight
) {

269 
IÁReù
 
	g£ËùiÚReù
 = 
box
->
£ËùiÚReù
(0, 0, 
¡¬t
, 
’d
);

270 
	gr
.
£tHeight
(
£ËùiÚReù
.
height
());

271 
	gr
.
£tY
(
£ËùiÚReù
.
y
());

273 
FlßtPošt
 
	gÜigš
 = 
loÿlToAbsŞu‹
(
r
.
loÿtiÚ
());

274 
	gr
.
£tX
(
Üigš
.
x
());

275 
	gr
.
£tY
(
Üigš
.
y
());

276 
	g»ùs
.
­³nd
(
r
);

278 
	g»®End
 = 
mš
(
box
->
’d
() + 1,ƒnd);

279 
IÁReù
 
	gr
 = 
box
->
£ËùiÚReù
(0, 0, 
¡¬t
, 
»®End
);

280 ià(!
	gr
.
isEm±y
()) {

281 ià(!
	gu£S–eùiÚHeight
) {

283 
	gr
.
£tHeight
(
box
->
height
());

284 
	gr
.
£tY
(
box
->
y
());

286 
FlßtPošt
 
	gÜigš
 = 
loÿlToAbsŞu‹
(
r
.
loÿtiÚ
());

287 
loÿlToAbsŞu‹
(
Üigš
);

288 
	gr
.
£tX
(
Üigš
.
x
());

289 
	gr
.
£tY
(
Üigš
.
y
());

290 
	g»ùs
.
­³nd
(
r
);

296 
	gR’d”Text
::
absŞu‹Quads
(
VeùÜ
<
FlßtQuad
>& 
quads
)

298 
IÆšeTextBox
* 
box
 = 
fœ¡TextBox
(); 
	gbox
; box = box->
ÃxtTextBox
())

299 
quads
.
­³nd
(
loÿlToAbsŞu‹Quad
(
FlßtReù
(
box
->
x
(), box->
y
(), box->
width
(), box->
height
())));

302 
	gR’d”Text
::
absŞu‹QuadsFÜRªge
(
VeùÜ
<
FlßtQuad
>& 
quads
, 
¡¬t
, 
’d
, 
boŞ
 
u£S–eùiÚHeight
)

309 
ASSERT
(
’d
 =ğ
UINT_MAX
 ||ƒnd <ğ
INT_MAX
);

310 
ASSERT
(
¡¬t
 <ğ
INT_MAX
);

311 
	g¡¬t
 = 
mš
(
¡¬t
, 
¡©ic_ÿ¡
<>(
INT_MAX
));

312 
	g’d
 = 
mš
(
’d
, 
¡©ic_ÿ¡
<>(
INT_MAX
));

314 
IÆšeTextBox
* 
	gbox
 = 
fœ¡TextBox
(); box; box = 
box
->
ÃxtTextBox
()) {

316 ià(
¡¬t
 <ğ
box
->¡¬t(è&& box->
’d
() <ƒnd) {

317 
IÁReù
 
r
 = IÁReù(
box
->
x
(), box->
y
(), box->
width
(), box->
height
());

318 ià(
	gu£S–eùiÚHeight
) {

319 
IÁReù
 
	g£ËùiÚReù
 = 
box
->
£ËùiÚReù
(0, 0, 
¡¬t
, 
’d
);

320 
	gr
.
£tHeight
(
£ËùiÚReù
.
height
());

321 
	gr
.
£tY
(
£ËùiÚReù
.
y
());

323 
	gquads
.
­³nd
(
loÿlToAbsŞu‹Quad
(
FlßtReù
(
r
)));

325 
	g»®End
 = 
mš
(
box
->
’d
() + 1,ƒnd);

326 
IÁReù
 
	gr
 = 
box
->
£ËùiÚReù
(0, 0, 
¡¬t
, 
»®End
);

327 ià(
	gr
.
height
()) {

328 ià(!
	gu£S–eùiÚHeight
) {

330 
	gr
.
£tHeight
(
box
->
height
());

331 
	gr
.
£tY
(
box
->
y
());

333 
	gquads
.
­³nd
(
loÿlToAbsŞu‹Quad
(
FlßtReù
(
r
)));

339 
IÆšeTextBox
* 
	gR’d”Text
::
fšdNextIÆšeTextBox
(
off£t
, & 
pos
) const

346 ià(!
	gm_fœ¡TextBox
)

349 
IÆšeTextBox
* 
	gs
 = 
m_fœ¡TextBox
;

350 
	goff
 = 
s
->
Ën
();

351 
	goff£t
 > 
	goff
 && 
	gs
->
ÃxtTextBox
()) {

352 
	gs
 = 
s
->
ÃxtTextBox
();

353 
	goff
 = 
s
->
¡¬t
(è+ s->
Ën
();

356 
	gpos
 = (
off£t
 > 
off
 ? 
s
->
Ën
() : s->len() - (off - offset) );

357  
	gs
;

360 
VisibËPos™iÚ
 
	gR’d”Text
::
pos™iÚFÜPošt
(cÚ¡ 
IÁPošt
& 
pošt
)

362 ià(!
fœ¡TextBox
(è|| 
‹xtL’gth
() == 0)

363  
ü—‹VisibËPos™iÚ
(0, 
DOWNSTREAM
);

366 
	goff£t
;

369 ià(
fœ¡TextBox
(è&& 
	gpošt
.
y
(è< fœ¡TextBox()->
roÙ
()->
lšeBÙtom
(è&&…ošt.
x
(è< fœ¡TextBox()->
	gm_x
) {

372 
	goff£t
 = 
fœ¡TextBox
()->
off£tFÜPos™iÚ
(
pošt
.
x
());

373  
ü—‹VisibËPos™iÚ
(
off£t
 + 
fœ¡TextBox
()->
¡¬t
(), 
DOWNSTREAM
);

375 ià(
Ï¡TextBox
(è&& 
	gpošt
.
y
(è>ğÏ¡TextBox()->
roÙ
()->
lšeTİ
(è&& 
pošt
.
x
(è>ğÏ¡TextBox()->
m_x
 +†a¡TextBox()->
m_width
) {

378 
off£t
 = 
Ï¡TextBox
()->
off£tFÜPos™iÚ
(
pošt
.
x
());

379  
ü—‹VisibËPos™iÚ
(
off£t
 + 
Ï¡TextBox
()->
¡¬t
(), 
VP_UPSTREAM_IF_POSSIBLE
);

382 
IÆšeTextBox
* 
	gÏ¡BoxAbove
 = 0;

383 
IÆšeTextBox
* 
	gbox
 = 
fœ¡TextBox
(); box; box = 
box
->
ÃxtTextBox
()) {

384 ià(
pošt
.
y
(è>ğ
box
->
roÙ
()->
lšeTİ
()) {

385 
bÙtom
 = 
box
->
roÙ
()->
ÃxtRoÙBox
(è? box->roÙ()->ÃxtRoÙBox()->
lšeTİ
(è: box->roÙ()->
lšeBÙtom
();

386 ià(
	gpošt
.
y
(è< 
	gbÙtom
) {

387 
	goff£t
 = 
box
->
off£tFÜPos™iÚ
(
pošt
.
x
());

389 ià(
	gpošt
.
x
(è=ğ
box
->
m_x
)

392  
ü—‹VisibËPos™iÚ
(
off£t
 + 
box
->
¡¬t
(), 
DOWNSTREAM
);

394 ià(
	gpošt
.
x
(è< 
	gbox
->
	gm_x
 + box->
	gm_width
)

397  
ü—‹VisibËPos™iÚ
(
off£t
 + 
box
->
¡¬t
(), off£ˆ> 0 ? 
VP_UPSTREAM_IF_POSSIBLE
 : 
DOWNSTREAM
);

399 ià(!
	gbox
->
´evOnLše
(è&& 
	gpošt
.
x
(è< box->
	gm_x
)

402  
ü—‹VisibËPos™iÚ
(
off£t
 + 
box
->
¡¬t
(), 
DOWNSTREAM
);

404 ià(!
	gbox
->
ÃxtOnLše
())

408  
ü—‹VisibËPos™iÚ
(
off£t
 + 
box
->
¡¬t
(), off£ˆ> 0 ? 
VP_UPSTREAM_IF_POSSIBLE
 : 
DOWNSTREAM
);

410 
	gÏ¡BoxAbove
 = 
box
;

414  
ü—‹VisibËPos™iÚ
(
Ï¡BoxAbove
 ?†a¡BoxAbove->
¡¬t
(è+†a¡BoxAbove->
Ën
(è: 0, 
DOWNSTREAM
);

417 
IÁReù
 
	gR’d”Text
::
loÿlC¬‘Reù
(
IÆšeBox
* 
šlšeBox
, 
ÿ»tOff£t
, * 
exŒaWidthToEndOfLše
)

419 ià(!
	gšlšeBox
)

420  
IÁReù
();

422 
ASSERT
(
šlšeBox
->
isIÆšeTextBox
());

423 ià(!
	gšlšeBox
->
isIÆšeTextBox
())

424  
IÁReù
();

426 
IÆšeTextBox
* 
	gbox
 = 
¡©ic_ÿ¡
<IÆšeTextBox*>(
šlšeBox
);

428 
	gheight
 = 
box
->
roÙ
()->
lšeBÙtom
(è- box->roÙ()->
lšeTİ
();

429 
	gtİ
 = 
box
->
roÙ
()->
lšeTİ
();

431 
	gËá
 = 
box
->
pos™iÚFÜOff£t
(
ÿ»tOff£t
);

434 
	gÿ»tWidthLeáOfOff£t
 = 
ÿ»tWidth
 / 2;

435 
	gËá
 -ğ
ÿ»tWidthLeáOfOff£t
;

436 
	gÿ»tWidthRightOfOff£t
 = 
ÿ»tWidth
 - 
ÿ»tWidthLeáOfOff£t
;

438 
	groÙLeá
 = 
box
->
roÙ
()->
x
();

439 
	groÙRight
 = 
roÙLeá
 + 
box
->
roÙ
()->
width
();

442 ià(
	gexŒaWidthToEndOfLše
)

443 *
	gexŒaWidthToEndOfLše
 = (
box
->
roÙ
()->
width
(è+ 
roÙLeá
è- (
Ëá
 + 1);

445 
R’d”Block
* 
	gcb
 = 
cÚššgBlock
();

446 ià(
¡yË
()->
autoW¿p
()) {

447 
	gavaabËWidth
 = 
cb
->
lšeWidth
(
tİ
, 
çl£
);

448 ià(
	gbox
->
dœeùiÚ
(è=ğ
LTR
)

449 
Ëá
 = 
mš
Öeá, 
roÙLeá
 + 
avaabËWidth
 - 
ÿ»tWidthRightOfOff£t
);

451 
	gËá
 = 
max
(
Ëá
, 
cb
->
x
());

454 ià(
	gcb
->
¡yË
()->
dœeùiÚ
(è=ğ
LTR
) {

455 
rightEdge
 = 
max
(
cb
->
width
(), 
roÙRight
);

456 
	gËá
 = 
mš
(
Ëá
, 
rightEdge
 - 
ÿ»tWidthRightOfOff£t
);

457 
	gËá
 = 
max
(
Ëá
, 
roÙLeá
);

459 
	gËáEdge
 = 
mš
(
cb
->
x
(), 
roÙLeá
);

460 
	gËá
 = 
max
(
Ëá
, 
ËáEdge
);

461 
	gËá
 = 
mš
(
Ëá
, 
roÙRight
 - 
ÿ»tWidth
);

465  
IÁReù
(
Ëá
, 
tİ
, 
ÿ»tWidth
, 
height
);

468 
ALWAYS_INLINE
 
	gR’d”Text
::
widthFromCache
(cÚ¡ 
FÚt
& 
f
, 
¡¬t
, 
Ën
, 
xPos
, 
HashS‘
<cÚ¡ 
Sim¶eFÚtD©a
*>* 
çÎbackFÚts
, 
GlyphOv”æow
* 
glyphOv”æow
) const

470 ià(
	gf
.
isFixedP™ch
(è&& !f.
isSm®lC­s
(è&& 
	gm_isAÎASCII
) {

471 
	gmÚo¥aûCh¬aù”Width
 = 
f
.
¥aûWidth
();

472 
	gbWidth
 = 
®lowTabs
(è? 
mÚo¥aûCh¬aù”Width
 * 8 : 0;

473 
	gw
 = 0;

474 
boŞ
 
	gisS·û
;

475 
boŞ
 
	g´eviousCh¬WasS·û
 = 
Œue
;

476 
ASSERT
(
m_‹xt
);

477 
	gSŒšgIm¶
& 
	g‹xt
 = *
m_‹xt
.
im¶
();

478 
	gi
 = 
¡¬t
; i < 
	g¡¬t
 + 
	gËn
; i++) {

479 
	gc
 = 
‹xt
[
i
];

480 ià(
	gc
 <= ' ') {

481 ià(
c
 == ' ' || c == '\n') {

482 
w
 +ğ
mÚo¥aûCh¬aù”Width
;

483 
	gisS·û
 = 
Œue
;

484 } ià(
	gc
 == '\t') {

485 
w
 +ğ
bWidth
 ?abWidth - ((
xPos
 + wè%abWidthè: 
mÚo¥aûCh¬aù”Width
;

486 
	gisS·û
 = 
Œue
;

488 
	gisS·û
 = 
çl£
;

490 
	gw
 +ğ
mÚo¥aûCh¬aù”Width
;

491 
	gisS·û
 = 
çl£
;

493 ià(
	gisS·û
 && !
	g´eviousCh¬WasS·û
)

494 
	gw
 +ğ
f
.
wÜdS·cšg
();

495 
	g´eviousCh¬WasS·û
 = 
isS·û
;

497  
	gw
;

500  
	gf
.
width
(
TextRun
(
‹xt
()->
ch¬aù”s
(è+ 
¡¬t
, 
Ën
, 
®lowTabs
(), 
xPos
), 
çÎbackFÚts
, 
glyphOv”æow
);

503 
	gR’d”Text
::
ŒimmedP»fWidths
(
ËadWidth
,

504 & 
begšMšW
, 
boŞ
& 
begšWS
,

505 & 
’dMšW
, 
boŞ
& 
’dWS
,

506 
boŞ
& 
hasB»akabËCh¬
, boŞ& 
hasB»ak
,

507 & 
begšMaxW
, & 
’dMaxW
,

508 & 
mšW
, & 
maxW
, 
boŞ
& 
¡rFrÚtS·ûs
)

510 
boŞ
 
	gcŞÏp£Wh™eS·û
 = 
¡yË
()->
cŞÏp£Wh™eS·û
();

511 ià(!
	gcŞÏp£Wh™eS·û
)

512 
	g¡rFrÚtS·ûs
 = 
çl£
;

514 ià(
	gm_hasTab
 || 
´efWidthsDœty
())

515 
ÿlcP»fWidths
(
ËadWidth
);

517 
	gbegšWS
 = !
¡rFrÚtS·ûs
 && 
m_hasBegšWS
;

518 
	g’dWS
 = 
m_hasEndWS
;

520 
	gËn
 = 
‹xtL’gth
();

522 ià(!
	gËn
 || (
	g¡rFrÚtS·ûs
 && 
‹xt
()->
cÚšsOÆyWh™e¥aû
())) {

523 
	gbegšMšW
 = 0;

524 
	g’dMšW
 = 0;

525 
	gbegšMaxW
 = 0;

526 
	g’dMaxW
 = 0;

527 
	gmšW
 = 0;

528 
	gmaxW
 = 0;

529 
	ghasB»ak
 = 
çl£
;

533 
	gmšW
 = 
m_mšWidth
;

534 
	gmaxW
 = 
m_maxWidth
;

536 
	gbegšMšW
 = 
m_begšMšWidth
;

537 
	g’dMšW
 = 
m_’dMšWidth
;

539 
	ghasB»akabËCh¬
 = 
m_hasB»akabËCh¬
;

540 
	ghasB»ak
 = 
m_hasB»ak
;

542 
ASSERT
(
m_‹xt
);

543 
	gSŒšgIm¶
& 
	g‹xt
 = *
m_‹xt
.
im¶
();

544 ià(
	g‹xt
[0] =ğ' ' || (
‹xt
[0] =ğ'\n' && !
¡yË
()->
´e£rveNewlše
()) ||ext[0] == '\t') {

545 cÚ¡ 
FÚt
& 
f
 = 
¡yË
()->
fÚt
();

546 ià(
	g¡rFrÚtS·ûs
) {

547 cÚ¡ 
UCh¬
 
	g¥aû
 = ' ';

548 
	g¥aûWidth
 = 
f
.
width
(
TextRun
(&
¥aû
, 1));

549 
	gmaxW
 -ğ
¥aûWidth
;

551 
	gmaxW
 +ğ
f
.
wÜdS·cšg
();

554 
	g¡rFrÚtS·ûs
 = 
cŞÏp£Wh™eS·û
 && 
m_hasEndWS
;

556 ià(!
¡yË
()->
autoW¿p
(è|| 
	gmšW
 > 
	gmaxW
)

557 
	gmšW
 = 
maxW
;

560 ià(
	ghasB»ak
) {

561 cÚ¡ 
	gFÚt
& 
	gf
 = 
¡yË
()->
fÚt
();

562 
boŞ
 
	gfœ¡Lše
 = 
Œue
;

563 
	gbegšMaxW
 = 
maxW
;

564 
	g’dMaxW
 = 
maxW
;

565 
	gi
 = 0; i < 
	gËn
; i++) {

566 
	glš–’
 = 0;

567 
	gi
 + 
	glš–’
 < 
	gËn
 && 
	g‹xt
[
i
 + 
lš–’
] != '\n')

568 
lš–’
++;

570 ià(
	glš–’
) {

571 
	g’dMaxW
 = 
widthFromCache
(
f
, 
i
, 
lš–’
, 
ËadWidth
 + 
’dMaxW
, 0, 0);

572 ià(
	gfœ¡Lše
) {

573 
	gfœ¡Lše
 = 
çl£
;

574 
	gËadWidth
 = 0;

575 
	gbegšMaxW
 = 
’dMaxW
;

577 
	gi
 +ğ
lš–’
;

578 } ià(
	gfœ¡Lše
) {

579 
	gbegšMaxW
 = 0;

580 
	gfœ¡Lše
 = 
çl£
;

581 
	gËadWidth
 = 0;

584 ià(
	gi
 =ğ
Ën
 - 1)

587 
’dMaxW
 = 0;

592 
šlše
 
boŞ
 
isS·ûAccÜdšgToStyË
(
UCh¬
 
c
, 
R’d”StyË
* 
¡yË
)

594  
	gc
 =ğ' ' || (
c
 =ğ
noB»akS·û
 && 
¡yË
->
nb¥Mode
(è=ğ
SPACE
);

597 
	gR’d”Text
::
mšP»fWidth
() const

599 ià(
´efWidthsDœty
())

600 
cÚ¡_ÿ¡
<
R’d”Text
*>(
this
)->
ÿlcP»fWidths
(0);

602  
	gm_mšWidth
;

605 
	gR’d”Text
::
maxP»fWidth
() const

607 ià(
´efWidthsDœty
())

608 
cÚ¡_ÿ¡
<
R’d”Text
*>(
this
)->
ÿlcP»fWidths
(0);

610  
	gm_maxWidth
;

613 
	gR’d”Text
::
ÿlcP»fWidths
(
ËadWidth
)

615 
HashS‘
<cÚ¡ 
Sim¶eFÚtD©a
*> 
çÎbackFÚts
;

616 
GlyphOv”æow
 
	gglyphOv”æow
;

617 
ÿlcP»fWidths
(
ËadWidth
, 
çÎbackFÚts
, 
glyphOv”æow
);

618 ià(
	gçÎbackFÚts
.
isEm±y
(è&& !
	gglyphOv”æow
.
	gËá
 && !glyphOv”æow.
	gright
 && !glyphOv”æow.
	gtİ
 && !glyphOv”æow.
	gbÙtom
)

619 
	gm_knownToHaveNoOv”æowAndNoF®lbackFÚts
 = 
Œue
;

622 
	gR’d”Text
::
ÿlcP»fWidths
(
ËadWidth
, 
HashS‘
<cÚ¡ 
Sim¶eFÚtD©a
*>& 
çÎbackFÚts
, 
GlyphOv”æow
& 
glyphOv”æow
)

624 
ASSERT
(
m_hasTab
 || 
´efWidthsDœty
(è|| !
m_knownToHaveNoOv”æowAndNoF®lbackFÚts
);

626 
	gm_mšWidth
 = 0;

627 
	gm_begšMšWidth
 = 0;

628 
	gm_’dMšWidth
 = 0;

629 
	gm_maxWidth
 = 0;

631 ià(
isBR
())

634 
	gcu¼MšWidth
 = 0;

635 
	gcu¼MaxWidth
 = 0;

636 
	gm_hasB»akabËCh¬
 = 
çl£
;

637 
	gm_hasB»ak
 = 
çl£
;

638 
	gm_hasTab
 = 
çl£
;

639 
	gm_hasBegšWS
 = 
çl£
;

640 
	gm_hasEndWS
 = 
çl£
;

642 cÚ¡ 
	gFÚt
& 
	gf
 = 
¡yË
()->
fÚt
();

643 
	gwÜdS·cšg
 = 
¡yË
()->
wÜdS·cšg
();

644 
	gËn
 = 
‹xtL’gth
();

645 cÚ¡ 
UCh¬
* 
	gtxt
 = 
ch¬aù”s
();

646 
boŞ
 
	gÃedsWÜdS·cšg
 = 
çl£
;

647 
boŞ
 
	gignÜšgS·ûs
 = 
çl£
;

648 
boŞ
 
	gisS·û
 = 
çl£
;

649 
boŞ
 
	gfœ¡WÜd
 = 
Œue
;

650 
boŞ
 
	gfœ¡Lše
 = 
Œue
;

651 
	gÃxtB»akabË
 = -1;

652 
	gÏ¡WÜdBound¬y
 = 0;

654 
	gfœ¡GlyphLeáOv”æow
 = -1;

656 
boŞ
 
	gb»akNBSP
 = 
¡yË
()->
autoW¿p
(è&& styË()->
nb¥Mode
(è=ğ
SPACE
;

657 
boŞ
 
	gb»akAÎ
 = (
¡yË
()->
wÜdB»ak
(è=ğ
B»akAÎWÜdB»ak
 || styË()->wÜdB»ak(è=ğ
B»akWÜdB»ak
è&& styË()->
autoW¿p
();

659 
	gi
 = 0; i < 
	gËn
; i++) {

660 
UCh¬
 
	gc
 = 
txt
[
i
];

662 
boŞ
 
	g´eviousCh¬aù”IsS·û
 = 
isS·û
;

664 
boŞ
 
	gisNewlše
 = 
çl£
;

665 ià(
	gc
 == '\n') {

666 ià(
¡yË
()->
´e£rveNewlše
()) {

667 
m_hasB»ak
 = 
Œue
;

668 
	gisNewlše
 = 
Œue
;

669 
	gisS·û
 = 
çl£
;

671 
	gisS·û
 = 
Œue
;

672 } ià(
	gc
 == '\t') {

673 ià(!
¡yË
()->
cŞÏp£Wh™eS·û
()) {

674 
m_hasTab
 = 
Œue
;

675 
	gisS·û
 = 
çl£
;

677 
	gisS·û
 = 
Œue
;

679 
	gisS·û
 = 
c
 == ' ';

681 ià((
	gisS·û
 || 
	gisNewlše
è&& !
	gi
)

682 
	gm_hasBegšWS
 = 
Œue
;

683 ià((
	gisS·û
 || 
	gisNewlše
è&& 
	gi
 =ğ
Ën
 - 1)

684 
m_hasEndWS
 = 
Œue
;

686 ià(!
	gignÜšgS·ûs
 && 
¡yË
()->
cŞÏp£Wh™eS·û
(è&& 
	g´eviousCh¬aù”IsS·û
 && 
	gisS·û
)

687 
	gignÜšgS·ûs
 = 
Œue
;

689 ià(
	gignÜšgS·ûs
 && !
	gisS·û
)

690 
	gignÜšgS·ûs
 = 
çl£
;

693 ià(
	gignÜšgS·ûs
) {

694 
ASSERT
(
Ï¡WÜdBound¬y
 =ğ
i
);

695 
	gÏ¡WÜdBound¬y
++;

697 } ià(
	gc
 =ğ
soáHyph’
) {

698 
cu¼MaxWidth
 +ğ
widthFromCache
(
f
, 
Ï¡WÜdBound¬y
, 
i
 -†a¡WÜdBound¬y, 
ËadWidth
 + cu¼MaxWidth, &
çÎbackFÚts
, &
glyphOv”æow
);

699 ià(
	gfœ¡GlyphLeáOv”æow
 < 0)

700 
	gfœ¡GlyphLeáOv”æow
 = 
glyphOv”æow
.
Ëá
;

701 
	gÏ¡WÜdBound¬y
 = 
i
 + 1;

705 
boŞ
 
	ghasB»ak
 = 
b»akAÎ
 || 
isB»akabË
(
txt
, 
i
, 
Ën
, 
ÃxtB»akabË
, 
b»akNBSP
);

706 
boŞ
 
	gb‘w“nWÜds
 = 
Œue
;

707 
	gj
 = 
i
;

708 
	gc
 !ğ'\n' && !
isS·ûAccÜdšgToStyË
(
c
, 
¡yË
()è&& c !ğ'\t' && c !ğ
soáHyph’
) {

709 
j
++;

710 ià(
	gj
 =ğ
Ën
)

712 
	gc
 = 
txt
[
j
];

713 ià(
isB»akabË
(
txt
, 
j
, 
Ën
, 
ÃxtB»akabË
, 
b»akNBSP
))

715 ià(
	gb»akAÎ
) {

716 
	gb‘w“nWÜds
 = 
çl£
;

721 
	gwÜdL’
 = 
j
 - 
i
;

722 ià(
	gwÜdL’
) {

723 
	gw
 = 
widthFromCache
(
f
, 
i
, 
wÜdL’
, 
ËadWidth
 + 
cu¼MaxWidth
, &
çÎbackFÚts
, &
glyphOv”æow
);

724 ià(
	gfœ¡GlyphLeáOv”æow
 < 0)

725 
	gfœ¡GlyphLeáOv”æow
 = 
glyphOv”æow
.
Ëá
;

726 
	gcu¼MšWidth
 +ğ
w
;

727 ià(
	gb‘w“nWÜds
) {

728 ià(
	gÏ¡WÜdBound¬y
 =ğ
i
)

729 
cu¼MaxWidth
 +ğ
w
;

731 
	gcu¼MaxWidth
 +ğ
widthFromCache
(
f
, 
Ï¡WÜdBound¬y
, 
j
 -†a¡WÜdBound¬y, 
ËadWidth
 + 
cu¼MaxWidth
, &
çÎbackFÚts
, &
glyphOv”æow
);

732 
	gÏ¡WÜdBound¬y
 = 
j
;

735 
boŞ
 
	gisS·û
 = (
j
 < 
Ën
è&& 
isS·ûAccÜdšgToStyË
(
c
, 
¡yË
());

736 
boŞ
 
	gisCŞÏpsibËWh™eS·û
 = (
j
 < 
Ën
è&& 
¡yË
()->
isCŞÏpsibËWh™eS·û
(
c
);

737 ià(
	gj
 < 
	gËn
 && 
¡yË
()->
autoW¿p
())

738 
	gm_hasB»akabËCh¬
 = 
Œue
;

742 ià(
	gwÜdS·cšg
 && (
	gisS·û
 || 
	gisCŞÏpsibËWh™eS·û
è&& !
cÚšsOÆyWh™e¥aû
(
j
, 
Ën
-j))

743 
	gcu¼MaxWidth
 +ğ
wÜdS·cšg
;

745 ià(
	gfœ¡WÜd
) {

746 
	gfœ¡WÜd
 = 
çl£
;

750 ià(
	ghasB»ak
)

751 
	gm_hasB»akabËCh¬
 = 
Œue
;

752 
	gm_begšMšWidth
 = 
hasB»ak
 ? 0 : 
w
;

754 
	gm_’dMšWidth
 = 
w
;

756 ià(
	gcu¼MšWidth
 > 
	gm_mšWidth
)

757 
	gm_mšWidth
 = 
cu¼MšWidth
;

758 
	gcu¼MšWidth
 = 0;

760 
	gi
 +ğ
wÜdL’
 - 1;

764 ià(
¡yË
()->
autoW¿p
(è|| 
	gisNewlše
)

765 
	gm_hasB»akabËCh¬
 = 
Œue
;

767 ià(
	gcu¼MšWidth
 > 
	gm_mšWidth
)

768 
	gm_mšWidth
 = 
cu¼MšWidth
;

769 
	gcu¼MšWidth
 = 0;

771 ià(
	gisNewlše
) {

772 ià(
	gfœ¡Lše
) {

773 
	gfœ¡Lše
 = 
çl£
;

774 
	gËadWidth
 = 0;

775 ià(!
¡yË
()->
autoW¿p
())

776 
	gm_begšMšWidth
 = 
cu¼MaxWidth
;

779 ià(
	gcu¼MaxWidth
 > 
	gm_maxWidth
)

780 
	gm_maxWidth
 = 
cu¼MaxWidth
;

781 
	gcu¼MaxWidth
 = 0;

783 
	gcu¼MaxWidth
 +ğ
f
.
width
(
TextRun
(
txt
 + 
i
, 1, 
®lowTabs
(), 
ËadWidth
 + 
cu¼MaxWidth
));

784 
	gglyphOv”æow
.
	gright
 = 0;

785 
	gÃedsWÜdS·cšg
 = 
isS·û
 && !
´eviousCh¬aù”IsS·û
 && 
i
 =ğ
Ën
 - 1;

787 
ASSERT
(
Ï¡WÜdBound¬y
 =ğ
i
);

788 
	gÏ¡WÜdBound¬y
++;

792 ià(
	gfœ¡GlyphLeáOv”æow
 > 0)

793 
	gglyphOv”æow
.
	gËá
 = 
fœ¡GlyphLeáOv”æow
;

795 ià((
	gÃedsWÜdS·cšg
 && 
	gËn
 > 1è|| (
	gignÜšgS·ûs
 && !
	gfœ¡WÜd
))

796 
	gcu¼MaxWidth
 +ğ
wÜdS·cšg
;

798 
	gm_mšWidth
 = 
max
(
cu¼MšWidth
, 
m_mšWidth
);

799 
	gm_maxWidth
 = 
max
(
cu¼MaxWidth
, 
m_maxWidth
);

801 ià(!
¡yË
()->
autoW¿p
())

802 
	gm_mšWidth
 = 
m_maxWidth
;

804 ià(
¡yË
()->
wh™eS·û
(è=ğ
PRE
) {

805 ià(
fœ¡Lše
)

806 
m_begšMšWidth
 = 
m_maxWidth
;

807 
	gm_’dMšWidth
 = 
cu¼MaxWidth
;

810 
£tP»fWidthsDœty
(
çl£
);

813 
boŞ
 
	gR’d”Text
::
isAÎCŞÏpsibËWh™e¥aû
()

815 
Ëngth
 = 
‹xtL’gth
();

816 cÚ¡ 
UCh¬
* 
	g‹xt
 = 
ch¬aù”s
();

817 
	gi
 = 0; i < 
	gËngth
; i++) {

818 ià(!
¡yË
()->
isCŞÏpsibËWh™eS·û
(
‹xt
[
i
]))

819  
	gçl£
;

821  
	gŒue
;

824 
boŞ
 
	gR’d”Text
::
cÚšsOÆyWh™e¥aû
(
äom
, 
Ën
) const

826 
ASSERT
(
m_‹xt
);

827 
	gSŒšgIm¶
& 
	g‹xt
 = *
m_‹xt
.
im¶
();

828 
	gcu¼Pos
;

829 
	gcu¼Pos
 = 
äom
;

830 
	gcu¼Pos
 < 
	gäom
 + 
	gËn
 && (
	g‹xt
[
cu¼Pos
] =ğ'\n' || 
‹xt
[currPos] == ' ' ||ext[currPos] == '\t');

831 
	gcu¼Pos
++) { }

832  
	gcu¼Pos
 >ğ(
äom
 + 
Ën
);

835 
IÁPošt
 
	gR’d”Text
::
fœ¡RunOrigš
() const

837  
IÁPošt
(
fœ¡RunX
(), 
fœ¡RunY
());

840 
	gR’d”Text
::
fœ¡RunX
() const

842  
m_fœ¡TextBox
 ? m_fœ¡TextBox->
m_x
 : 0;

845 
	gR’d”Text
::
fœ¡RunY
() const

847  
m_fœ¡TextBox
 ? m_fœ¡TextBox->
m_y
 : 0;

850 
	gR’d”Text
::
£tS–eùiÚS‹
(
S–eùiÚS‹
 
¡©e
)

852 
IÆšeTextBox
* 
box
;

854 
	gR’d”Objeù
::
£tS–eùiÚS‹
(
¡©e
);

855 ià(
	g¡©e
 =ğ
S–eùiÚS¹
 || 
¡©e
 =ğ
S–eùiÚEnd
 || s‹ =ğ
S–eùiÚBÙh
) {

856 
¡¬tPos
, 
’dPos
;

857 
£ËùiÚS¹End
(
¡¬tPos
, 
’dPos
);

858 ià(
£ËùiÚS‹
(è=ğ
S–eùiÚS¹
) {

859 
’dPos
 = 
‹xtL’gth
();

862 ià(
	g¡¬tPos
 !ğ0 && 
¡¬tPos
 =ğ
’dPos
)

863 
¡¬tPos
 = 
’dPos
 - 1;

864 } ià(
£ËùiÚS‹
(è=ğ
S–eùiÚEnd
)

865 
¡¬tPos
 = 0;

867 
	gbox
 = 
fœ¡TextBox
(); box; box = 
box
->
ÃxtTextBox
()) {

868 ià(
box
->
isS–eùed
(
¡¬tPos
, 
’dPos
)) {

869 
RoÙIÆšeBox
* 
lše
 = 
box
->
roÙ
();

870 ià(
	glše
)

871 
	glše
->
£tHasS–eùedChd»n
(
Œue
);

875 
	gbox
 = 
fœ¡TextBox
(); box; box = 
box
->
ÃxtTextBox
()) {

876 
RoÙIÆšeBox
* 
lše
 = 
box
->
roÙ
();

877 ià(
	glše
)

878 
	glše
->
£tHasS–eùedChd»n
(
¡©e
 =ğ
S–eùiÚInside
);

883 ià(
R’d”Block
* 
	gcb
 = 
cÚššgBlock
())

884 
cb
->
£tS–eùiÚS‹
(
¡©e
);

887 
	gR’d”Text
::
£tTextW™hOff£t
(
PassRefPŒ
<
SŒšgIm¶
> 
‹xt
, 
off£t
, 
Ën
, 
boŞ
 
fÜû
)

889 
	gŞdL’
 = 
‹xtL’gth
();

890 
	gÃwL’
 = 
‹xt
->
Ëngth
();

891 
	gd–
 = 
ÃwL’
 - 
ŞdL’
;

892 
	g’d
 = 
Ën
 ? 
off£t
 +†en - 1 : offset;

894 
RoÙIÆšeBox
* 
	gfœ¡RoÙBox
 = 0;

895 
RoÙIÆšeBox
* 
	gÏ¡RoÙBox
 = 0;

897 
boŞ
 
	gdœt›dLšes
 = 
çl£
;

900 
IÆšeTextBox
* 
	gcu¼
 = 
fœ¡TextBox
(); cu¼; cu¼ = 
cu¼
->
ÃxtTextBox
()) {

902 ià(
cu¼
->
’d
(è< 
off£t
)

906 ià(
	gcu¼
->
¡¬t
(è> 
	g’d
) {

907 
	gcu¼
->
off£tRun
(
d–
);

908 
RoÙIÆšeBox
* 
	groÙ
 = 
cu¼
->
roÙ
();

909 ià(!
	gfœ¡RoÙBox
) {

910 
	gfœ¡RoÙBox
 = 
roÙ
;

911 ià(!
	gdœt›dLšes
) {

914 
	gfœ¡RoÙBox
->
m¬kDœty
();

915 
	gdœt›dLšes
 = 
Œue
;

918 
	gÏ¡RoÙBox
 = 
roÙ
;

919 } ià(
	gcu¼
->
’d
(è>ğ
off£t
 && 
cu¼
->end() <=ƒnd) {

921 
cu¼
->
dœtyLšeBoxes
();

922 
	gdœt›dLšes
 = 
Œue
;

923 } ià(
	gcu¼
->
¡¬t
(è<ğ
off£t
 && 
cu¼
->
’d
() >=ƒnd) {

925 
cu¼
->
dœtyLšeBoxes
();

926 
	gdœt›dLšes
 = 
Œue
;

927 } ià(
	gcu¼
->
¡¬t
(è<ğ
’d
 && 
cu¼
->end() >=ƒnd) {

929 
cu¼
->
dœtyLšeBoxes
();

930 
	gdœt›dLšes
 = 
Œue
;

936 ià(
	gÏ¡RoÙBox
)

937 
	gÏ¡RoÙBox
 = 
Ï¡RoÙBox
->
ÃxtRoÙBox
();

938 ià(
	gfœ¡RoÙBox
) {

939 
RoÙIÆšeBox
* 
	g´ev
 = 
fœ¡RoÙBox
->
´evRoÙBox
();

940 ià(
	g´ev
)

941 
	gfœ¡RoÙBox
 = 
´ev
;

942 } ià(
Ï¡TextBox
()) {

943 
ASSERT
(!
Ï¡RoÙBox
);

944 
	gfœ¡RoÙBox
 = 
Ï¡TextBox
()->
roÙ
();

945 
	gfœ¡RoÙBox
->
m¬kDœty
();

946 
	gdœt›dLšes
 = 
Œue
;

948 
RoÙIÆšeBox
* 
	gcu¼
 = 
fœ¡RoÙBox
; cu¼ && cu¼ !ğ
Ï¡RoÙBox
; cu¼ = 
cu¼
->
ÃxtRoÙBox
()) {

949 ià(
cu¼
->
lšeB»akObj
(è=ğ
this
 && cu¼->
lšeB»akPos
(è> 
’d
)

950 
cu¼
->
£tLšeB»akPos
(cu¼->
lšeB»akPos
(è+ 
d–
);

954 ià(!
fœ¡TextBox
(è&& 
·»Á
()) {

955 
·»Á
()->
dœtyLšesFromChªgedChd
(
this
);

956 
	gdœt›dLšes
 = 
Œue
;

959 
	gm_lšesDœty
 = 
dœt›dLšes
;

960 
£tText
(
‹xt
, 
fÜû
);

963 
šlše
 
boŞ
 
isIÆšeFlowOrEm±yText
(
R’d”Objeù
* 
o
)

965 ià(
	go
->
isR’d”IÆše
())

966  
	gŒue
;

967 ià(!
	go
->
isText
())

968  
	gçl£
;

969 
SŒšgIm¶
* 
	g‹xt
 = 
toR’d”Text
(
o
)->
‹xt
();

970 ià(!
	g‹xt
)

971  
	gŒue
;

972  !
	g‹xt
->
Ëngth
();

975 
UCh¬
 
	gR’d”Text
::
´eviousCh¬aù”
()

978 
R’d”Objeù
* 
´eviousText
 = 
this
;

979 (
	g´eviousText
 = 
´eviousText
->
´eviousInP»Ord”
()))

980 ià(!
isIÆšeFlowOrEm±yText
(
´eviousText
))

982 
UCh¬
 
	g´ev
 = ' ';

983 ià(
	g´eviousText
 &&…»viousText->
isText
())

984 ià(
SŒšgIm¶
* 
	g´eviousSŒšg
 = 
toR’d”Text
(
´eviousText
)->
‹xt
())

985 
´ev
 = (*
´eviousSŒšg
)[´eviousSŒšg->
Ëngth
() - 1];

986  
	g´ev
;

989 
	gR’d”Text
::
£tTextIÁ”Çl
(
PassRefPŒ
<
SŒšgIm¶
> 
‹xt
)

991 
ASSERT
(
‹xt
);

992 
	gm_‹xt
 = 
docum’t
()->
di¥ÏySŒšgModif›dByEncodšg
(
‹xt
);

993 
ASSERT
(
m_‹xt
);

995 #ià
ENABLE
(
SVG
)

996 ià(
isSVGText
()) {

997 ià(
¡yË
(è&& styË()->
wh™eS·û
(è=ğ
PRE
) {

1003 
m_‹xt
.
»¶aû
('\n', ' ');

1014 
	gm_‹xt
.
»¶aû
('\n', 
SŒšgIm¶
::
em±y
());

1020 
	gm_‹xt
.
»¶aû
('\t', ' ');

1024 ià(
¡yË
()) {

1025 
¡yË
()->
‹xtT¿nsfÜm
()) {

1026 
	gTTNONE
:

1028 
	gCAPITALIZE
:

1029 
makeC­™®ized
(&
m_‹xt
, 
´eviousCh¬aù”
());

1031 
	gUPPERCASE
:

1032 
m_‹xt
.
makeUµ”
();

1034 
	gLOWERCASE
:

1035 
m_‹xt
.
makeLow”
();

1041 
¡yË
()->
‹xtSecur™y
()) {

1042 
	gTSNONE
:

1044 
	gTSCIRCLE
:

1045 
m_‹xt
.
makeSecu»
(
wh™eBuÎ‘
);

1047 
	gTSDISC
:

1048 
m_‹xt
.
makeSecu»
(
buÎ‘
);

1050 
	gTSSQUARE
:

1051 
m_‹xt
.
makeSecu»
(
bÏckSqu¬e
);

1055 
ASSERT
(
m_‹xt
);

1056 
ASSERT
(!
isBR
(è|| (
‹xtL’gth
(è=ğ1 && 
m_‹xt
[0] == '\n'));

1058 
	gm_isAÎASCII
 = 
m_‹xt
.
cÚšsOÆyASCII
();

1061 
	gR’d”Text
::
£tText
(
PassRefPŒ
<
SŒšgIm¶
> 
‹xt
, 
boŞ
 
fÜû
)

1063 
ASSERT
(
‹xt
);

1065 ià(!
	gfÜû
 && 
equ®
(
m_‹xt
.
im¶
(), 
‹xt
.
g‘
()))

1068 
£tTextIÁ”Çl
(
‹xt
);

1069 
£tN“dsLayoutAndP»fWidthsReÿlc
();

1070 
	gm_knownToHaveNoOv”æowAndNoF®lbackFÚts
 = 
çl£
;

1072 
AXObjeùCache
* 
	gaxObjeùCache
 = 
docum’t
()->
axObjeùCache
();

1073 ià(
	gaxObjeùCache
->
acûssib™yEÇbËd
())

1074 
	gaxObjeùCache
->
cÚ‹ÁChªged
(
this
);

1077 
	gR’d”Text
::
lšeHeight
(
boŞ
 
fœ¡Lše
, bool) const

1080  
·»Á
()->
lšeHeight
(
fœ¡Lše
, 
Œue
);

1083 
	gR’d”Text
::
dœtyLšeBoxes
(
boŞ
 
fuÎLayout
)

1085 ià(
fuÎLayout
)

1086 
d–‘eTextBoxes
();

1087 ià(!
	gm_lšesDœty
) {

1088 
IÆšeTextBox
* 
	gbox
 = 
fœ¡TextBox
(); box; box = 
box
->
ÃxtTextBox
())

1089 
box
->
dœtyLšeBoxes
();

1091 
	gm_lšesDœty
 = 
çl£
;

1094 
IÆšeTextBox
* 
	gR’d”Text
::
ü—‹TextBox
()

1096  
Ãw
 (
»nd”A»Ç
()è
IÆšeTextBox
(
this
);

1099 
IÆšeTextBox
* 
	gR’d”Text
::
ü—‹IÆšeTextBox
()

1101 
IÆšeTextBox
* 
‹xtBox
 = 
ü—‹TextBox
();

1102 ià(!
	gm_fœ¡TextBox
)

1103 
	gm_fœ¡TextBox
 = 
m_Ï¡TextBox
 = 
‹xtBox
;

1105 
	gm_Ï¡TextBox
->
£tNextTextBox
(
‹xtBox
);

1106 
	g‹xtBox
->
£tP»viousTextBox
(
m_Ï¡TextBox
);

1107 
	gm_Ï¡TextBox
 = 
‹xtBox
;

1109 
	g‹xtBox
->
£tIsText
(
Œue
);

1110  
	g‹xtBox
;

1113 
	gR’d”Text
::
pos™iÚLšeBox
(
IÆšeBox
* 
box
)

1115 
IÆšeTextBox
* 
s
 = 
¡©ic_ÿ¡
<IÆšeTextBox*>(
box
);

1118 ià(!
	gs
->
Ën
()) {

1120 
	gs
->
»move
();

1121 ià(
	gm_fœ¡TextBox
 =ğ
s
)

1122 
m_fœ¡TextBox
 = 
s
->
ÃxtTextBox
();

1124 
	gs
->
´evTextBox
()->
£tNextTextBox
(
s
->
ÃxtTextBox
());

1125 ià(
	gm_Ï¡TextBox
 =ğ
s
)

1126 
m_Ï¡TextBox
 = 
s
->
´evTextBox
();

1128 
	gs
->
ÃxtTextBox
()->
£tP»viousTextBox
(
s
->
´evTextBox
());

1129 
	gs
->
de¡roy
(
»nd”A»Ç
());

1133 
	gm_cÚšsRev”£dText
 |ğ
s
->
dœeùiÚ
(è=ğ
RTL
;

1136 
	gR’d”Text
::
width
(
äom
, 
Ën
, 
xPos
, 
boŞ
 
fœ¡Lše
, 
HashS‘
<cÚ¡ 
Sim¶eFÚtD©a
*>* 
çÎbackFÚts
, 
GlyphOv”æow
* 
glyphOv”æow
) const

1138 ià(
	gäom
 >ğ
‹xtL’gth
())

1141 ià(
	gäom
 + 
	gËn
 > 
‹xtL’gth
())

1142 
	gËn
 = 
‹xtL’gth
(è- 
äom
;

1144  
width
(
äom
, 
Ën
, 
¡yË
(
fœ¡Lše
)->
fÚt
(), 
xPos
, 
çÎbackFÚts
, 
glyphOv”æow
);

1147 
	gR’d”Text
::
width
(
äom
, 
Ën
, cÚ¡ 
FÚt
& 
f
, 
xPos
, 
HashS‘
<cÚ¡ 
Sim¶eFÚtD©a
*>* 
çÎbackFÚts
, 
GlyphOv”æow
* 
glyphOv”æow
) const

1149 
ASSERT
(
äom
 + 
Ën
 <ğ
‹xtL’gth
());

1150 ià(!
ch¬aù”s
())

1153 
	gw
;

1154 ià(&
	gf
 =ğ&
¡yË
()->
fÚt
()) {

1155 ià(!
¡yË
()->
´e£rveNewlše
(è&& !
äom
 && 
Ën
 =ğ
‹xtL’gth
()) {

1156 ià(
çÎbackFÚts
) {

1157 
ASSERT
(
glyphOv”æow
);

1158 ià(
´efWidthsDœty
(è|| !
	gm_knownToHaveNoOv”æowAndNoF®lbackFÚts
) {

1159 
	gcÚ¡_ÿ¡
<
	gR’d”Text
*>(
	gthis
)->
ÿlcP»fWidths
(0, *
çÎbackFÚts
, *
glyphOv”æow
);

1160 ià(
	gçÎbackFÚts
->
isEm±y
(è&& !
	gglyphOv”æow
->
	gËá
 && !glyphOv”æow->
	gright
 && !glyphOv”æow->
	gtİ
 && !glyphOv”æow->
	gbÙtom
)

1161 
	gm_knownToHaveNoOv”æowAndNoF®lbackFÚts
 = 
Œue
;

1163 
	gw
 = 
m_maxWidth
;

1165 
	gw
 = 
maxP»fWidth
();

1167 
	gw
 = 
widthFromCache
(
f
, 
äom
, 
Ën
, 
xPos
, 
çÎbackFÚts
, 
glyphOv”æow
);

1169 
	gw
 = 
f
.
width
(
TextRun
(
‹xt
()->
ch¬aù”s
(è+ 
äom
, 
Ën
, 
®lowTabs
(), 
xPos
), 
çÎbackFÚts
, 
glyphOv”æow
);

1171  
	gw
;

1174 
IÁReù
 
	gR’d”Text
::
lšesBoundšgBox
() const

1176 
IÁReù
 
»suÉ
;

1178 
ASSERT
(!
fœ¡TextBox
(è=ğ!
Ï¡TextBox
());

1179 ià(
fœ¡TextBox
(è&& 
Ï¡TextBox
()) {

1181 
	gËáSide
 = 0;

1182 
	grightSide
 = 0;

1183 
IÆšeTextBox
* 
	gcu¼
 = 
fœ¡TextBox
(); cu¼; cu¼ = 
cu¼
->
ÃxtTextBox
()) {

1184 ià(
cu¼
 =ğ
fœ¡TextBox
(è|| cu¼->
x
(è< 
ËáSide
)

1185 
ËáSide
 = 
cu¼
->
x
();

1186 ià(
	gcu¼
 =ğ
fœ¡TextBox
(è|| 
cu¼
->
x
(è+ cu¼->
width
(è> 
rightSide
)

1187 
rightSide
 = 
cu¼
->
x
(è+ cu¼->
width
();

1189 
	g»suÉ
.
£tWidth
(
rightSide
 - 
ËáSide
);

1190 
	g»suÉ
.
£tX
(
ËáSide
);

1191 
	g»suÉ
.
£tHeight
(
Ï¡TextBox
()->
y
(è+†a¡TextBox()->
height
(è- 
fœ¡TextBox
()->y());

1192 
	g»suÉ
.
£tY
(
fœ¡TextBox
()->
y
());

1195  
	g»suÉ
;

1198 
IÁReù
 
	gR’d”Text
::
ş³dOv”æowReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
)

1200 
R’d”Objeù
* 
cb
 = 
cÚššgBlock
();

1202 ià(
	g»·štCÚš”
 &&„•aštCÚš” !ğ
cb
) {

1203 ià(!
cb
->
isDesûndªtOf
(
»·štCÚš”
))

1204  
»·štCÚš”
->
ş³dOv”æowReùFÜR•ašt
(repaintContainer);

1206  
	gcb
->
ş³dOv”æowReùFÜR•ašt
(
»·štCÚš”
);

1209 
IÁReù
 
	gR’d”Text
::
£ËùiÚReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
boŞ
 
şToVisibËCÚ‹Á
)

1211 
ASSERT
(!
ÃedsLayout
());

1213 ià(
£ËùiÚS‹
(è=ğ
S–eùiÚNÚe
)

1214  
IÁReù
();

1215 
R’d”Block
* 
	gcb
 = 
cÚššgBlock
();

1216 ià(!
	gcb
)

1217  
IÁReù
();

1221 
	g¡¬tPos
, 
	g’dPos
;

1222 ià(
£ËùiÚS‹
(è=ğ
S–eùiÚInside
) {

1224 
¡¬tPos
 = 0;

1225 
	g’dPos
 = 
‹xtL’gth
();

1227 
£ËùiÚS¹End
(
¡¬tPos
, 
’dPos
);

1228 ià(
£ËùiÚS‹
(è=ğ
S–eùiÚS¹
)

1229 
’dPos
 = 
‹xtL’gth
();

1230 ià(
£ËùiÚS‹
(è=ğ
S–eùiÚEnd
)

1231 
¡¬tPos
 = 0;

1234 ià(
	g¡¬tPos
 =ğ
’dPos
)

1235  
IÁReù
();

1237 
IÁReù
 
	g»ù
;

1238 
IÆšeTextBox
* 
	gbox
 = 
fœ¡TextBox
(); box; box = 
box
->
ÃxtTextBox
()) {

1239 
»ù
.
un™e
(
box
->
£ËùiÚReù
(0, 0, 
¡¬tPos
, 
’dPos
));

1242 
	gŒunÿtiÚ
 = 
box
->
ŒunÿtiÚ
();

1243 ià(
	gŒunÿtiÚ
 !ğ
cNoTrunÿtiÚ
) {

1244 ià(
EÎsisBox
* 
–lsis
 = 
box
->
roÙ
()->
–lsisBox
()) {

1245 
ePos
 = 
mš
<>(
’dPos
 - 
box
->
¡¬t
(), 
	gbox
->
Ën
());

1246 
	gsPos
 = 
max
<>(
¡¬tPos
 - 
box
->
¡¬t
(), 0);

1251 ià(
	gePos
 >ğ
ŒunÿtiÚ
 && 
sPos
 <=runcation)

1252 
»ù
.
un™e
(
–lsis
->
£ËùiÚReù
(0, 0));

1257 ià(
	gşToVisibËCÚ‹Á
)

1258 
compu‹ReùFÜR•ašt
(
»·štCÚš”
, 
»ù
);

1260 ià(
	gcb
->
hasCŞumns
())

1261 
	gcb
->
adju¡ReùFÜCŞumns
(
»ù
);

1263 
	g»ù
 = 
loÿlToCÚš”Quad
(
FlßtReù
(
»ù
), 
»·štCÚš”
).
’şosšgBoundšgBox
();

1266  
	g»ù
;

1269 
	gR’d”Text
::
ÿ»tMšOff£t
() const

1271 
IÆšeTextBox
* 
box
 = 
fœ¡TextBox
();

1272 ià(!
	gbox
)

1274 
	gmšOff£t
 = 
box
->
¡¬t
();

1275 
	gbox
 = 
box
->
ÃxtTextBox
(); box; box = box->nextTextBox())

1276 
mšOff£t
 = 
mš
<>(mšOff£t, 
	gbox
->
¡¬t
());

1277  
	gmšOff£t
;

1280 
	gR’d”Text
::
ÿ»tMaxOff£t
() const

1282 
IÆšeTextBox
* 
box
 = 
Ï¡TextBox
();

1283 ià(!
	gbox
)

1284  
‹xtL’gth
();

1285 
	gmaxOff£t
 = 
box
->
¡¬t
(è+ box->
Ën
();

1286 
	gbox
 = 
box
->
´evTextBox
(); box; box = box->prevTextBox())

1287 
maxOff£t
 = 
max
<>(maxOff£t, 
	gbox
->
¡¬t
(è+ box->
Ën
());

1288  
	gmaxOff£t
;

1291 
	gR’d”Text
::
ÿ»tMaxR’d”edOff£t
() const

1293 
l
 = 0;

1294 
IÆšeTextBox
* 
	gbox
 = 
fœ¡TextBox
(); box; box = 
box
->
ÃxtTextBox
())

1295 
l
 +ğ
box
->
Ën
();

1296  
	gl
;

1299 
	gR’d”Text
::
´eviousOff£t
(
cu¼’t
) const

1301 
SŒšgIm¶
* 
si
 = 
m_‹xt
.
im¶
();

1302 
TextB»akI‹¿tÜ
* 
	g™”©Ü
 = 
cursÜMovem’tI‹¿tÜ
(
si
->
ch¬aù”s
(), si->
Ëngth
());

1303 ià(!
	g™”©Ü
)

1304  
	gcu¼’t
 - 1;

1306 
	g»suÉ
 = 
‹xtB»akP»ûdšg
(
™”©Ü
, 
cu¼’t
);

1307 ià(
	g»suÉ
 =ğ
TextB»akDÚe
)

1308 
»suÉ
 = 
cu¼’t
 - 1;

1310 #ifdeà
BUILDING_ON_TIGER


1312 ià(
	g¡©ic_ÿ¡
<>(
	g»suÉ
è< 
	gsi
->
Ëngth
()) {

1313 
UCh¬
 
	gch¬aù”
 = (*
si
)[
»suÉ
];

1314 ià(
	gch¬aù”
 =ğ0xFF9E || 
ch¬aù”
 == 0xFF9F)

1315 --
»suÉ
;

1319  
	g»suÉ
;

1322 
	#HANGUL_CHOSEONG_START
 (0x1100)

	)

1323 
	#HANGUL_CHOSEONG_END
 (0x115F)

	)

1324 
	#HANGUL_JUNGSEONG_START
 (0x1160)

	)

1325 
	#HANGUL_JUNGSEONG_END
 (0x11A2)

	)

1326 
	#HANGUL_JONGSEONG_START
 (0x11A8)

	)

1327 
	#HANGUL_JONGSEONG_END
 (0x11F9)

	)

1328 
	#HANGUL_SYLLABLE_START
 (0xAC00)

	)

1329 
	#HANGUL_SYLLABLE_END
 (0xD7AF)

	)

1330 
	#HANGUL_JONGSEONG_COUNT
 (28)

	)

1332 
	eHªgulS‹
 {

1333 
	gHªgulS‹L
,

1334 
	gHªgulS‹V
,

1335 
	gHªgulS‹T
,

1336 
	gHªgulS‹LV
,

1337 
	gHªgulS‹LVT
,

1338 
	gHªgulS‹B»ak


1341 
šlše
 
boŞ
 
isHªgulLVT
(
UCh¬32
 
ch¬aù”
)

1343  (
	gch¬aù”
 - 
	gHANGUL_SYLLABLE_START
è% 
	gHANGUL_JONGSEONG_COUNT
;

1346 
	gR’d”Text
::
´eviousOff£tFÜBackw¬dD–‘iÚ
(
cu¼’t
) const

1348 #ià
PLATFORM
(
MAC
)

1349 
ASSERT
(
m_‹xt
);

1350 
	gSŒšgIm¶
& 
	g‹xt
 = *
m_‹xt
.
im¶
();

1351 
UCh¬32
 
	gch¬aù”
;

1352 
	gcu¼’t
 > 0) {

1353 ià(
U16_IS_TRAIL
(
‹xt
[--
cu¼’t
]))

1354 --
	gcu¼’t
;

1355 ià(
	gcu¼’t
 < 0)

1358 
UCh¬32
 
	gch¬aù”
 = 
‹xt
.
ch¬aù”S¹šgAt
(
cu¼’t
);

1361 ià((
	gch¬aù”
 >ğ0x0530è&& (
ch¬aù”
 < 0x1950))

1364 ià(
u_isba£
(
ch¬aù”
è&& (
	gch¬aù”
 != 0xFF9E) && (character != 0xFF9F))

1368 ià(
	gcu¼’t
 <= 0)

1369  
cu¼’t
;

1372 
	gch¬aù”
 = 
‹xt
.
ch¬aù”S¹šgAt
(
cu¼’t
);

1373 ià(((
	gch¬aù”
 >ğ
HANGUL_CHOSEONG_START
è&& (
ch¬aù”
 <ğ
HANGUL_JONGSEONG_END
)è|| ((ch¬aù” >ğ
HANGUL_SYLLABLE_START
è&& (ch¬aù” <ğ
HANGUL_SYLLABLE_END
))) {

1374 
HªgulS‹
 
¡©e
;

1375 
HªgulS‹
 
	gš™ŸlS‹
;

1377 ià(
	gch¬aù”
 < 
	gHANGUL_JUNGSEONG_START
)

1378 
	g¡©e
 = 
HªgulS‹L
;

1379 ià(
	gch¬aù”
 < 
	gHANGUL_JONGSEONG_START
)

1380 
	g¡©e
 = 
HªgulS‹V
;

1381 ià(
	gch¬aù”
 < 
	gHANGUL_SYLLABLE_START
)

1382 
	g¡©e
 = 
HªgulS‹T
;

1384 
	g¡©e
 = 
isHªgulLVT
(
ch¬aù”
è? 
HªgulS‹LVT
 : 
HªgulS‹LV
;

1386 
	gš™ŸlS‹
 = 
¡©e
;

1388 
	gcu¼’t
 > 0 && ((
	gch¬aù”
 = 
‹xt
.
ch¬aù”S¹šgAt
(
cu¼’t
 - 1)è>ğ
HANGUL_CHOSEONG_START
è&& (
ch¬aù”
 <ğ
HANGUL_SYLLABLE_END
è&& ((ch¬aù” <ğ
HANGUL_JONGSEONG_END
è|| (ch¬aù” >ğ
HANGUL_SYLLABLE_START
))) {

1389 
¡©e
) {

1390 
HªgulS‹V
:

1391 ià(
ch¬aù”
 <ğ
HANGUL_CHOSEONG_END
)

1392 
¡©e
 = 
HªgulS‹L
;

1393 ià((
	gch¬aù”
 >ğ
HANGUL_SYLLABLE_START
è&& (
ch¬aù”
 <ğ
HANGUL_SYLLABLE_END
è&& !
isHªgulLVT
(character))

1394 
¡©e
 = 
HªgulS‹LV
;

1395 ià(
	gch¬aù”
 > 
	gHANGUL_JUNGSEONG_END
)

1396 
	g¡©e
 = 
HªgulS‹B»ak
;

1398 
	gHªgulS‹T
:

1399 ià((
ch¬aù”
 >ğ
HANGUL_JUNGSEONG_START
è&& (ch¬aù” <ğ
HANGUL_JUNGSEONG_END
))

1400 
¡©e
 = 
HªgulS‹V
;

1401 ià((
	gch¬aù”
 >ğ
HANGUL_SYLLABLE_START
è&& (
ch¬aù”
 <ğ
HANGUL_SYLLABLE_END
))

1402 
¡©e
 = (
isHªgulLVT
(
ch¬aù”
è? 
HªgulS‹LVT
 : 
HªgulS‹LV
);

1403 ià(
	gch¬aù”
 < 
	gHANGUL_JUNGSEONG_START
)

1404 
	g¡©e
 = 
HªgulS‹B»ak
;

1407 
¡©e
 = (
ch¬aù”
 < 
HANGUL_JUNGSEONG_START
è? 
HªgulS‹L
 : 
HªgulS‹B»ak
;

1410 ià(
	g¡©e
 =ğ
HªgulS‹B»ak
)

1413 --
	gcu¼’t
;

1417  
	gcu¼’t
;

1420  
	gcu¼’t
 - 1;

1424 
	gR’d”Text
::
ÃxtOff£t
(
cu¼’t
) const

1426 
SŒšgIm¶
* 
si
 = 
m_‹xt
.
im¶
();

1427 
TextB»akI‹¿tÜ
* 
	g™”©Ü
 = 
cursÜMovem’tI‹¿tÜ
(
si
->
ch¬aù”s
(), si->
Ëngth
());

1428 ià(!
	g™”©Ü
)

1429  
	gcu¼’t
 + 1;

1431 
	g»suÉ
 = 
‹xtB»akFŞlowšg
(
™”©Ü
, 
cu¼’t
);

1432 ià(
	g»suÉ
 =ğ
TextB»akDÚe
)

1433 
»suÉ
 = 
cu¼’t
 + 1;

1435 #ifdeà
BUILDING_ON_TIGER


1437 ià(
	g¡©ic_ÿ¡
<>(
	g»suÉ
è< 
	gsi
->
Ëngth
()) {

1438 
UCh¬
 
	gch¬aù”
 = (*
si
)[
»suÉ
];

1439 ià(
	gch¬aù”
 =ğ0xFF9E || 
ch¬aù”
 == 0xFF9F)

1440 ++
»suÉ
;

1444  
	g»suÉ
;

1447 #iâdeà
NDEBUG


1449 
	gR’d”Text
::
checkCÚsi¡’cy
() const

1451 #ifdeà
CHECK_CONSISTENCY


1452 cÚ¡ 
IÆšeTextBox
* 
´ev
 = 0;

1453 cÚ¡ 
IÆšeTextBox
* 
	gchd
 = 
m_fœ¡TextBox
; chd !ğ0; chd = 
chd
->
ÃxtTextBox
()) {

1454 
ASSERT
(
chd
->
»nd””
(è=ğ
this
);

1455 
ASSERT
(
chd
->
´evTextBox
(è=ğ
´ev
);

1456 
	g´ev
 = 
chd
;

1458 
ASSERT
(
´ev
 =ğ
m_Ï¡TextBox
);

	@RenderText.h

23 #iâdeà
R’d”Text_h


24 
	#R’d”Text_h


	)

26 
	~"R’d”Objeù.h
"

28 
Çme¥aû
 
	gWebCÜe
 {

30 
şass
 
	gIÆšeTextBox
;

31 
şass
 
	gSŒšgIm¶
;

33 şas 
	cR’d”Text
 : 
public
 
R’d”Objeù
 {

34 
public
:

35 
R’d”Text
(
Node
*, 
PassRefPŒ
<
SŒšgIm¶
>);

36 #iâdeà
NDEBUG


37 
	gvœtu®
 ~
R’d”Text
();

40 
vœtu®
 cÚ¡ * 
»nd”Name
() const;

42 
vœtu®
 
boŞ
 
isTextF¿gm’t
() const;

43 
vœtu®
 
boŞ
 
isWÜdB»ak
() const;

45 
vœtu®
 
	gPassRefPŒ
<
	gSŒšgIm¶
> 
Üigš®Text
() const;

47 
exŒaùTextBox
(
IÆšeTextBox
*);

48 
©chTextBox
(
IÆšeTextBox
*);

49 
»moveTextBox
(
IÆšeTextBox
*);

51 
vœtu®
 
de¡roy
();

53 
SŒšgIm¶
* 
‹xt
(ècÚ¡ {  
	gm_‹xt
.
im¶
(); }

55 
IÆšeTextBox
* 
ü—‹IÆšeTextBox
();

56 
dœtyLšeBoxes
(
boŞ
 
fuÎLayout
);

58 
vœtu®
 
absŞu‹Reùs
(
VeùÜ
<
IÁReù
>&, 
tx
, 
ty
);

59 
absŞu‹ReùsFÜRªge
(
VeùÜ
<
IÁReù
>&, 
¡¬tOff£t
 = 0, 
’dOff£t
 = 
UINT_MAX
, 
boŞ
 
u£S–eùiÚHeight
 = 
çl£
);

61 
vœtu®
 
absŞu‹Quads
(
VeùÜ
<
FlßtQuad
>&);

62 
absŞu‹QuadsFÜRªge
(
VeùÜ
<
FlßtQuad
>&, 
¡¬tOff£t
 = 0, 
’dOff£t
 = 
UINT_MAX
, 
boŞ
 
u£S–eùiÚHeight
 = 
çl£
);

64 
vœtu®
 
VisibËPos™iÚ
 
pos™iÚFÜPošt
(cÚ¡ 
IÁPošt
&);

66 cÚ¡ 
UCh¬
* 
ch¬aù”s
(ècÚ¡ {  
	gm_‹xt
.characters(); }

67 
‹xtL’gth
(ècÚ¡ {  
	gm_‹xt
.
Ëngth
(); }

68 
pos™iÚLšeBox
(
IÆšeBox
*);

70 
vœtu®
 
width
(
äom
, 
Ën
, cÚ¡ 
FÚt
&, 
xPos
, 
HashS‘
<cÚ¡ 
Sim¶eFÚtD©a
*>* 
çÎbackFÚts
 = 0, 
GlyphOv”æow
* = 0) const;

71 
vœtu®
 
width
(
äom
, 
Ën
, 
xPos
, 
boŞ
 
fœ¡Lše
 = 
çl£
, 
HashS‘
<cÚ¡ 
Sim¶eFÚtD©a
*>* 
çÎbackFÚts
 = 0, 
GlyphOv”æow
* = 0) const;

73 
vœtu®
 
lšeHeight
(
boŞ
 
fœ¡Lše
, boŞ 
isRoÙLšeBox
 = 
çl£
) const;

75 
vœtu®
 
mšP»fWidth
() const;

76 
vœtu®
 
maxP»fWidth
() const;

78 
ŒimmedP»fWidths
(
ËadWidth
,

79 & 
begšMšW
, 
boŞ
& 
begšWS
,

80 & 
’dMšW
, 
boŞ
& 
’dWS
,

81 
boŞ
& 
hasB»akabËCh¬
, boŞ& 
hasB»ak
,

82 & 
begšMaxW
, & 
’dMaxW
,

83 & 
mšW
, & 
maxW
, 
boŞ
& 
¡rFrÚtS·ûs
);

85 
IÁReù
 
lšesBoundšgBox
() const;

87 
IÁPošt
 
fœ¡RunOrigš
() const;

88 
fœ¡RunX
() const;

89 
fœ¡RunY
() const;

91 
£tText
(
PassRefPŒ
<
SŒšgIm¶
>, 
boŞ
 
fÜû
 = 
çl£
);

92 
£tTextW™hOff£t
(
PassRefPŒ
<
SŒšgIm¶
>, 
off£t
, 
Ën
, 
boŞ
 
fÜû
 = 
çl£
);

94 
vœtu®
 
boŞ
 
ÿnBeS–eùiÚL—f
(ècÚ¡ {  
	gŒue
; }

95 
vœtu®
 
£tS–eùiÚS‹
(
S–eùiÚS‹
 
s
);

96 
vœtu®
 
IÁReù
 
£ËùiÚReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
boŞ
 
şToVisibËCÚ‹Á
 = 
Œue
);

97 
vœtu®
 
IÁReù
 
loÿlC¬‘Reù
(
IÆšeBox
*, 
ÿ»tOff£t
, * 
exŒaWidthToEndOfLše
 = 0);

99 
vœtu®
 
m¬gšLeá
(ècÚ¡ {  
¡yË
()->m¬gšLeá().
ÿlcMšV®ue
(0); }

100 
vœtu®
 
m¬gšRight
(ècÚ¡ {  
¡yË
()->m¬gšRight().
ÿlcMšV®ue
(0); }

102 
vœtu®
 
IÁReù
 
ş³dOv”æowReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
);

104 
IÆšeTextBox
* 
fœ¡TextBox
(ècÚ¡ {  
	gm_fœ¡TextBox
; }

105 
IÆšeTextBox
* 
Ï¡TextBox
(ècÚ¡ {  
	gm_Ï¡TextBox
; }

107 
vœtu®
 
ÿ»tMšOff£t
() const;

108 
vœtu®
 
ÿ»tMaxOff£t
() const;

109 
vœtu®
 
ÿ»tMaxR’d”edOff£t
() const;

111 
vœtu®
 
´eviousOff£t
(
cu¼’t
) const;

112 
vœtu®
 
´eviousOff£tFÜBackw¬dD–‘iÚ
(
cu¼’t
) const;

113 
vœtu®
 
ÃxtOff£t
(
cu¼’t
) const;

115 
boŞ
 
cÚšsRev”£dText
(ècÚ¡ {  
	gm_cÚšsRev”£dText
; }

117 
IÆšeTextBox
* 
fšdNextIÆšeTextBox
(
off£t
, & 
pos
) const;

119 
boŞ
 
®lowTabs
(ècÚ¡ {  !
¡yË
()->
cŞÏp£Wh™eS·û
(); }

121 
checkCÚsi¡’cy
() const;

123 
vœtu®
 
ÿlcP»fWidths
(
ËadWidth
);

124 
boŞ
 
isAÎCŞÏpsibËWh™e¥aû
();

126 
	g´Ùeùed
:

127 
vœtu®
 
¡yËWlChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
*) { }

128 
vœtu®
 
¡yËDidChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
);

130 
vœtu®
 
£tTextIÁ”Çl
(
PassRefPŒ
<
SŒšgIm¶
>);

131 
vœtu®
 
UCh¬
 
´eviousCh¬aù”
();

133 
vœtu®
 
IÆšeTextBox
* 
ü—‹TextBox
();

135 
	g´iv©e
:

136 
ÿlcP»fWidths
(
ËadWidth
, 
HashS‘
<cÚ¡ 
Sim¶eFÚtD©a
*>& 
çÎbackFÚts
, 
GlyphOv”æow
&);

141 
vœtu®
 
Ëngth
(ècÚ¡ {  
‹xtL’gth
(); }

143 
vœtu®
 
·št
(
PaštInfo
&, , è{ 
ASSERT_NOT_REACHED
(); }

144 
vœtu®
 
Ïyout
(è{ 
ASSERT_NOT_REACHED
(); }

145 
vœtu®
 
boŞ
 
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, , , , , 
H™Te¡AùiÚ
è{ 
ASSERT_NOT_REACHED
();  
	gçl£
; }

147 
d–‘eTextBoxes
();

148 
boŞ
 
cÚšsOÆyWh™e¥aû
(
äom
, 
Ën
) const;

149 
widthFromCache
(cÚ¡ 
FÚt
&, 
¡¬t
, 
Ën
, 
xPos
, 
HashS‘
<cÚ¡ 
Sim¶eFÚtD©a
*>* 
çÎbackFÚts
, 
GlyphOv”æow
*) const;

150 
boŞ
 
isAÎASCII
(ècÚ¡ {  
	gm_isAÎASCII
; }

152 
	gm_mšWidth
;

154 
SŒšg
 
	gm_‹xt
;

156 
IÆšeTextBox
* 
	gm_fœ¡TextBox
;

157 
IÆšeTextBox
* 
	gm_Ï¡TextBox
;

159 
	gm_maxWidth
;

160 
	gm_begšMšWidth
;

161 
	gm_’dMšWidth
;

163 
boŞ
 
	gm_hasB»akabËCh¬
 : 1;

164 
boŞ
 
	gm_hasB»ak
 : 1;

165 
boŞ
 
	gm_hasTab
 : 1;

166 
boŞ
 
	gm_hasBegšWS
 : 1;

167 
boŞ
 
	gm_hasEndWS
 : 1;

168 
boŞ
 
	gm_lšesDœty
 : 1;

172 
boŞ
 
	gm_cÚšsRev”£dText
 : 1;

173 
boŞ
 
	gm_isAÎASCII
 : 1;

174 
mubË
 
boŞ
 
	gm_knownToHaveNoOv”æowAndNoF®lbackFÚts
 : 1;

177 
šlše
 
R’d”Text
* 
	$toR’d”Text
(
R’d”Objeù
* 
objeù
)

179 
	`ASSERT
(!
objeù
 || objeù->
	`isText
());

180  
¡©ic_ÿ¡
<
R’d”Text
*>(
objeù
);

181 
	}
}

183 
šlše
 cÚ¡ 
R’d”Text
* 
	$toR’d”Text
(cÚ¡ 
R’d”Objeù
* 
objeù
)

185 
	`ASSERT
(!
objeù
 || objeù->
	`isText
());

186  
¡©ic_ÿ¡
<cÚ¡ 
R’d”Text
*>(
objeù
);

187 
	}
}

190 
toR’d”Text
(cÚ¡ 
R’d”Text
*);

192 #ifdeà
NDEBUG


193 
šlše
 
	gR’d”Text
::
	$checkCÚsi¡’cy
() const

195 
	}
}

	@RenderTextControl.cpp

22 
	~"cÚfig.h
"

23 
	~"R’d”TextCÚŒŞ.h
"

25 
	~"AXObjeùCache.h
"

26 
	~"Ch¬aù”Names.h
"

27 
	~"Ed™Ü.h
"

28 
	~"Ev’t.h
"

29 
	~"Ev’tNames.h
"

30 
	~"F¿me.h
"

31 
	~"HTMLBREËm’t.h
"

32 
	~"HTMLNames.h
"

33 
	~"H™Te¡ResuÉ.h
"

34 
	~"R’d”Lay”.h
"

35 
	~"R’d”Text.h
"

36 
	~"SüŞlb¬Theme.h
"

37 
	~"S–eùiÚCÚŒŞËr.h
"

38 
	~"Text.h
"

39 
	~"TextCÚŒŞIÂ”EËm’ts.h
"

40 
	~"TextI‹¿tÜ.h
"

42 
usšg
 
Çme¥aû
 
	g¡d
;

44 
Çme¥aû
 
	gWebCÜe
 {

46 
usšg
 
Çme¥aû
 
	gHTMLNames
;

49 cÚ¡ 
	gmšCŞÜCÚŒa¡V®ue
 = 1300;

51 
CŞÜ
 
di§bËdTextCŞÜ
(cÚ¡ CŞÜ& 
‹xtCŞÜ
, cÚ¡ CŞÜ& 
backgroundCŞÜ
)

55 
CŞÜ
 
	gdi§bËdCŞÜ
;

56 ià(
	g‹xtCŞÜ
.
rgb
(è=ğ
CŞÜ
::
bÏck
 || 
difã»nûSqu¬ed
(
‹xtCŞÜ
, CŞÜ::
wh™e
è> difã»nûSqu¬ed(
backgroundCŞÜ
, Color::white))

57 
di§bËdCŞÜ
 = 
‹xtCŞÜ
.
light
();

59 
	gdi§bËdCŞÜ
 = 
‹xtCŞÜ
.
d¬k
();

64 ià(
difã»nûSqu¬ed
(
di§bËdCŞÜ
, 
backgroundCŞÜ
è< 
	gmšCŞÜCÚŒa¡V®ue
)

65  
	g‹xtCŞÜ
;

67  
	gdi§bËdCŞÜ
;

70 
	gR’d”TextCÚŒŞ
::
R’d”TextCÚŒŞ
(
Node
* 
node
, 
boŞ
 
¶aûhŞd”VisibË
)

71 : 
R’d”Block
(
node
)

72 , 
m_¶aûhŞd”VisibË
(
¶aûhŞd”VisibË
)

73 , 
m_wasChªgedSšûLa¡ChªgeEv’t
(
çl£
)

74 , 
m_Ï¡ChªgeWasU£rEd™
(
çl£
)

78 
	gR’d”TextCÚŒŞ
::~
R’d”TextCÚŒŞ
()

81 ià(
m_šÃrText
)

82 
m_šÃrText
->
d‘ach
();

85 
	gR’d”TextCÚŒŞ
::
¡yËDidChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
)

87 
	gR’d”Block
::
¡yËDidChªge
(
diff
, 
ŞdStyË
);

89 ià(
	gm_šÃrText
) {

90 
R’d”Block
* 
	g‹xtBlockR’d””
 = 
toR’d”Block
(
m_šÃrText
->
»nd””
());

91 
	gRefPŒ
<
	gR’d”StyË
> 
	g‹xtBlockStyË
 = 
ü—‹IÂ”TextStyË
(
¡yË
());

94 
	g‹xtBlockR’d””
->
¡yË
()->
£tHeight
(
L’gth
());

95 
	g‹xtBlockR’d””
->
¡yË
()->
£tWidth
(
L’gth
());

96 
£tIÂ”TextStyË
(
‹xtBlockStyË
);

99 
£tR•Ïûd
(
isIÆše
());

102 
	gR’d”TextCÚŒŞ
::
£tIÂ”TextStyË
(
PassRefPŒ
<
R’d”StyË
> 
¡yË
)

104 ià(
m_šÃrText
) {

105 
RefPŒ
<
R’d”StyË
> 
‹xtStyË
 = 
¡yË
;

106 
	gm_šÃrText
->
»nd””
()->
£tStyË
(
‹xtStyË
);

107 
Node
* 
	gn
 = 
m_šÃrText
->
fœ¡Chd
();‚;‚ = 
n
->
Œav”£NextNode
(m_šÃrText.
g‘
())) {

108 ià(
n
->
»nd””
())

109 
n
->
»nd””
()->
£tStyË
(
‹xtStyË
);

114 
šlše
 
boŞ
 
upd©eU£rModifyPrİ”ty
(
Node
* 
node
, 
R’d”StyË
* 
¡yË
)

116 
boŞ
 
	gisEÇbËd
 = 
Œue
;

117 
boŞ
 
	gisR—dOÆyCÚŒŞ
 = 
çl£
;

119 ià(
	gnode
->
isEËm’tNode
()) {

120 
EËm’t
* 
	g–em’t
 = 
¡©ic_ÿ¡
<EËm’t*>(
node
);

121 
	gisEÇbËd
 = 
–em’t
->
isEÇbËdFÜmCÚŒŞ
();

122 
	gisR—dOÆyCÚŒŞ
 = 
–em’t
->
isR—dOÆyFÜmCÚŒŞ
();

125 
	g¡yË
->
£tU£rModify
((
isR—dOÆyCÚŒŞ
 || !
isEÇbËd
è? 
READ_ONLY
 : 
READ_WRITE_PLAINTEXT_ONLY
);

126  !
	gisEÇbËd
;

129 
	gR’d”TextCÚŒŞ
::
adju¡IÂ”TextStyË
(cÚ¡ 
R’d”StyË
* 
¡¬tStyË
, R’d”StyË* 
‹xtBlockStyË
) const

133 
	g‹xtBlockStyË
->
£tDœeùiÚ
(
¡yË
()->
dœeùiÚ
());

135 
boŞ
 
	gdi§bËd
 = 
upd©eU£rModifyPrİ”ty
(
node
(), 
‹xtBlockStyË
);

136 ià(
	gdi§bËd
)

137 
	g‹xtBlockStyË
->
£tCŞÜ
(
di§bËdTextCŞÜ
(
‹xtBlockStyË
->
cŞÜ
(), 
¡¬tStyË
->
backgroundCŞÜ
()));

140 
	gR’d”TextCÚŒŞ
::
ü—‹SubŒ“IfN“ded
(
TextCÚŒŞIÂ”EËm’t
* 
šÃrBlock
)

142 ià(!
m_šÃrText
) {

146 
R’d”StyË
* 
·»ÁStyË
 = 
šÃrBlock
 ? iÂ”Block->
»nd””
()->
¡yË
() : style();

147 
	gm_šÃrText
 = 
Ãw
 
TextCÚŒŞIÂ”TextEËm’t
(
docum’t
(), 
šÃrBlock
 ? 0 : 
node
());

148 
	gm_šÃrText
->
©chIÂ”EËm’t
(
šÃrBlock
 ? iÂ”Block : 
node
(), 
ü—‹IÂ”TextStyË
(
·»ÁStyË
), 
»nd”A»Ç
());

152 
	gR’d”TextCÚŒŞ
::
‹xtBlockHeight
() const

154  
height
(è- 
·ddšgTİ
(è- 
·ddšgBÙtom
(è- 
bÜd”Tİ
(è- 
bÜd”BÙtom
();

157 
	gR’d”TextCÚŒŞ
::
‹xtBlockWidth
() const

159  
width
(è- 
·ddšgLeá
(è- 
·ddšgRight
(è- 
bÜd”Leá
(è- 
bÜd”Right
()

160 - 
m_šÃrText
->
»nd”Box
()->
·ddšgLeá
(è- m_šÃrText->»nd”Box()->
·ddšgRight
();

163 
	gR’d”TextCÚŒŞ
::
upd©eFromEËm’t
()

165 
upd©eU£rModifyPrİ”ty
(
node
(), 
m_šÃrText
->
»nd””
()->
¡yË
());

168 
	gR’d”TextCÚŒŞ
::
£tIÂ”TextV®ue
(cÚ¡ 
SŒšg
& 
šÃrTextV®ue
)

170 
SŒšg
 
v®ue
;

172 ià(
	gšÃrTextV®ue
.
isNuÎ
())

173 
	gv®ue
 = "";

175 
	gv®ue
 = 
šÃrTextV®ue
;

176 
	gv®ue
 = 
docum’t
()->
di¥ÏySŒšgModif›dByEncodšg
(
v®ue
);

179 ià(
	gv®ue
 !ğ
‹xt
(è|| !
m_šÃrText
->
hasChdNodes
()) {

180 ià(
v®ue
 !ğ
‹xt
()) {

181 ià(
F¿me
* 
äame
 = 
docum’t
()->frame()) {

182 
äame
->
ed™Ü
()->
ş—rUndoRedoO³¿tiÚs
();

184 ià(
	gAXObjeùCache
::
acûssib™yEÇbËd
())

185 
docum’t
()->
axObjeùCache
()->
po¡NÙifiÿtiÚ
(
this
, 
AXObjeùCache
::
AXV®ueChªged
, 
çl£
);

189 
Exû±iÚCode
 
	gec
 = 0;

190 
	gm_šÃrText
->
£tIÂ”Text
(
v®ue
, 
ec
);

191 
ASSERT
(!
ec
);

193 ià(
	gv®ue
.
’dsW™h
("\n") || value.endsWith("\r")) {

194 
	gm_šÃrText
->
­³ndChd
(
Ãw
 
HTMLBREËm’t
(
brTag
, 
docum’t
()), 
ec
);

195 
ASSERT
(!
ec
);

199 
	gm_Ï¡ChªgeWasU£rEd™
 = 
çl£
;

202 
	g¡©ic_ÿ¡
<
	gEËm’t
*>(
node
())->
£tFÜmCÚŒŞV®ueM©chesR’d””
(
Œue
);

205 
	gR’d”TextCÚŒŞ
::
£tLa¡ChªgeWasU£rEd™
(
boŞ
 
Ï¡ChªgeWasU£rEd™
)

207 
m_Ï¡ChªgeWasU£rEd™
 = 
Ï¡ChªgeWasU£rEd™
;

208 
docum’t
()->
£tIgnÜeAutofocus
(
Ï¡ChªgeWasU£rEd™
);

211 
	gR’d”TextCÚŒŞ
::
£ËùiÚS¹
()

213 
F¿me
* 
äame
 = 
docum’t
()->frame();

214 ià(!
	gäame
)

216  
šdexFÜVisibËPos™iÚ
(
äame
->
£ËùiÚ
()->
¡¬t
());

219 
	gR’d”TextCÚŒŞ
::
£ËùiÚEnd
()

221 
F¿me
* 
äame
 = 
docum’t
()->frame();

222 ià(!
	gäame
)

224  
šdexFÜVisibËPos™iÚ
(
äame
->
£ËùiÚ
()->
’d
());

227 
	gR’d”TextCÚŒŞ
::
£tS–eùiÚS¹
(
¡¬t
)

229 
£tS–eùiÚRªge
(
¡¬t
, 
max
(¡¬t, 
£ËùiÚEnd
()));

232 
	gR’d”TextCÚŒŞ
::
£tS–eùiÚEnd
(
’d
)

234 
£tS–eùiÚRªge
(
mš
(
’d
, 
£ËùiÚS¹
()),ƒnd);

237 
	gR’d”TextCÚŒŞ
::
£Ëù
()

239 
£tS–eùiÚRªge
(0, 
‹xt
().
Ëngth
());

242 
	gR’d”TextCÚŒŞ
::
£tS–eùiÚRªge
(
¡¬t
, 
’d
)

244 
	g’d
 = 
max
(
’d
, 0);

245 
	g¡¬t
 = 
mš
(
max
(
¡¬t
, 0), 
’d
);

247 
ASSERT
(!
docum’t
()->
chdN“dsAndNÙInStyËReÿlc
());

249 ià(
¡yË
()->
visib™y
(è=ğ
HIDDEN
 || !
m_šÃrText
 || !m_šÃrText->
»nd””
(è|| !m_šÃrText->
»nd”Box
()->
height
()) {

250 
ÿcheS–eùiÚ
(
¡¬t
, 
’d
);

253 
VisibËPos™iÚ
 
	g¡¬tPos™iÚ
 = 
visibËPos™iÚFÜIndex
(
¡¬t
);

254 
VisibËPos™iÚ
 
	g’dPos™iÚ
;

255 ià(
	g¡¬t
 =ğ
’d
)

256 
’dPos™iÚ
 = 
¡¬tPos™iÚ
;

258 
	g’dPos™iÚ
 = 
visibËPos™iÚFÜIndex
(
’d
);

262 ià(
	g¡¬tPos™iÚ
.
isNÙNuÎ
(è&& 
	g’dPos™iÚ
.isNotNull()) {

263 
ASSERT
(
¡¬tPos™iÚ
.
d“pEquiv®’t
().
node
()->
shadowAnû¡ÜNode
(è=ğnode(è&& 
’dPos™iÚ
.deepEquivalent().node()->shadowAncestorNode() ==‚ode());

265 
VisibËS–eùiÚ
 
	gÃwS–eùiÚ
 = VisibËS–eùiÚ(
¡¬tPos™iÚ
, 
’dPos™iÚ
);

267 ià(
F¿me
* 
	gäame
 = 
docum’t
()->
äame
())

268 
äame
->
£ËùiÚ
()->
£tS–eùiÚ
(
ÃwS–eùiÚ
);

271 
VisibËS–eùiÚ
 
	gR’d”TextCÚŒŞ
::
£ËùiÚ
(
¡¬t
, 
’d
) const

273  
VisibËS–eùiÚ
(
VisibËPos™iÚ
(
m_šÃrText
.
g‘
(), 
¡¬t
, 
VP_DEFAULT_AFFINITY
),

274 
VisibËPos™iÚ
(
m_šÃrText
.
g‘
(), 
’d
, 
VP_DEFAULT_AFFINITY
));

277 
VisibËPos™iÚ
 
	gR’d”TextCÚŒŞ
::
visibËPos™iÚFÜIndex
(
šdex
)

279 ià(
šdex
 <= 0)

280  
VisibËPos™iÚ
(
m_šÃrText
.
g‘
(), 0, 
DOWNSTREAM
);

281 
Exû±iÚCode
 
	gec
 = 0;

282 
	gRefPŒ
<
	gRªge
> 
	g¿nge
 = 
Rªge
::
ü—‹
(
docum’t
());

283 
	g¿nge
->
£ËùNodeCÚ‹Ás
(
m_šÃrText
.
g‘
(), 
ec
);

284 
ASSERT
(!
ec
);

285 
Ch¬aù”I‹¿tÜ
 
™
(
¿nge
.
g‘
());

286 
	g™
.
advªû
(
šdex
 - 1);

287 
Node
* 
	g’dCÚš”
 = 
™
.
¿nge
()->
’dCÚš”
(
ec
);

288 
ASSERT
(!
ec
);

289 
	g’dOff£t
 = 
™
.
¿nge
()->
’dOff£t
(
ec
);

290 
ASSERT
(!
ec
);

291  
VisibËPos™iÚ
(
’dCÚš”
, 
’dOff£t
, 
UPSTREAM
);

294 
	gR’d”TextCÚŒŞ
::
šdexFÜVisibËPos™iÚ
(cÚ¡ 
VisibËPos™iÚ
& 
pos
)

296 
Pos™iÚ
 
šdexPos™iÚ
 = 
pos
.
d“pEquiv®’t
();

297 ià(!
	gšdexPos™iÚ
.
node
(è|| indexPos™iÚ.node()->
roÙEd™abËEËm’t
(è!ğ
m_šÃrText
)

299 
Exû±iÚCode
 
	gec
 = 0;

300 
	gRefPŒ
<
	gRªge
> 
	g¿nge
 = 
Rªge
::
ü—‹
(
docum’t
());

301 
	g¿nge
->
£tS¹
(
m_šÃrText
.
g‘
(), 0, 
ec
);

302 
ASSERT
(!
ec
);

303 
	g¿nge
->
£tEnd
(
šdexPos™iÚ
.
node
(), indexPos™iÚ.
d•»ÿ‹dEd™šgOff£t
(), 
ec
);

304 
ASSERT
(!
ec
);

305  
	gTextI‹¿tÜ
::
¿ngeL’gth
(
¿nge
.
g‘
());

308 
	gR’d”TextCÚŒŞ
::
subŒ“HasChªged
()

310 
m_wasChªgedSšûLa¡ChªgeEv’t
 = 
Œue
;

311 
	gm_Ï¡ChªgeWasU£rEd™
 = 
Œue
;

314 
SŒšg
 
	gR’d”TextCÚŒŞ
::
fšishText
(
VeùÜ
<
UCh¬
>& 
»suÉ
) const

317 
size_t
 
size
 = 
»suÉ
.size();

318 ià(
	gsize
 && 
	g»suÉ
[
size
 - 1] == '\n')

319 
»suÉ
.
shršk
(--
size
);

322 
docum’t
()->
di¥ÏyBufãrModif›dByEncodšg
(
»suÉ
.
d©a
(),„esuÉ.
size
());

324  
	gSŒšg
::
adİt
(
»suÉ
);

327 
SŒšg
 
	gR’d”TextCÚŒŞ
::
‹xt
()

329 ià(!
m_šÃrText
)

332 
	gVeùÜ
<
	gUCh¬
> 
	g»suÉ
;

334 
Node
* 
	gn
 = 
m_šÃrText
.
g‘
();‚;‚ = 
n
->
Œav”£NextNode
(m_innerText.get())) {

335 ià(
n
->
hasTagName
(
brTag
))

336 
»suÉ
.
­³nd
(&
ÃwlšeCh¬aù”
, 1);

337 ià(
	gn
->
isTextNode
()) {

338 
SŒšg
 
	gd©a
 = 
¡©ic_ÿ¡
<
Text
*>(
n
)->
d©a
();

339 
	g»suÉ
.
­³nd
(
d©a
.
ch¬aù”s
(), d©a.
Ëngth
());

343  
fšishText
(
»suÉ
);

346 
g‘NextSoáB»ak
(
RoÙIÆšeBox
*& 
lše
, 
Node
*& 
b»akNode
, & 
b»akOff£t
)

348 
RoÙIÆšeBox
* 
	gÃxt
;

349 ; 
	glše
;†šğ
Ãxt
) {

350 
Ãxt
 = 
lše
->
ÃxtRoÙBox
();

351 ià(
	gÃxt
 && !
	glše
->
’dsW™hB»ak
()) {

352 
ASSERT
(
lše
->
lšeB»akObj
());

353 
	gb»akNode
 = 
lše
->
lšeB»akObj
()->
node
();

354 
	gb»akOff£t
 = 
lše
->
lšeB»akPos
();

355 
	glše
 = 
Ãxt
;

359 
	gb»akNode
 = 0;

360 
	gb»akOff£t
 = 0;

363 
SŒšg
 
	gR’d”TextCÚŒŞ
::
‹xtW™hH¬dLšeB»aks
()

365 ià(!
m_šÃrText
)

367 
Node
* 
	gfœ¡Chd
 = 
m_šÃrText
->
fœ¡Chd
();

368 ià(!
	gfœ¡Chd
)

371 
R’d”Objeù
* 
	g»nd””
 = 
fœ¡Chd
->
»nd””
();

372 ià(!
	g»nd””
)

375 
IÆšeBox
* 
	gbox
 = 
»nd””
->
isText
(è? 
toR’d”Text
Ô’d””)->
fœ¡TextBox
(è: 
toR’d”Box
Ô’d””)->
šlšeBoxW¿µ”
();

376 ià(!
	gbox
)

379 
Node
* 
	gb»akNode
;

380 
	gb»akOff£t
;

381 
RoÙIÆšeBox
* 
	glše
 = 
box
->
roÙ
();

382 
g‘NextSoáB»ak
(
lše
, 
b»akNode
, 
b»akOff£t
);

384 
	gVeùÜ
<
	gUCh¬
> 
	g»suÉ
;

386 
Node
* 
	gn
 = 
fœ¡Chd
;‚;‚ = 
n
->
Œav”£NextNode
(
m_šÃrText
.
g‘
())) {

387 ià(
n
->
hasTagName
(
brTag
))

388 
»suÉ
.
­³nd
(&
ÃwlšeCh¬aù”
, 1);

389 ià(
	gn
->
isTextNode
()) {

390 
Text
* 
	g‹xt
 = 
¡©ic_ÿ¡
<Text*>(
n
);

391 
SŒšg
 
	gd©a
 = 
‹xt
->
d©a
();

392 
	gËngth
 = 
d©a
.
Ëngth
();

393 
	gpos™iÚ
 = 0;

394 
	gb»akNode
 =ğ
n
 && 
b»akOff£t
 <ğ
Ëngth
) {

395 ià(
b»akOff£t
 > 
pos™iÚ
) {

396 
»suÉ
.
­³nd
(
d©a
.
ch¬aù”s
(è+ 
pos™iÚ
, 
b»akOff£t
 -…osition);

397 
	gpos™iÚ
 = 
b»akOff£t
;

398 
	g»suÉ
.
­³nd
(&
ÃwlšeCh¬aù”
, 1);

400 
g‘NextSoáB»ak
(
lše
, 
b»akNode
, 
b»akOff£t
);

402 
	g»suÉ
.
­³nd
(
d©a
.
ch¬aù”s
(è+ 
pos™iÚ
, 
Ëngth
 -…osition);

404 
	gb»akNode
 =ğ
n
)

405 
g‘NextSoáB»ak
(
lše
, 
b»akNode
, 
b»akOff£t
);

408  
fšishText
(
»suÉ
);

411 
	gR’d”TextCÚŒŞ
::
süŞlb¬ThickÃss
() const

414  
SüŞlb¬Theme
::
ÇtiveTheme
()->
süŞlb¬ThickÃss
();

417 
	gR’d”TextCÚŒŞ
::
ÿlcHeight
()

419 
£tHeight
(
m_šÃrText
->
»nd”Box
()->
bÜd”Tİ
(è+ m_šÃrText->»nd”Box()->
bÜd”BÙtom
() +

420 
m_šÃrText
->
»nd”Box
()->
·ddšgTİ
(è+ m_šÃrText->»nd”Box()->
·ddšgBÙtom
() +

421 
m_šÃrText
->
»nd”Box
()->
m¬gšTİ
(è+ m_šÃrText->»nd”Box()->
m¬gšBÙtom
());

423 
adju¡CÚŒŞHeightBa£dOnLšeHeight
(
m_šÃrText
->
»nd””
()->
lšeHeight
(
Œue
,rue));

424 
£tHeight
(
height
(è+ 
·ddšgTİ
(è+ 
·ddšgBÙtom
(è+ 
bÜd”Tİ
(è+ 
bÜd”BÙtom
());

427 ià(
¡yË
()->
ov”æowX
(è=ğ
OSCROLL
 || (¡yË()->ov”æowX(è=ğ
OAUTO
 && 
m_šÃrText
->
»nd””
()->¡yË()->
wÜdW¿p
(è=ğ
NÜm®WÜdW¿p
))

428 
£tHeight
(
height
(è+ 
süŞlb¬ThickÃss
());

430 
	gR’d”Block
::
ÿlcHeight
();

433 
	gR’d”TextCÚŒŞ
::
h™IÂ”TextEËm’t
(
H™Te¡ResuÉ
& 
»suÉ
, 
xPos
, 
yPos
, 
tx
, 
ty
)

435 
	g»suÉ
.
£tIÂ”Node
(
m_šÃrText
.
g‘
());

436 
	g»suÉ
.
£tIÂ”NÚSh¬edNode
(
m_šÃrText
.
g‘
());

437 
	g»suÉ
.
£tLoÿlPošt
(
IÁPošt
(
xPos
 - 
tx
 - 
x
(è- 
m_šÃrText
->
»nd”Box
()->x(),

438 
yPos
 - 
ty
 - 
y
(è- 
m_šÃrText
->
»nd”Box
()->y()));

441 
	gR’d”TextCÚŒŞ
::
fÜw¬dEv’t
(
Ev’t
* 
ev’t
)

443 ià(
ev’t
->
ty³
(è=ğ
ev’tNames
().
blurEv’t
 ||ƒv’t->ty³(è=ğev’tNames().
focusEv’t
)

445 
	gm_šÃrText
->
deçuÉEv’tHªdËr
(
ev’t
);

448 
IÁReù
 
	gR’d”TextCÚŒŞ
::
cÚŒŞClReù
(
tx
, 
ty
) const

450 
IÁReù
 
	gşReù
 = 
cÚ‹ÁBoxReù
();

451 
	gşReù
.
move
(
tx
, 
ty
);

452  
	gşReù
;

455 cÚ¡ * 
	gfÚtFam›sW™hInv®idCh¬Width
[] = {

497 
boŞ
 
	gR’d”TextCÚŒŞ
::
hasV®idAvgCh¬Width
(
AtomicSŒšg
 
çmy
)

499 
HashS‘
<
AtomicSŒšg
>* 
fÚtFam›sW™hInv®idCh¬WidthM­
 = 0;

501 ià(!
	gfÚtFam›sW™hInv®idCh¬WidthM­
) {

502 
	gfÚtFam›sW™hInv®idCh¬WidthM­
 = 
Ãw
 
HashS‘
<
AtomicSŒšg
>;

504 
	gi
 = 0; i < (
	gfÚtFam›sW™hInv®idCh¬Width
) / (fontFamiliesWithInvalidCharWidth[0]); i++)

505 
	gfÚtFam›sW™hInv®idCh¬WidthM­
->
add
(
AtomicSŒšg
(
fÚtFam›sW™hInv®idCh¬Width
[
i
]));

508  !
	gfÚtFam›sW™hInv®idCh¬WidthM­
->
cÚšs
(
çmy
);

511 
	gR’d”TextCÚŒŞ
::
g‘AvgCh¬Width
(
AtomicSŒšg
 
çmy
)

513 ià(
hasV®idAvgCh¬Width
(
çmy
))

514  
roundf
(
¡yË
()->
fÚt
().
´im¬yFÚt
()->
avgCh¬Width
());

516 cÚ¡ 
UCh¬
 
	gch
 = '0';

517  
¡yË
()->
fÚt
().
æßtWidth
(
TextRun
(&
ch
, 1, 
çl£
, 0, 0, false, false, false));

520 
	gR’d”TextCÚŒŞ
::
sÿËEmToUn™s
(
x
) const

523 
un™sP”Em
 = 2048.0f;

524  
roundf
(
¡yË
()->
fÚt
().
size
(è* 
x
 / 
un™sP”Em
);

527 
	gR’d”TextCÚŒŞ
::
ÿlcP»fWidths
()

529 
ASSERT
(
´efWidthsDœty
());

531 
	gm_mšP»fWidth
 = 0;

532 
	gm_maxP»fWidth
 = 0;

534 ià(
¡yË
()->
width
().
isFixed
(è&& styË()->width().
v®ue
() > 0)

535 
	gm_mšP»fWidth
 = 
m_maxP»fWidth
 = 
ÿlcCÚ‹ÁBoxWidth
(
¡yË
()->
width
().
v®ue
());

538 
AtomicSŒšg
 
	gçmy
 = 
¡yË
()->
fÚt
().
çmy
().family();

539 
	gm_maxP»fWidth
 = 
´eã¼edCÚ‹ÁWidth
(
g‘AvgCh¬Width
(
çmy
)è+ 
m_šÃrText
->
»nd”Box
()->
·ddšgLeá
(è+ m_šÃrText->»nd”Box()->
·ddšgRight
();

542 ià(
¡yË
()->
mšWidth
().
isFixed
(è&& styË()->mšWidth().
v®ue
() > 0) {

543 
	gm_maxP»fWidth
 = 
max
(
m_maxP»fWidth
, 
ÿlcCÚ‹ÁBoxWidth
(
¡yË
()->
mšWidth
().
v®ue
()));

544 
	gm_mšP»fWidth
 = 
max
(
m_mšP»fWidth
, 
ÿlcCÚ‹ÁBoxWidth
(
¡yË
()->
mšWidth
().
v®ue
()));

545 } ià(
¡yË
()->
width
().
isP”ûÁ
(è|| (¡yË()->width().
isAuto
(è&& styË()->
height
().isPercent()))

546 
	gm_mšP»fWidth
 = 0;

548 
	gm_mšP»fWidth
 = 
m_maxP»fWidth
;

550 ià(
¡yË
()->
maxWidth
().
isFixed
(è&& styË()->maxWidth().
v®ue
(è!ğ
undefšedL’gth
) {

551 
m_maxP»fWidth
 = 
mš
(m_maxP»fWidth, 
ÿlcCÚ‹ÁBoxWidth
(
¡yË
()->
maxWidth
().
v®ue
()));

552 
	gm_mšP»fWidth
 = 
mš
(
m_mšP»fWidth
, 
ÿlcCÚ‹ÁBoxWidth
(
¡yË
()->
maxWidth
().
v®ue
()));

555 
	gtoAdd
 = 
·ddšgLeá
(è+ 
·ddšgRight
(è+ 
bÜd”Leá
(è+ 
bÜd”Right
();

557 
	gm_mšP»fWidth
 +ğ
toAdd
;

558 
	gm_maxP»fWidth
 +ğ
toAdd
;

560 
£tP»fWidthsDœty
(
çl£
);

563 
	gR’d”TextCÚŒŞ
::
£ËùiÚChªged
(
boŞ
 
u£rTrigg”ed
)

565 
ÿcheS–eùiÚ
(
£ËùiÚS¹
(), 
£ËùiÚEnd
());

567 ià(
F¿me
* 
	gäame
 = 
docum’t
()->
äame
()) {

568 ià(
äame
->
£ËùiÚ
()->
isRªge
(è&& 
u£rTrigg”ed
)

569 
node
()->
di¥©chEv’t
(
Ev’t
::
ü—‹
(
ev’tNames
().
£ËùEv’t
, 
Œue
, 
çl£
));

573 
	gR’d”TextCÚŒŞ
::
addFocusRšgReùs
(
VeùÜ
<
IÁReù
>& 
»ùs
, 
tx
, 
ty
)

575 ià(
width
(è&& 
height
())

576 
	g»ùs
.
­³nd
(
IÁReù
(
tx
, 
ty
, 
width
(), 
height
()));

579 
HTMLEËm’t
* 
	gR’d”TextCÚŒŞ
::
šÃrTextEËm’t
() const

581  
m_šÃrText
.
g‘
();

584 
	gR’d”TextCÚŒŞ
::
upd©ePÏûhŞd”Visib™y
(
boŞ
 
¶aûhŞd”ShouldBeVisibË
, boŞ 
¶aûhŞd”V®ueChªged
)

586 
boŞ
 
	gŞdPÏûhŞd”VisibË
 = 
m_¶aûhŞd”VisibË
;

587 
	gm_¶aûhŞd”VisibË
 = 
¶aûhŞd”ShouldBeVisibË
;

588 ià(
	gŞdPÏûhŞd”VisibË
 !ğ
m_¶aûhŞd”VisibË
 || 
¶aûhŞd”V®ueChªged
) {

590 
£tIÂ”TextStyË
(
ü—‹IÂ”TextStyË
(
‹xtBa£StyË
()));

594 
upd©eFromEËm’t
();

	@RenderTextControl.h

22 #iâdeà
R’d”TextCÚŒŞ_h


23 
	#R’d”TextCÚŒŞ_h


	)

25 
	~"R’d”Block.h
"

27 
Çme¥aû
 
	gWebCÜe
 {

29 
şass
 
	gVisibËS–eùiÚ
;

30 
şass
 
	gTextCÚŒŞIÂ”EËm’t
;

31 
şass
 
	gTextCÚŒŞIÂ”TextEËm’t
;

33 şas 
	cR’d”TextCÚŒŞ
 : 
public
 
R’d”Block
 {

34 
public
:

35 
vœtu®
 ~
R’d”TextCÚŒŞ
();

37 
boŞ
 
wasChªgedSšûLa¡ChªgeEv’t
(ècÚ¡ {  
	gm_wasChªgedSšûLa¡ChªgeEv’t
; }

38 
£tChªgedSšûLa¡ChªgeEv’t
(
boŞ
 
wasChªgedSšûLa¡ChªgeEv’t
è{ 
	gm_wasChªgedSšûLa¡ChªgeEv’t
 = wasChangedSinceLastChangeEvent; }

40 
boŞ
 
Ï¡ChªgeWasU£rEd™
(ècÚ¡ {  
	gm_Ï¡ChªgeWasU£rEd™
; }

41 
£tLa¡ChªgeWasU£rEd™
(
boŞ
 
Ï¡ChªgeWasU£rEd™
);

43 
£ËùiÚS¹
();

44 
£ËùiÚEnd
();

45 
£tS–eùiÚS¹
();

46 
£tS–eùiÚEnd
();

47 
£Ëù
();

48 
£tS–eùiÚRªge
(
¡¬t
, 
’d
);

49 
VisibËS–eùiÚ
 
£ËùiÚ
(
¡¬t
, 
’d
) const;

51 
vœtu®
 
subŒ“HasChªged
();

52 
SŒšg
 
‹xt
();

53 
SŒšg
 
‹xtW™hH¬dLšeB»aks
();

54 
£ËùiÚChªged
(
boŞ
 
u£rTrigg”ed
);

56 
VisibËPos™iÚ
 
visibËPos™iÚFÜIndex
(
šdex
);

57 
šdexFÜVisibËPos™iÚ
(cÚ¡ 
VisibËPos™iÚ
&);

59 
upd©ePÏûhŞd”Visib™y
(
boŞ
, bool);

61 
	g´Ùeùed
:

62 
R’d”TextCÚŒŞ
(
Node
*, 
boŞ
);

64 
süŞlb¬ThickÃss
() const;

65 
adju¡IÂ”TextStyË
(cÚ¡ 
R’d”StyË
* 
¡¬tStyË
, R’d”StyË* 
‹xtBlockStyË
) const;

66 
£tIÂ”TextV®ue
(cÚ¡ 
SŒšg
&);

68 
vœtu®
 
¡yËDidChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
);

70 
ü—‹SubŒ“IfN“ded
(
TextCÚŒŞIÂ”EËm’t
* 
šÃrBlock
);

71 
h™IÂ”TextEËm’t
(
H™Te¡ResuÉ
&, 
x
, 
y
, 
tx
, 
ty
);

72 
fÜw¬dEv’t
(
Ev’t
*);

74 
‹xtBlockWidth
() const;

75 
‹xtBlockHeight
() const;

77 
sÿËEmToUn™s
(
x
) const;

79 
boŞ
 
hasV®idAvgCh¬Width
(
AtomicSŒšg
 
çmy
);

80 
vœtu®
 
g‘AvgCh¬Width
(
AtomicSŒšg
 
çmy
);

81 
vœtu®
 
´eã¼edCÚ‹ÁWidth
(
ch¬Width
) const = 0;

82 
vœtu®
 
adju¡CÚŒŞHeightBa£dOnLšeHeight
(
lšeHeight
) = 0;

83 
vœtu®
 
ÿcheS–eùiÚ
(
¡¬t
, 
’d
) = 0;

84 
vœtu®
 
	gPassRefPŒ
<
	gR’d”StyË
> 
ü—‹IÂ”TextStyË
(cÚ¡ 
R’d”StyË
* 
¡¬tStyË
) const = 0;

85 
vœtu®
 
R’d”StyË
* 
‹xtBa£StyË
() const = 0;

87 
vœtu®
 
upd©eFromEËm’t
();

88 
vœtu®
 
ÿlcHeight
();

90 
ä›nd
 
şass
 
	gTextI‹¿tÜ
;

91 
HTMLEËm’t
* 
šÃrTextEËm’t
() const;

93 
boŞ
 
	gm_¶aûhŞd”VisibË
;

95 
	g´iv©e
:

96 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderTextControl"; }

97 
vœtu®
 
boŞ
 
isTextCÚŒŞ
(ècÚ¡ {  
	gŒue
; }

98 
vœtu®
 
boŞ
 
hasCÚŒŞCl
(ècÚ¡ {  
	gçl£
; }

99 
vœtu®
 
IÁReù
 
cÚŒŞClReù
(
tx
, 
ty
) const;

100 
vœtu®
 
ÿlcP»fWidths
();

101 
vœtu®
 
»moveLeáov”AnÚymousBlock
(
R’d”Block
*) { }

102 
vœtu®
 
boŞ
 
ÿnHaveChd»n
(ècÚ¡ {  
	gçl£
; }

103 
vœtu®
 
boŞ
 
avoidsFlßts
(ècÚ¡ {  
	gŒue
; }

104 
£tIÂ”TextStyË
(
PassRefPŒ
<
R’d”StyË
>);

106 
vœtu®
 
addFocusRšgReùs
(
VeùÜ
<
IÁReù
>&, 
tx
, 
ty
);

108 
vœtu®
 
boŞ
 
ÿnBeProg¿m©iÿÎySüŞËd
(boŞècÚ¡ {  
	gŒue
; }

110 
SŒšg
 
fšishText
(
VeùÜ
<
UCh¬
>&) const;

112 
boŞ
 
	gm_wasChªgedSšûLa¡ChªgeEv’t
;

113 
boŞ
 
	gm_Ï¡ChªgeWasU£rEd™
;

114 
	gRefPŒ
<
	gTextCÚŒŞIÂ”TextEËm’t
> 
	gm_šÃrText
;

117 
šlše
 
R’d”TextCÚŒŞ
* 
	$toR’d”TextCÚŒŞ
(
R’d”Objeù
* 
objeù
)

119 
	`ASSERT
(!
objeù
 || objeù->
	`isTextCÚŒŞ
());

120  
¡©ic_ÿ¡
<
R’d”TextCÚŒŞ
*>(
objeù
);

121 
	}
}

123 
šlše
 cÚ¡ 
R’d”TextCÚŒŞ
* 
	$toR’d”TextCÚŒŞ
(cÚ¡ 
R’d”Objeù
* 
objeù
)

125 
	`ASSERT
(!
objeù
 || objeù->
	`isTextCÚŒŞ
());

126  
¡©ic_ÿ¡
<cÚ¡ 
R’d”TextCÚŒŞ
*>(
objeù
);

127 
	}
}

130 
toR’d”TextCÚŒŞ
(cÚ¡ 
R’d”TextCÚŒŞ
*);

	@RenderTextControlMultiLine.cpp

22 
	~"cÚfig.h
"

23 
	~"R’d”TextCÚŒŞMuÉiLše.h
"

25 
	~"Ev’t.h
"

26 
	~"Ev’tNames.h
"

27 
	~"F¿me.h
"

28 
	~"HTMLNames.h
"

29 
	~"HTMLTextA»aEËm’t.h
"

30 
	~"H™Te¡ResuÉ.h
"

32 
Çme¥aû
 
	gWebCÜe
 {

34 
	gR’d”TextCÚŒŞMuÉiLše
::
R’d”TextCÚŒŞMuÉiLše
(
Node
* 
node
, 
boŞ
 
¶aûhŞd”VisibË
)

35 : 
R’d”TextCÚŒŞ
(
node
, 
¶aûhŞd”VisibË
)

39 
	gR’d”TextCÚŒŞMuÉiLše
::~
R’d”TextCÚŒŞMuÉiLše
()

41 ià(
node
())

42 
¡©ic_ÿ¡
<
HTMLTextA»aEËm’t
*>(
node
())->
»nd””WlBeDe¡royed
();

45 
	gR’d”TextCÚŒŞMuÉiLše
::
subŒ“HasChªged
()

47 
R’d”TextCÚŒŞ
::
subŒ“HasChªged
();

48 
HTMLTextA»aEËm’t
* 
	g‹xtA»a
 = 
¡©ic_ÿ¡
<HTMLTextA»aEËm’t*>(
node
());

49 
	g‹xtA»a
->
£tFÜmCÚŒŞV®ueM©chesR’d””
(
çl£
);

50 
	g‹xtA»a
->
£tN“dsV®id™yCheck
();

52 ià(!
node
()->
focu£d
())

55 
node
()->
di¥©chEv’t
(
Ev’t
::
ü—‹
(
ev’tNames
().
šputEv’t
, 
Œue
, 
çl£
));

57 ià(
F¿me
* 
	gäame
 = 
docum’t
()->
äame
())

58 
äame
->
‹xtDidChªgeInTextA»a
(
‹xtA»a
);

61 
boŞ
 
	gR’d”TextCÚŒŞMuÉiLše
::
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
& 
»que¡
, 
H™Te¡ResuÉ
& 
»suÉ
, 
x
, 
y
, 
tx
, 
ty
, 
H™Te¡AùiÚ
 
h™Te¡AùiÚ
)

63 ià(!
	gR’d”TextCÚŒŞ
::
nodeAtPošt
(
»que¡
, 
»suÉ
, 
x
, 
y
, 
tx
, 
ty
, 
h™Te¡AùiÚ
))

64  
	gçl£
;

66 
boŞ
 
	g»suÉIsTextV®ueOrPÏûhŞd”


67 ğ(!
m_¶aûhŞd”VisibË
 && 
»suÉ
.
šÃrNode
(è=ğ
šÃrTextEËm’t
())

68 || (
m_¶aûhŞd”VisibË
 && 
»suÉ
.
šÃrNode
()->
isDesûndªtOf
(
šÃrTextEËm’t
()));

69 ià(
	g»suÉ
.
šÃrNode
(è=ğ
node
(è|| 
»suÉIsTextV®ueOrPÏûhŞd”
)

70 
h™IÂ”TextEËm’t
(
»suÉ
, 
x
, 
y
, 
tx
, 
ty
);

72  
	gŒue
;

75 
	gR’d”TextCÚŒŞMuÉiLše
::
fÜw¬dEv’t
(
Ev’t
* 
ev’t
)

77 
R’d”TextCÚŒŞ
::
fÜw¬dEv’t
(
ev’t
);

80 
	gR’d”TextCÚŒŞMuÉiLše
::
g‘AvgCh¬Width
(
AtomicSŒšg
 
çmy
)

85 ià(
çmy
 =ğ
AtomicSŒšg
("Lucida Grande"))

86  
sÿËEmToUn™s
(1229);

88  
	gR’d”TextCÚŒŞ
::
g‘AvgCh¬Width
(
çmy
);

91 
	gR’d”TextCÚŒŞMuÉiLše
::
´eã¼edCÚ‹ÁWidth
(
ch¬Width
) const

93 
çùÜ
 = 
¡©ic_ÿ¡
<
HTMLTextA»aEËm’t
*>(
node
())->
cŞs
();

94  
	g¡©ic_ÿ¡
<>(
ûf
(
ch¬Width
 * 
çùÜ
)è+ 
süŞlb¬ThickÃss
();

97 
	gR’d”TextCÚŒŞMuÉiLše
::
adju¡CÚŒŞHeightBa£dOnLšeHeight
(
lšeHeight
)

99 
£tHeight
(
height
(è+ 
lšeHeight
 * 
¡©ic_ÿ¡
<
HTMLTextA»aEËm’t
*>(
node
())->
rows
());

102 
	gR’d”TextCÚŒŞMuÉiLše
::
ba£lšePos™iÚ
(
boŞ
, bool) const

104  
height
(è+ 
m¬gšTİ
(è+ 
m¬gšBÙtom
();

107 
	gR’d”TextCÚŒŞMuÉiLše
::
upd©eFromEËm’t
()

109 
ü—‹SubŒ“IfN“ded
(0);

110 
	gR’d”TextCÚŒŞ
::
upd©eFromEËm’t
();

112 
HTMLTextA»aEËm’t
* 
	g‹xtA»a
 = 
¡©ic_ÿ¡
<HTMLTextA»aEËm’t*>(
node
());

113 ià(
	gm_¶aûhŞd”VisibË
)

114 
£tIÂ”TextV®ue
(
‹xtA»a
->
g‘A‰ribu‹
(
HTMLNames
::
¶aûhŞd”A‰r
));

116 
£tIÂ”TextV®ue
(
‹xtA»a
->
v®ue
());

119 
	gR’d”TextCÚŒŞMuÉiLše
::
ÿcheS–eùiÚ
(
¡¬t
, 
’d
)

121 
	g¡©ic_ÿ¡
<
	gHTMLTextA»aEËm’t
*>(
node
())->
ÿcheS–eùiÚ
(
¡¬t
, 
’d
);

124 
	gPassRefPŒ
<
	gR’d”StyË
> 
	gR’d”TextCÚŒŞMuÉiLše
::
ü—‹IÂ”TextStyË
(cÚ¡ 
R’d”StyË
* 
¡¬tStyË
) const

126 
RefPŒ
<
R’d”StyË
> 
‹xtBlockStyË
;

127 ià(
	gm_¶aûhŞd”VisibË
) {

128 ià(
R’d”StyË
* 
	gp£udoStyË
 = 
g‘CachedP£udoStyË
(
INPUT_PLACEHOLDER
))

129 
‹xtBlockStyË
 = 
R’d”StyË
::
şÚe
(
p£udoStyË
);

131 ià(!
	g‹xtBlockStyË
) {

132 
	g‹xtBlockStyË
 = 
R’d”StyË
::
ü—‹
();

133 
	g‹xtBlockStyË
->
šh”™From
(
¡¬tStyË
);

136 
adju¡IÂ”TextStyË
(
¡¬tStyË
, 
‹xtBlockStyË
.
g‘
());

137 
	g‹xtBlockStyË
->
£tDi¥Ïy
(
BLOCK
);

139  
	g‹xtBlockStyË
.
»Ëa£
();

142 
R’d”StyË
* 
	gR’d”TextCÚŒŞMuÉiLše
::
‹xtBa£StyË
() const

144  
¡yË
();

	@RenderTextControlMultiLine.h

22 #iâdeà
R’d”TextCÚŒŞMuÉiLše_h


23 
	#R’d”TextCÚŒŞMuÉiLše_h


	)

25 
	~"R’d”TextCÚŒŞ.h
"

27 
Çme¥aû
 
	gWebCÜe
 {

29 şas 
	cR’d”TextCÚŒŞMuÉiLše
 : 
public
 
R’d”TextCÚŒŞ
 {

30 
public
:

31 
R’d”TextCÚŒŞMuÉiLše
(
Node
*, 
boŞ
);

32 
	gvœtu®
 ~
R’d”TextCÚŒŞMuÉiLše
();

34 
fÜw¬dEv’t
(
Ev’t
*);

36 
	g´iv©e
:

37 
vœtu®
 
boŞ
 
isTextA»a
(ècÚ¡ {  
Œue
; }

39 
vœtu®
 
subŒ“HasChªged
();

41 
vœtu®
 
boŞ
 
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, 
x
, 
y
, 
tx
, 
ty
, 
H™Te¡AùiÚ
);

43 
vœtu®
 
g‘AvgCh¬Width
(
AtomicSŒšg
 
çmy
);

44 
vœtu®
 
´eã¼edCÚ‹ÁWidth
(
ch¬Width
) const;

45 
vœtu®
 
adju¡CÚŒŞHeightBa£dOnLšeHeight
(
lšeHeight
);

46 
vœtu®
 
ba£lšePos™iÚ
(
boŞ
 
fœ¡Lše
, boŞ 
isRoÙLšeBox
) const;

48 
vœtu®
 
upd©eFromEËm’t
();

49 
vœtu®
 
ÿcheS–eùiÚ
(
¡¬t
, 
’d
);

51 
vœtu®
 
R’d”StyË
* 
‹xtBa£StyË
() const;

52 
vœtu®
 
	gPassRefPŒ
<
	gR’d”StyË
> 
ü—‹IÂ”TextStyË
(cÚ¡ 
R’d”StyË
* 
¡¬tStyË
) const;

55 
šlše
 
R’d”TextCÚŒŞMuÉiLše
* 
	$toR’d”TextCÚŒŞMuÉiLše
(
R’d”Objeù
* 
objeù
)

57 
	`ASSERT
(!
objeù
 || objeù->
	`isTextA»a
());

58  
¡©ic_ÿ¡
<
R’d”TextCÚŒŞMuÉiLše
*>(
objeù
);

59 
	}
}

62 
toR’d”TextCÚŒŞMuÉiLše
(cÚ¡ 
R’d”TextCÚŒŞMuÉiLše
*);

	@RenderTextControlSingleLine.cpp

22 
	~"cÚfig.h
"

23 
	~"R’d”TextCÚŒŞSšgËLše.h
"

25 
	~"CSSStyËS–eùÜ.h
"

26 
	~"Ev’t.h
"

27 
	~"Ev’tNames.h
"

28 
	~"F¿me.h
"

29 
	~"F¿meV›w.h
"

30 
	~"H™Te¡ResuÉ.h
"

31 
	~"HTMLIÅutEËm’t.h
"

32 
	~"HTMLNames.h
"

33 
	~"IÅutEËm’t.h
"

34 
	~"LoÿlizedSŒšgs.h
"

35 
	~"Mou£Ev’t.h
"

36 
	~"PÏtfÜmKeybßrdEv’t.h
"

37 
	~"R’d”SüŞlb¬.h
"

38 
	~"R’d”Theme.h
"

39 
	~"S—rchPİupM’u.h
"

40 
	~"S–eùiÚCÚŒŞËr.h
"

41 
	~"S‘tšgs.h
"

42 
	~"Sim¶eFÚtD©a.h
"

43 
	~"TextCÚŒŞIÂ”EËm’ts.h
"

45 
usšg
 
Çme¥aû
 
	g¡d
;

47 
Çme¥aû
 
	gWebCÜe
 {

49 
usšg
 
Çme¥aû
 
	gHTMLNames
;

51 
	gR’d”TextCÚŒŞSšgËLše
::
R’d”TextCÚŒŞSšgËLše
(
Node
* 
node
, 
boŞ
 
¶aûhŞd”VisibË
)

52 : 
R’d”TextCÚŒŞ
(
node
, 
¶aûhŞd”VisibË
)

53 , 
m_£¬chPİupIsVisibË
(
çl£
)

54 , 
m_shouldD¿wC­sLockIndiÿtÜ
(
çl£
)

55 , 
m_£¬chEv’tTim”
(
this
, &
R’d”TextCÚŒŞSšgËLše
::
£¬chEv’tTim”Fœed
)

56 , 
m_£¬chPİup
(0)

60 
	gR’d”TextCÚŒŞSšgËLše
::~
R’d”TextCÚŒŞSšgËLše
()

62 ià(
m_£¬chPİup
) {

63 
m_£¬chPİup
->
discÚÃùCl›Á
();

64 
	gm_£¬chPİup
 = 0;

67 ià(
	gm_šÃrBlock
)

68 
	gm_šÃrBlock
->
d‘ach
();

71 
R’d”StyË
* 
	gR’d”TextCÚŒŞSšgËLše
::
‹xtBa£StyË
() const

73  
m_šÃrBlock
 ? m_šÃrBlock->
»nd””
()->
¡yË
() : style();

76 
	gR’d”TextCÚŒŞSšgËLše
::
addS—rchResuÉ
()

78 
ASSERT
(
node
()->
isHTMLEËm’t
());

79 
HTMLIÅutEËm’t
* 
	gšput
 = 
¡©ic_ÿ¡
<HTMLIÅutEËm’t*>(
node
());

80 ià(
	gšput
->
maxResuÉs
() <= 0)

83 
SŒšg
 
	gv®ue
 = 
šput
->
v®ue
();

84 ià(
	gv®ue
.
isEm±y
())

87 
S‘tšgs
* 
	g£‰šgs
 = 
docum’t
()->
£‰šgs
();

88 ià(!
	g£‰šgs
 || s‘tšgs->
´iv©eBrowsšgEÇbËd
())

91 
	gsize
 = 
¡©ic_ÿ¡
<>(
m_»ûÁS—rches
.
size
());

92 
	gi
 = 
size
 - 1; i >= 0; --i) {

93 ià(
	gm_»ûÁS—rches
[
i
] =ğ
v®ue
)

94 
m_»ûÁS—rches
.
»move
(
i
);

97 
	gm_»ûÁS—rches
.
š£¹
(0, 
v®ue
);

98 
	g¡©ic_ÿ¡
<>(
	gm_»ûÁS—rches
.
size
()è> 
	gšput
->
maxResuÉs
())

99 
	gm_»ûÁS—rches
.
»moveLa¡
();

101 cÚ¡ 
	gAtomicSŒšg
& 
	gÇme
 = 
auto§veName
();

102 ià(!
	gm_£¬chPİup
)

103 
	gm_£¬chPİup
 = 
S—rchPİupM’u
::
ü—‹
(
this
);

105 
	gm_£¬chPİup
->
§veReûÁS—rches
(
Çme
, 
m_»ûÁS—rches
);

108 
	gR’d”TextCÚŒŞSšgËLše
::
¡İS—rchEv’tTim”
()

110 
ASSERT
(
node
()->
isHTMLEËm’t
());

111 
	gm_£¬chEv’tTim”
.
¡İ
();

114 
	gR’d”TextCÚŒŞSšgËLše
::
showPİup
()

116 
ASSERT
(
node
()->
isHTMLEËm’t
());

117 ià(
	gm_£¬chPİupIsVisibË
)

120 ià(!
	gm_£¬chPİup
)

121 
	gm_£¬chPİup
 = 
S—rchPİupM’u
::
ü—‹
(
this
);

123 ià(!
	gm_£¬chPİup
->
’abËd
())

126 
	gm_£¬chPİupIsVisibË
 = 
Œue
;

128 cÚ¡ 
	gAtomicSŒšg
& 
	gÇme
 = 
auto§veName
();

129 
	gm_£¬chPİup
->
lßdReûÁS—rches
(
Çme
, 
m_»ûÁS—rches
);

132 
HTMLIÅutEËm’t
* 
	gšput
 = 
¡©ic_ÿ¡
<HTMLIÅutEËm’t*>(
node
());

133 ià(
	g¡©ic_ÿ¡
<>(
	gm_»ûÁS—rches
.
size
()è> 
	gšput
->
maxResuÉs
()) {

135 
	gm_»ûÁS—rches
.
»moveLa¡
();

136 } 
	g¡©ic_ÿ¡
<>(
	gm_»ûÁS—rches
.
size
()è> 
	gšput
->
maxResuÉs
());

138 
	gm_£¬chPİup
->
§veReûÁS—rches
(
Çme
, 
m_»ûÁS—rches
);

141 
	gm_£¬chPİup
->
show
(
absŞu‹BoundšgBoxReù
(
Œue
), 
docum’t
()->
v›w
(), -1);

144 
	gR’d”TextCÚŒŞSšgËLše
::
hidePİup
()

146 
ASSERT
(
node
()->
isHTMLEËm’t
());

147 ià(
	gm_£¬chPİup
)

148 
	gm_£¬chPİup
->
hide
();

151 
	gR’d”TextCÚŒŞSšgËLše
::
subŒ“HasChªged
()

153 
boŞ
 
wasChªged
 = 
wasChªgedSšûLa¡ChªgeEv’t
();

154 
	gR’d”TextCÚŒŞ
::
subŒ“HasChªged
();

156 
IÅutEËm’t
* 
	gšput
 = 
šputEËm’t
();

161 
	gšput
->
£tV®ueFromR’d””
(
šput
->
§n™izeV®ue
(
‹xt
()));

163 ià(
	gm_ÿnûlBu‰Ú
)

164 
upd©eCªûlBu‰ÚVisib™y
();

167 ià(
	gšput
->
£¬chEv’tsShouldBeDi¥©ched
())

168 
¡¬tS—rchEv’tTim”
();

170 ià(!
	gwasChªged
 && 
node
()->
focu£d
()) {

171 ià(
F¿me
* 
	gäame
 = 
docum’t
()->
äame
())

172 
äame
->
‹xtF›ldDidBegšEd™šg
(
¡©ic_ÿ¡
<
EËm’t
*>(
node
()));

175 ià(
node
()->
focu£d
()) {

176 ià(
F¿me
* 
	gäame
 = 
docum’t
()->
äame
())

177 
äame
->
‹xtDidChªgeInTextF›ld
(
¡©ic_ÿ¡
<
EËm’t
*>(
node
()));

181 
	gR’d”TextCÚŒŞSšgËLše
::
·št
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

183 
	gR’d”TextCÚŒŞ
::
·št
(
·štInfo
, 
tx
, 
ty
);

185 ià(
	g·štInfo
.
	gpha£
 =ğ
PaštPha£BlockBackground
 && 
m_shouldD¿wC­sLockIndiÿtÜ
) {

186 
IÁReù
 
cÚ‹ÁsReù
 = 
cÚ‹ÁBoxReù
();

189 
	gcÚ‹ÁsReù
.
move
(
tx
 + 
x
(), 
ty
 + 
y
());

190 
theme
()->
·štC­sLockIndiÿtÜ
(
this
, 
·štInfo
, 
cÚ‹ÁsReù
);

194 
	gR’d”TextCÚŒŞSšgËLše
::
Ïyout
()

196 
ŞdHeight
 = 
height
();

197 
ÿlcHeight
();

199 
	gŞdWidth
 = 
width
();

200 
ÿlcWidth
();

202 
boŞ
 
	g»ÏyoutChd»n
 = 
ŞdHeight
 !ğ
height
(è|| 
ŞdWidth
 !ğ
width
();

204 
R’d”Box
* 
	gšÃrTextR’d””
 = 
šÃrTextEËm’t
()->
»nd”Box
();

205 
R’d”Box
* 
	gšÃrBlockR’d””
 = 
m_šÃrBlock
 ? m_šÃrBlock->
»nd”Box
() : 0;

208 
	gdesœedHeight
 = 
‹xtBlockHeight
();

209 
	gcu¼’tHeight
 = 
šÃrTextR’d””
->
height
();

211 ià(
	gcu¼’tHeight
 > 
height
()) {

212 ià(
	gdesœedHeight
 !ğ
cu¼’tHeight
)

213 
»ÏyoutChd»n
 = 
Œue
;

214 
	gšÃrTextR’d””
->
¡yË
()->
£tHeight
(
L’gth
(
desœedHeight
, 
Fixed
));

215 ià(
	gm_šÃrBlock
)

216 
	gšÃrBlockR’d””
->
¡yË
()->
£tHeight
(
L’gth
(
desœedHeight
, 
Fixed
));

220 
	gdesœedWidth
 = 
‹xtBlockWidth
();

221 ià(
	gdesœedWidth
 !ğ
šÃrTextR’d””
->
width
())

222 
»ÏyoutChd»n
 = 
Œue
;

223 
	gšÃrTextR’d””
->
¡yË
()->
£tWidth
(
L’gth
(
desœedWidth
, 
Fixed
));

225 ià(
	gm_šÃrBlock
) {

226 
	gšÃrBlockWidth
 = 
width
(è- 
·ddšgLeá
(è- 
·ddšgRight
(è- 
bÜd”Leá
(è- 
bÜd”Right
();

227 ià(
	gšÃrBlockWidth
 !ğ
šÃrBlockR’d””
->
width
())

228 
»ÏyoutChd»n
 = 
Œue
;

229 
	gšÃrBlockR’d””
->
¡yË
()->
£tWidth
(
L’gth
(
šÃrBlockWidth
, 
Fixed
));

232 
	gR’d”Block
::
ÏyoutBlock
(
»ÏyoutChd»n
);

235 
R’d”Box
* 
	gchdBlock
 = 
šÃrBlockR’d””
 ? iÂ”BlockR’d”” : 
šÃrTextR’d””
;

236 
	gcu¼’tHeight
 = 
chdBlock
->
height
();

237 ià(
	gcu¼’tHeight
 < 
height
())

238 
	gchdBlock
->
£tLoÿtiÚ
(
chdBlock
->
x
(), (
height
(è- 
cu¼’tHeight
) / 2);

241 
boŞ
 
	gR’d”TextCÚŒŞSšgËLše
::
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
& 
»que¡
, 
H™Te¡ResuÉ
& 
»suÉ
, 
xPos
, 
yPos
, 
tx
, 
ty
, 
H™Te¡AùiÚ
 
h™Te¡AùiÚ
)

249 ià(!
	gR’d”TextCÚŒŞ
::
nodeAtPošt
(
»que¡
, 
»suÉ
, 
xPos
, 
yPos
, 
tx
, 
ty
, 
h™Te¡AùiÚ
))

250  
	gçl£
;

255 ià(
	g»suÉ
.
šÃrNode
()->
isDesûndªtOf
(
šÃrTextEËm’t
()è||„esuÉ.šÃrNode(è=ğ
node
())

256 
h™IÂ”TextEËm’t
(
»suÉ
, 
xPos
, 
yPos
, 
tx
, 
ty
);

259 ià(!
	gm_šÃrBlock
 || 
	g»suÉ
.
šÃrNode
(è=ğ
m_»suÉsBu‰Ú
 || 
»suÉ
.šÃrNode(è=ğ
m_ÿnûlBu‰Ú
)

260  
Œue
;

262 
Node
* 
	gšÃrNode
 = 0;

263 
R’d”Box
* 
	gšÃrBlockR’d””
 = 
m_šÃrBlock
->
»nd”Box
();

264 
R’d”Box
* 
	gšÃrTextR’d””
 = 
šÃrTextEËm’t
()->
»nd”Box
();

266 
IÁPošt
 
	gloÿlPošt
 = 
»suÉ
.
loÿlPošt
();

267 
	gloÿlPošt
.
move
(-
šÃrBlockR’d””
->
x
(), -šÃrBlockR’d””->
y
());

269 
	g‹xtLeá
 = 
tx
 + 
x
(è+ 
šÃrBlockR’d””
->x(è+ 
šÃrTextR’d””
->x();

270 ià(
	gm_»suÉsBu‰Ú
 && m_»suÉsBu‰Ú->
»nd””
(è&& 
	gxPos
 < 
	g‹xtLeá
)

271 
	gšÃrNode
 = 
m_»suÉsBu‰Ú
.
g‘
();

273 ià(!
	gšÃrNode
) {

274 
	g‹xtRight
 = 
‹xtLeá
 + 
šÃrTextR’d””
->
width
();

275 ià(
	gm_ÿnûlBu‰Ú
 && m_ÿnûlBu‰Ú->
»nd””
(è&& 
	gxPos
 > 
	g‹xtRight
)

276 
	gšÃrNode
 = 
m_ÿnûlBu‰Ú
.
g‘
();

279 ià(
	gšÃrNode
) {

280 
	g»suÉ
.
£tIÂ”Node
(
šÃrNode
);

281 
	gloÿlPošt
.
move
(-
šÃrNode
->
»nd”Box
()->
x
(), -šÃrNode->»nd”Box()->
y
());

284 
	g»suÉ
.
£tLoÿlPošt
(
loÿlPošt
);

285  
	gŒue
;

288 
	gR’d”TextCÚŒŞSšgËLše
::
fÜw¬dEv’t
(
Ev’t
* 
ev’t
)

290 
R’d”Box
* 
šÃrTextR’d””
 = 
šÃrTextEËm’t
()->
»nd”Box
();

292 ià(
	gev’t
->
ty³
(è=ğ
ev’tNames
().
blurEv’t
) {

293 ià(
šÃrTextR’d””
) {

294 ià(
R’d”Lay”
* 
šÃrLay”
 = 
šÃrTextR’d””
->
Ïy”
())

295 
šÃrLay”
->
süŞlToOff£t
(
¡yË
()->
dœeùiÚ
(è=ğ
RTL
 ? iÂ”Lay”->
süŞlWidth
() : 0, 0);

298 
ÿpsLockS‹MayHaveChªged
();

299 } ià(
	gev’t
->
ty³
(è=ğ
ev’tNames
().
focusEv’t
)

300 
ÿpsLockS‹MayHaveChªged
();

302 ià(!
	gev’t
->
isMou£Ev’t
()) {

303 
	gR’d”TextCÚŒŞ
::
fÜw¬dEv’t
(
ev’t
);

307 
FlßtPošt
 
	gloÿlPošt
 = 
šÃrTextR’d””
->
absŞu‹ToLoÿl
(
¡©ic_ÿ¡
<
Mou£Ev’t
*>(
ev’t
)->
absŞu‹LoÿtiÚ
(), 
çl£
, 
Œue
);

308 ià(
	gm_»suÉsBu‰Ú
 && 
	gloÿlPošt
.
x
(è< 
	gšÃrTextR’d””
->
bÜd”BoxReù
().x())

309 
	gm_»suÉsBu‰Ú
->
deçuÉEv’tHªdËr
(
ev’t
);

310 ià(
	gm_ÿnûlBu‰Ú
 && 
	gloÿlPošt
.
x
(è> 
	gšÃrTextR’d””
->
bÜd”BoxReù
().
right
())

311 
	gm_ÿnûlBu‰Ú
->
deçuÉEv’tHªdËr
(
ev’t
);

313 
	gR’d”TextCÚŒŞ
::
fÜw¬dEv’t
(
ev’t
);

316 
	gR’d”TextCÚŒŞSšgËLše
::
¡yËDidChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
)

318 
	gR’d”TextCÚŒŞ
::
¡yËDidChªge
(
diff
, 
ŞdStyË
);

320 ià(
R’d”Objeù
* 
	gšÃrBlockR’d””
 = 
m_šÃrBlock
 ? m_šÃrBlock->
»nd””
() : 0) {

323 
šÃrBlockR’d””
->
¡yË
()->
£tHeight
(
L’gth
());

324 
	gšÃrBlockR’d””
->
¡yË
()->
£tWidth
(
L’gth
());

325 
	gšÃrBlockR’d””
->
£tStyË
(
ü—‹IÂ”BlockStyË
(
¡yË
()));

328 ià(
R’d”Objeù
* 
	g»suÉsR’d””
 = 
m_»suÉsBu‰Ú
 ? m_»suÉsBu‰Ú->
»nd””
() : 0)

329 
»suÉsR’d””
->
£tStyË
(
ü—‹ResuÉsBu‰ÚStyË
(
¡yË
()));

331 ià(
R’d”Objeù
* 
	gÿnûlR’d””
 = 
m_ÿnûlBu‰Ú
 ? m_ÿnûlBu‰Ú->
»nd””
() : 0)

332 
ÿnûlR’d””
->
£tStyË
(
ü—‹CªûlBu‰ÚStyË
(
¡yË
()));

334 
£tHasOv”æowCl
(
çl£
);

337 
	gR’d”TextCÚŒŞSšgËLše
::
ÿpsLockS‹MayHaveChªged
()

339 ià(!
node
(è|| !
docum’t
())

347 
boŞ
 
	gshouldD¿wC­sLockIndiÿtÜ
 = 
çl£
;

349 ià(
F¿me
* 
	gäame
 = 
docum’t
()->
äame
())

350 
shouldD¿wC­sLockIndiÿtÜ
 = 
šputEËm’t
()->
isPasswÜdF›ld
()

351 && 
äame
->
£ËùiÚ
()->
isFocu£dAndAùive
()

352 && 
docum’t
()->
focu£dNode
(è=ğ
node
()

353 && 
PÏtfÜmKeybßrdEv’t
::
cu¼’tC­sLockS‹
();

355 ià(
	gshouldD¿wC­sLockIndiÿtÜ
 !ğ
m_shouldD¿wC­sLockIndiÿtÜ
) {

356 
m_shouldD¿wC­sLockIndiÿtÜ
 = 
shouldD¿wC­sLockIndiÿtÜ
;

357 
»·št
();

361 
	gR’d”TextCÚŒŞSšgËLše
::
‹xtBlockWidth
() const

363 
width
 = 
R’d”TextCÚŒŞ
::
‹xtBlockWidth
();

365 ià(
R’d”Box
* 
	g»suÉsR’d””
 = 
m_»suÉsBu‰Ú
 ? m_»suÉsBu‰Ú->
»nd”Box
() : 0) {

366 
»suÉsR’d””
->
ÿlcWidth
();

367 
	gwidth
 -ğ
»suÉsR’d””
->
width
(è+„esuÉsR’d””->
m¬gšLeá
(è+„esuÉsR’d””->
m¬gšRight
();

370 ià(
R’d”Box
* 
	gÿnûlR’d””
 = 
m_ÿnûlBu‰Ú
 ? m_ÿnûlBu‰Ú->
»nd”Box
() : 0) {

371 
ÿnûlR’d””
->
ÿlcWidth
();

372 
	gwidth
 -ğ
ÿnûlR’d””
->
width
(è+ cªûlR’d””->
m¬gšLeá
(è+ cªûlR’d””->
m¬gšRight
();

375  
	gwidth
;

378 
	gR’d”TextCÚŒŞSšgËLše
::
g‘AvgCh¬Width
(
AtomicSŒšg
 
çmy
)

384 ià(
çmy
 =ğ
AtomicSŒšg
("Lucida Grande"))

385  
sÿËEmToUn™s
(901);

387  
	gR’d”TextCÚŒŞ
::
g‘AvgCh¬Width
(
çmy
);

390 
	gR’d”TextCÚŒŞSšgËLše
::
´eã¼edCÚ‹ÁWidth
(
ch¬Width
) const

392 
çùÜ
 = 
šputEËm’t
()->
size
();

393 ià(
	gçùÜ
 <= 0)

394 
çùÜ
 = 20;

396 
	g»suÉ
 = 
¡©ic_ÿ¡
<>(
ûf
(
ch¬Width
 * 
çùÜ
));

398 
	gmaxCh¬Width
 = 0.f;

399 
AtomicSŒšg
 
	gçmy
 = 
¡yË
()->
fÚt
().
çmy
().family();

404 ià(
	gçmy
 =ğ
AtomicSŒšg
("Lucida Grande"))

405 
maxCh¬Width
 = 
sÿËEmToUn™s
(4027);

406 ià(
hasV®idAvgCh¬Width
(
çmy
))

407 
	gmaxCh¬Width
 = 
roundf
(
¡yË
()->
fÚt
().
´im¬yFÚt
()->
maxCh¬Width
());

410 ià(
	gmaxCh¬Width
 > 0.f)

411 
	g»suÉ
 +ğ
maxCh¬Width
 - 
ch¬Width
;

413 ià(
R’d”Box
* 
	g»suÉsR’d””
 = 
m_»suÉsBu‰Ú
 ? m_»suÉsBu‰Ú->
»nd”Box
() : 0)

414 
»suÉ
 +ğ
»suÉsR’d””
->
bÜd”Leá
(è+„esuÉsR’d””->
bÜd”Right
() +

415 
»suÉsR’d””
->
·ddšgLeá
(è+„esuÉsR’d””->
·ddšgRight
();

417 ià(
R’d”Box
* 
	gÿnûlR’d””
 = 
m_ÿnûlBu‰Ú
 ? m_ÿnûlBu‰Ú->
»nd”Box
() : 0)

418 
»suÉ
 +ğ
ÿnûlR’d””
->
bÜd”Leá
(è+ cªûlR’d””->
bÜd”Right
() +

419 
ÿnûlR’d””
->
·ddšgLeá
(è+ cªûlR’d””->
·ddšgRight
();

421  
	g»suÉ
;

424 
	gR’d”TextCÚŒŞSšgËLše
::
adju¡CÚŒŞHeightBa£dOnLšeHeight
(
lšeHeight
)

426 ià(
R’d”Box
* 
»suÉsR’d””
 = 
m_»suÉsBu‰Ú
 ? m_»suÉsBu‰Ú->
»nd”Box
() : 0) {

427 
toR’d”Block
(
»suÉsR’d””
)->
ÿlcHeight
();

428 
£tHeight
(
max
(
height
(),

429 
»suÉsR’d””
->
bÜd”Tİ
(è+„esuÉsR’d””->
bÜd”BÙtom
() +

430 
»suÉsR’d””
->
·ddšgTİ
(è+„esuÉsR’d””->
·ddšgBÙtom
() +

431 
»suÉsR’d””
->
m¬gšTİ
(è+„esuÉsR’d””->
m¬gšBÙtom
()));

432 
	glšeHeight
 = 
max
(
lšeHeight
, 
»suÉsR’d””
->
height
());

435 ià(
R’d”Box
* 
	gÿnûlR’d””
 = 
m_ÿnûlBu‰Ú
 ? m_ÿnûlBu‰Ú->
»nd”Box
() : 0) {

436 
toR’d”Block
(
ÿnûlR’d””
)->
ÿlcHeight
();

437 
£tHeight
(
max
(
height
(),

438 
ÿnûlR’d””
->
bÜd”Tİ
(è+ cªûlR’d””->
bÜd”BÙtom
() +

439 
ÿnûlR’d””
->
·ddšgTİ
(è+ cªûlR’d””->
·ddšgBÙtom
() +

440 
ÿnûlR’d””
->
m¬gšTİ
(è+ cªûlR’d””->
m¬gšBÙtom
()));

441 
	glšeHeight
 = 
max
(
lšeHeight
, 
ÿnûlR’d””
->
height
());

444 
£tHeight
(
height
(è+ 
lšeHeight
);

447 
	gR’d”TextCÚŒŞSšgËLše
::
ü—‹SubŒ“IfN“ded
()

449 ià(!
šputEËm’t
()->
isS—rchF›ld
()) {

450 
R’d”TextCÚŒŞ
::
ü—‹SubŒ“IfN“ded
(
m_šÃrBlock
.
g‘
());

454 ià(!
	gm_šÃrBlock
) {

456 
	gm_šÃrBlock
 = 
Ãw
 
TextCÚŒŞIÂ”EËm’t
(
docum’t
(), 
node
());

457 
	gm_šÃrBlock
->
©chIÂ”EËm’t
(
node
(), 
ü—‹IÂ”BlockStyË
(
¡yË
()), 
»nd”A»Ç
());

460 ià(!
	gm_»suÉsBu‰Ú
) {

462 
	gm_»suÉsBu‰Ú
 = 
Ãw
 
S—rchF›ldResuÉsBu‰ÚEËm’t
(
docum’t
());

463 
	gm_»suÉsBu‰Ú
->
©chIÂ”EËm’t
(
m_šÃrBlock
.
g‘
(), 
ü—‹ResuÉsBu‰ÚStyË
(m_šÃrBlock->
»nd””
()->
¡yË
()), 
»nd”A»Ç
());

467 
	gR’d”TextCÚŒŞ
::
ü—‹SubŒ“IfN“ded
(
m_šÃrBlock
.
g‘
());

469 ià(!
	gm_ÿnûlBu‰Ú
) {

471 
	gm_ÿnûlBu‰Ú
 = 
Ãw
 
S—rchF›ldCªûlBu‰ÚEËm’t
(
docum’t
());

472 
	gm_ÿnûlBu‰Ú
->
©chIÂ”EËm’t
(
m_šÃrBlock
.
g‘
(), 
ü—‹CªûlBu‰ÚStyË
(m_šÃrBlock->
»nd””
()->
¡yË
()), 
»nd”A»Ç
());

476 
	gR’d”TextCÚŒŞSšgËLše
::
upd©eFromEËm’t
()

478 
ü—‹SubŒ“IfN“ded
();

479 
	gR’d”TextCÚŒŞ
::
upd©eFromEËm’t
();

481 ià(
	gm_ÿnûlBu‰Ú
)

482 
upd©eCªûlBu‰ÚVisib™y
();

484 ià(
	gm_¶aûhŞd”VisibË
) {

485 
Exû±iÚCode
 
	gec
 = 0;

486 
šÃrTextEËm’t
()->
£tIÂ”Text
(
¡©ic_ÿ¡
<
EËm’t
*>(
node
())->
g‘A‰ribu‹
(
¶aûhŞd”A‰r
), 
ec
);

487 
ASSERT
(!
ec
);

489 ià(!
šputEËm’t
()->
sugge¡edV®ue
().
isNuÎ
())

490 
£tIÂ”TextV®ue
(
šputEËm’t
()->
sugge¡edV®ue
());

492 
£tIÂ”TextV®ue
(
šputEËm’t
()->
v®ue
());

495 ià(
	gm_£¬chPİupIsVisibË
)

496 
	gm_£¬chPİup
->
upd©eFromEËm’t
();

499 
	gR’d”TextCÚŒŞSšgËLše
::
ÿcheS–eùiÚ
(
¡¬t
, 
’d
)

501 
šputEËm’t
()->
ÿcheS–eùiÚ
(
¡¬t
, 
’d
);

504 
	gPassRefPŒ
<
	gR’d”StyË
> 
	gR’d”TextCÚŒŞSšgËLše
::
ü—‹IÂ”TextStyË
(cÚ¡ 
R’d”StyË
* 
¡¬tStyË
) const

506 
RefPŒ
<
R’d”StyË
> 
‹xtBlockStyË
;

507 ià(
	gm_¶aûhŞd”VisibË
) {

508 ià(
R’d”StyË
* 
	gp£udoStyË
 = 
g‘CachedP£udoStyË
(
INPUT_PLACEHOLDER
))

509 
‹xtBlockStyË
 = 
R’d”StyË
::
şÚe
(
p£udoStyË
);

511 ià(!
	g‹xtBlockStyË
) {

512 
	g‹xtBlockStyË
 = 
R’d”StyË
::
ü—‹
();

513 
	g‹xtBlockStyË
->
šh”™From
(
¡¬tStyË
);

516 
adju¡IÂ”TextStyË
(
¡¬tStyË
, 
‹xtBlockStyË
.
g‘
());

518 
	g‹xtBlockStyË
->
£tWh™eS·û
(
PRE
);

519 
	g‹xtBlockStyË
->
£tWÜdW¿p
(
NÜm®WÜdW¿p
);

520 
	g‹xtBlockStyË
->
£tOv”æowX
(
OHIDDEN
);

521 
	g‹xtBlockStyË
->
£tOv”æowY
(
OHIDDEN
);

524 ià(
	g‹xtBlockStyË
->
fÚt
().
lšeS·cšg
(è> 
lšeHeight
(
Œue
,rue))

525 
	g‹xtBlockStyË
->
£tLšeHeight
(
L’gth
(-100.0f, 
P”ûÁ
));

527 
	g‹xtBlockStyË
->
£tDi¥Ïy
(
m_šÃrBlock
 ? 
INLINE_BLOCK
 : 
BLOCK
);

530 
	g‹xtBlockStyË
->
£tPaddšgLeá
(
L’gth
(1, 
Fixed
));

531 
	g‹xtBlockStyË
->
£tPaddšgRight
(
L’gth
(1, 
Fixed
));

537 ià(
	gm_¶aûhŞd”VisibË
)

538 
	g‹xtBlockStyË
->
£tTextSecur™y
(
TSNONE
);

540  
	g‹xtBlockStyË
.
»Ëa£
();

543 
	gPassRefPŒ
<
	gR’d”StyË
> 
	gR’d”TextCÚŒŞSšgËLše
::
ü—‹IÂ”BlockStyË
(cÚ¡ 
R’d”StyË
* 
¡¬tStyË
) const

545 
ASSERT
(
node
()->
isHTMLEËm’t
());

547 
	gRefPŒ
<
	gR’d”StyË
> 
	gšÃrBlockStyË
 = 
R’d”StyË
::
ü—‹
();

548 
	gšÃrBlockStyË
->
šh”™From
(
¡¬tStyË
);

550 
	gšÃrBlockStyË
->
£tDi¥Ïy
(
BLOCK
);

551 
	gšÃrBlockStyË
->
£tDœeùiÚ
(
LTR
);

554 
	gšÃrBlockStyË
->
£tU£rModify
(
READ_ONLY
);

556  
	gšÃrBlockStyË
.
»Ëa£
();

559 
	gPassRefPŒ
<
	gR’d”StyË
> 
	gR’d”TextCÚŒŞSšgËLše
::
ü—‹ResuÉsBu‰ÚStyË
(cÚ¡ 
R’d”StyË
* 
¡¬tStyË
) const

561 
ASSERT
(
node
()->
isHTMLEËm’t
());

562 
HTMLIÅutEËm’t
* 
	gšput
 = 
¡©ic_ÿ¡
<HTMLIÅutEËm’t*>(
node
());

564 
	gRefPŒ
<
	gR’d”StyË
> 
	g»suÉsBlockStyË
;

565 ià(
	gšput
->
maxResuÉs
() < 0)

566 
	g»suÉsBlockStyË
 = 
g‘CachedP£udoStyË
(
SEARCH_DECORATION
);

567 ià(!
	gšput
->
maxResuÉs
())

568 
	g»suÉsBlockStyË
 = 
g‘CachedP£udoStyË
(
SEARCH_RESULTS_DECORATION
);

570 
	g»suÉsBlockStyË
 = 
g‘CachedP£udoStyË
(
SEARCH_RESULTS_BUTTON
);

572 ià(!
	g»suÉsBlockStyË
)

573 
	g»suÉsBlockStyË
 = 
R’d”StyË
::
ü—‹
();

575 ià(
	g¡¬tStyË
)

576 
	g»suÉsBlockStyË
->
šh”™From
(
¡¬tStyË
);

578  
	g»suÉsBlockStyË
.
»Ëa£
();

581 
	gPassRefPŒ
<
	gR’d”StyË
> 
	gR’d”TextCÚŒŞSšgËLše
::
ü—‹CªûlBu‰ÚStyË
(cÚ¡ 
R’d”StyË
* 
¡¬tStyË
) const

583 
ASSERT
(
node
()->
isHTMLEËm’t
());

584 
	gRefPŒ
<
	gR’d”StyË
> 
	gÿnûlBlockStyË
;

586 ià(
	gRefPŒ
<
	gR’d”StyË
> 
	gp£udoStyË
 = 
g‘CachedP£udoStyË
(
SEARCH_CANCEL_BUTTON
))

588 
ÿnûlBlockStyË
 = 
R’d”StyË
::
şÚe
(
p£udoStyË
.
g‘
());

590 
	gÿnûlBlockStyË
 = 
R’d”StyË
::
ü—‹
();

592 ià(
	g¡¬tStyË
)

593 
	gÿnûlBlockStyË
->
šh”™From
(
¡¬tStyË
);

595 
	gÿnûlBlockStyË
->
£tVisib™y
(
visib™yFÜCªûlBu‰Ú
());

596  
	gÿnûlBlockStyË
.
»Ëa£
();

599 
	gR’d”TextCÚŒŞSšgËLše
::
upd©eCªûlBu‰ÚVisib™y
() const

601 ià(!
m_ÿnûlBu‰Ú
->
»nd””
())

604 cÚ¡ 
R’d”StyË
* 
	gcurStyË
 = 
m_ÿnûlBu‰Ú
->
»nd””
()->
¡yË
();

605 
EVisib™y
 
	gbu‰ÚVisib™y
 = 
visib™yFÜCªûlBu‰Ú
();

606 ià(
	gcurStyË
->
visib™y
(è=ğ
bu‰ÚVisib™y
)

609 
	gRefPŒ
<
	gR’d”StyË
> 
	gÿnûlBu‰ÚStyË
 = 
R’d”StyË
::
şÚe
(
curStyË
);

610 
	gÿnûlBu‰ÚStyË
->
£tVisib™y
(
bu‰ÚVisib™y
);

611 
	gm_ÿnûlBu‰Ú
->
»nd””
()->
£tStyË
(
ÿnûlBu‰ÚStyË
);

614 
EVisib™y
 
	gR’d”TextCÚŒŞSšgËLše
::
visib™yFÜCªûlBu‰Ú
() const

616 
ASSERT
(
node
()->
isHTMLEËm’t
());

617 
HTMLIÅutEËm’t
* 
	gšput
 = 
¡©ic_ÿ¡
<HTMLIÅutEËm’t*>(
node
());

618  
	gšput
->
v®ue
().
isEm±y
(è? 
	gHIDDEN
 : 
VISIBLE
;

621 cÚ¡ 
	gAtomicSŒšg
& 
	gR’d”TextCÚŒŞSšgËLše
::
auto§veName
() const

623  
¡©ic_ÿ¡
<
EËm’t
*>(
node
())->
g‘A‰ribu‹
(
auto§veA‰r
);

626 
	gR’d”TextCÚŒŞSšgËLše
::
¡¬tS—rchEv’tTim”
()

628 
ASSERT
(
node
()->
isHTMLEËm’t
());

629 
	gËngth
 = 
‹xt
().
Ëngth
();

632 ià(!
	gËngth
) {

633 
¡İS—rchEv’tTim”
();

634 
	g¡©ic_ÿ¡
<
	gHTMLIÅutEËm’t
*>(
node
())->
ÚS—rch
();

640 
	gm_£¬chEv’tTim”
.
¡¬tOÃShÙ
(
max
(0.2, 0.6 - 0.1 * 
Ëngth
));

643 
	gR’d”TextCÚŒŞSšgËLše
::
£¬chEv’tTim”Fœed
(
Tim”
<
R’d”TextCÚŒŞSšgËLše
>*)

645 
ASSERT
(
node
()->
isHTMLEËm’t
());

646 
	g¡©ic_ÿ¡
<
	gHTMLIÅutEËm’t
*>(
node
())->
ÚS—rch
();

650 
	gR’d”TextCÚŒŞSšgËLše
::
v®ueChªged
(
li¡Index
, 
boŞ
 
fœeEv’ts
)

652 
ASSERT
(
node
()->
isHTMLEËm’t
());

653 
ASSERT
(
¡©ic_ÿ¡
<>(
li¡Index
è< 
li¡Size
());

654 
HTMLIÅutEËm’t
* 
	gšput
 = 
¡©ic_ÿ¡
<HTMLIÅutEËm’t*>(
node
());

655 ià(
	g¡©ic_ÿ¡
<>(
	gli¡Index
è=ğ(
li¡Size
() - 1)) {

656 ià(
fœeEv’ts
) {

657 
m_»ûÁS—rches
.
ş—r
();

658 cÚ¡ 
	gAtomicSŒšg
& 
	gÇme
 = 
auto§veName
();

659 ià(!
	gÇme
.
isEm±y
()) {

660 ià(!
	gm_£¬chPİup
)

661 
	gm_£¬chPİup
 = 
S—rchPİupM’u
::
ü—‹
(
this
);

662 
	gm_£¬chPİup
->
§veReûÁS—rches
(
Çme
, 
m_»ûÁS—rches
);

666 
	gšput
->
£tV®ue
(
™emText
(
li¡Index
));

667 ià(
	gfœeEv’ts
)

668 
	gšput
->
ÚS—rch
();

669 
	gšput
->
£Ëù
();

673 
SŒšg
 
	gR’d”TextCÚŒŞSšgËLše
::
™emText
(
li¡Index
) const

675 
size
 = 
li¡Size
();

676 ià(
	gsize
 == 1) {

677 
ASSERT
(!
li¡Index
);

678  
£¬chM’uNoReûÁS—rchesText
();

680 ià(!
	gli¡Index
)

681  
£¬chM’uReûÁS—rchesText
();

682 ià(
™emIsS•¬©Ü
(
li¡Index
))

683  
SŒšg
();

684 ià(
	g¡©ic_ÿ¡
<>(
	gli¡Index
è=ğ(
size
 - 1))

685  
£¬chM’uCË¬ReûÁS—rchesText
();

686  
	gm_»ûÁS—rches
[
li¡Index
 - 1];

689 
boŞ
 
	gR’d”TextCÚŒŞSšgËLše
::
™emIsEÇbËd
(
li¡Index
) const

691 ià(!
li¡Index
 || 
™emIsS•¬©Ü
(listIndex))

692  
çl£
;

693  
	gŒue
;

696 
PİupM’uStyË
 
	gR’d”TextCÚŒŞSšgËLše
::
™emStyË
() const

698  
m’uStyË
();

701 
PİupM’uStyË
 
	gR’d”TextCÚŒŞSšgËLše
::
m’uStyË
() const

703  
PİupM’uStyË
(
¡yË
()->
cŞÜ
(), styË()->
backgroundCŞÜ
(), styË()->
fÚt
(), styË()->
visib™y
(è=ğ
VISIBLE
, styË()->
‹xtInd’t
(), styË()->
dœeùiÚ
());

706 
	gR’d”TextCÚŒŞSšgËLše
::
ş›ÁIn£tLeá
() const

710  
height
() / 2;

713 
	gR’d”TextCÚŒŞSšgËLše
::
ş›ÁIn£tRight
() const

718  
height
() / 2;

721 
	gR’d”TextCÚŒŞSšgËLše
::
ş›ÁPaddšgLeá
() const

723 
·ddšg
 = 
·ddšgLeá
();

725 ià(
R’d”Box
* 
	g»suÉsR’d””
 = 
m_»suÉsBu‰Ú
 ? m_»suÉsBu‰Ú->
»nd”Box
() : 0)

726 
·ddšg
 +ğ
»suÉsR’d””
->
width
();

728  
	g·ddšg
;

731 
	gR’d”TextCÚŒŞSšgËLše
::
ş›ÁPaddšgRight
() const

733 
·ddšg
 = 
·ddšgRight
();

735 ià(
R’d”Box
* 
	gÿnûlR’d””
 = 
m_ÿnûlBu‰Ú
 ? m_ÿnûlBu‰Ú->
»nd”Box
() : 0)

736 
·ddšg
 +ğ
ÿnûlR’d””
->
width
();

738  
	g·ddšg
;

741 
	gR’d”TextCÚŒŞSšgËLše
::
li¡Size
() const

744 ià(!
m_»ûÁS—rches
.
size
())

747  
	gm_»ûÁS—rches
.
size
() + 3;

750 
	gR’d”TextCÚŒŞSšgËLše
::
£ËùedIndex
() const

755 
	gR’d”TextCÚŒŞSšgËLše
::
pİupDidHide
()

757 
m_£¬chPİupIsVisibË
 = 
çl£
;

760 
boŞ
 
	gR’d”TextCÚŒŞSšgËLše
::
™emIsS•¬©Ü
(
li¡Index
) const

763  
¡©ic_ÿ¡
<>(
li¡Index
è=ğ(
li¡Size
() - 2);

766 
boŞ
 
	gR’d”TextCÚŒŞSšgËLše
::
™emIsLab–
(
li¡Index
) const

768  
li¡Index
 == 0;

771 
boŞ
 
	gR’d”TextCÚŒŞSšgËLše
::
™emIsS–eùed
() const

773  
çl£
;

776 
	gR’d”TextCÚŒŞSšgËLše
::
£tTextFromI‹m
(
li¡Index
)

778 
ASSERT
(
node
()->
isHTMLEËm’t
());

779 
	g¡©ic_ÿ¡
<
	gHTMLIÅutEËm’t
*>(
node
())->
£tV®ue
(
™emText
(
li¡Index
));

782 
FÚtS–eùÜ
* 
	gR’d”TextCÚŒŞSšgËLše
::
fÚtS–eùÜ
() const

784  
docum’t
()->
¡yËS–eùÜ
()->
fÚtS–eùÜ
();

787 
Ho¡Wšdow
* 
	gR’d”TextCÚŒŞSšgËLše
::
ho¡Wšdow
() const

789  
docum’t
()->
v›w
()->
ho¡Wšdow
();

792 
	gR’d”TextCÚŒŞSšgËLše
::
autosüŞl
()

794 
R’d”Lay”
* 
Ïy”
 = 
šÃrTextEËm’t
()->
»nd”Box
()->layer();

795 ià(
	gÏy”
)

796 
	gÏy”
->
autosüŞl
();

799 
	gR’d”TextCÚŒŞSšgËLše
::
süŞlWidth
() const

801 ià(
šÃrTextEËm’t
())

802  
šÃrTextEËm’t
()->
süŞlWidth
();

803  
	gR’d”Block
::
süŞlWidth
();

806 
	gR’d”TextCÚŒŞSšgËLše
::
süŞlHeight
() const

808 ià(
šÃrTextEËm’t
())

809  
šÃrTextEËm’t
()->
süŞlHeight
();

810  
	gR’d”Block
::
süŞlHeight
();

813 
	gR’d”TextCÚŒŞSšgËLše
::
süŞlLeá
() const

815 ià(
šÃrTextEËm’t
())

816  
šÃrTextEËm’t
()->
süŞlLeá
();

817  
	gR’d”Block
::
süŞlLeá
();

820 
	gR’d”TextCÚŒŞSšgËLše
::
süŞlTİ
() const

822 ià(
šÃrTextEËm’t
())

823  
šÃrTextEËm’t
()->
süŞlTİ
();

824  
	gR’d”Block
::
süŞlTİ
();

827 
	gR’d”TextCÚŒŞSšgËLše
::
£tSüŞlLeá
(
ÃwLeá
)

829 ià(
šÃrTextEËm’t
())

830 
šÃrTextEËm’t
()->
£tSüŞlLeá
(
ÃwLeá
);

833 
	gR’d”TextCÚŒŞSšgËLše
::
£tSüŞlTİ
(
ÃwTİ
)

835 ià(
šÃrTextEËm’t
())

836 
šÃrTextEËm’t
()->
£tSüŞlTİ
(
ÃwTİ
);

839 
boŞ
 
	gR’d”TextCÚŒŞSšgËLše
::
süŞl
(
SüŞlDœeùiÚ
 
dœeùiÚ
, 
SüŞlG¿nuÏr™y
 
g¿nuÏr™y
, 
muÉl›r
, 
Node
** 
¡İNode
)

841 
R’d”Lay”
* 
	gÏy”
 = 
šÃrTextEËm’t
()->
»nd”Box
()->
Ïy”
();

842 ià(
	gÏy”
 &&†ay”->
süŞl
(
dœeùiÚ
, 
g¿nuÏr™y
, 
muÉl›r
))

843  
	gŒue
;

844  
	gR’d”Block
::
süŞl
(
dœeùiÚ
, 
g¿nuÏr™y
, 
muÉl›r
, 
¡İNode
);

847 
	gPassRefPŒ
<
	gSüŞlb¬
> 
	gR’d”TextCÚŒŞSšgËLše
::
ü—‹SüŞlb¬
(
SüŞlb¬Cl›Á
* 
ş›Á
, 
SüŞlb¬Or›Á©iÚ
 
Ü›Á©iÚ
, 
SüŞlb¬CÚŒŞSize
 
cÚŒŞSize
)

849 
	gRefPŒ
<
	gSüŞlb¬
> 
	gwidg‘
;

850 
boŞ
 
	ghasCu¡omSüŞlb¬StyË
 = 
¡yË
()->
hasP£udoStyË
(
SCROLLBAR
);

851 ià(
	ghasCu¡omSüŞlb¬StyË
)

852 
	gwidg‘
 = 
R’d”SüŞlb¬
::
ü—‹Cu¡omSüŞlb¬
(
ş›Á
, 
Ü›Á©iÚ
, 
this
);

854 
	gwidg‘
 = 
SüŞlb¬
::
ü—‹N©iveSüŞlb¬
(
ş›Á
, 
Ü›Á©iÚ
, 
cÚŒŞSize
);

855  
	gwidg‘
.
»Ëa£
();

858 
IÅutEËm’t
* 
	gR’d”TextCÚŒŞSšgËLše
::
šputEËm’t
() const

860  
toIÅutEËm’t
(
¡©ic_ÿ¡
<
EËm’t
*>(
node
()));

	@RenderTextControlSingleLine.h

22 #iâdeà
R’d”TextCÚŒŞSšgËLše_h


23 
	#R’d”TextCÚŒŞSšgËLše_h


	)

25 
	~"PİupM’uCl›Á.h
"

26 
	~"R’d”TextCÚŒŞ.h
"

27 
	~"Tim”.h
"

29 
Çme¥aû
 
	gWebCÜe
 {

31 
şass
 
	gIÅutEËm’t
;

32 
şass
 
	gS—rchF›ldCªûlBu‰ÚEËm’t
;

33 
şass
 
	gS—rchF›ldResuÉsBu‰ÚEËm’t
;

34 
şass
 
	gS—rchPİupM’u
;

35 
şass
 
	gTextCÚŒŞIÂ”EËm’t
;

37 
şass
 
	gR’d”TextCÚŒŞSšgËLše
 : 
public
 
R’d”TextCÚŒŞ
, 
´iv©e
 
	gPİupM’uCl›Á
 {

38 
	gpublic
:

39 
R’d”TextCÚŒŞSšgËLše
(
Node
*, 
boŞ
);

40 
	gvœtu®
 ~
R’d”TextCÚŒŞSšgËLše
();

42 
boŞ
 
¶aûhŞd”IsVisibË
(ècÚ¡ {  
	gm_¶aûhŞd”VisibË
; }

43 
boŞ
 
¶aûhŞd”ShouldBeVisibË
() const;

45 
addS—rchResuÉ
();

46 
¡İS—rchEv’tTim”
();

48 
boŞ
 
pİupIsVisibË
(ècÚ¡ {  
	gm_£¬chPİupIsVisibË
; }

49 
showPİup
();

50 
hidePİup
();

52 
fÜw¬dEv’t
(
Ev’t
*);

54 
ÿpsLockS‹MayHaveChªged
();

56 
	g´iv©e
:

57 
vœtu®
 
boŞ
 
hasCÚŒŞCl
(ècÚ¡ {  
m_ÿnûlBu‰Ú
; }

58 
vœtu®
 
boŞ
 
isTextF›ld
(ècÚ¡ {  
	gŒue
; }

60 
vœtu®
 
subŒ“HasChªged
();

61 
vœtu®
 
·št
(
PaštInfo
&, 
tx
, 
ty
);

62 
vœtu®
 
Ïyout
();

64 
vœtu®
 
boŞ
 
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, 
x
, 
y
, 
tx
, 
ty
, 
H™Te¡AùiÚ
);

66 
vœtu®
 
autosüŞl
();

69 
vœtu®
 
süŞlLeá
() const;

70 
vœtu®
 
süŞlTİ
() const;

71 
vœtu®
 
süŞlWidth
() const;

72 
vœtu®
 
süŞlHeight
() const;

73 
vœtu®
 
£tSüŞlLeá
();

74 
vœtu®
 
£tSüŞlTİ
();

75 
vœtu®
 
boŞ
 
süŞl
(
SüŞlDœeùiÚ
, 
SüŞlG¿nuÏr™y
, 
muÉl›r
 = 1.0f, 
Node
** 
¡İNode
 = 0);

77 
‹xtBlockWidth
() const;

78 
vœtu®
 
g‘AvgCh¬Width
(
AtomicSŒšg
 
çmy
);

79 
vœtu®
 
´eã¼edCÚ‹ÁWidth
(
ch¬Width
) const;

80 
vœtu®
 
adju¡CÚŒŞHeightBa£dOnLšeHeight
(
lšeHeight
);

82 
ü—‹SubŒ“IfN“ded
();

83 
vœtu®
 
upd©eFromEËm’t
();

84 
vœtu®
 
ÿcheS–eùiÚ
(
¡¬t
, 
’d
);

85 
vœtu®
 
¡yËDidChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
);

87 
vœtu®
 
R’d”StyË
* 
‹xtBa£StyË
() const;

88 
vœtu®
 
	gPassRefPŒ
<
	gR’d”StyË
> 
ü—‹IÂ”TextStyË
(cÚ¡ 
R’d”StyË
* 
¡¬tStyË
) const;

89 
	gPassRefPŒ
<
	gR’d”StyË
> 
ü—‹IÂ”BlockStyË
(cÚ¡ 
R’d”StyË
* 
¡¬tStyË
) const;

90 
	gPassRefPŒ
<
	gR’d”StyË
> 
ü—‹ResuÉsBu‰ÚStyË
(cÚ¡ 
R’d”StyË
* 
¡¬tStyË
) const;

91 
	gPassRefPŒ
<
	gR’d”StyË
> 
ü—‹CªûlBu‰ÚStyË
(cÚ¡ 
R’d”StyË
* 
¡¬tStyË
) const;

93 
upd©eCªûlBu‰ÚVisib™y
() const;

94 
EVisib™y
 
visib™yFÜCªûlBu‰Ú
() const;

95 cÚ¡ 
	gAtomicSŒšg
& 
auto§veName
() const;

97 
¡¬tS—rchEv’tTim”
();

98 
£¬chEv’tTim”Fœed
(
Tim”
<
R’d”TextCÚŒŞSšgËLše
>*);

101 
vœtu®
 
v®ueChªged
(
li¡Index
, 
boŞ
 
fœeEv’ts
 = 
Œue
);

102 
vœtu®
 
SŒšg
 
™emText
(
li¡Index
) const;

103 
vœtu®
 
SŒšg
 
™emToŞT
() const {  String(); }

104 
vœtu®
 
SŒšg
 
™emAcûssib™yText
() const {  String(); }

105 
vœtu®
 
boŞ
 
™emIsEÇbËd
(
li¡Index
) const;

106 
vœtu®
 
PİupM’uStyË
 
™emStyË
(
li¡Index
) const;

107 
vœtu®
 
PİupM’uStyË
 
m’uStyË
() const;

108 
vœtu®
 
ş›ÁIn£tLeá
() const;

109 
vœtu®
 
ş›ÁIn£tRight
() const;

110 
vœtu®
 
ş›ÁPaddšgLeá
() const;

111 
vœtu®
 
ş›ÁPaddšgRight
() const;

112 
vœtu®
 
li¡Size
() const;

113 
vœtu®
 
£ËùedIndex
() const;

114 
vœtu®
 
pİupDidHide
();

115 
vœtu®
 
boŞ
 
™emIsS•¬©Ü
(
li¡Index
) const;

116 
vœtu®
 
boŞ
 
™emIsLab–
(
li¡Index
) const;

117 
vœtu®
 
boŞ
 
™emIsS–eùed
(
li¡Index
) const;

118 
vœtu®
 
boŞ
 
shouldPİOv”
(ècÚ¡ {  
	gçl£
; }

119 
vœtu®
 
boŞ
 
v®ueShouldChªgeOnHÙT¿ck
(ècÚ¡ {  
	gçl£
; }

120 
vœtu®
 
£tTextFromI‹m
(
li¡Index
);

121 
vœtu®
 
FÚtS–eùÜ
* 
fÚtS–eùÜ
() const;

122 
vœtu®
 
Ho¡Wšdow
* 
ho¡Wšdow
() const;

123 
vœtu®
 
	gPassRefPŒ
<
	gSüŞlb¬
> 
ü—‹SüŞlb¬
(
SüŞlb¬Cl›Á
*, 
SüŞlb¬Or›Á©iÚ
, 
SüŞlb¬CÚŒŞSize
);

125 
IÅutEËm’t
* 
šputEËm’t
() const;

127 
boŞ
 
	gm_£¬chPİupIsVisibË
;

128 
boŞ
 
	gm_shouldD¿wC­sLockIndiÿtÜ
;

130 
	gRefPŒ
<
	gTextCÚŒŞIÂ”EËm’t
> 
	gm_šÃrBlock
;

131 
	gRefPŒ
<
	gS—rchF›ldResuÉsBu‰ÚEËm’t
> 
	gm_»suÉsBu‰Ú
;

132 
	gRefPŒ
<
	gS—rchF›ldCªûlBu‰ÚEËm’t
> 
	gm_ÿnûlBu‰Ú
;

134 
	gTim”
<
	gR’d”TextCÚŒŞSšgËLše
> 
	gm_£¬chEv’tTim”
;

135 
	gRefPŒ
<
	gS—rchPİupM’u
> 
	gm_£¬chPİup
;

136 
	gVeùÜ
<
	gSŒšg
> 
	gm_»ûÁS—rches
;

139 
šlše
 
R’d”TextCÚŒŞSšgËLše
* 
toR’d”TextCÚŒŞSšgËLše
(
R’d”Objeù
* 
objeù
)

141 
ASSERT
(!
objeù
 || objeù->
isTextF›ld
());

142  
	g¡©ic_ÿ¡
<
	gR’d”TextCÚŒŞSšgËLše
*>(
	gobjeù
);

146 
toR’d”TextCÚŒŞSšgËLše
(cÚ¡ 
R’d”TextCÚŒŞSšgËLše
*);

	@RenderTextFragment.cpp

23 
	~"cÚfig.h
"

24 
	~"R’d”TextF¿gm’t.h
"

26 
	~"Text.h
"

28 
Çme¥aû
 
	gWebCÜe
 {

30 
	gR’d”TextF¿gm’t
::
R’d”TextF¿gm’t
(
Node
* 
node
, 
SŒšgIm¶
* 
¡r
, 
¡¬tOff£t
, 
Ëngth
)

31 : 
R’d”Text
(
node
, 
¡r
 ? sŒ->
sub¡ršg
(
¡¬tOff£t
, 
Ëngth
) : 0)

32 , 
m_¡¬t
(
¡¬tOff£t
)

33 , 
m_’d
(
Ëngth
)

34 , 
m_fœ¡L‘‹r
(0)

38 
	gR’d”TextF¿gm’t
::
R’d”TextF¿gm’t
(
Node
* 
node
, 
SŒšgIm¶
* 
¡r
)

39 : 
R’d”Text
(
node
, 
¡r
)

40 , 
m_¡¬t
(0)

41 , 
m_’d
(
¡r
 ? sŒ->
Ëngth
() : 0)

42 , 
m_cÚ‹ÁSŒšg
(
¡r
)

43 , 
m_fœ¡L‘‹r
(0)

47 
	gPassRefPŒ
<
	gSŒšgIm¶
> 
	gR’d”TextF¿gm’t
::
Üigš®Text
() const

49 
Node
* 
e
 = 
node
();

50 
	gRefPŒ
<
	gSŒšgIm¶
> 
	g»suÉ
 = (
e
 ? 
¡©ic_ÿ¡
<
Text
*>Ó)->
d©aIm¶
(è: 
cÚ‹ÁSŒšg
());

51 ià(
	g»suÉ
 && (
¡¬t
(è> 0 || s¹(è<„esuÉ->
Ëngth
()))

52 
	g»suÉ
 = 
»suÉ
->
sub¡ršg
(
¡¬t
(), 
’d
());

53  
	g»suÉ
.
»Ëa£
();

56 
	gR’d”TextF¿gm’t
::
de¡roy
()

58 ià(
m_fœ¡L‘‹r
)

59 
m_fœ¡L‘‹r
->
de¡roy
();

60 
	gR’d”Text
::
de¡roy
();

63 
	gR’d”TextF¿gm’t
::
£tTextIÁ”Çl
(
PassRefPŒ
<
SŒšgIm¶
> 
‹xt
)

65 
R’d”Text
::
£tTextIÁ”Çl
(
‹xt
);

66 ià(
	gm_fœ¡L‘‹r
) {

67 
ASSERT
(!
m_cÚ‹ÁSŒšg
);

68 
	gm_fœ¡L‘‹r
->
de¡roy
();

69 
	gm_fœ¡L‘‹r
 = 0;

70 
	gm_¡¬t
 = 0;

71 
	gm_’d
 = 
‹xtL’gth
();

72 ià(
Node
* 
	gt
 = 
node
()) {

73 
ASSERT
(!
t
->
»nd””
());

74 
	gt
->
£tR’d””
(
this
);

79 
UCh¬
 
	gR’d”TextF¿gm’t
::
´eviousCh¬aù”
()

81 ià(
¡¬t
()) {

82 
Node
* 
e
 = 
node
();

83 
SŒšgIm¶
* 
	gÜigš®
 = (
e
 ? 
¡©ic_ÿ¡
<
Text
*>Ó)->
d©aIm¶
(è: 
cÚ‹ÁSŒšg
());

84 ià(
	gÜigš®
)

85  (*
	gÜigš®
)[
¡¬t
() - 1];

88  
	gR’d”Text
::
´eviousCh¬aù”
();

	@RenderTextFragment.h

23 #iâdeà
R’d”TextF¿gm’t_h


24 
	#R’d”TextF¿gm’t_h


	)

26 
	~"R’d”Text.h
"

28 
Çme¥aû
 
	gWebCÜe
 {

34 şas 
	cR’d”TextF¿gm’t
 : 
public
 
R’d”Text
 {

35 
public
:

36 
R’d”TextF¿gm’t
(
Node
*, 
SŒšgIm¶
*, 
¡¬tOff£t
, 
Ëngth
);

37 
R’d”TextF¿gm’t
(
Node
*, 
SŒšgIm¶
*);

39 
vœtu®
 
boŞ
 
isTextF¿gm’t
(ècÚ¡ {  
	gŒue
; }

41 
vœtu®
 
de¡roy
();

43 
¡¬t
(ècÚ¡ {  
	gm_¡¬t
; }

44 
’d
(ècÚ¡ {  
	gm_’d
; }

46 
R’d”Objeù
* 
fœ¡L‘‹r
(ècÚ¡ {  
	gm_fœ¡L‘‹r
; }

47 
£tFœ¡L‘‹r
(
R’d”Objeù
* 
fœ¡L‘‹r
è{ 
	gm_fœ¡L‘‹r
 = firstLetter; }

49 
SŒšgIm¶
* 
cÚ‹ÁSŒšg
(ècÚ¡ {  
	gm_cÚ‹ÁSŒšg
.
g‘
(); }

50 
vœtu®
 
	gPassRefPŒ
<
	gSŒšgIm¶
> 
Üigš®Text
() const;

52 
	g´iv©e
:

53 
vœtu®
 
£tTextIÁ”Çl
(
PassRefPŒ
<
SŒšgIm¶
>);

54 
vœtu®
 
UCh¬
 
´eviousCh¬aù”
();

56 
	gm_¡¬t
;

57 
	gm_’d
;

58 
	gRefPŒ
<
	gSŒšgIm¶
> 
	gm_cÚ‹ÁSŒšg
;

59 
R’d”Objeù
* 
	gm_fœ¡L‘‹r
;

	@RenderTheme.cpp

22 
	~"cÚfig.h
"

23 
	~"R’d”Theme.h
"

25 
	~"CSSV®ueKeywÜds.h
"

26 
	~"Docum’t.h
"

27 
	~"FocusCÚŒŞËr.h
"

28 
	~"FÚtS–eùÜ.h
"

29 
	~"F¿me.h
"

30 
	~"G¿phicsCÚ‹xt.h
"

31 
	~"HTMLIÅutEËm’t.h
"

32 
	~"HTMLNames.h
"

33 
	~"MedŸCÚŒŞEËm’ts.h
"

34 
	~"Page.h
"

35 
	~"R’d”StyË.h
"

36 
	~"R’d”V›w.h
"

37 
	~"S–eùiÚCÚŒŞËr.h
"

38 
	~"S‘tšgs.h
"

42 
Çme¥aû
 
	gWebCÜe
 {

44 
usšg
 
Çme¥aû
 
	gHTMLNames
;

46 
	gCŞÜ
& 
cu¡omFocusRšgCŞÜ
()

48 
DEFINE_STATIC_LOCAL
(
CŞÜ
, 
cŞÜ
, ());

49  
	gcŞÜ
;

52 
	gR’d”Theme
::
R’d”Theme
()

53 #ià
USE
(
NEW_THEME
)

54 : 
m_theme
(
¶©fÜmTheme
())

59 
R’d”Theme
::
adju¡StyË
(
CSSStyËS–eùÜ
* 
£ËùÜ
, 
R’d”StyË
* 
¡yË
, 
EËm’t
* 
e
,

60 
boŞ
 
UAHasAµ—¿nû
, cÚ¡ 
BÜd”D©a
& 
bÜd”
, cÚ¡ 
FlLay”
& 
background
, cÚ¡ 
CŞÜ
& 
backgroundCŞÜ
)

63 
CÚŒŞP¬t
 
	g·¹
 = 
¡yË
->
­³¬ªû
();

64 ià(
	g¡yË
->
di¥Ïy
(è=ğ
INLINE
 || 
¡yË
->di¥Ïy(è=ğ
INLINE_TABLE
 || styË->di¥Ïy(è=ğ
TABLE_ROW_GROUP
 ||

65 
¡yË
->
di¥Ïy
(è=ğ
TABLE_HEADER_GROUP
 || styË->di¥Ïy(è=ğ
TABLE_FOOTER_GROUP
 ||

66 
¡yË
->
di¥Ïy
(è=ğ
TABLE_ROW
 || styË->di¥Ïy(è=ğ
TABLE_COLUMN_GROUP
 || styË->di¥Ïy(è=ğ
TABLE_COLUMN
 ||

67 
¡yË
->
di¥Ïy
(è=ğ
TABLE_CELL
 || styË->di¥Ïy(è=ğ
TABLE_CAPTION
)

68 
¡yË
->
£tDi¥Ïy
(
INLINE_BLOCK
);

69 ià(
	g¡yË
->
di¥Ïy
(è=ğ
COMPACT
 || 
¡yË
->di¥Ïy(è=ğ
RUN_IN
 || styË->di¥Ïy(è=ğ
LIST_ITEM
 || styË->di¥Ïy(è=ğ
TABLE
)

70 
¡yË
->
£tDi¥Ïy
(
BLOCK
);

72 ià(
	gUAHasAµ—¿nû
 && 
isCÚŒŞStyËd
(
¡yË
, 
bÜd”
, 
background
, 
backgroundCŞÜ
)) {

73 ià(
	g·¹
 =ğ
M’uli¡P¬t
) {

74 
¡yË
->
£tAµ—¿nû
(
M’uli¡Bu‰ÚP¬t
);

75 
	g·¹
 = 
M’uli¡Bu‰ÚP¬t
;

77 
	g¡yË
->
£tAµ—¿nû
(
NoCÚŒŞP¬t
);

80 ià(!
	g¡yË
->
hasAµ—¿nû
())

84 
	g¡yË
->
£tBoxShadow
(0);

86 #ià
USE
(
NEW_THEME
)

87 
	g·¹
) {

88 
	gLi¡Bu‰ÚP¬t
:

89 
CheckboxP¬t
:

90 
IÂ”SpšBu‰ÚP¬t
:

91 
Ou‹rSpšBu‰ÚP¬t
:

92 
RadioP¬t
:

93 
PushBu‰ÚP¬t
:

94 
Squ¬eBu‰ÚP¬t
:

95 
DeçuÉBu‰ÚP¬t
:

96 
Bu‰ÚP¬t
: {

98 
L’gthBox
 
bÜd”Box
(
¡yË
->
bÜd”TİWidth
(), styË->
bÜd”RightWidth
(), styË->
bÜd”BÙtomWidth
(), styË->
bÜd”LeáWidth
());

99 
	gbÜd”Box
 = 
m_theme
->
cÚŒŞBÜd”
(
·¹
, 
¡yË
->
fÚt
(), 
bÜd”Box
, styË->
efãùiveZoom
());

100 ià(
	gbÜd”Box
.
tİ
().
v®ue
(è!ğ
¡yË
->
bÜd”TİWidth
()) {

101 ià(
bÜd”Box
.
tİ
().
v®ue
())

102 
¡yË
->
£tBÜd”TİWidth
(
bÜd”Box
.
tİ
().
v®ue
());

104 
	g¡yË
->
»£tBÜd”Tİ
();

106 ià(
	gbÜd”Box
.
right
().
v®ue
(è!ğ
¡yË
->
bÜd”RightWidth
()) {

107 ià(
bÜd”Box
.
right
().
v®ue
())

108 
¡yË
->
£tBÜd”RightWidth
(
bÜd”Box
.
right
().
v®ue
());

110 
	g¡yË
->
»£tBÜd”Right
();

112 ià(
	gbÜd”Box
.
bÙtom
().
v®ue
(è!ğ
¡yË
->
bÜd”BÙtomWidth
()) {

113 
¡yË
->
£tBÜd”BÙtomWidth
(
bÜd”Box
.
bÙtom
().
v®ue
());

114 ià(
	gbÜd”Box
.
bÙtom
().
v®ue
())

115 
	g¡yË
->
£tBÜd”BÙtomWidth
(
bÜd”Box
.
bÙtom
().
v®ue
());

117 
	g¡yË
->
»£tBÜd”BÙtom
();

119 ià(
	gbÜd”Box
.
Ëá
().
v®ue
(è!ğ
¡yË
->
bÜd”LeáWidth
()) {

120 
¡yË
->
£tBÜd”LeáWidth
(
bÜd”Box
.
Ëá
().
v®ue
());

121 ià(
	gbÜd”Box
.
Ëá
().
v®ue
())

122 
	g¡yË
->
£tBÜd”LeáWidth
(
bÜd”Box
.
Ëá
().
v®ue
());

124 
	g¡yË
->
»£tBÜd”Leá
();

128 
L’gthBox
 
	g·ddšgBox
 = 
m_theme
->
cÚŒŞPaddšg
(
·¹
, 
¡yË
->
fÚt
(), styË->
·ddšgBox
(), styË->
efãùiveZoom
());

129 ià(
	g·ddšgBox
 !ğ
¡yË
->
·ddšgBox
())

130 
¡yË
->
£tPaddšgBox
(
·ddšgBox
);

133 ià(
	gm_theme
->
cÚŒŞRequœesP»Wh™eS·û
(
·¹
))

134 
	g¡yË
->
£tWh™eS·û
(
PRE
);

139 
L’gthSize
 
	gcÚŒŞSize
 = 
m_theme
->
cÚŒŞSize
(
·¹
, 
¡yË
->
fÚt
(), L’gthSize(¡yË->
width
(), styË->
height
()), styË->
efãùiveZoom
());

140 ià(
	gcÚŒŞSize
.
width
(è!ğ
¡yË
->width())

141 
¡yË
->
£tWidth
(
cÚŒŞSize
.
width
());

142 ià(
	gcÚŒŞSize
.
height
(è!ğ
¡yË
->height())

143 
¡yË
->
£tHeight
(
cÚŒŞSize
.
height
());

146 
L’gthSize
 
	gmšCÚŒŞSize
 = 
m_theme
->
mšimumCÚŒŞSize
(
·¹
, 
¡yË
->
fÚt
(), styË->
efãùiveZoom
());

147 ià(
	gmšCÚŒŞSize
.
width
(è!ğ
¡yË
->
mšWidth
())

148 
¡yË
->
£tMšWidth
(
mšCÚŒŞSize
.
width
());

149 ià(
	gmšCÚŒŞSize
.
height
(è!ğ
¡yË
->
mšHeight
())

150 
¡yË
->
£tMšHeight
(
mšCÚŒŞSize
.
height
());

153 
FÚtDesütiÚ
 
	gcÚŒŞFÚt
 = 
m_theme
->
cÚŒŞFÚt
(
·¹
, 
¡yË
->
fÚt
(), styË->
efãùiveZoom
());

154 ià(
	gcÚŒŞFÚt
 !ğ
¡yË
->
fÚt
().
fÚtDesütiÚ
()) {

156 
¡yË
->
£tLšeHeight
(
R’d”StyË
::
š™ŸlLšeHeight
());

159 ià(
	g¡yË
->
£tFÚtDesütiÚ
(
cÚŒŞFÚt
))

160 
	g¡yË
->
fÚt
().
upd©e
(0);

169 
	g¡yË
->
­³¬ªû
()) {

170 #ià!
USE
(
NEW_THEME
)

171 
	gCheckboxP¬t
:

172  
adju¡CheckboxStyË
(
£ËùÜ
, 
¡yË
, 
e
);

173 
	gRadioP¬t
:

174  
adju¡RadioStyË
(
£ËùÜ
, 
¡yË
, 
e
);

175 
	gPushBu‰ÚP¬t
:

176 
Squ¬eBu‰ÚP¬t
:

177 
Li¡Bu‰ÚP¬t
:

178 
DeçuÉBu‰ÚP¬t
:

179 
Bu‰ÚP¬t
:

180  
adju¡Bu‰ÚStyË
(
£ËùÜ
, 
¡yË
, 
e
);

181 
	gIÂ”SpšBu‰ÚP¬t
:

182  
adju¡IÂ”SpšBu‰ÚStyË
(
£ËùÜ
, 
¡yË
, 
e
);

183 
	gOu‹rSpšBu‰ÚP¬t
:

184  
adju¡Ou‹rSpšBu‰ÚStyË
(
£ËùÜ
, 
¡yË
, 
e
);

186 
	gTextF›ldP¬t
:

187  
adju¡TextF›ldStyË
(
£ËùÜ
, 
¡yË
, 
e
);

188 
	gTextA»aP¬t
:

189  
adju¡TextA»aStyË
(
£ËùÜ
, 
¡yË
, 
e
);

190 
	gM’uli¡P¬t
:

191  
adju¡M’uLi¡StyË
(
£ËùÜ
, 
¡yË
, 
e
);

192 
	gM’uli¡Bu‰ÚP¬t
:

193  
adju¡M’uLi¡Bu‰ÚStyË
(
£ËùÜ
, 
¡yË
, 
e
);

194 
	gMedŸSlid”P¬t
:

195 
MedŸVŞumeSlid”P¬t
:

196 
Slid”HÜizÚlP¬t
:

197 
Slid”V”tiÿlP¬t
:

198  
adju¡Slid”T¿ckStyË
(
£ËùÜ
, 
¡yË
, 
e
);

199 
	gSlid”ThumbHÜizÚlP¬t
:

200 
Slid”ThumbV”tiÿlP¬t
:

201  
adju¡Slid”ThumbStyË
(
£ËùÜ
, 
¡yË
, 
e
);

202 
	gS—rchF›ldP¬t
:

203  
adju¡S—rchF›ldStyË
(
£ËùÜ
, 
¡yË
, 
e
);

204 
	gS—rchF›ldCªûlBu‰ÚP¬t
:

205  
adju¡S—rchF›ldCªûlBu‰ÚStyË
(
£ËùÜ
, 
¡yË
, 
e
);

206 
	gS—rchF›ldDecÜ©iÚP¬t
:

207  
adju¡S—rchF›ldDecÜ©iÚStyË
(
£ËùÜ
, 
¡yË
, 
e
);

208 
	gS—rchF›ldResuÉsDecÜ©iÚP¬t
:

209  
adju¡S—rchF›ldResuÉsDecÜ©iÚStyË
(
£ËùÜ
, 
¡yË
, 
e
);

210 
	gS—rchF›ldResuÉsBu‰ÚP¬t
:

211  
adju¡S—rchF›ldResuÉsBu‰ÚStyË
(
£ËùÜ
, 
¡yË
, 
e
);

212 #ià
ENABLE
(
PROGRESS_TAG
)

213 
	gProg»ssB¬P¬t
:

214  
adju¡Prog»ssB¬StyË
(
£ËùÜ
, 
¡yË
, 
e
);

221 
boŞ
 
	gR’d”Theme
::
·št
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

226 ià(
	g·štInfo
.
	gcÚ‹xt
->
upd©šgCÚŒŞTšts
()) {

227 ià(
cÚŒŞSuµÜtsTšts
(
o
))

228 
	go
->
»·št
();

229  
	gçl£
;

231 ià(
	g·štInfo
.
	gcÚ‹xt
->
·štšgDi§bËd
())

232  
	gçl£
;

234 
CÚŒŞP¬t
 
	g·¹
 = 
o
->
¡yË
()->
­³¬ªû
();

236 #ià
USE
(
NEW_THEME
)

237 
	g·¹
) {

238 
	gCheckboxP¬t
:

239 
RadioP¬t
:

240 
PushBu‰ÚP¬t
:

241 
Squ¬eBu‰ÚP¬t
:

242 
Li¡Bu‰ÚP¬t
:

243 
DeçuÉBu‰ÚP¬t
:

244 
Bu‰ÚP¬t
:

245 
IÂ”SpšBu‰ÚP¬t
:

246 
Ou‹rSpšBu‰ÚP¬t
:

247 
m_theme
->
·št
(
·¹
, 
cÚŒŞS‹sFÜR’d””
(
o
), 
cÚ¡_ÿ¡
<
G¿phicsCÚ‹xt
*>(
·štInfo
.
cÚ‹xt
), 
r
, o->
¡yË
()->
efãùiveZoom
(), o->
v›w
()->
äameV›w
());

248  
	gçl£
;

255 
	g·¹
) {

256 #ià!
USE
(
NEW_THEME
)

257 
	gCheckboxP¬t
:

258  
·štCheckbox
(
o
, 
·štInfo
, 
r
);

259 
	gRadioP¬t
:

260  
·štRadio
(
o
, 
·štInfo
, 
r
);

261 
	gPushBu‰ÚP¬t
:

262 
Squ¬eBu‰ÚP¬t
:

263 
Li¡Bu‰ÚP¬t
:

264 
DeçuÉBu‰ÚP¬t
:

265 
Bu‰ÚP¬t
:

266  
·štBu‰Ú
(
o
, 
·štInfo
, 
r
);

267 
	gIÂ”SpšBu‰ÚP¬t
:

268  
·štIÂ”SpšBu‰Ú
(
o
, 
·štInfo
, 
r
);

269 
	gOu‹rSpšBu‰ÚP¬t
:

270  
·štOu‹rSpšBu‰Ú
(
o
, 
·štInfo
, 
r
);

272 
	gM’uli¡P¬t
:

273  
·štM’uLi¡
(
o
, 
·štInfo
, 
r
);

274 #ià
ENABLE
(
PROGRESS_TAG
)

275 
	gProg»ssB¬P¬t
:

276  
·štProg»ssB¬
(
o
, 
·štInfo
, 
r
);

278 
	gSlid”HÜizÚlP¬t
:

279 
Slid”V”tiÿlP¬t
:

280  
·štSlid”T¿ck
(
o
, 
·štInfo
, 
r
);

281 
	gSlid”ThumbHÜizÚlP¬t
:

282 
Slid”ThumbV”tiÿlP¬t
:

283 ià(
o
->
·»Á
()->
isSlid”
())

284  
·štSlid”Thumb
(
o
, 
·štInfo
, 
r
);

287 
	gMedŸFuÎsü“nBu‰ÚP¬t
:

288  
·štMedŸFuÎsü“nBu‰Ú
(
o
, 
·štInfo
, 
r
);

289 
	gMedŸPÏyBu‰ÚP¬t
:

290  
·štMedŸPÏyBu‰Ú
(
o
, 
·štInfo
, 
r
);

291 
	gMedŸMu‹Bu‰ÚP¬t
:

292  
·štMedŸMu‹Bu‰Ú
(
o
, 
·štInfo
, 
r
);

293 
	gMedŸS“kBackBu‰ÚP¬t
:

294  
·štMedŸS“kBackBu‰Ú
(
o
, 
·štInfo
, 
r
);

295 
	gMedŸS“kFÜw¬dBu‰ÚP¬t
:

296  
·štMedŸS“kFÜw¬dBu‰Ú
(
o
, 
·štInfo
, 
r
);

297 
	gMedŸRewšdBu‰ÚP¬t
:

298  
·štMedŸRewšdBu‰Ú
(
o
, 
·štInfo
, 
r
);

299 
	gMedŸR‘uºToR—ÉimeBu‰ÚP¬t
:

300  
·štMedŸR‘uºToR—ÉimeBu‰Ú
(
o
, 
·štInfo
, 
r
);

301 
	gMedŸToggËClo£dC­tiÚsBu‰ÚP¬t
:

302  
·štMedŸToggËClo£dC­tiÚsBu‰Ú
(
o
, 
·štInfo
, 
r
);

303 
	gMedŸSlid”P¬t
:

304  
·štMedŸSlid”T¿ck
(
o
, 
·štInfo
, 
r
);

305 
	gMedŸSlid”ThumbP¬t
:

306 ià(
o
->
·»Á
()->
isSlid”
())

307  
·štMedŸSlid”Thumb
(
o
, 
·štInfo
, 
r
);

309 
	gMedŸVŞumeSlid”CÚš”P¬t
:

310  
·štMedŸVŞumeSlid”CÚš”
(
o
, 
·štInfo
, 
r
);

311 
	gMedŸVŞumeSlid”P¬t
:

312  
·štMedŸVŞumeSlid”T¿ck
(
o
, 
·štInfo
, 
r
);

313 
	gMedŸVŞumeSlid”ThumbP¬t
:

314 ià(
o
->
·»Á
()->
isSlid”
())

315  
·štMedŸVŞumeSlid”Thumb
(
o
, 
·štInfo
, 
r
);

317 
	gMedŸTimeRemaššgP¬t
:

318  
·štMedŸTimeRemaššg
(
o
, 
·štInfo
, 
r
);

319 
	gMedŸCu¼’tTimeP¬t
:

320  
·štMedŸCu¼’tTime
(
o
, 
·štInfo
, 
r
);

321 
	gMedŸCÚŒŞsBackgroundP¬t
:

322  
·štMedŸCÚŒŞsBackground
(
o
, 
·štInfo
, 
r
);

323 
	gM’uli¡Bu‰ÚP¬t
:

324 
TextF›ldP¬t
:

325 
TextA»aP¬t
:

326 
Li¡boxP¬t
:

327  
Œue
;

328 
	gS—rchF›ldP¬t
:

329  
·štS—rchF›ld
(
o
, 
·štInfo
, 
r
);

330 
	gS—rchF›ldCªûlBu‰ÚP¬t
:

331  
·štS—rchF›ldCªûlBu‰Ú
(
o
, 
·štInfo
, 
r
);

332 
	gS—rchF›ldDecÜ©iÚP¬t
:

333  
·štS—rchF›ldDecÜ©iÚ
(
o
, 
·štInfo
, 
r
);

334 
	gS—rchF›ldResuÉsDecÜ©iÚP¬t
:

335  
·štS—rchF›ldResuÉsDecÜ©iÚ
(
o
, 
·štInfo
, 
r
);

336 
	gS—rchF›ldResuÉsBu‰ÚP¬t
:

337  
·štS—rchF›ldResuÉsBu‰Ú
(
o
, 
·štInfo
, 
r
);

342  
	gŒue
;

345 
boŞ
 
	gR’d”Theme
::
·štBÜd”OÆy
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

347 ià(
	g·štInfo
.
	gcÚ‹xt
->
·štšgDi§bËd
())

348  
	gçl£
;

351 
	go
->
¡yË
()->
­³¬ªû
()) {

352 
	gTextF›ldP¬t
:

353  
·štTextF›ld
(
o
, 
·štInfo
, 
r
);

354 
	gLi¡boxP¬t
:

355 
TextA»aP¬t
:

356  
·štTextA»a
(
o
, 
·štInfo
, 
r
);

357 
	gM’uli¡Bu‰ÚP¬t
:

358 
S—rchF›ldP¬t
:

359  
Œue
;

360 
	gCheckboxP¬t
:

361 
RadioP¬t
:

362 
PushBu‰ÚP¬t
:

363 
Squ¬eBu‰ÚP¬t
:

364 
Li¡Bu‰ÚP¬t
:

365 
DeçuÉBu‰ÚP¬t
:

366 
Bu‰ÚP¬t
:

367 
M’uli¡P¬t
:

368 #ià
ENABLE
(
PROGRESS_TAG
)

369 
Prog»ssB¬P¬t
:

371 
Slid”HÜizÚlP¬t
:

372 
Slid”V”tiÿlP¬t
:

373 
Slid”ThumbHÜizÚlP¬t
:

374 
Slid”ThumbV”tiÿlP¬t
:

375 
S—rchF›ldCªûlBu‰ÚP¬t
:

376 
S—rchF›ldDecÜ©iÚP¬t
:

377 
S—rchF›ldResuÉsDecÜ©iÚP¬t
:

378 
S—rchF›ldResuÉsBu‰ÚP¬t
:

383  
	gçl£
;

386 
boŞ
 
	gR’d”Theme
::
·štDecÜ©iÚs
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

388 ià(
	g·štInfo
.
	gcÚ‹xt
->
·štšgDi§bËd
())

389  
	gçl£
;

392 
	go
->
¡yË
()->
­³¬ªû
()) {

393 
	gM’uli¡Bu‰ÚP¬t
:

394  
·štM’uLi¡Bu‰Ú
(
o
, 
·štInfo
, 
r
);

395 
	gTextF›ldP¬t
:

396 
TextA»aP¬t
:

397 
Li¡boxP¬t
:

398 
CheckboxP¬t
:

399 
RadioP¬t
:

400 
PushBu‰ÚP¬t
:

401 
Squ¬eBu‰ÚP¬t
:

402 
Li¡Bu‰ÚP¬t
:

403 
DeçuÉBu‰ÚP¬t
:

404 
Bu‰ÚP¬t
:

405 
M’uli¡P¬t
:

406 #ià
ENABLE
(
PROGRESS_TAG
)

407 
Prog»ssB¬P¬t
:

409 
Slid”HÜizÚlP¬t
:

410 
Slid”V”tiÿlP¬t
:

411 
Slid”ThumbHÜizÚlP¬t
:

412 
Slid”ThumbV”tiÿlP¬t
:

413 
S—rchF›ldP¬t
:

414 
S—rchF›ldCªûlBu‰ÚP¬t
:

415 
S—rchF›ldDecÜ©iÚP¬t
:

416 
S—rchF›ldResuÉsDecÜ©iÚP¬t
:

417 
S—rchF›ldResuÉsBu‰ÚP¬t
:

422  
	gçl£
;

425 #ià
ENABLE
(
VIDEO
)

426 
boŞ
 
	gR’d”Theme
::
h™Te¡MedŸCÚŒŞP¬t
(
R’d”Objeù
* 
o
, cÚ¡ 
IÁPošt
& 
absPošt
)

428 ià(!
	go
->
isBox
())

429  
	gçl£
;

431 
FlßtPošt
 
	gloÿlPošt
 = 
o
->
absŞu‹ToLoÿl
(
absPošt
, 
çl£
, 
Œue
);

432  
toR’d”Box
(
o
)->
bÜd”BoxReù
().
cÚšs
(
roundedIÁPošt
(
loÿlPošt
));

435 
boŞ
 
	gR’d”Theme
::
shouldR’d”MedŸCÚŒŞP¬t
(
CÚŒŞP¬t
 
·¹
, 
EËm’t
* 
e
)

437 
HTMLMedŸEËm’t
* 
	gmedŸEËm’t
 = 
¡©ic_ÿ¡
<HTMLMedŸEËm’t*>(
e
);

438 
	g·¹
) {

439 
	gMedŸMu‹Bu‰ÚP¬t
:

440  
medŸEËm’t
->
hasAudio
();

441 
	gMedŸRewšdBu‰ÚP¬t
:

442  
medŸEËm’t
->
mov›LßdTy³
(è!ğ
MedŸPÏy”
::
LiveSŒ—m
;

443 
	gMedŸR‘uºToR—ÉimeBu‰ÚP¬t
:

444  
medŸEËm’t
->
mov›LßdTy³
(è=ğ
MedŸPÏy”
::
LiveSŒ—m
;

445 
	gMedŸFuÎsü“nBu‰ÚP¬t
:

446  
medŸEËm’t
->
suµÜtsFuÎsü“n
();

447 
	gMedŸToggËClo£dC­tiÚsBu‰ÚP¬t
:

448  
medŸEËm’t
->
hasClo£dC­tiÚs
();

450  
Œue
;

454 
SŒšg
 
	gR’d”Theme
::
fÜm©MedŸCÚŒŞsTime
(
time
) const

456 ià(!
isfš™e
(
time
))

457 
time
 = 0;

458 
	g£cÚds
 = ()
çbsf
(
time
);

459 
	ghours
 = 
£cÚds
 / (60 * 60);

460 
	gmšu‹s
 = (
£cÚds
 / 60) % 60;

461 
	g£cÚds
 %= 60;

462 ià(
	ghours
) {

463 ià(
	ghours
 > 9)

464  
	gSŒšg
::
fÜm©
("%s%02d:%02d:%02d", (
time
 < 0 ? "-" : ""), 
hours
, 
mšu‹s
, 
£cÚds
);

466  
	gSŒšg
::
fÜm©
("%s%01d:%02d:%02d", (
time
 < 0 ? "-" : ""), 
hours
, 
mšu‹s
, 
£cÚds
);

469  
	gSŒšg
::
fÜm©
("%s%02d:%02d", (
time
 < 0 ? "-" : ""), 
mšu‹s
, 
£cÚds
);

472 
SŒšg
 
	gR’d”Theme
::
fÜm©MedŸCÚŒŞsCu¼’tTime
(
cu¼’tTime
, ) const

474  
fÜm©MedŸCÚŒŞsTime
(
cu¼’tTime
);

477 
SŒšg
 
	gR’d”Theme
::
fÜm©MedŸCÚŒŞsRemaššgTime
(
cu¼’tTime
, 
du¿tiÚ
) const

479  
fÜm©MedŸCÚŒŞsTime
(
cu¼’tTime
 - 
du¿tiÚ
);

484 
CŞÜ
 
	gR’d”Theme
::
aùiveS–eùiÚBackgroundCŞÜ
() const

486 ià(!
m_aùiveS–eùiÚBackgroundCŞÜ
.
isV®id
())

487 
m_aùiveS–eùiÚBackgroundCŞÜ
 = 
¶©fÜmAùiveS–eùiÚBackgroundCŞÜ
().
bËndW™hWh™e
();

488  
	gm_aùiveS–eùiÚBackgroundCŞÜ
;

491 
CŞÜ
 
	gR’d”Theme
::
šaùiveS–eùiÚBackgroundCŞÜ
() const

493 ià(!
m_šaùiveS–eùiÚBackgroundCŞÜ
.
isV®id
())

494 
m_šaùiveS–eùiÚBackgroundCŞÜ
 = 
¶©fÜmIÇùiveS–eùiÚBackgroundCŞÜ
().
bËndW™hWh™e
();

495  
	gm_šaùiveS–eùiÚBackgroundCŞÜ
;

498 
CŞÜ
 
	gR’d”Theme
::
aùiveS–eùiÚFÜegroundCŞÜ
() const

500 ià(!
m_aùiveS–eùiÚFÜegroundCŞÜ
.
isV®id
(è&& 
suµÜtsS–eùiÚFÜegroundCŞÜs
())

501 
m_aùiveS–eùiÚFÜegroundCŞÜ
 = 
¶©fÜmAùiveS–eùiÚFÜegroundCŞÜ
();

502  
	gm_aùiveS–eùiÚFÜegroundCŞÜ
;

505 
CŞÜ
 
	gR’d”Theme
::
šaùiveS–eùiÚFÜegroundCŞÜ
() const

507 ià(!
m_šaùiveS–eùiÚFÜegroundCŞÜ
.
isV®id
(è&& 
suµÜtsS–eùiÚFÜegroundCŞÜs
())

508 
m_šaùiveS–eùiÚFÜegroundCŞÜ
 = 
¶©fÜmIÇùiveS–eùiÚFÜegroundCŞÜ
();

509  
	gm_šaùiveS–eùiÚFÜegroundCŞÜ
;

512 
CŞÜ
 
	gR’d”Theme
::
aùiveLi¡BoxS–eùiÚBackgroundCŞÜ
() const

514 ià(!
m_aùiveLi¡BoxS–eùiÚBackgroundCŞÜ
.
isV®id
())

515 
m_aùiveLi¡BoxS–eùiÚBackgroundCŞÜ
 = 
¶©fÜmAùiveLi¡BoxS–eùiÚBackgroundCŞÜ
();

516  
	gm_aùiveLi¡BoxS–eùiÚBackgroundCŞÜ
;

519 
CŞÜ
 
	gR’d”Theme
::
šaùiveLi¡BoxS–eùiÚBackgroundCŞÜ
() const

521 ià(!
m_šaùiveLi¡BoxS–eùiÚBackgroundCŞÜ
.
isV®id
())

522 
m_šaùiveLi¡BoxS–eùiÚBackgroundCŞÜ
 = 
¶©fÜmIÇùiveLi¡BoxS–eùiÚBackgroundCŞÜ
();

523  
	gm_šaùiveLi¡BoxS–eùiÚBackgroundCŞÜ
;

526 
CŞÜ
 
	gR’d”Theme
::
aùiveLi¡BoxS–eùiÚFÜegroundCŞÜ
() const

528 ià(!
m_aùiveLi¡BoxS–eùiÚFÜegroundCŞÜ
.
isV®id
(è&& 
suµÜtsLi¡BoxS–eùiÚFÜegroundCŞÜs
())

529 
m_aùiveLi¡BoxS–eùiÚFÜegroundCŞÜ
 = 
¶©fÜmAùiveLi¡BoxS–eùiÚFÜegroundCŞÜ
();

530  
	gm_aùiveLi¡BoxS–eùiÚFÜegroundCŞÜ
;

533 
CŞÜ
 
	gR’d”Theme
::
šaùiveLi¡BoxS–eùiÚFÜegroundCŞÜ
() const

535 ià(!
m_šaùiveLi¡BoxS–eùiÚFÜegroundCŞÜ
.
isV®id
(è&& 
suµÜtsLi¡BoxS–eùiÚFÜegroundCŞÜs
())

536 
m_šaùiveLi¡BoxS–eùiÚFÜegroundCŞÜ
 = 
¶©fÜmIÇùiveLi¡BoxS–eùiÚFÜegroundCŞÜ
();

537  
	gm_šaùiveLi¡BoxS–eùiÚFÜegroundCŞÜ
;

540 
CŞÜ
 
	gR’d”Theme
::
¶©fÜmAùiveS–eùiÚBackgroundCŞÜ
() const

543  
CŞÜ
(0, 0, 255);

546 
CŞÜ
 
	gR’d”Theme
::
¶©fÜmAùiveS–eùiÚFÜegroundCŞÜ
() const

549  
CŞÜ
::
wh™e
;

552 
CŞÜ
 
	gR’d”Theme
::
¶©fÜmIÇùiveS–eùiÚBackgroundCŞÜ
() const

556  
CŞÜ
(176, 176, 176);

559 
CŞÜ
 
	gR’d”Theme
::
¶©fÜmIÇùiveS–eùiÚFÜegroundCŞÜ
() const

562  
CŞÜ
::
bÏck
;

565 
CŞÜ
 
	gR’d”Theme
::
¶©fÜmAùiveLi¡BoxS–eùiÚBackgroundCŞÜ
() const

567  
¶©fÜmAùiveS–eùiÚBackgroundCŞÜ
();

570 
CŞÜ
 
	gR’d”Theme
::
¶©fÜmAùiveLi¡BoxS–eùiÚFÜegroundCŞÜ
() const

572  
¶©fÜmAùiveS–eùiÚFÜegroundCŞÜ
();

575 
CŞÜ
 
	gR’d”Theme
::
¶©fÜmIÇùiveLi¡BoxS–eùiÚBackgroundCŞÜ
() const

577  
¶©fÜmIÇùiveS–eùiÚBackgroundCŞÜ
();

580 
CŞÜ
 
	gR’d”Theme
::
¶©fÜmIÇùiveLi¡BoxS–eùiÚFÜegroundCŞÜ
() const

582  
¶©fÜmIÇùiveS–eùiÚFÜegroundCŞÜ
();

585 
	gR’d”Theme
::
ba£lšePos™iÚ
(cÚ¡ 
R’d”Objeù
* 
o
) const

587 ià(!
o
->
isBox
())

590 cÚ¡ 
R’d”Box
* 
	gbox
 = 
toR’d”Box
(
o
);

592 #ià
USE
(
NEW_THEME
)

593  
	gbox
->
height
(è+ box->
m¬gšTİ
(è+ 
	gm_theme
->
ba£lšePos™iÚAdju¡m’t
(
o
->
¡yË
()->
­³¬ªû
()è* 
	go
->¡yË()->
efãùiveZoom
();

595  
	gbox
->
height
(è+ box->
m¬gšTİ
();

599 
boŞ
 
	gR’d”Theme
::
isCÚŒŞCÚš”
(
CÚŒŞP¬t
 
­³¬ªû
) const

603  
­³¬ªû
 !ğ
CheckboxP¬t
 &&‡µ—¿nû !ğ
RadioP¬t
;

606 
boŞ
 
	gR’d”Theme
::
isCÚŒŞStyËd
(cÚ¡ 
R’d”StyË
* 
¡yË
, cÚ¡ 
BÜd”D©a
& 
bÜd”
, cÚ¡ 
FlLay”
& 
background
,

607 cÚ¡ 
CŞÜ
& 
backgroundCŞÜ
) const

609 
	g¡yË
->
­³¬ªû
()) {

610 
	gPushBu‰ÚP¬t
:

611 
Squ¬eBu‰ÚP¬t
:

612 
DeçuÉBu‰ÚP¬t
:

613 
Bu‰ÚP¬t
:

614 
Li¡boxP¬t
:

615 
M’uli¡P¬t
:

618 
TextF›ldP¬t
:

619 
TextA»aP¬t
:

621  (
¡yË
->
bÜd”
() != border ||

622 *
¡yË
->
backgroundLay”s
(è!ğ
background
 ||

623 
¡yË
->
backgroundCŞÜ
() != backgroundColor);

625  
çl£
;

629 
	gR’d”Theme
::
adju¡R•aštReù
(cÚ¡ 
R’d”Objeù
* 
o
, 
IÁReù
& 
r
)

631 #ià
USE
(
NEW_THEME
)

632 
	gm_theme
->
šæ©eCÚŒŞPaštReù
(
o
->
¡yË
()->
­³¬ªû
(), 
cÚŒŞS‹sFÜR’d””
(o), 
r
, o->¡yË()->
efãùiveZoom
());

636 
boŞ
 
	gR’d”Theme
::
suµÜtsFocusRšg
(cÚ¡ 
R’d”StyË
* 
¡yË
) const

638  (
¡yË
->
hasAµ—¿nû
(è&& styË->
­³¬ªû
(è!ğ
TextF›ldP¬t
 && styË->­³¬ªû(è!ğ
TextA»aP¬t
 && styË->­³¬ªû(è!ğ
M’uli¡Bu‰ÚP¬t
 && styË->­³¬ªû(è!ğ
Li¡boxP¬t
);

641 
boŞ
 
	gR’d”Theme
::
¡©eChªged
(
R’d”Objeù
* 
o
, 
CÚŒŞS‹
 
¡©e
) const

644 ià(
	g¡©e
 =ğ
Hov”S‹
 && !
suµÜtsHov”
(
o
->
¡yË
()))

645  
çl£
;

648 ià(
	g¡©e
 =ğ
P»s£dS‹
 && !
isEÇbËd
(
o
))

649  
çl£
;

652 
	go
->
»·št
();

653  
	gŒue
;

656 
CÚŒŞS‹s
 
	gR’d”Theme
::
cÚŒŞS‹sFÜR’d””
(cÚ¡ 
R’d”Objeù
* 
o
) const

658 
CÚŒŞS‹s
 
»suÉ
 = 0;

659 ià(
isHov”ed
(
o
))

660 
	g»suÉ
 |ğ
Hov”S‹
;

661 ià(
isP»s£d
(
o
))

662 
	g»suÉ
 |ğ
P»s£dS‹
;

663 ià(
isFocu£d
(
o
è&& 
	go
->
¡yË
()->
oušeStyËIsAuto
())

664 
	g»suÉ
 |ğ
FocusS‹
;

665 ià(
isEÇbËd
(
o
))

666 
	g»suÉ
 |ğ
EÇbËdS‹
;

667 ià(
isChecked
(
o
))

668 
	g»suÉ
 |ğ
CheckedS‹
;

669 ià(
isR—dOÆyCÚŒŞ
(
o
))

670 
	g»suÉ
 |ğ
R—dOÆyS‹
;

671 ià(
isDeçuÉ
(
o
))

672 
	g»suÉ
 |ğ
DeçuÉS‹
;

673 ià(!
isAùive
(
o
))

674 
	g»suÉ
 |ğ
WšdowIÇùiveS‹
;

675 ià(
isInd‘”mš©e
(
o
))

676 
	g»suÉ
 |ğ
Ind‘”mš©eS‹
;

677  
	g»suÉ
;

680 
boŞ
 
	gR’d”Theme
::
isAùive
(cÚ¡ 
R’d”Objeù
* 
o
) const

682 
Node
* 
node
 = 
o
->node();

683 ià(!
	gnode
)

684  
	gçl£
;

686 
F¿me
* 
	gäame
 = 
node
->
docum’t
()->
äame
();

687 ià(!
	gäame
)

688  
	gçl£
;

690 
Page
* 
	g·ge
 = 
äame
->
·ge
();

691 ià(!
	g·ge
)

692  
	gçl£
;

694  
	g·ge
->
focusCÚŒŞËr
()->
isAùive
();

697 
boŞ
 
	gR’d”Theme
::
isChecked
(cÚ¡ 
R’d”Objeù
* 
o
) const

699 ià(!
o
->
node
(è|| !o->node()->
isEËm’tNode
())

700  
çl£
;

702 
IÅutEËm’t
* 
	gšputEËm’t
 = 
toIÅutEËm’t
(
¡©ic_ÿ¡
<
EËm’t
*>(
o
->
node
()));

703 ià(!
	gšputEËm’t
)

704  
	gçl£
;

706  
	gšputEËm’t
->
isChecked
();

709 
boŞ
 
	gR’d”Theme
::
isInd‘”mš©e
(cÚ¡ 
R’d”Objeù
* 
o
) const

711 ià(!
o
->
node
(è|| !o->node()->
isEËm’tNode
())

712  
çl£
;

714 
IÅutEËm’t
* 
	gšputEËm’t
 = 
toIÅutEËm’t
(
¡©ic_ÿ¡
<
EËm’t
*>(
o
->
node
()));

715 ià(!
	gšputEËm’t
)

716  
	gçl£
;

718  
	gšputEËm’t
->
isInd‘”mš©e
();

721 
boŞ
 
	gR’d”Theme
::
isEÇbËd
(cÚ¡ 
R’d”Objeù
* 
o
) const

723 
Node
* 
node
 = 
o
->node();

724 ià(!
	gnode
 || !node->
isEËm’tNode
())

725  
	gŒue
;

726  
	g¡©ic_ÿ¡
<
	gEËm’t
*>(
	gnode
)->
isEÇbËdFÜmCÚŒŞ
();

729 
boŞ
 
	gR’d”Theme
::
isFocu£d
(cÚ¡ 
R’d”Objeù
* 
o
) const

731 
Node
* 
node
 = 
o
->node();

732 ià(!
	gnode
)

733  
	gçl£
;

734 
Docum’t
* 
	gdocum’t
 = 
node
->
docum’t
();

735 
F¿me
* 
	gäame
 = 
docum’t
->
äame
();

736  
	gnode
 =ğ
docum’t
->
focu£dNode
(è&& 
äame
 && f¿me->
£ËùiÚ
()->
isFocu£dAndAùive
();

739 
boŞ
 
	gR’d”Theme
::
isP»s£d
(cÚ¡ 
R’d”Objeù
* 
o
) const

741 ià(!
o
->
node
())

742  
çl£
;

743  
	go
->
node
()->
aùive
();

746 
boŞ
 
	gR’d”Theme
::
isR—dOÆyCÚŒŞ
(cÚ¡ 
R’d”Objeù
* 
o
) const

748 
Node
* 
node
 = 
o
->node();

749 ià(!
	gnode
 || !node->
isEËm’tNode
())

750  
	gçl£
;

751  
	g¡©ic_ÿ¡
<
	gEËm’t
*>(
	gnode
)->
isR—dOÆyFÜmCÚŒŞ
();

754 
boŞ
 
	gR’d”Theme
::
isHov”ed
(cÚ¡ 
R’d”Objeù
* 
o
) const

756 ià(!
o
->
node
())

757  
çl£
;

758  
	go
->
node
()->
hov”ed
();

761 
boŞ
 
	gR’d”Theme
::
isDeçuÉ
(cÚ¡ 
R’d”Objeù
* 
o
) const

764 ià(!
isAùive
(
o
))

765  
çl£
;

767 ià(!
	go
->
docum’t
())

768  
	gçl£
;

770 
S‘tšgs
* 
	g£‰šgs
 = 
o
->
docum’t
()->
£‰šgs
();

771 ià(!
	g£‰šgs
 || !£‰šgs->
šAµliÿtiÚChromeMode
())

772  
	gçl£
;

774  
	go
->
¡yË
()->
­³¬ªû
(è=ğ
DeçuÉBu‰ÚP¬t
;

777 #ià!
USE
(
NEW_THEME
)

779 
	gR’d”Theme
::
adju¡CheckboxStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
* 
¡yË
, 
EËm’t
*) const

784 
£tCheckboxSize
(
¡yË
);

787 
	g¡yË
->
»£tPaddšg
();

791 
	g¡yË
->
»£tBÜd”
();

793 
	g¡yË
->
£tBoxShadow
(0);

796 
	gR’d”Theme
::
adju¡RadioStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
* 
¡yË
, 
EËm’t
*) const

801 
£tRadioSize
(
¡yË
);

804 
	g¡yË
->
»£tPaddšg
();

808 
	g¡yË
->
»£tBÜd”
();

810 
	g¡yË
->
£tBoxShadow
(0);

813 
	gR’d”Theme
::
adju¡Bu‰ÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
* 
¡yË
, 
EËm’t
*) const

817 
£tBu‰ÚSize
(
¡yË
);

820 
	gR’d”Theme
::
adju¡IÂ”SpšBu‰ÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const

824 
	gR’d”Theme
::
adju¡Ou‹rSpšBu‰ÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const

830 
	gR’d”Theme
::
adju¡TextF›ldStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const

834 
	gR’d”Theme
::
adju¡TextA»aStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const

838 
	gR’d”Theme
::
adju¡M’uLi¡StyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const

842 #ià
ENABLE
(
PROGRESS_TAG
)

843 
	gR’d”Theme
::
ªim©iÚR•—tIÁ”v®FÜProg»ssB¬
(
R’d”Prog»ss
*) const

848 
	gR’d”Theme
::
ªim©iÚDu¿tiÚFÜProg»ssB¬
(
R’d”Prog»ss
*) const

853 
	gR’d”Theme
::
adju¡Prog»ssB¬StyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const

858 
	gR’d”Theme
::
adju¡M’uLi¡Bu‰ÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const

862 
	gR’d”Theme
::
adju¡Slid”T¿ckStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const

866 
	gR’d”Theme
::
adju¡Slid”ThumbStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const

870 
	gR’d”Theme
::
adju¡Slid”ThumbSize
(
R’d”Objeù
*) const

874 
R’d”Theme
::
adju¡S—rchF›ldStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const

878 
	gR’d”Theme
::
adju¡S—rchF›ldCªûlBu‰ÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const

882 
	gR’d”Theme
::
adju¡S—rchF›ldDecÜ©iÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const

886 
	gR’d”Theme
::
adju¡S—rchF›ldResuÉsDecÜ©iÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const

890 
	gR’d”Theme
::
adju¡S—rchF›ldResuÉsBu‰ÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const

894 
	gR’d”Theme
::
¶©fÜmCŞÜsDidChªge
()

896 
m_aùiveS–eùiÚFÜegroundCŞÜ
 = 
CŞÜ
();

897 
	gm_šaùiveS–eùiÚFÜegroundCŞÜ
 = 
CŞÜ
();

898 
	gm_aùiveS–eùiÚBackgroundCŞÜ
 = 
CŞÜ
();

899 
	gm_šaùiveS–eùiÚBackgroundCŞÜ
 = 
CŞÜ
();

901 
	gm_aùiveLi¡BoxS–eùiÚFÜegroundCŞÜ
 = 
CŞÜ
();

902 
	gm_šaùiveLi¡BoxS–eùiÚFÜegroundCŞÜ
 = 
CŞÜ
();

903 
	gm_aùiveLi¡BoxS–eùiÚBackgroundCŞÜ
 = 
CŞÜ
();

904 
	gm_šaùiveLi¡BoxS–eùiÚFÜegroundCŞÜ
 = 
CŞÜ
();

907 
CŞÜ
 
	gR’d”Theme
::
sy¡emCŞÜ
(
cssV®ueId
) const

909 
cssV®ueId
) {

910 
CSSV®ueAùivebÜd”
:

912 
	gCSSV®ueAùiveÿ±iÚ
:

914 
	gCSSV®ueAµwÜk¥aû
:

916 
	gCSSV®ueBackground
:

918 
	gCSSV®ueBu‰Úçû
:

920 
	gCSSV®ueBu‰Úhighlight
:

922 
	gCSSV®ueBu‰Úshadow
:

924 
	gCSSV®ueBu‰Ú‹xt
:

926 
	gCSSV®ueC­tiÚ‹xt
:

928 
	gCSSV®ueG¿y‹xt
:

930 
	gCSSV®ueHighlight
:

932 
	gCSSV®ueHighligh‰ext
:

934 
	gCSSV®ueIÇùivebÜd”
:

936 
	gCSSV®ueIÇùiveÿ±iÚ
:

938 
	gCSSV®ueIÇùiveÿ±iÚ‹xt
:

940 
	gCSSV®ueInfobackground
:

942 
	gCSSV®ueInfÙext
:

944 
	gCSSV®ueM’u
:

946 
	gCSSV®ueM’u‹xt
:

948 
	gCSSV®ueSüŞlb¬
:

950 
	gCSSV®ueText
:

952 
	gCSSV®ueTh»edd¬kshadow
:

954 
	gCSSV®ueTh»edçû
:

956 
	gCSSV®ueTh»edhighlight
:

958 
	gCSSV®ueTh»edlightshadow
:

960 
	gCSSV®ueTh»edshadow
:

962 
	gCSSV®ueWšdow
:

964 
	gCSSV®ueWšdowäame
:

966 
	gCSSV®ueWšdow‹xt
:

969  
CŞÜ
();

972 
CŞÜ
 
	gR’d”Theme
::
¶©fÜmAùiveTextS—rchHighlightCŞÜ
() const

974  
CŞÜ
(255, 150, 50);

977 
CŞÜ
 
	gR’d”Theme
::
¶©fÜmIÇùiveTextS—rchHighlightCŞÜ
() const

979  
CŞÜ
(255, 255, 0);

982 
	gR’d”Theme
::
£tCu¡omFocusRšgCŞÜ
(cÚ¡ 
CŞÜ
& 
c
)

984 
cu¡omFocusRšgCŞÜ
(èğ
c
;

987 
CŞÜ
 
	gR’d”Theme
::
focusRšgCŞÜ
()

989  
cu¡omFocusRšgCŞÜ
().
isV®id
(è? cu¡omFocusRšgCŞÜ(è: 
deçuÉTheme
()->
¶©fÜmFocusRšgCŞÜ
();

	@RenderTheme.h

23 #iâdeà
R’d”Theme_h


24 
	#R’d”Theme_h


	)

26 #ià
USE
(
NEW_THEME
)

27 
	~"Theme.h
"

29 
	~"ThemeTy³s.h
"

31 
	~"R’d”Objeù.h
"

32 
	~"R’d”Theme.h
"

33 
	~"SüŞlTy³s.h
"

34 
	~<wtf/PassRefPŒ.h
>

35 
	~<wtf/RefCouÁed.h
>

37 
Çme¥aû
 
	gWebCÜe
 {

39 
şass
 
	gEËm’t
;

40 
şass
 
	gPİupM’u
;

41 
şass
 
	gR’d”M’uLi¡
;

42 #ià
ENABLE
(
PROGRESS_TAG
)

43 
şass
 
	gR’d”Prog»ss
;

45 
şass
 
	gCSSStyËSh“t
;

47 
şass
 
	gR’d”Theme
 : 
public
 
RefCouÁed
<
R’d”Theme
> {

48 
´Ùeùed
:

49 
R’d”Theme
();

51 
	gpublic
:

52 
vœtu®
 ~
R’d”Theme
() { }

57 
PassRefPŒ
<
R’d”Theme
> 
themeFÜPage
(
Page
* 
·ge
);

60 
šlše
 
	gPassRefPŒ
<
	gR’d”Theme
> 
deçuÉTheme
()

62  
themeFÜPage
(0);

70 
adju¡StyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*, 
boŞ
 
UAHasAµ—¿nû
,

71 cÚ¡ 
BÜd”D©a
&, cÚ¡ 
FlLay”
&, cÚ¡ 
CŞÜ
& 
backgroundCŞÜ
);

76 
boŞ
 
·št
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

77 
boŞ
 
·štBÜd”OÆy
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

78 
boŞ
 
·štDecÜ©iÚs
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

85 
vœtu®
 
SŒšg
 
exŒaDeçuÉStyËSh“t
() {  String(); }

86 
vœtu®
 
SŒšg
 
exŒaQuœksStyËSh“t
() {  String(); }

87 #ià
ENABLE
(
VIDEO
)

88 
vœtu®
 
SŒšg
 
exŒaMedŸCÚŒŞsStyËSh“t
() {  String(); };

94 
vœtu®
 
ba£lšePos™iÚ
(cÚ¡ 
R’d”Objeù
*) const;

98 
boŞ
 
isCÚŒŞCÚš”
(
CÚŒŞP¬t
) const;

101 
vœtu®
 
boŞ
 
cÚŒŞSuµÜtsTšts
(cÚ¡ 
R’d”Objeù
*ècÚ¡ {  
	gçl£
; }

104 
vœtu®
 
boŞ
 
isCÚŒŞStyËd
(cÚ¡ 
R’d”StyË
*, cÚ¡ 
BÜd”D©a
&, cÚ¡ 
FlLay”
&, cÚ¡ 
CŞÜ
& 
backgroundCŞÜ
) const;

107 
vœtu®
 
boŞ
 
suµÜtsCÚŒŞTšts
(ècÚ¡ {  
	gçl£
; }

111 
vœtu®
 
adju¡R•aštReù
(cÚ¡ 
R’d”Objeù
*, 
IÁReù
&);

115 
vœtu®
 
boŞ
 
¡©eChªged
(
R’d”Objeù
*, 
CÚŒŞS‹
) const;

119 
vœtu®
 
themeChªged
() { }

122 
vœtu®
 
boŞ
 
suµÜtsFocusRšg
(cÚ¡ 
R’d”StyË
*) const;

125 
vœtu®
 
boŞ
 
suµÜtsHov”
(cÚ¡ 
R’d”StyË
*ècÚ¡ {  
	gçl£
; }

128 
CŞÜ
 
aùiveS–eùiÚBackgroundCŞÜ
() const;

129 
CŞÜ
 
šaùiveS–eùiÚBackgroundCŞÜ
() const;

130 
CŞÜ
 
aùiveS–eùiÚFÜegroundCŞÜ
() const;

131 
CŞÜ
 
šaùiveS–eùiÚFÜegroundCŞÜ
() const;

134 
CŞÜ
 
aùiveLi¡BoxS–eùiÚBackgroundCŞÜ
() const;

135 
CŞÜ
 
aùiveLi¡BoxS–eùiÚFÜegroundCŞÜ
() const;

136 
CŞÜ
 
šaùiveLi¡BoxS–eùiÚBackgroundCŞÜ
() const;

137 
CŞÜ
 
šaùiveLi¡BoxS–eùiÚFÜegroundCŞÜ
() const;

140 
vœtu®
 
CŞÜ
 
¶©fÜmAùiveTextS—rchHighlightCŞÜ
() const;

141 
vœtu®
 
CŞÜ
 
¶©fÜmIÇùiveTextS—rchHighlightCŞÜ
() const;

143 
CŞÜ
 
focusRšgCŞÜ
();

144 
vœtu®
 
CŞÜ
 
¶©fÜmFocusRšgCŞÜ
() const {  Color(0, 0, 0); }

145 
£tCu¡omFocusRšgCŞÜ
(cÚ¡ 
CŞÜ
&);

147 
vœtu®
 
¶©fÜmCŞÜsDidChªge
();

149 
vœtu®
 
ÿ»tBlškIÁ”v®
() const {  0.5; }

152 
vœtu®
 
sy¡emFÚt
(
cssV®ueId
, 
FÚtDesütiÚ
&) const = 0;

153 
vœtu®
 
CŞÜ
 
sy¡emCŞÜ
(
cssV®ueId
) const;

155 
vœtu®
 
mšimumM’uLi¡Size
(
R’d”StyË
*) const {  0; }

157 
vœtu®
 
adju¡Slid”ThumbSize
(
R’d”Objeù
*) const;

159 
vœtu®
 
pİupIÁ”ÇlPaddšgLeá
(
R’d”StyË
*) const {  0; }

160 
vœtu®
 
pİupIÁ”ÇlPaddšgRight
(
R’d”StyË
*) const {  0; }

161 
vœtu®
 
pİupIÁ”ÇlPaddšgTİ
(
R’d”StyË
*) const {  0; }

162 
vœtu®
 
pİupIÁ”ÇlPaddšgBÙtom
(
R’d”StyË
*) const {  0; }

163 
vœtu®
 
boŞ
 
pİupO±iÚSuµÜtsTextInd’t
(ècÚ¡ {  
	gçl£
; }

165 
vœtu®
 
bu‰ÚIÁ”ÇlPaddšgLeá
() const {  0; }

166 
vœtu®
 
bu‰ÚIÁ”ÇlPaddšgRight
() const {  0; }

167 
vœtu®
 
bu‰ÚIÁ”ÇlPaddšgTİ
() const {  0; }

168 
vœtu®
 
bu‰ÚIÁ”ÇlPaddšgBÙtom
() const {  0; }

170 
vœtu®
 
SüŞlb¬CÚŒŞSize
 
süŞlb¬CÚŒŞSizeFÜP¬t
(
CÚŒŞP¬t
è{  
	gReguÏrSüŞlb¬
; }

173 
vœtu®
 
boŞ
 
·štC­sLockIndiÿtÜ
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&) {  0; };

175 #ià
ENABLE
(
PROGRESS_TAG
)

177 
vœtu®
 
ªim©iÚR•—tIÁ”v®FÜProg»ssB¬
(
R’d”Prog»ss
*) const;

179 
vœtu®
 
ªim©iÚDu¿tiÚFÜProg»ssB¬
(
R’d”Prog»ss
*) const;

182 #ià
ENABLE
(
VIDEO
)

184 
vœtu®
 
boŞ
 
h™Te¡MedŸCÚŒŞP¬t
(
R’d”Objeù
*, cÚ¡ 
IÁPošt
& 
absPošt
);

185 
vœtu®
 
boŞ
 
shouldR’d”MedŸCÚŒŞP¬t
(
CÚŒŞP¬t
, 
EËm’t
*);

186 
vœtu®
 
medŸCÚŒŞsFadeInDu¿tiÚ
() {  0.1; }

187 
vœtu®
 
medŸCÚŒŞsFadeOutDu¿tiÚ
() {  0.3; }

188 
vœtu®
 
SŒšg
 
fÜm©MedŸCÚŒŞsTime
(
time
) const;

189 
vœtu®
 
SŒšg
 
fÜm©MedŸCÚŒŞsCu¼’tTime
(
cu¼’tTime
, 
du¿tiÚ
) const;

190 
vœtu®
 
SŒšg
 
fÜm©MedŸCÚŒŞsRemaššgTime
(
cu¼’tTime
, 
du¿tiÚ
) const;

193 
	g´Ùeùed
:

195 
vœtu®
 
CŞÜ
 
¶©fÜmAùiveS–eùiÚBackgroundCŞÜ
() const;

196 
vœtu®
 
CŞÜ
 
¶©fÜmIÇùiveS–eùiÚBackgroundCŞÜ
() const;

197 
vœtu®
 
CŞÜ
 
¶©fÜmAùiveS–eùiÚFÜegroundCŞÜ
() const;

198 
vœtu®
 
CŞÜ
 
¶©fÜmIÇùiveS–eùiÚFÜegroundCŞÜ
() const;

200 
vœtu®
 
CŞÜ
 
¶©fÜmAùiveLi¡BoxS–eùiÚBackgroundCŞÜ
() const;

201 
vœtu®
 
CŞÜ
 
¶©fÜmIÇùiveLi¡BoxS–eùiÚBackgroundCŞÜ
() const;

202 
vœtu®
 
CŞÜ
 
¶©fÜmAùiveLi¡BoxS–eùiÚFÜegroundCŞÜ
() const;

203 
vœtu®
 
CŞÜ
 
¶©fÜmIÇùiveLi¡BoxS–eùiÚFÜegroundCŞÜ
() const;

205 
vœtu®
 
boŞ
 
suµÜtsS–eùiÚFÜegroundCŞÜs
(ècÚ¡ {  
	gŒue
; }

206 
vœtu®
 
boŞ
 
suµÜtsLi¡BoxS–eùiÚFÜegroundCŞÜs
(ècÚ¡ {  
	gŒue
; }

208 #ià!
USE
(
NEW_THEME
)

210 
vœtu®
 
adju¡CheckboxStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

211 
vœtu®
 
boŞ
 
·štCheckbox
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&è{  
	gŒue
; }

212 
vœtu®
 
£tCheckboxSize
(
R’d”StyË
*) const { }

214 
vœtu®
 
adju¡RadioStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

215 
vœtu®
 
boŞ
 
·štRadio
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&è{  
	gŒue
; }

216 
vœtu®
 
£tRadioSize
(
R’d”StyË
*) const { }

218 
vœtu®
 
adju¡Bu‰ÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

219 
vœtu®
 
boŞ
 
·štBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&è{  
	gŒue
; }

220 
vœtu®
 
£tBu‰ÚSize
(
R’d”StyË
*) const { }

222 
vœtu®
 
adju¡IÂ”SpšBu‰ÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

223 
vœtu®
 
boŞ
 
·štIÂ”SpšBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&è{  
	gŒue
; }

224 
vœtu®
 
adju¡Ou‹rSpšBu‰ÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

225 
vœtu®
 
boŞ
 
·štOu‹rSpšBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&è{  
	gŒue
; }

228 
vœtu®
 
adju¡TextF›ldStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

229 
vœtu®
 
boŞ
 
·štTextF›ld
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&è{  
	gŒue
; }

231 
vœtu®
 
adju¡TextA»aStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

232 
vœtu®
 
boŞ
 
·štTextA»a
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&è{  
	gŒue
; }

234 
vœtu®
 
adju¡M’uLi¡StyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

235 
vœtu®
 
boŞ
 
·štM’uLi¡
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&è{  
	gŒue
; }

237 
vœtu®
 
adju¡M’uLi¡Bu‰ÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

238 
vœtu®
 
boŞ
 
·štM’uLi¡Bu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&è{  
	gŒue
; }

240 #ià
ENABLE
(
PROGRESS_TAG
)

241 
vœtu®
 
adju¡Prog»ssB¬StyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

242 
vœtu®
 
boŞ
 
·štProg»ssB¬
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&è{  
	gŒue
; }

245 
vœtu®
 
adju¡Slid”T¿ckStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

246 
vœtu®
 
boŞ
 
·štSlid”T¿ck
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&è{  
	gŒue
; }

248 
vœtu®
 
adju¡Slid”ThumbStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

249 
vœtu®
 
boŞ
 
·štSlid”Thumb
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&è{  
	gŒue
; }

251 
vœtu®
 
adju¡S—rchF›ldStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

252 
vœtu®
 
boŞ
 
·štS—rchF›ld
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&è{  
	gŒue
; }

254 
vœtu®
 
adju¡S—rchF›ldCªûlBu‰ÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

255 
vœtu®
 
boŞ
 
·štS—rchF›ldCªûlBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&è{  
	gŒue
; }

257 
vœtu®
 
adju¡S—rchF›ldDecÜ©iÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

258 
vœtu®
 
boŞ
 
·štS—rchF›ldDecÜ©iÚ
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&è{  
	gŒue
; }

260 
vœtu®
 
adju¡S—rchF›ldResuÉsDecÜ©iÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

261 
vœtu®
 
boŞ
 
·štS—rchF›ldResuÉsDecÜ©iÚ
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&è{  
	gŒue
; }

263 
vœtu®
 
adju¡S—rchF›ldResuÉsBu‰ÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

264 
vœtu®
 
boŞ
 
·štS—rchF›ldResuÉsBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&è{  
	gŒue
; }

266 
vœtu®
 
boŞ
 
·štMedŸFuÎsü“nBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&è{  
	gŒue
; }

267 
vœtu®
 
boŞ
 
·štMedŸPÏyBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&è{  
	gŒue
; }

268 
vœtu®
 
boŞ
 
·štMedŸMu‹Bu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&è{  
	gŒue
; }

269 
vœtu®
 
boŞ
 
·štMedŸS“kBackBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&è{  
	gŒue
; }

270 
vœtu®
 
boŞ
 
·štMedŸS“kFÜw¬dBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&è{  
	gŒue
; }

271 
vœtu®
 
boŞ
 
·štMedŸSlid”T¿ck
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&è{  
	gŒue
; }

272 
vœtu®
 
boŞ
 
·štMedŸSlid”Thumb
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&è{  
	gŒue
; }

273 
vœtu®
 
boŞ
 
·štMedŸVŞumeSlid”CÚš”
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&è{  
	gŒue
; }

274 
vœtu®
 
boŞ
 
·štMedŸVŞumeSlid”T¿ck
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&è{  
	gŒue
; }

275 
vœtu®
 
boŞ
 
·štMedŸVŞumeSlid”Thumb
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&è{  
	gŒue
; }

276 
vœtu®
 
boŞ
 
·štMedŸRewšdBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&è{  
	gŒue
; }

277 
vœtu®
 
boŞ
 
·štMedŸR‘uºToR—ÉimeBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&è{  
	gŒue
; }

278 
vœtu®
 
boŞ
 
·štMedŸToggËClo£dC­tiÚsBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&è{  
	gŒue
; }

279 
vœtu®
 
boŞ
 
·štMedŸCÚŒŞsBackground
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&è{  
	gŒue
; }

280 
vœtu®
 
boŞ
 
·štMedŸCu¼’tTime
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&è{  
	gŒue
; }

281 
vœtu®
 
boŞ
 
·štMedŸTimeRemaššg
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&è{  
	gŒue
; }

283 
	gpublic
:

285 
CÚŒŞS‹s
 
cÚŒŞS‹sFÜR’d””
(cÚ¡ 
R’d”Objeù
* 
o
) const;

286 
boŞ
 
isAùive
(cÚ¡ 
R’d”Objeù
*) const;

287 
boŞ
 
isChecked
(cÚ¡ 
R’d”Objeù
*) const;

288 
boŞ
 
isInd‘”mš©e
(cÚ¡ 
R’d”Objeù
*) const;

289 
boŞ
 
isEÇbËd
(cÚ¡ 
R’d”Objeù
*) const;

290 
boŞ
 
isFocu£d
(cÚ¡ 
R’d”Objeù
*) const;

291 
boŞ
 
isP»s£d
(cÚ¡ 
R’d”Objeù
*) const;

292 
boŞ
 
isHov”ed
(cÚ¡ 
R’d”Objeù
*) const;

293 
boŞ
 
isR—dOÆyCÚŒŞ
(cÚ¡ 
R’d”Objeù
*) const;

294 
boŞ
 
isDeçuÉ
(cÚ¡ 
R’d”Objeù
*) const;

296 
	g´iv©e
:

297 
mubË
 
CŞÜ
 
m_aùiveS–eùiÚBackgroundCŞÜ
;

298 
mubË
 
CŞÜ
 
	gm_šaùiveS–eùiÚBackgroundCŞÜ
;

299 
mubË
 
CŞÜ
 
	gm_aùiveS–eùiÚFÜegroundCŞÜ
;

300 
mubË
 
CŞÜ
 
	gm_šaùiveS–eùiÚFÜegroundCŞÜ
;

302 
mubË
 
CŞÜ
 
	gm_aùiveLi¡BoxS–eùiÚBackgroundCŞÜ
;

303 
mubË
 
CŞÜ
 
	gm_šaùiveLi¡BoxS–eùiÚBackgroundCŞÜ
;

304 
mubË
 
CŞÜ
 
	gm_aùiveLi¡BoxS–eùiÚFÜegroundCŞÜ
;

305 
mubË
 
CŞÜ
 
	gm_šaùiveLi¡BoxS–eùiÚFÜegroundCŞÜ
;

307 #ià
USE
(
NEW_THEME
)

308 
Theme
* 
	gm_theme
;

	@RenderThemeChromiumLinux.cpp

25 
	~"cÚfig.h
"

26 
	~"R’d”ThemeChromiumLšux.h
"

28 
	~"CSSV®ueKeywÜds.h
"

29 
	~"CŞÜ.h
"

30 
	~"R’d”Objeù.h
"

31 
	~"U£rAg’tStyËSh“ts.h
"

33 
Çme¥aû
 
	gWebCÜe
 {

35 
	gR’d”ThemeChromiumLšux
::
m_thumbIÇùiveCŞÜ
 = 0xf0ebe5;

36 
	gR’d”ThemeChromiumLšux
::
m_thumbAùiveCŞÜ
 = 0xfaf8f5;

37 
	gR’d”ThemeChromiumLšux
::
m_ŒackCŞÜ
 = 0xe3ddd8;

38 
	gR’d”ThemeChromiumLšux
::
m_aùiveS–eùiÚBackgroundCŞÜ
 =

40 
	gR’d”ThemeChromiumLšux
::
m_aùiveS–eùiÚFÜegroundCŞÜ
 =

41 
CŞÜ
::
bÏck
;

42 
	gR’d”ThemeChromiumLšux
::
m_šaùiveS–eùiÚBackgroundCŞÜ
 =

44 
	gR’d”ThemeChromiumLšux
::
m_šaùiveS–eùiÚFÜegroundCŞÜ
 =

47 
	gR’d”ThemeChromiumLšux
::
m_ÿ»tBlškIÁ”v®
;

49 
	gPassRefPŒ
<
	gR’d”Theme
> 
	gR’d”ThemeChromiumLšux
::
ü—‹
()

51  
adİtRef
(
Ãw
 
R’d”ThemeChromiumLšux
());

54 
	gPassRefPŒ
<
	gR’d”Theme
> R’d”Theme::
themeFÜPage
(
Page
* 
·ge
)

56 
R’d”Theme
* 
¹
 = 
R’d”ThemeChromiumLšux
::
ü—‹
().
»Ëa£Ref
();

57  
	g¹
;

60 
	gR’d”ThemeChromiumLšux
::
R’d”ThemeChromiumLšux
()

62 
m_ÿ»tBlškIÁ”v®
 = 
R’d”Theme
::
ÿ»tBlškIÁ”v®
();

65 
	gR’d”ThemeChromiumLšux
::~
R’d”ThemeChromiumLšux
()

69 
CŞÜ
 
R’d”ThemeChromiumLšux
::
sy¡emCŞÜ
(
cssV®ueId
) const

71 cÚ¡ 
CŞÜ
 
lšuxBu‰ÚG¿yCŞÜ
(0xffdddddd);

73 ià(
	gcssV®ueId
 =ğ
CSSV®ueBu‰Úçû
)

74  
lšuxBu‰ÚG¿yCŞÜ
;

75  
	gR’d”Theme
::
sy¡emCŞÜ
(
cssV®ueId
);

78 
SŒšg
 
	gR’d”ThemeChromiumLšux
::
exŒaDeçuÉStyËSh“t
()

80  
R’d”ThemeChromiumSkŸ
::
exŒaDeçuÉStyËSh“t
() +

81 
SŒšg
(
themeChromiumLšuxU£rAg’tStyËSh“t
, (themeChromiumLinuxUserAgentStyleSheet));

84 
boŞ
 
	gR’d”ThemeChromiumLšux
::
cÚŒŞSuµÜtsTšts
(cÚ¡ 
R’d”Objeù
* 
o
) const

86  
isEÇbËd
(
o
);

89 
CŞÜ
 
	gR’d”ThemeChromiumLšux
::
aùiveLi¡BoxS–eùiÚBackgroundCŞÜ
() const

91  
CŞÜ
(0x28, 0x28, 0x28);

94 
CŞÜ
 
	gR’d”ThemeChromiumLšux
::
aùiveLi¡BoxS–eùiÚFÜegroundCŞÜ
() const

96  
CŞÜ
::
bÏck
;

99 
CŞÜ
 
	gR’d”ThemeChromiumLšux
::
šaùiveLi¡BoxS–eùiÚBackgroundCŞÜ
() const

101  
CŞÜ
(0xc8, 0xc8, 0xc8);

104 
CŞÜ
 
	gR’d”ThemeChromiumLšux
::
šaùiveLi¡BoxS–eùiÚFÜegroundCŞÜ
() const

106  
CŞÜ
(0x32, 0x32, 0x32);

109 
CŞÜ
 
	gR’d”ThemeChromiumLšux
::
¶©fÜmAùiveS–eùiÚBackgroundCŞÜ
() const

111  
m_aùiveS–eùiÚBackgroundCŞÜ
;

114 
CŞÜ
 
	gR’d”ThemeChromiumLšux
::
¶©fÜmIÇùiveS–eùiÚBackgroundCŞÜ
() const

116  
m_šaùiveS–eùiÚBackgroundCŞÜ
;

119 
CŞÜ
 
	gR’d”ThemeChromiumLšux
::
¶©fÜmAùiveS–eùiÚFÜegroundCŞÜ
() const

121  
m_aùiveS–eùiÚFÜegroundCŞÜ
;

124 
CŞÜ
 
	gR’d”ThemeChromiumLšux
::
¶©fÜmIÇùiveS–eùiÚFÜegroundCŞÜ
() const

126  
m_šaùiveS–eùiÚFÜegroundCŞÜ
;

129 
	gR’d”ThemeChromiumLšux
::
adju¡Slid”ThumbSize
(
R’d”Objeù
* 
o
) const

132 cÚ¡ 
¦id”ThumbAlÚgAxis
 = 11;

133 cÚ¡ 
	g¦id”ThumbAüossAxis
 = 21;

134 ià(
	go
->
¡yË
()->
­³¬ªû
(è=ğ
Slid”ThumbHÜizÚlP¬t
) {

135 
o
->
¡yË
()->
£tWidth
(
L’gth
(
¦id”ThumbAlÚgAxis
, 
Fixed
));

136 
	go
->
¡yË
()->
£tHeight
(
L’gth
(
¦id”ThumbAüossAxis
, 
Fixed
));

137 } ià(
	go
->
¡yË
()->
­³¬ªû
(è=ğ
Slid”ThumbV”tiÿlP¬t
) {

138 
o
->
¡yË
()->
£tWidth
(
L’gth
(
¦id”ThumbAüossAxis
, 
Fixed
));

139 
	go
->
¡yË
()->
£tHeight
(
L’gth
(
¦id”ThumbAlÚgAxis
, 
Fixed
));

141 
	gR’d”ThemeChromiumSkŸ
::
adju¡Slid”ThumbSize
(
o
);

144 
boŞ
 
	gR’d”ThemeChromiumLšux
::
suµÜtsCÚŒŞTšts
() const

146  
Œue
;

149 
	gR’d”ThemeChromiumLšux
::
£tC¬‘BlškIÁ”v®
(
š‹rv®
)

151 
m_ÿ»tBlškIÁ”v®
 = 
š‹rv®
;

154 
	gR’d”ThemeChromiumLšux
::
ÿ»tBlškIÁ”v®IÁ”Çl
() const

156  
m_ÿ»tBlškIÁ”v®
;

159 
	gR’d”ThemeChromiumLšux
::
£tS–eùiÚCŞÜs
(

160 
aùiveBackgroundCŞÜ
,

161 
aùiveFÜegroundCŞÜ
,

162 
šaùiveBackgroundCŞÜ
,

163 
šaùiveFÜegroundCŞÜ
)

165 
	gm_aùiveS–eùiÚBackgroundCŞÜ
 = 
aùiveBackgroundCŞÜ
;

166 
	gm_aùiveS–eùiÚFÜegroundCŞÜ
 = 
aùiveFÜegroundCŞÜ
;

167 
	gm_šaùiveS–eùiÚBackgroundCŞÜ
 = 
šaùiveBackgroundCŞÜ
;

168 
	gm_šaùiveS–eùiÚFÜegroundCŞÜ
 = 
šaùiveFÜegroundCŞÜ
;

171 
	gR’d”ThemeChromiumLšux
::
£tSüŞlb¬CŞÜs
(

172 
SkCŞÜ
 
šaùiveCŞÜ
, SkCŞÜ 
aùiveCŞÜ
, SkCŞÜ 
ŒackCŞÜ
)

174 
	gm_thumbIÇùiveCŞÜ
 = 
šaùiveCŞÜ
;

175 
	gm_thumbAùiveCŞÜ
 = 
aùiveCŞÜ
;

176 
	gm_ŒackCŞÜ
 = 
ŒackCŞÜ
;

	@RenderThemeChromiumLinux.h

29 #iâdeà
R’d”ThemeChromiumLšux_h


30 
	#R’d”ThemeChromiumLšux_h


	)

32 
	~"R’d”ThemeChromiumSkŸ.h
"

34 
Çme¥aû
 
	gWebCÜe
 {

36 şas 
	cR’d”ThemeChromiumLšux
 : 
public
 
R’d”ThemeChromiumSkŸ
 {

37 
public
:

38 
PassRefPŒ
<
R’d”Theme
> 
ü—‹
();

39 
vœtu®
 
SŒšg
 
exŒaDeçuÉStyËSh“t
();

41 
vœtu®
 
CŞÜ
 
sy¡emCŞÜ
(
cssV®idId
) const;

44 
vœtu®
 
boŞ
 
cÚŒŞSuµÜtsTšts
(cÚ¡ 
R’d”Objeù
*) const;

47 
vœtu®
 
CŞÜ
 
aùiveLi¡BoxS–eùiÚBackgroundCŞÜ
() const;

48 
vœtu®
 
CŞÜ
 
aùiveLi¡BoxS–eùiÚFÜegroundCŞÜ
() const;

49 
vœtu®
 
CŞÜ
 
šaùiveLi¡BoxS–eùiÚBackgroundCŞÜ
() const;

50 
vœtu®
 
CŞÜ
 
šaùiveLi¡BoxS–eùiÚFÜegroundCŞÜ
() const;

52 
vœtu®
 
CŞÜ
 
¶©fÜmAùiveS–eùiÚBackgroundCŞÜ
() const;

53 
vœtu®
 
CŞÜ
 
¶©fÜmIÇùiveS–eùiÚBackgroundCŞÜ
() const;

54 
vœtu®
 
CŞÜ
 
¶©fÜmAùiveS–eùiÚFÜegroundCŞÜ
() const;

55 
vœtu®
 
CŞÜ
 
¶©fÜmIÇùiveS–eùiÚFÜegroundCŞÜ
() const;

57 
vœtu®
 
adju¡Slid”ThumbSize
(
R’d”Objeù
*) const;

59 
£tC¬‘BlškIÁ”v®
(
š‹rv®
);

60 
vœtu®
 
ÿ»tBlškIÁ”v®IÁ”Çl
() const;

62 
£tS–eùiÚCŞÜs
(
aùiveBackgroundCŞÜ
,

63 
aùiveFÜegroundCŞÜ
,

64 
šaùiveBackgroundCŞÜ
,

65 
šaùiveFÜegroundCŞÜ
);

67 
£tSüŞlb¬CŞÜs
(
šaùive_cŞÜ
,

68 
aùive_cŞÜ
,

69 
Œack_cŞÜ
);

70 
thumbIÇùiveCŞÜ
(è{  
	gm_thumbIÇùiveCŞÜ
; }

71 
thumbAùiveCŞÜ
(è{  
	gm_thumbAùiveCŞÜ
; }

72 
ŒackCŞÜ
(è{  
	gm_ŒackCŞÜ
; }

74 
	g´iv©e
:

75 
R’d”ThemeChromiumLšux
();

76 
	gvœtu®
 ~
R’d”ThemeChromiumLšux
();

79 
vœtu®
 
boŞ
 
suµÜtsCÚŒŞTšts
() const;

81 
	gm_ÿ»tBlškIÁ”v®
;

83 
	gm_aùiveS–eùiÚBackgroundCŞÜ
;

84 
	gm_aùiveS–eùiÚFÜegroundCŞÜ
;

85 
	gm_šaùiveS–eùiÚBackgroundCŞÜ
;

86 
	gm_šaùiveS–eùiÚFÜegroundCŞÜ
;

88 
	gm_thumbIÇùiveCŞÜ
;

89 
	gm_thumbAùiveCŞÜ
;

90 
	gm_ŒackCŞÜ
;

	@RenderThemeChromiumMac.h

24 #iâdeà
R’d”ThemeChromiumMac_h


25 
	#R’d”ThemeChromiumMac_h


	)

28 #impÜˆ<
wtf
/
HashM­
.
h
>

29 #impÜˆ<
wtf
/
R‘ašPŒ
.
h
>

31 #ifdeà
__OBJC__


32 @
şass
 
	gWebCÜeR’d”ThemeNÙifiÿtiÚOb£rv”
;

34 
şass
 
	gWebCÜeR’d”ThemeNÙifiÿtiÚOb£rv”
;

40 
Çme¥aû
 
	gWebCÜe
 {

42 
şass
 
	gR’d”StyË
;

44 şas 
	cR’d”ThemeChromiumMac
 : 
public
 
R’d”Theme
 {

45 
public
:

46 
PassRefPŒ
<
R’d”Theme
> 
ü—‹
();

49 
vœtu®
 
boŞ
 
cÚŒŞSuµÜtsTšts
(cÚ¡ 
R’d”Objeù
*) const;

52 
vœtu®
 
boŞ
 
suµÜtsCÚŒŞTšts
(ècÚ¡ {  
	gŒue
; }

54 
vœtu®
 
adju¡R•aštReù
(cÚ¡ 
R’d”Objeù
*, 
IÁReù
&);

56 
vœtu®
 
boŞ
 
isCÚŒŞStyËd
(cÚ¡ 
R’d”StyË
*, cÚ¡ 
BÜd”D©a
&,

57 cÚ¡ 
FlLay”
&, cÚ¡ 
CŞÜ
& 
backgroundCŞÜ
) const;

59 
vœtu®
 
CŞÜ
 
¶©fÜmAùiveS–eùiÚBackgroundCŞÜ
() const;

60 
vœtu®
 
CŞÜ
 
¶©fÜmIÇùiveS–eùiÚBackgroundCŞÜ
() const;

61 
vœtu®
 
CŞÜ
 
¶©fÜmAùiveLi¡BoxS–eùiÚBackgroundCŞÜ
() const;

62 
vœtu®
 
CŞÜ
 
¶©fÜmAùiveLi¡BoxS–eùiÚFÜegroundCŞÜ
() const;

63 
vœtu®
 
CŞÜ
 
¶©fÜmIÇùiveLi¡BoxS–eùiÚBackgroundCŞÜ
() const;

64 
vœtu®
 
CŞÜ
 
¶©fÜmIÇùiveLi¡BoxS–eùiÚFÜegroundCŞÜ
() const;

65 
vœtu®
 
CŞÜ
 
¶©fÜmFocusRšgCŞÜ
() const;

67 
vœtu®
 
SüŞlb¬CÚŒŞSize
 
süŞlb¬CÚŒŞSizeFÜP¬t
(
CÚŒŞP¬t
è{  
	gSm®lSüŞlb¬
; }

69 
vœtu®
 
¶©fÜmCŞÜsDidChªge
();

72 
vœtu®
 
sy¡emFÚt
(
cssV®ueId
, 
FÚtDesütiÚ
&) const;

74 
vœtu®
 
mšimumM’uLi¡Size
(
R’d”StyË
*) const;

76 
vœtu®
 
adju¡Slid”ThumbSize
(
R’d”Objeù
*) const;

78 
vœtu®
 
pİupIÁ”ÇlPaddšgLeá
(
R’d”StyË
*) const;

79 
vœtu®
 
pİupIÁ”ÇlPaddšgRight
(
R’d”StyË
*) const;

80 
vœtu®
 
pİupIÁ”ÇlPaddšgTİ
(
R’d”StyË
*) const;

81 
vœtu®
 
pİupIÁ”ÇlPaddšgBÙtom
(
R’d”StyË
*) const;

83 
vœtu®
 
boŞ
 
·štC­sLockIndiÿtÜ
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

85 
vœtu®
 
CŞÜ
 
sy¡emCŞÜ
(
cssV®ueId
) const;

87 
	g´Ùeùed
:

88 
vœtu®
 
boŞ
 
suµÜtsS–eùiÚFÜegroundCŞÜs
(ècÚ¡ {  
çl£
; }

90 
vœtu®
 
boŞ
 
·štTextF›ld
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

91 
vœtu®
 
adju¡TextF›ldStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

93 
vœtu®
 
boŞ
 
·štTextA»a
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

94 
vœtu®
 
adju¡TextA»aStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

96 
vœtu®
 
boŞ
 
·štM’uLi¡
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

97 
vœtu®
 
adju¡M’uLi¡StyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

99 
vœtu®
 
boŞ
 
·štM’uLi¡Bu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

100 
vœtu®
 
adju¡M’uLi¡Bu‰ÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

102 
vœtu®
 
boŞ
 
·štSlid”T¿ck
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

103 
vœtu®
 
adju¡Slid”T¿ckStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

105 
vœtu®
 
boŞ
 
·štSlid”Thumb
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

106 
vœtu®
 
adju¡Slid”ThumbStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

108 
vœtu®
 
boŞ
 
·štS—rchF›ld
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

109 
vœtu®
 
adju¡S—rchF›ldStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

111 
vœtu®
 
adju¡S—rchF›ldCªûlBu‰ÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

112 
vœtu®
 
boŞ
 
·štS—rchF›ldCªûlBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

114 
vœtu®
 
adju¡S—rchF›ldDecÜ©iÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

115 
vœtu®
 
boŞ
 
·štS—rchF›ldDecÜ©iÚ
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

117 
vœtu®
 
adju¡S—rchF›ldResuÉsDecÜ©iÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

118 
vœtu®
 
boŞ
 
·štS—rchF›ldResuÉsDecÜ©iÚ
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

120 
vœtu®
 
adju¡S—rchF›ldResuÉsBu‰ÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

121 
vœtu®
 
boŞ
 
·štS—rchF›ldResuÉsBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

123 #ià
ENABLE
(
VIDEO
)

124 
vœtu®
 
boŞ
 
shouldR’d”MedŸCÚŒŞP¬t
(
CÚŒŞP¬t
, 
EËm’t
*);

125 
vœtu®
 
boŞ
 
·štMedŸPÏyBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

126 
vœtu®
 
boŞ
 
·štMedŸMu‹Bu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

127 
vœtu®
 
boŞ
 
·štMedŸSlid”T¿ck
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

128 
vœtu®
 
boŞ
 
·štMedŸSlid”Thumb
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

129 
vœtu®
 
boŞ
 
·štMedŸVŞumeSlid”T¿ck
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

130 
vœtu®
 
boŞ
 
·štMedŸVŞumeSlid”Thumb
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

131 
vœtu®
 
boŞ
 
·štMedŸCÚŒŞsBackground
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

134 
vœtu®
 
SŒšg
 
exŒaMedŸCÚŒŞsStyËSh“t
();

137 
	g´iv©e
:

138 
R’d”ThemeChromiumMac
();

139 
	gvœtu®
 ~
R’d”ThemeChromiumMac
();

141 
IÁReù
 
šæ©eReù
(cÚ¡ IÁReù&, cÚ¡ 
IÁSize
&, cÚ¡ * 
m¬gšs
, 
zoomLev–
 = 1.0f) const;

143 
FlßtReù
 
cÚv”tToPaštšgReù
(cÚ¡ 
R’d”Objeù
* 
šputR’d””
, cÚ¡ R’d”Objeù* 
·¹R’d””
, cÚ¡ FlßtReù& 
šputReù
, cÚ¡ 
IÁReù
& 
r
) const;

146 
NSCÚŒŞSize
 
cÚŒŞSizeFÜFÚt
(
R’d”StyË
*) const;

147 
NSCÚŒŞSize
 
cÚŒŞSizeFÜSy¡emFÚt
(
R’d”StyË
*) const;

148 
£tCÚŒŞSize
(
NSC–l
*, cÚ¡ 
IÁSize
* 
sizes
, cÚ¡ IÁSize& 
mšSize
, 
zoomLev–
 = 1.0f);

149 
£tSizeFromFÚt
(
R’d”StyË
*, cÚ¡ 
IÁSize
* 
sizes
) const;

150 
IÁSize
 
sizeFÜFÚt
(
R’d”StyË
*, cÚ¡ IÁSize* 
sizes
) const;

151 
IÁSize
 
sizeFÜSy¡emFÚt
(
R’d”StyË
*, cÚ¡ IÁSize* 
sizes
) const;

152 
£tFÚtFromCÚŒŞSize
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
NSCÚŒŞSize
) const;

154 
upd©eAùiveS‹
(
NSC–l
*, cÚ¡ 
R’d”Objeù
*);

155 
upd©eCheckedS‹
(
NSC–l
*, cÚ¡ 
R’d”Objeù
*);

156 
upd©eEÇbËdS‹
(
NSC–l
*, cÚ¡ 
R’d”Objeù
*);

157 
upd©eFocu£dS‹
(
NSC–l
*, cÚ¡ 
R’d”Objeù
*);

158 
upd©eP»s£dS‹
(
NSC–l
*, cÚ¡ 
R’d”Objeù
*);

162 
£tPİupBu‰ÚC–lS‹
(cÚ¡ 
R’d”Objeù
*, cÚ¡ 
IÁReù
&);

163 cÚ¡ 
IÁSize
* 
pİupBu‰ÚSizes
() const;

164 cÚ¡ * 
pİupBu‰ÚM¬gšs
() const;

165 cÚ¡ * 
pİupBu‰ÚPaddšg
(
NSCÚŒŞSize
) const;

166 
·štM’uLi¡Bu‰ÚG¿d›Ás
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

167 cÚ¡ 
IÁSize
* 
m’uLi¡Sizes
() const;

169 cÚ¡ 
IÁSize
* 
£¬chF›ldSizes
() const;

170 cÚ¡ 
IÁSize
* 
ÿnûlBu‰ÚSizes
() const;

171 cÚ¡ 
IÁSize
* 
»suÉsBu‰ÚSizes
() const;

172 
£tS—rchC–lS‹
(
R’d”Objeù
*, cÚ¡ 
IÁReù
&);

173 
£tS—rchF›ldSize
(
R’d”StyË
*) const;

175 
NSPİUpBu‰ÚC–l
* 
pİupBu‰Ú
() const;

176 
NSS—rchF›ldC–l
* 
£¬ch
() const;

177 
NSM’u
* 
£¬chM’uTem¶©e
() const;

178 
NSSlid”C–l
* 
¦id”ThumbHÜizÚl
() const;

179 
NSSlid”C–l
* 
¦id”ThumbV”tiÿl
() const;

181 
	g´iv©e
:

182 
mubË
 
R‘ašPŒ
<
NSPİUpBu‰ÚC–l
> 
m_pİupBu‰Ú
;

183 
mubË
 
	gR‘ašPŒ
<
	gNSS—rchF›ldC–l
> 
	gm_£¬ch
;

184 
mubË
 
	gR‘ašPŒ
<
	gNSM’u
> 
	gm_£¬chM’uTem¶©e
;

185 
mubË
 
	gR‘ašPŒ
<
	gNSSlid”C–l
> 
	gm_¦id”ThumbHÜizÚl
;

186 
mubË
 
	gR‘ašPŒ
<
	gNSSlid”C–l
> 
	gm_¦id”ThumbV”tiÿl
;

188 
boŞ
 
	gm_isSlid”ThumbHÜizÚlP»s£d
;

189 
boŞ
 
	gm_isSlid”ThumbV”tiÿlP»s£d
;

191 
mubË
 
	gHashM­
<, 
	gRGBA32
> 
	gm_sy¡emCŞÜCache
;

193 
	gR‘ašPŒ
<
	gWebCÜeR’d”ThemeNÙifiÿtiÚOb£rv”
> 
	gm_nÙifiÿtiÚOb£rv”
;

	@RenderThemeChromiumSkia.cpp

24 
	~"cÚfig.h
"

25 
	~"R’d”ThemeChromiumSkŸ.h
"

27 
	~"ChromiumBridge.h
"

28 
	~"CSSV®ueKeywÜds.h
"

29 
	~"G¿phicsCÚ‹xt.h
"

30 
	~"HTMLMedŸEËm’t.h
"

31 
	~"HTMLNames.h
"

32 
	~"Image.h
"

33 
	~"MedŸCÚŒŞEËm’ts.h
"

34 
	~"PÏtfÜmCÚ‹xtSkŸ.h
"

35 
	~"R’d”Box.h
"

36 
	~"R’d”MedŸCÚŒŞsChromium.h
"

37 
	~"R’d”Objeù.h
"

38 
	~"R’d”Slid”.h
"

39 
	~"SüŞlb¬Theme.h
"

40 
	~"TimeRªges.h
"

41 
	~"T¿nsfÜm©iÚM©rix.h
"

42 
	~"U£rAg’tStyËSh“ts.h
"

44 
	~"SkShad”.h
"

45 
	~"SkG¿d›ÁShad”.h
"

47 
Çme¥aû
 
	gWebCÜe
 {

49 
	ePaddšgTy³
 {

50 
	gTİPaddšg
,

51 
	gRightPaddšg
,

52 
	gBÙtomPaddšg
,

53 
	gLeáPaddšg


56 cÚ¡ 
	g¡yËdM’uLi¡IÁ”ÇlPaddšg
[4] = { 1, 4, 1, 4 };

59 cÚ¡ 
	gdeçuÉCÚŒŞFÚtPix–Size
 = 13;

60 cÚ¡ 
	gdeçuÉCªûlBu‰ÚSize
 = 9;

61 cÚ¡ 
	gmšCªûlBu‰ÚSize
 = 5;

62 cÚ¡ 
	gmaxCªûlBu‰ÚSize
 = 21;

63 cÚ¡ 
	gdeçuÉS—rchF›ldResuÉsDecÜ©iÚSize
 = 13;

64 cÚ¡ 
	gmšS—rchF›ldResuÉsDecÜ©iÚSize
 = 9;

65 cÚ¡ 
	gmaxS—rchF›ldResuÉsDecÜ©iÚSize
 = 30;

66 cÚ¡ 
	gdeçuÉS—rchF›ldResuÉsBu‰ÚWidth
 = 18;

68 
£tSizeIfAuto
(
R’d”StyË
* 
¡yË
, cÚ¡ 
IÁSize
& 
size
)

70 ià(
	g¡yË
->
width
().
isIÁršsicOrAuto
())

71 
	g¡yË
->
£tWidth
(
L’gth
(
size
.
width
(), 
Fixed
));

72 ià(
	g¡yË
->
height
().
isAuto
())

73 
	g¡yË
->
£tHeight
(
L’gth
(
size
.
height
(), 
Fixed
));

76 
d¿wV”tLše
(
SkCªvas
* 
ÿnvas
, 
x
, 
y1
, 
y2
, cÚ¡ 
SkPašt
& 
·št
)

78 
SkIReù
 
	gsk»ù
;

79 
	gsk»ù
.
£t
(
x
, 
y1
, x + 1, 
y2
 + 1);

80 
	gÿnvas
->
d¿wIReù
(
sk»ù
, 
·št
);

83 
d¿wHÜizLše
(
SkCªvas
* 
ÿnvas
, 
x1
, 
x2
, 
y
, cÚ¡ 
SkPašt
& 
·št
)

85 
SkIReù
 
	gsk»ù
;

86 
	gsk»ù
.
£t
(
x1
, 
y
, 
x2
 + 1, y + 1);

87 
	gÿnvas
->
d¿wIReù
(
sk»ù
, 
·št
);

90 
d¿wBox
(
SkCªvas
* 
ÿnvas
, cÚ¡ 
IÁReù
& 
»ù
, cÚ¡ 
SkPašt
& 
·št
)

92 cÚ¡ 
	gright
 = 
»ù
.
x
(è+„eù.
width
() - 1;

93 cÚ¡ 
	gbÙtom
 = 
»ù
.
y
(è+„eù.
height
() - 1;

94 
d¿wHÜizLše
(
ÿnvas
, 
»ù
.
x
(), 
right
,„eù.
y
(), 
·št
);

95 
d¿wV”tLše
(
ÿnvas
, 
right
, 
»ù
.
y
(), 
bÙtom
, 
·št
);

96 
d¿wHÜizLše
(
ÿnvas
, 
»ù
.
x
(), 
right
, 
bÙtom
, 
·št
);

97 
d¿wV”tLše
(
ÿnvas
, 
»ù
.
x
(),„eù.
y
(), 
bÙtom
, 
·št
);

109 cÚ¡ 
	gSŒšg
& 
	gR’d”ThemeChromiumSkŸ
::
deçuÉGUIFÚt
()

111 
DEFINE_STATIC_LOCAL
(
SŒšg
, 
fÚtFaû
, ("Arial"));

112  
	gfÚtFaû
;

115 
	gR’d”ThemeChromiumSkŸ
::
deçuÉFÚtSize
 = 16.0;

117 
	gR’d”ThemeChromiumSkŸ
::
R’d”ThemeChromiumSkŸ
()

121 
R’d”ThemeChromiumSkŸ
::~RenderThemeChromiumSkia()

126 
SŒšg
 
R’d”ThemeChromiumSkŸ
::
exŒaDeçuÉStyËSh“t
()

128  
SŒšg
(
themeWšU£rAg’tStyËSh“t
, (themeWinUserAgentStyleSheet));

131 
SŒšg
 
	gR’d”ThemeChromiumSkŸ
::
exŒaQuœksStyËSh“t
()

133  
SŒšg
(
themeWšQuœksU£rAg’tStyËSh“t
, (themeWinQuirksUserAgentStyleSheet));

136 #ià
ENABLE
(
VIDEO
)

137 
SŒšg
 
	gR’d”ThemeChromiumSkŸ
::
exŒaMedŸCÚŒŞsStyËSh“t
()

139  
SŒšg
(
medŸCÚŒŞsChromiumU£rAg’tStyËSh“t
, (mediaControlsChromiumUserAgentStyleSheet));

143 
boŞ
 
	gR’d”ThemeChromiumSkŸ
::
suµÜtsHov”
(cÚ¡ 
R’d”StyË
* 
¡yË
) const

145  
Œue
;

148 
boŞ
 
	gR’d”ThemeChromiumSkŸ
::
suµÜtsFocusRšg
(cÚ¡ 
R’d”StyË
* 
¡yË
) const

151  
çl£
;

154 
CŞÜ
 
	gR’d”ThemeChromiumSkŸ
::
¶©fÜmAùiveS–eùiÚBackgroundCŞÜ
() const

156  
CŞÜ
(0x1e, 0x90, 0xff);

159 
CŞÜ
 
	gR’d”ThemeChromiumSkŸ
::
¶©fÜmIÇùiveS–eùiÚBackgroundCŞÜ
() const

161  
CŞÜ
(0xc8, 0xc8, 0xc8);

164 
CŞÜ
 
	gR’d”ThemeChromiumSkŸ
::
¶©fÜmAùiveS–eùiÚFÜegroundCŞÜ
() const

166  
CŞÜ
::
bÏck
;

169 
CŞÜ
 
	gR’d”ThemeChromiumSkŸ
::
¶©fÜmIÇùiveS–eùiÚFÜegroundCŞÜ
() const

171  
CŞÜ
(0x32, 0x32, 0x32);

174 
CŞÜ
 
	gR’d”ThemeChromiumSkŸ
::
¶©fÜmFocusRšgCŞÜ
() const

176 
CŞÜ
 
focusRšgCŞÜ
(229, 151, 0, 255);

177  
	gfocusRšgCŞÜ
;

180 
	gR’d”ThemeChromiumSkŸ
::
ÿ»tBlškIÁ”v®
() const

184 ià(
ChromiumBridge
::
ÏyoutTe¡Mode
())

187  
ÿ»tBlškIÁ”v®IÁ”Çl
();

190 
	gR’d”ThemeChromiumSkŸ
::
sy¡emFÚt
(
´İId
, 
FÚtDesütiÚ
& 
fÚtDesütiÚ
) const

192 
	gfÚtSize
 = 
deçuÉFÚtSize
;

194 
	g´İId
) {

195 
	gCSSV®ueWebk™MšiCÚŒŞ
:

196 
CSSV®ueWebk™Sm®lCÚŒŞ
:

197 
CSSV®ueWebk™CÚŒŞ
:

201 cÚ¡ 
poštsP”Inch
 = 72.0f;

202 cÚ¡ 
	gpix–sP”Inch
 = 96.0f;

203 
	gfÚtSize
 -ğ(2.0à/ 
poštsP”Inch
è* 
pix–sP”Inch
;

207 
	gfÚtDesütiÚ
.
fœ¡Famy
().
£tFamy
(
deçuÉGUIFÚt
());

208 
	gfÚtDesütiÚ
.
£tS³cif›dSize
(
fÚtSize
);

209 
	gfÚtDesütiÚ
.
£tIsAbsŞu‹Size
(
Œue
);

210 
	gfÚtDesütiÚ
.
£tG’”icFamy
(
FÚtDesütiÚ
::
NoFamy
);

211 
	gfÚtDesütiÚ
.
£tWeight
(
FÚtWeightNÜm®
);

212 
	gfÚtDesütiÚ
.
£tIlic
(
çl£
);

215 
	gR’d”ThemeChromiumSkŸ
::
mšimumM’uLi¡Size
(
R’d”StyË
* 
¡yË
) const

221 cÚ¡ 
	gwidg‘Snd¬dWidth
 = 13;

222 cÚ¡ 
	gwidg‘Snd¬dHeight
 = 13;

226 
IÁReù
 
ûÁ”
(cÚ¡ IÁReù& 
Üigš®
, 
width
, 
height
)

228 
	gwidth
 = 
¡d
::
mš
(
Üigš®
.
width
(), width);

229 
	gheight
 = 
¡d
::
mš
(
Üigš®
.
height
(), height);

230 
	gx
 = 
Üigš®
.
x
(è+ (Üigš®.
width
() - width) / 2;

231 
	gy
 = 
Üigš®
.
y
(è+ (Üigš®.
height
() - height) / 2;

233  
IÁReù
(
x
, 
y
, 
width
, 
height
);

236 
boŞ
 
	gR’d”ThemeChromiumSkŸ
::
·štCheckbox
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
»ù
)

238 
Image
* cÚ¡ 
	gcheckedImage
 = Image::
lßdPÏtfÜmResourû
("lšuxCheckboxOn").
»Ëa£Ref
();

239 
Image
* cÚ¡ 
	guncheckedImage
 = Image::
lßdPÏtfÜmResourû
("lšuxCheckboxOff").
»Ëa£Ref
();

240 
Image
* cÚ¡ 
	gdi§bËdCheckedImage
 = Image::
lßdPÏtfÜmResourû
("lšuxCheckboxDi§bËdOn").
»Ëa£Ref
();

241 
Image
* cÚ¡ 
	gdi§bËdUncheckedImage
 = Image::
lßdPÏtfÜmResourû
("lšuxCheckboxDi§bËdOff").
»Ëa£Ref
();

243 
Image
* 
	gimage
;

245 ià(
	gthis
->
isEÇbËd
(
o
))

246 
	gimage
 = 
this
->
isChecked
(
o
è? 
checkedImage
 : 
uncheckedImage
;

248 
	gimage
 = 
this
->
isChecked
(
o
è? 
di§bËdCheckedImage
 : 
di§bËdUncheckedImage
;

250 
	gi
.
	gcÚ‹xt
->
d¿wImage
(
image
, 
o
->
¡yË
()->
cŞÜS·û
(), 
ûÁ”
(
»ù
, 
widg‘Snd¬dHeight
, 
widg‘Snd¬dWidth
));

251  
	gçl£
;

254 
	gR’d”ThemeChromiumSkŸ
::
£tCheckboxSize
(
R’d”StyË
* 
¡yË
) const

257 ià(!
¡yË
->
width
().
isIÁršsicOrAuto
(è&& !¡yË->
height
().
isAuto
())

265 cÚ¡ 
IÁSize
 
size
(
widg‘Snd¬dHeight
, 
widg‘Snd¬dWidth
);

266 
£tSizeIfAuto
(
¡yË
, 
size
);

269 
boŞ
 
	gR’d”ThemeChromiumSkŸ
::
·štRadio
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
»ù
)

271 
Image
* cÚ¡ 
	gcheckedImage
 = Image::
lßdPÏtfÜmResourû
("lšuxRadioOn").
»Ëa£Ref
();

272 
Image
* cÚ¡ 
	guncheckedImage
 = Image::
lßdPÏtfÜmResourû
("lšuxRadioOff").
»Ëa£Ref
();

273 
Image
* cÚ¡ 
	gdi§bËdCheckedImage
 = Image::
lßdPÏtfÜmResourû
("lšuxRadioDi§bËdOn").
»Ëa£Ref
();

274 
Image
* cÚ¡ 
	gdi§bËdUncheckedImage
 = Image::
lßdPÏtfÜmResourû
("lšuxRadioDi§bËdOff").
»Ëa£Ref
();

276 
Image
* 
	gimage
;

277 ià(
	gthis
->
isEÇbËd
(
o
))

278 
	gimage
 = 
this
->
isChecked
(
o
è? 
checkedImage
 : 
uncheckedImage
;

280 
	gimage
 = 
this
->
isChecked
(
o
è? 
di§bËdCheckedImage
 : 
di§bËdUncheckedImage
;

282 
	gi
.
	gcÚ‹xt
->
d¿wImage
(
image
, 
o
->
¡yË
()->
cŞÜS·û
(), 
ûÁ”
(
»ù
, 
widg‘Snd¬dHeight
, 
widg‘Snd¬dWidth
));

283  
	gçl£
;

286 
	gR’d”ThemeChromiumSkŸ
::
£tRadioSize
(
R’d”StyË
* 
¡yË
) const

289 
£tCheckboxSize
(
¡yË
);

292 
SkCŞÜ
 
brigh‹nCŞÜ
(
h
, 
s
, 
l
, 
brigh‹nAmouÁ
)

294 
	gl
 +ğ
brigh‹nAmouÁ
;

295 ià(
	gl
 > 1.0)

296 
	gl
 = 1.0;

297 ià(
	gl
 < 0.0)

298 
	gl
 = 0.0;

300  
makeRGBAFromHSLA
(
h
, 
s
, 
l
, 1.0);

303 
·štBu‰ÚLike
(
R’d”Theme
* 
theme
, 
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
»ù
)

305 
SkCªvas
* cÚ¡ 
	gÿnvas
 = 
i
.
cÚ‹xt
->
¶©fÜmCÚ‹xt
()->
ÿnvas
();

306 
SkPašt
 
	g·št
;

307 
SkReù
 
	gsk»ù
;

308 cÚ¡ 
	gright
 = 
»ù
.
x
(è+„eù.
width
();

309 cÚ¡ 
	gbÙtom
 = 
»ù
.
y
(è+„eù.
height
();

310 
SkCŞÜ
 
	gba£CŞÜ
 = 
SkCŞÜS‘ARGB
(0xff, 0xdd, 0xdd, 0xdd);

311 ià(
	go
->
¡yË
()->
hasBackground
())

312 
	gba£CŞÜ
 = 
o
->
¡yË
()->
backgroundCŞÜ
().
rgb
();

313 
	gh
, 
	gs
, 
	gl
;

314 
CŞÜ
(
ba£CŞÜ
).
g‘HSL
(
h
, 
s
, 
l
);

317 
SkCŞÜ
 
lightCŞÜ
(
brigh‹nCŞÜ
(
h
, 
s
, 
l
, 0.105));

320 ià(
	g»ù
.
width
(è< 5 ||„eù.
height
() < 5) {

321 
	g·št
.
£tCŞÜ
(
ba£CŞÜ
);

322 
	gsk»ù
.
£t
(
»ù
.
x
(),„eù.
y
(), 
right
, 
bÙtom
);

323 
	gÿnvas
->
d¿wReù
(
sk»ù
, 
·št
);

327 cÚ¡ 
	gbÜd”AÍha
 = 
theme
->
isHov”ed
(
o
) ? 0x80 : 0x55;

328 
	g·št
.
£tARGB
(
bÜd”AÍha
, 0, 0, 0);

329 
	gÿnvas
->
d¿wLše
(
»ù
.
x
(è+ 1,„eù.
y
(), 
right
 - 1,„eù.y(), 
·št
);

330 
	gÿnvas
->
d¿wLše
(
right
 - 1, 
»ù
.
y
(è+ 1,„ighˆ- 1, 
bÙtom
 - 1, 
·št
);

331 
	gÿnvas
->
d¿wLše
(
»ù
.
x
(è+ 1, 
bÙtom
 - 1, 
right
 - 1, bÙtom - 1, 
·št
);

332 
	gÿnvas
->
d¿wLše
(
»ù
.
x
(),„eù.
y
(è+ 1,„eù.x(), 
bÙtom
 - 1, 
·št
);

334 
	g·št
.
£tCŞÜ
(
SK_CŞÜBLACK
);

335 
SkPošt
 
	gp
[2];

336 cÚ¡ 
	glightEnd
 = 
theme
->
isP»s£d
(
o
) ? 1 : 0;

337 cÚ¡ 
	gd¬kEnd
 = !
lightEnd
;

338 
	gp
[
lightEnd
].
£t
(
SkIÁToSÿÏr
(
»ù
.
x
()), SkIÁToSÿÏrÔeù.
y
()));

339 
	gp
[
d¬kEnd
].
£t
(
SkIÁToSÿÏr
(
»ù
.
x
()), SkIÁToSÿÏr(
bÙtom
 - 1));

340 
SkCŞÜ
 
	gcŞÜs
[2];

341 
	gcŞÜs
[0] = 
lightCŞÜ
;

342 
	gcŞÜs
[1] = 
ba£CŞÜ
;

344 
SkShad”
* 
	gshad”
 = 
SkG¿d›ÁShad”
::
C»©eLš—r
(

345 
p
, 
cŞÜs
, 
NULL
, 2, 
SkShad”
::
kCÏmp_TeMode
, NULL);

346 
	g·št
.
£tStyË
(
SkPašt
::
kFl_StyË
);

347 
	g·št
.
£tShad”
(
shad”
);

348 
	gshad”
->
uÄef
();

350 
	gsk»ù
.
£t
(
»ù
.
x
(è+ 1,„eù.
y
(è+ 1, 
right
 - 1, 
bÙtom
 - 1);

351 
	gÿnvas
->
d¿wReù
(
sk»ù
, 
·št
);

353 
	g·št
.
£tShad”
(
NULL
);

354 
	g·št
.
£tCŞÜ
(
brigh‹nCŞÜ
(
h
, 
s
, 
l
, -0.0588));

355 
	gÿnvas
->
d¿wPošt
(
»ù
.
x
(è+ 1,„eù.
y
(è+ 1, 
·št
);

356 
	gÿnvas
->
d¿wPošt
(
right
 - 2, 
»ù
.
y
(è+ 1, 
·št
);

357 
	gÿnvas
->
d¿wPošt
(
»ù
.
x
(è+ 1, 
bÙtom
 - 2, 
·št
);

358 
	gÿnvas
->
d¿wPošt
(
right
 - 2, 
bÙtom
 - 2, 
·št
);

361 
boŞ
 
	gR’d”ThemeChromiumSkŸ
::
·štBu‰Ú
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
»ù
)

363 
·štBu‰ÚLike
(
this
, 
o
, 
i
, 
»ù
);

364  
	gçl£
;

367 
	gR’d”ThemeChromiumSkŸ
::
adju¡Bu‰ÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
* 
¡yË
, 
EËm’t
*) const

369 ià(
	g¡yË
->
­³¬ªû
(è=ğ
PushBu‰ÚP¬t
) {

371 
¡yË
->
£tLšeHeight
(
R’d”StyË
::
š™ŸlLšeHeight
());

376 
boŞ
 
	gR’d”ThemeChromiumSkŸ
::
·štTextF›ld
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
»ù
)

378  
	gŒue
;

381 
boŞ
 
	gR’d”ThemeChromiumSkŸ
::
·štTextA»a
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
r
)

383  
·štTextF›ld
(
o
, 
i
, 
r
);

386 
	gR’d”ThemeChromiumSkŸ
::
adju¡S—rchF›ldStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
* 
¡yË
, 
EËm’t
*) const

389 
	g¡yË
->
£tLšeHeight
(
R’d”StyË
::
š™ŸlLšeHeight
());

392 
boŞ
 
	gR’d”ThemeChromiumSkŸ
::
·štS—rchF›ld
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
r
)

394  
·štTextF›ld
(
o
, 
i
, 
r
);

397 
	gR’d”ThemeChromiumSkŸ
::
adju¡S—rchF›ldCªûlBu‰ÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
* 
¡yË
, 
EËm’t
*) const

400 
	gfÚtSÿË
 = 
¡yË
->
fÚtSize
(è/ 
deçuÉCÚŒŞFÚtPix–Size
;

401 
	gÿnûlBu‰ÚSize
 = 
Ìoundf
(
¡d
::
mš
(¡d::
max
(
mšCªûlBu‰ÚSize
, 
deçuÉCªûlBu‰ÚSize
 * 
fÚtSÿË
), 
maxCªûlBu‰ÚSize
));

402 
	g¡yË
->
£tWidth
(
L’gth
(
ÿnûlBu‰ÚSize
, 
Fixed
));

403 
	g¡yË
->
£tHeight
(
L’gth
(
ÿnûlBu‰ÚSize
, 
Fixed
));

406 
IÁReù
 
	gR’d”ThemeChromiumSkŸ
::
cÚv”tToPaštšgReù
(
R’d”Objeù
* 
šputR’d””
, cÚ¡ R’d”Objeù* 
·¹R’d””
, IÁReù 
·¹Reù
, cÚ¡ IÁReù& 
loÿlOff£t
) const

409 
IÁSize
 
	goff£tFromIÅutR’d””
 = -(
·¹R’d””
->
off£tFromAnû¡ÜCÚš”
(
šputR’d””
));

411 
	g·¹Reù
.
move
(
off£tFromIÅutR’d””
);

413 
	g·¹Reù
.
move
(
loÿlOff£t
.
x
(),†oÿlOff£t.
y
());

415  
	g·¹Reù
;

418 
boŞ
 
	gR’d”ThemeChromiumSkŸ
::
·štS—rchF›ldCªûlBu‰Ú
(
R’d”Objeù
* 
ÿnûlBu‰ÚObjeù
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

421 
Node
* 
	gšput
 = 
ÿnûlBu‰ÚObjeù
->
node
()->
shadowAnû¡ÜNode
();

422 ià(!
	gšput
->
»nd””
()->
isBox
())

423  
	gçl£
;

424 
R’d”Box
* 
	gšputR’d”Box
 = 
toR’d”Box
(
šput
->
»nd””
());

425 
IÁReù
 
	gšputCÚ‹ÁBox
 = 
šputR’d”Box
->
cÚ‹ÁBoxReù
();

428 
	gÿnûlBu‰ÚSize
 = 
¡d
::
mš
(
šputCÚ‹ÁBox
.
width
(), std::mš(šputCÚ‹ÁBox.
height
(), 
r
.height()));

432 
IÁReù
 
ÿnûlBu‰ÚReù
(
ÿnûlBu‰ÚObjeù
->
off£tFromAnû¡ÜCÚš”
(
šputR’d”Box
).
width
(),

433 
šputCÚ‹ÁBox
.
y
(è+ (šputCÚ‹ÁBox.
height
(è- 
ÿnûlBu‰ÚSize
 + 1) / 2,

434 
ÿnûlBu‰ÚSize
, cancelButtonSize);

435 
IÁReù
 
	g·štšgReù
 = 
cÚv”tToPaštšgReù
(
šputR’d”Box
, 
ÿnûlBu‰ÚObjeù
, 
ÿnûlBu‰ÚReù
, 
r
);

437 
Image
* 
	gÿnûlImage
 = Image::
lßdPÏtfÜmResourû
("£¬chCªûl").
»Ëa£Ref
();

438 
Image
* 
	gÿnûlP»s£dImage
 = Image::
lßdPÏtfÜmResourû
("£¬chCªûlP»s£d").
»Ëa£Ref
();

439 
	g·štInfo
.
	gcÚ‹xt
->
d¿wImage
(
isP»s£d
(
ÿnûlBu‰ÚObjeù
è? 
ÿnûlP»s£dImage
 : 
ÿnûlImage
,

440 
ÿnûlBu‰ÚObjeù
->
¡yË
()->
cŞÜS·û
(), 
·štšgReù
);

441  
	gçl£
;

444 
	gR’d”ThemeChromiumSkŸ
::
adju¡S—rchF›ldDecÜ©iÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
* 
¡yË
, 
EËm’t
*) const

446 
IÁSize
 
em±ySize
(1, 11);

447 
	g¡yË
->
£tWidth
(
L’gth
(
em±ySize
.
width
(), 
Fixed
));

448 
	g¡yË
->
£tHeight
(
L’gth
(
em±ySize
.
height
(), 
Fixed
));

451 
	gR’d”ThemeChromiumSkŸ
::
adju¡S—rchF›ldResuÉsDecÜ©iÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
* 
¡yË
, 
EËm’t
*) const

454 
	gfÚtSÿË
 = 
¡yË
->
fÚtSize
(è/ 
deçuÉCÚŒŞFÚtPix–Size
;

455 
	gmagnif›rSize
 = 
Ìoundf
(
¡d
::
mš
(¡d::
max
(
mšS—rchF›ldResuÉsDecÜ©iÚSize
, 
deçuÉS—rchF›ldResuÉsDecÜ©iÚSize
 * 
fÚtSÿË
),

456 
maxS—rchF›ldResuÉsDecÜ©iÚSize
));

457 
	g¡yË
->
£tWidth
(
L’gth
(
magnif›rSize
, 
Fixed
));

458 
	g¡yË
->
£tHeight
(
L’gth
(
magnif›rSize
, 
Fixed
));

461 
boŞ
 
	gR’d”ThemeChromiumSkŸ
::
·štS—rchF›ldResuÉsDecÜ©iÚ
(
R’d”Objeù
* 
magnif›rObjeù
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

464 
Node
* 
	gšput
 = 
magnif›rObjeù
->
node
()->
shadowAnû¡ÜNode
();

465 ià(!
	gšput
->
»nd””
()->
isBox
())

466  
	gçl£
;

467 
R’d”Box
* 
	gšputR’d”Box
 = 
toR’d”Box
(
šput
->
»nd””
());

468 
IÁReù
 
	gšputCÚ‹ÁBox
 = 
šputR’d”Box
->
cÚ‹ÁBoxReù
();

471 
	gmagnif›rSize
 = 
¡d
::
mš
(
šputCÚ‹ÁBox
.
width
(), std::mš(šputCÚ‹ÁBox.
height
(), 
r
.height()));

475 
IÁReù
 
magnif›rReù
(
magnif›rObjeù
->
off£tFromAnû¡ÜCÚš”
(
šputR’d”Box
).
width
(),

476 
šputCÚ‹ÁBox
.
y
(è+ (šputCÚ‹ÁBox.
height
(è- 
magnif›rSize
 + 1) / 2,

477 
magnif›rSize
, magnifierSize);

478 
IÁReù
 
	g·štšgReù
 = 
cÚv”tToPaštšgReù
(
šputR’d”Box
, 
magnif›rObjeù
, 
magnif›rReù
, 
r
);

480 
Image
* 
	gmagnif›rImage
 = Image::
lßdPÏtfÜmResourû
("£¬chMagnif›r").
»Ëa£Ref
();

481 
	g·štInfo
.
	gcÚ‹xt
->
d¿wImage
(
magnif›rImage
, 
magnif›rObjeù
->
¡yË
()->
cŞÜS·û
(), 
·štšgReù
);

482  
	gçl£
;

485 
	gR’d”ThemeChromiumSkŸ
::
adju¡S—rchF›ldResuÉsBu‰ÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
* 
¡yË
, 
EËm’t
*) const

488 
	gfÚtSÿË
 = 
¡yË
->
fÚtSize
(è/ 
deçuÉCÚŒŞFÚtPix–Size
;

489 
	gmagnif›rHeight
 = 
Ìoundf
(
¡d
::
mš
(¡d::
max
(
mšS—rchF›ldResuÉsDecÜ©iÚSize
, 
deçuÉS—rchF›ldResuÉsDecÜ©iÚSize
 * 
fÚtSÿË
),

490 
maxS—rchF›ldResuÉsDecÜ©iÚSize
));

491 
	gmagnif›rWidth
 = 
Ìoundf
(
magnif›rHeight
 * 
deçuÉS—rchF›ldResuÉsBu‰ÚWidth
 / 
deçuÉS—rchF›ldResuÉsDecÜ©iÚSize
);

492 
	g¡yË
->
£tWidth
(
L’gth
(
magnif›rWidth
, 
Fixed
));

493 
	g¡yË
->
£tHeight
(
L’gth
(
magnif›rHeight
, 
Fixed
));

496 
boŞ
 
	gR’d”ThemeChromiumSkŸ
::
·štS—rchF›ldResuÉsBu‰Ú
(
R’d”Objeù
* 
magnif›rObjeù
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

499 
Node
* 
	gšput
 = 
magnif›rObjeù
->
node
()->
shadowAnû¡ÜNode
();

500 ià(!
	gšput
->
»nd””
()->
isBox
())

501  
	gçl£
;

502 
R’d”Box
* 
	gšputR’d”Box
 = 
toR’d”Box
(
šput
->
»nd””
());

503 
IÁReù
 
	gšputCÚ‹ÁBox
 = 
šputR’d”Box
->
cÚ‹ÁBoxReù
();

506 
	gmagnif›rHeight
 = 
¡d
::
mš
(
šputCÚ‹ÁBox
.
height
(), 
r
.height());

507 
	gmagnif›rWidth
 = 
¡d
::
mš
(
šputCÚ‹ÁBox
.
width
(), 
¡©ic_ÿ¡
<>(
magnif›rHeight
 * 
deçuÉS—rchF›ldResuÉsBu‰ÚWidth
 / 
deçuÉS—rchF›ldResuÉsDecÜ©iÚSize
));

508 
IÁReù
 
magnif›rReù
(
magnif›rObjeù
->
off£tFromAnû¡ÜCÚš”
(
šputR’d”Box
).
width
(),

509 
šputCÚ‹ÁBox
.
y
(è+ (šputCÚ‹ÁBox.
height
(è- 
magnif›rHeight
 + 1) / 2,

510 
magnif›rWidth
, 
magnif›rHeight
);

511 
IÁReù
 
	g·štšgReù
 = 
cÚv”tToPaštšgReù
(
šputR’d”Box
, 
magnif›rObjeù
, 
magnif›rReù
, 
r
);

513 
Image
* 
	gmagnif›rImage
 = Image::
lßdPÏtfÜmResourû
("£¬chMagnif›rResuÉs").
»Ëa£Ref
();

514 
	g·štInfo
.
	gcÚ‹xt
->
d¿wImage
(
magnif›rImage
, 
magnif›rObjeù
->
¡yË
()->
cŞÜS·û
(), 
·štšgReù
);

515  
	gçl£
;

518 
boŞ
 
	gR’d”ThemeChromiumSkŸ
::
·štMedŸCÚŒŞsBackground
(
R’d”Objeù
* 
objeù
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
»ù
)

520 #ià
ENABLE
(
VIDEO
)

521  
	gR’d”MedŸCÚŒŞsChromium
::
·štMedŸCÚŒŞsP¬t
(
MedŸTim–šeCÚš”
, 
objeù
, 
·štInfo
, 
»ù
);

523 
UNUSED_PARAM
(
objeù
);

524 
UNUSED_PARAM
(
·štInfo
);

525 
UNUSED_PARAM
(
»ù
);

526  
	gçl£
;

530 
boŞ
 
	gR’d”ThemeChromiumSkŸ
::
·štMedŸSlid”T¿ck
(
R’d”Objeù
* 
objeù
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
»ù
)

532 #ià
ENABLE
(
VIDEO
)

533  
	gR’d”MedŸCÚŒŞsChromium
::
·štMedŸCÚŒŞsP¬t
(
MedŸSlid”
, 
objeù
, 
·štInfo
, 
»ù
);

535 
UNUSED_PARAM
(
objeù
);

536 
UNUSED_PARAM
(
·štInfo
);

537 
UNUSED_PARAM
(
»ù
);

538  
	gçl£
;

542 
boŞ
 
	gR’d”ThemeChromiumSkŸ
::
·štMedŸVŞumeSlid”T¿ck
(
R’d”Objeù
* 
objeù
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
»ù
)

544 #ià
ENABLE
(
VIDEO
)

545  
	gR’d”MedŸCÚŒŞsChromium
::
·štMedŸCÚŒŞsP¬t
(
MedŸVŞumeSlid”
, 
objeù
, 
·štInfo
, 
»ù
);

547 
UNUSED_PARAM
(
objeù
);

548 
UNUSED_PARAM
(
·štInfo
);

549 
UNUSED_PARAM
(
»ù
);

550  
	gçl£
;

554 
	gR’d”ThemeChromiumSkŸ
::
adju¡Slid”ThumbSize
(
R’d”Objeù
* 
objeù
) const

556 #ià
ENABLE
(
VIDEO
)

557 
R’d”MedŸCÚŒŞsChromium
::
adju¡MedŸSlid”ThumbSize
(
objeù
);

559 
UNUSED_PARAM
(
objeù
);

563 
boŞ
 
	gR’d”ThemeChromiumSkŸ
::
·štMedŸSlid”Thumb
(
R’d”Objeù
* 
objeù
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
»ù
)

565 #ià
ENABLE
(
VIDEO
)

566  
	gR’d”MedŸCÚŒŞsChromium
::
·štMedŸCÚŒŞsP¬t
(
MedŸSlid”Thumb
, 
objeù
, 
·štInfo
, 
»ù
);

568 
UNUSED_PARAM
(
objeù
);

569 
UNUSED_PARAM
(
·štInfo
);

570 
UNUSED_PARAM
(
»ù
);

571  
	gçl£
;

575 
boŞ
 
	gR’d”ThemeChromiumSkŸ
::
·štMedŸVŞumeSlid”Thumb
(
R’d”Objeù
* 
objeù
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
»ù
)

577 #ià
ENABLE
(
VIDEO
)

578  
	gR’d”MedŸCÚŒŞsChromium
::
·štMedŸCÚŒŞsP¬t
(
MedŸVŞumeSlid”Thumb
, 
objeù
, 
·štInfo
, 
»ù
);

580 
UNUSED_PARAM
(
objeù
);

581 
UNUSED_PARAM
(
·štInfo
);

582 
UNUSED_PARAM
(
»ù
);

583  
	gçl£
;

587 
boŞ
 
	gR’d”ThemeChromiumSkŸ
::
·štMedŸPÏyBu‰Ú
(
R’d”Objeù
* 
objeù
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
»ù
)

589 #ià
ENABLE
(
VIDEO
)

590  
	gR’d”MedŸCÚŒŞsChromium
::
·štMedŸCÚŒŞsP¬t
(
MedŸPÏyBu‰Ú
, 
objeù
, 
·štInfo
, 
»ù
);

592 
UNUSED_PARAM
(
objeù
);

593 
UNUSED_PARAM
(
·štInfo
);

594 
UNUSED_PARAM
(
»ù
);

595  
	gçl£
;

599 
boŞ
 
	gR’d”ThemeChromiumSkŸ
::
·štMedŸMu‹Bu‰Ú
(
R’d”Objeù
* 
objeù
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
»ù
)

601 #ià
ENABLE
(
VIDEO
)

602  
	gR’d”MedŸCÚŒŞsChromium
::
·štMedŸCÚŒŞsP¬t
(
MedŸMu‹Bu‰Ú
, 
objeù
, 
·štInfo
, 
»ù
);

604 
UNUSED_PARAM
(
objeù
);

605 
UNUSED_PARAM
(
·štInfo
);

606 
UNUSED_PARAM
(
»ù
);

607  
	gçl£
;

611 
	gR’d”ThemeChromiumSkŸ
::
adju¡M’uLi¡StyË
(
CSSStyËS–eùÜ
* 
£ËùÜ
, 
R’d”StyË
* 
¡yË
, 
WebCÜe
::
EËm’t
* 
e
) const

614 
¡yË
->
£tLšeHeight
(
R’d”StyË
::
š™ŸlLšeHeight
());

617 
boŞ
 
	gR’d”ThemeChromiumSkŸ
::
·štM’uLi¡
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
»ù
)

619 
SkCªvas
* cÚ¡ 
	gÿnvas
 = 
i
.
cÚ‹xt
->
¶©fÜmCÚ‹xt
()->
ÿnvas
();

620 cÚ¡ 
	gright
 = 
»ù
.
x
(è+„eù.
width
();

621 cÚ¡ 
	gmiddË
 = 
»ù
.
y
(è+„eù.
height
() / 2;

623 
·štBu‰ÚLike
(
this
, 
o
, 
i
, 
»ù
);

625 
SkPašt
 
	g·št
;

626 
	g·št
.
£tCŞÜ
(
SK_CŞÜBLACK
);

627 
	g·št
.
£tAÁiAlŸs
(
Œue
);

628 
	g·št
.
£tStyË
(
SkPašt
::
kFl_StyË
);

630 
	g¬rowXPos™iÚ
 = (
o
->
¡yË
()->
dœeùiÚ
(è=ğ
RTL
è? 
»ù
.
x
(è+ 7 : 
right
 - 13;

631 
SkP©h
 
	g·th
;

632 
	g·th
.
moveTo
(
¬rowXPos™iÚ
, 
middË
 - 3);

633 
	g·th
.
rLšeTo
(6, 0);

634 
	g·th
.
rLšeTo
(-3, 6);

635 
	g·th
.
şo£
();

636 
	gÿnvas
->
d¿wP©h
(
·th
, 
·št
);

638  
	gçl£
;

641 
	gR’d”ThemeChromiumSkŸ
::
adju¡M’uLi¡Bu‰ÚStyË
(
CSSStyËS–eùÜ
* 
£ËùÜ
, 
R’d”StyË
* 
¡yË
, 
EËm’t
* 
e
) const

643 
adju¡M’uLi¡StyË
(
£ËùÜ
, 
¡yË
, 
e
);

647 
boŞ
 
	gR’d”ThemeChromiumSkŸ
::
·štM’uLi¡Bu‰Ú
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
»ù
)

649  
·štM’uLi¡
(
o
, 
i
, 
»ù
);

652 
boŞ
 
	gR’d”ThemeChromiumSkŸ
::
·štSlid”T¿ck
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
»ù
)

655 
SkCªvas
* cÚ¡ 
	gÿnvas
 = 
i
.
cÚ‹xt
->
¶©fÜmCÚ‹xt
()->
ÿnvas
();

656 
	gv”tiÿlC’‹r
 = 
»ù
.
y
(è+„eù.
height
() / 2;

657 
	gtİ
 = 
¡d
::
max
(
»ù
.
y
(), 
v”tiÿlC’‹r
 - 2);

658 
	gbÙtom
 = 
¡d
::
mš
(
»ù
.
y
(è+„eù.
height
(), 
v”tiÿlC’‹r
 + 2);

660 
SkPašt
 
	g·št
;

661 cÚ¡ 
SkCŞÜ
 
	gg»y
 = 
SkCŞÜS‘ARGB
(0xff, 0xe3, 0xdd, 0xd8);

662 
	g·št
.
£tCŞÜ
(
g»y
);

664 
SkReù
 
	gsk»ù
;

665 
	gsk»ù
.
£t
(
»ù
.
x
(), 
tİ
,„eù.x(è+„eù.
width
(), 
bÙtom
);

666 
	gÿnvas
->
d¿wReù
(
sk»ù
, 
·št
);

668  
	gçl£
;

671 
boŞ
 
	gR’d”ThemeChromiumSkŸ
::
·štSlid”Thumb
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
»ù
)

674 cÚ¡ 
boŞ
 
	ghov”ed
 = 
isHov”ed
(
o
è|| 
toR’d”Slid”
(o->
·»Á
())->
šD¿gMode
();

675 cÚ¡ 
	gmidx
 = 
»ù
.
x
(è+„eù.
width
() / 2;

676 cÚ¡ 
	gmidy
 = 
»ù
.
y
(è+„eù.
height
() / 2;

677 cÚ¡ 
boŞ
 
	gv”tiÿl
 = (
o
->
¡yË
()->
­³¬ªû
(è=ğ
Slid”ThumbV”tiÿlP¬t
);

678 
SkCªvas
* cÚ¡ 
	gÿnvas
 = 
i
.
cÚ‹xt
->
¶©fÜmCÚ‹xt
()->
ÿnvas
();

680 cÚ¡ 
SkCŞÜ
 
	gthumbLightG»y
 = 
SkCŞÜS‘ARGB
(0xff, 0xf4, 0xf2, 0xef);

681 cÚ¡ 
SkCŞÜ
 
	gthumbD¬kG»y
 = 
SkCŞÜS‘ARGB
(0xff, 0xea, 0xe5, 0xe0);

682 
SkPašt
 
	g·št
;

683 
	g·št
.
£tCŞÜ
(
hov”ed
 ? 
SK_CŞÜWHITE
 : 
thumbLightG»y
);

685 
SkIReù
 
	gsk»ù
;

686 ià(
	gv”tiÿl
)

687 
	gsk»ù
.
£t
(
»ù
.
x
(),„eù.
y
(), 
midx
 + 1,„eù.
bÙtom
());

689 
	gsk»ù
.
£t
(
»ù
.
x
(),„eù.
y
(),„eù.
right
(), 
midy
 + 1);

691 
	gÿnvas
->
d¿wIReù
(
sk»ù
, 
·št
);

693 
	g·št
.
£tCŞÜ
(
hov”ed
 ? 
thumbLightG»y
 : 
thumbD¬kG»y
);

695 ià(
	gv”tiÿl
)

696 
	gsk»ù
.
£t
(
midx
 + 1, 
»ù
.
y
(),„eù.
right
(),„eù.
bÙtom
());

698 
	gsk»ù
.
£t
(
»ù
.
x
(), 
midy
 + 1,„eù.
right
(),„eù.
bÙtom
());

700 
	gÿnvas
->
d¿wIReù
(
sk»ù
, 
·št
);

702 cÚ¡ 
SkCŞÜ
 
	gbÜd”D¬kG»y
 = 
SkCŞÜS‘ARGB
(0xff, 0x9d, 0x96, 0x8e);

703 
	g·št
.
£tCŞÜ
(
bÜd”D¬kG»y
);

704 
d¿wBox
(
ÿnvas
, 
»ù
, 
·št
);

706 ià(
	g»ù
.
height
(è> 10 &&„eù.
width
() > 10) {

707 
d¿wHÜizLše
(
ÿnvas
, 
midx
 - 2, midx + 2, 
midy
, 
·št
);

708 
d¿wHÜizLše
(
ÿnvas
, 
midx
 - 2, midx + 2, 
midy
 - 3, 
·št
);

709 
d¿wHÜizLše
(
ÿnvas
, 
midx
 - 2, midx + 2, 
midy
 + 3, 
·št
);

712  
	gçl£
;

715 
	gR’d”ThemeChromiumSkŸ
::
pİupIÁ”ÇlPaddšgLeá
(
R’d”StyË
* 
¡yË
) const

717  
m’uLi¡IÁ”ÇlPaddšg
(
¡yË
, 
LeáPaddšg
);

720 
	gR’d”ThemeChromiumSkŸ
::
pİupIÁ”ÇlPaddšgRight
(
R’d”StyË
* 
¡yË
) const

722  
m’uLi¡IÁ”ÇlPaddšg
(
¡yË
, 
RightPaddšg
);

725 
	gR’d”ThemeChromiumSkŸ
::
pİupIÁ”ÇlPaddšgTİ
(
R’d”StyË
* 
¡yË
) const

727  
m’uLi¡IÁ”ÇlPaddšg
(
¡yË
, 
TİPaddšg
);

730 
	gR’d”ThemeChromiumSkŸ
::
pİupIÁ”ÇlPaddšgBÙtom
(
R’d”StyË
* 
¡yË
) const

732  
m’uLi¡IÁ”ÇlPaddšg
(
¡yË
, 
BÙtomPaddšg
);

735 #ià
ENABLE
(
VIDEO
)

736 
boŞ
 
	gR’d”ThemeChromiumSkŸ
::
shouldR’d”MedŸCÚŒŞP¬t
(
CÚŒŞP¬t
 
·¹
, 
EËm’t
* 
e
)

738  
	gR’d”MedŸCÚŒŞsChromium
::
shouldR’d”MedŸCÚŒŞP¬t
(
·¹
, 
e
);

743 
	gR’d”ThemeChromiumSkŸ
::
£tDeçuÉFÚtSize
(
fÚtSize
)

745 
deçuÉFÚtSize
 = 
¡©ic_ÿ¡
<>(
fÚtSize
);

748 
	gR’d”ThemeChromiumSkŸ
::
ÿ»tBlškIÁ”v®IÁ”Çl
() const

750  
R’d”Theme
::
ÿ»tBlškIÁ”v®
();

753 
	gR’d”ThemeChromiumSkŸ
::
m’uLi¡IÁ”ÇlPaddšg
(
R’d”StyË
* 
¡yË
, 
·ddšgTy³
) const

757 
	g·ddšg
 = 
¡yËdM’uLi¡IÁ”ÇlPaddšg
[
·ddšgTy³
];

764 cÚ¡ 
	gb¬Ty³
 = 
¡yË
->
dœeùiÚ
(è=ğ
LTR
 ? 
RightPaddšg
 : 
LeáPaddšg
;

765 ià(
	g·ddšgTy³
 =ğ
b¬Ty³
 && 
¡yË
->
­³¬ªû
(è!ğ
NoCÚŒŞP¬t
)

766 
·ddšg
 +ğ
SüŞlb¬Theme
::
ÇtiveTheme
()->
süŞlb¬ThickÃss
();

768  
	g·ddšg
;

	@RenderThemeChromiumSkia.h

28 #iâdeà
R’d”ThemeChromiumSkŸ_h


29 
	#R’d”ThemeChromiumSkŸ_h


	)

31 
	~"R’d”Theme.h
"

33 
Çme¥aû
 
	gWebCÜe
 {

35 şas 
	cR’d”ThemeChromiumSkŸ
 : 
public
 
R’d”Theme
 {

36 
public
:

37 
R’d”ThemeChromiumSkŸ
();

38 
	gvœtu®
 ~
R’d”ThemeChromiumSkŸ
();

40 
vœtu®
 
SŒšg
 
exŒaDeçuÉStyËSh“t
();

41 
vœtu®
 
SŒšg
 
exŒaQuœksStyËSh“t
();

42 #ià
ENABLE
(
VIDEO
)

43 
vœtu®
 
SŒšg
 
exŒaMedŸCÚŒŞsStyËSh“t
();

47 
vœtu®
 
boŞ
 
suµÜtsHov”
(cÚ¡ 
R’d”StyË
*) const;

50 
vœtu®
 
boŞ
 
suµÜtsFocusRšg
(cÚ¡ 
R’d”StyË
*) const;

53 
vœtu®
 
CŞÜ
 
¶©fÜmAùiveS–eùiÚBackgroundCŞÜ
() const;

54 
vœtu®
 
CŞÜ
 
¶©fÜmIÇùiveS–eùiÚBackgroundCŞÜ
() const;

55 
vœtu®
 
CŞÜ
 
¶©fÜmAùiveS–eùiÚFÜegroundCŞÜ
() const;

56 
vœtu®
 
CŞÜ
 
¶©fÜmIÇùiveS–eùiÚFÜegroundCŞÜ
() const;

57 
vœtu®
 
CŞÜ
 
¶©fÜmFocusRšgCŞÜ
() const;

60 
vœtu®
 
ÿ»tBlškIÁ”v®
() const;

63 
vœtu®
 
sy¡emFÚt
(
´İId
, 
FÚtDesütiÚ
&) const;

65 
vœtu®
 
mšimumM’uLi¡Size
(
R’d”StyË
*) const;

67 
vœtu®
 
boŞ
 
·štCheckbox
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

68 
vœtu®
 
£tCheckboxSize
(
R’d”StyË
*) const;

70 
vœtu®
 
boŞ
 
·štRadio
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

71 
vœtu®
 
£tRadioSize
(
R’d”StyË
*) const;

73 
vœtu®
 
boŞ
 
·štBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

74 
vœtu®
 
adju¡Bu‰ÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

76 
vœtu®
 
boŞ
 
·štTextF›ld
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

78 
vœtu®
 
boŞ
 
·štTextA»a
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

80 
vœtu®
 
adju¡S—rchF›ldStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

81 
vœtu®
 
boŞ
 
·štS—rchF›ld
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

83 
vœtu®
 
adju¡S—rchF›ldCªûlBu‰ÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

84 
vœtu®
 
boŞ
 
·štS—rchF›ldCªûlBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

86 
vœtu®
 
adju¡S—rchF›ldDecÜ©iÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

88 
vœtu®
 
adju¡S—rchF›ldResuÉsDecÜ©iÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

89 
vœtu®
 
boŞ
 
·štS—rchF›ldResuÉsDecÜ©iÚ
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

91 
vœtu®
 
adju¡S—rchF›ldResuÉsBu‰ÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

92 
vœtu®
 
boŞ
 
·štS—rchF›ldResuÉsBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

94 
vœtu®
 
boŞ
 
·štMedŸCÚŒŞsBackground
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

95 
vœtu®
 
boŞ
 
·štMedŸSlid”T¿ck
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

96 
vœtu®
 
boŞ
 
·štMedŸVŞumeSlid”T¿ck
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

97 
vœtu®
 
adju¡Slid”ThumbSize
(
R’d”Objeù
*) const;

98 
vœtu®
 
boŞ
 
·štMedŸSlid”Thumb
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

99 
vœtu®
 
boŞ
 
·štMedŸVŞumeSlid”Thumb
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

100 
vœtu®
 
boŞ
 
·štMedŸPÏyBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

101 
vœtu®
 
boŞ
 
·štMedŸMu‹Bu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

112 
vœtu®
 
adju¡M’uLi¡StyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

113 
vœtu®
 
boŞ
 
·štM’uLi¡
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

114 
vœtu®
 
adju¡M’uLi¡Bu‰ÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

115 
vœtu®
 
boŞ
 
·štM’uLi¡Bu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

117 
vœtu®
 
boŞ
 
·štSlid”T¿ck
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

118 
vœtu®
 
boŞ
 
·štSlid”Thumb
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

121 
vœtu®
 
pİupIÁ”ÇlPaddšgLeá
(
R’d”StyË
*) const;

122 
vœtu®
 
pİupIÁ”ÇlPaddšgRight
(
R’d”StyË
*) const;

123 
vœtu®
 
pİupIÁ”ÇlPaddšgTİ
(
R’d”StyË
*) const;

124 
vœtu®
 
pİupIÁ”ÇlPaddšgBÙtom
(
R’d”StyË
*) const;

126 #ià
ENABLE
(
VIDEO
)

128 
vœtu®
 
boŞ
 
shouldR’d”MedŸCÚŒŞP¬t
(
CÚŒŞP¬t
, 
EËm’t
*);

136 
£tDeçuÉFÚtSize
();

138 
	g´Ùeùed
:

139 cÚ¡ 
SŒšg
& 
deçuÉGUIFÚt
();

144 
	gdeçuÉFÚtSize
;

146 
vœtu®
 
ÿ»tBlškIÁ”v®IÁ”Çl
() const;

148 
	g´iv©e
:

149 
m’uLi¡IÁ”ÇlPaddšg
(
R’d”StyË
*, 
·ddšgTy³
) const;

150 
boŞ
 
·štMedŸBu‰ÚIÁ”Çl
(
G¿phicsCÚ‹xt
*, cÚ¡ 
IÁReù
&, 
Image
*);

151 
IÁReù
 
cÚv”tToPaštšgReù
(
R’d”Objeù
* 
šputR’d””
, cÚ¡ R’d”Objeù* 
·¹R’d””
, IÁReù 
·¹Reù
, cÚ¡ IÁReù& 
loÿlOff£t
) const;

	@RenderThemeChromiumWin.cpp

25 
	~"cÚfig.h
"

26 
	~"R’d”ThemeChromiumWš.h
"

28 
	~<wšdows.h
>

29 
	~<uxtheme.h
>

30 
	~<vssym32.h
>

32 
	~"ChromiumBridge.h
"

33 
	~"CSSV®ueKeywÜds.h
"

34 
	~"FÚtS–eùÜ.h
"

35 
	~"FÚtUtsChromiumWš.h
"

36 
	~"G¿phicsCÚ‹xt.h
"

37 
	~"HTMLMedŸEËm’t.h
"

38 
	~"HTMLNames.h
"

39 
	~"MedŸCÚŒŞEËm’ts.h
"

40 
	~"R’d”Box.h
"

41 
	~"R’d”Slid”.h
"

42 
	~"SüŞlb¬Theme.h
"

43 
	~"T¿n¥¬’cyWš.h
"

44 
	~"WšdowsV”siÚ.h
"

47 
	~<skŸ/ext/skŸ_uts_wš.h
>

49 
	#SIZEOF_STRUCT_WITH_SPECIFIED_LAST_MEMBER
(
¡ruùName
, 
memb”
) \

50 
	`off£tof
(
¡ruùName
, 
memb”
) + \

51 ( 
¡©ic_ÿ¡
<
¡ruùName
*>(0)->
memb”
)

	)

52 
	#NONCLIENTMETRICS_SIZE_PRE_VISTA
 \

53 
	`SIZEOF_STRUCT_WITH_SPECIFIED_LAST_MEMBER
(
NONCLIENTMETRICS
, 
lfMes§geFÚt
)

	)

55 
Çme¥aû
 
	gWebCÜe
 {

57 
	gÇme¥aû
 {

58 şas 
	cThemePaš‹r
 : 
public
 
T¿n¥¬’cyWš
 {

59 
public
:

60 
ThemePaš‹r
(
G¿phicsCÚ‹xt
* 
cÚ‹xt
, cÚ¡ 
IÁReù
& 
r
)

62 
T¿nsfÜmMode
 
	gŒªsfÜmMode
 = 
g‘T¿nsfÜmMode
(
cÚ‹xt
->
g‘CTM
());

63 
š™
(
cÚ‹xt
, 
g‘Lay”Mode
(cÚ‹xt, 
ŒªsfÜmMode
),¿nsfÜmMode, 
r
);

66 ~
ThemePaš‹r
()

68 
compos™e
();

71 
	g´iv©e
:

72 
boŞ
 
ÿnvasHasMuÉËLay”s
(cÚ¡ 
SkCªvas
* 
ÿnvas
)

74 
SkCªvas
::
Lay”I‹r
 
™”
(
cÚ¡_ÿ¡
<SkCªvas*>(
ÿnvas
), 
çl£
);

75 
	g™”
.
Ãxt
();

76  !
	g™”
.
dÚe
();

79 
Lay”Mode
 
g‘Lay”Mode
(
G¿phicsCÚ‹xt
* 
cÚ‹xt
, 
T¿nsfÜmMode
 
ŒªsfÜmMode
)

81 ià(
	gcÚ‹xt
->
¶©fÜmCÚ‹xt
()->
isD¿wšgToImageBufãr
())

82  
	gWh™eLay”
;

83 ià(
ÿnvasHasMuÉËLay”s
(
cÚ‹xt
->
¶©fÜmCÚ‹xt
()->
ÿnvas
()))

84  
	gO·queCompos™eLay”
;

86  
	gŒªsfÜmMode
 =ğ
K“pT¿nsfÜm
 ? 
NoLay”
 : 
O·queCompos™eLay”
;

89 
T¿nsfÜmMode
 
g‘T¿nsfÜmMode
(cÚ¡ 
AffšeT¿nsfÜm
& 
m©rix
)

91 ià(
	gm©rix
.
b
(è!ğ0 || 
m©rix
.
c
() != 0)

92  
UÁ¿nsfÜm
;

93 ià(
	gm©rix
.
a
(è!ğ1.0 || 
m©rix
.
d
() != 1.0)

94  
SÿËT¿nsfÜm
;

96  
	gK“pT¿nsfÜm
;

102 
	$g‘NÚCl›ÁM‘rics
(
NONCLIENTMETRICS
* 
m‘rics
)

104 
UINT
 
size
 = 
WebCÜe
::
	`isVi¡aOrNew”
() ?

105 (
NONCLIENTMETRICS
è: 
NONCLIENTMETRICS_SIZE_PRE_VISTA
;

106 
m‘rics
->
cbSize
 = 
size
;

107 
boŞ
 
sucûss
 = !!
	`Sy¡emP¬am‘”sInfo
(
SPI_GETNONCLIENTMETRICS
, 
size
, 
m‘rics
, 0);

108 
	`ASSERT
(
sucûss
);

109 
	}
}

111 
FÚtDesütiÚ
 
	gsm®lSy¡emFÚt
;

112 
FÚtDesütiÚ
 
	gm’uFÚt
;

113 
FÚtDesütiÚ
 
	gÏb–FÚt
;

118 
boŞ
 
	$suµÜtsFocus
(
CÚŒŞP¬t
 
­³¬ªû
)

120 
­³¬ªû
) {

121 
PushBu‰ÚP¬t
:

122 
Bu‰ÚP¬t
:

123 
DeçuÉBu‰ÚP¬t
:

124 
S—rchF›ldP¬t
:

125 
TextF›ldP¬t
:

126 
TextA»aP¬t
:

127  
Œue
;

129  
çl£
;

130 
	}
}

134 
	$sy¡emFÚtSize
(cÚ¡ 
LOGFONT
& 
fÚt
)

136 
size
 = -
fÚt
.
lfHeight
;

137 ià(
size
 < 0) {

138 
HFONT
 
hFÚt
 = 
	`C»©eFÚtIndœeù
(&
fÚt
);

139 ià(
hFÚt
) {

140 
HDC
 
hdc
 = 
	`G‘DC
(0);

141 ià(
hdc
) {

142 
HGDIOBJ
 
hObjeù
 = 
	`S–eùObjeù
(
hdc
, 
hFÚt
);

143 
TEXTMETRIC
 
tm
;

144 
	`G‘TextM‘rics
(
hdc
, &
tm
);

145 
	`S–eùObjeù
(
hdc
, 
hObjeù
);

146 
	`R–—£DC
(0, 
hdc
);

147 
size
 = 
tm
.
tmAsûÁ
;

149 
	`D–‘eObjeù
(
hFÚt
);

163  ((
size
 < 12.0fè&& (
	`G‘ACP
() == 936)) ? 12.0f : size;

164 
	}
}

167 
	$poštsToPix–s
(
pošts
)

169 
pix–sP”Inch
 = 0.0f;

170 ià(!
pix–sP”Inch
) {

171 
HDC
 
hdc
 = 
	`G‘DC
(0);

172 ià(
hdc
) {

173 
pix–sP”Inch
 = 
	`G‘DeviûC­s
(
hdc
, 
LOGPIXELSY
);

174 
	`R–—£DC
(0, 
hdc
);

176 
pix–sP”Inch
 = 96.0f;

180 cÚ¡ 
poštsP”Inch
 = 72.0f;

181  
pošts
 / 
poštsP”Inch
 * 
pix–sP”Inch
;

182 
	}
}

184 
	$qu”ySy¡emBlškIÁ”v®
(
deçuÉIÁ”v®
)

186 
UINT
 
blškTime
 = 
	`G‘C¬‘BlškTime
();

187 ià(
blškTime
 == 0)

188  
deçuÉIÁ”v®
;

189 ià(
blškTime
 =ğ
INFINITE
)

191  
blškTime
 / 1000.0;

192 
	}
}

194 
	gPassRefPŒ
<
	gR’d”Theme
> 
	gR’d”ThemeChromiumWš
::
	$ü—‹
()

196  
	`adİtRef
(
Ãw
 
R’d”ThemeChromiumWš
);

197 
	}
}

199 
	gPassRefPŒ
<
	gR’d”Theme
> R’d”Theme::
	$themeFÜPage
(
Page
* 
·ge
)

201 
R’d”Theme
* 
¹
 = 
R’d”ThemeChromiumWš
::
	`ü—‹
().
	`»Ëa£Ref
();

202  
¹
;

203 
	}
}

205 
boŞ
 
	gR’d”ThemeChromiumWš
::
	$suµÜtsFocusRšg
(cÚ¡ 
R’d”StyË
* 
¡yË
) const

210  
¡yË
->
	`­³¬ªû
(è=ğ
Bu‰ÚP¬t


211 || 
¡yË
->
	`­³¬ªû
(è=ğ
PushBu‰ÚP¬t
;

212 
	}
}

214 
CŞÜ
 
	gR’d”ThemeChromiumWš
::
	$¶©fÜmAùiveS–eùiÚBackgroundCŞÜ
() const

216 ià(
ChromiumBridge
::
	`ÏyoutTe¡Mode
())

217  
	`CŞÜ
(0x00, 0x00, 0xff);

218 
COLORREF
 
cŞÜ
 = 
	`G‘SysCŞÜ
(
COLOR_HIGHLIGHT
);

219  
	`CŞÜ
(
	`G‘RV®ue
(
cŞÜ
), 
	`G‘GV®ue
(cŞÜ), 
	`G‘BV®ue
(color), 0xff);

220 
	}
}

222 
CŞÜ
 
	gR’d”ThemeChromiumWš
::
	$¶©fÜmIÇùiveS–eùiÚBackgroundCŞÜ
() const

224 ià(
ChromiumBridge
::
	`ÏyoutTe¡Mode
())

225  
	`CŞÜ
(0x99, 0x99, 0x99);

226 
COLORREF
 
cŞÜ
 = 
	`G‘SysCŞÜ
(
COLOR_GRAYTEXT
);

227  
	`CŞÜ
(
	`G‘RV®ue
(
cŞÜ
), 
	`G‘GV®ue
(cŞÜ), 
	`G‘BV®ue
(color), 0xff);

228 
	}
}

230 
CŞÜ
 
	gR’d”ThemeChromiumWš
::
	$¶©fÜmAùiveS–eùiÚFÜegroundCŞÜ
() const

232 ià(
ChromiumBridge
::
	`ÏyoutTe¡Mode
())

233  
	`CŞÜ
(0xff, 0xff, 0xcc);

234 
COLORREF
 
cŞÜ
 = 
	`G‘SysCŞÜ
(
COLOR_HIGHLIGHTTEXT
);

235  
	`CŞÜ
(
	`G‘RV®ue
(
cŞÜ
), 
	`G‘GV®ue
(cŞÜ), 
	`G‘BV®ue
(color), 0xff);

236 
	}
}

238 
CŞÜ
 
	gR’d”ThemeChromiumWš
::
	$¶©fÜmIÇùiveS–eùiÚFÜegroundCŞÜ
() const

240  
CŞÜ
::
wh™e
;

241 
	}
}

243 
CŞÜ
 
	gR’d”ThemeChromiumWš
::
	$¶©fÜmAùiveTextS—rchHighlightCŞÜ
() const

245  
	`CŞÜ
(0xff, 0x96, 0x32);

246 
	}
}

248 
CŞÜ
 
	gR’d”ThemeChromiumWš
::
	$¶©fÜmIÇùiveTextS—rchHighlightCŞÜ
() const

250  
	`CŞÜ
(0xff, 0xff, 0x96);

251 
	}
}

253 
	gR’d”ThemeChromiumWš
::
	$sy¡emFÚt
(
´İId
, 
FÚtDesütiÚ
& 
fÚtDesütiÚ
) const

256 
FÚtDesütiÚ
* 
ÿchedDesc
 = 0;

257 
AtomicSŒšg
 
çûName
;

258 
fÚtSize
 = 0;

259 
´İId
) {

260 
CSSV®ueSm®lC­tiÚ
:

261 
ÿchedDesc
 = &
sm®lSy¡emFÚt
;

262 ià(!
sm®lSy¡emFÚt
.
	`isAbsŞu‹Size
()) {

263 
NONCLIENTMETRICS
 
m‘rics
;

264 
	`g‘NÚCl›ÁM‘rics
(&
m‘rics
);

265 
çûName
 = 
	`AtomicSŒšg
(
m‘rics
.
lfSmC­tiÚFÚt
.
lfFaûName
, 
	`wc¦’
(metrics.lfSmCaptionFont.lfFaceName));

266 
fÚtSize
 = 
	`sy¡emFÚtSize
(
m‘rics
.
lfSmC­tiÚFÚt
);

269 
CSSV®ueM’u
:

270 
ÿchedDesc
 = &
m’uFÚt
;

271 ià(!
m’uFÚt
.
	`isAbsŞu‹Size
()) {

272 
NONCLIENTMETRICS
 
m‘rics
;

273 
	`g‘NÚCl›ÁM‘rics
(&
m‘rics
);

274 
çûName
 = 
	`AtomicSŒšg
(
m‘rics
.
lfM’uFÚt
.
lfFaûName
, 
	`wc¦’
(metrics.lfMenuFont.lfFaceName));

275 
fÚtSize
 = 
	`sy¡emFÚtSize
(
m‘rics
.
lfM’uFÚt
);

278 
CSSV®ueStusB¬
:

279 
ÿchedDesc
 = &
Ïb–FÚt
;

280 ià(!
Ïb–FÚt
.
	`isAbsŞu‹Size
()) {

281 
NONCLIENTMETRICS
 
m‘rics
;

282 
	`g‘NÚCl›ÁM‘rics
(&
m‘rics
);

283 
çûName
 = 
m‘rics
.
lfStusFÚt
.
lfFaûName
;

284 
fÚtSize
 = 
	`sy¡emFÚtSize
(
m‘rics
.
lfStusFÚt
);

287 
CSSV®ueWebk™MšiCÚŒŞ
:

288 
CSSV®ueWebk™Sm®lCÚŒŞ
:

289 
CSSV®ueWebk™CÚŒŞ
:

290 
çûName
 = 
	`deçuÉGUIFÚt
();

292 
fÚtSize
 = 
deçuÉFÚtSize
 - 
	`poštsToPix–s
(2);

295 
çûName
 = 
	`deçuÉGUIFÚt
();

296 
fÚtSize
 = 
deçuÉFÚtSize
;

300 ià(!
ÿchedDesc
)

301 
ÿchedDesc
 = &
fÚtDesütiÚ
;

303 ià(
fÚtSize
) {

304 
ÿchedDesc
->
	`fœ¡Famy
().
	`£tFamy
(
çûName
);

305 
ÿchedDesc
->
	`£tIsAbsŞu‹Size
(
Œue
);

306 
ÿchedDesc
->
	`£tG’”icFamy
(
FÚtDesütiÚ
::
NoFamy
);

307 
ÿchedDesc
->
	`£tS³cif›dSize
(
fÚtSize
);

308 
ÿchedDesc
->
	`£tWeight
(
FÚtWeightNÜm®
);

309 
ÿchedDesc
->
	`£tIlic
(
çl£
);

311 
fÚtDesütiÚ
 = *
ÿchedDesc
;

312 
	}
}

315 
	$cssV®ueIdToSysCŞÜIndex
(
cssV®ueId
)

317 
cssV®ueId
) {

318 
CSSV®ueAùivebÜd”
:  
COLOR_ACTIVEBORDER
;

319 
CSSV®ueAùiveÿ±iÚ
:  
COLOR_ACTIVECAPTION
;

320 
CSSV®ueAµwÜk¥aû
:  
COLOR_APPWORKSPACE
;

321 
CSSV®ueBackground
:  
COLOR_BACKGROUND
;

322 
CSSV®ueBu‰Úçû
:  
COLOR_BTNFACE
;

323 
CSSV®ueBu‰Úhighlight
:  
COLOR_BTNHIGHLIGHT
;

324 
CSSV®ueBu‰Úshadow
:  
COLOR_BTNSHADOW
;

325 
CSSV®ueBu‰Ú‹xt
:  
COLOR_BTNTEXT
;

326 
CSSV®ueC­tiÚ‹xt
:  
COLOR_CAPTIONTEXT
;

327 
CSSV®ueG¿y‹xt
:  
COLOR_GRAYTEXT
;

328 
CSSV®ueHighlight
:  
COLOR_HIGHLIGHT
;

329 
CSSV®ueHighligh‰ext
:  
COLOR_HIGHLIGHTTEXT
;

330 
CSSV®ueIÇùivebÜd”
:  
COLOR_INACTIVEBORDER
;

331 
CSSV®ueIÇùiveÿ±iÚ
:  
COLOR_INACTIVECAPTION
;

332 
CSSV®ueIÇùiveÿ±iÚ‹xt
:  
COLOR_INACTIVECAPTIONTEXT
;

333 
CSSV®ueInfobackground
:  
COLOR_INFOBK
;

334 
CSSV®ueInfÙext
:  
COLOR_INFOTEXT
;

335 
CSSV®ueM’u
:  
COLOR_MENU
;

336 
CSSV®ueM’u‹xt
:  
COLOR_MENUTEXT
;

337 
CSSV®ueSüŞlb¬
:  
COLOR_SCROLLBAR
;

338 
CSSV®ueTh»edd¬kshadow
:  
COLOR_3DDKSHADOW
;

339 
CSSV®ueTh»edçû
:  
COLOR_3DFACE
;

340 
CSSV®ueTh»edhighlight
:  
COLOR_3DHIGHLIGHT
;

341 
CSSV®ueTh»edlightshadow
:  
COLOR_3DLIGHT
;

342 
CSSV®ueTh»edshadow
:  
COLOR_3DSHADOW
;

343 
CSSV®ueWšdow
:  
COLOR_WINDOW
;

344 
CSSV®ueWšdowäame
:  
COLOR_WINDOWFRAME
;

345 
CSSV®ueWšdow‹xt
:  
COLOR_WINDOWTEXT
;

348 
	}
}

350 
CŞÜ
 
	gR’d”ThemeChromiumWš
::
	$sy¡emCŞÜ
(
cssV®ueId
) const

352 
sysCŞÜIndex
 = 
	`cssV®ueIdToSysCŞÜIndex
(
cssV®ueId
);

353 ià(
ChromiumBridge
::
	`ÏyoutTe¡Mode
(è|| (
sysCŞÜIndex
 == -1))

354  
R’d”Theme
::
	`sy¡emCŞÜ
(
cssV®ueId
);

356 
COLORREF
 
cŞÜ
 = 
	`G‘SysCŞÜ
(
sysCŞÜIndex
);

357  
	`CŞÜ
(
	`G‘RV®ue
(
cŞÜ
), 
	`G‘GV®ue
(cŞÜ), 
	`G‘BV®ue
(color));

358 
	}
}

360 
	gR’d”ThemeChromiumWš
::
	$adju¡Slid”ThumbSize
(
R’d”Objeù
* 
o
) const

363 cÚ¡ 
¦id”ThumbAlÚgAxis
 = 11;

364 cÚ¡ 
¦id”ThumbAüossAxis
 = 21;

365 ià(
o
->
	`¡yË
()->
	`­³¬ªû
(è=ğ
Slid”ThumbHÜizÚlP¬t
) {

366 
o
->
	`¡yË
()->
	`£tWidth
(
	`L’gth
(
¦id”ThumbAlÚgAxis
, 
Fixed
));

367 
o
->
	`¡yË
()->
	`£tHeight
(
	`L’gth
(
¦id”ThumbAüossAxis
, 
Fixed
));

368 } ià(
o
->
	`¡yË
()->
	`­³¬ªû
(è=ğ
Slid”ThumbV”tiÿlP¬t
) {

369 
o
->
	`¡yË
()->
	`£tWidth
(
	`L’gth
(
¦id”ThumbAüossAxis
, 
Fixed
));

370 
o
->
	`¡yË
()->
	`£tHeight
(
	`L’gth
(
¦id”ThumbAlÚgAxis
, 
Fixed
));

372 
R’d”ThemeChromiumSkŸ
::
	`adju¡Slid”ThumbSize
(
o
);

373 
	}
}

375 
boŞ
 
	gR’d”ThemeChromiumWš
::
·štCheckbox
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
r
)

377  
·štBu‰Ú
(
o
, 
i
, 
r
);

379 
boŞ
 
	gR’d”ThemeChromiumWš
::
·štRadio
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
r
)

381  
·štBu‰Ú
(
o
, 
i
, 
r
);

384 
boŞ
 
	gR’d”ThemeChromiumWš
::
·štBu‰Ú
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
r
)

386 cÚ¡ 
	gThemeD©a
& 
	gthemeD©a
 = 
g‘ThemeD©a
(
o
);

388 
	gWebCÜe
::
ThemePaš‹r
 
·š‹r
(
i
.
cÚ‹xt
, 
r
);

389 
	gChromiumBridge
::
·štBu‰Ú
(
·š‹r
.
cÚ‹xt
(),

390 
themeD©a
.
m_·¹
,

391 
themeD©a
.
m_¡©e
,

392 
themeD©a
.
m_şassicS‹
,

393 
·š‹r
.
d¿wReù
());

394  
	gçl£
;

397 
boŞ
 
	gR’d”ThemeChromiumWš
::
·štTextF›ld
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
r
)

399  
·štTextF›ldIÁ”Çl
(
o
, 
i
, 
r
, 
Œue
);

402 
boŞ
 
	gR’d”ThemeChromiumWš
::
·štSlid”T¿ck
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
r
)

404 cÚ¡ 
	gThemeD©a
& 
	gthemeD©a
 = 
g‘ThemeD©a
(
o
);

406 
	gWebCÜe
::
ThemePaš‹r
 
·š‹r
(
i
.
cÚ‹xt
, 
r
);

407 
	gChromiumBridge
::
·štT¿ckb¬
(
·š‹r
.
cÚ‹xt
(),

408 
themeD©a
.
m_·¹
,

409 
themeD©a
.
m_¡©e
,

410 
themeD©a
.
m_şassicS‹
,

411 
·š‹r
.
d¿wReù
());

412  
	gçl£
;

415 
boŞ
 
	gR’d”ThemeChromiumWš
::
·štSlid”Thumb
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
r
)

417  
·štSlid”T¿ck
(
o
, 
i
, 
r
);

421 
boŞ
 
	gR’d”ThemeChromiumWš
::
·štM’uLi¡
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
r
)

423 ià(!
	go
->
isBox
())

424  
	gçl£
;

426 cÚ¡ 
R’d”Box
* 
	gbox
 = 
toR’d”Box
(
o
);

427 
	gbÜd”Right
 = 
box
->
bÜd”Right
();

428 
	gbÜd”Leá
 = 
box
->
bÜd”Leá
();

429 
	gbÜd”Tİ
 = 
box
->
bÜd”Tİ
();

430 
	gbÜd”BÙtom
 = 
box
->
bÜd”BÙtom
();

437 
boŞ
 
	gd¿wEdges
 = !(
bÜd”Right
 =ğ0 && 
bÜd”Leá
 =ğ0 && 
bÜd”Tİ
 =ğ0 && 
bÜd”BÙtom
 == 0);

439 
·štTextF›ldIÁ”Çl
(
o
, 
i
, 
r
, 
d¿wEdges
);

444 cÚ¡ 
	gbu‰ÚWidth
 = 
G‘Sy¡emM‘rics
(
SM_CXVSCROLL
);

445 
	g¥acšgLeá
 = 
bÜd”Leá
 + 
box
->
·ddšgLeá
();

446 
	g¥acšgRight
 = 
bÜd”Right
 + 
box
->
·ddšgRight
();

447 
	g¥acšgTİ
 = 
bÜd”Tİ
 + 
box
->
·ddšgTİ
();

448 
	g¥acšgBÙtom
 = 
bÜd”BÙtom
 + 
box
->
·ddšgBÙtom
();

450 
	gbu‰ÚX
;

451 ià(
	gr
.
right
(è-„.
x
(è< 
	gbu‰ÚWidth
)

452 
	gbu‰ÚX
 = 
r
.
x
();

454 
	gbu‰ÚX
 = 
o
->
¡yË
()->
dœeùiÚ
(è=ğ
LTR
 ? 
r
.
right
(è- 
¥acšgRight
 - 
bu‰ÚWidth
 :„.
x
(è+ 
¥acšgLeá
;

457 
IÁReù
 
»ù
(
bu‰ÚX
,

458 
r
.
y
(è+ 
¥acšgTİ
,

459 
¡d
::
mš
(
bu‰ÚWidth
, 
r
.
right
(è-„.
x
()),

460 
r
.
height
(è- (
¥acšgTİ
 + 
¥acšgBÙtom
));

463 
	gWebCÜe
::
ThemePaš‹r
 
·š‹r
(
i
.
cÚ‹xt
, 
»ù
);

464 
	gChromiumBridge
::
·štM’uLi¡
(
·š‹r
.
cÚ‹xt
(),

465 
CP_DROPDOWNBUTTON
,

466 
d‘”mšeS‹
(
o
),

467 
d‘”mšeCÏssicS‹
(
o
),

468 
·š‹r
.
d¿wReù
());

469  
	gçl£
;

473 
	gR’d”ThemeChromiumWš
::
	$£tDeçuÉFÚtSize
(
fÚtSize
)

475 
R’d”ThemeChromiumSkŸ
::
	`£tDeçuÉFÚtSize
(
fÚtSize
);

478 
sm®lSy¡emFÚt
 = 
m’uFÚt
 = 
Ïb–FÚt
 = 
	`FÚtDesütiÚ
();

479 
	}
}

481 
	gR’d”ThemeChromiumWš
::
	$ÿ»tBlškIÁ”v®IÁ”Çl
() const

484 
blškIÁ”v®
 = 
	`qu”ySy¡emBlškIÁ”v®
(
R’d”Theme
::
	`ÿ»tBlškIÁ”v®
());

485  
blškIÁ”v®
;

486 
	}
}

488 
	gR’d”ThemeChromiumWš
::
	$d‘”mšeS‹
(
R’d”Objeù
* 
o
)

490 
»suÉ
 = 
TS_NORMAL
;

491 
CÚŒŞP¬t
 
­³¬ªû
 = 
o
->
	`¡yË
()->
	`­³¬ªû
();

492 ià(!
	`isEÇbËd
(
o
))

493 
»suÉ
 = 
TS_DISABLED
;

494 ià(
	`isR—dOÆyCÚŒŞ
(
o
è&& (
TextF›ldP¬t
 =ğ
­³¬ªû
 || 
TextA»aP¬t
 =ğ­³¬ªû || 
S—rchF›ldP¬t
 ==‡ppearance))

495 
»suÉ
 = 
ETS_READONLY
;

496 ià(
	`isP»s£d
(
o
))

497 
»suÉ
 = 
TS_PRESSED
;

498 ià(
	`suµÜtsFocus
(
­³¬ªû
è&& 
	`isFocu£d
(
o
))

499 
»suÉ
 = 
ETS_FOCUSED
;

500 ià(
	`isHov”ed
(
o
))

501 
»suÉ
 = 
TS_HOT
;

502 ià(
	`isChecked
(
o
))

503 
»suÉ
 += 4;

504  
»suÉ
;

505 
	}
}

507 
	gR’d”ThemeChromiumWš
::
	$d‘”mšeSlid”ThumbS‹
(
R’d”Objeù
* 
o
)

509 
»suÉ
 = 
TUS_NORMAL
;

510 ià(!
	`isEÇbËd
(
o
->
	`·»Á
()))

511 
»suÉ
 = 
TUS_DISABLED
;

512 ià(
	`suµÜtsFocus
(
o
->
	`¡yË
()->
	`­³¬ªû
()è&& 
	`isFocu£d
(o->
	`·»Á
()))

513 
»suÉ
 = 
TUS_FOCUSED
;

514 ià(
	`toR’d”Slid”
(
o
->
	`·»Á
())->
	`šD¿gMode
())

515 
»suÉ
 = 
TUS_PRESSED
;

516 ià(
	`isHov”ed
(
o
))

517 
»suÉ
 = 
TUS_HOT
;

518  
»suÉ
;

519 
	}
}

521 
	gR’d”ThemeChromiumWš
::
	$d‘”mšeCÏssicS‹
(
R’d”Objeù
* 
o
)

523 
»suÉ
 = 0;

525 
CÚŒŞP¬t
 
·¹
 = 
o
->
	`¡yË
()->
	`­³¬ªû
();

528 ià(
·¹
 =ğ
Slid”HÜizÚlP¬t
 ||…¬ˆ=ğ
Slid”V”tiÿlP¬t
)

529  
»suÉ
;

532 ià(
	`isR—dOÆyCÚŒŞ
(
o
è&& (
·¹
 =ğ
TextF›ldP¬t
 ||…¬ˆ=ğ
TextA»aP¬t
 ||…¬ˆ=ğ
S—rchF›ldP¬t
))

533  
»suÉ
;

535 ià(
·¹
 =ğ
Slid”ThumbHÜizÚlP¬t
 ||…¬ˆ=ğ
Slid”ThumbV”tiÿlP¬t
) {

536 ià(!
	`isEÇbËd
(
o
->
	`·»Á
()))

537 
»suÉ
 = 
DFCS_INACTIVE
;

538 ià(
	`toR’d”Slid”
(
o
->
	`·»Á
())->
	`šD¿gMode
())

539 
»suÉ
 = 
DFCS_PUSHED
;

540 ià(
	`isHov”ed
(
o
))

541 
»suÉ
 = 
DFCS_HOT
;

543 ià(!
	`isEÇbËd
(
o
))

544 
»suÉ
 = 
DFCS_INACTIVE
;

545 ià(
	`isP»s£d
(
o
))

546 
»suÉ
 = 
DFCS_PUSHED
;

547 ià(
	`suµÜtsFocus
(
·¹
è&& 
	`isFocu£d
(
o
))

548 
»suÉ
 = 0;

549 ià(
	`isHov”ed
(
o
))

550 
»suÉ
 = 
DFCS_HOT
;

551 ià(
	`isChecked
(
o
))

552 
»suÉ
 |ğ
DFCS_CHECKED
;

554  
»suÉ
;

555 
	}
}

557 
ThemeD©a
 
	gR’d”ThemeChromiumWš
::
	$g‘ThemeD©a
(
R’d”Objeù
* 
o
)

559 
ThemeD©a
 
»suÉ
;

560 
o
->
	`¡yË
()->
	`­³¬ªû
()) {

561 
CheckboxP¬t
:

562 
»suÉ
.
m_·¹
 = 
BP_CHECKBOX
;

563 
»suÉ
.
m_¡©e
 = 
	`d‘”mšeS‹
(
o
);

564 
»suÉ
.
m_şassicS‹
 = 
DFCS_BUTTONCHECK
;

566 
RadioP¬t
:

567 
»suÉ
.
m_·¹
 = 
BP_RADIOBUTTON
;

568 
»suÉ
.
m_¡©e
 = 
	`d‘”mšeS‹
(
o
);

569 
»suÉ
.
m_şassicS‹
 = 
DFCS_BUTTONRADIO
;

571 
PushBu‰ÚP¬t
:

572 
Bu‰ÚP¬t
:

573 
»suÉ
.
m_·¹
 = 
BP_PUSHBUTTON
;

574 
»suÉ
.
m_¡©e
 = 
	`d‘”mšeS‹
(
o
);

575 
»suÉ
.
m_şassicS‹
 = 
DFCS_BUTTONPUSH
;

577 
Slid”HÜizÚlP¬t
:

578 
»suÉ
.
m_·¹
 = 
TKP_TRACK
;

579 
»suÉ
.
m_¡©e
 = 
TRS_NORMAL
;

581 
Slid”V”tiÿlP¬t
:

582 
»suÉ
.
m_·¹
 = 
TKP_TRACKVERT
;

583 
»suÉ
.
m_¡©e
 = 
TRVS_NORMAL
;

585 
Slid”ThumbHÜizÚlP¬t
:

586 
»suÉ
.
m_·¹
 = 
TKP_THUMBBOTTOM
;

587 
»suÉ
.
m_¡©e
 = 
	`d‘”mšeSlid”ThumbS‹
(
o
);

589 
Slid”ThumbV”tiÿlP¬t
:

590 
»suÉ
.
m_·¹
 = 
TKP_THUMBVERT
;

591 
»suÉ
.
m_¡©e
 = 
	`d‘”mšeSlid”ThumbS‹
(
o
);

593 
Li¡boxP¬t
:

594 
M’uli¡P¬t
:

595 
M’uli¡Bu‰ÚP¬t
:

596 
S—rchF›ldP¬t
:

597 
TextF›ldP¬t
:

598 
TextA»aP¬t
:

599 
»suÉ
.
m_·¹
 = 
EP_EDITTEXT
;

600 
»suÉ
.
m_¡©e
 = 
	`d‘”mšeS‹
(
o
);

604 
»suÉ
.
m_şassicS‹
 |ğ
	`d‘”mšeCÏssicS‹
(
o
);

606  
»suÉ
;

607 
	}
}

609 
boŞ
 
	gR’d”ThemeChromiumWš
::
·štTextF›ldIÁ”Çl
(
R’d”Objeù
* 
o
,

610 cÚ¡ 
R’d”Objeù
::
PaštInfo
& 
i
,

611 cÚ¡ 
IÁReù
& 
r
,

612 
boŞ
 
d¿wEdges
)

616 
CŞÜ
 
backgroundCŞÜ
(CŞÜ::
wh™e
);

617 ià(
	go
->
¡yË
()->
backgroundCŞÜ
().
isV®id
())

618 
	gbackgroundCŞÜ
 = 
o
->
¡yË
()->
backgroundCŞÜ
();

627 
boŞ
 
	gflCÚ‹ÁA»a
 = !
o
->
¡yË
()->
hasBackgroundImage
(è&& 
backgroundCŞÜ
.
®pha
();

629 ià(
	go
->
¡yË
()->
hasBÜd”Radius
()) {

633 
	gi
.
	gcÚ‹xt
->
§ve
();

634 
IÁSize
 
	gtİLeá
, 
	gtİRight
, 
	gbÙtomLeá
, 
	gbÙtomRight
;

635 
	go
->
¡yË
()->
g‘BÜd”RadiiFÜReù
(
r
, 
tİLeá
, 
tİRight
, 
bÙtomLeá
, 
bÙtomRight
);

636 
	gi
.
	gcÚ‹xt
->
addRoundedReùCl
(
r
, 
tİLeá
, 
tİRight
, 
bÙtomLeá
, 
bÙtomRight
);

639 cÚ¡ 
	gThemeD©a
& 
	gthemeD©a
 = 
g‘ThemeD©a
(
o
);

640 
	gWebCÜe
::
ThemePaš‹r
 
·š‹r
(
i
.
cÚ‹xt
, 
r
);

641 
	gChromiumBridge
::
·štTextF›ld
(
·š‹r
.
cÚ‹xt
(),

642 
themeD©a
.
m_·¹
,

643 
themeD©a
.
m_¡©e
,

644 
themeD©a
.
m_şassicS‹
,

645 
·š‹r
.
d¿wReù
(),

646 
backgroundCŞÜ
,

647 
flCÚ‹ÁA»a
,

648 
d¿wEdges
);

651 ià(
	go
->
¡yË
()->
hasBÜd”Radius
())

652 
	gi
.
	gcÚ‹xt
->
»¡Üe
();

653  
	gçl£
;

	@RenderThemeChromiumWin.h

24 #iâdeà
R’d”ThemeChromiumWš_h


25 
	#R’d”ThemeChromiumWš_h


	)

27 
	~"R’d”ThemeChromiumSkŸ.h
"

29 #ià
WIN32


30 * 
	tHANDLE
;

31 
HINSTANCE__
* 
	tHINSTANCE
;

32 
HINSTANCE
 
	tHMODULE
;

35 
Çme¥aû
 
	gWebCÜe
 {

37 
	sThemeD©a
 {

38 
ThemeD©a
(è: 
m_·¹
(0), 
m_¡©e
(0), 
m_şassicS‹
(0) {}

40 
	gm_·¹
;

41 
	gm_¡©e
;

42 
	gm_şassicS‹
;

45 şas 
	cR’d”ThemeChromiumWš
 : 
public
 
R’d”ThemeChromiumSkŸ
 {

46 
public
:

47 
PassRefPŒ
<
R’d”Theme
> 
ü—‹
();

50 
vœtu®
 
boŞ
 
suµÜtsFocusRšg
(cÚ¡ 
R’d”StyË
*) const;

53 
vœtu®
 
CŞÜ
 
¶©fÜmAùiveS–eùiÚBackgroundCŞÜ
() const;

54 
vœtu®
 
CŞÜ
 
¶©fÜmIÇùiveS–eùiÚBackgroundCŞÜ
() const;

55 
vœtu®
 
CŞÜ
 
¶©fÜmAùiveS–eùiÚFÜegroundCŞÜ
() const;

56 
vœtu®
 
CŞÜ
 
¶©fÜmIÇùiveS–eùiÚFÜegroundCŞÜ
() const;

57 
vœtu®
 
CŞÜ
 
¶©fÜmAùiveTextS—rchHighlightCŞÜ
() const;

58 
vœtu®
 
CŞÜ
 
¶©fÜmIÇùiveTextS—rchHighlightCŞÜ
() const;

61 
vœtu®
 
sy¡emFÚt
(
´İId
, 
FÚtDesütiÚ
&) const;

62 
vœtu®
 
CŞÜ
 
sy¡emCŞÜ
(
cssV®ueId
) const;

64 
vœtu®
 
adju¡Slid”ThumbSize
(
R’d”Objeù
*) const;

67 
vœtu®
 
boŞ
 
·štCheckbox
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

68 
vœtu®
 
boŞ
 
·štRadio
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

69 
vœtu®
 
boŞ
 
·štBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

70 
vœtu®
 
boŞ
 
·štTextF›ld
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

71 
vœtu®
 
boŞ
 
·štSlid”T¿ck
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

72 
vœtu®
 
boŞ
 
·štSlid”Thumb
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

83 
vœtu®
 
boŞ
 
·štM’uLi¡
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

87 
£tDeçuÉFÚtSize
();

89 
	g´Ùeùed
:

90 
vœtu®
 
ÿ»tBlškIÁ”v®IÁ”Çl
() const;

92 
	g´iv©e
:

93 
R’d”ThemeChromiumWš
() { }

94 
vœtu®
 ~
R’d”ThemeChromiumWš
() { }

96 
d‘”mšeS‹
(
R’d”Objeù
*);

97 
d‘”mšeSlid”ThumbS‹
(
R’d”Objeù
*);

98 
d‘”mšeCÏssicS‹
(
R’d”Objeù
*);

100 
ThemeD©a
 
g‘ThemeD©a
(
R’d”Objeù
*);

102 
boŞ
 
·štTextF›ldIÁ”Çl
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&, bool);

	@RenderThemeMac.h

23 #iâdeà
R’d”ThemeMac_h


24 
	#R’d”ThemeMac_h


	)

27 #impÜˆ<
wtf
/
HashM­
.
h
>

28 #impÜˆ<
wtf
/
R‘ašPŒ
.
h
>

30 
şass
 
	gR’d”Prog»ss
;

32 #ifdeà
__OBJC__


33 @
şass
 
	gWebCÜeR’d”ThemeNÙifiÿtiÚOb£rv”
;

35 
şass
 
	gWebCÜeR’d”ThemeNÙifiÿtiÚOb£rv”
;

38 
Çme¥aû
 
	gWebCÜe
 {

40 
şass
 
	gR’d”StyË
;

42 şas 
	cR’d”ThemeMac
 : 
public
 
R’d”Theme
 {

43 
public
:

44 
PassRefPŒ
<
R’d”Theme
> 
ü—‹
();

47 
vœtu®
 
boŞ
 
cÚŒŞSuµÜtsTšts
(cÚ¡ 
R’d”Objeù
*) const;

50 
vœtu®
 
boŞ
 
suµÜtsCÚŒŞTšts
(ècÚ¡ {  
	gŒue
; }

52 
vœtu®
 
adju¡R•aštReù
(cÚ¡ 
R’d”Objeù
*, 
IÁReù
&);

54 
vœtu®
 
boŞ
 
isCÚŒŞStyËd
(cÚ¡ 
R’d”StyË
*, cÚ¡ 
BÜd”D©a
&,

55 cÚ¡ 
FlLay”
&, cÚ¡ 
CŞÜ
& 
backgroundCŞÜ
) const;

57 
vœtu®
 
CŞÜ
 
¶©fÜmAùiveS–eùiÚBackgroundCŞÜ
() const;

58 
vœtu®
 
CŞÜ
 
¶©fÜmIÇùiveS–eùiÚBackgroundCŞÜ
() const;

59 
vœtu®
 
CŞÜ
 
¶©fÜmAùiveLi¡BoxS–eùiÚBackgroundCŞÜ
() const;

60 
vœtu®
 
CŞÜ
 
¶©fÜmAùiveLi¡BoxS–eùiÚFÜegroundCŞÜ
() const;

61 
vœtu®
 
CŞÜ
 
¶©fÜmIÇùiveLi¡BoxS–eùiÚBackgroundCŞÜ
() const;

62 
vœtu®
 
CŞÜ
 
¶©fÜmIÇùiveLi¡BoxS–eùiÚFÜegroundCŞÜ
() const;

63 
vœtu®
 
CŞÜ
 
¶©fÜmFocusRšgCŞÜ
() const;

65 
vœtu®
 
SüŞlb¬CÚŒŞSize
 
süŞlb¬CÚŒŞSizeFÜP¬t
(
CÚŒŞP¬t
è{  
	gSm®lSüŞlb¬
; }

67 
vœtu®
 
¶©fÜmCŞÜsDidChªge
();

70 
vœtu®
 
sy¡emFÚt
(
cssV®ueId
, 
FÚtDesütiÚ
&) const;

72 
vœtu®
 
mšimumM’uLi¡Size
(
R’d”StyË
*) const;

74 
vœtu®
 
adju¡Slid”ThumbSize
(
R’d”Objeù
*) const;

76 
vœtu®
 
pİupIÁ”ÇlPaddšgLeá
(
R’d”StyË
*) const;

77 
vœtu®
 
pİupIÁ”ÇlPaddšgRight
(
R’d”StyË
*) const;

78 
vœtu®
 
pİupIÁ”ÇlPaddšgTİ
(
R’d”StyË
*) const;

79 
vœtu®
 
pİupIÁ”ÇlPaddšgBÙtom
(
R’d”StyË
*) const;

81 
vœtu®
 
boŞ
 
·štC­sLockIndiÿtÜ
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

83 #ià
ENABLE
(
PROGRESS_TAG
)

85 
vœtu®
 
ªim©iÚR•—tIÁ”v®FÜProg»ssB¬
(
R’d”Prog»ss
*) const;

87 
vœtu®
 
ªim©iÚDu¿tiÚFÜProg»ssB¬
(
R’d”Prog»ss
*) const;

90 
vœtu®
 
CŞÜ
 
sy¡emCŞÜ
(
cssV®ueId
) const;

92 
	g´Ùeùed
:

93 
vœtu®
 
boŞ
 
suµÜtsS–eùiÚFÜegroundCŞÜs
(ècÚ¡ {  
çl£
; }

95 
vœtu®
 
boŞ
 
·štTextF›ld
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

96 
vœtu®
 
adju¡TextF›ldStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

98 
vœtu®
 
boŞ
 
·štTextA»a
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

99 
vœtu®
 
adju¡TextA»aStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

101 
vœtu®
 
boŞ
 
·štM’uLi¡
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

102 
vœtu®
 
adju¡M’uLi¡StyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

104 
vœtu®
 
boŞ
 
·štM’uLi¡Bu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

105 
vœtu®
 
adju¡M’uLi¡Bu‰ÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

107 #ià
ENABLE
(
PROGRESS_TAG
)

108 
vœtu®
 
adju¡Prog»ssB¬StyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

109 
vœtu®
 
boŞ
 
·štProg»ssB¬
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

112 
vœtu®
 
boŞ
 
·štSlid”T¿ck
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

113 
vœtu®
 
adju¡Slid”T¿ckStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

115 
vœtu®
 
boŞ
 
·štSlid”Thumb
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

116 
vœtu®
 
adju¡Slid”ThumbStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

118 
vœtu®
 
boŞ
 
·štS—rchF›ld
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

119 
vœtu®
 
adju¡S—rchF›ldStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

121 
vœtu®
 
adju¡S—rchF›ldCªûlBu‰ÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

122 
vœtu®
 
boŞ
 
·štS—rchF›ldCªûlBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

124 
vœtu®
 
adju¡S—rchF›ldDecÜ©iÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

125 
vœtu®
 
boŞ
 
·štS—rchF›ldDecÜ©iÚ
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

127 
vœtu®
 
adju¡S—rchF›ldResuÉsDecÜ©iÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

128 
vœtu®
 
boŞ
 
·štS—rchF›ldResuÉsDecÜ©iÚ
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

130 
vœtu®
 
adju¡S—rchF›ldResuÉsBu‰ÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

131 
vœtu®
 
boŞ
 
·štS—rchF›ldResuÉsBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

133 #ià
ENABLE
(
VIDEO
)

134 
vœtu®
 
boŞ
 
·štMedŸFuÎsü“nBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

135 
vœtu®
 
boŞ
 
·štMedŸPÏyBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

136 
vœtu®
 
boŞ
 
·štMedŸMu‹Bu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

137 
vœtu®
 
boŞ
 
·štMedŸS“kBackBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

138 
vœtu®
 
boŞ
 
·štMedŸS“kFÜw¬dBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

139 
vœtu®
 
boŞ
 
·štMedŸSlid”T¿ck
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

140 
vœtu®
 
boŞ
 
·štMedŸSlid”Thumb
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

141 
vœtu®
 
boŞ
 
·štMedŸRewšdBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

142 
vœtu®
 
boŞ
 
·štMedŸR‘uºToR—ÉimeBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

143 
vœtu®
 
boŞ
 
·štMedŸToggËClo£dC­tiÚsBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

144 
vœtu®
 
boŞ
 
·štMedŸCÚŒŞsBackground
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

145 
vœtu®
 
boŞ
 
·štMedŸCu¼’tTime
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

146 
vœtu®
 
boŞ
 
·štMedŸTimeRemaššg
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

149 
vœtu®
 
SŒšg
 
exŒaMedŸCÚŒŞsStyËSh“t
();

151 
vœtu®
 
boŞ
 
shouldR’d”MedŸCÚŒŞP¬t
(
CÚŒŞP¬t
, 
EËm’t
*);

154 
	g´iv©e
:

155 
R’d”ThemeMac
();

156 
	gvœtu®
 ~
R’d”ThemeMac
();

158 
IÁReù
 
šæ©eReù
(cÚ¡ IÁReù&, cÚ¡ 
IÁSize
&, cÚ¡ * 
m¬gšs
, 
zoomLev–
 = 1.0f) const;

160 
FlßtReù
 
cÚv”tToPaštšgReù
(cÚ¡ 
R’d”Objeù
* 
šputR’d””
, cÚ¡ R’d”Objeù* 
·¹R’d””
, cÚ¡ FlßtReù& 
šputReù
, cÚ¡ 
IÁReù
& 
r
) const;

163 
NSCÚŒŞSize
 
cÚŒŞSizeFÜFÚt
(
R’d”StyË
*) const;

164 
NSCÚŒŞSize
 
cÚŒŞSizeFÜSy¡emFÚt
(
R’d”StyË
*) const;

165 
£tCÚŒŞSize
(
NSC–l
*, cÚ¡ 
IÁSize
* 
sizes
, cÚ¡ IÁSize& 
mšSize
, 
zoomLev–
 = 1.0f);

166 
£tSizeFromFÚt
(
R’d”StyË
*, cÚ¡ 
IÁSize
* 
sizes
) const;

167 
IÁSize
 
sizeFÜFÚt
(
R’d”StyË
*, cÚ¡ IÁSize* 
sizes
) const;

168 
IÁSize
 
sizeFÜSy¡emFÚt
(
R’d”StyË
*, cÚ¡ IÁSize* 
sizes
) const;

169 
£tFÚtFromCÚŒŞSize
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
NSCÚŒŞSize
) const;

171 
upd©eCheckedS‹
(
NSC–l
*, cÚ¡ 
R’d”Objeù
*);

172 
upd©eEÇbËdS‹
(
NSC–l
*, cÚ¡ 
R’d”Objeù
*);

173 
upd©eFocu£dS‹
(
NSC–l
*, cÚ¡ 
R’d”Objeù
*);

174 
upd©eP»s£dS‹
(
NSC–l
*, cÚ¡ 
R’d”Objeù
*);

178 
£tPİupBu‰ÚC–lS‹
(cÚ¡ 
R’d”Objeù
*, cÚ¡ 
IÁReù
&);

179 cÚ¡ 
IÁSize
* 
pİupBu‰ÚSizes
() const;

180 cÚ¡ * 
pİupBu‰ÚM¬gšs
() const;

181 cÚ¡ * 
pİupBu‰ÚPaddšg
(
NSCÚŒŞSize
) const;

182 
·štM’uLi¡Bu‰ÚG¿d›Ás
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

183 cÚ¡ 
IÁSize
* 
m’uLi¡Sizes
() const;

185 cÚ¡ 
IÁSize
* 
£¬chF›ldSizes
() const;

186 cÚ¡ 
IÁSize
* 
ÿnûlBu‰ÚSizes
() const;

187 cÚ¡ 
IÁSize
* 
»suÉsBu‰ÚSizes
() const;

188 
£tS—rchC–lS‹
(
R’d”Objeù
*, cÚ¡ 
IÁReù
&);

189 
£tS—rchF›ldSize
(
R’d”StyË
*) const;

191 
NSPİUpBu‰ÚC–l
* 
pİupBu‰Ú
() const;

192 
NSS—rchF›ldC–l
* 
£¬ch
() const;

193 
NSM’u
* 
£¬chM’uTem¶©e
() const;

194 
NSSlid”C–l
* 
¦id”ThumbHÜizÚl
() const;

195 
NSSlid”C–l
* 
¦id”ThumbV”tiÿl
() const;

197 
	g´iv©e
:

198 
mubË
 
R‘ašPŒ
<
NSPİUpBu‰ÚC–l
> 
m_pİupBu‰Ú
;

199 
mubË
 
	gR‘ašPŒ
<
	gNSS—rchF›ldC–l
> 
	gm_£¬ch
;

200 
mubË
 
	gR‘ašPŒ
<
	gNSM’u
> 
	gm_£¬chM’uTem¶©e
;

201 
mubË
 
	gR‘ašPŒ
<
	gNSSlid”C–l
> 
	gm_¦id”ThumbHÜizÚl
;

202 
mubË
 
	gR‘ašPŒ
<
	gNSSlid”C–l
> 
	gm_¦id”ThumbV”tiÿl
;

204 
boŞ
 
	gm_isSlid”ThumbHÜizÚlP»s£d
;

205 
boŞ
 
	gm_isSlid”ThumbV”tiÿlP»s£d
;

207 
mubË
 
	gHashM­
<, 
	gRGBA32
> 
	gm_sy¡emCŞÜCache
;

209 
	gR‘ašPŒ
<
	gWebCÜeR’d”ThemeNÙifiÿtiÚOb£rv”
> 
	gm_nÙifiÿtiÚOb£rv”
;

	@RenderThemeSafari.cpp

22 
	~"cÚfig.h
"

23 
	~"R’d”ThemeSaçri.h
"

24 
	~"R’d”ThemeWš.h
"

25 
	~"S‘tšgs.h
"

27 #ià
USE
(
SAFARI_THEME
)

29 
	~"CSSV®ueKeywÜds.h
"

30 
	~"Docum’t.h
"

31 
	~"EËm’t.h
"

32 
	~"F¿me.h
"

33 
	~"F¿meV›w.h
"

34 
	~"G¿phicsCÚ‹xt.h
"

35 
	~"HTMLIÅutEËm’t.h
"

36 
	~"HTMLMedŸEËm’t.h
"

37 
	~"HTMLNames.h
"

38 
	~"R’d”MedŸCÚŒŞs.h
"

39 
	~"R’d”Slid”.h
"

40 
	~"R’d”V›w.h
"

41 
	~"R‘ašPŒ.h
"

42 
	~"SoáLškšg.h
"

43 
	~"css¡yË£ËùÜ.h
"

44 
	~<CÜeG¿phics/CÜeG¿phics.h
>

46 
usšg
 
	g¡d
::
mš
;

50 
Çme¥aû
 
	gWebCÜe
 {

52 
usšg
 
Çme¥aû
 
	gHTMLNames
;

53 
usšg
 
Çme¥aû
 
	gSaçriTheme
;

56 
	gtİM¬gš
,

57 
	grightM¬gš
,

58 
	gbÙtomM¬gš
,

59 
	gËáM¬gš


63 
	gtİPaddšg
,

64 
	grightPaddšg
,

65 
	gbÙtomPaddšg
,

66 
	gËáPaddšg


69 
	gPassRefPŒ
<
	gR’d”Theme
> 
	gR’d”ThemeSaçri
::
ü—‹
()

71  
adİtRef
(
Ãw
 
R’d”ThemeSaçri
);

74 
	gPassRefPŒ
<
	gR’d”Theme
> R’d”Theme::
themeFÜPage
(
Page
* 
·ge
)

76 
R’d”Theme
* 
§çriTheme
 = 
R’d”ThemeSaçri
::
ü—‹
().
»Ëa£Ref
();

77 
R’d”Theme
* 
	gwšdowsTheme
 = 
R’d”ThemeWš
::
ü—‹
().
»Ëa£Ref
();

82 ià(
	gS‘tšgs
::
shouldPaštN©iveCÚŒŞs
()) {

83 
R’d”Theme
::
£tCu¡omFocusRšgCŞÜ
(
§çriTheme
->
¶©fÜmFocusRšgCŞÜ
());

84  
	gwšdowsTheme
;

86  
	g§çriTheme
;

89 #ifdeà
DEBUG_ALL


90 
SOFT_LINK_DEBUG_LIBRARY
(
SaçriTheme
)

92 
SOFT_LINK_LIBRARY
(
SaçriTheme
)

95 
SOFT_LINK
(
SaçriTheme
, 
·štThemeP¬t
, , 
__¡dÿÎ
, (
ThemeP¬t
 
·¹
, 
CGCÚ‹xtRef
 
cÚ‹xt
, cÚ¡ 
CGReù
& 
»ù
, 
NSCÚŒŞSize
 
size
, 
ThemeCÚŒŞS‹
 
¡©e
), (part, context,„ect, size, state))

96 #ià
defšed
(
SAFARI_THEME_VERSION
) && SAFARI_THEME_VERSION >= 2

97 
SOFT_LINK
(
SaçriTheme
, 
STPaštProg»ssIndiÿtÜ
, , 
APIENTRY
, (
Prog»ssIndiÿtÜTy³
 
ty³
, 
CGCÚ‹xtRef
 
cÚ‹xt
, cÚ¡ 
CGReù
& 
»ù
, 
NSCÚŒŞSize
 
size
, 
ThemeCÚŒŞS‹
 
¡©e
, 
v®ue
), (type, context,„ect, size, state, value))

99 
SOFT_LINK_OPTIONAL
(
SaçriTheme
, 
STCİyThemeCŞÜ
, 
CGCŞÜRef
, 
APIENTRY
, (
cŞÜ
, SaçriTheme::
ThemeCÚŒŞS‹
));

101 cÚ¡ 
	g¡FocusRšgCŞÜID
 = 4;

103 cÚ¡ 
	gaquaFocusRšgCŞÜ
 = 0xFF7DADD9;

105 
RGBA32
 
makeRGBAFromCGCŞÜ
(
CGCŞÜRef
 
cŞÜ
)

107 cÚ¡ 
CGFlßt
* 
	gcompÚ’ts
 = 
CGCŞÜG‘CompÚ’ts
(
cŞÜ
);

108  
makeRGBA
(255 * 
compÚ’ts
[0], 255 * components[1], 255 * components[2], 255 * components[3]);

111 
ThemeCÚŒŞS‹
 
	gR’d”ThemeSaçri
::
d‘”mšeS‹
(
R’d”Objeù
* 
o
) const

113 
ThemeCÚŒŞS‹
 
»suÉ
 = 0;

114 ià(
isAùive
(
o
))

115 
	g»suÉ
 |ğ
SaçriTheme
::
AùiveS‹
;

116 ià(
isEÇbËd
(
o
è&& !
isR—dOÆyCÚŒŞ
(o))

117 
	g»suÉ
 |ğ
SaçriTheme
::
EÇbËdS‹
;

118 ià(
isP»s£d
(
o
))

119 
	g»suÉ
 |ğ
SaçriTheme
::
P»s£dS‹
;

120 ià(
isChecked
(
o
))

121 
	g»suÉ
 |ğ
SaçriTheme
::
CheckedS‹
;

122 ià(
isInd‘”mš©e
(
o
))

123 
	g»suÉ
 |ğ
SaçriTheme
::
Ind‘”mš©eCheckedS‹
;

124 ià(
isFocu£d
(
o
))

125 
	g»suÉ
 |ğ
SaçriTheme
::
Focu£dS‹
;

126 ià(
isDeçuÉ
(
o
))

127 
	g»suÉ
 |ğ
SaçriTheme
::
DeçuÉS‹
;

128  
	g»suÉ
;

131 
NSCÚŒŞSize
 
cÚŒŞSizeFromReù
(cÚ¡ 
IÁReù
& 
»ù
, cÚ¡ 
IÁSize
 
sizes
[])

133 ià(
	gsizes
[
NSReguÏrCÚŒŞSize
].
height
(è=ğ
»ù
.height())

134  
NSReguÏrCÚŒŞSize
;

135 ià(
	gsizes
[
NSMšiCÚŒŞSize
].
height
(è=ğ
»ù
.height())

136  
NSMšiCÚŒŞSize
;

138  
	gNSSm®lCÚŒŞSize
;

141 
	gR’d”ThemeSaçri
::
R’d”ThemeSaçri
()

145 
R’d”ThemeSaçri
::~RenderThemeSafari()

149 
CŞÜ
 
R’d”ThemeSaçri
::
¶©fÜmAùiveS–eùiÚBackgroundCŞÜ
() const

151  
CŞÜ
(181, 213, 255);

154 
CŞÜ
 
	gR’d”ThemeSaçri
::
¶©fÜmIÇùiveS–eùiÚBackgroundCŞÜ
() const

156  
CŞÜ
(212, 212, 212);

159 
CŞÜ
 
	gR’d”ThemeSaçri
::
aùiveLi¡BoxS–eùiÚBackgroundCŞÜ
() const

162  
CŞÜ
(56, 117, 215);

165 
CŞÜ
 
	gR’d”ThemeSaçri
::
¶©fÜmFocusRšgCŞÜ
() const

167 
CŞÜ
 
focusRšgCŞÜ
;

169 ià(!
	gfocusRšgCŞÜ
.
isV®id
()) {

170 ià(
STCİyThemeCŞÜPŒ
()) {

171 
	gR‘ašPŒ
<
	gCGCŞÜRef
> 
cŞÜ
(
AdİtCF
, 
STCİyThemeCŞÜPŒ
()(
¡FocusRšgCŞÜID
, 
SaçriTheme
::
AùiveS‹
));

172 
	gfocusRšgCŞÜ
 = 
makeRGBAFromCGCŞÜ
(
cŞÜ
.
g‘
());

174 ià(!
	gfocusRšgCŞÜ
.
isV®id
())

175 
	gfocusRšgCŞÜ
 = 
aquaFocusRšgCŞÜ
;

178  
	gfocusRšgCŞÜ
;

181 
sy¡emFÚtSizeFÜCÚŒŞSize
(
NSCÚŒŞSize
 
cÚŒŞSize
)

183 
	gsizes
[] = { 13.0f, 11.0f, 9.0f };

185  
	gsizes
[
cÚŒŞSize
];

188 
	gR’d”ThemeSaçri
::
sy¡emFÚt
(
´İId
, 
FÚtDesütiÚ
& 
fÚtDesütiÚ
) const

190 
FÚtDesütiÚ
 
	gsy¡emFÚt
;

191 
FÚtDesütiÚ
 
	gsm®lSy¡emFÚt
;

192 
FÚtDesütiÚ
 
	gm’uFÚt
;

193 
FÚtDesütiÚ
 
	gÏb–FÚt
;

194 
FÚtDesütiÚ
 
	gmšiCÚŒŞFÚt
;

195 
FÚtDesütiÚ
 
	gsm®lCÚŒŞFÚt
;

196 
FÚtDesütiÚ
 
	gcÚŒŞFÚt
;

198 
FÚtDesütiÚ
* 
	gÿchedDesc
;

199 
	gfÚtSize
 = 0;

200 
	g´İId
) {

201 
	gCSSV®ueSm®lC­tiÚ
:

202 
ÿchedDesc
 = &
sm®lSy¡emFÚt
;

203 ià(!
	gsm®lSy¡emFÚt
.
isAbsŞu‹Size
())

204 
	gfÚtSize
 = 
sy¡emFÚtSizeFÜCÚŒŞSize
(
NSSm®lCÚŒŞSize
);

206 
	gCSSV®ueM’u
:

207 
ÿchedDesc
 = &
m’uFÚt
;

208 ià(!
	gm’uFÚt
.
isAbsŞu‹Size
())

209 
	gfÚtSize
 = 
sy¡emFÚtSizeFÜCÚŒŞSize
(
NSReguÏrCÚŒŞSize
);

211 
	gCSSV®ueStusB¬
:

212 
ÿchedDesc
 = &
Ïb–FÚt
;

213 ià(!
	gÏb–FÚt
.
isAbsŞu‹Size
())

214 
	gfÚtSize
 = 10.0f;

216 
	gCSSV®ueWebk™MšiCÚŒŞ
:

217 
ÿchedDesc
 = &
mšiCÚŒŞFÚt
;

218 ià(!
	gmšiCÚŒŞFÚt
.
isAbsŞu‹Size
())

219 
	gfÚtSize
 = 
sy¡emFÚtSizeFÜCÚŒŞSize
(
NSMšiCÚŒŞSize
);

221 
	gCSSV®ueWebk™Sm®lCÚŒŞ
:

222 
ÿchedDesc
 = &
sm®lCÚŒŞFÚt
;

223 ià(!
	gsm®lCÚŒŞFÚt
.
isAbsŞu‹Size
())

224 
	gfÚtSize
 = 
sy¡emFÚtSizeFÜCÚŒŞSize
(
NSSm®lCÚŒŞSize
);

226 
	gCSSV®ueWebk™CÚŒŞ
:

227 
ÿchedDesc
 = &
cÚŒŞFÚt
;

228 ià(!
	gcÚŒŞFÚt
.
isAbsŞu‹Size
())

229 
	gfÚtSize
 = 
sy¡emFÚtSizeFÜCÚŒŞSize
(
NSReguÏrCÚŒŞSize
);

232 
ÿchedDesc
 = &
sy¡emFÚt
;

233 ià(!
	gsy¡emFÚt
.
isAbsŞu‹Size
())

234 
	gfÚtSize
 = 13.0f;

237 ià(
	gfÚtSize
) {

238 
	gÿchedDesc
->
£tIsAbsŞu‹Size
(
Œue
);

239 
	gÿchedDesc
->
£tG’”icFamy
(
FÚtDesütiÚ
::
NoFamy
);

240 
	gÿchedDesc
->
fœ¡Famy
().
£tFamy
("Lucida Grande");

241 
	gÿchedDesc
->
£tS³cif›dSize
(
fÚtSize
);

242 
	gÿchedDesc
->
£tWeight
(
FÚtWeightNÜm®
);

243 
	gÿchedDesc
->
£tIlic
(
çl£
);

245 
	gfÚtDesütiÚ
 = *
ÿchedDesc
;

248 
boŞ
 
	gR’d”ThemeSaçri
::
isCÚŒŞStyËd
(cÚ¡ 
R’d”StyË
* 
¡yË
, cÚ¡ 
BÜd”D©a
& 
bÜd”
,

249 cÚ¡ 
FlLay”
& 
background
, cÚ¡ 
CŞÜ
& 
backgroundCŞÜ
) const

252 ià(!
SaçriThemeLib¿ry
())

253  
	gŒue
;

255 ià(
	g¡yË
->
­³¬ªû
(è=ğ
TextF›ldP¬t
 || 
¡yË
->­³¬ªû(è=ğ
TextA»aP¬t
 || styË->­³¬ªû(è=ğ
Li¡boxP¬t
)

256  
¡yË
->
bÜd”
() != border;

257  
	gR’d”Theme
::
isCÚŒŞStyËd
(
¡yË
, 
bÜd”
, 
background
, 
backgroundCŞÜ
);

260 
	gR’d”ThemeSaçri
::
adju¡R•aštReù
(cÚ¡ 
R’d”Objeù
* 
o
, 
IÁReù
& 
r
)

262 
NSCÚŒŞSize
 
	gcÚŒŞSize
 = 
cÚŒŞSizeFÜFÚt
(
o
->
¡yË
());

264 
	go
->
¡yË
()->
­³¬ªû
()) {

265 
	gCheckboxP¬t
: {

268 
r
 = 
šæ©eReù
Ô, 
checkboxSizes
()[
cÚŒŞSize
], 
checkboxM¬gšs
(controlSize));

271 
	gRadioP¬t
: {

274 
r
 = 
šæ©eReù
Ô, 
¿dioSizes
()[
cÚŒŞSize
], 
¿dioM¬gšs
(controlSize));

277 
	gPushBu‰ÚP¬t
:

278 
DeçuÉBu‰ÚP¬t
:

279 
Bu‰ÚP¬t
: {

282 ià(
r
.
height
(è<ğ
bu‰ÚSizes
()[
NSReguÏrCÚŒŞSize
].height())

283 
r
 = 
šæ©eReù
Ô, 
bu‰ÚSizes
()[
cÚŒŞSize
], 
bu‰ÚM¬gšs
(controlSize));

286 
	gM’uli¡P¬t
: {

287 
r
 = 
šæ©eReù
Ô, 
pİupBu‰ÚSizes
()[
cÚŒŞSize
], 
pİupBu‰ÚM¬gšs
(controlSize));

295 
IÁReù
 
	gR’d”ThemeSaçri
::
šæ©eReù
(cÚ¡ IÁReù& 
r
, cÚ¡ 
IÁSize
& 
size
, cÚ¡ * 
m¬gšs
) const

299 
	gwidthD–
 = 
r
.
width
(è- (
size
.width(è+ 
m¬gšs
[
ËáM¬gš
] + m¬gšs[
rightM¬gš
]);

300 
	gheightD–
 = 
r
.
height
(è- (
size
.height(è+ 
m¬gšs
[
tİM¬gš
] + m¬gšs[
bÙtomM¬gš
]);

301 
IÁReù
 
»suÉ
(
r
);

302 ià(
	gwidthD–
 < 0) {

303 
	g»suÉ
.
£tX
(
»suÉ
.
x
(è- 
m¬gšs
[
ËáM¬gš
]);

304 
	g»suÉ
.
£tWidth
(
»suÉ
.
width
(è- 
widthD–
);

306 ià(
	gheightD–
 < 0) {

307 
	g»suÉ
.
£tY
(
»suÉ
.
y
(è- 
m¬gšs
[
tİM¬gš
]);

308 
	g»suÉ
.
£tHeight
(
»suÉ
.
height
(è- 
heightD–
);

310  
	g»suÉ
;

313 
	gR’d”ThemeSaçri
::
ba£lšePos™iÚ
(cÚ¡ 
R’d”Objeù
* 
o
) const

315 ià(!
o
->
isBox
())

318 ià(
	go
->
¡yË
()->
­³¬ªû
(è=ğ
CheckboxP¬t
 || 
o
->¡yË()->­³¬ªû(è=ğ
RadioP¬t
) {

319 cÚ¡ 
R’d”Box
* 
box
 = 
toR’d”Box
(
o
);

320  
	gbox
->
m¬gšTİ
(è+ box->
height
() - 2;

323  
	gR’d”Theme
::
ba£lšePos™iÚ
(
o
);

326 
boŞ
 
	gR’d”ThemeSaçri
::
cÚŒŞSuµÜtsTšts
(cÚ¡ 
R’d”Objeù
* 
o
) const

328 ià(!
isEÇbËd
(
o
))

329  
çl£
;

332 ià(
	go
->
¡yË
()->
­³¬ªû
(è=ğ
CheckboxP¬t
)

333  
isChecked
(
o
);

336  
	gŒue
;

339 
NSCÚŒŞSize
 
	gR’d”ThemeSaçri
::
cÚŒŞSizeFÜFÚt
(
R’d”StyË
* 
¡yË
) const

341 
fÚtSize
 = 
¡yË
->fontSize();

342 ià(
	gfÚtSize
 >= 16)

343  
NSReguÏrCÚŒŞSize
;

344 ià(
	gfÚtSize
 >= 11)

345  
NSSm®lCÚŒŞSize
;

346  
	gNSMšiCÚŒŞSize
;

364 
IÁSize
 
	gR’d”ThemeSaçri
::
sizeFÜFÚt
(
R’d”StyË
* 
¡yË
, cÚ¡ IÁSize* 
sizes
) const

366  
	gsizes
[
cÚŒŞSizeFÜFÚt
(
¡yË
)];

369 
IÁSize
 
	gR’d”ThemeSaçri
::
sizeFÜSy¡emFÚt
(
R’d”StyË
* 
¡yË
, cÚ¡ IÁSize* 
sizes
) const

371  
	gsizes
[
cÚŒŞSizeFÜSy¡emFÚt
(
¡yË
)];

374 
	gR’d”ThemeSaçri
::
£tSizeFromFÚt
(
R’d”StyË
* 
¡yË
, cÚ¡ 
IÁSize
* 
sizes
) const

377 
IÁSize
 
	gsize
 = 
sizeFÜFÚt
(
¡yË
, 
sizes
);

378 ià(
	g¡yË
->
width
().
isIÁršsicOrAuto
(è&& 
	gsize
.width() > 0)

379 
	g¡yË
->
£tWidth
(
L’gth
(
size
.
width
(), 
Fixed
));

380 ià(
	g¡yË
->
height
().
isAuto
(è&& 
	gsize
.height() > 0)

381 
	g¡yË
->
£tHeight
(
L’gth
(
size
.
height
(), 
Fixed
));

384 
	gR’d”ThemeSaçri
::
£tFÚtFromCÚŒŞSize
(
CSSStyËS–eùÜ
* 
£ËùÜ
, 
R’d”StyË
* 
¡yË
, 
NSCÚŒŞSize
 
cÚŒŞSize
) const

386 
FÚtDesütiÚ
 
	gfÚtDesütiÚ
;

387 
	gfÚtDesütiÚ
.
£tIsAbsŞu‹Size
(
Œue
);

388 
	gfÚtDesütiÚ
.
£tG’”icFamy
(
FÚtDesütiÚ
::
S”ifFamy
);

390 
	gfÚtSize
 = 
sy¡emFÚtSizeFÜCÚŒŞSize
(
cÚŒŞSize
);

391 
	gfÚtDesütiÚ
.
fœ¡Famy
().
£tFamy
("Lucida Grande");

392 
	gfÚtDesütiÚ
.
£tCompu‹dSize
(
fÚtSize
);

393 
	gfÚtDesütiÚ
.
£tS³cif›dSize
(
fÚtSize
);

396 
	g¡yË
->
£tLšeHeight
(
R’d”StyË
::
š™ŸlLšeHeight
());

398 ià(
	g¡yË
->
£tFÚtDesütiÚ
(
fÚtDesütiÚ
))

399 
	g¡yË
->
fÚt
().
upd©e
(
£ËùÜ
->
fÚtS–eùÜ
());

402 
NSCÚŒŞSize
 
	gR’d”ThemeSaçri
::
cÚŒŞSizeFÜSy¡emFÚt
(
R’d”StyË
* 
¡yË
) const

404 
fÚtSize
 = 
¡yË
->fontSize();

405 ià(
	gfÚtSize
 >= 13)

406  
NSReguÏrCÚŒŞSize
;

407 ià(
	gfÚtSize
 >= 11)

408  
NSSm®lCÚŒŞSize
;

409  
	gNSMšiCÚŒŞSize
;

412 
boŞ
 
	gR’d”ThemeSaçri
::
·štCheckbox
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

414 
ASSERT
(
SaçriThemeLib¿ry
());

416 
NSCÚŒŞSize
 
	gcÚŒŞSize
 = 
cÚŒŞSizeFÜFÚt
(
o
->
¡yË
());

418 
IÁReù
 
	gšæ©edReù
 = 
šæ©eReù
(
r
, 
checkboxSizes
()[
cÚŒŞSize
], 
checkboxM¬gšs
(controlSize));

419 
·štThemeP¬t
(
SaçriTheme
::
CheckboxP¬t
, 
·štInfo
.
cÚ‹xt
->
¶©fÜmCÚ‹xt
(), 
šæ©edReù
, 
cÚŒŞSize
, 
d‘”mšeS‹
(
o
));

421  
	gçl£
;

424 cÚ¡ 
IÁSize
* 
	gR’d”ThemeSaçri
::
checkboxSizes
() const

426 cÚ¡ 
IÁSize
 
sizes
[3] = { IntSize(14, 14), IntSize(12, 12), IntSize(10, 10) };

427  
	gsizes
;

430 cÚ¡ * 
	gR’d”ThemeSaçri
::
checkboxM¬gšs
(
NSCÚŒŞSize
 
cÚŒŞSize
) const

432 cÚ¡ 
m¬gšs
[3][4] =

438  
	gm¬gšs
[
cÚŒŞSize
];

441 
	gR’d”ThemeSaçri
::
£tCheckboxSize
(
R’d”StyË
* 
¡yË
) const

444 ià(!
¡yË
->
width
().
isIÁršsicOrAuto
(è&& !¡yË->
height
().
isAuto
())

448 
£tSizeFromFÚt
(
¡yË
, 
checkboxSizes
());

451 
boŞ
 
	gR’d”ThemeSaçri
::
·štRadio
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

453 
ASSERT
(
SaçriThemeLib¿ry
());

455 
NSCÚŒŞSize
 
	gcÚŒŞSize
 = 
cÚŒŞSizeFÜFÚt
(
o
->
¡yË
());

457 
IÁReù
 
	gšæ©edReù
 = 
šæ©eReù
(
r
, 
¿dioSizes
()[
cÚŒŞSize
], 
¿dioM¬gšs
(controlSize));

458 
·štThemeP¬t
(
RadioBu‰ÚP¬t
, 
·štInfo
.
cÚ‹xt
->
¶©fÜmCÚ‹xt
(), 
šæ©edReù
, 
cÚŒŞSize
, 
d‘”mšeS‹
(
o
));

460  
	gçl£
;

463 cÚ¡ 
IÁSize
* 
	gR’d”ThemeSaçri
::
¿dioSizes
() const

465 cÚ¡ 
IÁSize
 
sizes
[3] = { IntSize(14, 15), IntSize(12, 13), IntSize(10, 10) };

466  
	gsizes
;

469 cÚ¡ * 
	gR’d”ThemeSaçri
::
¿dioM¬gšs
(
NSCÚŒŞSize
 
cÚŒŞSize
) const

471 cÚ¡ 
m¬gšs
[3][4] =

477  
	gm¬gšs
[
cÚŒŞSize
];

480 
	gR’d”ThemeSaçri
::
£tRadioSize
(
R’d”StyË
* 
¡yË
) const

483 ià(!
¡yË
->
width
().
isIÁršsicOrAuto
(è&& !¡yË->
height
().
isAuto
())

487 
£tSizeFromFÚt
(
¡yË
, 
¿dioSizes
());

490 
	gR’d”ThemeSaçri
::
£tBu‰ÚPaddšgFromCÚŒŞSize
(
R’d”StyË
* 
¡yË
, 
NSCÚŒŞSize
 
size
) const

497 cÚ¡ 
	g·ddšg
 = 8;

498 
	g¡yË
->
£tPaddšgLeá
(
L’gth
(
·ddšg
, 
Fixed
));

499 
	g¡yË
->
£tPaddšgRight
(
L’gth
(
·ddšg
, 
Fixed
));

500 
	g¡yË
->
£tPaddšgTİ
(
L’gth
(0, 
Fixed
));

501 
	g¡yË
->
£tPaddšgBÙtom
(
L’gth
(0, 
Fixed
));

504 
	gR’d”ThemeSaçri
::
adju¡Bu‰ÚStyË
(
CSSStyËS–eùÜ
* 
£ËùÜ
, 
R’d”StyË
* 
¡yË
, 
EËm’t
* 
e
) const

516 
NSCÚŒŞSize
 
	gcÚŒŞSize
 = 
cÚŒŞSizeFÜFÚt
(
¡yË
);

518 ià(
	g¡yË
->
­³¬ªû
(è=ğ
PushBu‰ÚP¬t
) {

520 
¡yË
->
»£tBÜd”
();

523 
	g¡yË
->
£tHeight
(
L’gth
(
Auto
));

526 
	g¡yË
->
£tWh™eS·û
(
PRE
);

529 
£tBu‰ÚSize
(
¡yË
);

532 
£tBu‰ÚPaddšgFromCÚŒŞSize
(
¡yË
, 
cÚŒŞSize
);

537 
£tFÚtFromCÚŒŞSize
(
£ËùÜ
, 
¡yË
, 
cÚŒŞSize
);

540 
	g¡yË
->
£tMšHeight
(
L’gth
(15, 
Fixed
));

543 
	g¡yË
->
»£tBÜd”Tİ
();

544 
	g¡yË
->
»£tBÜd”BÙtom
();

548 cÚ¡ 
IÁSize
* 
	gR’d”ThemeSaçri
::
bu‰ÚSizes
() const

550 cÚ¡ 
IÁSize
 
sizes
[3] = { IntSize(0, 21), IntSize(0, 18), IntSize(0, 15) };

551  
	gsizes
;

554 cÚ¡ * 
	gR’d”ThemeSaçri
::
bu‰ÚM¬gšs
(
NSCÚŒŞSize
 
cÚŒŞSize
) const

556 cÚ¡ 
m¬gšs
[3][4] =

562  
	gm¬gšs
[
cÚŒŞSize
];

565 
	gR’d”ThemeSaçri
::
£tBu‰ÚSize
(
R’d”StyË
* 
¡yË
) const

568 ià(!
¡yË
->
width
().
isIÁršsicOrAuto
(è&& !¡yË->
height
().
isAuto
())

572 
£tSizeFromFÚt
(
¡yË
, 
bu‰ÚSizes
());

575 
boŞ
 
	gR’d”ThemeSaçri
::
·štBu‰Ú
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

577 
ASSERT
(
SaçriThemeLib¿ry
());

582 
NSCÚŒŞSize
 
	gcÚŒŞSize
 = 
cÚŒŞSizeFromReù
(
r
, 
bu‰ÚSizes
());

583 
IÁReù
 
	gšæ©edReù
 = 
r
;

585 
ThemeP¬t
 
	g·¹
;

586 ià(
	gr
.
height
(è<ğ
bu‰ÚSizes
()[
NSReguÏrCÚŒŞSize
].height()) {

588 
·¹
 = 
SaçriTheme
::
PushBu‰ÚP¬t
;

590 
IÁSize
 
	gsize
 = 
bu‰ÚSizes
()[
cÚŒŞSize
];

591 
	gsize
.
£tWidth
(
r
.
width
());

594 ià(
	gšæ©edReù
.
height
(è> 
	gsize
.height()) {

595 
	gšæ©edReù
.
£tY
(
šæ©edReù
.
y
(è+ (šæ©edReù.
height
(è- 
size
.height()) / 2);

596 
	gšæ©edReù
.
£tHeight
(
size
.
height
());

600 
	gšæ©edReù
 = 
šæ©eReù
(
šæ©edReù
, 
size
, 
bu‰ÚM¬gšs
(
cÚŒŞSize
));

602 
	g·¹
 = 
SaçriTheme
::
Squ¬eBu‰ÚP¬t
;

604 
·štThemeP¬t
(
·¹
, 
·štInfo
.
cÚ‹xt
->
¶©fÜmCÚ‹xt
(), 
šæ©edReù
, 
cÚŒŞSize
, 
d‘”mšeS‹
(
o
));

605  
	gçl£
;

608 
boŞ
 
	gR’d”ThemeSaçri
::
·štTextF›ld
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

610 
ASSERT
(
SaçriThemeLib¿ry
());

612 
·štThemeP¬t
(
SaçriTheme
::
TextF›ldP¬t
, 
·štInfo
.
cÚ‹xt
->
¶©fÜmCÚ‹xt
(), 
r
, (
NSCÚŒŞSize
)0, 
d‘”mšeS‹
(
o
è& ~
Focu£dS‹
);

613  
	gçl£
;

616 
	gR’d”ThemeSaçri
::
adju¡TextF›ldStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const

620 
boŞ
 
	gR’d”ThemeSaçri
::
·štC­sLockIndiÿtÜ
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

622 #ià
defšed
(
SAFARI_THEME_VERSION
) && SAFARI_THEME_VERSION >= 1

623 
ASSERT
(
SaçriThemeLib¿ry
());

625 ià(
	g·štInfo
.
	gcÚ‹xt
->
·štšgDi§bËd
())

626  
	gŒue
;

628 
·štThemeP¬t
(
C­sLockP¬t
, 
·štInfo
.
cÚ‹xt
->
¶©fÜmCÚ‹xt
(), 
r
, (
NSCÚŒŞSize
)0, (
ThemeCÚŒŞS‹
)0);

630  
	gçl£
;

632  
	gŒue
;

636 
boŞ
 
	gR’d”ThemeSaçri
::
·štTextA»a
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

638 
ASSERT
(
SaçriThemeLib¿ry
());

640 
·štThemeP¬t
(
SaçriTheme
::
TextA»aP¬t
, 
·štInfo
.
cÚ‹xt
->
¶©fÜmCÚ‹xt
(), 
r
, (
NSCÚŒŞSize
)0, 
d‘”mšeS‹
(
o
è& ~
Focu£dS‹
);

641  
	gçl£
;

644 
	gR’d”ThemeSaçri
::
adju¡TextA»aStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const

648 cÚ¡ * 
	gR’d”ThemeSaçri
::
pİupBu‰ÚM¬gšs
(
NSCÚŒŞSize
 
size
) const

650 cÚ¡ 
m¬gšs
[3][4] =

656  
	gm¬gšs
[
size
];

659 cÚ¡ 
IÁSize
* 
	gR’d”ThemeSaçri
::
pİupBu‰ÚSizes
() const

661 cÚ¡ 
IÁSize
 
sizes
[3] = { IntSize(0, 21), IntSize(0, 18), IntSize(0, 15) };

662  
	gsizes
;

665 cÚ¡ * 
	gR’d”ThemeSaçri
::
pİupBu‰ÚPaddšg
(
NSCÚŒŞSize
 
size
) const

667 cÚ¡ 
·ddšg
[3][4] =

673  
	g·ddšg
[
size
];

676 
boŞ
 
	gR’d”ThemeSaçri
::
·štM’uLi¡
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
šfo
, cÚ¡ 
IÁReù
& 
r
)

678 
ASSERT
(
SaçriThemeLib¿ry
());

680 
NSCÚŒŞSize
 
	gcÚŒŞSize
 = 
cÚŒŞSizeFromReù
(
r
, 
pİupBu‰ÚSizes
());

681 
IÁReù
 
	gšæ©edReù
 = 
r
;

682 
IÁSize
 
	gsize
 = 
pİupBu‰ÚSizes
()[
cÚŒŞSize
];

683 
	gsize
.
£tWidth
(
r
.
width
());

686 ià(
	gr
.
width
(è>ğ
mšimumM’uLi¡Size
(
o
->
¡yË
()))

687 
šæ©edReù
 = 
šæ©eReù
(šæ©edReù, 
size
, 
pİupBu‰ÚM¬gšs
(
cÚŒŞSize
));

689 
·štThemeP¬t
(
DrİDownBu‰ÚP¬t
, 
šfo
.
cÚ‹xt
->
¶©fÜmCÚ‹xt
(), 
šæ©edReù
, 
cÚŒŞSize
, 
d‘”mšeS‹
(
o
));

691  
	gçl£
;

694 cÚ¡ 
	gba£FÚtSize
 = 11.0f;

695 cÚ¡ 
	gba£A¼owHeight
 = 5.0f;

696 cÚ¡ 
	gba£A¼owWidth
 = 7.0f;

697 cÚ¡ 
	g¬rowPaddšgLeá
 = 5;

698 cÚ¡ 
	g¬rowPaddšgRight
 = 5;

699 cÚ¡ 
	g·ddšgBefÜeS•¬©Ü
 = 4;

700 cÚ¡ 
	gba£BÜd”Radius
 = 5;

701 cÚ¡ 
	g¡yËdPİupPaddšgLeá
 = 8;

702 cÚ¡ 
	g¡yËdPİupPaddšgTİ
 = 1;

703 cÚ¡ 
	g¡yËdPİupPaddšgBÙtom
 = 2;

705 
TİG¿d›ÁIÁ”pŞ©e
(* 
šfo
, cÚ¡ 
CGFlßt
* 
šD©a
, CGFlßt* 
outD©a
)

707 
	gd¬k
[4] = { 1.0f, 1.0f, 1.0f, 0.4f };

708 
	glight
[4] = { 1.0f, 1.0f, 1.0f, 0.15f };

709 
	ga
 = 
šD©a
[0];

710 
	gi
 = 0;

711 
	gi
 = 0; i < 4; i++)

712 
	goutD©a
[
i
] = (1.0à- 
a
è* 
d¬k
[i] +‡ * 
light
[i];

715 
BÙtomG¿d›ÁIÁ”pŞ©e
(* 
šfo
, cÚ¡ 
CGFlßt
* 
šD©a
, CGFlßt* 
outD©a
)

717 
	gd¬k
[4] = { 1.0f, 1.0f, 1.0f, 0.0f };

718 
	glight
[4] = { 1.0f, 1.0f, 1.0f, 0.3f };

719 
	ga
 = 
šD©a
[0];

720 
	gi
 = 0;

721 
	gi
 = 0; i < 4; i++)

722 
	goutD©a
[
i
] = (1.0à- 
a
è* 
d¬k
[i] +‡ * 
light
[i];

725 
MašG¿d›ÁIÁ”pŞ©e
(* 
šfo
, cÚ¡ 
CGFlßt
* 
šD©a
, CGFlßt* 
outD©a
)

727 
	gd¬k
[4] = { 0.0f, 0.0f, 0.0f, 0.15f };

728 
	glight
[4] = { 0.0f, 0.0f, 0.0f, 0.0f };

729 
	ga
 = 
šD©a
[0];

730 
	gi
 = 0;

731 
	gi
 = 0; i < 4; i++)

732 
	goutD©a
[
i
] = (1.0à- 
a
è* 
d¬k
[i] +‡ * 
light
[i];

735 
T¿ckG¿d›ÁIÁ”pŞ©e
(* 
šfo
, cÚ¡ 
CGFlßt
* 
šD©a
, CGFlßt* 
outD©a
)

737 
	gd¬k
[4] = { 0.0f, 0.0f, 0.0f, 0.678f };

738 
	glight
[4] = { 0.0f, 0.0f, 0.0f, 0.13f };

739 
	ga
 = 
šD©a
[0];

740 
	gi
 = 0;

741 
	gi
 = 0; i < 4; i++)

742 
	goutD©a
[
i
] = (1.0à- 
a
è* 
d¬k
[i] +‡ * 
light
[i];

745 
	gR’d”ThemeSaçri
::
·štM’uLi¡Bu‰ÚG¿d›Ás
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

747 ià(
	gr
.
isEm±y
())

750 
CGCÚ‹xtRef
 
	gcÚ‹xt
 = 
·štInfo
.
cÚ‹xt
->
¶©fÜmCÚ‹xt
();

752 
	g·štInfo
.
	gcÚ‹xt
->
§ve
();

754 
IÁSize
 
	gtİLeáRadius
;

755 
IÁSize
 
	gtİRightRadius
;

756 
IÁSize
 
	gbÙtomLeáRadius
;

757 
IÁSize
 
	gbÙtomRightRadius
;

759 
	go
->
¡yË
()->
g‘BÜd”RadiiFÜReù
(
r
, 
tİLeáRadius
, 
tİRightRadius
, 
bÙtomLeáRadius
, 
bÙtomRightRadius
);

761 
	g¿dius
 = 
tİLeáRadius
.
width
();

763 
	gR‘ašPŒ
<
	gCGCŞÜS·ûRef
> 
c¥aû
(
AdİtCF
, 
CGCŞÜS·ûC»©eDeviûRGB
());

765 
FlßtReù
 
tİG¿d›Á
(
r
.
x
(),„.
y
(),„.
width
(),„.
height
() / 2.0f);

766 
CGFunùiÚC®lbacks
 
	gtİC®lbacks
 = { 0, 
TİG¿d›ÁIÁ”pŞ©e
, 
NULL
 };

767 
	gR‘ašPŒ
<
	gCGFunùiÚRef
> 
tİFunùiÚ
(
AdİtCF
, 
CGFunùiÚC»©e
(
NULL
, 1, NULL, 4, NULL, &
tİC®lbacks
));

768 
	gR‘ašPŒ
<
	gCGShadšgRef
> 
tİShadšg
(
AdİtCF
, 
CGShadšgC»©eAxŸl
(
c¥aû
.
g‘
(), 
CGPoštMake
(
tİG¿d›Á
.
x
(),İG¿d›Á.
y
()), CGPoštMakeÑİG¿d›Á.x(),İG¿d›Á.
bÙtom
()), 
tİFunùiÚ
.g‘(), 
çl£
, false));

770 
FlßtReù
 
bÙtomG¿d›Á
(
r
.
x
(è+ 
¿dius
,„.
y
(è+„.
height
(è/ 2.0f,„.
width
() - 2.0f *„adius,„.height() / 2.0f);

771 
CGFunùiÚC®lbacks
 
	gbÙtomC®lbacks
 = { 0, 
BÙtomG¿d›ÁIÁ”pŞ©e
, 
NULL
 };

772 
	gR‘ašPŒ
<
	gCGFunùiÚRef
> 
bÙtomFunùiÚ
(
AdİtCF
, 
CGFunùiÚC»©e
(
NULL
, 1, NULL, 4, NULL, &
bÙtomC®lbacks
));

773 
	gR‘ašPŒ
<
	gCGShadšgRef
> 
bÙtomShadšg
(
AdİtCF
, 
CGShadšgC»©eAxŸl
(
c¥aû
.
g‘
(), 
CGPoštMake
(
bÙtomG¿d›Á
.
x
(), bÙtomG¿d›Á.
y
()), CGPoštMake(bÙtomG¿d›Á.x(), bÙtomG¿d›Á.
bÙtom
()), 
bÙtomFunùiÚ
.g‘(), 
çl£
, false));

775 
CGFunùiÚC®lbacks
 
	gmašC®lbacks
 = { 0, 
MašG¿d›ÁIÁ”pŞ©e
, 
NULL
 };

776 
	gR‘ašPŒ
<
	gCGFunùiÚRef
> 
mašFunùiÚ
(
AdİtCF
, 
CGFunùiÚC»©e
(
NULL
, 1, NULL, 4, NULL, &
mašC®lbacks
));

777 
	gR‘ašPŒ
<
	gCGShadšgRef
> 
mašShadšg
(
AdİtCF
, 
CGShadšgC»©eAxŸl
(
c¥aû
.
g‘
(), 
CGPoštMake
(
r
.
x
(),„.
y
()), CGPoštMakeÔ.x(),„.
bÙtom
()), 
mašFunùiÚ
.g‘(), 
çl£
, false));

779 
	gR‘ašPŒ
<
	gCGShadšgRef
> 
ËáShadšg
(
AdİtCF
, 
CGShadšgC»©eAxŸl
(
c¥aû
.
g‘
(), 
CGPoštMake
(
r
.
x
(),„.
y
()), CGPoštMakeÔ.x(è+ 
¿dius
,„.y()), 
mašFunùiÚ
.g‘(), 
çl£
, false));

781 
	gR‘ašPŒ
<
	gCGShadšgRef
> 
rightShadšg
(
AdİtCF
, 
CGShadšgC»©eAxŸl
(
c¥aû
.
g‘
(), 
CGPoštMake
(
r
.
right
(),„.
y
()), CGPoštMakeÔ.right(è- 
¿dius
,„.y()), 
mašFunùiÚ
.g‘(), 
çl£
, false));

782 
	g·štInfo
.
	gcÚ‹xt
->
§ve
();

783 
CGCÚ‹xtClToReù
(
cÚ‹xt
, 
r
);

784 
	g·štInfo
.
	gcÚ‹xt
->
addRoundedReùCl
(
r
, 
tİLeáRadius
, 
tİRightRadius
, 
bÙtomLeáRadius
, 
bÙtomRightRadius
);

785 
CGCÚ‹xtD¿wShadšg
(
cÚ‹xt
, 
mašShadšg
.
g‘
());

786 
	g·štInfo
.
	gcÚ‹xt
->
»¡Üe
();

788 
	g·štInfo
.
	gcÚ‹xt
->
§ve
();

789 
CGCÚ‹xtClToReù
(
cÚ‹xt
, 
tİG¿d›Á
);

790 
	g·štInfo
.
	gcÚ‹xt
->
addRoundedReùCl
(
’şosšgIÁReù
(
tİG¿d›Á
), 
tİLeáRadius
, 
tİRightRadius
, 
IÁSize
(), IntSize());

791 
CGCÚ‹xtD¿wShadšg
(
cÚ‹xt
, 
tİShadšg
.
g‘
());

792 
	g·štInfo
.
	gcÚ‹xt
->
»¡Üe
();

794 ià(!
	gbÙtomG¿d›Á
.
isEm±y
()) {

795 
	g·štInfo
.
	gcÚ‹xt
->
§ve
();

796 
CGCÚ‹xtClToReù
(
cÚ‹xt
, 
bÙtomG¿d›Á
);

797 
	g·štInfo
.
	gcÚ‹xt
->
addRoundedReùCl
(
’şosšgIÁReù
(
bÙtomG¿d›Á
), 
IÁSize
(), IÁSize(), 
bÙtomLeáRadius
, 
bÙtomRightRadius
);

798 
CGCÚ‹xtD¿wShadšg
(
cÚ‹xt
, 
bÙtomShadšg
.
g‘
());

799 
	g·štInfo
.
	gcÚ‹xt
->
»¡Üe
();

802 
	g·štInfo
.
	gcÚ‹xt
->
§ve
();

803 
CGCÚ‹xtClToReù
(
cÚ‹xt
, 
r
);

804 
	g·štInfo
.
	gcÚ‹xt
->
addRoundedReùCl
(
r
, 
tİLeáRadius
, 
tİRightRadius
, 
bÙtomLeáRadius
, 
bÙtomRightRadius
);

805 
CGCÚ‹xtD¿wShadšg
(
cÚ‹xt
, 
ËáShadšg
.
g‘
());

806 
CGCÚ‹xtD¿wShadšg
(
cÚ‹xt
, 
rightShadšg
.
g‘
());

807 
	g·štInfo
.
	gcÚ‹xt
->
»¡Üe
();

809 
	g·štInfo
.
	gcÚ‹xt
->
»¡Üe
();

812 
boŞ
 
	gR’d”ThemeSaçri
::
·štM’uLi¡Bu‰Ú
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

814 
IÁReù
 
	gbounds
 = IÁReù(
r
.
x
(è+ 
o
->
¡yË
()->
bÜd”LeáWidth
(),

815 
r
.
y
(è+ 
o
->
¡yË
()->
bÜd”TİWidth
(),

816 
r
.
width
(è- 
o
->
¡yË
()->
bÜd”LeáWidth
(è- o->¡yË()->
bÜd”RightWidth
(),

817 
r
.
height
(è- 
o
->
¡yË
()->
bÜd”TİWidth
(è- o->¡yË()->
bÜd”BÙtomWidth
());

819 
·štM’uLi¡Bu‰ÚG¿d›Ás
(
o
, 
·štInfo
, 
bounds
);

822 
	gfÚtSÿË
 = 
mš
(
o
->
¡yË
()->
fÚtSize
(è/ 
ba£FÚtSize
, 
bounds
.
height
(è/ 
ba£A¼owHeight
);

823 
	gûÁ”Y
 = 
bounds
.
y
(è+ bounds.
height
() / 2.0f;

824 
	g¬rowHeight
 = 
ba£A¼owHeight
 * 
fÚtSÿË
;

825 
	g¬rowWidth
 = 
ba£A¼owWidth
 * 
fÚtSÿË
;

826 
	gËáEdge
 = 
bounds
.
right
(è- 
¬rowPaddšgRight
 - 
¬rowWidth
;

828 ià(
	gbounds
.
width
(è< 
	g¬rowWidth
 + 
	g¬rowPaddšgLeá
)

829  
	gçl£
;

831 
	g·štInfo
.
	gcÚ‹xt
->
§ve
();

833 
	g·štInfo
.
	gcÚ‹xt
->
£tFlCŞÜ
(
o
->
¡yË
()->
cŞÜ
(), 
DeviûCŞÜS·û
);

834 
	g·štInfo
.
	gcÚ‹xt
->
£tSŒokeCŞÜ
(
NoSŒoke
, 
DeviûCŞÜS·û
);

836 
FlßtPošt
 
	g¬row
[3];

837 
	g¬row
[0] = 
FlßtPošt
(
ËáEdge
, 
ûÁ”Y
 - 
¬rowHeight
 / 2.0f);

838 
	g¬row
[1] = 
FlßtPošt
(
ËáEdge
 + 
¬rowWidth
, 
ûÁ”Y
 - 
¬rowHeight
 / 2.0f);

839 
	g¬row
[2] = 
FlßtPošt
(
ËáEdge
 + 
¬rowWidth
 / 2.0f, 
ûÁ”Y
 + 
¬rowHeight
 / 2.0f);

842 
	g·štInfo
.
	gcÚ‹xt
->
d¿wCÚvexPŞygÚ
(3, 
¬row
, 
Œue
);

844 
CŞÜ
 
ËáS•¬©ÜCŞÜ
(0, 0, 0, 40);

845 
CŞÜ
 
rightS•¬©ÜCŞÜ
(255, 255, 255, 40);

848 
	g£·¿tÜS·û
 = 2;

849 
	gËáEdgeOfS•¬©Ü
 = 
¡©ic_ÿ¡
<>(
ËáEdge
 - 
¬rowPaddšgLeá
);

852 
	g·štInfo
.
	gcÚ‹xt
->
£tSŒokeThickÃss
(1.0f);

853 
	g·štInfo
.
	gcÚ‹xt
->
£tSŒokeStyË
(
SŞidSŒoke
);

854 
	g·štInfo
.
	gcÚ‹xt
->
£tSŒokeCŞÜ
(
ËáS•¬©ÜCŞÜ
, 
DeviûCŞÜS·û
);

855 
	g·štInfo
.
	gcÚ‹xt
->
d¿wLše
(
IÁPošt
(
ËáEdgeOfS•¬©Ü
, 
bounds
.
y
()),

856 
IÁPošt
(
ËáEdgeOfS•¬©Ü
, 
bounds
.
bÙtom
()));

858 
	g·štInfo
.
	gcÚ‹xt
->
£tSŒokeCŞÜ
(
rightS•¬©ÜCŞÜ
, 
DeviûCŞÜS·û
);

859 
	g·štInfo
.
	gcÚ‹xt
->
d¿wLše
(
IÁPošt
(
ËáEdgeOfS•¬©Ü
 + 
£·¿tÜS·û
, 
bounds
.
y
()),

860 
IÁPošt
(
ËáEdgeOfS•¬©Ü
 + 
£·¿tÜS·û
, 
bounds
.
bÙtom
()));

862 
	g·štInfo
.
	gcÚ‹xt
->
»¡Üe
();

863  
	gçl£
;

866 
	gR’d”ThemeSaçri
::
adju¡M’uLi¡StyË
(
CSSStyËS–eùÜ
* 
£ËùÜ
, 
R’d”StyË
* 
¡yË
, 
EËm’t
* 
e
) const

868 
NSCÚŒŞSize
 
	gcÚŒŞSize
 = 
cÚŒŞSizeFÜFÚt
(
¡yË
);

870 
	g¡yË
->
»£tBÜd”
();

871 
	g¡yË
->
»£tPaddšg
();

874 
	g¡yË
->
£tHeight
(
L’gth
(
Auto
));

877 
	g¡yË
->
£tWh™eS·û
(
PRE
);

881 
	g¡yË
->
£tCŞÜ
(
e
 &&ƒ->
isEÇbËdFÜmCÚŒŞ
(è? 
¡©ic_ÿ¡
<
RGBA32
>(
CŞÜ
::
bÏck
è: CŞÜ::
d¬kG¿y
);

884 
£tBu‰ÚSize
(
¡yË
);

889 
£tFÚtFromCÚŒŞSize
(
£ËùÜ
, 
¡yË
, 
cÚŒŞSize
);

892 
	gR’d”ThemeSaçri
::
pİupIÁ”ÇlPaddšgLeá
(
R’d”StyË
* 
¡yË
) const

894 ià(
¡yË
->
­³¬ªû
(è=ğ
M’uli¡P¬t
)

895  
pİupBu‰ÚPaddšg
(
cÚŒŞSizeFÜFÚt
(
¡yË
))[
ËáPaddšg
];

896 ià(
	g¡yË
->
­³¬ªû
(è=ğ
M’uli¡Bu‰ÚP¬t
)

897  
¡yËdPİupPaddšgLeá
;

901 
	gR’d”ThemeSaçri
::
pİupIÁ”ÇlPaddšgRight
(
R’d”StyË
* 
¡yË
) const

903 ià(
¡yË
->
­³¬ªû
(è=ğ
M’uli¡P¬t
)

904  
pİupBu‰ÚPaddšg
(
cÚŒŞSizeFÜFÚt
(
¡yË
))[
rightPaddšg
];

905 ià(
	g¡yË
->
­³¬ªû
(è=ğ
M’uli¡Bu‰ÚP¬t
) {

906 
fÚtSÿË
 = 
¡yË
->
fÚtSize
(è/ 
ba£FÚtSize
;

907 
	g¬rowWidth
 = 
ba£A¼owWidth
 * 
fÚtSÿË
;

908  
	g¡©ic_ÿ¡
<>(
ûf
(
¬rowWidth
 + 
¬rowPaddšgLeá
 + 
¬rowPaddšgRight
 + 
·ddšgBefÜeS•¬©Ü
));

913 
	gR’d”ThemeSaçri
::
pİupIÁ”ÇlPaddšgTİ
(
R’d”StyË
* 
¡yË
) const

915 ià(
¡yË
->
­³¬ªû
(è=ğ
M’uli¡P¬t
)

916  
pİupBu‰ÚPaddšg
(
cÚŒŞSizeFÜFÚt
(
¡yË
))[
tİPaddšg
];

917 ià(
	g¡yË
->
­³¬ªû
(è=ğ
M’uli¡Bu‰ÚP¬t
)

918  
¡yËdPİupPaddšgTİ
;

922 
	gR’d”ThemeSaçri
::
pİupIÁ”ÇlPaddšgBÙtom
(
R’d”StyË
* 
¡yË
) const

924 ià(
¡yË
->
­³¬ªû
(è=ğ
M’uli¡P¬t
)

925  
pİupBu‰ÚPaddšg
(
cÚŒŞSizeFÜFÚt
(
¡yË
))[
bÙtomPaddšg
];

926 ià(
	g¡yË
->
­³¬ªû
(è=ğ
M’uli¡Bu‰ÚP¬t
)

927  
¡yËdPİupPaddšgBÙtom
;

931 
	gR’d”ThemeSaçri
::
adju¡M’uLi¡Bu‰ÚStyË
(
CSSStyËS–eùÜ
* 
£ËùÜ
, 
R’d”StyË
* 
¡yË
, 
EËm’t
* 
e
) const

933 
	gfÚtSÿË
 = 
¡yË
->
fÚtSize
(è/ 
ba£FÚtSize
;

935 
	g¡yË
->
»£tPaddšg
();

936 
	g¡yË
->
£tBÜd”Radius
(
IÁSize
((
ba£BÜd”Radius
 + 
fÚtSÿË
 - 1), (baseBorderRadius + fontScale - 1)));

938 cÚ¡ 
	gmšHeight
 = 15;

939 
	g¡yË
->
£tMšHeight
(
L’gth
(
mšHeight
, 
Fixed
));

941 
	g¡yË
->
£tLšeHeight
(
R’d”StyË
::
š™ŸlLšeHeight
());

944 cÚ¡ 
IÁSize
* 
	gR’d”ThemeSaçri
::
m’uLi¡Sizes
() const

946 cÚ¡ 
IÁSize
 
sizes
[3] = { IntSize(9, 0), IntSize(5, 0), IntSize(0, 0) };

947  
	gsizes
;

950 
	gR’d”ThemeSaçri
::
mšimumM’uLi¡Size
(
R’d”StyË
* 
¡yË
) const

952  
sizeFÜSy¡emFÚt
(
¡yË
, 
m’uLi¡Sizes
()).
width
();

955 cÚ¡ 
	gŒackWidth
 = 5;

956 cÚ¡ 
	gŒackRadius
 = 2;

958 
boŞ
 
	gR’d”ThemeSaçri
::
·štSlid”T¿ck
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

960 
IÁReù
 
	gbounds
 = 
r
;

962 ià(
	go
->
¡yË
()->
­³¬ªû
(è=ğ
Slid”HÜizÚlP¬t
) {

963 
bounds
.
£tHeight
(
ŒackWidth
);

964 
	gbounds
.
£tY
(
r
.
y
(è+„.
height
(è/ 2 - 
ŒackWidth
 / 2);

965 } ià(
	go
->
¡yË
()->
­³¬ªû
(è=ğ
Slid”V”tiÿlP¬t
) {

966 
bounds
.
£tWidth
(
ŒackWidth
);

967 
	gbounds
.
£tX
(
r
.
x
(è+„.
width
(è/ 2 - 
ŒackWidth
 / 2);

970 
CGCÚ‹xtRef
 
	gcÚ‹xt
 = 
·štInfo
.
cÚ‹xt
->
¶©fÜmCÚ‹xt
();

971 
	gR‘ašPŒ
<
	gCGCŞÜS·ûRef
> 
c¥aû
(
AdİtCF
, 
CGCŞÜS·ûC»©eDeviûRGB
());

973 
	g·štInfo
.
	gcÚ‹xt
->
§ve
();

974 
CGCÚ‹xtClToReù
(
cÚ‹xt
, 
bounds
);

976 
CGFunùiÚC®lbacks
 
	gmašC®lbacks
 = { 0, 
T¿ckG¿d›ÁIÁ”pŞ©e
, 
NULL
 };

977 
	gR‘ašPŒ
<
	gCGFunùiÚRef
> 
mašFunùiÚ
(
AdİtCF
, 
CGFunùiÚC»©e
(
NULL
, 1, NULL, 4, NULL, &
mašC®lbacks
));

978 
	gR‘ašPŒ
<
	gCGShadšgRef
> 
	gmašShadšg
;

979 ià(
	go
->
¡yË
()->
­³¬ªû
(è=ğ
Slid”V”tiÿlP¬t
)

980 
mašShadšg
.
adİtCF
(
CGShadšgC»©eAxŸl
(
c¥aû
.
g‘
(), 
CGPoštMake
(
bounds
.
x
(), bounds.
bÙtom
()), CGPoštMake(bounds.
right
(), bounds.bÙtom()), 
mašFunùiÚ
.g‘(), 
çl£
, false));

982 
	gmašShadšg
.
adİtCF
(
CGShadšgC»©eAxŸl
(
c¥aû
.
g‘
(), 
CGPoštMake
(
bounds
.
x
(), bounds.
y
()), CGPoštMake(bounds.x(), bounds.
bÙtom
()), 
mašFunùiÚ
.g‘(), 
çl£
, false));

984 
IÁSize
 
¿dius
(
ŒackRadius
,rackRadius);

985 
	g·štInfo
.
	gcÚ‹xt
->
addRoundedReùCl
(
bounds
,

986 
¿dius
,„adius,

987 
¿dius
,„adius);

988 
CGCÚ‹xtD¿wShadšg
(
cÚ‹xt
, 
mašShadšg
.
g‘
());

989 
	g·štInfo
.
	gcÚ‹xt
->
»¡Üe
();

991  
	gçl£
;

994 
	gR’d”ThemeSaçri
::
adju¡Slid”ThumbStyË
(
CSSStyËS–eùÜ
* 
£ËùÜ
, 
R’d”StyË
* 
¡yË
, 
EËm’t
* 
e
) const

996 
	g¡yË
->
£tBoxShadow
(0);

999 cÚ¡ 
	gv”tiÿlSlid”HeightPaddšg
 = 0.1f;

1001 
boŞ
 
	gR’d”ThemeSaçri
::
·štSlid”Thumb
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

1003 
ASSERT
(
SaçriThemeLib¿ry
());

1005 
ASSERT
(
o
->
·»Á
()->
isSlid”
());

1007 
boŞ
 
	g´es£d
 = 
toR’d”Slid”
(
o
->
·»Á
())->
šD¿gMode
();

1008 
ThemeCÚŒŞS‹
 
	g¡©e
 = 
d‘”mšeS‹
(
o
->
·»Á
());

1009 
	g¡©e
 &ğ~
SaçriTheme
::
P»s£dS‹
;

1010 ià(
	g´es£d
)

1011 
	g¡©e
 |ğ
SaçriTheme
::
P»s£dS‹
;

1013 
·štThemeP¬t
(
Slid”ThumbP¬t
, 
·štInfo
.
cÚ‹xt
->
¶©fÜmCÚ‹xt
(), 
r
, 
NSSm®lCÚŒŞSize
, 
¡©e
);

1014  
	gçl£
;

1017 cÚ¡ 
	g¦id”ThumbWidth
 = 15;

1018 cÚ¡ 
	g¦id”ThumbHeight
 = 15;

1020 
	gR’d”ThemeSaçri
::
adju¡Slid”ThumbSize
(
R’d”Objeù
* 
o
) const

1022 ià(
o
->
¡yË
()->
­³¬ªû
(è=ğ
Slid”ThumbHÜizÚlP¬t
 || o->¡yË()->­³¬ªû(è=ğ
Slid”ThumbV”tiÿlP¬t
) {

1023 
o
->
¡yË
()->
£tWidth
(
L’gth
(
¦id”ThumbWidth
, 
Fixed
));

1024 
	go
->
¡yË
()->
£tHeight
(
L’gth
(
¦id”ThumbHeight
, 
Fixed
));

1026 #ià
ENABLE
(
VIDEO
)

1027 ià(
	go
->
¡yË
()->
­³¬ªû
(è=ğ
MedŸSlid”ThumbP¬t
)

1028 
R’d”MedŸCÚŒŞs
::
adju¡MedŸSlid”ThumbSize
(
o
);

1032 
boŞ
 
	gR’d”ThemeSaçri
::
·štS—rchF›ld
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

1034 
ASSERT
(
SaçriThemeLib¿ry
());

1036 
·štThemeP¬t
(
SaçriTheme
::
S—rchF›ldP¬t
, 
·štInfo
.
cÚ‹xt
->
¶©fÜmCÚ‹xt
(), 
r
, 
cÚŒŞSizeFromReù
Ô, 
£¬chF›ldSizes
()), 
d‘”mšeS‹
(
o
));

1037  
	gçl£
;

1040 cÚ¡ 
IÁSize
* 
	gR’d”ThemeSaçri
::
£¬chF›ldSizes
() const

1042 cÚ¡ 
IÁSize
 
sizes
[3] = { IntSize(0, 22), IntSize(0, 19), IntSize(0, 15) };

1043  
	gsizes
;

1046 
	gR’d”ThemeSaçri
::
£tS—rchF›ldSize
(
R’d”StyË
* 
¡yË
) const

1049 ià(!
¡yË
->
width
().
isIÁršsicOrAuto
(è&& !¡yË->
height
().
isAuto
())

1053 
£tSizeFromFÚt
(
¡yË
, 
£¬chF›ldSizes
());

1056 
	gR’d”ThemeSaçri
::
adju¡S—rchF›ldStyË
(
CSSStyËS–eùÜ
* 
£ËùÜ
, 
R’d”StyË
* 
¡yË
, 
EËm’t
* 
e
) const

1059 
	g¡yË
->
»£tBÜd”
();

1060 cÚ¡ 
	gbÜd”Width
 = 2;

1061 
	g¡yË
->
£tBÜd”LeáWidth
(
bÜd”Width
);

1062 
	g¡yË
->
£tBÜd”LeáStyË
(
INSET
);

1063 
	g¡yË
->
£tBÜd”RightWidth
(
bÜd”Width
);

1064 
	g¡yË
->
£tBÜd”RightStyË
(
INSET
);

1065 
	g¡yË
->
£tBÜd”BÙtomWidth
(
bÜd”Width
);

1066 
	g¡yË
->
£tBÜd”BÙtomStyË
(
INSET
);

1067 
	g¡yË
->
£tBÜd”TİWidth
(
bÜd”Width
);

1068 
	g¡yË
->
£tBÜd”TİStyË
(
INSET
);

1071 
	g¡yË
->
£tHeight
(
L’gth
(
Auto
));

1072 
£tS—rchF›ldSize
(
¡yË
);

1075 cÚ¡ 
	g·ddšg
 = 1;

1076 
	g¡yË
->
£tPaddšgLeá
(
L’gth
(
·ddšg
, 
Fixed
));

1077 
	g¡yË
->
£tPaddšgRight
(
L’gth
(
·ddšg
, 
Fixed
));

1078 
	g¡yË
->
£tPaddšgTİ
(
L’gth
(
·ddšg
, 
Fixed
));

1079 
	g¡yË
->
£tPaddšgBÙtom
(
L’gth
(
·ddšg
, 
Fixed
));

1081 
NSCÚŒŞSize
 
	gcÚŒŞSize
 = 
cÚŒŞSizeFÜFÚt
(
¡yË
);

1082 
£tFÚtFromCÚŒŞSize
(
£ËùÜ
, 
¡yË
, 
cÚŒŞSize
);

1085 
boŞ
 
	gR’d”ThemeSaçri
::
·štS—rchF›ldCªûlBu‰Ú
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
&)

1087 
ASSERT
(
SaçriThemeLib¿ry
());

1089 
Node
* 
	gšput
 = 
o
->
node
()->
shadowAnû¡ÜNode
();

1090 
ASSERT
(
šput
);

1091 
R’d”Objeù
* 
	g»nd””
 = 
šput
->
»nd””
();

1092 
ASSERT
(
»nd””
);

1094 
IÁReù
 
	g£¬chReù
 = 
»nd””
->
absŞu‹BoundšgBoxReù
();

1096 
·štThemeP¬t
(
SaçriTheme
::
S—rchF›ldCªûlBu‰ÚP¬t
, 
·štInfo
.
cÚ‹xt
->
¶©fÜmCÚ‹xt
(), 
£¬chReù
, 
cÚŒŞSizeFromReù
(£¬chReù, 
£¬chF›ldSizes
()), 
d‘”mšeS‹
(
o
));

1097  
	gçl£
;

1100 cÚ¡ 
IÁSize
* 
	gR’d”ThemeSaçri
::
ÿnûlBu‰ÚSizes
() const

1102 cÚ¡ 
IÁSize
 
sizes
[3] = { IntSize(16, 13), IntSize(13, 11), IntSize(13, 9) };

1103  
	gsizes
;

1106 
	gR’d”ThemeSaçri
::
adju¡S—rchF›ldCªûlBu‰ÚStyË
(
CSSStyËS–eùÜ
* 
£ËùÜ
, 
R’d”StyË
* 
¡yË
, 
EËm’t
* 
e
) const

1108 
IÁSize
 
	gsize
 = 
sizeFÜSy¡emFÚt
(
¡yË
, 
ÿnûlBu‰ÚSizes
());

1109 
	g¡yË
->
£tWidth
(
L’gth
(
size
.
width
(), 
Fixed
));

1110 
	g¡yË
->
£tHeight
(
L’gth
(
size
.
height
(), 
Fixed
));

1113 cÚ¡ 
IÁSize
* 
	gR’d”ThemeSaçri
::
»suÉsBu‰ÚSizes
() const

1115 cÚ¡ 
IÁSize
 
sizes
[3] = { IntSize(19, 13), IntSize(17, 11), IntSize(17, 9) };

1116  
	gsizes
;

1119 cÚ¡ 
	gem±yResuÉsOff£t
 = 9;

1120 
	gR’d”ThemeSaçri
::
adju¡S—rchF›ldDecÜ©iÚStyË
(
CSSStyËS–eùÜ
* 
£ËùÜ
, 
R’d”StyË
* 
¡yË
, 
EËm’t
* 
e
) const

1122 
IÁSize
 
	gsize
 = 
sizeFÜSy¡emFÚt
(
¡yË
, 
»suÉsBu‰ÚSizes
());

1123 
	g¡yË
->
£tWidth
(
L’gth
(
size
.
width
(è- 
em±yResuÉsOff£t
, 
Fixed
));

1124 
	g¡yË
->
£tHeight
(
L’gth
(
size
.
height
(), 
Fixed
));

1127 
boŞ
 
	gR’d”ThemeSaçri
::
·štS—rchF›ldDecÜ©iÚ
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&)

1129  
	gçl£
;

1132 
	gR’d”ThemeSaçri
::
adju¡S—rchF›ldResuÉsDecÜ©iÚStyË
(
CSSStyËS–eùÜ
* 
£ËùÜ
, 
R’d”StyË
* 
¡yË
, 
EËm’t
* 
e
) const

1134 
IÁSize
 
	gsize
 = 
sizeFÜSy¡emFÚt
(
¡yË
, 
»suÉsBu‰ÚSizes
());

1135 
	g¡yË
->
£tWidth
(
L’gth
(
size
.
width
(), 
Fixed
));

1136 
	g¡yË
->
£tHeight
(
L’gth
(
size
.
height
(), 
Fixed
));

1139 
boŞ
 
	gR’d”ThemeSaçri
::
·štS—rchF›ldResuÉsDecÜ©iÚ
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
&)

1141 
ASSERT
(
SaçriThemeLib¿ry
());

1143 
Node
* 
	gšput
 = 
o
->
node
()->
shadowAnû¡ÜNode
();

1144 
ASSERT
(
šput
);

1145 
R’d”Objeù
* 
	g»nd””
 = 
šput
->
»nd””
();

1146 
ASSERT
(
»nd””
);

1148 
IÁReù
 
	g£¬chReù
 = 
»nd””
->
absŞu‹BoundšgBoxReù
();

1150 
·štThemeP¬t
(
SaçriTheme
::
S—rchF›ldResuÉsDecÜ©iÚP¬t
, 
·štInfo
.
cÚ‹xt
->
¶©fÜmCÚ‹xt
(), 
£¬chReù
, 
cÚŒŞSizeFromReù
(£¬chReù, 
£¬chF›ldSizes
()), 
d‘”mšeS‹
(
o
));

1151  
	gçl£
;

1154 cÚ¡ 
	g»suÉsA¼owWidth
 = 5;

1155 
	gR’d”ThemeSaçri
::
adju¡S—rchF›ldResuÉsBu‰ÚStyË
(
CSSStyËS–eùÜ
* 
£ËùÜ
, 
R’d”StyË
* 
¡yË
, 
EËm’t
* 
e
) const

1157 
IÁSize
 
	gsize
 = 
sizeFÜSy¡emFÚt
(
¡yË
, 
»suÉsBu‰ÚSizes
());

1158 
	g¡yË
->
£tWidth
(
L’gth
(
size
.
width
(è+ 
»suÉsA¼owWidth
, 
Fixed
));

1159 
	g¡yË
->
£tHeight
(
L’gth
(
size
.
height
(), 
Fixed
));

1162 
boŞ
 
	gR’d”ThemeSaçri
::
·štS—rchF›ldResuÉsBu‰Ú
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
&)

1164 
ASSERT
(
SaçriThemeLib¿ry
());

1166 
Node
* 
	gšput
 = 
o
->
node
()->
shadowAnû¡ÜNode
();

1167 
ASSERT
(
šput
);

1168 
R’d”Objeù
* 
	g»nd””
 = 
šput
->
»nd””
();

1169 
ASSERT
(
»nd””
);

1171 
IÁReù
 
	g£¬chReù
 = 
»nd””
->
absŞu‹BoundšgBoxReù
();

1173 
·štThemeP¬t
(
SaçriTheme
::
S—rchF›ldResuÉsBu‰ÚP¬t
, 
·štInfo
.
cÚ‹xt
->
¶©fÜmCÚ‹xt
(), 
£¬chReù
, 
cÚŒŞSizeFromReù
(£¬chReù, 
£¬chF›ldSizes
()), 
d‘”mšeS‹
(
o
));

1174  
	gçl£
;

1176 #ià
ENABLE
(
VIDEO
)

1177 
boŞ
 
	gR’d”ThemeSaçri
::
·štMedŸFuÎsü“nBu‰Ú
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

1179  
	gR’d”MedŸCÚŒŞs
::
·štMedŸCÚŒŞsP¬t
(
MedŸFuÎsü“nBu‰Ú
, 
o
, 
·štInfo
, 
r
);

1182 
boŞ
 
	gR’d”ThemeSaçri
::
·štMedŸMu‹Bu‰Ú
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

1184  
	gR’d”MedŸCÚŒŞs
::
·štMedŸCÚŒŞsP¬t
(
MedŸMu‹Bu‰Ú
, 
o
, 
·štInfo
, 
r
);

1187 
boŞ
 
	gR’d”ThemeSaçri
::
·štMedŸPÏyBu‰Ú
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

1189  
	gR’d”MedŸCÚŒŞs
::
·štMedŸCÚŒŞsP¬t
(
MedŸPÏyBu‰Ú
, 
o
, 
·štInfo
, 
r
);

1192 
boŞ
 
	gR’d”ThemeSaçri
::
·štMedŸS“kBackBu‰Ú
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

1194  
	gR’d”MedŸCÚŒŞs
::
·štMedŸCÚŒŞsP¬t
(
MedŸS“kBackBu‰Ú
, 
o
, 
·štInfo
, 
r
);

1197 
boŞ
 
	gR’d”ThemeSaçri
::
·štMedŸS“kFÜw¬dBu‰Ú
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

1199  
	gR’d”MedŸCÚŒŞs
::
·štMedŸCÚŒŞsP¬t
(
MedŸS“kFÜw¬dBu‰Ú
, 
o
, 
·štInfo
, 
r
);

1202 
boŞ
 
	gR’d”ThemeSaçri
::
·štMedŸSlid”T¿ck
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

1204  
	gR’d”MedŸCÚŒŞs
::
·štMedŸCÚŒŞsP¬t
(
MedŸSlid”
, 
o
, 
·štInfo
, 
r
);

1207 
boŞ
 
	gR’d”ThemeSaçri
::
·štMedŸSlid”Thumb
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

1209  
	gR’d”MedŸCÚŒŞs
::
·štMedŸCÚŒŞsP¬t
(
MedŸSlid”Thumb
, 
o
, 
·štInfo
, 
r
);

	@RenderThemeSafari.h

22 #iâdeà
R’d”ThemeSaçri_h


23 
	#R’d”ThemeSaçri_h


	)

25 #ià
USE
(
SAFARI_THEME
)

27 
	~"R’d”Theme.h
"

31 
	~<SaçriTheme/SaçriThemeCÚ¡ªts.h
>

32 #iâdeà
SaçriThemeCÚ¡ªts_h


33 
	~<SaçriTheme/SaçriTheme.h
>

36 #ià
PLATFORM
(
WIN
)

37 * 
	tHANDLE
;

38 
HINSTANCE__
* 
	tHINSTANCE
;

39 
HINSTANCE
 
	tHMODULE
;

42 
Çme¥aû
 
	gWebCÜe
 {

44 
usšg
 
Çme¥aû
 
	gSaçriTheme
;

46 
şass
 
	gR’d”StyË
;

48 şas 
	cR’d”ThemeSaçri
 : 
public
 
R’d”Theme
 {

49 
public
:

50 
PassRefPŒ
<
R’d”Theme
> 
ü—‹
();

55 
vœtu®
 
ba£lšePos™iÚ
(cÚ¡ 
R’d”Objeù
*) const;

58 
vœtu®
 
boŞ
 
cÚŒŞSuµÜtsTšts
(cÚ¡ 
R’d”Objeù
*) const;

61 
vœtu®
 
boŞ
 
suµÜtsCÚŒŞTšts
(ècÚ¡ {  
	gŒue
; }

63 
vœtu®
 
adju¡R•aštReù
(cÚ¡ 
R’d”Objeù
*, 
IÁReù
&);

65 
vœtu®
 
boŞ
 
isCÚŒŞStyËd
(cÚ¡ 
R’d”StyË
*, cÚ¡ 
BÜd”D©a
&,

66 cÚ¡ 
FlLay”
&, cÚ¡ 
CŞÜ
& 
backgroundCŞÜ
) const;

68 
vœtu®
 
CŞÜ
 
¶©fÜmAùiveS–eùiÚBackgroundCŞÜ
() const;

69 
vœtu®
 
CŞÜ
 
¶©fÜmIÇùiveS–eùiÚBackgroundCŞÜ
() const;

70 
vœtu®
 
CŞÜ
 
aùiveLi¡BoxS–eùiÚBackgroundCŞÜ
() const;

72 
vœtu®
 
CŞÜ
 
¶©fÜmFocusRšgCŞÜ
() const;

75 
vœtu®
 
sy¡emFÚt
(
´İId
, 
FÚtDesütiÚ
&) const;

77 
vœtu®
 
mšimumM’uLi¡Size
(
R’d”StyË
*) const;

79 
vœtu®
 
adju¡Slid”ThumbSize
(
R’d”Objeù
*) const;

80 
vœtu®
 
adju¡Slid”ThumbStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

82 
vœtu®
 
pİupIÁ”ÇlPaddšgLeá
(
R’d”StyË
*) const;

83 
vœtu®
 
pİupIÁ”ÇlPaddšgRight
(
R’d”StyË
*) const;

84 
vœtu®
 
pİupIÁ”ÇlPaddšgTİ
(
R’d”StyË
*) const;

85 
vœtu®
 
pİupIÁ”ÇlPaddšgBÙtom
(
R’d”StyË
*) const;

87 
	g´Ùeùed
:

89 
vœtu®
 
boŞ
 
·štCheckbox
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

90 
vœtu®
 
£tCheckboxSize
(
R’d”StyË
*) const;

92 
vœtu®
 
boŞ
 
·štRadio
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

93 
vœtu®
 
£tRadioSize
(
R’d”StyË
*) const;

95 
vœtu®
 
adju¡Bu‰ÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
WebCÜe
::
EËm’t
*) const;

96 
vœtu®
 
boŞ
 
·štBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

97 
vœtu®
 
£tBu‰ÚSize
(
R’d”StyË
*) const;

99 
vœtu®
 
boŞ
 
·štTextF›ld
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

100 
vœtu®
 
adju¡TextF›ldStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

102 
vœtu®
 
boŞ
 
·štTextA»a
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

103 
vœtu®
 
adju¡TextA»aStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

105 
vœtu®
 
boŞ
 
·štM’uLi¡
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

106 
vœtu®
 
adju¡M’uLi¡StyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

108 
vœtu®
 
boŞ
 
·štM’uLi¡Bu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

109 
vœtu®
 
adju¡M’uLi¡Bu‰ÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

111 
vœtu®
 
boŞ
 
·štSlid”T¿ck
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

112 
vœtu®
 
boŞ
 
·štSlid”Thumb
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

114 
vœtu®
 
boŞ
 
·štS—rchF›ld
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

115 
vœtu®
 
adju¡S—rchF›ldStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

117 
vœtu®
 
adju¡S—rchF›ldCªûlBu‰ÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

118 
vœtu®
 
boŞ
 
·štS—rchF›ldCªûlBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

120 
vœtu®
 
adju¡S—rchF›ldDecÜ©iÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

121 
vœtu®
 
boŞ
 
·štS—rchF›ldDecÜ©iÚ
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

123 
vœtu®
 
adju¡S—rchF›ldResuÉsDecÜ©iÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

124 
vœtu®
 
boŞ
 
·štS—rchF›ldResuÉsDecÜ©iÚ
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

126 
vœtu®
 
adju¡S—rchF›ldResuÉsBu‰ÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

127 
vœtu®
 
boŞ
 
·štS—rchF›ldResuÉsBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

129 
vœtu®
 
boŞ
 
·štC­sLockIndiÿtÜ
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

131 #ià
ENABLE
(
VIDEO
)

132 
vœtu®
 
boŞ
 
·štMedŸFuÎsü“nBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

133 
vœtu®
 
boŞ
 
·štMedŸPÏyBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

134 
vœtu®
 
boŞ
 
·štMedŸMu‹Bu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

135 
vœtu®
 
boŞ
 
·štMedŸS“kBackBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

136 
vœtu®
 
boŞ
 
·štMedŸS“kFÜw¬dBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

137 
vœtu®
 
boŞ
 
·štMedŸSlid”T¿ck
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

138 
vœtu®
 
boŞ
 
·štMedŸSlid”Thumb
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

141 
	g´iv©e
:

142 
R’d”ThemeSaçri
();

143 
	gvœtu®
 ~
R’d”ThemeSaçri
();

145 
IÁReù
 
šæ©eReù
(cÚ¡ IÁReù&, cÚ¡ 
IÁSize
&, cÚ¡ * 
m¬gšs
) const;

149 
NSCÚŒŞSize
 
cÚŒŞSizeFÜFÚt
(
R’d”StyË
*) const;

150 
NSCÚŒŞSize
 
cÚŒŞSizeFÜSy¡emFÚt
(
R’d”StyË
*) const;

152 
£tSizeFromFÚt
(
R’d”StyË
*, cÚ¡ 
IÁSize
* 
sizes
) const;

153 
IÁSize
 
sizeFÜFÚt
(
R’d”StyË
*, cÚ¡ IÁSize* 
sizes
) const;

154 
IÁSize
 
sizeFÜSy¡emFÚt
(
R’d”StyË
*, cÚ¡ IÁSize* 
sizes
) const;

155 
£tFÚtFromCÚŒŞSize
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
NSCÚŒŞSize
) const;

158 cÚ¡ 
IÁSize
* 
checkboxSizes
() const;

159 cÚ¡ * 
checkboxM¬gšs
(
NSCÚŒŞSize
) const;

161 cÚ¡ 
IÁSize
* 
¿dioSizes
() const;

162 cÚ¡ * 
¿dioM¬gšs
(
NSCÚŒŞSize
) const;

164 
£tBu‰ÚPaddšgFromCÚŒŞSize
(
R’d”StyË
*, 
NSCÚŒŞSize
) const;

165 cÚ¡ 
IÁSize
* 
bu‰ÚSizes
() const;

166 cÚ¡ * 
bu‰ÚM¬gšs
(
NSCÚŒŞSize
) const;

168 cÚ¡ 
IÁSize
* 
pİupBu‰ÚSizes
() const;

169 cÚ¡ * 
pİupBu‰ÚM¬gšs
(
NSCÚŒŞSize
) const;

170 cÚ¡ * 
pİupBu‰ÚPaddšg
(
NSCÚŒŞSize
) const;

171 
·štM’uLi¡Bu‰ÚG¿d›Ás
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

172 cÚ¡ 
IÁSize
* 
m’uLi¡Sizes
() const;

174 cÚ¡ 
IÁSize
* 
£¬chF›ldSizes
() const;

175 cÚ¡ 
IÁSize
* 
ÿnûlBu‰ÚSizes
() const;

176 cÚ¡ 
IÁSize
* 
»suÉsBu‰ÚSizes
() const;

177 
£tS—rchF›ldSize
(
R’d”StyË
*) const;

179 
ThemeCÚŒŞS‹
 
d‘”mšeS‹
(
R’d”Objeù
*) const;

	@RenderThemeWin.cpp

22 
	~"cÚfig.h
"

23 
	~"R’d”ThemeWš.h
"

25 
	~"CSSV®ueKeywÜds.h
"

26 
	~"EËm’t.h
"

27 
	~"F¿me.h
"

28 
	~"G¿phicsCÚ‹xt.h
"

29 
	~"R’d”Slid”.h
"

30 
	~"S‘tšgs.h
"

31 
	~"SoáLškšg.h
"

32 
	~"Sy¡emInfo.h
"

33 
	~"U£rAg’tStyËSh“ts.h
"

35 #ià
ENABLE
(
VIDEO
)

36 
	~"R’d”MedŸCÚŒŞs.h
"

39 
	~<tch¬.h
>

48 
	#TS_NORMAL
 1

	)

49 
	#TS_HOVER
 2

	)

50 
	#TS_ACTIVE
 3

	)

51 
	#TS_DISABLED
 4

	)

52 
	#TS_FOCUSED
 5

	)

55 
	#BP_BUTTON
 1

	)

56 
	#BP_RADIO
 2

	)

57 
	#BP_CHECKBOX
 3

	)

60 
	#TFP_TEXTFIELD
 1

	)

61 
	#EP_EDITBORDER_NOSCROLL
 6

	)

62 
	#TFS_READONLY
 6

	)

65 
	#CP_DROPDOWNBUTTON
 1

	)

66 
	#CP_BORDER
 4

	)

67 
	#CP_READONLY
 5

	)

68 
	#CP_DROPDOWNBUTTONRIGHT
 6

	)

71 
	#TKP_TRACK
 1

	)

72 
	#TKP_TRACKVERT
 2

	)

75 
	#TKP_THUMBBOTTOM
 4

	)

76 
	#TKP_THUMBTOP
 5

	)

77 
	#TKP_THUMBLEFT
 7

	)

78 
	#TKP_THUMBRIGHT
 8

	)

81 
	#TUS_NORMAL
 1

	)

82 
	#TUS_HOT
 2

	)

83 
	#TUS_PRESSED
 3

	)

84 
	#TUS_FOCUSED
 4

	)

85 
	#TUS_DISABLED
 5

	)

88 
	#PBS_NORMAL
 1

	)

89 
	#PBS_HOT
 2

	)

90 
	#PBS_PRESSED
 3

	)

91 
	#PBS_DISABLED
 4

	)

92 
	#PBS_DEFAULTED
 5

	)

94 
	$SOFT_LINK_LIBRARY
(
uxtheme
)

95 
	`SOFT_LINK
(
uxtheme
, 
O³nThemeD©a
, 
HANDLE
, 
WINAPI
, (
HWND
 
hwnd
, 
LPCWSTR
 
pszCÏssLi¡
), (hwnd,…szClassList))

96 
	`SOFT_LINK
(
uxtheme
, 
Clo£ThemeD©a
, 
HRESULT
, 
WINAPI
, (
HANDLE
 
hTheme
), (hTheme))

97 
	`SOFT_LINK
(
uxtheme
, 
D¿wThemeBackground
, 
HRESULT
, 
WINAPI
, (
HANDLE
 
hTheme
, 
HDC
 
hdc
, 
iP¬tId
, 
iS‹Id
, cÚ¡ 
RECT
* 
pReù
, cÚ¡ RECT* 
pClReù
), (hTheme, hdc, iPartId, iStateId,…Rect,…ClipRect))

98 
	`SOFT_LINK
(
uxtheme
, 
IsThemeAùive
, 
BOOL
, 
WINAPI
, (), ())

99 
	`SOFT_LINK
(
uxtheme
, 
IsThemeBackgroundP¬tŸÎyT¿n¥¬’t
, 
BOOL
, 
WINAPI
, (
HANDLE
 
hTheme
, 
iP¬tId
, 
iS‹Id
), (hTheme, iPartId, iStateId))

101 
boŞ
 
haveTheme
;

103 cÚ¡ 
vi¡aM’uLi¡Bu‰ÚOut£t
 = 1;

105 
usšg
 
Çme¥aû
 
¡d
;

107 
Çme¥aû
 
WebCÜe
 {

110 cÚ¡ 
drİDownBu‰ÚWidth
 = 17;

112 cÚ¡ 
sh–l32Magnif›rIcÚIndex
 = 22;

115 cÚ¡ 
deçuÉCÚŒŞFÚtPix–Size
 = 13;

117 cÚ¡ 
deçuÉCªûlBu‰ÚSize
 = 9;

118 cÚ¡ 
mšCªûlBu‰ÚSize
 = 5;

119 cÚ¡ 
maxCªûlBu‰ÚSize
 = 21;

120 cÚ¡ 
deçuÉS—rchF›ldResuÉsDecÜ©iÚSize
 = 13;

121 cÚ¡ 
mšS—rchF›ldResuÉsDecÜ©iÚSize
 = 9;

122 cÚ¡ 
maxS—rchF›ldResuÉsDecÜ©iÚSize
 = 30;

123 cÚ¡ 
deçuÉS—rchF›ldResuÉsBu‰ÚWidth
 = 18;

125 
boŞ
 
gWebK™IsBešgUÆßded
;

127 
boŞ
 
	`docum’tIsInAµliÿtiÚChromeMode
(cÚ¡ 
Docum’t
* 
docum’t
)

129 
S‘tšgs
* 
£‰šgs
 = 
docum’t
->
	`£‰šgs
();

130  
£‰šgs
 && s‘tšgs->
	`šAµliÿtiÚChromeMode
();

133 
R’d”ThemeWš
::
	`£tWebK™IsBešgUÆßded
()

135 
gWebK™IsBešgUÆßded
 = 
Œue
;

138 
PassRefPŒ
<
R’d”Theme
> 
R’d”ThemeWš
::
	`ü—‹
()

140  
	`adİtRef
(
Ãw
 
R’d”ThemeWš
);

143 #ià!
	`USE
(
SAFARI_THEME
)

144 
PassRefPŒ
<
R’d”Theme
> R’d”Theme::
	`themeFÜPage
(
Page
* 
·ge
)

146 
R’d”Theme
* 
wšTheme
 = 
R’d”ThemeWš
::
	`ü—‹
().
	`»Ëa£Ref
();

147  
wšTheme
;

151 
R’d”ThemeWš
::
	`R’d”ThemeWš
()

152 : 
	`m_bu‰ÚTheme
(0)

153 , 
	`m_‹xtF›ldTheme
(0)

154 , 
	`m_m’uLi¡Theme
(0)

155 , 
	`m_¦id”Theme
(0)

157 
haveTheme
 = 
	`uxthemeLib¿ry
(è&& 
	`IsThemeAùive
();

160 
R’d”ThemeWš
::~
	`R’d”ThemeWš
()

163 ià(
gWebK™IsBešgUÆßded
 || !
	`uxthemeLib¿ry
())

165 
	`şo£
();

168 
HANDLE
 
R’d”ThemeWš
::
	`bu‰ÚTheme
() const

170 ià(
haveTheme
 && !
m_bu‰ÚTheme
)

171 
m_bu‰ÚTheme
 = 
	`O³nThemeD©a
(0, 
L
"Button");

172  
m_bu‰ÚTheme
;

175 
HANDLE
 
R’d”ThemeWš
::
	`‹xtF›ldTheme
() const

177 ià(
haveTheme
 && !
m_‹xtF›ldTheme
)

178 
m_‹xtF›ldTheme
 = 
	`O³nThemeD©a
(0, 
L
"Edit");

179  
m_‹xtF›ldTheme
;

182 
HANDLE
 
R’d”ThemeWš
::
	`m’uLi¡Theme
() const

184 ià(
haveTheme
 && !
m_m’uLi¡Theme
)

185 
m_m’uLi¡Theme
 = 
	`O³nThemeD©a
(0, 
L
"ComboBox");

186  
m_m’uLi¡Theme
;

189 
HANDLE
 
R’d”ThemeWš
::
	`¦id”Theme
() const

191 ià(
haveTheme
 && !
m_¦id”Theme
)

192 
m_¦id”Theme
 = 
	`O³nThemeD©a
(0, 
L
"TrackBar");

193  
m_¦id”Theme
;

196 
R’d”ThemeWš
::
	`şo£
()

199 ià(
m_bu‰ÚTheme
)

200 
	`Clo£ThemeD©a
(
m_bu‰ÚTheme
);

201 ià(
m_‹xtF›ldTheme
)

202 
	`Clo£ThemeD©a
(
m_‹xtF›ldTheme
);

203 ià(
m_m’uLi¡Theme
)

204 
	`Clo£ThemeD©a
(
m_m’uLi¡Theme
);

205 ià(
m_¦id”Theme
)

206 
	`Clo£ThemeD©a
(
m_¦id”Theme
);

207 
m_bu‰ÚTheme
 = 
m_‹xtF›ldTheme
 = 
m_m’uLi¡Theme
 = 
m_¦id”Theme
 = 0;

209 
haveTheme
 = 
	`uxthemeLib¿ry
(è&& 
	`IsThemeAùive
();

212 
R’d”ThemeWš
::
	`themeChªged
()

214 
	`şo£
();

217 
SŒšg
 
R’d”ThemeWš
::
	`exŒaDeçuÉStyËSh“t
()

219  
	`SŒšg
(
themeWšU£rAg’tStyËSh“t
, (themeWinUserAgentStyleSheet));

222 
SŒšg
 
R’d”ThemeWš
::
	`exŒaQuœksStyËSh“t
()

224  
	`SŒšg
(
themeWšQuœksU£rAg’tStyËSh“t
, (themeWinQuirksUserAgentStyleSheet));

227 
boŞ
 
R’d”ThemeWš
::
	`suµÜtsHov”
(cÚ¡ 
R’d”StyË
*) const

230  
haveTheme
;

233 
CŞÜ
 
R’d”ThemeWš
::
	`¶©fÜmAùiveS–eùiÚBackgroundCŞÜ
() const

235 
COLORREF
 
cŞÜ
 = 
	`G‘SysCŞÜ
(
COLOR_HIGHLIGHT
);

236  
	`CŞÜ
(
	`G‘RV®ue
(
cŞÜ
), 
	`G‘GV®ue
(cŞÜ), 
	`G‘BV®ue
(color));

239 
CŞÜ
 
R’d”ThemeWš
::
	`¶©fÜmIÇùiveS–eùiÚBackgroundCŞÜ
() const

242  
	`CŞÜ
(176, 176, 176);

245 
CŞÜ
 
R’d”ThemeWš
::
	`¶©fÜmAùiveS–eùiÚFÜegroundCŞÜ
() const

247 
COLORREF
 
cŞÜ
 = 
	`G‘SysCŞÜ
(
COLOR_HIGHLIGHTTEXT
);

248  
	`CŞÜ
(
	`G‘RV®ue
(
cŞÜ
), 
	`G‘GV®ue
(cŞÜ), 
	`G‘BV®ue
(color));

251 
CŞÜ
 
R’d”ThemeWš
::
	`¶©fÜmIÇùiveS–eùiÚFÜegroundCŞÜ
() const

253  
	`¶©fÜmAùiveS–eùiÚFÜegroundCŞÜ
();

256 
	`flFÚtDesütiÚ
(
FÚtDesütiÚ
& 
fÚtDesütiÚ
, 
LOGFONT
& 
logFÚt
, 
fÚtSize
)

258 
fÚtDesütiÚ
.
	`£tIsAbsŞu‹Size
(
Œue
);

259 
fÚtDesütiÚ
.
	`£tG’”icFamy
(
FÚtDesütiÚ
::
NoFamy
);

260 
fÚtDesütiÚ
.
	`fœ¡Famy
().
	`£tFamy
(
	`SŒšg
(
logFÚt
.
lfFaûName
));

261 
fÚtDesütiÚ
.
	`£tS³cif›dSize
(
fÚtSize
);

262 
fÚtDesütiÚ
.
	`£tWeight
(
logFÚt
.
lfWeight
 >ğ700 ? 
FÚtWeightBŞd
 : 
FÚtWeightNÜm®
);

263 
fÚtDesütiÚ
.
	`£tIlic
(
logFÚt
.
lfIlic
);

266 
	`flFÚtDesütiÚ
(
FÚtDesütiÚ
& 
fÚtDesütiÚ
, 
LOGFONT
& 
logFÚt
)

268 
	`flFÚtDesütiÚ
(
fÚtDesütiÚ
, 
logFÚt
, 
	`abs
ÖogFÚt.
lfHeight
));

271 
R’d”ThemeWš
::
	`sy¡emFÚt
(
´İId
, 
FÚtDesütiÚ
& 
fÚtDesütiÚ
) const

273 
FÚtDesütiÚ
 
ÿ±iÚFÚt
;

274 
FÚtDesütiÚ
 
cÚŒŞFÚt
;

275 
FÚtDesütiÚ
 
sm®lC­tiÚFÚt
;

276 
FÚtDesütiÚ
 
m’uFÚt
;

277 
FÚtDesütiÚ
 
icÚFÚt
;

278 
FÚtDesütiÚ
 
mes§geBoxFÚt
;

279 
FÚtDesütiÚ
 
¡©usB¬FÚt
;

280 
FÚtDesütiÚ
 
sy¡emFÚt
;

282 
boŞ
 
š™Ÿlized
;

283 
NONCLIENTMETRICS
 
ncm
;

285 ià(!
š™Ÿlized
) {

286 
š™Ÿlized
 = 
Œue
;

287 
ncm
.
cbSize
 = (
NONCLIENTMETRICS
);

288 ::
	`Sy¡emP¬am‘”sInfo
(
SPI_GETNONCLIENTMETRICS
, (
ncm
), &ncm, 0);

291 
´İId
) {

292 
CSSV®ueIcÚ
: {

293 ià(!
icÚFÚt
.
	`isAbsŞu‹Size
()) {

294 
LOGFONT
 
logFÚt
;

295 ::
	`Sy¡emP¬am‘”sInfo
(
SPI_GETICONTITLELOGFONT
, (
logFÚt
), &logFont, 0);

296 
	`flFÚtDesütiÚ
(
icÚFÚt
, 
logFÚt
);

298 
fÚtDesütiÚ
 = 
icÚFÚt
;

301 
CSSV®ueM’u
:

302 ià(!
m’uFÚt
.
	`isAbsŞu‹Size
())

303 
	`flFÚtDesütiÚ
(
m’uFÚt
, 
ncm
.
lfM’uFÚt
);

304 
fÚtDesütiÚ
 = 
m’uFÚt
;

306 
CSSV®ueMes§geBox
:

307 ià(!
mes§geBoxFÚt
.
	`isAbsŞu‹Size
())

308 
	`flFÚtDesütiÚ
(
mes§geBoxFÚt
, 
ncm
.
lfMes§geFÚt
);

309 
fÚtDesütiÚ
 = 
mes§geBoxFÚt
;

311 
CSSV®ueStusB¬
:

312 ià(!
¡©usB¬FÚt
.
	`isAbsŞu‹Size
())

313 
	`flFÚtDesütiÚ
(
¡©usB¬FÚt
, 
ncm
.
lfStusFÚt
);

314 
fÚtDesütiÚ
 = 
¡©usB¬FÚt
;

316 
CSSV®ueC­tiÚ
:

317 ià(!
ÿ±iÚFÚt
.
	`isAbsŞu‹Size
())

318 
	`flFÚtDesütiÚ
(
ÿ±iÚFÚt
, 
ncm
.
lfC­tiÚFÚt
);

319 
fÚtDesütiÚ
 = 
ÿ±iÚFÚt
;

321 
CSSV®ueSm®lC­tiÚ
:

322 ià(!
sm®lC­tiÚFÚt
.
	`isAbsŞu‹Size
())

323 
	`flFÚtDesütiÚ
(
sm®lC­tiÚFÚt
, 
ncm
.
lfSmC­tiÚFÚt
);

324 
fÚtDesütiÚ
 = 
sm®lC­tiÚFÚt
;

326 
CSSV®ueWebk™Sm®lCÚŒŞ
:

327 
CSSV®ueWebk™MšiCÚŒŞ
:

328 
CSSV®ueWebk™CÚŒŞ
:

329 ià(!
cÚŒŞFÚt
.
	`isAbsŞu‹Size
()) {

330 
HGDIOBJ
 
hGDI
 = ::
	`G‘StockObjeù
(
DEFAULT_GUI_FONT
);

331 ià(
hGDI
) {

332 
LOGFONT
 
logFÚt
;

333 ià(::
	`G‘Objeù
(
hGDI
, (
logFÚt
), &logFont) > 0)

334 
	`flFÚtDesütiÚ
(
cÚŒŞFÚt
, 
logFÚt
, 
deçuÉCÚŒŞFÚtPix–Size
);

337 
fÚtDesütiÚ
 = 
cÚŒŞFÚt
;

340 ià(!
sy¡emFÚt
.
	`isAbsŞu‹Size
()) {

341 
HGDIOBJ
 
hGDI
 = ::
	`G‘StockObjeù
(
DEFAULT_GUI_FONT
);

342 ià(
hGDI
) {

343 
LOGFONT
 
logFÚt
;

344 ià(::
	`G‘Objeù
(
hGDI
, (
logFÚt
), &logFont) > 0)

345 
	`flFÚtDesütiÚ
(
sy¡emFÚt
, 
logFÚt
);

348 
fÚtDesütiÚ
 = 
sy¡emFÚt
;

353 
boŞ
 
R’d”ThemeWš
::
	`suµÜtsFocus
(
CÚŒŞP¬t
 
­³¬ªû
) const

355 
­³¬ªû
) {

356 
PushBu‰ÚP¬t
:

357 
Bu‰ÚP¬t
:

358 
DeçuÉBu‰ÚP¬t
:

359  
Œue
;

361  
çl£
;

365 
boŞ
 
R’d”ThemeWš
::
	`suµÜtsFocusRšg
(cÚ¡ 
R’d”StyË
* 
¡yË
) const

367  
	`suµÜtsFocus
(
¡yË
->
	`­³¬ªû
());

370 
R’d”ThemeWš
::
	`d‘”mšeCÏssicS‹
(
R’d”Objeù
* 
o
)

372 
¡©e
 = 0;

373 
o
->
	`¡yË
()->
	`­³¬ªû
()) {

374 
PushBu‰ÚP¬t
:

375 
Bu‰ÚP¬t
:

376 
DeçuÉBu‰ÚP¬t
:

377 
¡©e
 = 
DFCS_BUTTONPUSH
;

378 ià(!
	`isEÇbËd
(
o
))

379 
¡©e
 |ğ
DFCS_INACTIVE
;

380 ià(
	`isP»s£d
(
o
))

381 
¡©e
 |ğ
DFCS_PUSHED
;

383 
RadioP¬t
:

384 
CheckboxP¬t
:

385 
¡©e
 = (
o
->
	`¡yË
()->
	`­³¬ªû
(è=ğ
RadioP¬t
è? 
DFCS_BUTTONRADIO
 : 
DFCS_BUTTONCHECK
;

386 ià(
	`isChecked
(
o
))

387 
¡©e
 |ğ
DFCS_CHECKED
;

388 ià(!
	`isEÇbËd
(
o
))

389 
¡©e
 |ğ
DFCS_INACTIVE
;

390 ià(
	`isP»s£d
(
o
))

391 
¡©e
 |ğ
DFCS_PUSHED
;

393 
M’uli¡P¬t
:

394 
¡©e
 = 
DFCS_SCROLLCOMBOBOX
;

395 ià(!
	`isEÇbËd
(
o
))

396 
¡©e
 |ğ
DFCS_INACTIVE
;

397 ià(
	`isP»s£d
(
o
))

398 
¡©e
 |ğ
DFCS_PUSHED
;

402  
¡©e
;

405 
R’d”ThemeWš
::
	`d‘”mšeS‹
(
R’d”Objeù
* 
o
)

407 
»suÉ
 = 
TS_NORMAL
;

408 
CÚŒŞP¬t
 
­³¬ªû
 = 
o
->
	`¡yË
()->
	`­³¬ªû
();

409 ià(!
	`isEÇbËd
(
o
))

410 
»suÉ
 = 
TS_DISABLED
;

411 ià(
	`isR—dOÆyCÚŒŞ
(
o
è&& (
TextF›ldP¬t
 =ğ
­³¬ªû
 || 
TextA»aP¬t
 =ğ­³¬ªû || 
S—rchF›ldP¬t
 ==‡ppearance))

412 
»suÉ
 = 
TFS_READONLY
;

413 ià(
	`isP»s£d
(
o
))

414 
»suÉ
 = 
TS_ACTIVE
;

415 ià(
	`suµÜtsFocus
(
­³¬ªû
è&& 
	`isFocu£d
(
o
))

416 
»suÉ
 = 
TS_FOCUSED
;

417 ià(
	`isHov”ed
(
o
))

418 
»suÉ
 = 
TS_HOVER
;

419 ià(
	`isChecked
(
o
))

420 
»suÉ
 += 4;

421  
»suÉ
;

424 
R’d”ThemeWš
::
	`d‘”mšeSlid”ThumbS‹
(
R’d”Objeù
* 
o
)

426 
»suÉ
 = 
TUS_NORMAL
;

427 ià(!
	`isEÇbËd
(
o
->
	`·»Á
()))

428 
»suÉ
 = 
TUS_DISABLED
;

429 ià(
	`suµÜtsFocus
(
o
->
	`¡yË
()->
	`­³¬ªû
()è&& 
	`isFocu£d
(o->
	`·»Á
()))

430 
»suÉ
 = 
TUS_FOCUSED
;

431 ià(
	`toR’d”Slid”
(
o
->
	`·»Á
())->
	`šD¿gMode
())

432 
»suÉ
 = 
TUS_PRESSED
;

433 ià(
	`isHov”ed
(
o
))

434 
»suÉ
 = 
TUS_HOT
;

435  
»suÉ
;

438 
R’d”ThemeWš
::
	`d‘”mšeBu‰ÚS‹
(
R’d”Objeù
* 
o
)

440 
»suÉ
 = 
PBS_NORMAL
;

441 ià(!
	`isEÇbËd
(
o
))

442 
»suÉ
 = 
PBS_DISABLED
;

443 ià(
	`isP»s£d
(
o
))

444 
»suÉ
 = 
PBS_PRESSED
;

445 ià(
	`suµÜtsFocus
(
o
->
	`¡yË
()->
	`­³¬ªû
()è&& 
	`isFocu£d
(o))

446 
»suÉ
 = 
PBS_DEFAULTED
;

447 ià(
	`isHov”ed
(
o
))

448 
»suÉ
 = 
PBS_HOT
;

449 ià(
	`isDeçuÉ
(
o
))

450 
»suÉ
 = 
PBS_DEFAULTED
;

451  
»suÉ
;

454 
ThemeD©a
 
R’d”ThemeWš
::
	`g‘CÏssicThemeD©a
(
R’d”Objeù
* 
o
)

456 
ThemeD©a
 
»suÉ
;

457 
o
->
	`¡yË
()->
	`­³¬ªû
()) {

458 
PushBu‰ÚP¬t
:

459 
Bu‰ÚP¬t
:

460 
DeçuÉBu‰ÚP¬t
:

461 
CheckboxP¬t
:

462 
RadioP¬t
:

463 
»suÉ
.
m_·¹
 = 
DFC_BUTTON
;

464 
»suÉ
.
m_¡©e
 = 
	`d‘”mšeCÏssicS‹
(
o
);

466 
M’uli¡P¬t
:

467 
»suÉ
.
m_·¹
 = 
DFC_SCROLL
;

468 
»suÉ
.
m_¡©e
 = 
	`d‘”mšeCÏssicS‹
(
o
);

470 
S—rchF›ldP¬t
:

471 
TextF›ldP¬t
:

472 
TextA»aP¬t
:

473 
»suÉ
.
m_·¹
 = 
TFP_TEXTFIELD
;

474 
»suÉ
.
m_¡©e
 = 
	`d‘”mšeS‹
(
o
);

476 
Slid”HÜizÚlP¬t
:

477 
»suÉ
.
m_·¹
 = 
TKP_TRACK
;

478 
»suÉ
.
m_¡©e
 = 
TS_NORMAL
;

480 
Slid”V”tiÿlP¬t
:

481 
»suÉ
.
m_·¹
 = 
TKP_TRACKVERT
;

482 
»suÉ
.
m_¡©e
 = 
TS_NORMAL
;

484 
Slid”ThumbHÜizÚlP¬t
:

485 
»suÉ
.
m_·¹
 = 
TKP_THUMBBOTTOM
;

486 
»suÉ
.
m_¡©e
 = 
	`d‘”mšeSlid”ThumbS‹
(
o
);

488 
Slid”ThumbV”tiÿlP¬t
:

489 
»suÉ
.
m_·¹
 = 
TKP_THUMBRIGHT
;

490 
»suÉ
.
m_¡©e
 = 
	`d‘”mšeSlid”ThumbS‹
(
o
);

495  
»suÉ
;

498 
ThemeD©a
 
R’d”ThemeWš
::
	`g‘ThemeD©a
(
R’d”Objeù
* 
o
)

500 ià(!
haveTheme
)

501  
	`g‘CÏssicThemeD©a
(
o
);

503 
ThemeD©a
 
»suÉ
;

504 
o
->
	`¡yË
()->
	`­³¬ªû
()) {

505 
PushBu‰ÚP¬t
:

506 
Bu‰ÚP¬t
:

507 
DeçuÉBu‰ÚP¬t
:

508 
»suÉ
.
m_·¹
 = 
BP_BUTTON
;

509 
»suÉ
.
m_¡©e
 = 
	`d‘”mšeBu‰ÚS‹
(
o
);

511 
CheckboxP¬t
:

512 
»suÉ
.
m_·¹
 = 
BP_CHECKBOX
;

513 
»suÉ
.
m_¡©e
 = 
	`d‘”mšeS‹
(
o
);

515 
M’uli¡P¬t
:

516 
M’uli¡Bu‰ÚP¬t
:

517 
»suÉ
.
m_·¹
 = 
	`isRuÂšgOnVi¡aOrL©”
(è? 
CP_DROPDOWNBUTTONRIGHT
 : 
CP_DROPDOWNBUTTON
;

518 ià(
	`isRuÂšgOnVi¡aOrL©”
(è&& 
	`docum’tIsInAµliÿtiÚChromeMode
(
o
->
	`docum’t
())) {

521 
»suÉ
.
m_¡©e
 = 
TS_NORMAL
;

523 
»suÉ
.
m_¡©e
 = 
	`d‘”mšeS‹
(
o
);

525 
RadioP¬t
:

526 
»suÉ
.
m_·¹
 = 
BP_RADIO
;

527 
»suÉ
.
m_¡©e
 = 
	`d‘”mšeS‹
(
o
);

529 
S—rchF›ldP¬t
:

530 
TextF›ldP¬t
:

531 
TextA»aP¬t
:

532 
»suÉ
.
m_·¹
 = 
	`isRuÂšgOnVi¡aOrL©”
(è? 
EP_EDITBORDER_NOSCROLL
 : 
TFP_TEXTFIELD
;

533 
»suÉ
.
m_¡©e
 = 
	`d‘”mšeS‹
(
o
);

535 
Slid”HÜizÚlP¬t
:

536 
»suÉ
.
m_·¹
 = 
TKP_TRACK
;

537 
»suÉ
.
m_¡©e
 = 
TS_NORMAL
;

539 
Slid”V”tiÿlP¬t
:

540 
»suÉ
.
m_·¹
 = 
TKP_TRACKVERT
;

541 
»suÉ
.
m_¡©e
 = 
TS_NORMAL
;

543 
Slid”ThumbHÜizÚlP¬t
:

544 
»suÉ
.
m_·¹
 = 
TKP_THUMBBOTTOM
;

545 
»suÉ
.
m_¡©e
 = 
	`d‘”mšeSlid”ThumbS‹
(
o
);

547 
Slid”ThumbV”tiÿlP¬t
:

548 
»suÉ
.
m_·¹
 = 
TKP_THUMBRIGHT
;

549 
»suÉ
.
m_¡©e
 = 
	`d‘”mšeSlid”ThumbS‹
(
o
);

553  
»suÉ
;

556 
	`d¿wCÚŒŞ
(
G¿phicsCÚ‹xt
* 
cÚ‹xt
, 
R’d”Objeù
* 
o
, 
HANDLE
 
theme
, cÚ¡ 
ThemeD©a
& 
themeD©a
, cÚ¡ 
IÁReù
& 
r
)

558 
boŞ
 
®phaBËnd
 = 
çl£
;

559 ià(
theme
)

560 
®phaBËnd
 = 
	`IsThemeBackgroundP¬tŸÎyT¿n¥¬’t
(
theme
, 
themeD©a
.
m_·¹
,hemeD©a.
m_¡©e
);

561 
HDC
 
hdc
 = 
cÚ‹xt
->
	`g‘WšdowsCÚ‹xt
(
r
, 
®phaBËnd
);

562 
RECT
 
widg‘Reù
 = 
r
;

563 ià(
theme
)

564 
	`D¿wThemeBackground
(
theme
, 
hdc
, 
themeD©a
.
m_·¹
,hemeD©a.
m_¡©e
, &
widg‘Reù
, 
NULL
);

566 ià(
themeD©a
.
m_·¹
 =ğ
TFP_TEXTFIELD
) {

567 ::
	`D¿wEdge
(
hdc
, &
widg‘Reù
, 
EDGE_SUNKEN
, 
BF_RECT
 | 
BF_ADJUST
);

568 ià(
themeD©a
.
m_¡©e
 =ğ
TS_DISABLED
 ||hemeD©a.m_¡©=ğ
TFS_READONLY
)

569 ::
	`FlReù
(
hdc
, &
widg‘Reù
, (
HBRUSH
)(
COLOR_BTNFACE
+1));

571 ::
	`FlReù
(
hdc
, &
widg‘Reù
, (
HBRUSH
)(
COLOR_WINDOW
+1));

572 } ià(
themeD©a
.
m_·¹
 =ğ
TKP_TRACK
 ||hemeD©a.m_·¹ =ğ
TKP_TRACKVERT
) {

573 ::
	`D¿wEdge
(
hdc
, &
widg‘Reù
, 
EDGE_SUNKEN
, 
BF_RECT
 | 
BF_ADJUST
);

574 ::
	`FlReù
(
hdc
, &
widg‘Reù
, (
HBRUSH
)
	`G‘StockObjeù
(
GRAY_BRUSH
));

575 } ià((
o
->
	`¡yË
()->
	`­³¬ªû
(è=ğ
Slid”ThumbHÜizÚlP¬t
 ||

576 
o
->
	`¡yË
()->
	`­³¬ªû
(è=ğ
Slid”ThumbV”tiÿlP¬t
) &&

577 (
themeD©a
.
m_·¹
 =ğ
TKP_THUMBBOTTOM
 ||hemeD©a.m_·¹ =ğ
TKP_THUMBTOP
 ||

578 
themeD©a
.
m_·¹
 =ğ
TKP_THUMBLEFT
 ||hemeD©a.m_·¹ =ğ
TKP_THUMBRIGHT
)) {

579 ::
	`D¿wEdge
(
hdc
, &
widg‘Reù
, 
EDGE_RAISED
, 
BF_RECT
 | 
BF_SOFT
 | 
BF_MIDDLE
 | 
BF_ADJUST
);

580 ià(
themeD©a
.
m_¡©e
 =ğ
TUS_DISABLED
) {

581 
WORD
 
·‰”nB™s
[8] = {0xaa, 0x55, 0xaa, 0x55, 0xaa, 0x55, 0xaa, 0x55};

582 
HBITMAP
 
·‰”nBmp
 = ::
	`C»©eB™m­
(8, 8, 1, 1, 
·‰”nB™s
);

583 ià(
·‰”nBmp
) {

584 
HBRUSH
 
brush
 = (HBRUSHè::
	`C»©eP©‹ºBrush
(
·‰”nBmp
);

585 
COLORREF
 
ŞdFÜeCŞÜ
 = ::
	`S‘TextCŞÜ
(
hdc
, ::
	`G‘SysCŞÜ
(
COLOR_3DFACE
));

586 
COLORREF
 
ŞdBackCŞÜ
 = ::
	`S‘BkCŞÜ
(
hdc
, ::
	`G‘SysCŞÜ
(
COLOR_3DHILIGHT
));

587 
POINT
 
p
;

588 ::
	`G‘V›wpÜtOrgEx
(
hdc
, &
p
);

589 ::
	`S‘BrushOrgEx
(
hdc
, 
p
.
x
 + 
widg‘Reù
.
Ëá
,….
y
 + widg‘Reù.
tİ
, 
NULL
);

590 
HBRUSH
 
ŞdBrush
 = (HBRUSHè::
	`S–eùObjeù
(
hdc
, 
brush
);

591 ::
	`FlReù
(
hdc
, &
widg‘Reù
, 
brush
);

592 ::
	`S‘TextCŞÜ
(
hdc
, 
ŞdFÜeCŞÜ
);

593 ::
	`S‘BkCŞÜ
(
hdc
, 
ŞdBackCŞÜ
);

594 ::
	`S–eùObjeù
(
hdc
, 
ŞdBrush
);

595 ::
	`D–‘eObjeù
(
brush
);

597 ::
	`FlReù
(
hdc
, &
widg‘Reù
, (
HBRUSH
)
COLOR_3DHILIGHT
);

598 ::
	`D–‘eObjeù
(
·‰”nBmp
);

602 ià(
o
->
	`¡yË
()->
	`­³¬ªû
(è=ğ
DeçuÉBu‰ÚP¬t
) {

603 
HBRUSH
 
brush
 = ::
	`G‘SysCŞÜBrush
(
COLOR_3DDKSHADOW
);

604 ::
	`F¿meReù
(
hdc
, &
widg‘Reù
, 
brush
);

605 ::
	`Inæ©eReù
(&
widg‘Reù
, -1, -1);

606 ::
	`D¿wEdge
(
hdc
, &
widg‘Reù
, 
BDR_RAISEDOUTER
, 
BF_RECT
 | 
BF_MIDDLE
);

608 ::
	`D¿wF¿meCÚŒŞ
(
hdc
, &
widg‘Reù
, 
themeD©a
.
m_·¹
,hemeD©a.
m_¡©e
);

611 
cÚ‹xt
->
	`»Ëa£WšdowsCÚ‹xt
(
hdc
, 
r
, 
®phaBËnd
);

614 
boŞ
 
R’d”ThemeWš
::
	`·štBu‰Ú
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
r
)

616 
	`d¿wCÚŒŞ
(
i
.
cÚ‹xt
, 
o
, 
	`bu‰ÚTheme
(), 
	`g‘ThemeD©a
(o), 
r
);

617  
çl£
;

620 
R’d”ThemeWš
::
	`£tCheckboxSize
(
R’d”StyË
* 
¡yË
) const

623 ià(!
¡yË
->
	`width
().
	`isIÁršsicOrAuto
(è&& !¡yË->
	`height
().
	`isAuto
())

630 ià(
¡yË
->
	`width
().
	`isIÁršsicOrAuto
())

631 
¡yË
->
	`£tWidth
(
	`L’gth
(13, 
Fixed
));

632 ià(
¡yË
->
	`height
().
	`isAuto
())

633 
¡yË
->
	`£tHeight
(
	`L’gth
(13, 
Fixed
));

636 
boŞ
 
R’d”ThemeWš
::
	`·štTextF›ld
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
r
)

638 
	`d¿wCÚŒŞ
(
i
.
cÚ‹xt
, 
o
, 
	`‹xtF›ldTheme
(), 
	`g‘ThemeD©a
(o), 
r
);

639  
çl£
;

642 
boŞ
 
R’d”ThemeWš
::
	`·štM’uLi¡
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
r
)

644 
HANDLE
 
theme
;

645 
·¹
;

646 ià(
haveTheme
 && 
	`isRuÂšgOnVi¡aOrL©”
()) {

647 
theme
 = 
	`m’uLi¡Theme
();

648 ià(
	`docum’tIsInAµliÿtiÚChromeMode
(
o
->
	`docum’t
()))

649 
·¹
 = 
CP_READONLY
;

651 
·¹
 = 
CP_BORDER
;

653 
theme
 = 
	`‹xtF›ldTheme
();

654 
·¹
 = 
TFP_TEXTFIELD
;

657 
	`d¿wCÚŒŞ
(
i
.
cÚ‹xt
, 
o
, 
theme
, 
	`ThemeD©a
(
·¹
, 
	`d‘”mšeS‹
(o)), 
r
);

659  
	`·štM’uLi¡Bu‰Ú
(
o
, 
i
, 
r
);

662 
R’d”ThemeWš
::
	`adju¡M’uLi¡StyË
(
CSSStyËS–eùÜ
* 
£ËùÜ
, 
R’d”StyË
* 
¡yË
, 
EËm’t
* 
e
) const

664 
¡yË
->
	`»£tBÜd”
();

665 
	`adju¡M’uLi¡Bu‰ÚStyË
(
£ËùÜ
, 
¡yË
, 
e
);

668 
R’d”ThemeWš
::
	`adju¡M’uLi¡Bu‰ÚStyË
(
CSSStyËS–eùÜ
* 
£ËùÜ
, 
R’d”StyË
* 
¡yË
, 
EËm’t
* 
e
) const

671 cÚ¡ 
drİDownBoxPaddšgTİ
 = 2;

672 cÚ¡ 
drİDownBoxPaddšgRight
 = 
¡yË
->
	`dœeùiÚ
(è=ğ
LTR
 ? 4 + 
drİDownBu‰ÚWidth
 : 4;

673 cÚ¡ 
drİDownBoxPaddšgBÙtom
 = 2;

674 cÚ¡ 
drİDownBoxPaddšgLeá
 = 
¡yË
->
	`dœeùiÚ
(è=ğ
LTR
 ? 4 : 4 + 
drİDownBu‰ÚWidth
;

676 cÚ¡ 
drİDownBoxMšHeight
 = 12;

679 
¡yË
->
	`£tPaddšgTİ
(
	`L’gth
(
drİDownBoxPaddšgTİ
, 
Fixed
));

680 
¡yË
->
	`£tPaddšgRight
(
	`L’gth
(
drİDownBoxPaddšgRight
, 
Fixed
));

681 
¡yË
->
	`£tPaddšgBÙtom
(
	`L’gth
(
drİDownBoxPaddšgBÙtom
, 
Fixed
));

682 
¡yË
->
	`£tPaddšgLeá
(
	`L’gth
(
drİDownBoxPaddšgLeá
, 
Fixed
));

685 
¡yË
->
	`£tHeight
(
	`L’gth
(
Auto
));

688 
mšHeight
 = 
¡yË
->
	`fÚt
().
	`height
();

689 
mšHeight
 = 
	`max
(mšHeight, 
drİDownBoxMšHeight
);

691 
¡yË
->
	`£tMšHeight
(
	`L’gth
(
mšHeight
, 
Fixed
));

694 
¡yË
->
	`£tWh™eS·û
(
PRE
);

697 
boŞ
 
R’d”ThemeWš
::
	`·štM’uLi¡Bu‰Ú
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
r
)

700 
bÜd”ThickÃss
 = 
haveTheme
 ? 1 : 2;

704 
IÁReù
 
	`bu‰ÚReù
(
r
);

705 
bu‰ÚReù
.
	`šæ©e
(-
bÜd”ThickÃss
);

706 ià(
o
->
	`¡yË
()->
	`dœeùiÚ
(è=ğ
LTR
)

707 
bu‰ÚReù
.
	`£tX
(bu‰ÚReù.
	`right
(è- 
drİDownBu‰ÚWidth
);

708 
bu‰ÚReù
.
	`£tWidth
(
drİDownBu‰ÚWidth
);

710 ià(
	`isRuÂšgOnVi¡aOrL©”
()) {

712 
bu‰ÚReù
.
	`£tY
(bu‰ÚReù.
	`y
(è- 
vi¡aM’uLi¡Bu‰ÚOut£t
);

713 
bu‰ÚReù
.
	`£tHeight
(bu‰ÚReù.
	`height
(è+ 2 * 
vi¡aM’uLi¡Bu‰ÚOut£t
);

714 
bu‰ÚReù
.
	`£tWidth
(bu‰ÚReù.
	`width
(è+ 
vi¡aM’uLi¡Bu‰ÚOut£t
);

717 
	`d¿wCÚŒŞ
(
i
.
cÚ‹xt
, 
o
, 
	`m’uLi¡Theme
(), 
	`g‘ThemeD©a
(o), 
bu‰ÚReù
);

719  
çl£
;

722 cÚ¡ 
ŒackWidth
 = 4;

724 
boŞ
 
R’d”ThemeWš
::
	`·štSlid”T¿ck
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
r
)

726 
IÁReù
 
bounds
 = 
r
;

728 ià(
o
->
	`¡yË
()->
	`­³¬ªû
(è=ğ
Slid”HÜizÚlP¬t
) {

729 
bounds
.
	`£tHeight
(
ŒackWidth
);

730 
bounds
.
	`£tY
(
r
.
	`y
(è+„.
	`height
(è/ 2 - 
ŒackWidth
 / 2);

731 } ià(
o
->
	`¡yË
()->
	`­³¬ªû
(è=ğ
Slid”V”tiÿlP¬t
) {

732 
bounds
.
	`£tWidth
(
ŒackWidth
);

733 
bounds
.
	`£tX
(
r
.
	`x
(è+„.
	`width
(è/ 2 - 
ŒackWidth
 / 2);

736 
	`d¿wCÚŒŞ
(
i
.
cÚ‹xt
, 
o
, 
	`¦id”Theme
(), 
	`g‘ThemeD©a
(o), 
bounds
);

737  
çl£
;

740 
boŞ
 
R’d”ThemeWš
::
	`·štSlid”Thumb
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
r
)

742 
	`d¿wCÚŒŞ
(
i
.
cÚ‹xt
, 
o
, 
	`¦id”Theme
(), 
	`g‘ThemeD©a
(o), 
r
);

743  
çl£
;

746 cÚ¡ 
¦id”ThumbWidth
 = 7;

747 cÚ¡ 
¦id”ThumbHeight
 = 15;

749 
R’d”ThemeWš
::
	`adju¡Slid”ThumbSize
(
R’d”Objeù
* 
o
) const

751 ià(
o
->
	`¡yË
()->
	`­³¬ªû
(è=ğ
Slid”ThumbV”tiÿlP¬t
) {

752 
o
->
	`¡yË
()->
	`£tWidth
(
	`L’gth
(
¦id”ThumbHeight
, 
Fixed
));

753 
o
->
	`¡yË
()->
	`£tHeight
(
	`L’gth
(
¦id”ThumbWidth
, 
Fixed
));

754 } ià(
o
->
	`¡yË
()->
	`­³¬ªû
(è=ğ
Slid”ThumbHÜizÚlP¬t
) {

755 
o
->
	`¡yË
()->
	`£tWidth
(
	`L’gth
(
¦id”ThumbWidth
, 
Fixed
));

756 
o
->
	`¡yË
()->
	`£tHeight
(
	`L’gth
(
¦id”ThumbHeight
, 
Fixed
));

758 #ià
	`ENABLE
(
VIDEO
)

759 ià(
o
->
	`¡yË
()->
	`­³¬ªû
(è=ğ
MedŸSlid”ThumbP¬t
)

760 
R’d”MedŸCÚŒŞs
::
	`adju¡MedŸSlid”ThumbSize
(
o
);

764 
R’d”ThemeWš
::
	`bu‰ÚIÁ”ÇlPaddšgLeá
() const

769 
R’d”ThemeWš
::
	`bu‰ÚIÁ”ÇlPaddšgRight
() const

774 
R’d”ThemeWš
::
	`bu‰ÚIÁ”ÇlPaddšgTİ
() const

779 
R’d”ThemeWš
::
	`bu‰ÚIÁ”ÇlPaddšgBÙtom
() const

784 
boŞ
 
R’d”ThemeWš
::
	`·štS—rchF›ld
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
r
)

786  
	`·štTextF›ld
(
o
, 
i
, 
r
);

789 
R’d”ThemeWš
::
	`adju¡S—rchF›ldStyË
(
CSSStyËS–eùÜ
* 
£ËùÜ
, 
R’d”StyË
* 
¡yË
, 
EËm’t
* 
e
) const

792 cÚ¡ 
·ddšg
 = 1;

793 
¡yË
->
	`£tPaddšgLeá
(
	`L’gth
(
·ddšg
, 
Fixed
));

794 
¡yË
->
	`£tPaddšgRight
(
	`L’gth
(
·ddšg
, 
Fixed
));

795 
¡yË
->
	`£tPaddšgTİ
(
	`L’gth
(
·ddšg
, 
Fixed
));

796 
¡yË
->
	`£tPaddšgBÙtom
(
	`L’gth
(
·ddšg
, 
Fixed
));

797 ià(
e
 &&ƒ->
	`focu£d
(è&&ƒ->
	`docum’t
()->
	`äame
()->
	`£ËùiÚ
()->
	`isFocu£dAndAùive
())

798 
¡yË
->
	`£tOušeOff£t
(-2);

801 
boŞ
 
R’d”ThemeWš
::
	`·štS—rchF›ldCªûlBu‰Ú
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

803 
IÁReù
 
bounds
 = 
r
;

804 
	`ASSERT
(
o
->
	`·»Á
());

805 ià(!
o
->
	`·»Á
(è|| !o->·»Á()->
	`isBox
())

806  
çl£
;

808 
R’d”Box
* 
·»ÁR’d”Box
 = 
	`toR’d”Box
(
o
->
	`·»Á
());

810 
IÁReù
 
·»ÁBox
 = 
·»ÁR’d”Box
->
	`absŞu‹CÚ‹ÁBox
();

813 
bounds
.
	`£tHeight
(
	`mš
(
·»ÁBox
.
	`width
(), mšÕ¬’tBox.
	`height
(), bounds.height())));

814 
bounds
.
	`£tWidth
(bounds.
	`height
());

818 
bounds
.
	`£tY
(
·»ÁBox
.
	`y
(è+ (·»ÁBox.
	`height
() - bounds.height() + 1) / 2);

820 
Image
* 
ÿnûlImage
 = Image::
	`lßdPÏtfÜmResourû
("£¬chCªûl").
	`»Ëa£Ref
();

821 
Image
* 
ÿnûlP»s£dImage
 = Image::
	`lßdPÏtfÜmResourû
("£¬chCªûlP»s£d").
	`»Ëa£Ref
();

822 
·štInfo
.
cÚ‹xt
->
	`d¿wImage
(
	`isP»s£d
(
o
è? 
ÿnûlP»s£dImage
 : 
ÿnûlImage
, o->
	`¡yË
()->
	`cŞÜS·û
(), 
bounds
);

823  
çl£
;

826 
R’d”ThemeWš
::
	`adju¡S—rchF›ldCªûlBu‰ÚStyË
(
CSSStyËS–eùÜ
* 
£ËùÜ
, 
R’d”StyË
* 
¡yË
, 
EËm’t
* 
e
) const

829 
fÚtSÿË
 = 
¡yË
->
	`fÚtSize
(è/ 
deçuÉCÚŒŞFÚtPix–Size
;

830 
ÿnûlBu‰ÚSize
 = 
	`Ìoundf
(
	`mš
(
	`max
(
mšCªûlBu‰ÚSize
, 
deçuÉCªûlBu‰ÚSize
 * 
fÚtSÿË
), 
maxCªûlBu‰ÚSize
));

831 
¡yË
->
	`£tWidth
(
	`L’gth
(
ÿnûlBu‰ÚSize
, 
Fixed
));

832 
¡yË
->
	`£tHeight
(
	`L’gth
(
ÿnûlBu‰ÚSize
, 
Fixed
));

835 
R’d”ThemeWš
::
	`adju¡S—rchF›ldDecÜ©iÚStyË
(
CSSStyËS–eùÜ
* 
£ËùÜ
, 
R’d”StyË
* 
¡yË
, 
EËm’t
* 
e
) const

837 
IÁSize
 
	`em±ySize
(1, 11);

838 
¡yË
->
	`£tWidth
(
	`L’gth
(
em±ySize
.
	`width
(), 
Fixed
));

839 
¡yË
->
	`£tHeight
(
	`L’gth
(
em±ySize
.
	`height
(), 
Fixed
));

842 
R’d”ThemeWš
::
	`adju¡S—rchF›ldResuÉsDecÜ©iÚStyË
(
CSSStyËS–eùÜ
* 
£ËùÜ
, 
R’d”StyË
* 
¡yË
, 
EËm’t
* 
e
) const

845 
fÚtSÿË
 = 
¡yË
->
	`fÚtSize
(è/ 
deçuÉCÚŒŞFÚtPix–Size
;

846 
magnif›rSize
 = 
	`Ìoundf
(
	`mš
(
	`max
(
mšS—rchF›ldResuÉsDecÜ©iÚSize
, 
deçuÉS—rchF›ldResuÉsDecÜ©iÚSize
 * 
fÚtSÿË
),

847 
maxS—rchF›ldResuÉsDecÜ©iÚSize
));

848 
¡yË
->
	`£tWidth
(
	`L’gth
(
magnif›rSize
, 
Fixed
));

849 
¡yË
->
	`£tHeight
(
	`L’gth
(
magnif›rSize
, 
Fixed
));

852 
boŞ
 
R’d”ThemeWš
::
	`·štS—rchF›ldResuÉsDecÜ©iÚ
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

854 
IÁReù
 
bounds
 = 
r
;

855 
	`ASSERT
(
o
->
	`·»Á
());

856 ià(!
o
->
	`·»Á
(è|| !o->·»Á()->
	`isBox
())

857  
çl£
;

859 
R’d”Box
* 
·»ÁR’d”Box
 = 
	`toR’d”Box
(
o
->
	`·»Á
());

860 
IÁReù
 
·»ÁBox
 = 
·»ÁR’d”Box
->
	`absŞu‹CÚ‹ÁBox
();

863 
bounds
.
	`£tHeight
(
	`mš
(
·»ÁBox
.
	`width
(), mšÕ¬’tBox.
	`height
(), bounds.height())));

864 
bounds
.
	`£tWidth
(bounds.
	`height
());

868 
bounds
.
	`£tY
(
·»ÁBox
.
	`y
(è+ (·»ÁBox.
	`height
() - bounds.height() + 1) / 2);

870 
Image
* 
magnif›rImage
 = Image::
	`lßdPÏtfÜmResourû
("£¬chMagnif›r").
	`»Ëa£Ref
();

871 
·štInfo
.
cÚ‹xt
->
	`d¿wImage
(
magnif›rImage
, 
o
->
	`¡yË
()->
	`cŞÜS·û
(), 
bounds
);

872  
çl£
;

875 
R’d”ThemeWš
::
	`adju¡S—rchF›ldResuÉsBu‰ÚStyË
(
CSSStyËS–eùÜ
* 
£ËùÜ
, 
R’d”StyË
* 
¡yË
, 
EËm’t
* 
e
) const

878 
fÚtSÿË
 = 
¡yË
->
	`fÚtSize
(è/ 
deçuÉCÚŒŞFÚtPix–Size
;

879 
magnif›rHeight
 = 
	`Ìoundf
(
	`mš
(
	`max
(
mšS—rchF›ldResuÉsDecÜ©iÚSize
, 
deçuÉS—rchF›ldResuÉsDecÜ©iÚSize
 * 
fÚtSÿË
),

880 
maxS—rchF›ldResuÉsDecÜ©iÚSize
));

881 
magnif›rWidth
 = 
	`Ìoundf
(
magnif›rHeight
 * 
deçuÉS—rchF›ldResuÉsBu‰ÚWidth
 / 
deçuÉS—rchF›ldResuÉsDecÜ©iÚSize
);

882 
¡yË
->
	`£tWidth
(
	`L’gth
(
magnif›rWidth
, 
Fixed
));

883 
¡yË
->
	`£tHeight
(
	`L’gth
(
magnif›rHeight
, 
Fixed
));

886 
boŞ
 
R’d”ThemeWš
::
	`·štS—rchF›ldResuÉsBu‰Ú
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

888 
IÁReù
 
bounds
 = 
r
;

889 
	`ASSERT
(
o
->
	`·»Á
());

890 ià(!
o
->
	`·»Á
())

891  
çl£
;

892 ià(!
o
->
	`·»Á
(è|| !o->·»Á()->
	`isBox
())

893  
çl£
;

895 
R’d”Box
* 
·»ÁR’d”Box
 = 
	`toR’d”Box
(
o
->
	`·»Á
());

896 
IÁReù
 
·»ÁBox
 = 
·»ÁR’d”Box
->
	`absŞu‹CÚ‹ÁBox
();

899 
bounds
.
	`£tHeight
(
	`mš
(
·»ÁBox
.
	`height
(), bounds.height()));

900 
bounds
.
	`£tWidth
(
	`mš
(
·»ÁBox
.
	`width
(), 
¡©ic_ÿ¡
<>(bounds.
	`height
(è* 
deçuÉS—rchF›ldResuÉsBu‰ÚWidth
 / 
deçuÉS—rchF›ldResuÉsDecÜ©iÚSize
)));

904 
bounds
.
	`£tY
(
·»ÁBox
.
	`y
(è+ (·»ÁBox.
	`height
() - bounds.height() + 1) / 2);

906 
Image
* 
magnif›rImage
 = Image::
	`lßdPÏtfÜmResourû
("£¬chMagnif›rResuÉs").
	`»Ëa£Ref
();

907 
·štInfo
.
cÚ‹xt
->
	`d¿wImage
(
magnif›rImage
, 
o
->
	`¡yË
()->
	`cŞÜS·û
(), 
bounds
);

908  
çl£
;

912 
	`cssV®ueIdToSysCŞÜIndex
(
cssV®ueId
)

914 
cssV®ueId
) {

915 
CSSV®ueAùivebÜd”
:  
COLOR_ACTIVEBORDER
;

916 
CSSV®ueAùiveÿ±iÚ
:  
COLOR_ACTIVECAPTION
;

917 
CSSV®ueAµwÜk¥aû
:  
COLOR_APPWORKSPACE
;

918 
CSSV®ueBackground
:  
COLOR_BACKGROUND
;

919 
CSSV®ueBu‰Úçû
:  
COLOR_BTNFACE
;

920 
CSSV®ueBu‰Úhighlight
:  
COLOR_BTNHIGHLIGHT
;

921 
CSSV®ueBu‰Úshadow
:  
COLOR_BTNSHADOW
;

922 
CSSV®ueBu‰Ú‹xt
:  
COLOR_BTNTEXT
;

923 
CSSV®ueC­tiÚ‹xt
:  
COLOR_CAPTIONTEXT
;

924 
CSSV®ueG¿y‹xt
:  
COLOR_GRAYTEXT
;

925 
CSSV®ueHighlight
:  
COLOR_HIGHLIGHT
;

926 
CSSV®ueHighligh‰ext
:  
COLOR_HIGHLIGHTTEXT
;

927 
CSSV®ueIÇùivebÜd”
:  
COLOR_INACTIVEBORDER
;

928 
CSSV®ueIÇùiveÿ±iÚ
:  
COLOR_INACTIVECAPTION
;

929 
CSSV®ueIÇùiveÿ±iÚ‹xt
:  
COLOR_INACTIVECAPTIONTEXT
;

930 
CSSV®ueInfobackground
:  
COLOR_INFOBK
;

931 
CSSV®ueInfÙext
:  
COLOR_INFOTEXT
;

932 
CSSV®ueM’u
:  
COLOR_MENU
;

933 
CSSV®ueM’u‹xt
:  
COLOR_MENUTEXT
;

934 
CSSV®ueSüŞlb¬
:  
COLOR_SCROLLBAR
;

935 
CSSV®ueTh»edd¬kshadow
:  
COLOR_3DDKSHADOW
;

936 
CSSV®ueTh»edçû
:  
COLOR_3DFACE
;

937 
CSSV®ueTh»edhighlight
:  
COLOR_3DHIGHLIGHT
;

938 
CSSV®ueTh»edlightshadow
:  
COLOR_3DLIGHT
;

939 
CSSV®ueTh»edshadow
:  
COLOR_3DSHADOW
;

940 
CSSV®ueWšdow
:  
COLOR_WINDOW
;

941 
CSSV®ueWšdowäame
:  
COLOR_WINDOWFRAME
;

942 
CSSV®ueWšdow‹xt
:  
COLOR_WINDOWTEXT
;

947 
CŞÜ
 
R’d”ThemeWš
::
	`sy¡emCŞÜ
(
cssV®ueId
) const

949 
sysCŞÜIndex
 = 
	`cssV®ueIdToSysCŞÜIndex
(
cssV®ueId
);

950 ià(
sysCŞÜIndex
 == -1)

951  
R’d”Theme
::
	`sy¡emCŞÜ
(
cssV®ueId
);

953 
COLORREF
 
cŞÜ
 = 
	`G‘SysCŞÜ
(
sysCŞÜIndex
);

954  
	`CŞÜ
(
	`G‘RV®ue
(
cŞÜ
), 
	`G‘GV®ue
(cŞÜ), 
	`G‘BV®ue
(color));

957 #ià
	`ENABLE
(
VIDEO
)

959 
boŞ
 
R’d”ThemeWš
::
	`shouldR’d”MedŸCÚŒŞP¬t
(
CÚŒŞP¬t
 
·¹
, 
EËm’t
* 
–em’t
)

961 ià(
·¹
 =ğ
MedŸToggËClo£dC­tiÚsBu‰ÚP¬t
) {

963 #ià
SAFARI_THEME_VERSION
 >= 4

964 ià(!
–em’t
->
	`hasTagName
(
videoTag
))

965  
çl£
;

967  
çl£
;

971  
R’d”Theme
::
	`shouldR’d”MedŸCÚŒŞP¬t
(
·¹
, 
–em’t
);

975 
boŞ
 
R’d”ThemeWš
::
	`·štMedŸFuÎsü“nBu‰Ú
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

977  
R’d”MedŸCÚŒŞs
::
	`·štMedŸCÚŒŞsP¬t
(
MedŸFuÎsü“nBu‰Ú
, 
o
, 
·štInfo
, 
r
);

980 
boŞ
 
R’d”ThemeWš
::
	`·štMedŸMu‹Bu‰Ú
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

982  
R’d”MedŸCÚŒŞs
::
	`·štMedŸCÚŒŞsP¬t
(
MedŸMu‹Bu‰Ú
, 
o
, 
·štInfo
, 
r
);

985 
boŞ
 
R’d”ThemeWš
::
	`·štMedŸPÏyBu‰Ú
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

987  
R’d”MedŸCÚŒŞs
::
	`·štMedŸCÚŒŞsP¬t
(
MedŸPÏyBu‰Ú
, 
o
, 
·štInfo
, 
r
);

990 
boŞ
 
R’d”ThemeWš
::
	`·štMedŸS“kBackBu‰Ú
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

992  
R’d”MedŸCÚŒŞs
::
	`·štMedŸCÚŒŞsP¬t
(
MedŸS“kBackBu‰Ú
, 
o
, 
·štInfo
, 
r
);

995 
boŞ
 
R’d”ThemeWš
::
	`·štMedŸS“kFÜw¬dBu‰Ú
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

997  
R’d”MedŸCÚŒŞs
::
	`·štMedŸCÚŒŞsP¬t
(
MedŸS“kFÜw¬dBu‰Ú
, 
o
, 
·štInfo
, 
r
);

1000 
boŞ
 
R’d”ThemeWš
::
	`·štMedŸSlid”T¿ck
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

1002  
R’d”MedŸCÚŒŞs
::
	`·štMedŸCÚŒŞsP¬t
(
MedŸSlid”
, 
o
, 
·štInfo
, 
r
);

1005 
boŞ
 
R’d”ThemeWš
::
	`·štMedŸSlid”Thumb
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

1007  
R’d”MedŸCÚŒŞs
::
	`·štMedŸCÚŒŞsP¬t
(
MedŸSlid”Thumb
, 
o
, 
·štInfo
, 
r
);

1010 
boŞ
 
R’d”ThemeWš
::
	`·štMedŸToggËClo£dC­tiÚsBu‰Ú
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

1012  
R’d”MedŸCÚŒŞs
::
	`·štMedŸCÚŒŞsP¬t
(
MedŸShowClo£dC­tiÚsBu‰Ú
, 
o
, 
·štInfo
, 
r
);

1017 
	}
}

	@RenderThemeWin.h

24 #iâdeà
R’d”ThemeWš_h


25 
	#R’d”ThemeWš_h


	)

27 
	~"R’d”Theme.h
"

29 #ià
WIN32


30 * 
	tHANDLE
;

31 
HINSTANCE__
* 
	tHINSTANCE
;

32 
HINSTANCE
 
	tHMODULE
;

35 
Çme¥aû
 
	gWebCÜe
 {

37 
	sThemeD©a
 {

38 
ThemeD©a
(è:
m_·¹
(0), 
m_¡©e
(0), 
m_şassicS‹
(0) {}

39 
ThemeD©a
(
·¹
, 
¡©e
)

40 : 
m_·¹
(
·¹
)

41 , 
m_¡©e
(
¡©e
)

42 , 
m_şassicS‹
(0)

45 
	gm_·¹
;

46 
	gm_¡©e
;

47 
	gm_şassicS‹
;

50 şas 
	cR’d”ThemeWš
 : 
public
 
R’d”Theme
 {

51 
public
:

52 
PassRefPŒ
<
R’d”Theme
> 
ü—‹
();

54 
vœtu®
 
SŒšg
 
exŒaDeçuÉStyËSh“t
();

55 
vœtu®
 
SŒšg
 
exŒaQuœksStyËSh“t
();

58 
vœtu®
 
boŞ
 
suµÜtsHov”
(cÚ¡ 
R’d”StyË
*) const;

60 
vœtu®
 
CŞÜ
 
¶©fÜmAùiveS–eùiÚBackgroundCŞÜ
() const;

61 
vœtu®
 
CŞÜ
 
¶©fÜmIÇùiveS–eùiÚBackgroundCŞÜ
() const;

62 
vœtu®
 
CŞÜ
 
¶©fÜmAùiveS–eùiÚFÜegroundCŞÜ
() const;

63 
vœtu®
 
CŞÜ
 
¶©fÜmIÇùiveS–eùiÚFÜegroundCŞÜ
() const;

66 
vœtu®
 
sy¡emFÚt
(
´İId
, 
FÚtDesütiÚ
&) const;

67 
vœtu®
 
CŞÜ
 
sy¡emCŞÜ
(
cssV®ueId
) const;

69 
vœtu®
 
boŞ
 
·štCheckbox
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
r
)

70 {  
·štBu‰Ú
(
o
, 
i
, 
r
); }

71 
vœtu®
 
£tCheckboxSize
(
R’d”StyË
*) const;

73 
vœtu®
 
boŞ
 
·štRadio
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
r
)

74 {  
·štBu‰Ú
(
o
, 
i
, 
r
); }

75 
vœtu®
 
£tRadioSize
(
R’d”StyË
* 
¡yË
) const

76 {  
£tCheckboxSize
(
¡yË
); }

78 
vœtu®
 
boŞ
 
·štBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

80 
vœtu®
 
boŞ
 
·štTextF›ld
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

82 
vœtu®
 
boŞ
 
·štTextA»a
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
r
)

83 {  
·štTextF›ld
(
o
, 
i
, 
r
); }

85 
vœtu®
 
adju¡M’uLi¡StyË
(
CSSStyËS–eùÜ
* 
£ËùÜ
, 
R’d”StyË
* 
¡yË
, 
EËm’t
* 
e
) const;

86 
vœtu®
 
boŞ
 
·štM’uLi¡
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

87 
vœtu®
 
adju¡M’uLi¡Bu‰ÚStyË
(
CSSStyËS–eùÜ
* 
£ËùÜ
, 
R’d”StyË
* 
¡yË
, 
EËm’t
* 
e
) const;

89 
vœtu®
 
boŞ
 
·štM’uLi¡Bu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

91 
vœtu®
 
boŞ
 
·štSlid”T¿ck
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
r
);

92 
vœtu®
 
boŞ
 
·štSlid”Thumb
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
r
);

93 
vœtu®
 
adju¡Slid”ThumbSize
(
R’d”Objeù
*) const;

95 
vœtu®
 
boŞ
 
pİupO±iÚSuµÜtsTextInd’t
(ècÚ¡ {  
	gŒue
; }

97 
vœtu®
 
bu‰ÚIÁ”ÇlPaddšgLeá
() const;

98 
vœtu®
 
bu‰ÚIÁ”ÇlPaddšgRight
() const;

99 
vœtu®
 
bu‰ÚIÁ”ÇlPaddšgTİ
() const;

100 
vœtu®
 
bu‰ÚIÁ”ÇlPaddšgBÙtom
() const;

102 
vœtu®
 
adju¡S—rchF›ldStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

103 
vœtu®
 
boŞ
 
·štS—rchF›ld
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

105 
vœtu®
 
adju¡S—rchF›ldCªûlBu‰ÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

106 
vœtu®
 
boŞ
 
·štS—rchF›ldCªûlBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

108 
vœtu®
 
adju¡S—rchF›ldDecÜ©iÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

109 
vœtu®
 
boŞ
 
·štS—rchF›ldDecÜ©iÚ
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&è{  
	gçl£
; }

111 
vœtu®
 
adju¡S—rchF›ldResuÉsDecÜ©iÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

112 
vœtu®
 
boŞ
 
·štS—rchF›ldResuÉsDecÜ©iÚ
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

114 
vœtu®
 
adju¡S—rchF›ldResuÉsBu‰ÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

115 
vœtu®
 
boŞ
 
·štS—rchF›ldResuÉsBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

117 
vœtu®
 
themeChªged
();

119 
vœtu®
 
adju¡Bu‰ÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
* 
¡yË
, 
EËm’t
*) const {}

120 
vœtu®
 
adju¡TextF›ldStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
* 
¡yË
, 
EËm’t
*) const {}

121 
vœtu®
 
adju¡TextA»aStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
* 
¡yË
, 
EËm’t
*) const {}

123 
£tWebK™IsBešgUÆßded
();

125 
vœtu®
 
boŞ
 
suµÜtsFocusRšg
(cÚ¡ 
R’d”StyË
*) const;

127 #ià
ENABLE
(
VIDEO
)

128 
vœtu®
 
boŞ
 
shouldR’d”MedŸCÚŒŞP¬t
(
CÚŒŞP¬t
, 
EËm’t
*);

129 
vœtu®
 
boŞ
 
·štMedŸFuÎsü“nBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

130 
vœtu®
 
boŞ
 
·štMedŸPÏyBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

131 
vœtu®
 
boŞ
 
·štMedŸMu‹Bu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

132 
vœtu®
 
boŞ
 
·štMedŸS“kBackBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

133 
vœtu®
 
boŞ
 
·štMedŸS“kFÜw¬dBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

134 
vœtu®
 
boŞ
 
·štMedŸSlid”T¿ck
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

135 
vœtu®
 
boŞ
 
·štMedŸSlid”Thumb
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

136 
vœtu®
 
boŞ
 
·štMedŸToggËClo£dC­tiÚsBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

139 
	g´iv©e
:

140 
R’d”ThemeWš
();

141 ~
R’d”ThemeWš
();

143 
addIÁršsicM¬gšs
(
R’d”StyË
*) const;

144 
şo£
();

146 
d‘”mšeS‹
(
R’d”Objeù
*);

147 
d‘”mšeCÏssicS‹
(
R’d”Objeù
*);

148 
d‘”mšeSlid”ThumbS‹
(
R’d”Objeù
*);

149 
d‘”mšeBu‰ÚS‹
(
R’d”Objeù
*);

151 
boŞ
 
suµÜtsFocus
(
CÚŒŞP¬t
) const;

153 
ThemeD©a
 
g‘ThemeD©a
(
R’d”Objeù
*);

154 
ThemeD©a
 
g‘CÏssicThemeD©a
(
R’d”Objeù
* 
o
);

156 
HANDLE
 
bu‰ÚTheme
() const;

157 
HANDLE
 
‹xtF›ldTheme
() const;

158 
HANDLE
 
m’uLi¡Theme
() const;

159 
HANDLE
 
¦id”Theme
() const;

161 
mubË
 
HANDLE
 
	gm_bu‰ÚTheme
;

162 
mubË
 
HANDLE
 
	gm_‹xtF›ldTheme
;

163 
mubË
 
HANDLE
 
	gm_m’uLi¡Theme
;

164 
mubË
 
HANDLE
 
	gm_¦id”Theme
;

	@RenderThemeWince.cpp

24 
	~"cÚfig.h
"

25 
	~"R’d”ThemeWšû.h
"

27 
	~"CSSStyËSh“t.h
"

28 
	~"CSSV®ueKeywÜds.h
"

29 
	~"Docum’t.h
"

30 
	~"G¿phicsCÚ‹xt.h
"

31 
	~"NÙIm¶em’‹d.h
"

32 #ià
ENABLE
(
VIDEO
)

33 
	~"HTMLMedŸEËm’t.h
"

36 
	~<wšdows.h
>

43 
	#THEME_COLOR
 204

	)

44 
	#THEME_FONT
 210

	)

47 
	#TS_NORMAL
 1

	)

48 
	#TS_HOVER
 2

	)

49 
	#TS_ACTIVE
 3

	)

50 
	#TS_DISABLED
 4

	)

51 
	#TS_FOCUSED
 5

	)

54 
	#BP_BUTTON
 1

	)

55 
	#BP_RADIO
 2

	)

56 
	#BP_CHECKBOX
 3

	)

59 
	#TFP_TEXTFIELD
 1

	)

60 
	#TFS_READONLY
 6

	)

62 
	$HANDLE
 (
	tWINAPI
*
	tİ’ThemeD©aPŒ
)(
	tHWND
 
	thwnd
, 
	tLPCWSTR
 
	tpszCÏssLi¡
);

63 
	$HRESULT
 (
	tWINAPI
*
	tşo£ThemeD©aPŒ
)(
	tHANDLE
 
	thTheme
);

64 
	$HRESULT
 (
	tWINAPI
*
	td¿wThemeBackgroundPŒ
)(
	tHANDLE
 
	thTheme
, 
	tHDC
 
	thdc
, 
	tiP¬tId
,

65 
	tiS‹Id
, cÚ¡ 
	tRECT
 *
	tpReù
,

66 cÚ¡ 
	tRECT
* 
	tpClReù
);

67 
	$HRESULT
 (
	tWINAPI
*
	td¿wThemeEdgePŒ
)(
	tHANDLE
 
	thTheme
, 
	tHDC
 
	thdc
, 
	tiP¬tId
,

68 
	tiS‹Id
, cÚ¡ 
	tRECT
 *
	tpReù
,

69 
	tuEdge
, 
	tuFÏgs
,

70 cÚ¡ 
	tRECT
* 
	tpClReù
);

71 
	$HRESULT
 (
	tWINAPI
*
	tg‘ThemeCÚ‹ÁReùPŒ
)(
	tHANDLE
 
	thTheme
, 
	tHDC
 
	thdc
, 
	tiP¬tId
,

72 
	tiS‹Id
, cÚ¡ 
	tRECT
* 
	tpReù
,

73 
	tRECT
* 
	tpCÚ‹ÁReù
);

74 
	$HRESULT
 (
	tWINAPI
*
	tg‘ThemeP¬tSizePŒ
)(
	tHANDLE
 
	thTheme
, 
	tHDC
 
	thdc
, 
	tiP¬tId
,

75 
	tiS‹Id
, 
	tRECT
* 
	t´c
, 
	tts
,

76 
	tSIZE
* 
	tpsz
);

77 
	$HRESULT
 (
	tWINAPI
*
	tg‘ThemeSysFÚtPŒ
)(
	tHANDLE
 
	thTheme
, 
	tiFÚtId
, 
	tOUT
 
	tLOGFONT
* 
	tpFÚt
);

78 
	$HRESULT
 (
	tWINAPI
*
	tg‘ThemeCŞÜPŒ
)(
	tHANDLE
 
	thTheme
, 
	tHDC
 
	thdc
, 
	tiP¬tId
,

79 
	tiS‹Id
, 
	tiPrİId
, 
	tOUT
 
	tCOLORREF
* 
	tpFÚt
);

81 
Çme¥aû
 
WebCÜe
 {

83 cÚ¡ 
drİDownBu‰ÚWidth
 = 17;

84 cÚ¡ 
ŒackWidth
 = 4;

86 
PassRefPŒ
<
R’d”Theme
> 
R’d”ThemeWšû
::
	`ü—‹
()

88  
	`adİtRef
(
Ãw
 
R’d”ThemeWšû
);

91 
PassRefPŒ
<
R’d”Theme
> R’d”Theme::
	`themeFÜPage
(
Page
* 
·ge
)

93 
R’d”Theme
* 
wšûTheme
 = 
R’d”ThemeWšû
::
	`ü—‹
().
	`»Ëa£Ref
();

94  
wšûTheme
;

97 
R’d”ThemeWšû
::
	`R’d”ThemeWšû
()

101 
R’d”ThemeWšû
::~
	`R’d”ThemeWšû
()

105 
CŞÜ
 
R’d”ThemeWšû
::
	`¶©fÜmAùiveS–eùiÚBackgroundCŞÜ
() const

107 
COLORREF
 
cŞÜ
 = 
	`G‘SysCŞÜ
(
COLOR_HIGHLIGHT
);

108  
	`CŞÜ
(
	`G‘RV®ue
(
cŞÜ
), 
	`G‘GV®ue
(cŞÜ), 
	`G‘BV®ue
(color), 255);

111 
CŞÜ
 
R’d”ThemeWšû
::
	`¶©fÜmIÇùiveS–eùiÚBackgroundCŞÜ
() const

113 
COLORREF
 
cŞÜ
 = 
	`G‘SysCŞÜ
(
COLOR_GRAYTEXT
);

114  
	`CŞÜ
(
	`G‘RV®ue
(
cŞÜ
), 
	`G‘GV®ue
(cŞÜ), 
	`G‘BV®ue
(color), 255);

117 
CŞÜ
 
R’d”ThemeWšû
::
	`¶©fÜmAùiveS–eùiÚFÜegroundCŞÜ
() const

119 
COLORREF
 
cŞÜ
 = 
	`G‘SysCŞÜ
(
COLOR_HIGHLIGHTTEXT
);

120  
	`CŞÜ
(
	`G‘RV®ue
(
cŞÜ
), 
	`G‘GV®ue
(cŞÜ), 
	`G‘BV®ue
(color), 255);

123 
CŞÜ
 
R’d”ThemeWšû
::
	`¶©fÜmIÇùiveS–eùiÚFÜegroundCŞÜ
() const

125  
CŞÜ
::
wh™e
;

128 
boŞ
 
R’d”ThemeWšû
::
	`suµÜtsFocus
(
CÚŒŞP¬t
 
­³¬ªû
) const

130 
­³¬ªû
) {

131 
PushBu‰ÚP¬t
:

132 
Bu‰ÚP¬t
:

133 
TextF›ldP¬t
:

134 
TextA»aP¬t
:

135  
Œue
;

137  
çl£
;

140  
çl£
;

143 
boŞ
 
R’d”ThemeWšû
::
	`suµÜtsFocusRšg
(cÚ¡ 
R’d”StyË
 *
¡yË
) const

145  
	`suµÜtsFocus
(
¡yË
->
	`­³¬ªû
());

148 
R’d”ThemeWšû
::
	`d‘”mšeCÏssicS‹
(
R’d”Objeù
* 
o
)

150 
»suÉ
 = 0;

151 ià(!
	`isEÇbËd
(
o
è|| 
	`isR—dOÆyCÚŒŞ
(o))

152 
»suÉ
 = 
DFCS_INACTIVE
;

153 ià(
	`isP»s£d
(
o
))

154 
»suÉ
 = 
DFCS_PUSHED
;

156 ià(
	`isChecked
(
o
))

157 
»suÉ
 |ğ
DFCS_CHECKED
;

158  
»suÉ
;

161 
ThemeD©a
 
R’d”ThemeWšû
::
	`g‘ThemeD©a
(
R’d”Objeù
* 
o
)

163 
ThemeD©a
 
»suÉ
;

164 
o
->
	`¡yË
()->
	`­³¬ªû
()) {

165 
PushBu‰ÚP¬t
:

166 
Bu‰ÚP¬t
:

167 
»suÉ
.
m_·¹
 = 
BP_BUTTON
;

168 
»suÉ
.
m_şassicS‹
 = 
DFCS_BUTTONPUSH
;

170 
CheckboxP¬t
:

171 
»suÉ
.
m_·¹
 = 
BP_CHECKBOX
;

172 
»suÉ
.
m_şassicS‹
 = 
DFCS_BUTTONCHECK
;

174 
RadioP¬t
:

175 
»suÉ
.
m_·¹
 = 
BP_RADIO
;

176 
»suÉ
.
m_şassicS‹
 = 
DFCS_BUTTONRADIO
;

178 
Li¡boxP¬t
:

179 
M’uli¡P¬t
:

180 
TextF›ldP¬t
:

181 
TextA»aP¬t
:

182 
»suÉ
.
m_·¹
 = 
TFP_TEXTFIELD
;

186 
»suÉ
.
m_şassicS‹
 |ğ
	`d‘”mšeCÏssicS‹
(
o
);

188  
»suÉ
;

191 
boŞ
 
R’d”ThemeWšû
::
	`·štBu‰Ú
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
r
)

194 
ThemeD©a
 
themeD©a
 = 
	`g‘ThemeD©a
(
o
);

197 
i
.
cÚ‹xt
->
	`d¿wF¿meCÚŒŞ
(
r
, 
DFC_BUTTON
, 
themeD©a
.
m_şassicS‹
);

198 ià(
	`isFocu£d
(
o
)) {

199 ià(
themeD©a
.
m_·¹
 =ğ
BP_BUTTON
) {

200 
IÁReù
 
	`focusReù
(
r
);

201 
focusReù
.
	`šæ©e
(-2);

202 
i
.
cÚ‹xt
->
	`d¿wFocusReù
(
focusReù
);

204 
i
.
cÚ‹xt
->
	`d¿wFocusReù
(
r
);

207  
çl£
;

210 
R’d”ThemeWšû
::
	`£tCheckboxSize
(
R’d”StyË
* 
¡yË
) const

213 ià(!
¡yË
->
	`width
().
	`isIÁršsicOrAuto
(è&& !¡yË->
	`height
().
	`isAuto
())

220 ià(
¡yË
->
	`width
().
	`isIÁršsicOrAuto
())

221 
¡yË
->
	`£tWidth
(
	`L’gth
(13, 
Fixed
));

222 ià(
¡yË
->
	`height
().
	`isAuto
())

223 
¡yË
->
	`£tHeight
(
	`L’gth
(13, 
Fixed
));

226 
boŞ
 
R’d”ThemeWšû
::
	`·štTextF›ld
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
r
)

229 
ThemeD©a
 
themeD©a
 = 
	`g‘ThemeD©a
(
o
);

232 
i
.
cÚ‹xt
->
	`·štTextF›ld
(
r
, 
themeD©a
.
m_şassicS‹
);

234  
çl£
;

237 
R’d”ThemeWšû
::
	`adju¡M’uLi¡StyË
(
CSSStyËS–eùÜ
* 
£ËùÜ
, 
R’d”StyË
* 
¡yË
, 
EËm’t
* 
e
) const

239 
¡yË
->
	`»£tBÜd”
();

240 
	`adju¡M’uLi¡Bu‰ÚStyË
(
£ËùÜ
, 
¡yË
, 
e
);

243 
boŞ
 
R’d”ThemeWšû
::
	`·štM’uLi¡
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
r
)

245 
	`·štTextF›ld
(
o
, 
i
, 
r
);

246 
	`·štM’uLi¡Bu‰Ú
(
o
, 
i
, 
r
);

247  
Œue
;

250 
boŞ
 
R’d”ThemeWšû
::
	`·štM’uLi¡Bu‰Ú
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
r
)

252 
IÁReù
 
	`bu‰ÚReù
(
r
.
	`right
(è- 
drİDownBu‰ÚWidth
 - 1,„.
	`y
(), drİDownBu‰ÚWidth,„.
	`height
());

253 
bu‰ÚReù
.
	`šæ©eY
(-1);

254 
i
.
cÚ‹xt
->
	`d¿wF¿meCÚŒŞ
(
bu‰ÚReù
, 
DFC_SCROLL
, 
DFCS_SCROLLCOMBOBOX
 | 
	`d‘”mšeCÏssicS‹
(
o
));

255  
Œue
;

258 
R’d”ThemeWšû
::
	`sy¡emFÚt
(
´İId
, 
FÚtDesütiÚ
& 
fÚtDesütiÚ
) const

260 
	`nÙIm¶em’‹d
();

263 
R’d”ThemeWšû
::
	`themeChªged
()

267 
SŒšg
 
R’d”ThemeWšû
::
	`exŒaDeçuÉStyËSh“t
()

269 
	`nÙIm¶em’‹d
();

270  
	`SŒšg
();

273 
SŒšg
 
R’d”ThemeWšû
::
	`exŒaQuœksStyËSh“t
()

275 
	`nÙIm¶em’‹d
();

276  
	`SŒšg
();

279 
boŞ
 
R’d”ThemeWšû
::
	`suµÜtsHov”
(cÚ¡ 
R’d”StyË
*) const

281  
çl£
;

285 
	`cssV®ueIdToSysCŞÜIndex
(
cssV®ueId
)

287 
cssV®ueId
) {

288 
CSSV®ueAùivebÜd”
:  
COLOR_ACTIVEBORDER
;

289 
CSSV®ueAùiveÿ±iÚ
:  
COLOR_ACTIVECAPTION
;

290 
CSSV®ueAµwÜk¥aû
:  
COLOR_APPWORKSPACE
;

291 
CSSV®ueBackground
:  
COLOR_BACKGROUND
;

292 
CSSV®ueBu‰Úçû
:  
COLOR_BTNFACE
;

293 
CSSV®ueBu‰Úhighlight
:  
COLOR_BTNHIGHLIGHT
;

294 
CSSV®ueBu‰Úshadow
:  
COLOR_BTNSHADOW
;

295 
CSSV®ueBu‰Ú‹xt
:  
COLOR_BTNTEXT
;

296 
CSSV®ueC­tiÚ‹xt
:  
COLOR_CAPTIONTEXT
;

297 
CSSV®ueG¿y‹xt
:  
COLOR_GRAYTEXT
;

298 
CSSV®ueHighlight
:  
COLOR_HIGHLIGHT
;

299 
CSSV®ueHighligh‰ext
:  
COLOR_HIGHLIGHTTEXT
;

300 
CSSV®ueIÇùivebÜd”
:  
COLOR_INACTIVEBORDER
;

301 
CSSV®ueIÇùiveÿ±iÚ
:  
COLOR_INACTIVECAPTION
;

302 
CSSV®ueIÇùiveÿ±iÚ‹xt
:  
COLOR_INACTIVECAPTIONTEXT
;

303 
CSSV®ueInfobackground
:  
COLOR_INFOBK
;

304 
CSSV®ueInfÙext
:  
COLOR_INFOTEXT
;

305 
CSSV®ueM’u
:  
COLOR_MENU
;

306 
CSSV®ueM’u‹xt
:  
COLOR_MENUTEXT
;

307 
CSSV®ueSüŞlb¬
:  
COLOR_SCROLLBAR
;

308 
CSSV®ueTh»edd¬kshadow
:  
COLOR_3DDKSHADOW
;

309 
CSSV®ueTh»edçû
:  
COLOR_3DFACE
;

310 
CSSV®ueTh»edhighlight
:  
COLOR_3DHIGHLIGHT
;

311 
CSSV®ueTh»edlightshadow
:  
COLOR_3DLIGHT
;

312 
CSSV®ueTh»edshadow
:  
COLOR_3DSHADOW
;

313 
CSSV®ueWšdow
:  
COLOR_WINDOW
;

314 
CSSV®ueWšdowäame
:  
COLOR_WINDOWFRAME
;

315 
CSSV®ueWšdow‹xt
:  
COLOR_WINDOWTEXT
;

320 
CŞÜ
 
R’d”ThemeWšû
::
	`sy¡emCŞÜ
(
cssV®ueId
) const

322 
sysCŞÜIndex
 = 
	`cssV®ueIdToSysCŞÜIndex
(
cssV®ueId
);

323 ià(
sysCŞÜIndex
 == -1)

324  
R’d”Theme
::
	`sy¡emCŞÜ
(
cssV®ueId
);

326 
COLORREF
 
cŞÜ
 = 
	`G‘SysCŞÜ
(
sysCŞÜIndex
);

327  
	`CŞÜ
(
	`G‘RV®ue
(
cŞÜ
), 
	`G‘GV®ue
(cŞÜ), 
	`G‘BV®ue
(color));

330 cÚ¡ 
¦id”ThumbWidth
 = 7;

331 cÚ¡ 
¦id”ThumbHeight
 = 15;

333 
R’d”ThemeWšû
::
	`adju¡Slid”ThumbSize
(
R’d”Objeù
* 
o
) const

335 ià(
o
->
	`¡yË
()->
	`­³¬ªû
(è=ğ
Slid”ThumbV”tiÿlP¬t
) {

336 
o
->
	`¡yË
()->
	`£tWidth
(
	`L’gth
(
¦id”ThumbHeight
, 
Fixed
));

337 
o
->
	`¡yË
()->
	`£tHeight
(
	`L’gth
(
¦id”ThumbWidth
, 
Fixed
));

338 } ià(
o
->
	`¡yË
()->
	`­³¬ªû
(è=ğ
Slid”ThumbHÜizÚlP¬t
) {

339 
o
->
	`¡yË
()->
	`£tWidth
(
	`L’gth
(
¦id”ThumbWidth
, 
Fixed
));

340 
o
->
	`¡yË
()->
	`£tHeight
(
	`L’gth
(
¦id”ThumbHeight
, 
Fixed
));

345 
R’d”ThemeWšû
::
	`adju¡Bu‰ÚIÂ”StyË
(
R’d”StyË
* 
¡yË
) const

348 
¡yË
->
	`£tPaddšgTİ
(
	`L’gth
(1, 
Fixed
));

349 
¡yË
->
	`£tPaddšgRight
(
	`L’gth
(3, 
Fixed
));

350 
¡yË
->
	`£tPaddšgBÙtom
(
	`L’gth
(1, 
Fixed
));

351 
¡yË
->
	`£tPaddšgLeá
(
	`L’gth
(3, 
Fixed
));

354 
R’d”ThemeWšû
::
	`adju¡S—rchF›ldStyË
(
CSSStyËS–eùÜ
* 
£ËùÜ
, 
R’d”StyË
* 
¡yË
, 
EËm’t
* 
e
) const

357 cÚ¡ 
·ddšg
 = 1;

358 
¡yË
->
	`£tPaddšgLeá
(
	`L’gth
(
·ddšg
, 
Fixed
));

359 
¡yË
->
	`£tPaddšgRight
(
	`L’gth
(
·ddšg
, 
Fixed
));

360 
¡yË
->
	`£tPaddšgTİ
(
	`L’gth
(
·ddšg
, 
Fixed
));

361 
¡yË
->
	`£tPaddšgBÙtom
(
	`L’gth
(
·ddšg
, 
Fixed
));

365 
boŞ
 
R’d”ThemeWšû
::
	`·štS—rchF›ld
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
r
)

367  
	`·štTextF›ld
(
o
, 
i
, 
r
);

370 
boŞ
 
R’d”ThemeWšû
::
	`·štS—rchF›ldCªûlBu‰Ú
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

372 
CŞÜ
 
bu‰ÚCŞÜ
 = (
o
->
	`node
(è&& o->node()->
	`aùive
()è? 
	`CŞÜ
(138, 138, 138) : Color(186, 186, 186);

374 
IÁSize
 
	`ÿnûlSize
(10, 10);

375 
IÁSize
 
	`ÿnûlRadius
(
ÿnûlSize
.
	`width
(è/ 2, cªûlSize.
	`height
() / 2);

376 
x
 = 
r
.
	`x
(è+ (r.
	`width
(è- 
ÿnûlSize
.width()) / 2;

377 
y
 = 
r
.
	`y
(è+ (r.
	`height
(è- 
ÿnûlSize
.height()) / 2 + 1;

378 
IÁReù
 
	`ÿnûlBounds
(
	`IÁPošt
(
x
, 
y
), 
ÿnûlSize
);

379 
·štInfo
.
cÚ‹xt
->
	`§ve
();

380 
·štInfo
.
cÚ‹xt
->
	`addRoundedReùCl
(
ÿnûlBounds
, 
ÿnûlRadius
, cancelRadius, cancelRadius, cancelRadius);

381 
·štInfo
.
cÚ‹xt
->
	`flReù
(
ÿnûlBounds
, 
bu‰ÚCŞÜ
, 
DeviûCŞÜS·û
);

384 
IÁSize
 
	`xSize
(3, 3);

385 
IÁReù
 
	`xBounds
(
ÿnûlBounds
.
	`loÿtiÚ
(è+ 
	`IÁSize
(3, 3), 
xSize
);

386 
·štInfo
.
cÚ‹xt
->
	`£tSŒokeCŞÜ
(
CŞÜ
::
wh™e
, 
DeviûCŞÜS·û
);

387 
·štInfo
.
cÚ‹xt
->
	`d¿wLše
(
xBounds
.
	`loÿtiÚ
(), xBounds.loÿtiÚ(è+ xBounds.
	`size
());

388 
·štInfo
.
cÚ‹xt
->
	`d¿wLše
(
	`IÁPošt
(
xBounds
.
	`right
(), xBounds.
	`y
()), IÁPošt(xBounds.
	`x
(), xBounds.
	`bÙtom
()));

390 
·štInfo
.
cÚ‹xt
->
	`»¡Üe
();

391  
çl£
;

394 
R’d”ThemeWšû
::
	`adju¡S—rchF›ldCªûlBu‰ÚStyË
(
CSSStyËS–eùÜ
* 
£ËùÜ
, 
R’d”StyË
* 
¡yË
, 
EËm’t
* 
e
) const

396 
IÁSize
 
	`ÿnûlSize
(13, 11);

397 
¡yË
->
	`£tWidth
(
	`L’gth
(
ÿnûlSize
.
	`width
(), 
Fixed
));

398 
¡yË
->
	`£tHeight
(
	`L’gth
(
ÿnûlSize
.
	`height
(), 
Fixed
));

401 
R’d”ThemeWšû
::
	`adju¡S—rchF›ldDecÜ©iÚStyË
(
CSSStyËS–eùÜ
* 
£ËùÜ
, 
R’d”StyË
* 
¡yË
, 
EËm’t
* 
e
) const

403 
IÁSize
 
	`em±ySize
(1, 11);

404 
¡yË
->
	`£tWidth
(
	`L’gth
(
em±ySize
.
	`width
(), 
Fixed
));

405 
¡yË
->
	`£tHeight
(
	`L’gth
(
em±ySize
.
	`height
(), 
Fixed
));

408 
R’d”ThemeWšû
::
	`adju¡S—rchF›ldResuÉsDecÜ©iÚStyË
(
CSSStyËS–eùÜ
* 
£ËùÜ
, 
R’d”StyË
* 
¡yË
, 
EËm’t
* 
e
) const

410 
IÁSize
 
	`magnif›rSize
(15, 11);

411 
¡yË
->
	`£tWidth
(
	`L’gth
(
magnif›rSize
.
	`width
(), 
Fixed
));

412 
¡yË
->
	`£tHeight
(
	`L’gth
(
magnif›rSize
.
	`height
(), 
Fixed
));

415 
boŞ
 
R’d”ThemeWšû
::
	`·štS—rchF›ldResuÉsDecÜ©iÚ
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

417 
	`nÙIm¶em’‹d
();

418  
çl£
;

421 
R’d”ThemeWšû
::
	`adju¡S—rchF›ldResuÉsBu‰ÚStyË
(
CSSStyËS–eùÜ
* 
£ËùÜ
, 
R’d”StyË
* 
¡yË
, 
EËm’t
* 
e
) const

423 
IÁSize
 
	`magnif›rSize
(15, 11);

424 
¡yË
->
	`£tWidth
(
	`L’gth
(
magnif›rSize
.
	`width
(), 
Fixed
));

425 
¡yË
->
	`£tHeight
(
	`L’gth
(
magnif›rSize
.
	`height
(), 
Fixed
));

428 
boŞ
 
R’d”ThemeWšû
::
	`·štS—rchF›ldResuÉsBu‰Ú
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

430 
	`·štS—rchF›ldResuÉsDecÜ©iÚ
(
o
, 
·štInfo
, 
r
);

431  
çl£
;

434 
R’d”ThemeWšû
::
	`adju¡M’uLi¡Bu‰ÚStyË
(
CSSStyËS–eùÜ
* 
£ËùÜ
, 
R’d”StyË
* 
¡yË
, 
EËm’t
* 
e
) const

437 cÚ¡ 
drİDownBoxPaddšgTİ
 = 2;

438 cÚ¡ 
drİDownBoxPaddšgRight
 = 
¡yË
->
	`dœeùiÚ
(è=ğ
LTR
 ? 4 + 
drİDownBu‰ÚWidth
 : 4;

439 cÚ¡ 
drİDownBoxPaddšgBÙtom
 = 2;

440 cÚ¡ 
drİDownBoxPaddšgLeá
 = 
¡yË
->
	`dœeùiÚ
(è=ğ
LTR
 ? 4 : 4 + 
drİDownBu‰ÚWidth
;

442 cÚ¡ 
drİDownBoxMšHeight
 = 12;

445 
¡yË
->
	`£tPaddšgTİ
(
	`L’gth
(
drİDownBoxPaddšgTİ
, 
Fixed
));

446 
¡yË
->
	`£tPaddšgRight
(
	`L’gth
(
drİDownBoxPaddšgRight
, 
Fixed
));

447 
¡yË
->
	`£tPaddšgBÙtom
(
	`L’gth
(
drİDownBoxPaddšgBÙtom
, 
Fixed
));

448 
¡yË
->
	`£tPaddšgLeá
(
	`L’gth
(
drİDownBoxPaddšgLeá
, 
Fixed
));

451 
¡yË
->
	`£tHeight
(
	`L’gth
(
Auto
));

454 
mšHeight
 = 
¡yË
->
	`fÚt
().
	`height
();

455 
mšHeight
 = 
	`max
(mšHeight, 
drİDownBoxMšHeight
);

457 
¡yË
->
	`£tMšHeight
(
	`L’gth
(
mšHeight
, 
Fixed
));

460 
¡yË
->
	`£tWh™eS·û
(
PRE
);

462 
DWORD
 
cŞÜM’u
 = 
	`G‘SysCŞÜ
(
COLOR_MENU
);

463 
DWORD
 
cŞÜM’uText
 = 
	`G‘SysCŞÜ
(
COLOR_MENUTEXT
);

464 
CŞÜ
 
	`bgCŞÜ
(
	`G‘RV®ue
(
cŞÜM’u
), 
	`G‘GV®ue
(cŞÜM’u), 
	`G‘BV®ue
(colorMenu), 255);

465 
CŞÜ
 
	`‹xtCŞÜ
(
	`G‘RV®ue
(
cŞÜM’uText
), 
	`G‘GV®ue
(cŞÜM’uText), 
	`G‘BV®ue
(colorMenuText), 255);

466 ià(
bgCŞÜ
 =ğ
‹xtCŞÜ
)

467 
‹xtCŞÜ
.
	`£tRGB
((~
bgCŞÜ
.
	`rgb
()) | 0xFF000000);

468 
¡yË
->
	`ş—rBackgroundLay”s
();

469 
¡yË
->
	`acûssBackgroundLay”s
()->
	`£tCl
(
CÚ‹ÁFlBox
);

470 
¡yË
->
	`£tBackgroundCŞÜ
(
bgCŞÜ
);

471 
¡yË
->
	`£tCŞÜ
(
‹xtCŞÜ
);

474 #ià
	`ENABLE
(
VIDEO
)

476 
HTMLMedŸEËm’t
* 
	`medŸEËm’tP¬’t
(
Node
* 
node
)

478 ià(!
node
)

480 
Node
* 
medŸNode
 = 
node
->
	`shadowAnû¡ÜNode
();

481 ià(!
medŸNode
 || (!medŸNode->
	`hasTagName
(
HTMLNames
::
videoTag
è&& !medŸNode->hasTagName(HTMLNames::
audioTag
)))

484  
¡©ic_ÿ¡
<
HTMLMedŸEËm’t
*>(
medŸNode
);

488 
boŞ
 
R’d”ThemeWšû
::
	`·štSlid”T¿ck
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
r
)

490 
boŞ
 
rc
 = 
R’d”Theme
::
	`·štSlid”T¿ck
(
o
, 
i
, 
r
);

491 
IÁPošt
 
Ëá
 = 
	`IÁPošt
(
r
.
	`x
(è+ 2, (r.
	`y
(è+„.
	`bÙtom
()) / 2);

492 
i
.
cÚ‹xt
->
	`§ve
();

493 
i
.
cÚ‹xt
->
	`£tSŒokeCŞÜ
(
CŞÜ
::
g¿y
, 
DeviûCŞÜS·û
);

494 
i
.
cÚ‹xt
->
	`£tFlCŞÜ
(
CŞÜ
::
g¿y
, 
DeviûCŞÜS·û
);

495 
i
.
cÚ‹xt
->
	`flReù
(
r
);

496 #ià
	`ENABLE
(
VIDEO
)

497 
HTMLMedŸEËm’t
* 
medŸEËm’t
 = 
	`medŸEËm’tP¬’t
(
o
->
	`node
());

498 ià(
medŸEËm’t
) {

499 
i
.
cÚ‹xt
->
	`£tSŒokeCŞÜ
(
	`CŞÜ
(0, 0xff, 0));

500 
IÁPošt
 
right
 = 
	`IÁPošt
(
Ëá
.
	`x
(è+ 
medŸEËm’t
->
	`³rûÁLßded
(è* (
r
.
	`right
(è-„.x(è- 4), (r.
	`y
(è+„.
	`bÙtom
()) / 2);

501 
i
.
cÚ‹xt
->
	`d¿wLše
(
Ëá
, 
right
);

502 
Ëá
 = 
right
;

505 
i
.
cÚ‹xt
->
	`£tSŒokeCŞÜ
(
CŞÜ
::
bÏck
, 
DeviûCŞÜS·û
);

506 
i
.
cÚ‹xt
->
	`d¿wLše
(
Ëá
, 
	`IÁPošt
(
r
.
	`right
(è- 2,†eá.
	`y
()));

507 
i
.
cÚ‹xt
->
	`»¡Üe
();

508  
rc
;

511 
boŞ
 
R’d”ThemeWšû
::
	`·štSlid”Thumb
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
r
)

513 
boŞ
 
rc
 = 
R’d”Theme
::
	`·štSlid”Thumb
(
o
, 
i
, 
r
);

514 
i
.
cÚ‹xt
->
	`§ve
();

515 
i
.
cÚ‹xt
->
	`£tSŒokeCŞÜ
(
CŞÜ
::
bÏck
, 
DeviûCŞÜS·û
);

516 
i
.
cÚ‹xt
->
	`£tFlCŞÜ
(
CŞÜ
::
bÏck
, 
DeviûCŞÜS·û
);

517 #ià
	`ENABLE
(
VIDEO
)

518 
HTMLMedŸEËm’t
* 
medŸEËm’t
 = 
	`medŸEËm’tP¬’t
(
o
->
	`node
());

519 ià(
medŸEËm’t
) {

520 
±
 = (
medŸEËm’t
->
	`cu¼’tTime
(è- medŸEËm’t->
	`¡¬tTime
()è/ medŸEËm’t->
	`du¿tiÚ
();

521 
FlßtReù
 
štReù
 = 
r
;

522 
štReù
.
	`£tX
(štReù.
	`x
(è+ iÁReù.
	`width
(è* 
±
 - 2);

523 
štReù
.
	`£tWidth
(5);

524 
i
.
cÚ‹xt
->
	`flReù
(
štReù
);

527 
i
.
cÚ‹xt
->
	`»¡Üe
();

528  
rc
;

531 
R’d”ThemeWšû
::
	`bu‰ÚIÁ”ÇlPaddšgLeá
() const

536 
R’d”ThemeWšû
::
	`bu‰ÚIÁ”ÇlPaddšgRight
() const

541 
R’d”ThemeWšû
::
	`bu‰ÚIÁ”ÇlPaddšgTİ
() const

546 
R’d”ThemeWšû
::
	`bu‰ÚIÁ”ÇlPaddšgBÙtom
() const

551 
R’d”ThemeWšû
::
	`adju¡S—rchF›ldStyË
(
CSSStyËS–eùÜ
* 
£ËùÜ
, 
R’d”StyË
* 
¡yË
, 
EËm’t
* 
e
) const

553 cÚ¡ 
·ddšg
 = 1;

554 
¡yË
->
	`£tPaddšgLeá
(
	`L’gth
(
·ddšg
, 
Fixed
));

555 
¡yË
->
	`£tPaddšgRight
(
	`L’gth
(
·ddšg
, 
Fixed
));

556 
¡yË
->
	`£tPaddšgTİ
(
	`L’gth
(
·ddšg
, 
Fixed
));

557 
¡yË
->
	`£tPaddšgBÙtom
(
	`L’gth
(
·ddšg
, 
Fixed
));

560 #ià
	`ENABLE
(
VIDEO
)

562 
boŞ
 
R’d”ThemeWšû
::
	`·štMedŸFuÎsü“nBu‰Ú
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

564 
boŞ
 
rc
 = 
	`·štBu‰Ú
(
o
, 
·štInfo
, 
r
);

565 
FlßtReù
 
imReù
 = 
r
;

566 
imReù
.
	`šæ©e
(-2);

567 
·štInfo
.
cÚ‹xt
->
	`§ve
();

568 
·štInfo
.
cÚ‹xt
->
	`£tSŒokeCŞÜ
(
CŞÜ
::
bÏck
);

569 
·štInfo
.
cÚ‹xt
->
	`£tFlCŞÜ
(
CŞÜ
::
g¿y
);

570 
·štInfo
.
cÚ‹xt
->
	`flReù
(
imReù
);

571 
·štInfo
.
cÚ‹xt
->
	`»¡Üe
();

572  
rc
;

575 
boŞ
 
R’d”ThemeWšû
::
	`·štMedŸMu‹Bu‰Ú
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

577 
boŞ
 
rc
 = 
	`·štBu‰Ú
(
o
, 
·štInfo
, 
r
);

578 
HTMLMedŸEËm’t
* 
medŸEËm’t
 = 
	`medŸEËm’tP¬’t
(
o
->
	`node
());

579 
boŞ
 
mu‹d
 = !
medŸEËm’t
 || medŸEËm’t->
	`mu‹d
();

580 
FlßtReù
 
imReù
 = 
r
;

581 
imReù
.
	`šæ©e
(-2);

582 
·štInfo
.
cÚ‹xt
->
	`§ve
();

583 
·štInfo
.
cÚ‹xt
->
	`£tSŒokeCŞÜ
(
CŞÜ
::
bÏck
);

584 
·štInfo
.
cÚ‹xt
->
	`£tFlCŞÜ
(
CŞÜ
::
bÏck
);

585 
FlßtPošt
 
±s
[6] = {

586 
	`FlßtPošt
(
imReù
.
	`x
(è+ 1, imReù.
	`y
(è+ imReù.
	`height
() / 3.0),

587 
	`FlßtPošt
(
imReù
.
	`x
(è+ 1 + imReù.
	`width
(è/ 2.0, imReù.
	`y
(è+ imReù.
	`height
() / 3.0),

588 
	`FlßtPošt
(
imReù
.
	`right
(è- 1, imReù.
	`y
()),

589 
	`FlßtPošt
(
imReù
.
	`right
(è- 1, imReù.
	`bÙtom
()),

590 
	`FlßtPošt
(
imReù
.
	`x
(è+ 1 + imReù.
	`width
(è/ 2.0, imReù.
	`y
(è+ 2.0 * imReù.
	`height
() / 3.0),

591 
	`FlßtPošt
(
imReù
.
	`x
(è+ 1, imReù.
	`y
(è+ 2.0 * imReù.
	`height
() / 3.0)

593 
·štInfo
.
cÚ‹xt
->
	`d¿wCÚvexPŞygÚ
(6, 
±s
);

594 ià(
mu‹d
)

595 
·štInfo
.
cÚ‹xt
->
	`d¿wLše
(
	`IÁPošt
(
imReù
.
	`right
(), imReù.
	`y
()), IÁPošt(imReù.
	`x
(), imReù.
	`bÙtom
()));

596 
·štInfo
.
cÚ‹xt
->
	`»¡Üe
();

597  
rc
;

600 
boŞ
 
R’d”ThemeWšû
::
	`·štMedŸPÏyBu‰Ú
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

602 
boŞ
 
rc
 = 
	`·štBu‰Ú
(
o
, 
·štInfo
, 
r
);

603 
FlßtReù
 
imReù
 = 
r
;

604 
imReù
.
	`šæ©e
(-3);

605 
·štInfo
.
cÚ‹xt
->
	`§ve
();

606 
·štInfo
.
cÚ‹xt
->
	`£tSŒokeCŞÜ
(
CŞÜ
::
bÏck
);

607 
·štInfo
.
cÚ‹xt
->
	`£tFlCŞÜ
(
CŞÜ
::
bÏck
);

608 
HTMLMedŸEËm’t
* 
medŸEËm’t
 = 
	`medŸEËm’tP¬’t
(
o
->
	`node
());

609 
boŞ
 
·u£d
 = !
medŸEËm’t
 || medŸEËm’t->
	`·u£d
();

610 ià(
·u£d
) {

611 
width
 = 
imReù
.
	`width
();

612 
imReù
.
	`£tWidth
(
width
 / 3.0);

613 
·štInfo
.
cÚ‹xt
->
	`flReù
(
imReù
);

614 
imReù
.
	`move
(2.0 * 
width
 / 3.0, 0);

615 
·štInfo
.
cÚ‹xt
->
	`flReù
(
imReù
);

617 
FlßtPošt
 
±s
[3] = { 
	`FlßtPošt
(
imReù
.
	`x
(), imReù.
	`y
()), FlßtPošt(imReù.
	`right
(), (imReù.y(è+ imReù.
	`bÙtom
()) / 2.0), FloatPoint(imRect.x(), imRect.bottom()) };

618 
·štInfo
.
cÚ‹xt
->
	`d¿wCÚvexPŞygÚ
(3, 
±s
);

620 
·štInfo
.
cÚ‹xt
->
	`»¡Üe
();

621  
rc
;

624 
boŞ
 
R’d”ThemeWšû
::
	`·štMedŸS“kBackBu‰Ú
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

626 
boŞ
 
rc
 = 
	`·štBu‰Ú
(
o
, 
·štInfo
, 
r
);

627 
FlßtReù
 
imReù
 = 
r
;

628 
imReù
.
	`šæ©e
(-3);

629 
FlßtPošt
 
±s
[3] = { 
	`FlßtPošt
((
imReù
.
	`x
(è+ imReù.
	`right
()è/ 2.0, imReù.
	`y
()), FlßtPošt(imReù.x(), (imReù.y(è+ imReù.
	`bÙtom
()) / 2.0), FloatPoint((imRect.x() + imRect.right()) / 2.0, imRect.bottom()) };

630 
FlßtPošt
 
±s2
[3] = { 
	`FlßtPošt
(
imReù
.
	`right
(), imReù.
	`y
()), FlßtPošt((imReù.
	`x
(è+ imReù.right()è/ 2.0, (imReù.y(è+ imReù.
	`bÙtom
()) / 2.0), FloatPoint(imRect.right(), imRect.bottom()) };

631 
·štInfo
.
cÚ‹xt
->
	`§ve
();

632 
·štInfo
.
cÚ‹xt
->
	`£tSŒokeCŞÜ
(
CŞÜ
::
bÏck
);

633 
·štInfo
.
cÚ‹xt
->
	`£tFlCŞÜ
(
CŞÜ
::
bÏck
);

634 
·štInfo
.
cÚ‹xt
->
	`d¿wCÚvexPŞygÚ
(3, 
±s
);

635 
·štInfo
.
cÚ‹xt
->
	`d¿wCÚvexPŞygÚ
(3, 
±s2
);

636 
·štInfo
.
cÚ‹xt
->
	`»¡Üe
();

637  
rc
;

640 
boŞ
 
R’d”ThemeWšû
::
	`·štMedŸS“kFÜw¬dBu‰Ú
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

642 
boŞ
 
rc
 = 
	`·štBu‰Ú
(
o
, 
·štInfo
, 
r
);

643 
FlßtReù
 
imReù
 = 
r
;

644 
imReù
.
	`šæ©e
(-3);

645 
FlßtPošt
 
±s
[3] = { 
	`FlßtPošt
(
imReù
.
	`x
(), imReù.
	`y
()), FlßtPošt((imReù.x(è+ imReù.
	`right
()è/ 2.0, (imReù.y(è+ imReù.
	`bÙtom
()) / 2.0), FloatPoint(imRect.x(), imRect.bottom()) };

646 
FlßtPošt
 
±s2
[3] = { 
	`FlßtPošt
((
imReù
.
	`x
(è+ imReù.
	`right
()è/ 2.0, imReù.
	`y
()), FlßtPošt(imReù.right(), (imReù.y(è+ imReù.
	`bÙtom
()) / 2.0), FloatPoint((imRect.x() + imRect.right()) / 2.0, imRect.bottom()) };

647 
·štInfo
.
cÚ‹xt
->
	`§ve
();

648 
·štInfo
.
cÚ‹xt
->
	`£tSŒokeCŞÜ
(
CŞÜ
::
bÏck
);

649 
·štInfo
.
cÚ‹xt
->
	`£tFlCŞÜ
(
CŞÜ
::
bÏck
);

650 
·štInfo
.
cÚ‹xt
->
	`d¿wCÚvexPŞygÚ
(3, 
±s
);

651 
·štInfo
.
cÚ‹xt
->
	`d¿wCÚvexPŞygÚ
(3, 
±s2
);

652 
·štInfo
.
cÚ‹xt
->
	`»¡Üe
();

653  
rc
;

656 
boŞ
 
R’d”ThemeWšû
::
	`·štMedŸSlid”T¿ck
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

658  
	`·štSlid”T¿ck
(
o
, 
·štInfo
, 
r
);

661 
boŞ
 
R’d”ThemeWšû
::
	`·štMedŸSlid”Thumb
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
IÁReù
& 
r
)

663  
	`·štSlid”Thumb
(
o
, 
·štInfo
, 
r
);

667 
	}
}

	@RenderThemeWince.h

24 #iâdeà
R’d”ThemeWšû_h


25 
	#R’d”ThemeWšû_h


	)

27 
	~"R’d”Theme.h
"

29 * 
	tHANDLE
;

30 
HINSTANCE__
* 
	tHINSTANCE
;

31 
HINSTANCE
 
	tHMODULE
;

33 
Çme¥aû
 
	gWebCÜe
 {

35 
	sThemeD©a
 {

36 
ThemeD©a
(è:
m_·¹
(0), 
m_¡©e
(0), 
m_şassicS‹
(0) {}

37 
ThemeD©a
(
·¹
, 
¡©e
)

38 : 
m_·¹
(
·¹
)

39 , 
m_¡©e
(
¡©e
)

40 , 
m_şassicS‹
(0)

43 
	gm_·¹
;

44 
	gm_¡©e
;

45 
	gm_şassicS‹
;

48 şas 
	cR’d”ThemeWšû
 : 
public
 
R’d”Theme
 {

49 
public
:

50 
PassRefPŒ
<
R’d”Theme
> 
ü—‹
();

51 ~
R’d”ThemeWšû
();

53 
vœtu®
 
SŒšg
 
exŒaDeçuÉStyËSh“t
();

54 
vœtu®
 
SŒšg
 
exŒaQuœksStyËSh“t
();

57 
vœtu®
 
boŞ
 
suµÜtsHov”
(cÚ¡ 
R’d”StyË
*) const;

59 
vœtu®
 
CŞÜ
 
¶©fÜmAùiveS–eùiÚBackgroundCŞÜ
() const;

60 
vœtu®
 
CŞÜ
 
¶©fÜmIÇùiveS–eùiÚBackgroundCŞÜ
() const;

61 
vœtu®
 
CŞÜ
 
¶©fÜmAùiveS–eùiÚFÜegroundCŞÜ
() const;

62 
vœtu®
 
CŞÜ
 
¶©fÜmIÇùiveS–eùiÚFÜegroundCŞÜ
() const;

65 
vœtu®
 
sy¡emFÚt
(
´İId
, 
FÚtDesütiÚ
&) const;

66 
vœtu®
 
CŞÜ
 
sy¡emCŞÜ
(
cssV®ueId
) const;

68 
vœtu®
 
boŞ
 
·štCheckbox
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
r
)

69 {  
·štBu‰Ú
(
o
, 
i
, 
r
); }

70 
vœtu®
 
£tCheckboxSize
(
R’d”StyË
*) const;

72 
vœtu®
 
boŞ
 
·štRadio
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
r
)

73 {  
·štBu‰Ú
(
o
, 
i
, 
r
); }

74 
vœtu®
 
£tRadioSize
(
R’d”StyË
* 
¡yË
) const

75 {  
£tCheckboxSize
(
¡yË
); }

77 
vœtu®
 
boŞ
 
·štBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

79 
vœtu®
 
boŞ
 
·štTextF›ld
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

81 
vœtu®
 
boŞ
 
·štTextA»a
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
r
)

82 {  
·štTextF›ld
(
o
, 
i
, 
r
); }

84 
vœtu®
 
adju¡M’uLi¡StyË
(
CSSStyËS–eùÜ
* 
£ËùÜ
, 
R’d”StyË
* 
¡yË
, 
EËm’t
* 
e
) const;

85 
vœtu®
 
boŞ
 
·štM’uLi¡
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

86 
vœtu®
 
adju¡M’uLi¡Bu‰ÚStyË
(
CSSStyËS–eùÜ
* 
£ËùÜ
, 
R’d”StyË
* 
¡yË
, 
EËm’t
* 
e
) const;

88 
vœtu®
 
boŞ
 
·štM’uLi¡Bu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

90 
vœtu®
 
boŞ
 
·štSlid”T¿ck
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
r
);

91 
vœtu®
 
boŞ
 
·štSlid”Thumb
(
R’d”Objeù
* 
o
, cÚ¡ R’d”Objeù::
PaštInfo
& 
i
, cÚ¡ 
IÁReù
& 
r
);

92 
vœtu®
 
adju¡Slid”ThumbSize
(
R’d”Objeù
*) const;

94 
vœtu®
 
boŞ
 
pİupO±iÚSuµÜtsTextInd’t
(ècÚ¡ {  
	gŒue
; }

96 
vœtu®
 
bu‰ÚIÁ”ÇlPaddšgLeá
() const;

97 
vœtu®
 
bu‰ÚIÁ”ÇlPaddšgRight
() const;

98 
vœtu®
 
bu‰ÚIÁ”ÇlPaddšgTİ
() const;

99 
vœtu®
 
bu‰ÚIÁ”ÇlPaddšgBÙtom
() const;

101 
vœtu®
 
adju¡S—rchF›ldStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

102 
vœtu®
 
boŞ
 
·štS—rchF›ld
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

104 
vœtu®
 
adju¡S—rchF›ldCªûlBu‰ÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

105 
vœtu®
 
boŞ
 
·štS—rchF›ldCªûlBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

107 
vœtu®
 
adju¡S—rchF›ldDecÜ©iÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

108 
vœtu®
 
boŞ
 
·štS—rchF›ldDecÜ©iÚ
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&è{  
	gçl£
; }

110 
vœtu®
 
adju¡S—rchF›ldResuÉsDecÜ©iÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

111 
vœtu®
 
boŞ
 
·štS—rchF›ldResuÉsDecÜ©iÚ
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

113 
vœtu®
 
adju¡S—rchF›ldResuÉsBu‰ÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
*, 
EËm’t
*) const;

114 
vœtu®
 
boŞ
 
·štS—rchF›ldResuÉsBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

116 
vœtu®
 
themeChªged
();

118 
vœtu®
 
adju¡Bu‰ÚStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
* 
¡yË
, 
EËm’t
*) const {}

119 
vœtu®
 
adju¡TextF›ldStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
* 
¡yË
, 
EËm’t
*) const {}

120 
vœtu®
 
adju¡TextA»aStyË
(
CSSStyËS–eùÜ
*, 
R’d”StyË
* 
¡yË
, 
EËm’t
*) const {}

122 
£tWebK™IsBešgUÆßded
();

124 
vœtu®
 
boŞ
 
suµÜtsFocusRšg
(cÚ¡ 
R’d”StyË
*) const;

126 #ià
ENABLE
(
VIDEO
)

127 
vœtu®
 
boŞ
 
·štMedŸFuÎsü“nBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

128 
vœtu®
 
boŞ
 
·štMedŸPÏyBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

129 
vœtu®
 
boŞ
 
·štMedŸMu‹Bu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

130 
vœtu®
 
boŞ
 
·štMedŸS“kBackBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

131 
vœtu®
 
boŞ
 
·štMedŸS“kFÜw¬dBu‰Ú
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

132 
vœtu®
 
boŞ
 
·štMedŸSlid”T¿ck
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

133 
vœtu®
 
boŞ
 
·štMedŸSlid”Thumb
(
R’d”Objeù
*, cÚ¡ R’d”Objeù::
PaštInfo
&, cÚ¡ 
IÁReù
&);

136 
	g´iv©e
:

137 
R’d”ThemeWšû
();

139 
d‘”mšeCÏssicS‹
(
R’d”Objeù
*);

140 
boŞ
 
suµÜtsFocus
(
CÚŒŞP¬t
) const;

142 
ThemeD©a
 
g‘ThemeD©a
(
R’d”Objeù
*);

	@RenderTreeAsText.cpp

26 
	~"cÚfig.h
"

27 
	~"R’d”T»eAsText.h
"

29 
	~"CSSMubËStyËDeş¬©iÚ.h
"

30 
	~"Ch¬aù”Names.h
"

31 
	~"Docum’t.h
"

32 
	~"F¿me.h
"

33 
	~"F¿meV›w.h
"

34 
	~"HTMLEËm’t.h
"

35 
	~"HTMLNames.h
"

36 
	~"IÆšeTextBox.h
"

37 
	~"R’d”BR.h
"

38 
	~"R’d”FeU¶ßdCÚŒŞ.h
"

39 
	~"R’d”IÆše.h
"

40 
	~"R’d”Li¡M¬k”.h
"

41 
	~"R’d”P¬t.h
"

42 
	~"R’d”TabËC–l.h
"

43 
	~"R’d”V›w.h
"

44 
	~"R’d”Widg‘.h
"

45 
	~"S–eùiÚCÚŒŞËr.h
"

46 
	~"TextSŒ—m.h
"

47 
	~<wtf/Unu£dP¬am.h
>

48 
	~<wtf/VeùÜ.h
>

50 #ià
ENABLE
(
SVG
)

51 
	~"R’d”P©h.h
"

52 
	~"R’d”SVGCÚš”.h
"

53 
	~"R’d”SVGImage.h
"

54 
	~"R’d”SVGIÆšeText.h
"

55 
	~"R’d”SVGRoÙ.h
"

56 
	~"R’d”SVGText.h
"

57 
	~"SVGR’d”T»eAsText.h
"

60 #ià
USE
(
ACCELERATED_COMPOSITING
)

61 
	~"R’d”Lay”Backšg.h
"

64 #ià
PLATFORM
(
QT
)

65 
	~<QWidg‘
>

68 
Çme¥aû
 
	gWebCÜe
 {

70 
usšg
 
Çme¥aû
 
	gHTMLNames
;

72 
wr™eLay”s
(
TextSŒ—m
&, cÚ¡ 
R’d”Lay”
* 
roÙLay”
, R’d”Lay”*, cÚ¡ 
IÁReù
& 
·štDœtyReù
, 
šd’t
 = 0, 
R’d”AsTextBehaviÜ
 
behaviÜ
 = 
R’d”AsTextBehaviÜNÜm®
);

74 #ià!
ENABLE
(
SVG
)

75 
	gTextSŒ—m
 &
	gİ”©Ü
<<(TextSŒ—m& 
	gts
, cÚ¡ 
	gIÁReù
& 
	gr
)

77  
	gts
 << "© (" << 
	gr
.
x
(è<< "," <<„.
y
(è<< "èsiz" <<„.
width
(è<< "x" <<„.
height
();

81 
wr™eInd’t
(
TextSŒ—m
& 
ts
, 
šd’t
)

83 
	gi
 = 0; i !ğ
šd’t
; ++i)

84 
	gts
 << " ";

87 
´štBÜd”StyË
(
TextSŒ—m
& 
ts
, cÚ¡ 
EBÜd”StyË
 
bÜd”StyË
)

89 
	gbÜd”StyË
) {

90 
	gBNONE
:

91 
ts
 << "none";

93 
	gBHIDDEN
:

94 
ts
 << "hidden";

96 
	gINSET
:

97 
ts
 << "inset";

99 
	gGROOVE
:

100 
ts
 << "groove";

102 
	gRIDGE
:

103 
ts
 << "ridge";

105 
	gOUTSET
:

106 
ts
 << "outset";

108 
	gDOTTED
:

109 
ts
 << "dotted";

111 
	gDASHED
:

112 
ts
 << "dashed";

114 
	gSOLID
:

115 
ts
 << "solid";

117 
	gDOUBLE
:

118 
ts
 << "double";

122 
	gts
 << " ";

125 
SŒšg
 
g‘TagName
(
Node
* 
n
)

127 ià(
	gn
->
isDocum’tNode
())

129 ià(
	gn
->
isComm’tNode
())

131  
	gn
->
nodeName
();

134 
boŞ
 
isEm±yOrUn¡yËdAµËStyËS·n
(cÚ¡ 
Node
* 
node
)

136 ià(!
	gnode
 || !node->
isHTMLEËm’t
(è|| !node->
hasTagName
(
¥ªTag
))

137  
	gçl£
;

139 cÚ¡ 
HTMLEËm’t
* 
	g–em
 = 
¡©ic_ÿ¡
<cÚ¡ HTMLEËm’t*>(
node
);

140 ià(
	g–em
->
g‘A‰ribu‹
(
şassA‰r
) != "Apple-style-span")

141  
çl£
;

143 ià(!
	gnode
->
hasChdNodes
())

144  
	gŒue
;

146 
CSSMubËStyËDeş¬©iÚ
* 
	gšlšeStyËDeş
 = 
–em
->
šlšeStyËDeş
();

147  (!
	gšlšeStyËDeş
 || iÆšeStyËDeş->
Ëngth
() == 0);

150 
SŒšg
 
quÙeAndEsÿ³NÚPršbËs
(cÚ¡ SŒšg& 
s
)

152 
	gVeùÜ
<
	gUCh¬
> 
	g»suÉ
;

153 
	g»suÉ
.
­³nd
('"');

154 
	gi
 = 0; i !ğ
s
.
Ëngth
(); ++i) {

155 
UCh¬
 
	gc
 = 
s
[
i
];

156 ià(
	gc
 == '\\') {

157 
»suÉ
.
­³nd
('\\');

158 
	g»suÉ
.
­³nd
('\\');

159 } ià(
	gc
 == '"') {

160 
»suÉ
.
­³nd
('\\');

161 
	g»suÉ
.
­³nd
('"');

162 } ià(
	gc
 =ğ'\n' || 
c
 =ğ
noB»akS·û
)

163 
»suÉ
.
­³nd
(' ');

165 ià(
	gc
 >ğ0x20 && 
c
 < 0x7F)

166 
»suÉ
.
­³nd
(
c
);

168 
	gu
 = 
c
;

169 
SŒšg
 
	ghex
 = SŒšg::
fÜm©
("\\x{%X}", 
u
);

170 
	gËn
 = 
hex
.
Ëngth
();

171 
	gi
 = 0; i < 
	gËn
; ++i)

172 
	g»suÉ
.
­³nd
(
hex
[
i
]);

176 
	g»suÉ
.
­³nd
('"');

177  
	gSŒšg
::
adİt
(
»suÉ
);

180 
wr™eR’d”Objeù
(
TextSŒ—m
& 
ts
, cÚ¡ 
R’d”Objeù
& 
o
, 
R’d”AsTextBehaviÜ
 
behaviÜ
)

182 
	gts
 << 
	go
.
»nd”Name
();

184 ià(
	gbehaviÜ
 & 
	gR’d”AsTextShowAdd»s£s
)

185 
	gts
 << " " << &
	go
;

187 ià(
	go
.
¡yË
(è&& o.¡yË()->
zIndex
())

188 
	gts
 << " zI: " << 
	go
.
¡yË
()->
zIndex
();

190 ià(
	go
.
node
()) {

191 
SŒšg
 
	ggName
 = 
g‘TagName
(
o
.
node
());

192 ià(!
	ggName
.
isEm±y
()) {

193 
	gts
 << " {" << 
	ggName
 << "}";

196 ià(
isEm±yOrUn¡yËdAµËStyËS·n
(
o
.
node
()))

197 
	gts
 << " *empty or unstyled AppleStyleSpan*";

201 
boŞ
 
	gadju¡FÜTabËC–ls
 = 
o
.
cÚššgBlock
()->
isTabËC–l
();

203 
IÁReù
 
	gr
;

204 ià(
	go
.
isText
()) {

207 cÚ¡ 
	gR’d”Text
& 
	g‹xt
 = *
toR’d”Text
(&
o
);

208 
IÁReù
 
	glšesBox
 = 
‹xt
.
lšesBoundšgBox
();

209 
	gr
 = 
IÁReù
(
‹xt
.
fœ¡RunX
(),ext.
fœ¡RunY
(), 
lšesBox
.
width
(),†šesBox.
height
());

210 ià(
	gadju¡FÜTabËC–ls
 && !
	g‹xt
.
fœ¡TextBox
())

211 
	gadju¡FÜTabËC–ls
 = 
çl£
;

212 } ià(
	go
.
isR’d”IÆše
()) {

214 cÚ¡ 
	gR’d”IÆše
& 
	gšlšeFlow
 = *
toR’d”IÆše
(&
o
);

215 
	gr
 = 
IÁReù
(0, 0, 
šlšeFlow
.
lšesBoundšgBox
().
width
(), iÆšeFlow.lšesBoundšgBox().
height
());

216 
	gadju¡FÜTabËC–ls
 = 
çl£
;

217 } ià(
	go
.
isTabËC–l
()) {

221 cÚ¡ 
	gR’d”TabËC–l
& 
	gûÎ
 = *
toR’d”TabËC–l
(&
o
);

222 
	gr
 = 
IÁReù
(
ûÎ
.
x
(), c–l.
y
(è+ c–l.
šŒšsicPaddšgTİ
(), c–l.
width
(), c–l.
height
(è- c–l.šŒšsicPaddšgTİ(è- c–l.
šŒšsicPaddšgBÙtom
());

223 } ià(
	go
.
isBox
())

224 
	gr
 = 
toR’d”Box
(&
o
)->
äameReù
();

227 ià(
	gadju¡FÜTabËC–ls
)

228 
	gr
.
move
(0, -
toR’d”TabËC–l
(
o
.
cÚššgBlock
())->
šŒšsicPaddšgTİ
());

230 
	gts
 << " " << 
	gr
;

232 ià(!(
	go
.
isText
(è&& !o.
isBR
())) {

233 ià(
	go
.
isFeU¶ßdCÚŒŞ
()) {

234 
	gts
 << " " << 
quÙeAndEsÿ³NÚPršbËs
(
toR’d”FeU¶ßdCÚŒŞ
(&
o
)->
feTextV®ue
());

236 ià(
	go
.
·»Á
(è&& (o.·»Á()->
¡yË
()->
cŞÜ
(è!ğ
o
.style()->color()))

237 
ts
 << " [cŞÜ=" << 
o
.
¡yË
()->
cŞÜ
().
Çme
() << "]";

239 ià(
	go
.
·»Á
(è&& (o.·»Á()->
¡yË
()->
backgroundCŞÜ
(è!ğ
o
.style()->backgroundColor()) &&

240 
o
.
¡yË
()->
backgroundCŞÜ
().
isV®id
(è&& o.¡yË()->backgroundCŞÜ().
rgb
())

242 
ts
 << " [bgcŞÜ=" << 
o
.
¡yË
()->
backgroundCŞÜ
().
Çme
() << "]";

244 ià(
	go
.
·»Á
(è&& (o.·»Á()->
¡yË
()->
‹xtFlCŞÜ
(è!ğ
o
.style()->textFillColor()) &&

245 
o
.
¡yË
()->
‹xtFlCŞÜ
().
isV®id
(è&& o.¡yË()->‹xtFlCŞÜ(è!ğo.¡yË()->
cŞÜ
() &&

246 
o
.
¡yË
()->
‹xtFlCŞÜ
().
rgb
())

247 
ts
 << " [‹xtFlCŞÜ=" << 
o
.
¡yË
()->
‹xtFlCŞÜ
().
Çme
() << "]";

249 ià(
	go
.
·»Á
(è&& (o.·»Á()->
¡yË
()->
‹xtSŒokeCŞÜ
(è!ğ
o
.style()->textStrokeColor()) &&

250 
o
.
¡yË
()->
‹xtSŒokeCŞÜ
().
isV®id
(è&& o.¡yË()->‹xtSŒokeCŞÜ(è!ğo.¡yË()->
cŞÜ
() &&

251 
o
.
¡yË
()->
‹xtSŒokeCŞÜ
().
rgb
())

252 
ts
 << " [‹xtSŒokeCŞÜ=" << 
o
.
¡yË
()->
‹xtSŒokeCŞÜ
().
Çme
() << "]";

254 ià(
	go
.
·»Á
(è&& (o.·»Á()->
¡yË
()->
‹xtSŒokeWidth
(è!ğ
o
.style()->textStrokeWidth()) &&

255 
o
.
¡yË
()->
‹xtSŒokeWidth
() > 0)

256 
ts
 << " [‹xtSŒokeWidth=" << 
o
.
¡yË
()->
‹xtSŒokeWidth
() << "]";

258 ià(!
	go
.
isBoxMod–Objeù
())

261 cÚ¡ 
	gR’d”BoxMod–Objeù
& 
	gbox
 = *
toR’d”BoxMod–Objeù
(&
o
);

262 ià(
	gbox
.
bÜd”Tİ
(è|| box.
bÜd”Right
(è|| box.
bÜd”BÙtom
(è|| box.
bÜd”Leá
()) {

263 
	gts
 << " [border:";

265 
BÜd”V®ue
 
	g´evBÜd”
;

266 ià(
	go
.
¡yË
()->
bÜd”Tİ
(è!ğ
´evBÜd”
) {

267 
´evBÜd”
 = 
o
.
¡yË
()->
bÜd”Tİ
();

268 ià(!
	gbox
.
bÜd”Tİ
())

269 
	gts
 << "‚one";

271 
	gts
 << " (" << 
	gbox
.
bÜd”Tİ
() << "px ";

272 
´štBÜd”StyË
(
ts
, 
o
.
¡yË
()->
bÜd”TİStyË
());

273 
CŞÜ
 
	gcŞ
 = 
o
.
¡yË
()->
bÜd”TİCŞÜ
();

274 ià(!
	gcŞ
.
isV®id
())

275 
	gcŞ
 = 
o
.
¡yË
()->
cŞÜ
();

276 
	gts
 << 
	gcŞ
.
Çme
() << ")";

280 ià(
	go
.
¡yË
()->
bÜd”Right
(è!ğ
´evBÜd”
) {

281 
´evBÜd”
 = 
o
.
¡yË
()->
bÜd”Right
();

282 ià(!
	gbox
.
bÜd”Right
())

283 
	gts
 << "‚one";

285 
	gts
 << " (" << 
	gbox
.
bÜd”Right
() << "px ";

286 
´štBÜd”StyË
(
ts
, 
o
.
¡yË
()->
bÜd”RightStyË
());

287 
CŞÜ
 
	gcŞ
 = 
o
.
¡yË
()->
bÜd”RightCŞÜ
();

288 ià(!
	gcŞ
.
isV®id
())

289 
	gcŞ
 = 
o
.
¡yË
()->
cŞÜ
();

290 
	gts
 << 
	gcŞ
.
Çme
() << ")";

294 ià(
	go
.
¡yË
()->
bÜd”BÙtom
(è!ğ
´evBÜd”
) {

295 
´evBÜd”
 = 
box
.
¡yË
()->
bÜd”BÙtom
();

296 ià(!
	gbox
.
bÜd”BÙtom
())

297 
	gts
 << "‚one";

299 
	gts
 << " (" << 
	gbox
.
bÜd”BÙtom
() << "px ";

300 
´štBÜd”StyË
(
ts
, 
o
.
¡yË
()->
bÜd”BÙtomStyË
());

301 
CŞÜ
 
	gcŞ
 = 
o
.
¡yË
()->
bÜd”BÙtomCŞÜ
();

302 ià(!
	gcŞ
.
isV®id
())

303 
	gcŞ
 = 
o
.
¡yË
()->
cŞÜ
();

304 
	gts
 << 
	gcŞ
.
Çme
() << ")";

308 ià(
	go
.
¡yË
()->
bÜd”Leá
(è!ğ
´evBÜd”
) {

309 
´evBÜd”
 = 
o
.
¡yË
()->
bÜd”Leá
();

310 ià(!
	gbox
.
bÜd”Leá
())

311 
	gts
 << "‚one";

313 
	gts
 << " (" << 
	gbox
.
bÜd”Leá
() << "px ";

314 
´štBÜd”StyË
(
ts
, 
o
.
¡yË
()->
bÜd”LeáStyË
());

315 
CŞÜ
 
	gcŞ
 = 
o
.
¡yË
()->
bÜd”LeáCŞÜ
();

316 ià(!
	gcŞ
.
isV®id
())

317 
	gcŞ
 = 
o
.
¡yË
()->
cŞÜ
();

318 
	gts
 << 
	gcŞ
.
Çme
() << ")";

322 
	gts
 << "]";

326 ià(
	go
.
isTabËC–l
()) {

327 cÚ¡ 
	gR’d”TabËC–l
& 
	gc
 = *
toR’d”TabËC–l
(&
o
);

328 
	gts
 << " [r=" << 
	gc
.
row
(è<< " c=" << c.
cŞ
(è<< "„s=" << c.
rowS·n
(è<< " cs=" << c.
cŞS·n
() << "]";

331 ià(
	go
.
isLi¡M¬k”
()) {

332 
SŒšg
 
	g‹xt
 = 
toR’d”Li¡M¬k”
(&
o
)->
‹xt
();

333 ià(!
	g‹xt
.
isEm±y
()) {

334 ià(
	g‹xt
.
Ëngth
() != 1)

335 
‹xt
 = 
quÙeAndEsÿ³NÚPršbËs
(text);

337 
	g‹xt
[0]) {

338 
	gbuÎ‘
:

339 
‹xt
 = "bullet";

341 
	gbÏckSqu¬e
:

342 
‹xt
 = "black square";

344 
	gwh™eBuÎ‘
:

345 
‹xt
 = "white bullet";

348 
‹xt
 = 
quÙeAndEsÿ³NÚPršbËs
(text);

351 
	gts
 << ": " << 
	g‹xt
;

355 #ià
PLATFORM
(
QT
)

358 ià(
	go
.
isR’d”P¬t
()) {

359 cÚ¡ 
R’d”P¬t
* 
	g·¹
 = 
toR’d”P¬t
(
cÚ¡_ÿ¡
<
R’d”Objeù
*>(&
o
));

360 ià(
	g·¹
->
widg‘
(è&&…¬t->widg‘()->
¶©fÜmWidg‘
()) {

361 
QWidg‘
* 
	gwid
 = 
·¹
->
widg‘
()->
¶©fÜmWidg‘
();

363 
	gts
 << " [QT: ";

364 
	gts
 << "geom‘ry: {" << 
	gwid
->
geom‘ry
() << "} ";

365 
	gts
 << "isHidd’: " << 
	gwid
->
isHidd’
() << " ";

366 
	gts
 << "isS–fVisibË: " << 
	g·¹
->
widg‘
()->
isS–fVisibË
() << " ";

367 
	gts
 << "isP¬’tVisibË: " << 
	g·¹
->
widg‘
()->
isP¬’tVisibË
() << " ";

368 
	gts
 << "mask: {" << 
	gwid
->
mask
().
boundšgReù
() << "} ] ";

374 
wr™eTextRun
(
TextSŒ—m
& 
ts
, cÚ¡ 
R’d”Text
& 
o
, cÚ¡ 
IÆšeTextBox
& 
run
)

377 
	gy
 = 
run
.
m_y
;

378 ià(
	go
.
cÚššgBlock
()->
isTabËC–l
())

379 
	gy
 -ğ
toR’d”TabËC–l
(
o
.
cÚššgBlock
())->
šŒšsicPaddšgTİ
();

380 
	gts
 << "‹xˆruÀ© (" << 
	grun
.
	gm_x
 << "," << 
	gy
 << "èwidth " <<„un.
	gm_width
;

381 ià(
	grun
.
dœeùiÚ
(è=ğ
RTL
 || 
run
.
m_dœOv”ride
) {

382 
ts
 << (
run
.
dœeùiÚ
(è=ğ
RTL
 ? " RTL" : " LTR");

383 ià(
	grun
.
	gm_dœOv”ride
)

384 
	gts
 << " override";

386 
	gts
 << ": "

387 << 
quÙeAndEsÿ³NÚPršbËs
(
SŒšg
(
o
.
‹xt
()).
sub¡ršg
(
run
.
¡¬t
(),„un.
Ën
()))

391 
wr™e
(
TextSŒ—m
& 
ts
, cÚ¡ 
R’d”Objeù
& 
o
, 
šd’t
, 
R’d”AsTextBehaviÜ
 
behaviÜ
)

393 #ià
ENABLE
(
SVG
)

394 ià(
	go
.
isR’d”P©h
()) {

395 
wr™e
(
ts
, *
toR’d”P©h
(&
o
), 
šd’t
);

398 ià(
	go
.
isSVGResourû
()) {

399 
wr™eSVGResourû
(
ts
, 
o
, 
šd’t
);

402 ià(
	go
.
isSVGCÚš”
()) {

403 
wr™eSVGCÚš”
(
ts
, 
o
, 
šd’t
);

406 ià(
	go
.
isSVGRoÙ
()) {

407 
wr™e
(
ts
, *
toR’d”SVGRoÙ
(&
o
), 
šd’t
);

410 ià(
	go
.
isSVGText
()) {

411 ià(!
	go
.
isText
())

412 
wr™eSVGText
(
ts
, *
toR’d”Block
(&
o
), 
šd’t
);

414 
wr™eSVGIÆšeText
(
ts
, *
toR’d”Text
(&
o
), 
šd’t
);

417 ià(
	go
.
isSVGImage
()) {

418 
wr™eSVGImage
(
ts
, *
toR’d”Image
(&
o
), 
šd’t
);

423 
wr™eInd’t
(
ts
, 
šd’t
);

425 
wr™eR’d”Objeù
(
ts
, 
o
, 
behaviÜ
);

426 
	gts
 << "\n";

428 ià(
	go
.
isText
(è&& !o.
isBR
()) {

429 cÚ¡ 
	gR’d”Text
& 
	g‹xt
 = *
toR’d”Text
(&
o
);

430 
IÆšeTextBox
* 
	gbox
 = 
‹xt
.
fœ¡TextBox
(); box; box = 
box
->
ÃxtTextBox
()) {

431 
wr™eInd’t
(
ts
, 
šd’t
 + 1);

432 
wr™eTextRun
(
ts
, 
‹xt
, *
box
);

436 
R’d”Objeù
* 
	gchd
 = 
o
.
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
()) {

437 ià(
chd
->
hasLay”
())

439 
wr™e
(
ts
, *
chd
, 
šd’t
 + 1, 
behaviÜ
);

442 ià(
	go
.
isWidg‘
()) {

443 
Widg‘
* 
	gwidg‘
 = 
toR’d”Widg‘
(&
o
)->
widg‘
();

444 ià(
	gwidg‘
 && widg‘->
isF¿meV›w
()) {

445 
F¿meV›w
* 
	gv›w
 = 
¡©ic_ÿ¡
<F¿meV›w*>(
widg‘
);

446 
R’d”V›w
* 
	groÙ
 = 
v›w
->
äame
()->
cÚ‹ÁR’d””
();

447 ià(
	groÙ
) {

448 
	gv›w
->
Ïyout
();

449 
R’d”Lay”
* 
	gl
 = 
roÙ
->
Ïy”
();

450 ià(
	gl
)

451 
wr™eLay”s
(
ts
, 
l
,†, 
IÁReù
Ö->
x
(),†->
y
(),†->
width
(),†->
height
()), 
šd’t
 + 1, 
behaviÜ
);

457 
	eLay”PaštPha£
 {

458 
	gLay”PaštPha£AÎ
 = 0,

459 
	gLay”PaštPha£Background
 = -1,

460 
	gLay”PaštPha£FÜeground
 = 1

463 
wr™e
(
TextSŒ—m
& 
ts
, 
R’d”Lay”
& 
l
,

464 cÚ¡ 
IÁReù
& 
Ïy”Bounds
, cÚ¡ IÁReù& 
backgroundClReù
, cÚ¡ IÁReù& 
şReù
, cÚ¡ IÁReù& 
oušeClReù
,

465 
Lay”PaštPha£
 
·štPha£
 = 
Lay”PaštPha£AÎ
, 
šd’t
 = 0, 
R’d”AsTextBehaviÜ
 
behaviÜ
 = 
R’d”AsTextBehaviÜNÜm®
)

467 
wr™eInd’t
(
ts
, 
šd’t
);

469 
	gts
 << "layer ";

471 ià(
	gbehaviÜ
 & 
	gR’d”AsTextShowAdd»s£s
)

472 
	gts
 << &
	gl
 << " ";

474 
	gts
 << 
	gÏy”Bounds
;

476 ià(!
	gÏy”Bounds
.
isEm±y
()) {

477 ià(!
	gbackgroundClReù
.
cÚšs
(
Ïy”Bounds
))

478 
	gts
 << " backgroundCl " << 
	gbackgroundClReù
;

479 ià(!
	gşReù
.
cÚšs
(
Ïy”Bounds
))

480 
	gts
 << " cl " << 
	gşReù
;

481 ià(!
	goušeClReù
.
cÚšs
(
Ïy”Bounds
))

482 
	gts
 << " oušeCl " << 
	goušeClReù
;

485 ià(
	gl
.
»nd””
()->
hasOv”æowCl
()) {

486 ià(
	gl
.
süŞlXOff£t
())

487 
	gts
 << " süŞlX " << 
	gl
.
süŞlXOff£t
();

488 ià(
	gl
.
süŞlYOff£t
())

489 
	gts
 << " süŞlY " << 
	gl
.
süŞlYOff£t
();

490 ià(
	gl
.
»nd”Box
(è&&†.»nd”Box()->
ş›ÁWidth
(è!ğ
l
.
süŞlWidth
())

491 
ts
 << " süŞlWidth " << 
l
.
süŞlWidth
();

492 ià(
	gl
.
»nd”Box
(è&&†.»nd”Box()->
ş›ÁHeight
(è!ğ
l
.
süŞlHeight
())

493 
ts
 << " süŞlHeighˆ" << 
l
.
süŞlHeight
();

496 ià(
	g·štPha£
 =ğ
Lay”PaštPha£Background
)

497 
ts
 << "†ayerType: background only";

498 ià(
	g·štPha£
 =ğ
Lay”PaštPha£FÜeground
)

499 
ts
 << "†ayerType: foreground only";

501 #ià
USE
(
ACCELERATED_COMPOSITING
)

502 ià(
	gbehaviÜ
 & 
	gR’d”AsTextShowCompos™edLay”s
) {

503 ià(
	gl
.
isCompos™ed
())

504 
	gts
 << " (compos™ed, bound " << 
	gl
.
backšg
()->
compos™edBounds
() << ")";

507 
UNUSED_PARAM
(
behaviÜ
);

510 
	gts
 << "\n";

512 ià(
	g·štPha£
 !ğ
Lay”PaštPha£Background
)

513 
wr™e
(
ts
, *
l
.
»nd””
(), 
šd’t
 + 1, 
behaviÜ
);

516 
wr™eLay”s
(
TextSŒ—m
& 
ts
, cÚ¡ 
R’d”Lay”
* 
roÙLay”
, R’d”Lay”* 
l
,

517 cÚ¡ 
IÁReù
& 
·štDœtyReù
, 
šd’t
, 
R’d”AsTextBehaviÜ
 
behaviÜ
)

520 
IÁReù
 
	gÏy”Bounds
, 
	gdamageReù
, 
	gşReùToAµly
, 
	goušeReù
;

521 
	gl
->
ÿlcuÏ‹Reùs
(
roÙLay”
, 
·štDœtyReù
, 
Ïy”Bounds
, 
damageReù
, 
şReùToAµly
, 
oušeReù
, 
Œue
);

524 
	gl
->
upd©eZOrd”Li¡s
();

525 
	gl
->
upd©eNÜm®FlowLi¡
();

527 
boŞ
 
	gshouldPašt
 = (
behaviÜ
 & 
R’d”AsTextShowAÎLay”s
è? 
Œue
 : 
l
->
š‹r£ùsDamageReù
(
Ïy”Bounds
, 
damageReù
, 
roÙLay”
);

528 
	gVeùÜ
<
	gR’d”Lay”
*>* 
	gÃgLi¡
 = 
l
->
ÃgZOrd”Li¡
();

529 
boŞ
 
	g·štsBackgroundS•¬©–y
 = 
ÃgLi¡
 &&‚egLi¡->
size
() > 0;

530 ià(
	gshouldPašt
 && 
	g·štsBackgroundS•¬©–y
)

531 
wr™e
(
ts
, *
l
, 
Ïy”Bounds
, 
damageReù
, 
şReùToAµly
, 
oušeReù
, 
Lay”PaštPha£Background
, 
šd’t
, 
behaviÜ
);

533 ià(
	gÃgLi¡
) {

534 
	gcu¼Ind’t
 = 
šd’t
;

535 ià(
	gbehaviÜ
 & 
	gR’d”AsTextShowLay”Ne¡šg
) {

536 
wr™eInd’t
(
ts
, 
šd’t
);

537 
	gts
 << "‚eg©ivz-Üd”†i¡(" << 
	gÃgLi¡
->
size
() << ")\n";

538 ++
	gcu¼Ind’t
;

540 
	gi
 = 0; i !ğ
ÃgLi¡
->
size
(); ++i)

541 
wr™eLay”s
(
ts
, 
roÙLay”
, 
ÃgLi¡
->
©
(
i
), 
·štDœtyReù
, 
cu¼Ind’t
, 
behaviÜ
);

544 ià(
	gshouldPašt
)

545 
wr™e
(
ts
, *
l
, 
Ïy”Bounds
, 
damageReù
, 
şReùToAµly
, 
oušeReù
, 
·štsBackgroundS•¬©–y
 ? 
Lay”PaštPha£FÜeground
 : 
Lay”PaštPha£AÎ
, 
šd’t
, 
behaviÜ
);

547 ià(
	gVeùÜ
<
	gR’d”Lay”
*>* 
	gnÜm®FlowLi¡
 = 
l
->
nÜm®FlowLi¡
()) {

548 
cu¼Ind’t
 = 
šd’t
;

549 ià(
	gbehaviÜ
 & 
	gR’d”AsTextShowLay”Ne¡šg
) {

550 
wr™eInd’t
(
ts
, 
šd’t
);

551 
	gts
 << "‚Üm® flow†i¡(" << 
	gnÜm®FlowLi¡
->
size
() << ")\n";

552 ++
	gcu¼Ind’t
;

554 
	gi
 = 0; i !ğ
nÜm®FlowLi¡
->
size
(); ++i)

555 
wr™eLay”s
(
ts
, 
roÙLay”
, 
nÜm®FlowLi¡
->
©
(
i
), 
·štDœtyReù
, 
cu¼Ind’t
, 
behaviÜ
);

558 ià(
	gVeùÜ
<
	gR’d”Lay”
*>* 
	gposLi¡
 = 
l
->
posZOrd”Li¡
()) {

559 
cu¼Ind’t
 = 
šd’t
;

560 ià(
	gbehaviÜ
 & 
	gR’d”AsTextShowLay”Ne¡šg
) {

561 
wr™eInd’t
(
ts
, 
šd’t
);

562 
	gts
 << "…os™ivz-Üd”†i¡(" << 
	gposLi¡
->
size
() << ")\n";

563 ++
	gcu¼Ind’t
;

565 
	gi
 = 0; i !ğ
posLi¡
->
size
(); ++i)

566 
wr™eLay”s
(
ts
, 
roÙLay”
, 
posLi¡
->
©
(
i
), 
·štDœtyReù
, 
cu¼Ind’t
, 
behaviÜ
);

570 
SŒšg
 
nodePos™iÚ
(
Node
* 
node
)

572 
SŒšg
 
	g»suÉ
;

574 
Node
* 
	g·»Á
;

575 
Node
* 
	gn
 = 
node
;‚;‚ = 
·»Á
) {

576 
·»Á
 = 
n
->
·»ÁNode
();

577 ià(!
	g·»Á
)

578 
	g·»Á
 = 
n
->
shadowP¬’tNode
();

579 ià(
	gn
 !ğ
node
)

580 
»suÉ
 += " of ";

581 ià(
	g·»Á
)

582 
	g»suÉ
 +ğ"chd " + 
SŒšg
::
numb”
(
n
->
nodeIndex
()è+ " {" + 
g‘TagName
(n) + "}";

584 
	g»suÉ
 += "document";

587  
	g»suÉ
;

590 
wr™eS–eùiÚ
(
TextSŒ—m
& 
ts
, cÚ¡ 
R’d”Objeù
* 
o
)

592 
Node
* 
	gn
 = 
o
->
node
();

593 ià(!
	gn
 || !n->
isDocum’tNode
())

596 
Docum’t
* 
	gdoc
 = 
¡©ic_ÿ¡
<Docum’t*>(
n
);

597 
F¿me
* 
	gäame
 = 
doc
->
äame
();

598 ià(!
	gäame
)

601 
VisibËS–eùiÚ
 
	g£ËùiÚ
 = 
äame
->
£ËùiÚ
()->selection();

602 ià(
	g£ËùiÚ
.
isC¬‘
()) {

603 
	gts
 << "ÿ»t:…os™iÚ " << 
	g£ËùiÚ
.
¡¬t
().
d•»ÿ‹dEd™šgOff£t
(è<< " oà" << 
nodePos™iÚ
(
£ËùiÚ
.¡¬t().
node
());

604 ià(
	g£ËùiÚ
.
affš™y
(è=ğ
UPSTREAM
)

605 
ts
 << " (upstream‡ffinity)";

606 
	gts
 << "\n";

607 } ià(
	g£ËùiÚ
.
isRªge
())

608 
	gts
 << "£ËùiÚ s¹:…os™iÚ " << 
	g£ËùiÚ
.
¡¬t
().
d•»ÿ‹dEd™šgOff£t
(è<< " oà" << 
nodePos™iÚ
(
£ËùiÚ
.¡¬t().
node
()) << "\n"

609 << "£ËùiÚƒnd:…os™iÚ " << 
	g£ËùiÚ
.
’d
().
d•»ÿ‹dEd™šgOff£t
(è<< " oà" << 
nodePos™iÚ
(
£ËùiÚ
.’d().
node
()) << "\n";

612 
SŒšg
 
ex‹º®R•»£Á©iÚ
(
F¿me
* 
äame
, 
R’d”AsTextBehaviÜ
 
behaviÜ
)

614 
	gäame
->
docum’t
()->
upd©eLayout
();

616 
R’d”Objeù
* 
	go
 = 
äame
->
cÚ‹ÁR’d””
();

617 ià(!
	go
)

618  
SŒšg
();

620 
TextSŒ—m
 
	gts
;

621 #ià
ENABLE
(
SVG
)

622 
wr™eR’d”Resourûs
(
ts
, 
o
->
docum’t
());

624 ià(
	go
->
hasLay”
()) {

625 
R’d”Lay”
* 
	gl
 = 
toR’d”Box
(
o
)->
Ïy”
();

626 
wr™eLay”s
(
ts
, 
l
,†, 
IÁReù
Ö->
x
(),†->
y
(),†->
width
(),†->
height
()), 0, 
behaviÜ
);

627 
wr™eS–eùiÚ
(
ts
, 
o
);

629  
	gts
.
»Ëa£
();

632 
wr™eCouÁ”V®uesFromChd»n
(
TextSŒ—m
& 
¡»am
, 
R’d”Objeù
* 
·»Á
, 
boŞ
& 
isFœ¡CouÁ”
)

634 
R’d”Objeù
* 
	gchd
 = 
·»Á
->
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
()) {

635 ià(
chd
->
isCouÁ”
()) {

636 ià(!
isFœ¡CouÁ”
)

637 
¡»am
 << " ";

638 
	gisFœ¡CouÁ”
 = 
çl£
;

639 
SŒšg
 
¡r
(
toR’d”Text
(
chd
)->
‹xt
());

640 
	g¡»am
 << 
	g¡r
;

645 
SŒšg
 
couÁ”V®ueFÜEËm’t
(
EËm’t
* 
–em’t
)

648 
	gRefPŒ
<
	gEËm’t
> 
–em’tRef
(
–em’t
);

649 
	g–em’t
->
docum’t
()->
upd©eLayout
();

650 
TextSŒ—m
 
	g¡»am
;

651 
boŞ
 
	gisFœ¡CouÁ”
 = 
Œue
;

654 ià(
R’d”Objeù
* 
	g»nd””
 = 
–em’t
->
»nd””
()) {

655 
R’d”Objeù
* 
chd
 = 
»nd””
->
fœ¡Chd
(); 
	gchd
; chd = chd->
ÃxtSiblšg
()) {

656 ià(
chd
->
isAnÚymous
())

657 
wr™eCouÁ”V®uesFromChd»n
(
¡»am
, 
chd
, 
isFœ¡CouÁ”
);

660  
	g¡»am
.
»Ëa£
();

	@RenderTreeAsText.h

26 #iâdeà
R’d”T»eAsText_h


27 
	#R’d”T»eAsText_h


	)

29 
Çme¥aû
 
	gWebCÜe
 {

31 
şass
 
	gEËm’t
;

32 
şass
 
	gF¿me
;

33 
şass
 
	gR’d”Objeù
;

34 
şass
 
	gSŒšg
;

35 
şass
 
	gTextSŒ—m
;

37 
	eR’d”AsTextBehaviÜFÏgs
 {

38 
	gR’d”AsTextBehaviÜNÜm®
 = 0,

39 
	gR’d”AsTextShowAÎLay”s
 = 1 << 0,

40 
	gR’d”AsTextShowLay”Ne¡šg
 = 1 << 1,

41 
	gR’d”AsTextShowCompos™edLay”s
 = 1 << 2,

42 
	gR’d”AsTextShowAdd»s£s
 = 1 << 3

44 
	tR’d”AsTextBehaviÜ
;

46 
SŒšg
 
ex‹º®R•»£Á©iÚ
(
F¿me
*, 
R’d”AsTextBehaviÜ
 = 
R’d”AsTextBehaviÜNÜm®
);

47 
wr™e
(
TextSŒ—m
&, cÚ¡ 
R’d”Objeù
&, 
šd’t
 = 0, 
R’d”AsTextBehaviÜ
 = 
R’d”AsTextBehaviÜNÜm®
);

50 
SŒšg
 
quÙeAndEsÿ³NÚPršbËs
(const String&);

52 
SŒšg
 
couÁ”V®ueFÜEËm’t
(
EËm’t
*);

	@RenderVideo.cpp

26 
	~"cÚfig.h
"

28 #ià
ENABLE
(
VIDEO
)

29 
	~"R’d”Video.h
"

31 
	~"Docum’t.h
"

32 
	~"F¿meV›w.h
"

33 
	~"G¿phicsCÚ‹xt.h
"

34 
	~"HTMLNames.h
"

35 
	~"HTMLVideoEËm’t.h
"

36 
	~"MedŸPÏy”.h
"

37 
	~"R’d”V›w.h
"

39 #ià
USE
(
ACCELERATED_COMPOSITING
)

40 
	~"R’d”Lay”.h
"

41 
	~"R’d”Lay”Backšg.h
"

44 
usšg
 
Çme¥aû
 
	g¡d
;

46 
Çme¥aû
 
	gWebCÜe
 {

48 
usšg
 
Çme¥aû
 
	gHTMLNames
;

50 
	gR’d”Video
::
R’d”Video
(
HTMLVideoEËm’t
* 
video
)

51 : 
R’d”MedŸ
(
video
)

53 ià(
video
->
¶ay”
())

54 
£tIÁršsicSize
(
video
->
¶ay”
()->
Çtu¿lSize
());

60 ià(
	gvideo
->
hasA‰ribu‹
(
widthA‰r
è&& video->hasA‰ribu‹(
heightA‰r
))

61 
£tIÁršsicSize
(
IÁSize
(
video
->
width
(), video->
height
()));

62 ià(
	gvideo
->
owÃrDocum’t
(è&& video->owÃrDocum’t()->
isMedŸDocum’t
()) {

67 
£tIÁršsicSize
(
IÁSize
(
deçuÉSize
().
width
(), 1));

70 
£tIÁršsicSize
(
deçuÉSize
());

74 
	gR’d”Video
::~
R’d”Video
()

76 ià(
MedŸPÏy”
* 
p
 = 
¶ay”
()) {

77 
p
->
£tVisibË
(
çl£
);

78 
	gp
->
£tF¿meV›w
(0);

82 
IÁSize
 
	gR’d”Video
::
deçuÉSize
()

85 cÚ¡ 
cDeçuÉWidth
 = 300;

86 cÚ¡ 
	gcDeçuÉHeight
 = 150;

88  
IÁSize
(
cDeçuÉWidth
, 
cDeçuÉHeight
);

91 
	gR’d”Video
::
šŒšsicSizeChªged
()

93 ià(
videoEËm’t
()->
shouldDi¥ÏyPo¡”Image
())

94 
R’d”MedŸ
::
šŒšsicSizeChªged
();

95 
videoSizeChªged
();

99 
	gR’d”Video
::
videoSizeChªged
()

101 ià(!
¶ay”
())

103 
IÁSize
 
	gsize
 = 
¶ay”
()->
Çtu¿lSize
();

104 ià(!
	gsize
.
isEm±y
(è&& siz!ğ
šŒšsicSize
()) {

105 
£tIÁršsicSize
(
size
);

106 
£tP»fWidthsDœty
(
Œue
);

107 
£tN“dsLayout
(
Œue
);

111 
	gR’d”Video
::
imageChªged
(
W¿µedImagePŒ
 
ÃwImage
, cÚ¡ 
IÁReù
* 
»ù
)

113 
	gR’d”MedŸ
::
imageChªged
(
ÃwImage
, 
»ù
);

118 ià(
videoEËm’t
()->
shouldDi¥ÏyPo¡”Image
())

119 
	gm_ÿchedImageSize
 = 
šŒšsicSize
();

122 
IÁReù
 
	gR’d”Video
::
videoBox
() const

124 ià(
m_ÿchedImageSize
.
isEm±y
(è&& 
videoEËm’t
()->
shouldDi¥ÏyPo¡”Image
())

125  
IÁReù
();

127 
IÁSize
 
	g–em’tSize
;

128 ià(
videoEËm’t
()->
shouldDi¥ÏyPo¡”Image
())

129 
	g–em’tSize
 = 
m_ÿchedImageSize
;

131 
	g–em’tSize
 = 
šŒšsicSize
();

133 
IÁReù
 
	gcÚ‹ÁReù
 = 
cÚ‹ÁBoxReù
();

134 ià(
	g–em’tSize
.
isEm±y
(è|| 
	gcÚ‹ÁReù
.isEmpty())

135  
IÁReù
();

137 
IÁReù
 
	g»nd”Box
 = 
cÚ‹ÁReù
;

138 
	g¿tio
 = 
»nd”Box
.
width
(è* 
–em’tSize
.
height
() -„enderBox.height() *ƒlementSize.width();

139 ià(
	g¿tio
 > 0) {

140 
	gÃwWidth
 = 
»nd”Box
.
height
(è* 
–em’tSize
.
width
() /ƒlementSize.height();

142 ià(
	g»nd”Box
.
width
(è- 
	gÃwWidth
 > 2)

143 
	g»nd”Box
.
£tWidth
(
ÃwWidth
);

144 
	g»nd”Box
.
move
((
cÚ‹ÁReù
.
width
(è- 
»nd”Box
.width()) / 2, 0);

145 } ià(
	g¿tio
 < 0) {

146 
	gÃwHeight
 = 
»nd”Box
.
width
(è* 
–em’tSize
.
height
() /ƒlementSize.width();

147 ià(
	g»nd”Box
.
height
(è- 
	gÃwHeight
 > 2)

148 
	g»nd”Box
.
£tHeight
(
ÃwHeight
);

149 
	g»nd”Box
.
move
(0, (
cÚ‹ÁReù
.
height
(è- 
»nd”Box
.height()) / 2);

152  
	g»nd”Box
;

155 
	gR’d”Video
::
·štR•Ïûd
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

157 
MedŸPÏy”
* 
	gmedŸPÏy”
 = 
¶ay”
();

158 
boŞ
 
	gdi¥ÏyšgPo¡”
 = 
videoEËm’t
()->
shouldDi¥ÏyPo¡”Image
();

160 ià(
	gdi¥ÏyšgPo¡”
 && 
docum’t
()->
´štšg
(è&& !
v›w
()->
´štImages
())

163 ià(!
	gdi¥ÏyšgPo¡”
) {

164 ià(!
	gmedŸPÏy”
)

166 
upd©ePÏy”
();

169 
IÁReù
 
	g»ù
 = 
videoBox
();

170 ià(
	g»ù
.
isEm±y
())

172 
	g»ù
.
move
(
tx
, 
ty
);

173 ià(
	gdi¥ÏyšgPo¡”
)

174 
·štIÁoReù
(
·štInfo
.
cÚ‹xt
, 
»ù
);

176 
	gmedŸPÏy”
->
·št
(
·štInfo
.
cÚ‹xt
, 
»ù
);

179 
	gR’d”Video
::
Ïyout
()

181 
R’d”MedŸ
::
Ïyout
();

182 
upd©ePÏy”
();

185 
HTMLVideoEËm’t
* 
	gR’d”Video
::
videoEËm’t
() const

187 
ASSERT
(
node
()->
hasTagName
(
videoTag
));

188  
	g¡©ic_ÿ¡
<
	gHTMLVideoEËm’t
*>(
node
());

191 
	gR’d”Video
::
upd©eFromEËm’t
()

193 
R’d”MedŸ
::
upd©eFromEËm’t
();

194 
upd©ePÏy”
();

197 
	gR’d”Video
::
upd©ePÏy”
()

199 
MedŸPÏy”
* 
medŸPÏy”
 = 
¶ay”
();

200 ià(!
	gmedŸPÏy”
)

202 ià(!
videoEËm’t
()->
šAùiveDocum’t
()) {

203 
	gmedŸPÏy”
->
£tVisibË
(
çl£
);

207 #ià
USE
(
ACCELERATED_COMPOSITING
)

208 
Ïy”
()->
»nd””CÚ‹ÁChªged
();

211 
IÁReù
 
	gvideoBounds
 = 
videoBox
();

212 
	gmedŸPÏy”
->
£tF¿meV›w
(
docum’t
()->
v›w
());

213 
	gmedŸPÏy”
->
£tSize
(
IÁSize
(
videoBounds
.
width
(), videoBounds.
height
()));

214 
	gmedŸPÏy”
->
£tVisibË
(
Œue
);

217 
	gR’d”Video
::
ÿlcR•ÏûdWidth
(
boŞ
 
šşudeMaxWidth
) const

219 
width
;

220 ià(
isWidthS³cif›d
())

221 
	gwidth
 = 
ÿlcR•ÏûdWidthUsšg
(
¡yË
()->
width
());

223 
	gwidth
 = 
ÿlcA¥eùR©ioWidth
(è* 
¡yË
()->
efãùiveZoom
();

225 
	gmšW
 = 
ÿlcR•ÏûdWidthUsšg
(
¡yË
()->
mšWidth
());

226 
	gmaxW
 = !
šşudeMaxWidth
 || 
¡yË
()->
maxWidth
().
isUndefšed
(è? 
width
 : 
ÿlcR•ÏûdWidthUsšg
(style()->maxWidth());

228  
max
(
mšW
, 
mš
(
width
, 
maxW
));

231 
	gR’d”Video
::
ÿlcR•ÏûdHeight
() const

233 
height
;

234 ià(
isHeightS³cif›d
())

235 
	gheight
 = 
ÿlcR•ÏûdHeightUsšg
(
¡yË
()->
height
());

237 
	gheight
 = 
ÿlcA¥eùR©ioHeight
(è* 
¡yË
()->
efãùiveZoom
();

239 
	gmšH
 = 
ÿlcR•ÏûdHeightUsšg
(
¡yË
()->
mšHeight
());

240 
	gmaxH
 = 
¡yË
()->
maxHeight
().
isUndefšed
(è? 
height
 : 
ÿlcR•ÏûdHeightUsšg
(style()->maxHeight());

242  
max
(
mšH
, 
mš
(
height
, 
maxH
));

245 
	gR’d”Video
::
ÿlcA¥eùR©ioWidth
() const

247 
šŒšsicWidth
 = 
šŒšsicSize
().
width
();

248 
	gšŒšsicHeight
 = 
šŒšsicSize
().
height
();

249 ià(!
	gšŒšsicHeight
)

251  
	gR’d”Box
::
ÿlcR•ÏûdHeight
(è* 
šŒšsicWidth
 / 
šŒšsicHeight
;

254 
	gR’d”Video
::
ÿlcA¥eùR©ioHeight
() const

256 
šŒšsicWidth
 = 
šŒšsicSize
().
width
();

257 
	gšŒšsicHeight
 = 
šŒšsicSize
().
height
();

258 ià(!
	gšŒšsicWidth
)

260  
	gR’d”Box
::
ÿlcR•ÏûdWidth
(è* 
šŒšsicHeight
 / 
šŒšsicWidth
;

263 
	gR’d”Video
::
mšimumR•ÏûdHeight
() const

268 #ià
USE
(
ACCELERATED_COMPOSITING
)

269 
boŞ
 
	gR’d”Video
::
suµÜtsAcûË¿‹dR’d”šg
() const

271 
MedŸPÏy”
* 
p
 = 
¶ay”
();

272 ià(
	gp
)

273  
	gp
->
suµÜtsAcûË¿‹dR’d”šg
();

275  
	gçl£
;

278 
	gR’d”Video
::
acûË¿‹dR’d”šgS‹Chªged
()

280 
MedŸPÏy”
* 
p
 = 
¶ay”
();

281 ià(
	gp
)

282 
	gp
->
acûË¿‹dR’d”šgS‹Chªged
();

	@RenderVideo.h

26 #iâdeà
R’d”Video_h


27 
	#R’d”Video_h


	)

29 #ià
ENABLE
(
VIDEO
)

31 
	~"R’d”MedŸ.h
"

33 
Çme¥aû
 
	gWebCÜe
 {

35 
şass
 
	gHTMLMedŸEËm’t
;

36 
şass
 
	gHTMLVideoEËm’t
;

38 şas 
	cR’d”Video
 : 
public
 
R’d”MedŸ
 {

39 
public
:

40 
R’d”Video
(
HTMLVideoEËm’t
*);

41 
	gvœtu®
 ~
R’d”Video
();

43 
videoSizeChªged
();

44 
IÁReù
 
videoBox
() const;

46 
IÁSize
 
deçuÉSize
();

48 #ià
USE
(
ACCELERATED_COMPOSITING
)

49 
boŞ
 
suµÜtsAcûË¿‹dR’d”šg
() const;

50 
acûË¿‹dR’d”šgS‹Chªged
();

53 
	g´iv©e
:

54 
vœtu®
 
upd©eFromEËm’t
();

55 
šlše
 
HTMLVideoEËm’t
* 
videoEËm’t
() const;

57 
vœtu®
 
šŒšsicSizeChªged
();

58 
vœtu®
 
imageChªged
(
W¿µedImagePŒ
, cÚ¡ 
IÁReù
*);

60 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderVideo"; }

62 
vœtu®
 
boŞ
 
»quœesLay”
(ècÚ¡ {  
	gŒue
; }

63 
vœtu®
 
boŞ
 
isVideo
(ècÚ¡ {  
	gŒue
; }

65 
vœtu®
 
·štR•Ïûd
(
PaštInfo
&, 
tx
, 
ty
);

67 
vœtu®
 
Ïyout
();

69 
vœtu®
 
ÿlcR•ÏûdWidth
(
boŞ
 
šşudeMaxWidth
 = 
Œue
) const;

70 
vœtu®
 
ÿlcR•ÏûdHeight
() const;

71 
vœtu®
 
mšimumR•ÏûdHeight
() const;

73 
ÿlcA¥eùR©ioWidth
() const;

74 
ÿlcA¥eùR©ioHeight
() const;

76 
upd©ePÏy”
();

78 
IÁSize
 
	gm_ÿchedImageSize
;

81 
šlše
 
R’d”Video
* 
	$toR’d”Video
(
R’d”Objeù
* 
objeù
)

83 
	`ASSERT
(!
objeù
 || objeù->
	`isVideo
());

84  
¡©ic_ÿ¡
<
R’d”Video
*>(
objeù
);

85 
	}
}

88 
toR’d”Video
(cÚ¡ 
R’d”Video
*);

	@RenderView.cpp

21 
	~"cÚfig.h
"

22 
	~"R’d”V›w.h
"

24 
	~"Docum’t.h
"

25 
	~"EËm’t.h
"

26 
	~"FlßtQuad.h
"

27 
	~"F¿me.h
"

28 
	~"F¿meV›w.h
"

29 
	~"G¿phicsCÚ‹xt.h
"

30 
	~"H™Te¡ResuÉ.h
"

31 
	~"R’d”Lay”.h
"

32 
	~"R’d”S–eùiÚInfo.h
"

33 
	~"R’d”Widg‘.h
"

34 
	~"R’d”Widg‘PrÙeùÜ.h
"

35 
	~"T¿nsfÜmS‹.h
"

37 #ià
USE
(
ACCELERATED_COMPOSITING
)

38 
	~"R’d”Lay”Compos™Ü.h
"

41 
Çme¥aû
 
	gWebCÜe
 {

43 
	gR’d”V›w
::
R’d”V›w
(
Node
* 
node
, 
F¿meV›w
* 
v›w
)

44 : 
R’d”Block
(
node
)

45 , 
m_äameV›w
(
v›w
)

46 , 
m_£ËùiÚS¹
(0)

47 , 
m_£ËùiÚEnd
(0)

48 , 
m_£ËùiÚS¹Pos
(-1)

49 , 
m_£ËùiÚEndPos
(-1)

50 , 
m_´štImages
(
Œue
)

51 , 
m_maxim®OušeSize
(0)

52 , 
m_be¡Trunÿ‹dAt
(0)

53 , 
m_ŒunÿtÜWidth
(0)

54 , 
m_mšimumCŞumnHeight
(0)

55 , 
m_fÜûdPageB»ak
(
çl£
)

56 , 
m_ÏyoutS‹
(0)

57 , 
m_ÏyoutS‹Di§bËCouÁ
(0)

61 
£tIsAnÚymous
(
çl£
);

64 
£tIÆše
(
çl£
);

66 
	gm_mšP»fWidth
 = 0;

67 
	gm_maxP»fWidth
 = 0;

69 
£tP»fWidthsDœty
(
Œue
, 
çl£
);

71 
£tPos™iÚed
(
Œue
);

74 
	gm_Ïy”
 = 
Ãw
 (
node
->
docum’t
()->
»nd”A»Ç
()è
R’d”Lay”
(
this
);

75 
£tHasLay”
(
Œue
);

78 
	gR’d”V›w
::~
R’d”V›w
()

82 
R’d”V›w
::
ÿlcHeight
()

84 ià(!
´štšg
(è&& 
m_äameV›w
)

85 
£tHeight
(
v›wHeight
());

88 
	gR’d”V›w
::
ÿlcWidth
()

90 ià(!
´štšg
(è&& 
m_äameV›w
)

91 
£tWidth
(
v›wWidth
());

92 
	gm_m¬gšLeá
 = 0;

93 
	gm_m¬gšRight
 = 0;

96 
	gR’d”V›w
::
ÿlcP»fWidths
()

98 
ASSERT
(
´efWidthsDœty
());

100 
	gR’d”Block
::
ÿlcP»fWidths
();

102 
	gm_maxP»fWidth
 = 
m_mšP»fWidth
;

105 
	gR’d”V›w
::
Ïyout
()

107 ià(
´štšg
())

108 
m_mšP»fWidth
 = 
m_maxP»fWidth
 = 
width
();

111 
boŞ
 
	g»ÏyoutChd»n
 = !
´štšg
(è&& (!
m_äameV›w
 || 
width
(è!ğ
v›wWidth
(è|| 
height
(è!ğ
v›wHeight
());

112 ià(
	g»ÏyoutChd»n
) {

113 
£tChdN“dsLayout
(
Œue
, 
çl£
);

114 
R’d”Objeù
* 
	gchd
 = 
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
()) {

115 ià(
chd
->
¡yË
()->
height
().
isP”ûÁ
(è|| chd->¡yË()->
mšHeight
().isP”ûÁ(è|| chd->¡yË()->
maxHeight
().isPercent())

116 
chd
->
£tChdN“dsLayout
(
Œue
, 
çl£
);

120 
ASSERT
(!
m_ÏyoutS‹
);

121 
LayoutS‹
 
	g¡©e
;

123 
	g¡©e
.
	gm_ş³d
 = 
çl£
;

124 
	gm_ÏyoutS‹
 = &
¡©e
;

126 ià(
ÃedsLayout
())

127 
	gR’d”Block
::
Ïyout
();

130 
	gm_ov”æow
.
ş—r
();

131 
addLayoutOv”æow
(
IÁReù
(0, 0, 
docWidth
(), 
docHeight
()));

134 
ASSERT
(
ÏyoutD–
(è=ğ
IÁSize
());

135 
ASSERT
(
m_ÏyoutS‹Di§bËCouÁ
 == 0);

136 
ASSERT
(
m_ÏyoutS‹
 =ğ&
¡©e
);

137 
	gm_ÏyoutS‹
 = 0;

138 
£tN“dsLayout
(
çl£
);

141 
	gR’d”V›w
::
m­LoÿlToCÚš”
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
boŞ
 
fixed
, boŞ , 
T¿nsfÜmS‹
& 
ŒªsfÜmS‹
) const

145 
ASSERT_UNUSED
(
»·štCÚš”
, !»·štCÚš” ||„•aštCÚš” =ğ
this
);

147 ià(
	gfixed
 && 
	gm_äameV›w
)

148 
	gŒªsfÜmS‹
.
move
(
m_äameV›w
->
süŞlOff£t
());

151 
	gR’d”V›w
::
m­AbsŞu‹ToLoÿlPošt
(
boŞ
 
fixed
, boŞ , 
T¿nsfÜmS‹
& 
ŒªsfÜmS‹
) const

153 ià(
	gfixed
 && 
	gm_äameV›w
)

154 
	gŒªsfÜmS‹
.
move
(-
m_äameV›w
->
süŞlOff£t
());

157 
	gR’d”V›w
::
·št
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

160 
ASSERT
(!
ÃedsLayout
());

163 ià(
´štšg
())

164 
£tPrštReù
(
·štInfo
.
»ù
);

166 
£tPrštReù
(
IÁReù
());

167 
·štObjeù
(
·štInfo
, 
tx
, 
ty
);

170 
šlše
 
boŞ
 
»nd””Obscu»sBackground
(
R’d”Objeù
* 
objeù
)

172  
	gobjeù
 && objeù->
¡yË
()->
visib™y
(è=ğ
VISIBLE
 && 
objeù
->¡yË()->
İac™y
(è=ğ1 && !objeù->¡yË()->
hasT¿nsfÜm
();

175 
	gR’d”V›w
::
·štBoxDecÜ©iÚs
(
PaštInfo
& 
·štInfo
, , )

182 
EËm’t
* 
	g–t
;

183 
	g–t
 = 
docum’t
()->
owÃrEËm’t
(); 
v›w
(è&&ƒÉ &&ƒÉ->
»nd””
();ƒÉ = 
–t
->document()->ownerElement()) {

184 
R’d”Lay”
* 
Ïy”
 = 
–t
->
»nd””
()->
’şosšgLay”
();

185 ià(
	gÏy”
->
»quœesSlowR•ašts
()) {

186 
äameV›w
()->
£tU£SlowR•ašts
();

192 ià(
	g–t
 || 
»nd””Obscu»sBackground
(
fœ¡Chd
()è|| !
v›w
())

199 ià(
v›w
()->
isT¿n¥¬’t
())

200 
äameV›w
()->
£tU£SlowR•ašts
();

202 
CŞÜ
 
	gba£CŞÜ
 = 
äameV›w
()->
ba£BackgroundCŞÜ
();

203 ià(
	gba£CŞÜ
.
®pha
() > 0) {

204 
	g·štInfo
.
	gcÚ‹xt
->
§ve
();

205 
	g·štInfo
.
	gcÚ‹xt
->
£tCompos™eO³¿tiÚ
(
Compos™eCİy
);

206 
	g·štInfo
.
	gcÚ‹xt
->
flReù
(
·štInfo
.
»ù
, 
ba£CŞÜ
, 
¡yË
()->
cŞÜS·û
());

207 
	g·štInfo
.
	gcÚ‹xt
->
»¡Üe
();

209 
	g·štInfo
.
	gcÚ‹xt
->
ş—rReù
(
·štInfo
.
»ù
);

213 
boŞ
 
	gR’d”V›w
::
shouldR•ašt
(cÚ¡ 
IÁReù
& 
r
) const

215 ià(
´štšg
(è|| 
r
.
width
(è=ğ0 ||„.
height
() == 0)

216  
çl£
;

218 ià(!
	gm_äameV›w
)

219  
	gçl£
;

221  
	gŒue
;

224 
	gR’d”V›w
::
»·štV›wReùªgË
(cÚ¡ 
IÁReù
& 
ur
, 
boŞ
 
immedŸ‹
)

226 ià(!
shouldR•ašt
(
ur
))

231 
EËm’t
* 
	g–t
 = 
docum’t
()->
owÃrEËm’t
();

232 ià(!
	g–t
)

233 
	gm_äameV›w
->
»·štCÚ‹ÁReùªgË
(
ur
, 
immedŸ‹
);

234 ià(
R’d”Box
* 
	gobj
 = 
–t
->
»nd”Box
()) {

235 
IÁReù
 
vr
 = 
v›wReù
();

236 
IÁReù
 
	gr
 = 
š‹r£ùiÚ
(
ur
, 
vr
);

240 
	gr
.
move
(-
vr
.
x
(), -vr.
y
());

243 
	gr
.
move
(
obj
->
bÜd”Leá
(è+ obj->
·ddšgLeá
(),

244 
obj
->
bÜd”Tİ
(è+ obj->
·ddšgTİ
());

245 
	gobj
->
»·štReùªgË
(
r
, 
immedŸ‹
);

249 
	gR’d”V›w
::
»·štReùªgËInV›wAndCompos™edLay”s
(cÚ¡ 
IÁReù
& 
ur
, 
boŞ
 
immedŸ‹
)

251 ià(!
shouldR•ašt
(
ur
))

254 
»·štV›wReùªgË
(
ur
, 
immedŸ‹
);

256 #ià
USE
(
ACCELERATED_COMPOSITING
)

259 ià(
docum’t
()->
owÃrEËm’t
())

262 ià(
compos™Ü
()->
šCompos™šgMode
())

263 
compos™Ü
()->
»·štCompos™edLay”sAbsŞu‹Reù
(
ur
);

267 
	gR’d”V›w
::
compu‹ReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
IÁReù
& 
»ù
, 
boŞ
 
fixed
)

271 
ASSERT_UNUSED
(
»·štCÚš”
, !»·štCÚš” ||„•aštCÚš” =ğ
this
);

273 ià(
´štšg
())

276 ià(
	gfixed
 && 
	gm_äameV›w
)

277 
	g»ù
.
move
(
m_äameV›w
->
süŞlX
(), m_äameV›w->
süŞlY
());

280 ià(
	gm_Ïy”
 && m_Ïy”->
ŒªsfÜm
())

281 
	g»ù
 = 
m_Ïy”
->
ŒªsfÜm
()->
m­Reù
(
»ù
);

284 
	gR’d”V›w
::
absŞu‹Reùs
(
VeùÜ
<
IÁReù
>& 
»ùs
, 
tx
, 
ty
)

286 
	g»ùs
.
­³nd
(
IÁReù
(
tx
, 
ty
, 
m_Ïy”
->
width
(), m_Ïy”->
height
()));

289 
	gR’d”V›w
::
absŞu‹Quads
(
VeùÜ
<
FlßtQuad
>& 
quads
)

291 
quads
.
­³nd
(
FlßtReù
(0, 0, 
m_Ïy”
->
width
(), m_Ïy”->
height
()));

294 
R’d”Objeù
* 
»nd””Aá”Pos™iÚ
(R’d”Objeù* 
objeù
, 
off£t
)

296 ià(!
	gobjeù
)

299 
R’d”Objeù
* 
	gchd
 = 
objeù
->
chdAt
(
off£t
);

300  
	gchd
 ? chd : 
objeù
->
ÃxtInP»Ord”Aá”Chd»n
();

303 
IÁReù
 
	gR’d”V›w
::
£ËùiÚBounds
(
boŞ
 
şToVisibËCÚ‹Á
) const

305 
docum’t
()->
upd©eStyËIfN“ded
();

307 
	gHashM­
<
	tR’d”Objeù
*, 
	tR’d”S–eùiÚInfo
*> 
	tS–eùiÚM­
;

308 
S–eùiÚM­
 
	g£ËùedObjeùs
;

310 
R’d”Objeù
* 
	gos
 = 
m_£ËùiÚS¹
;

311 
R’d”Objeù
* 
	g¡İ
 = 
»nd””Aá”Pos™iÚ
(
m_£ËùiÚEnd
, 
m_£ËùiÚEndPos
);

312 
	gos
 && o !ğ
¡İ
) {

313 ià((
os
->
ÿnBeS–eùiÚL—f
(è|| o =ğ
m_£ËùiÚS¹
 || o =ğ
m_£ËùiÚEnd
è&& os->
£ËùiÚS‹
(è!ğ
S–eùiÚNÚe
) {

315 
£ËùedObjeùs
.
£t
(
os
, 
Ãw
 
R’d”S–eùiÚInfo
(os, 
şToVisibËCÚ‹Á
));

316 
R’d”Block
* 
	gcb
 = 
os
->
cÚššgBlock
();

317 
	gcb
 && !cb->
isR’d”V›w
()) {

318 
R’d”S–eùiÚInfo
* 
	gblockInfo
 = 
£ËùedObjeùs
.
g‘
(
cb
);

319 ià(
	gblockInfo
)

321 
	g£ËùedObjeùs
.
£t
(
cb
, 
Ãw
 
R’d”S–eùiÚInfo
(cb, 
şToVisibËCÚ‹Á
));

322 
	gcb
 = 
cb
->
cÚššgBlock
();

326 
	gos
 = 
os
->
ÃxtInP»Ord”
();

330 
IÁReù
 
	g£lReù
;

331 
	gS–eùiÚM­
::
™”©Ü
 
’d
 = 
£ËùedObjeùs
.end();

332 
	gS–eùiÚM­
::
™”©Ü
 
i
 = 
£ËùedObjeùs
.
begš
(); 
	gi
 !ğ
’d
; ++i) {

333 
R’d”S–eùiÚInfo
* 
	gšfo
 = 
i
->
£cÚd
;

335 
IÁReù
 
	gcu¼Reù
 = 
šfo
->
»ù
();

336 ià(
R’d”BoxMod–Objeù
* 
	g»·štCÚš”
 = 
šfo
->
»·štCÚš”
()) {

337 
FlßtQuad
 
absQuad
 = 
»·štCÚš”
->
loÿlToAbsŞu‹Quad
(
FlßtReù
(
cu¼Reù
));

338 
	gcu¼Reù
 = 
absQuad
.
’şosšgBoundšgBox
();

340 
	g£lReù
.
un™e
(
cu¼Reù
);

341 
d–‘e
 
	gšfo
;

343  
	g£lReù
;

346 #ià
USE
(
ACCELERATED_COMPOSITING
)

350 
	gR’d”V›w
::
£tMaxim®OušeSize
(
o
)

352 ià(
o
 !ğ
m_maxim®OušeSize
) {

353 
m_maxim®OušeSize
 = 
o
;

356 
compos™Ü
()->
£tCompos™šgLay”sN“dRebud
();

361 
	gR’d”V›w
::
£tS–eùiÚ
(
R’d”Objeù
* 
¡¬t
, 
¡¬tPos
, R’d”Objeù* 
’d
, 
’dPos
, 
S–eùiÚR•aštMode
 
blockR•aštMode
)

365 ià((
	g¡¬t
 && !
	g’d
) || (end && !start))

369 ià(
	gm_£ËùiÚS¹
 =ğ
¡¬t
 && 
m_£ËùiÚS¹Pos
 =ğ
¡¬tPos
 &&

370 
m_£ËùiÚEnd
 =ğ
’d
 && 
m_£ËùiÚEndPos
 =ğ
’dPos
)

375 
	gŞdS¹Pos
 = 
m_£ËùiÚS¹Pos
;

376 
	gŞdEndPos
 = 
m_£ËùiÚEndPos
;

379 
	gHashM­
<
	tR’d”Objeù
*, 
	tR’d”S–eùiÚInfo
*> 
	tS–eùedObjeùM­
;

380 
S–eùedObjeùM­
 
	gŞdS–eùedObjeùs
;

381 
S–eùedObjeùM­
 
	gÃwS–eùedObjeùs
;

386 
	gHashM­
<
	tR’d”Block
*, 
	tR’d”BlockS–eùiÚInfo
*> 
	tS–eùedBlockM­
;

387 
S–eùedBlockM­
 
	gŞdS–eùedBlocks
;

388 
S–eùedBlockM­
 
	gÃwS–eùedBlocks
;

390 
R’d”Objeù
* 
	gos
 = 
m_£ËùiÚS¹
;

391 
R’d”Objeù
* 
	g¡İ
 = 
»nd””Aá”Pos™iÚ
(
m_£ËùiÚEnd
, 
m_£ËùiÚEndPos
);

392 
	gos
 && o !ğ
¡İ
) {

393 ià((
os
->
ÿnBeS–eùiÚL—f
(è|| o =ğ
m_£ËùiÚS¹
 || o =ğ
m_£ËùiÚEnd
è&& os->
£ËùiÚS‹
(è!ğ
S–eùiÚNÚe
) {

395 
ŞdS–eùedObjeùs
.
£t
(
os
, 
Ãw
 
R’d”S–eùiÚInfo
(os, 
Œue
));

396 
R’d”Block
* 
	gcb
 = 
os
->
cÚššgBlock
();

397 
	gcb
 && !cb->
isR’d”V›w
()) {

398 
R’d”BlockS–eùiÚInfo
* 
	gblockInfo
 = 
ŞdS–eùedBlocks
.
g‘
(
cb
);

399 ià(
	gblockInfo
)

401 
	gŞdS–eùedBlocks
.
£t
(
cb
, 
Ãw
 
R’d”BlockS–eùiÚInfo
(cb));

402 
	gcb
 = 
cb
->
cÚššgBlock
();

406 
	gos
 = 
os
->
ÃxtInP»Ord”
();

410 
	gS–eùedObjeùM­
::
™”©Ü
 
ŞdObjeùsEnd
 = 
ŞdS–eùedObjeùs
.
’d
();

411 
	gS–eùedObjeùM­
::
™”©Ü
 
i
 = 
ŞdS–eùedObjeùs
.
begš
(); 
	gi
 !ğ
ŞdObjeùsEnd
; ++i)

412 
	gi
->
	gfœ¡
->
£tS–eùiÚS‹
(
S–eùiÚNÚe
);

415 
	gm_£ËùiÚS¹
 = 
¡¬t
;

416 
	gm_£ËùiÚS¹Pos
 = 
¡¬tPos
;

417 
	gm_£ËùiÚEnd
 = 
’d
;

418 
	gm_£ËùiÚEndPos
 = 
’dPos
;

421 ià(
	g¡¬t
 && s¹ =ğ
’d
)

422 
¡¬t
->
£tS–eùiÚS‹
(
S–eùiÚBÙh
);

424 ià(
	g¡¬t
)

425 
	g¡¬t
->
£tS–eùiÚS‹
(
S–eùiÚS¹
);

426 ià(
	g’d
)

427 
	g’d
->
£tS–eùiÚS‹
(
S–eùiÚEnd
);

430 
R’d”Objeù
* 
	go
 = 
¡¬t
;

431 
	g¡İ
 = 
»nd””Aá”Pos™iÚ
(
’d
, 
’dPos
);

433 
	go
 && o !ğ
¡İ
) {

434 ià(
o
 !ğ
¡¬t
 && o !ğ
’d
 && o->
ÿnBeS–eùiÚL—f
())

435 
o
->
£tS–eùiÚS‹
(
S–eùiÚInside
);

436 
	go
 = 
o
->
ÃxtInP»Ord”
();

439 
	gm_Ïy”
->
ş—rBlockS–eùiÚG­sBounds
();

443 
	go
 = 
¡¬t
;

444 
	go
 && o !ğ
¡İ
) {

445 ià((
o
->
ÿnBeS–eùiÚL—f
(è|| o =ğ
¡¬t
 || o =ğ
’d
è&& o->
£ËùiÚS‹
(è!ğ
S–eùiÚNÚe
) {

446 
ÃwS–eùedObjeùs
.
£t
(
o
, 
Ãw
 
R’d”S–eùiÚInfo
(o, 
Œue
));

447 
R’d”Block
* 
	gcb
 = 
o
->
cÚššgBlock
();

448 
	gcb
 && !cb->
isR’d”V›w
()) {

449 
R’d”BlockS–eùiÚInfo
* 
	gblockInfo
 = 
ÃwS–eùedBlocks
.
g‘
(
cb
);

450 ià(
	gblockInfo
)

452 
	gÃwS–eùedBlocks
.
£t
(
cb
, 
Ãw
 
R’d”BlockS–eùiÚInfo
(cb));

453 
	gcb
 = 
cb
->
cÚššgBlock
();

457 
	go
 = 
o
->
ÃxtInP»Ord”
();

460 ià(!
	gm_äameV›w
) {

463 
d–‘eAÎV®ues
(
ŞdS–eùedObjeùs
);

464 
d–‘eAÎV®ues
(
ÃwS–eùedObjeùs
);

465 
d–‘eAÎV®ues
(
ŞdS–eùedBlocks
);

466 
d–‘eAÎV®ues
(
ÃwS–eùedBlocks
);

470 
	gm_äameV›w
->
begšDeã¼edR•ašts
();

473 
	gS–eùedObjeùM­
::
™”©Ü
 
i
 = 
ŞdS–eùedObjeùs
.
begš
(); 
	gi
 !ğ
ŞdObjeùsEnd
; ++i) {

474 
R’d”Objeù
* 
	gobj
 = 
i
->
fœ¡
;

475 
R’d”S–eùiÚInfo
* 
	gÃwInfo
 = 
ÃwS–eùedObjeùs
.
g‘
(
obj
);

476 
R’d”S–eùiÚInfo
* 
	gŞdInfo
 = 
i
->
£cÚd
;

477 ià(!
	gÃwInfo
 || 
	gŞdInfo
->
»ù
(è!ğ
ÃwInfo
->»ù(è|| 
ŞdInfo
->
¡©e
() !=‚ewInfo->state() ||

478 (
m_£ËùiÚS¹
 =ğ
obj
 && 
ŞdS¹Pos
 !ğ
m_£ËùiÚS¹Pos
) ||

479 (
m_£ËùiÚEnd
 =ğ
obj
 && 
ŞdEndPos
 !ğ
m_£ËùiÚEndPos
)) {

480 
ŞdInfo
->
»·št
();

481 ià(
	gÃwInfo
) {

482 
	gÃwInfo
->
»·št
();

483 
	gÃwS–eùedObjeùs
.
»move
(
obj
);

484 
d–‘e
 
	gÃwInfo
;

487 
d–‘e
 
	gŞdInfo
;

491 
	gS–eùedObjeùM­
::
™”©Ü
 
ÃwObjeùsEnd
 = 
ÃwS–eùedObjeùs
.
’d
();

492 
	gS–eùedObjeùM­
::
™”©Ü
 
i
 = 
ÃwS–eùedObjeùs
.
begš
(); 
	gi
 !ğ
ÃwObjeùsEnd
; ++i) {

493 
R’d”S–eùiÚInfo
* 
	gÃwInfo
 = 
i
->
£cÚd
;

494 
	gÃwInfo
->
»·št
();

495 
d–‘e
 
	gÃwInfo
;

499 
	gS–eùedBlockM­
::
™”©Ü
 
ŞdBlocksEnd
 = 
ŞdS–eùedBlocks
.
’d
();

500 
	gS–eùedBlockM­
::
™”©Ü
 
i
 = 
ŞdS–eùedBlocks
.
begš
(); 
	gi
 !ğ
ŞdBlocksEnd
; ++i) {

501 
R’d”Block
* 
	gblock
 = 
i
->
fœ¡
;

502 
R’d”BlockS–eùiÚInfo
* 
	gÃwInfo
 = 
ÃwS–eùedBlocks
.
g‘
(
block
);

503 
R’d”BlockS–eùiÚInfo
* 
	gŞdInfo
 = 
i
->
£cÚd
;

504 ià(!
	gÃwInfo
 || 
	gŞdInfo
->
»ùs
(è!ğ
ÃwInfo
->»ùs(è|| 
ŞdInfo
->
¡©e
() !=‚ewInfo->state()) {

505 ià(
blockR•aštMode
 =ğ
R•aštNewXOROld
)

506 
ŞdInfo
->
»·št
();

507 ià(
	gÃwInfo
) {

508 
	gÃwInfo
->
»·št
();

509 
	gÃwS–eùedBlocks
.
»move
(
block
);

510 
d–‘e
 
	gÃwInfo
;

513 
d–‘e
 
	gŞdInfo
;

517 
	gS–eùedBlockM­
::
™”©Ü
 
ÃwBlocksEnd
 = 
ÃwS–eùedBlocks
.
’d
();

518 
	gS–eùedBlockM­
::
™”©Ü
 
i
 = 
ÃwS–eùedBlocks
.
begš
(); 
	gi
 !ğ
ÃwBlocksEnd
; ++i) {

519 
R’d”BlockS–eùiÚInfo
* 
	gÃwInfo
 = 
i
->
£cÚd
;

520 
	gÃwInfo
->
»·št
();

521 
d–‘e
 
	gÃwInfo
;

524 
	gm_äameV›w
->
’dDeã¼edR•ašts
();

527 
	gR’d”V›w
::
ş—rS–eùiÚ
()

529 
m_Ïy”
->
»·štBlockS–eùiÚG­s
();

530 
£tS–eùiÚ
(0, -1, 0, -1, 
R•aštNewMšusOld
);

533 
	gR’d”V›w
::
£ËùiÚS¹End
(& 
¡¬tPos
, & 
’dPos
) const

535 
	g¡¬tPos
 = 
m_£ËùiÚS¹Pos
;

536 
	g’dPos
 = 
m_£ËùiÚEndPos
;

539 
boŞ
 
	gR’d”V›w
::
´štšg
() const

541  
docum’t
()->
´štšg
();

544 
	gR’d”V›w
::
upd©eWidg‘Pos™iÚs
()

550 
size_t
 
size
 = 
m_widg‘s
.size();

552 
	gVeùÜ
<
	gR’d”Widg‘
*> 
	g»nd”Widg‘s
;

553 
	g»nd”Widg‘s
.
»£rveC­ac™y
(
size
);

555 
	gR’d”Widg‘S‘
::
cÚ¡_™”©Ü
 
’d
 = 
m_widg‘s
.end();

556 
	gR’d”Widg‘S‘
::
cÚ¡_™”©Ü
 
™
 = 
m_widg‘s
.
begš
(); 
	g™
 !ğ
’d
; ++it) {

557 
	g»nd”Widg‘s
.
uncheckedAµ’d
(*
™
);

558 (*
	g™
)->
»f
();

561 
size_t
 
	gi
 = 0; i < 
	gsize
; ++i)

562 
	g»nd”Widg‘s
[
i
]->
upd©eWidg‘Pos™iÚ
();

564 
size_t
 
	gi
 = 0; i < 
	gsize
; ++i)

565 
	g»nd”Widg‘s
[
i
]->
widg‘Pos™iÚsUpd©ed
();

567 
size_t
 
	gi
 = 0; i < 
	gsize
; ++i)

568 
	g»nd”Widg‘s
[
i
]->
d”ef
(
»nd”A»Ç
());

571 
	gR’d”V›w
::
addWidg‘
(
R’d”Widg‘
* 
o
)

573 
m_widg‘s
.
add
(
o
);

576 
	gR’d”V›w
::
»moveWidg‘
(
R’d”Widg‘
* 
o
)

578 
m_widg‘s
.
»move
(
o
);

581 
IÁReù
 
	gR’d”V›w
::
v›wReù
() const

583 ià(
´štšg
())

584  
IÁReù
(0, 0, 
width
(), 
height
());

585 ià(
	gm_äameV›w
)

586  
	gm_äameV›w
->
visibËCÚ‹ÁReù
();

587  
IÁReù
();

590 
	gR’d”V›w
::
docHeight
() const

592 
h
 = 
lowe¡Pos™iÚ
();

597 
	gdh
 = 0;

598 
R’d”Box
* 
	gc
 = 
fœ¡ChdBox
(); c; c = 
c
->
ÃxtSiblšgBox
())

599 
dh
 +ğ
c
->
height
(è+ c->
m¬gšTİ
(è+ c->
m¬gšBÙtom
();

601 ià(
	gdh
 > 
	gh
)

602 
	gh
 = 
dh
;

604  
	gh
;

607 
	gR’d”V›w
::
docWidth
() const

609 
w
 = 
rightmo¡Pos™iÚ
();

611 
R’d”Box
* 
	gc
 = 
fœ¡ChdBox
(); c; c = 
c
->
ÃxtSiblšgBox
()) {

612 
dw
 = 
c
->
width
(è+ c->
m¬gšLeá
(è+ c->
m¬gšRight
();

613 ià(
	gdw
 > 
	gw
)

614 
	gw
 = 
dw
;

617  
	gw
;

620 
	gR’d”V›w
::
v›wHeight
() const

622 
height
 = 0;

623 ià(!
´štšg
(è&& 
	gm_äameV›w
) {

624 
	gheight
 = 
m_äameV›w
->
ÏyoutHeight
();

625 
	gheight
 = 
m_äameV›w
->
u£FixedLayout
(è? 
ûf
(
¡yË
()->
efãùiveZoom
(è* (
height
)) : height;

627  
	gheight
;

630 
	gR’d”V›w
::
v›wWidth
() const

632 
width
 = 0;

633 ià(!
´štšg
(è&& 
	gm_äameV›w
) {

634 
	gwidth
 = 
m_äameV›w
->
ÏyoutWidth
();

635 
	gwidth
 = 
m_äameV›w
->
u£FixedLayout
(è? 
ûf
(
¡yË
()->
efãùiveZoom
(è* (
width
)) : width;

637  
	gwidth
;

640 
	gR’d”V›w
::
zoomFaùÜ
() const

642 ià(
m_äameV›w
->
äame
(è&& m_äameV›w->äame()->
shouldAµlyPageZoom
())

643  
m_äameV›w
->
äame
()->
zoomFaùÜ
();

650 
	gR’d”V›w
::
£tBe¡Trunÿ‹dAt
(
y
, 
R’d”BoxMod–Objeù
* 
fÜR’d””
, 
boŞ
 
fÜûdB»ak
)

653 ià(
	gm_fÜûdPageB»ak
)

657 ià(
	gfÜûdB»ak
) {

658 
	gm_fÜûdPageB»ak
 = 
Œue
;

659 
	gm_be¡Trunÿ‹dAt
 = 
y
;

664 
IÁReù
 
	gboundšgBox
 = 
fÜR’d””
->
bÜd”BoundšgBox
();

665 ià(
	gboundšgBox
.
width
(è> 
	gm_ŒunÿtÜWidth
) {

666 
	gm_ŒunÿtÜWidth
 = 
boundšgBox
.
width
();

667 
	gm_be¡Trunÿ‹dAt
 = 
y
;

671 
	gR’d”V›w
::
pushLayoutS‹
(
R’d”Objeù
* 
roÙ
)

673 
ASSERT
(!
došgFuÎR•ašt
());

674 
ASSERT
(
m_ÏyoutS‹Di§bËCouÁ
 == 0);

675 
ASSERT
(
m_ÏyoutS‹
 == 0);

677 
	gm_ÏyoutS‹
 = 
Ãw
 (
»nd”A»Ç
()è
LayoutS‹
(
roÙ
);

680 
boŞ
 
	gR’d”V›w
::
shouldDi§bËLayoutS‹FÜSubŒ“
(
R’d”Objeù
* 
»nd””
) const

682 
R’d”Objeù
* 
o
 = 
»nd””
;

683 
	go
) {

684 ià(
	go
->
hasCŞumns
(è|| o->
hasT¿nsfÜm
(è|| o->
hasReæeùiÚ
())

685  
	gŒue
;

686 
	go
 = 
o
->
cÚš”
();

688  
	gçl£
;

691 
	gR’d”V›w
::
upd©eH™Te¡ResuÉ
(
H™Te¡ResuÉ
& 
»suÉ
, cÚ¡ 
IÁPošt
& 
pošt
)

693 ià(
	g»suÉ
.
šÃrNode
())

696 
Node
* 
	gnode
 = 
docum’t
()->
docum’tEËm’t
();

697 ià(
	gnode
) {

698 
	g»suÉ
.
£tIÂ”Node
(
node
);

699 ià(!
	g»suÉ
.
šÃrNÚSh¬edNode
())

700 
	g»suÉ
.
£tIÂ”NÚSh¬edNode
(
node
);

701 
	g»suÉ
.
£tLoÿlPošt
(
pošt
);

705 #ià
USE
(
ACCELERATED_COMPOSITING
)

706 
boŞ
 
	gR’d”V›w
::
u£sCompos™šg
() const

708  
m_compos™Ü
 && m_compos™Ü->
šCompos™šgMode
();

711 
R’d”Lay”Compos™Ü
* 
	gR’d”V›w
::
compos™Ü
()

713 ià(!
m_compos™Ü
)

714 
m_compos™Ü
.
£t
(
Ãw
 
R’d”Lay”Compos™Ü
(
this
));

716  
	gm_compos™Ü
.
g‘
();

720 
	gR’d”V›w
::
didMoveOnsü“n
()

722 #ià
USE
(
ACCELERATED_COMPOSITING
)

723 ià(
m_compos™Ü
)

724 
m_compos™Ü
->
didMoveOnsü“n
();

728 
	gR’d”V›w
::
wlMoveOffsü“n
()

730 #ià
USE
(
ACCELERATED_COMPOSITING
)

731 ià(
m_compos™Ü
)

732 
m_compos™Ü
->
wlMoveOffsü“n
();

	@RenderView.h

22 #iâdeà
R’d”V›w_h


23 
	#R’d”V›w_h


	)

25 
	~"F¿meV›w.h
"

26 
	~"LayoutS‹.h
"

27 
	~"R’d”Block.h
"

28 
	~<wtf/OwnPŒ.h
>

30 
Çme¥aû
 
	gWebCÜe
 {

32 
şass
 
	gR’d”Widg‘
;

34 #ià
USE
(
ACCELERATED_COMPOSITING
)

35 
şass
 
	gR’d”Lay”Compos™Ü
;

38 şas 
	cR’d”V›w
 : 
public
 
R’d”Block
 {

39 
public
:

40 
R’d”V›w
(
Node
*, 
F¿meV›w
*);

41 
	gvœtu®
 ~
R’d”V›w
();

43 
vœtu®
 cÚ¡ * 
»nd”Name
() const {  "RenderView"; }

45 
vœtu®
 
boŞ
 
isR’d”V›w
(ècÚ¡ {  
	gŒue
; }

47 
vœtu®
 
Ïyout
();

48 
vœtu®
 
ÿlcWidth
();

49 
vœtu®
 
ÿlcHeight
();

50 
vœtu®
 
ÿlcP»fWidths
();

53 
v›wHeight
() const;

54 
v›wWidth
() const;

56 
zoomFaùÜ
() const;

58 
F¿meV›w
* 
äameV›w
(ècÚ¡ {  
	gm_äameV›w
; }

60 
vœtu®
 
compu‹ReùFÜR•ašt
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
IÁReù
&, 
boŞ
 
fixed
 = 
çl£
);

61 
vœtu®
 
»·štV›wReùªgË
(cÚ¡ 
IÁReù
&, 
boŞ
 
immedŸ‹
 = 
çl£
);

64 
vœtu®
 
»·štReùªgËInV›wAndCompos™edLay”s
(cÚ¡ 
IÁReù
&, 
boŞ
 
immedŸ‹
 = 
çl£
);

66 
vœtu®
 
·št
(
PaštInfo
&, 
tx
, 
ty
);

67 
vœtu®
 
·štBoxDecÜ©iÚs
(
PaštInfo
&, 
tx
, 
ty
);

69 
	eS–eùiÚR•aštMode
 { 
	gR•aštNewXOROld
, 
	gR•aštNewMšusOld
 };

70 
£tS–eùiÚ
(
R’d”Objeù
* 
¡¬t
, 
¡¬tPos
, R’d”Objeù* 
’d
, 
’dPos
, 
S–eùiÚR•aštMode
 = 
R•aštNewXOROld
);

71 
ş—rS–eùiÚ
();

72 
vœtu®
 
R’d”Objeù
* 
£ËùiÚS¹
(ècÚ¡ {  
	gm_£ËùiÚS¹
; }

73 
vœtu®
 
R’d”Objeù
* 
£ËùiÚEnd
(ècÚ¡ {  
	gm_£ËùiÚEnd
; }

75 
boŞ
 
´štšg
() const;

76 
£tPrštImages
(
boŞ
 
’abË
è{ 
	gm_´štImages
 =ƒnable; }

77 
boŞ
 
´štImages
(ècÚ¡ {  
	gm_´štImages
; }

78 
£tTrunÿ‹dAt
(
y
è{ 
	gm_Œunÿ‹dAt
 = y; 
	gm_be¡Trunÿ‹dAt
 = 
m_ŒunÿtÜWidth
 = 0; 
	gm_mšimumCŞumnHeight
 = 0; 
	gm_fÜûdPageB»ak
 = 
çl£
; }

79 
£tBe¡Trunÿ‹dAt
(
y
, 
R’d”BoxMod–Objeù
* 
fÜR’d””
, 
boŞ
 
fÜûdB»ak
 = 
çl£
);

80 
£tMšimumCŞumnHeight
(
height
è{ 
	gm_mšimumCŞumnHeight
 = height; }

81 
be¡Trunÿ‹dAt
(ècÚ¡ {  
	gm_be¡Trunÿ‹dAt
; }

82 
mšimumCŞumnHeight
(ècÚ¡ {  
	gm_mšimumCŞumnHeight
; }

84 
Œunÿ‹dAt
(ècÚ¡ {  
	gm_Œunÿ‹dAt
; }

86 
vœtu®
 
absŞu‹Reùs
(
VeùÜ
<
IÁReù
>&, 
tx
, 
ty
);

87 
vœtu®
 
absŞu‹Quads
(
VeùÜ
<
FlßtQuad
>&);

89 
IÁReù
 
£ËùiÚBounds
(
boŞ
 
şToVisibËCÚ‹Á
 = 
Œue
) const;

91 #ià
USE
(
ACCELERATED_COMPOSITING
)

92 
£tMaxim®OušeSize
(
o
);

94 
£tMaxim®OušeSize
(
o
è{ 
	gm_maxim®OušeSize
 = o; }

96 
maxim®OušeSize
(ècÚ¡ {  
	gm_maxim®OušeSize
; }

98 
vœtu®
 
IÁReù
 
v›wReù
() const;

100 
£ËùiÚS¹End
(& 
¡¬tPos
, & 
’dPos
) const;

102 
IÁReù
 
´štReù
(ècÚ¡ {  
	gm_´štReù
; }

103 
£tPrštReù
(cÚ¡ 
IÁReù
& 
r
è{ 
	gm_´štReù
 =„; }

105 
upd©eWidg‘Pos™iÚs
();

106 
addWidg‘
(
R’d”Widg‘
*);

107 
»moveWidg‘
(
R’d”Widg‘
*);

112 
IÁSize
 
ÏyoutD–
() const

114  
	gm_ÏyoutS‹
 ? m_ÏyoutS‹->
	gm_ÏyoutD–
 : 
IÁSize
();

116 
addLayoutD–
(cÚ¡ 
IÁSize
& 
d–
)

118 ià(
	gm_ÏyoutS‹
)

119 
	gm_ÏyoutS‹
->
	gm_ÏyoutD–
 +ğ
d–
;

122 
boŞ
 
došgFuÎR•ašt
(ècÚ¡ {  
	gm_äameV›w
->
ÃedsFuÎR•ašt
(); }

124 
pushLayoutS‹
(
R’d”Box
* 
»nd””
, cÚ¡ 
IÁSize
& 
off£t
)

126 ià(
došgFuÎR•ašt
())

129 
	gm_ÏyoutS‹
 = 
Ãw
 (
»nd”A»Ç
()è
LayoutS‹
(
m_ÏyoutS‹
, 
»nd””
, 
off£t
);

132 
pushLayoutS‹
(
R’d”Objeù
*);

134 
pİLayoutS‹
()

136 ià(
došgFuÎR•ašt
())

138 
LayoutS‹
* 
	g¡©e
 = 
m_ÏyoutS‹
;

139 
	gm_ÏyoutS‹
 = 
¡©e
->
m_Ãxt
;

140 
	g¡©e
->
de¡roy
(
»nd”A»Ç
());

143 
boŞ
 
shouldDi§bËLayoutS‹FÜSubŒ“
(
R’d”Objeù
*) const;

146 
boŞ
 
ÏyoutS‹EÇbËd
(ècÚ¡ {  
	gm_ÏyoutS‹Di§bËCouÁ
 =ğ0 && 
m_ÏyoutS‹
; }

147 
LayoutS‹
* 
ÏyoutS‹
(ècÚ¡ {  
	gm_ÏyoutS‹
; }

153 
di§bËLayoutS‹
(è{ 
	gm_ÏyoutS‹Di§bËCouÁ
++; }

154 
’abËLayoutS‹
(è{ 
ASSERT
(
m_ÏyoutS‹Di§bËCouÁ
 > 0); 
	gm_ÏyoutS‹Di§bËCouÁ
--; }

156 
vœtu®
 
upd©eH™Te¡ResuÉ
(
H™Te¡ResuÉ
&, cÚ¡ 
IÁPošt
&);

160 
didMoveOnsü“n
();

161 
wlMoveOffsü“n
();

163 #ià
USE
(
ACCELERATED_COMPOSITING
)

164 
R’d”Lay”Compos™Ü
* 
compos™Ü
();

165 
boŞ
 
u£sCompos™šg
() const;

168 
	g´Ùeùed
:

169 
vœtu®
 
m­LoÿlToCÚš”
(
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
boŞ
 
u£T¿nsfÜms
, boŞ 
fixed
, 
T¿nsfÜmS‹
&) const;

170 
vœtu®
 
m­AbsŞu‹ToLoÿlPošt
(
boŞ
 
fixed
, boŞ 
u£T¿nsfÜms
, 
T¿nsfÜmS‹
&) const;

172 
	g´iv©e
:

173 
boŞ
 
shouldR•ašt
(cÚ¡ 
IÁReù
& 
r
) const;

175 
docHeight
() const;

176 
docWidth
() const;

178 
	g´Ùeùed
:

179 
F¿meV›w
* 
m_äameV›w
;

181 
R’d”Objeù
* 
	gm_£ËùiÚS¹
;

182 
R’d”Objeù
* 
	gm_£ËùiÚEnd
;

183 
	gm_£ËùiÚS¹Pos
;

184 
	gm_£ËùiÚEndPos
;

187 
boŞ
 
	gm_´štImages
;

188 
	gm_Œunÿ‹dAt
;

190 
	gm_maxim®OušeSize
;

191 
IÁReù
 
	gm_´štReù
;

193 
	gHashS‘
<
	tR’d”Widg‘
*> 
	tR’d”Widg‘S‘
;

195 
R’d”Widg‘S‘
 
	gm_widg‘s
;

197 
	g´iv©e
:

198 
m_be¡Trunÿ‹dAt
;

199 
	gm_ŒunÿtÜWidth
;

200 
	gm_mšimumCŞumnHeight
;

201 
boŞ
 
	gm_fÜûdPageB»ak
;

202 
LayoutS‹
* 
	gm_ÏyoutS‹
;

203 
	gm_ÏyoutS‹Di§bËCouÁ
;

204 #ià
USE
(
ACCELERATED_COMPOSITING
)

205 
	gOwnPŒ
<
	gR’d”Lay”Compos™Ü
> 
	gm_compos™Ü
;

209 
šlše
 
R’d”V›w
* 
	$toR’d”V›w
(
R’d”Objeù
* 
objeù
)

211 
	`ASSERT
(!
objeù
 || objeù->
	`isR’d”V›w
());

212  
¡©ic_ÿ¡
<
R’d”V›w
*>(
objeù
);

213 
	}
}

215 
šlše
 cÚ¡ 
R’d”V›w
* 
	$toR’d”V›w
(cÚ¡ 
R’d”Objeù
* 
objeù
)

217 
	`ASSERT
(!
objeù
 || objeù->
	`isR’d”V›w
());

218  
¡©ic_ÿ¡
<cÚ¡ 
R’d”V›w
*>(
objeù
);

219 
	}
}

222 
toR’d”V›w
(cÚ¡ 
R’d”V›w
*);

226 şas 
	cLayoutS‹Mašš”
 : 
public
 
NÚcİyabË
 {

227 
public
:

229 
LayoutS‹Mašš”
(
R’d”V›w
* 
v›w
, 
R’d”Box
* 
roÙ
, 
IÁSize
 
off£t
, 
boŞ
 
di§bËS‹
 = 
çl£
)

230 : 
m_v›w
(
v›w
)

231 , 
m_di§bËd
(
di§bËS‹
)

232 , 
m_didS¹
(
çl£
)

233 , 
m_didEnd
(
çl£
)

235 
push
(
roÙ
, 
off£t
);

239 
LayoutS‹Mašš”
(
R’d”V›w
* 
v›w
)

240 : 
m_v›w
(
v›w
)

241 , 
m_di§bËd
(
çl£
)

242 , 
m_didS¹
(
çl£
)

243 , 
m_didEnd
(
çl£
)

247 ~
LayoutS‹Mašš”
()

249 
ASSERT
(
m_didS¹
 =ğ
m_didEnd
);

252 
push
(
R’d”Box
* 
roÙ
, 
IÁSize
 
off£t
)

254 
ASSERT
(!
m_didS¹
);

256 
	gm_v›w
->
pushLayoutS‹
(
roÙ
, 
off£t
);

257 ià(
	gm_di§bËd
)

258 
	gm_v›w
->
di§bËLayoutS‹
();

259 
	gm_didS¹
 = 
Œue
;

262 
pİ
()

264 ià(
	gm_didS¹
) {

265 
ASSERT
(!
m_didEnd
);

266 
	gm_v›w
->
pİLayoutS‹
();

267 ià(
	gm_di§bËd
)

268 
	gm_v›w
->
’abËLayoutS‹
();

269 
	gm_didEnd
 = 
Œue
;

273 
boŞ
 
didPush
(ècÚ¡ {  
	gm_didS¹
; }

275 
	g´iv©e
:

276 
R’d”V›w
* 
m_v›w
;

277 
boŞ
 
	gm_di§bËd
 : 1;

278 
boŞ
 
	gm_didS¹
 : 1;

279 
boŞ
 
	gm_didEnd
 : 1;

	@RenderWidget.cpp

23 
	~"cÚfig.h
"

24 
	~"R’d”Widg‘.h
"

26 
	~"AXObjeùCache.h
"

27 
	~"Anim©iÚCÚŒŞËr.h
"

28 
	~"G¿phicsCÚ‹xt.h
"

29 
	~"H™Te¡ResuÉ.h
"

30 
	~"R’d”V›w.h
"

31 
	~"R’d”Widg‘PrÙeùÜ.h
"

33 
usšg
 
Çme¥aû
 
	g¡d
;

35 
Çme¥aû
 
	gWebCÜe
 {

37 
	gHashM­
<cÚ¡ 
	gWidg‘
*, 
	gR’d”Widg‘
*>& 
widg‘R’d””M­
()

39 
	gHashM­
<cÚ¡ 
	gWidg‘
*, 
	gR’d”Widg‘
*>* 
	g¡©icWidg‘R’d””M­
 = 
Ãw
 
HashM­
<cÚ¡ 
Widg‘
*, RenderWidget*>;

40  *
	g¡©icWidg‘R’d””M­
;

43 
size_t
 
	gwidg‘H›¿rchyUpd©eSu¥’dCouÁ
;

45 
	gHashM­
<
	tRefPŒ
<
	tWidg‘
>, 
	tF¿meV›w
*> 
	tWidg‘ToP¬’tM­
;

47 
	gWidg‘ToP¬’tM­
& 
widg‘NewP¬’tM­
()

49 
DEFINE_STATIC_LOCAL
(
Widg‘ToP¬’tM­
, 
m­
, ());

50  
	gm­
;

53 
	gR’d”Widg‘
::
su¥’dWidg‘H›¿rchyUpd©es
()

55 
widg‘H›¿rchyUpd©eSu¥’dCouÁ
++;

58 
	gR’d”Widg‘
::
»sumeWidg‘H›¿rchyUpd©es
()

60 
ASSERT
(
widg‘H›¿rchyUpd©eSu¥’dCouÁ
);

61 ià(
	gwidg‘H›¿rchyUpd©eSu¥’dCouÁ
 == 1) {

62 
Widg‘ToP¬’tM­
 
m­
 = 
widg‘NewP¬’tM­
();

63 
widg‘NewP¬’tM­
().
ş—r
();

64 
	gWidg‘ToP¬’tM­
::
™”©Ü
 
’d
 = 
m­
.end();

65 
	gWidg‘ToP¬’tM­
::
™”©Ü
 
™
 = 
m­
.
begš
(); 
	g™
 !ğ
’d
; ++it) {

66 
Widg‘
* 
	gchd
 = 
™
->
fœ¡
.
g‘
();

67 
SüŞlV›w
* 
	gcu¼’tP¬’t
 = 
chd
->
·»Á
();

68 
F¿meV›w
* 
	gÃwP¬’t
 = 
™
->
£cÚd
;

69 ià(
	gÃwP¬’t
 !ğ
cu¼’tP¬’t
) {

70 ià(
cu¼’tP¬’t
)

71 
cu¼’tP¬’t
->
»moveChd
(
chd
);

72 ià(
	gÃwP¬’t
)

73 
	gÃwP¬’t
->
addChd
(
chd
);

77 
	gwidg‘H›¿rchyUpd©eSu¥’dCouÁ
--;

80 
moveWidg‘ToP¬’tSoÚ
(
Widg‘
* 
chd
, 
F¿meV›w
* 
·»Á
)

82 ià(!
	gwidg‘H›¿rchyUpd©eSu¥’dCouÁ
) {

83 ià(
	g·»Á
)

84 
	g·»Á
->
addChd
(
chd
);

86 
	gchd
->
»moveFromP¬’t
();

89 
widg‘NewP¬’tM­
().
£t
(
chd
, 
·»Á
);

92 
	gR’d”Widg‘
::
R’d”Widg‘
(
Node
* 
node
)

93 : 
R’d”R•Ïûd
(
node
)

94 , 
m_widg‘
(0)

95 , 
m_äameV›w
(
node
->
docum’t
()->
v›w
())

99 , 
m_»fCouÁ
(1)

101 
v›w
()->
addWidg‘
(
this
);

104 
	gR’d”Widg‘
::
de¡roy
()

112 
ªim©iÚ
()->
ÿnûlAnim©iÚs
(
this
);

114 ià(
R’d”V›w
* 
	gv
 = 
v›w
())

115 
v
->
»moveWidg‘
(
this
);

117 ià(
	gAXObjeùCache
::
acûssib™yEÇbËd
()) {

118 
docum’t
()->
axObjeùCache
()->
chd»nChªged
(
this
->
·»Á
());

119 
docum’t
()->
axObjeùCache
()->
»move
(
this
);

121 
»move
();

123 
£tWidg‘
(0);

126 ià(
hasOv”rideSize
())

127 
£tOv”rideSize
(-1);

129 ià(
¡yË
(è&& (¡yË()->
height
().
isP”ûÁ
(è|| styË()->
mšHeight
().isP”ûÁ(è|| styË()->
maxHeight
().isPercent()))

130 
	gR’d”Block
::
»moveP”ûÁHeightDesûndªt
(
this
);

132 ià(
hasLay”
()) {

133 
Ïy”
()->
ş—rClReùs
();

134 
£tHasLay”
(
çl£
);

135 
de¡royLay”
();

140 
R’d”A»Ç
* 
	g¬’a
 = 
»nd”A»Ç
();

141 
£tNode
(0);

142 
d”ef
(
¬’a
);

145 
	gR’d”Widg‘
::~
R’d”Widg‘
()

147 
ASSERT
(
m_»fCouÁ
 <= 0);

148 
ş—rWidg‘
();

151 
boŞ
 
	gR’d”Widg‘
::
£tWidg‘Geom‘ry
(cÚ¡ 
IÁReù
& 
äame
)

153 
ASSERT
(!
widg‘H›¿rchyUpd©eSu¥’dCouÁ
);

154 ià(!
node
())

155  
	gçl£
;

157 
IÁReù
 
	gşReù
 = 
’şosšgLay”
()->
chd»nClReù
();

158 
boŞ
 
	gşChªged
 = 
m_şReù
 !ğ
şReù
;

159 
boŞ
 
	gboundsChªged
 = 
m_widg‘
->
äameReù
(è!ğ
äame
;

161 ià(!
	gboundsChªged
 && !
	gşChªged
)

162  
	gçl£
;

164 
	gm_şReù
 = 
şReù
;

166 
R’d”Widg‘PrÙeùÜ
 
´ÙeùÜ
(
this
);

167 
	gRefPŒ
<
	gNode
> 
´ÙeùedNode
(
node
());

168 
	gm_widg‘
->
£tF¿meReù
(
äame
);

169  
	gboundsChªged
;

172 
	gR’d”Widg‘
::
£tWidg‘
(
PassRefPŒ
<
Widg‘
> 
widg‘
)

174 ià(
widg‘
 =ğ
m_widg‘
)

177 ià(
	gm_widg‘
) {

178 
moveWidg‘ToP¬’tSoÚ
(
m_widg‘
.
g‘
(), 0);

179 
widg‘R’d””M­
().
»move
(
m_widg‘
.
g‘
());

180 
ş—rWidg‘
();

182 
	gm_widg‘
 = 
widg‘
;

183 ià(
	gm_widg‘
) {

184 
widg‘R’d””M­
().
add
(
m_widg‘
.
g‘
(), 
this
);

188 ià(
¡yË
()) {

189 ià(!
ÃedsLayout
())

190 
£tWidg‘Geom‘ry
(
absŞu‹CÚ‹ÁBox
());

191 ià(
¡yË
()->
visib™y
(è!ğ
VISIBLE
)

192 
m_widg‘
->
hide
();

194 
	gm_widg‘
->
show
();

196 
moveWidg‘ToP¬’tSoÚ
(
m_widg‘
.
g‘
(), 
m_äameV›w
);

200 
	gR’d”Widg‘
::
Ïyout
()

202 
ASSERT
(
ÃedsLayout
());

204 
£tN“dsLayout
(
çl£
);

207 
	gR’d”Widg‘
::
¡yËDidChªge
(
StyËDifã»nû
 
diff
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
)

209 
	gR’d”R•Ïûd
::
¡yËDidChªge
(
diff
, 
ŞdStyË
);

210 ià(
	gm_widg‘
) {

211 ià(
¡yË
()->
visib™y
(è!ğ
VISIBLE
)

212 
m_widg‘
->
hide
();

214 
	gm_widg‘
->
show
();

218 
	gR’d”Widg‘
::
showSub¡™u‹Image
(
PassRefPŒ
<
Image
> 
´pImage
)

220 
m_sub¡™u‹Image
 = 
´pImage
;

221 
»·št
();

224 
	gR’d”Widg‘
::
·št
(
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

226 ià(!
shouldPašt
(
·štInfo
, 
tx
, 
ty
))

229 
	gtx
 +ğ
x
();

230 
	gty
 +ğ
y
();

232 ià(
hasBoxDecÜ©iÚs
(è&& (
	g·štInfo
.
	gpha£
 =ğ
PaštPha£FÜeground
 || 
·štInfo
.
pha£
 =ğ
PaštPha£S–eùiÚ
))

233 
·štBoxDecÜ©iÚs
(
·štInfo
, 
tx
, 
ty
);

235 ià(
	g·štInfo
.
	gpha£
 =ğ
PaštPha£Mask
) {

236 
·štMask
(
·štInfo
, 
tx
, 
ty
);

240 ià(!
	gm_äameV›w
 || 
	g·štInfo
.
	gpha£
 !ğ
PaštPha£FÜeground
 || 
¡yË
()->
visib™y
(è!ğ
VISIBLE
)

243 #ià
PLATFORM
(
MAC
)

244 ià(
¡yË
()->
highlight
(è!ğ
nuÎAtom
 && !
·štInfo
.
cÚ‹xt
->
·štšgDi§bËd
())

245 
·štCu¡omHighlight
(
tx
 - 
x
(), 
ty
 - 
y
(), 
¡yË
()->
highlight
(), 
Œue
);

248 ià(
¡yË
()->
hasBÜd”Radius
()) {

249 
IÁReù
 
	gbÜd”Reù
 = IÁReù(
tx
, 
ty
, 
width
(), 
height
());

251 ià(
	gbÜd”Reù
.
isEm±y
())

255 
	g·štInfo
.
	gcÚ‹xt
->
§ve
();

257 
IÁSize
 
	gtİLeá
, 
	gtİRight
, 
	gbÙtomLeá
, 
	gbÙtomRight
;

258 
¡yË
()->
g‘BÜd”RadiiFÜReù
(
bÜd”Reù
, 
tİLeá
, 
tİRight
, 
bÙtomLeá
, 
bÙtomRight
);

260 
	g·štInfo
.
	gcÚ‹xt
->
addRoundedReùCl
(
bÜd”Reù
, 
tİLeá
, 
tİRight
, 
bÙtomLeá
, 
bÙtomRight
);

263 ià(
	gm_widg‘
) {

266 ià(
	gm_sub¡™u‹Image
)

267 
	g·štInfo
.
	gcÚ‹xt
->
d¿wImage
(
m_sub¡™u‹Image
.
g‘
(), 
¡yË
()->
cŞÜS·û
(), 
m_widg‘
->
äameReù
());

269 
IÁPošt
 
	gwidg‘LoÿtiÚ
 = 
m_widg‘
->
äameReù
().
loÿtiÚ
();

270 
IÁPošt
 
·štLoÿtiÚ
(
tx
 + 
bÜd”Leá
(è+ 
·ddšgLeá
(), 
ty
 + 
bÜd”Tİ
(è+ 
·ddšgTİ
());

271 
IÁReù
 
	g·štReù
 = 
·štInfo
.
»ù
;

273 
IÁSize
 
	g·štOff£t
 = 
·štLoÿtiÚ
 - 
widg‘LoÿtiÚ
;

276 ià(!
	g·štOff£t
.
isZ”o
()) {

277 
	g·štInfo
.
	gcÚ‹xt
->
Œª¦©e
(
·štOff£t
);

278 
	g·štReù
.
move
(-
·štOff£t
);

280 
	gm_widg‘
->
·št
(
·štInfo
.
cÚ‹xt
, 
·štReù
);

282 ià(!
	g·štOff£t
.
isZ”o
())

283 
	g·štInfo
.
	gcÚ‹xt
->
Œª¦©e
(-
·štOff£t
);

285 ià(
	gm_widg‘
->
isF¿meV›w
(è&& 
	g·štInfo
.
	gov”ÏpTe¡Reque¡s
 && !
	g¡©ic_ÿ¡
<
	gF¿meV›w
*>(m_widg‘.
g‘
())->
u£SlowR•aštsIfNÙOv”Ïµed
()) {

286 
ASSERT
(!
·štInfo
.
ov”ÏpTe¡Reque¡s
->
cÚšs
(
this
));

287 
	g·štInfo
.
	gov”ÏpTe¡Reque¡s
->
£t
(
this
, 
m_widg‘
->
äameReù
());

291 ià(
¡yË
()->
hasBÜd”Radius
())

292 
	g·štInfo
.
	gcÚ‹xt
->
»¡Üe
();

295 ià(
isS–eùed
(è&& !
docum’t
()->
´štšg
()) {

297 
	g·štInfo
.
	gcÚ‹xt
->
flReù
(
£ËùiÚReù
(), 
£ËùiÚBackgroundCŞÜ
(), 
¡yË
()->
cŞÜS·û
());

301 
	gR’d”Widg‘
::
£tOv”ÏpTe¡ResuÉ
(
boŞ
 
isOv”Ïµed
)

303 
ASSERT
(
m_widg‘
);

304 
ASSERT
(
m_widg‘
->
isF¿meV›w
());

305 
	g¡©ic_ÿ¡
<
	gF¿meV›w
*>(
	gm_widg‘
.
g‘
())->
£tIsOv”Ïµed
(
isOv”Ïµed
);

308 
	gR’d”Widg‘
::
d”ef
(
R’d”A»Ç
 *
¬’a
)

310 ià(--
m_»fCouÁ
 <= 0)

311 
¬’aD–‘e
(
¬’a
, 
this
);

314 
	gR’d”Widg‘
::
upd©eWidg‘Pos™iÚ
()

316 ià(!
m_widg‘
 || !
node
())

320 
FlßtPošt
 
	gabsPos
 = 
loÿlToAbsŞu‹
();

321 
	gabsPos
.
move
(
bÜd”Leá
(è+ 
·ddšgLeá
(), 
bÜd”Tİ
(è+ 
·ddšgTİ
());

323 
	gw
 = 
width
(è- 
bÜd”Leá
(è- 
bÜd”Right
(è- 
·ddšgLeá
(è- 
·ddšgRight
();

324 
	gh
 = 
height
(è- 
bÜd”Tİ
(è- 
bÜd”BÙtom
(è- 
·ddšgTİ
(è- 
·ddšgBÙtom
();

326 
boŞ
 
	gboundsChªged
 = 
£tWidg‘Geom‘ry
(
IÁReù
(
absPos
.
x
(),‡bsPos.
y
(), 
w
, 
h
));

330 ià(
	gm_widg‘
->
isF¿meV›w
()) {

331 
F¿meV›w
* 
	gäameV›w
 = 
¡©ic_ÿ¡
<F¿meV›w*>(
m_widg‘
.
g‘
());

332 ià(
	gboundsChªged
 || 
	gäameV›w
->
ÃedsLayout
())

333 
	gäameV›w
->
Ïyout
();

337 
	gR’d”Widg‘
::
widg‘Pos™iÚsUpd©ed
()

339 ià(!
m_widg‘
)

341 
	gm_widg‘
->
widg‘Pos™iÚsUpd©ed
();

344 
IÁReù
 
	gR’d”Widg‘
::
wšdowClReù
() const

346 ià(!
m_äameV›w
)

347  
IÁReù
();

349  
š‹r£ùiÚ
(
m_äameV›w
->
cÚ‹ÁsToWšdow
(
m_şReù
), m_äameV›w->
wšdowClReù
());

352 
	gR’d”Widg‘
::
£tS–eùiÚS‹
(
S–eùiÚS‹
 
¡©e
)

354 ià(
£ËùiÚS‹
(è!ğ
¡©e
) {

355 
R’d”R•Ïûd
::
£tS–eùiÚS‹
(
¡©e
);

356 ià(
	gm_widg‘
)

357 
	gm_widg‘
->
£tIsS–eùed
(
isS–eùed
());

361 
	gR’d”Widg‘
::
ş—rWidg‘
()

363 
m_widg‘
 = 0;

366 
R’d”Widg‘
* 
	gR’d”Widg‘
::
fšd
(cÚ¡ 
Widg‘
* 
widg‘
)

368  
widg‘R’d””M­
().
g‘
(
widg‘
);

371 
boŞ
 
	gR’d”Widg‘
::
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
& 
»que¡
, 
H™Te¡ResuÉ
& 
»suÉ
, 
x
, 
y
, 
tx
, 
ty
, 
H™Te¡AùiÚ
 
aùiÚ
)

373 
boŞ
 
	ghadResuÉ
 = 
»suÉ
.
šÃrNode
();

374 
boŞ
 
	gšside
 = 
R’d”R•Ïûd
::
nodeAtPošt
(
»que¡
, 
»suÉ
, 
x
, 
y
, 
tx
, 
ty
, 
aùiÚ
);

377 ià(
	gšside
 && !
	ghadResuÉ
 && 
	g»suÉ
.
šÃrNode
(è=ğ
node
())

378 
»suÉ
.
£tIsOv”Widg‘
(
cÚ‹ÁBoxReù
().
cÚšs
ÔesuÉ.
loÿlPošt
()));

379  
	gšside
;

	@RenderWidget.h

22 #iâdeà
R’d”Widg‘_h


23 
	#R’d”Widg‘_h


	)

25 
	~"Ov”ÏpTe¡Reque¡Cl›Á.h
"

26 
	~"R’d”R•Ïûd.h
"

28 
Çme¥aû
 
	gWebCÜe
 {

30 
şass
 
	gWidg‘
;

32 
şass
 
	gR’d”Widg‘
 : 
public
 
R’d”R•Ïûd
, 
´iv©e
 
	gOv”ÏpTe¡Reque¡Cl›Á
 {

33 
	gpublic
:

34 
vœtu®
 ~
R’d”Widg‘
();

36 
Widg‘
* 
widg‘
(ècÚ¡ {  
	gm_widg‘
.
g‘
(); }

37 
vœtu®
 
£tWidg‘
(
PassRefPŒ
<
Widg‘
>);

39 
R’d”Widg‘
* 
fšd
(cÚ¡ 
Widg‘
*);

41 
upd©eWidg‘Pos™iÚ
();

42 
widg‘Pos™iÚsUpd©ed
();

43 
IÁReù
 
wšdowClReù
() const;

45 
showSub¡™u‹Image
(
PassRefPŒ
<
Image
>);

47 
su¥’dWidg‘H›¿rchyUpd©es
();

48 
»sumeWidg‘H›¿rchyUpd©es
();

50 
R’d”A»Ç
* 
»f
(è{ ++
	gm_»fCouÁ
;  
»nd”A»Ç
(); }

51 
d”ef
(
R’d”A»Ç
*);

53 
	g´Ùeùed
:

54 
R’d”Widg‘
(
Node
*);

56 
F¿meV›w
* 
äameV›w
(ècÚ¡ {  
	gm_äameV›w
; }

58 
ş—rWidg‘
();

60 
vœtu®
 
¡yËDidChªge
(
StyËDifã»nû
, cÚ¡ 
R’d”StyË
* 
ŞdStyË
);

61 
vœtu®
 
Ïyout
();

62 
vœtu®
 
·št
(
PaštInfo
&, 
x
, 
y
);

64 
	g´iv©e
:

65 
vœtu®
 
boŞ
 
isWidg‘
(ècÚ¡ {  
Œue
; }

67 
vœtu®
 
de¡roy
();

68 
vœtu®
 
£tS–eùiÚS‹
(
S–eùiÚS‹
);

69 
vœtu®
 
boŞ
 
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, 
x
, 
y
, 
tx
, 
ty
, 
H™Te¡AùiÚ
);

70 
vœtu®
 
£tOv”ÏpTe¡ResuÉ
(
boŞ
);

72 
boŞ
 
£tWidg‘Geom‘ry
(cÚ¡ 
IÁReù
&);

74 
	gRefPŒ
<
	gWidg‘
> 
	gm_widg‘
;

75 
	gRefPŒ
<
	gImage
> 
	gm_sub¡™u‹Image
;

76 
F¿meV›w
* 
	gm_äameV›w
;

77 
IÁReù
 
	gm_şReù
;

78 
	gm_»fCouÁ
;

81 
šlše
 
R’d”Widg‘
* 
toR’d”Widg‘
(
R’d”Objeù
* 
objeù
)

83 
ASSERT
(!
objeù
 || objeù->
isWidg‘
());

84  
	g¡©ic_ÿ¡
<
	gR’d”Widg‘
*>(
	gobjeù
);

87 
šlše
 cÚ¡ 
R’d”Widg‘
* 
toR’d”Widg‘
(cÚ¡ 
R’d”Objeù
* 
objeù
)

89 
ASSERT
(!
objeù
 || objeù->
isWidg‘
());

90  
	g¡©ic_ÿ¡
<cÚ¡ 
	gR’d”Widg‘
*>(
	gobjeù
);

94 
toR’d”Widg‘
(cÚ¡ 
R’d”Widg‘
*);

	@RenderWidgetProtector.h

26 #iâdeà
R’d”Widg‘PrÙeùÜ_h


27 
	#R’d”Widg‘PrÙeùÜ_h


	)

29 
	~"R’d”Widg‘.h
"

31 
Çme¥aû
 
	gWebCÜe
 {

33 şas 
	cR’d”Widg‘PrÙeùÜ
 : 
´iv©e
 
NÚcİyabË
 {

34 
public
:

35 
R’d”Widg‘PrÙeùÜ
(
R’d”Widg‘
* 
objeù
)

36 : 
m_objeù
(
objeù
)

37 , 
m_¬’a
(
objeù
->
»f
())

41 ~
R’d”Widg‘PrÙeùÜ
()

43 
	gm_objeù
->
d”ef
(
m_¬’a
);

46 
	g´iv©e
:

47 
R’d”Widg‘
* 
m_objeù
;

48 
R’d”A»Ç
* 
	gm_¬’a
;

	@RenderWordBreak.cpp

27 
	~"cÚfig.h
"

28 
	~"R’d”WÜdB»ak.h
"

30 
	~"HTMLEËm’t.h
"

32 
Çme¥aû
 
	gWebCÜe
 {

34 
	gR’d”WÜdB»ak
::
R’d”WÜdB»ak
(
HTMLEËm’t
* 
–em’t
)

35 : 
R’d”Text
(
–em’t
, 
SŒšgIm¶
::
em±y
())

39 cÚ¡ * 
R’d”WÜdB»ak
::
»nd”Name
() const

44 
boŞ
 
	gR’d”WÜdB»ak
::
isWÜdB»ak
() const

46  
Œue
;

	@RenderWordBreak.h

27 #iâdeà
R’d”WÜdB»ak_h


28 
	#R’d”WÜdB»ak_h


	)

30 
	~"R’d”Text.h
"

32 
Çme¥aû
 
	gWebCÜe
 {

34 
şass
 
	gHTMLEËm’t
;

36 şas 
	cR’d”WÜdB»ak
 : 
public
 
R’d”Text
 {

37 
public
:

38 
R’d”WÜdB»ak
(
HTMLEËm’t
*);

40 
vœtu®
 cÚ¡ * 
»nd”Name
() const;

41 
vœtu®
 
boŞ
 
isWÜdB»ak
() const;

	@RootInlineBox.cpp

20 
	~"cÚfig.h
"

21 
	~"RoÙIÆšeBox.h
"

23 
	~"BidiResŞv”.h
"

24 
	~"Chrome.h
"

25 
	~"ChromeCl›Á.h
"

26 
	~"Docum’t.h
"

27 
	~"EÎsisBox.h
"

28 
	~"F¿me.h
"

29 
	~"G¿phicsCÚ‹xt.h
"

30 
	~"H™Te¡ResuÉ.h
"

31 
	~"Page.h
"

32 
	~"R’d”A»Ç.h
"

33 
	~"R’d”Block.h
"

34 
	~"R’d”V›w.h
"

35 
	~"R’d”Lay”.h
"

37 
usšg
 
Çme¥aû
 
	g¡d
;

39 
Çme¥aû
 
	gWebCÜe
 {

41 
	gWTF
::
	tHashM­
<cÚ¡ 
	tRoÙIÆšeBox
*, 
	tEÎsisBox
*> 
	tEÎsisBoxM­
;

42 
EÎsisBoxM­
* 
	ggEÎsisBoxM­
 = 0;

44 
	gRoÙIÆšeBox
::
de¡roy
(
R’d”A»Ç
* 
¬’a
)

46 
d‘achEÎsisBox
(
¬’a
);

47 
	gIÆšeFlowBox
::
de¡roy
(
¬’a
);

50 
	gRoÙIÆšeBox
::
d‘achEÎsisBox
(
R’d”A»Ç
* 
¬’a
)

52 ià(
m_hasEÎsisBox
) {

53 
EÎsisBox
* 
box
 = 
gEÎsisBoxM­
->
ke
(
this
);

54 
	gbox
->
£tP¬’t
(0);

55 
	gbox
->
de¡roy
(
¬’a
);

56 
	gm_hasEÎsisBox
 = 
çl£
;

60 
R’d”LšeBoxLi¡
* 
	gRoÙIÆšeBox
::
»nd””LšeBoxes
() const

62  
block
()->
lšeBoxes
();

65 
	gRoÙIÆšeBox
::
ş—rTrunÿtiÚ
()

67 ià(
m_hasEÎsisBox
) {

68 
d‘achEÎsisBox
(
»nd””
()->
»nd”A»Ç
());

69 
	gIÆšeFlowBox
::
ş—rTrunÿtiÚ
();

73 
boŞ
 
	gRoÙIÆšeBox
::
ÿnAccommod©eEÎsis
(boŞ 
Ér
, 
blockEdge
, 
lšeBoxEdge
, 
–lsisWidth
)

76 
	gd–
 = 
Ér
 ? 
lšeBoxEdge
 - 
blockEdge
 : blockEdge -†ineBoxEdge;

77 ià(
width
(è- 
	gd–
 < 
	g–lsisWidth
)

78  
	gçl£
;

82  
	gIÆšeFlowBox
::
ÿnAccommod©eEÎsis
(
Ér
, 
blockEdge
, 
–lsisWidth
);

85 
	gRoÙIÆšeBox
::
¶aûEÎsis
(cÚ¡ 
AtomicSŒšg
& 
–lsisSŒ
, 
boŞ
 
Ér
, 
blockLeáEdge
, 
blockRightEdge
, 
–lsisWidth
,

86 
IÆšeBox
* 
m¬kupBox
)

89 
EÎsisBox
* 
	g–lsisBox
 = 
Ãw
 (
»nd””
()->
»nd”A»Ç
()èEÎsisBoxÔ’d””(), 
–lsisSŒ
, 
this
,

90 
–lsisWidth
 - (
m¬kupBox
 ? m¬kupBox->
width
(è: 0), 
height
(),

91 
y
(), !
´evRoÙBox
(),

92 
m¬kupBox
);

94 ià(!
	ggEÎsisBoxM­
)

95 
	ggEÎsisBoxM­
 = 
Ãw
 
EÎsisBoxM­
();

96 
	ggEÎsisBoxM­
->
add
(
this
, 
–lsisBox
);

97 
	gm_hasEÎsisBox
 = 
Œue
;

100 ià(
	gÉr
 && (
x
(è+ 
width
(è+ 
	g–lsisWidth
è<ğ
blockRightEdge
) {

101 
–lsisBox
->
m_x
 = 
x
(è+ 
width
();

108 
boŞ
 
	gfoundBox
 = 
çl£
;

109 
	g–lsisBox
->
	gm_x
 = 
¶aûEÎsisBox
(
Ér
, 
blockLeáEdge
, 
blockRightEdge
, 
–lsisWidth
, 
foundBox
);

112 
	gRoÙIÆšeBox
::
¶aûEÎsisBox
(
boŞ
 
Ér
, 
blockLeáEdge
, 
blockRightEdge
, 
–lsisWidth
, boŞ& 
foundBox
)

114 
	g»suÉ
 = 
IÆšeFlowBox
::
¶aûEÎsisBox
(
Ér
, 
blockLeáEdge
, 
blockRightEdge
, 
–lsisWidth
, 
foundBox
);

115 ià(
	g»suÉ
 == -1)

116 
»suÉ
 = 
Ér
 ? 
blockRightEdge
 - 
–lsisWidth
 : 
blockLeáEdge
;

117  
	g»suÉ
;

120 
	gRoÙIÆšeBox
::
·štEÎsisBox
(
R’d”Objeù
::
PaštInfo
& 
·štInfo
, 
tx
, 
ty
) const

122 ià(
	gm_hasEÎsisBox
 && 
»nd””
()->
shouldPaštW™hšRoÙ
(
·štInfo
è&&„’d””()->
¡yË
()->
visib™y
(è=ğ
VISIBLE
 &&

123 
·štInfo
.
pha£
 =ğ
PaštPha£FÜeground
)

124 
–lsisBox
()->
·št
(
·štInfo
, 
tx
, 
ty
);

127 #ià
PLATFORM
(
MAC
)

129 
	gRoÙIÆšeBox
::
addHighlightOv”æow
()

131 
F¿me
* 
äame
 = 
»nd””
()->
docum’t
()->frame();

132 ià(!
	gäame
)

134 
Page
* 
	g·ge
 = 
äame
->
·ge
();

135 ià(!
	g·ge
)

139 
FlßtReù
 
roÙReù
(0, 
£ËùiÚTİ
(), 
width
(), 
£ËùiÚHeight
());

140 
IÁReù
 
	gšæ©edReù
 = 
’şosšgIÁReù
(
·ge
->
chrome
()->
ş›Á
()->
cu¡omHighlightReù
(
»nd””
()->
node
(),„’d””()->
¡yË
()->
highlight
(), 
roÙReù
));

141 
£tHÜizÚlOv”æowPos™iÚs
(
ËáLayoutOv”æow
(), 
rightLayoutOv”æow
(), 
mš
(
ËáVisu®Ov”æow
(), 
šæ©edReù
.
x
()), 
max
(
rightVisu®Ov”æow
(), inæ©edReù.
right
()));

142 
£tV”tiÿlOv”æowPos™iÚs
(
tİLayoutOv”æow
(), 
bÙtomLayoutOv”æow
(), 
mš
(
tİVisu®Ov”æow
(), 
šæ©edReù
.
y
()), 
max
(
bÙtomVisu®Ov”æow
(), inæ©edReù.
bÙtom
()), 
height
());

145 
	gRoÙIÆšeBox
::
·štCu¡omHighlight
(
R’d”Objeù
::
PaštInfo
& 
·štInfo
, 
tx
, 
ty
, cÚ¡ 
AtomicSŒšg
& 
highlightTy³
)

147 ià(!
»nd””
()->
shouldPaštW™hšRoÙ
(
·štInfo
è||„’d””()->
¡yË
()->
visib™y
(è!ğ
VISIBLE
 ||…aštInfo.
pha£
 !ğ
PaštPha£FÜeground
)

150 
F¿me
* 
	gäame
 = 
»nd””
()->
docum’t
()->
äame
();

151 ià(!
	gäame
)

153 
Page
* 
	g·ge
 = 
äame
->
·ge
();

154 ià(!
	g·ge
)

158 
FlßtReù
 
roÙReù
(
tx
 + 
x
(), 
ty
 + 
£ËùiÚTİ
(), 
width
(), 
£ËùiÚHeight
());

159 
FlßtReù
 
	gšæ©edReù
 = 
·ge
->
chrome
()->
ş›Á
()->
cu¡omHighlightReù
(
»nd””
()->
node
(), 
highlightTy³
, 
roÙReù
);

160 ià(
	gšæ©edReù
.
š‹r£ùs
(
·štInfo
.
»ù
))

161 
	g·ge
->
chrome
()->
ş›Á
()->
·štCu¡omHighlight
(
»nd””
()->
node
(), 
highlightTy³
, 
roÙReù
,„oÙReù, 
çl£
, 
Œue
);

166 
	gRoÙIÆšeBox
::
·št
(
R’d”Objeù
::
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

168 
	gIÆšeFlowBox
::
·št
(
·štInfo
, 
tx
, 
ty
);

169 
·štEÎsisBox
(
·štInfo
, 
tx
, 
ty
);

170 #ià
PLATFORM
(
MAC
)

171 
R’d”StyË
* 
	g¡yËToU£
 = 
»nd””
()->
¡yË
(
m_fœ¡Lše
);

172 ià(
	g¡yËToU£
->
highlight
(è!ğ
nuÎAtom
 && !
·štInfo
.
cÚ‹xt
->
·štšgDi§bËd
())

173 
·štCu¡omHighlight
(
·štInfo
, 
tx
, 
ty
, 
¡yËToU£
->
highlight
());

177 
boŞ
 
	gRoÙIÆšeBox
::
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
& 
»que¡
, 
H™Te¡ResuÉ
& 
»suÉ
, 
x
, 
y
, 
tx
, 
ty
)

179 ià(
	gm_hasEÎsisBox
 && 
visibËToH™Te¡šg
()) {

180 ià(
–lsisBox
()->
nodeAtPošt
(
»que¡
, 
»suÉ
, 
x
, 
y
, 
tx
, 
ty
)) {

181 
»nd””
()->
upd©eH™Te¡ResuÉ
(
»suÉ
, 
IÁPošt
(
x
 - 
tx
, 
y
 - 
ty
));

182  
	gŒue
;

185  
	gIÆšeFlowBox
::
nodeAtPošt
(
»que¡
, 
»suÉ
, 
x
, 
y
, 
tx
, 
ty
);

188 
	gRoÙIÆšeBox
::
adju¡Pos™iÚ
(
dx
, 
dy
)

190 
	gIÆšeFlowBox
::
adju¡Pos™iÚ
(
dx
, 
dy
);

191 
	gm_lšeTİ
 +ğ
dy
;

192 
	gm_lšeBÙtom
 +ğ
dy
;

193 
	gm_blockHeight
 +ğ
dy
;

196 
	gRoÙIÆšeBox
::
chdRemoved
(
IÆšeBox
* 
box
)

198 ià(
box
->
»nd””
(è=ğ
m_lšeB»akObj
)

199 
£tLšeB»akInfo
(0, 0, 
BidiStus
());

201 
RoÙIÆšeBox
* 
	g´ev
 = 
´evRoÙBox
();…»v &&…»v->
lšeB»akObj
(è=ğ
box
->
»nd””
();…»v = 
´ev
->prevRootBox()) {

202 
´ev
->
£tLšeB»akInfo
(0, 0, 
BidiStus
());

203 
	g´ev
->
m¬kDœty
();

207 
	gRoÙIÆšeBox
::
v”tiÿÎyAlignBoxes
(
heightOfBlock
)

221 
maxPos™iÚTİ
 = 0;

222 
	gmaxPos™iÚBÙtom
 = 0;

223 
	gmaxAsûÁ
 = 0;

224 
	gmaxDesûÁ
 = 0;

228 
R’d”Objeù
* 
	gcu¼
 = 
»nd””
();

229 
	gcu¼
 && !cu¼->
node
())

230 
	gcu¼
 = 
cu¼
->
cÚš”
();

231 
boŞ
 
	g¡riùMode
 = (
cu¼
 && cu¼->
docum’t
()->
šSŒiùMode
());

233 
compu‹LogiÿlBoxHeights
(
maxPos™iÚTİ
, 
maxPos™iÚBÙtom
, 
maxAsûÁ
, 
maxDesûÁ
, 
¡riùMode
);

235 ià(
	gmaxAsûÁ
 + 
	gmaxDesûÁ
 < 
max
(
maxPos™iÚTİ
, 
maxPos™iÚBÙtom
))

236 
adju¡MaxAsûÁAndDesûÁ
(
maxAsûÁ
, 
maxDesûÁ
, 
maxPos™iÚTİ
, 
maxPos™iÚBÙtom
);

238 
	gmaxHeight
 = 
maxAsûÁ
 + 
maxDesûÁ
;

239 
	glšeTİ
 = 
heightOfBlock
;

240 
	glšeBÙtom
 = 
heightOfBlock
;

241 
¶aûBoxesV”tiÿÎy
(
heightOfBlock
, 
maxHeight
, 
maxAsûÁ
, 
¡riùMode
, 
lšeTİ
, 
lšeBÙtom
);

242 
compu‹V”tiÿlOv”æow
(
lšeTİ
, 
lšeBÙtom
, 
¡riùMode
);

243 
£tLšeTİBÙtomPos™iÚs
(
lšeTİ
, 
lšeBÙtom
);

245 
	gheightOfBlock
 +ğ
maxHeight
;

247  
	gheightOfBlock
;

250 
G­Reùs
 
	gRoÙIÆšeBox
::
flLšeS–eùiÚG­
(
£lTİ
, 
£lHeight
, 
R’d”Block
* 
roÙBlock
, 
blockX
, 
blockY
, 
tx
, 
ty
,

251 cÚ¡ 
R’d”Objeù
::
PaštInfo
* 
·štInfo
)

253 
R’d”Objeù
::
S–eùiÚS‹
 
lšeS‹
 = 
£ËùiÚS‹
();

255 
boŞ
 
	gËáG­
, 
	grightG­
;

256 
block
()->
g‘HÜizÚlS–eùiÚG­Info
(
lšeS‹
, 
ËáG­
, 
rightG­
);

258 
G­Reùs
 
	g»suÉ
;

260 
IÆšeBox
* 
	gfœ¡Box
 = 
fœ¡S–eùedBox
();

261 
IÆšeBox
* 
	gÏ¡Box
 = 
Ï¡S–eùedBox
();

262 ià(
	gËáG­
)

263 
	g»suÉ
.
un™eLeá
(
block
()->
flLeáS–eùiÚG­
(
fœ¡Box
->
·»Á
()->
»nd””
(),

264 
fœ¡Box
->
x
(), 
£lTİ
, 
£lHeight
,

265 
roÙBlock
, 
blockX
, 
blockY
, 
tx
, 
ty
, 
·štInfo
));

266 ià(
	grightG­
)

267 
	g»suÉ
.
un™eRight
(
block
()->
flRightS–eùiÚG­
(
Ï¡Box
->
·»Á
()->
»nd””
(),

268 
Ï¡Box
->
x
(è+†a¡Box->
width
(), 
£lTİ
, 
£lHeight
,

269 
roÙBlock
, 
blockX
, 
blockY
, 
tx
, 
ty
, 
·štInfo
));

278 ià(
	gfœ¡Box
 && fœ¡Box !ğ
Ï¡Box
) {

280 
Ï¡X
 = 
fœ¡Box
->
x
(è+ fœ¡Box->
width
();

281 
boŞ
 
	gisP»viousBoxS–eùed
 = 
fœ¡Box
->
£ËùiÚS‹
(è!ğ
R’d”Objeù
::
S–eùiÚNÚe
;

282 
IÆšeBox
* 
	gbox
 = 
fœ¡Box
->
ÃxtL—fChd
(); box; box = 
box
->nextLeafChild()) {

283 ià(
box
->
£ËùiÚS‹
(è!ğ
R’d”Objeù
::
S–eùiÚNÚe
) {

284 ià(
isP»viousBoxS–eùed
)

285 
»suÉ
.
un™eC’‹r
(
block
()->
flHÜizÚlS–eùiÚG­
(
box
->
·»Á
()->
»nd””
(),

286 
Ï¡X
 + 
tx
, 
£lTİ
 + 
ty
,

287 
box
->
x
(è- 
Ï¡X
, 
£lHeight
, 
·štInfo
));

288 
	gÏ¡X
 = 
box
->
x
(è+ box->
width
();

290 ià(
	gbox
 =ğ
Ï¡Box
)

292 
	gisP»viousBoxS–eùed
 = 
box
->
£ËùiÚS‹
(è!ğ
R’d”Objeù
::
S–eùiÚNÚe
;

296  
	g»suÉ
;

299 
	gRoÙIÆšeBox
::
£tHasS–eùedChd»n
(
boŞ
 
b
)

301 ià(
m_hasS–eùedChd»n
 =ğ
b
)

303 
	gm_hasS–eùedChd»n
 = 
b
;

306 
	gR’d”Objeù
::
S–eùiÚS‹
 
RoÙIÆšeBox
::
£ËùiÚS‹
()

309 
R’d”Objeù
::
S–eùiÚS‹
 
¡©e
 = R’d”Objeù::
S–eùiÚNÚe
;

310 
IÆšeBox
* 
	gbox
 = 
fœ¡L—fChd
(); box; box = 
box
->
ÃxtL—fChd
()) {

311 
R’d”Objeù
::
S–eùiÚS‹
 
boxS‹
 = 
box
->
£ËùiÚS‹
();

312 ià((
	gboxS‹
 =ğ
R’d”Objeù
::
S–eùiÚS¹
 && 
¡©e
 =ğR’d”Objeù::
S–eùiÚEnd
) ||

313 (
boxS‹
 =ğ
R’d”Objeù
::
S–eùiÚEnd
 && 
¡©e
 =ğR’d”Objeù::
S–eùiÚS¹
))

314 
¡©e
 = 
R’d”Objeù
::
S–eùiÚBÙh
;

315 ià(
	g¡©e
 =ğ
R’d”Objeù
::
S–eùiÚNÚe
 ||

316 ((
boxS‹
 =ğ
R’d”Objeù
::
S–eùiÚS¹
 || boxS‹ =ğR’d”Objeù::
S–eùiÚEnd
) &&

317 (
¡©e
 =ğ
R’d”Objeù
::
S–eùiÚNÚe
 || s‹ =ğR’d”Objeù::
S–eùiÚInside
)))

318 
¡©e
 = 
boxS‹
;

319 ià(
	g¡©e
 =ğ
R’d”Objeù
::
S–eùiÚBÙh
)

323  
	g¡©e
;

326 
IÆšeBox
* 
	gRoÙIÆšeBox
::
fœ¡S–eùedBox
()

328 
IÆšeBox
* 
box
 = 
fœ¡L—fChd
(); 
	gbox
; box = box->
ÃxtL—fChd
()) {

329 ià(
box
->
£ËùiÚS‹
(è!ğ
R’d”Objeù
::
S–eùiÚNÚe
)

330  
box
;

336 
IÆšeBox
* 
	gRoÙIÆšeBox
::
Ï¡S–eùedBox
()

338 
IÆšeBox
* 
box
 = 
Ï¡L—fChd
(); 
	gbox
; box = box->
´evL—fChd
()) {

339 ià(
box
->
£ËùiÚS‹
(è!ğ
R’d”Objeù
::
S–eùiÚNÚe
)

340  
box
;

346 
	gRoÙIÆšeBox
::
£ËùiÚTİ
() const

348 
£ËùiÚTİ
 = 
m_lšeTİ
;

349 ià(!
´evRoÙBox
())

350  
	g£ËùiÚTİ
;

352 
	g´evBÙtom
 = 
´evRoÙBox
()->
£ËùiÚBÙtom
();

353 ià(
	g´evBÙtom
 < 
	g£ËùiÚTİ
 && 
block
()->
cÚšsFlßts
()) {

357 
	g´evLeá
 = 
block
()->
ËáOff£t
(
´evBÙtom
, !
´evRoÙBox
());

358 
	g´evRight
 = 
block
()->
rightOff£t
(
´evBÙtom
, !
´evRoÙBox
());

359 
	gÃwLeá
 = 
block
()->
ËáOff£t
(
£ËùiÚTİ
, !
´evRoÙBox
());

360 
	gÃwRight
 = 
block
()->
rightOff£t
(
£ËùiÚTİ
, !
´evRoÙBox
());

361 ià(
	g´evLeá
 > 
	gÃwLeá
 || 
	g´evRight
 < 
	gÃwRight
)

362  
	g£ËùiÚTİ
;

365  
	g´evBÙtom
;

368 
R’d”Block
* 
	gRoÙIÆšeBox
::
block
() const

370  
toR’d”Block
(
»nd””
());

373 
boŞ
 
isEd™abËL—f
(
IÆšeBox
* 
Ëaf
)

375  
	gËaf
 &&†—f->
»nd””
(è&&†—f->»nd””()->
node
(è&&†—f->»nd””()->node()->
isCÚ‹ÁEd™abË
();

378 
IÆšeBox
* 
	gRoÙIÆšeBox
::
şo£¡L—fChdFÜXPos
(
x
, 
boŞ
 
ÚlyEd™abËL—ves
)

380 
IÆšeBox
* 
	gfœ¡L—f
 = 
fœ¡L—fChd
();

381 
IÆšeBox
* 
	gÏ¡L—f
 = 
Ï¡L—fChd
();

382 ià(
	gfœ¡L—f
 =ğ
Ï¡L—f
 && (!
ÚlyEd™abËL—ves
 || 
isEd™abËL—f
(
fœ¡L—f
)))

383  
fœ¡L—f
;

386 ià(
	gx
 <ğ
fœ¡L—f
->
m_x
 && !fœ¡L—f->
»nd””
()->
isLi¡M¬k”
(è&& (!
ÚlyEd™abËL—ves
 || 
isEd™abËL—f
(firstLeaf)))

389  
fœ¡L—f
;

391 ià(
	gx
 >ğ
Ï¡L—f
->
m_x
 +†a¡L—f->
m_width
 && !Ï¡L—f->
»nd””
()->
isLi¡M¬k”
(è&& (!
ÚlyEd™abËL—ves
 || 
isEd™abËL—f
(lastLeaf)))

394  
Ï¡L—f
;

396 
IÆšeBox
* 
	gşo£¡L—f
 = 0;

397 
IÆšeBox
* 
	gËaf
 = 
fœ¡L—f
;†—f;†—àğ
Ëaf
->
ÃxtL—fChd
()) {

398 ià(!
Ëaf
->
»nd””
()->
isLi¡M¬k”
(è&& (!
ÚlyEd™abËL—ves
 || 
isEd™abËL—f
(leaf))) {

399 
şo£¡L—f
 = 
Ëaf
;

400 ià(
	gx
 < 
	gËaf
->
	gm_x
 +†—f->
	gm_width
)

403  
	gËaf
;

407  
	gşo£¡L—f
 ? clo£¡L—à: 
Ï¡L—f
;

410 
BidiStus
 
	gRoÙIÆšeBox
::
lšeB»akBidiStus
() const

412  
BidiStus
(
m_lšeB»akBidiStusEÜ
, 
m_lšeB»akBidiStusLa¡SŒÚg
, 
m_lšeB»akBidiStusLa¡
, 
m_lšeB»akCÚ‹xt
);

415 
	gRoÙIÆšeBox
::
£tLšeB»akInfo
(
R’d”Objeù
* 
obj
, 
b»akPos
, cÚ¡ 
BidiStus
& 
¡©us
)

417 
	gm_lšeB»akObj
 = 
obj
;

418 
	gm_lšeB»akPos
 = 
b»akPos
;

419 
	gm_lšeB»akBidiStusEÜ
 = 
¡©us
.
eÜ
;

420 
	gm_lšeB»akBidiStusLa¡SŒÚg
 = 
¡©us
.
Ï¡SŒÚg
;

421 
	gm_lšeB»akBidiStusLa¡
 = 
¡©us
.
Ï¡
;

422 
	gm_lšeB»akCÚ‹xt
 = 
¡©us
.
cÚ‹xt
;

425 
EÎsisBox
* 
	gRoÙIÆšeBox
::
–lsisBox
() const

427 ià(!
m_hasEÎsisBox
)

428  
çl£
;

429  
	ggEÎsisBoxM­
->
g‘
(
this
);

432 
	gRoÙIÆšeBox
::
»moveLšeBoxFromR’d”Objeù
()

434 
block
()->
lšeBoxes
()->
»moveLšeBox
(
this
);

437 
	gRoÙIÆšeBox
::
exŒaùLšeBoxFromR’d”Objeù
()

439 
block
()->
lšeBoxes
()->
exŒaùLšeBox
(
this
);

442 
	gRoÙIÆšeBox
::
©chLšeBoxToR’d”Objeù
()

444 
block
()->
lšeBoxes
()->
©chLšeBox
(
this
);

	@RootInlineBox.h

21 #iâdeà
RoÙIÆšeBox_h


22 
	#RoÙIÆšeBox_h


	)

24 
	~"BidiCÚ‹xt.h
"

25 
	~"IÆšeFlowBox.h
"

27 
Çme¥aû
 
	gWebCÜe
 {

29 
şass
 
	gEÎsisBox
;

30 
şass
 
	gH™Te¡ResuÉ
;

32 
	gBidiStus
;

33 
	gG­Reùs
;

35 şas 
	cRoÙIÆšeBox
 : 
public
 
IÆšeFlowBox
 {

36 
public
:

37 
RoÙIÆšeBox
(
R’d”Objeù
* 
obj
)

38 : 
IÆšeFlowBox
(
obj
)

39 , 
m_lšeB»akObj
(0)

40 , 
m_lšeB»akPos
(0)

41 , 
m_lšeTİ
(0)

42 , 
m_lšeBÙtom
(0)

46 
vœtu®
 
de¡roy
(
R’d”A»Ç
*);

48 
vœtu®
 
boŞ
 
isRoÙIÆšeBox
(ècÚ¡ {  
	gŒue
; }

50 
d‘achEÎsisBox
(
R’d”A»Ç
*);

52 
RoÙIÆšeBox
* 
ÃxtRoÙBox
(ècÚ¡ {  
	g¡©ic_ÿ¡
<
	gRoÙIÆšeBox
*>(
	gm_ÃxtLšeBox
); }

53 
RoÙIÆšeBox
* 
´evRoÙBox
(ècÚ¡ {  
	g¡©ic_ÿ¡
<
	gRoÙIÆšeBox
*>(
	gm_´evLšeBox
); }

55 
vœtu®
 
adju¡Pos™iÚ
(
dx
, 
dy
);

57 
lšeTİ
(ècÚ¡ {  
	gm_lšeTİ
; }

58 
lšeBÙtom
(ècÚ¡ {  
	gm_lšeBÙtom
; }

60 
£ËùiÚTİ
() const;

61 
£ËùiÚBÙtom
(ècÚ¡ {  
lšeBÙtom
(); }

62 
£ËùiÚHeight
(ècÚ¡ {  
max
(0, 
£ËùiÚBÙtom
(è- 
£ËùiÚTİ
()); }

64 
vœtu®
 
v”tiÿÎyAlignBoxes
(
heightOfBlock
);

65 
£tLšeTİBÙtomPos™iÚs
(
tİ
, 
bÙtom
);

67 
vœtu®
 
R’d”LšeBoxLi¡
* 
»nd””LšeBoxes
() const;

69 #ià
ENABLE
(
SVG
)

70 
vœtu®
 
compu‹P”Ch¬aù”LayoutInfÜm©iÚ
() { }

73 
R’d”Objeù
* 
lšeB»akObj
(ècÚ¡ {  
	gm_lšeB»akObj
; }

74 
BidiStus
 
lšeB»akBidiStus
() const;

75 
£tLšeB»akInfo
(
R’d”Objeù
*, 
b»akPos
, cÚ¡ 
BidiStus
&);

77 
lšeB»akPos
(ècÚ¡ {  
	gm_lšeB»akPos
; }

78 
£tLšeB»akPos
(
p
è{ 
	gm_lšeB»akPos
 =…; }

80 
blockHeight
(ècÚ¡ {  
	gm_blockHeight
; }

81 
£tBlockHeight
(
h
è{ 
	gm_blockHeight
 = h; }

83 
boŞ
 
’dsW™hB»ak
(ècÚ¡ {  
	gm_’dsW™hB»ak
; }

84 
£tEndsW™hB»ak
(
boŞ
 
b
è{ 
	gm_’dsW™hB»ak
 = b; }

86 
chdRemoved
(
IÆšeBox
* 
box
);

88 
boŞ
 
ÿnAccommod©eEÎsis
(boŞ 
Ér
, 
blockEdge
, 
lšeBoxEdge
, 
–lsisWidth
);

89 
¶aûEÎsis
(cÚ¡ 
AtomicSŒšg
& 
–lsisSŒ
, 
boŞ
 
Ér
, 
blockLeáEdge
, 
blockRightEdge
, 
–lsisWidth
, 
IÆšeBox
* 
m¬kupBox
 = 0);

90 
vœtu®
 
¶aûEÎsisBox
(
boŞ
 
Ér
, 
blockLeáEdge
, 
blockRightEdge
, 
–lsisWidth
, boŞ& 
foundBox
);

92 
EÎsisBox
* 
–lsisBox
() const;

94 
·štEÎsisBox
(
R’d”Objeù
::
PaštInfo
&, 
tx
, 
ty
) const;

95 
boŞ
 
h™Te¡EÎsisBox
(
H™Te¡ResuÉ
&, 
x
, 
y
, 
tx
, 
ty
, 
H™Te¡AùiÚ
, bool);

97 
vœtu®
 
ş—rTrunÿtiÚ
();

99 #ià
PLATFORM
(
MAC
)

100 
addHighlightOv”æow
();

101 
·štCu¡omHighlight
(
R’d”Objeù
::
PaštInfo
&, 
tx
, 
ty
, cÚ¡ 
AtomicSŒšg
& 
highlightTy³
);

104 
vœtu®
 
·št
(
R’d”Objeù
::
PaštInfo
&, 
tx
, 
ty
);

105 
vœtu®
 
boŞ
 
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, , , , );

107 
boŞ
 
hasS–eùedChd»n
(ècÚ¡ {  
	gm_hasS–eùedChd»n
; }

108 
£tHasS–eùedChd»n
(
boŞ
);

110 
vœtu®
 
	gR’d”Objeù
::
S–eùiÚS‹
 
£ËùiÚS‹
();

111 
IÆšeBox
* 
fœ¡S–eùedBox
();

112 
IÆšeBox
* 
Ï¡S–eùedBox
();

114 
G­Reùs
 
flLšeS–eùiÚG­
(
£lTİ
, 
£lHeight
, 
R’d”Block
* 
roÙBlock
, 
blockX
, 
blockY
,

115 
tx
, 
ty
, cÚ¡ 
R’d”Objeù
::
PaštInfo
*);

117 
R’d”Block
* 
block
() const;

119 
IÆšeBox
* 
şo£¡L—fChdFÜXPos
(
x
, 
boŞ
 
ÚlyEd™abËL—ves
 = 
çl£
);

121 
	gVeùÜ
<
	gR’d”Box
*>& 
æßts
()

123 
ASSERT
(!
isDœty
());

124 ià(!
	gm_æßts
)

125 
	gm_æßts
.
£t
(
Ãw
 
VeùÜ
<
R’d”Box
*>());

126  *
	gm_æßts
;

129 
	gVeùÜ
<
	gR’d”Box
*>* 
æßtsPŒ
(è{ 
ASSERT
(!
isDœty
());  
	gm_æßts
.
g‘
(); }

131 
vœtu®
 
exŒaùLšeBoxFromR’d”Objeù
();

132 
vœtu®
 
©chLšeBoxToR’d”Objeù
();

133 
vœtu®
 
»moveLšeBoxFromR’d”Objeù
();

135 
	g´Ùeùed
:

138 
R’d”Objeù
* 
m_lšeB»akObj
;

139 
	gm_lšeB»akPos
;

140 
	gRefPŒ
<
	gBidiCÚ‹xt
> 
	gm_lšeB»akCÚ‹xt
;

142 
	gm_lšeTİ
;

143 
	gm_lšeBÙtom
;

147 
	gOwnPŒ
<
	gVeùÜ
<
	gR’d”Box
*> > 
	gm_æßts
;

150 
	gm_blockHeight
;

152 
	gWTF
::
Unicode
::
DœeùiÚ
 
m_lšeB»akBidiStusEÜ
 : 5;

153 
	gWTF
::
Unicode
::
DœeùiÚ
 
m_lšeB»akBidiStusLa¡SŒÚg
 : 5;

154 
	gWTF
::
Unicode
::
DœeùiÚ
 
m_lšeB»akBidiStusLa¡
 : 5;

157 
šlše
 
	gRoÙIÆšeBox
::
	$£tLšeTİBÙtomPos™iÚs
(
tİ
, 
bÙtom
)

159 
m_lšeTİ
 = 
tİ
;

160 
m_lšeBÙtom
 = 
bÙtom
;

161 
	}
}

	@SVGCharacterLayoutInfo.cpp

23 
	~"cÚfig.h
"

25 #ià
ENABLE
(
SVG
)

26 
	~"SVGCh¬aù”LayoutInfo.h
"

28 
	~"IÆšeFlowBox.h
"

29 
	~"IÆšeTextBox.h
"

30 
	~"SVGL’gthLi¡.h
"

31 
	~"SVGNumb”Li¡.h
"

32 
	~"SVGTextPos™iÚšgEËm’t.h
"

33 
	~"R’d”SVGTextP©h.h
"

35 
	~<æßt.h
>

37 
Çme¥aû
 
	gWebCÜe
 {

40 
ÿlcuÏ‹Ba£lšeShiá
(
R’d”Objeù
* 
™em
)

42 cÚ¡ 
	gFÚt
& 
	gfÚt
 = 
™em
->
¡yË
()->
fÚt
();

43 cÚ¡ 
SVGR’d”StyË
* 
	gsvgStyË
 = 
™em
->
¡yË
()->
svgStyË
();

45 
	gba£lšeShiá
 = 0.0f;

46 ià(
	gsvgStyË
->
ba£lšeShiá
(è=ğ
BS_LENGTH
) {

47 
CSSPrim™iveV®ue
* 
´im™ive
 = 
¡©ic_ÿ¡
<CSSPrim™iveV®ue*>(
svgStyË
->
ba£lšeShiáV®ue
());

48 
	gba£lšeShiá
 = 
´im™ive
->
g‘FlßtV®ue
();

50 ià(
	g´im™ive
->
´im™iveTy³
(è=ğ
CSSPrim™iveV®ue
::
CSS_PERCENTAGE
)

51 
ba£lšeShiá
 = ba£lšeShiá / 100.0à* 
fÚt
.
pix–Size
();

53 
	gba£lšeAsûÁ
 = 
fÚt
.
asûÁ
(è+ fÚt.
desûÁ
();

55 
	gsvgStyË
->
ba£lšeShiá
()) {

56 
	gBS_BASELINE
:

58 
	gBS_SUB
:

59 
ba£lšeShiá
 = -
ba£lšeAsûÁ
 / 2.0f;

61 
	gBS_SUPER
:

62 
ba£lšeShiá
 = 
ba£lšeAsûÁ
 / 2.0f;

65 
ASSERT_NOT_REACHED
();

69  
	gba£lšeShiá
;

72 
	gSVGCh¬aù”LayoutInfo
::
SVGCh¬aù”LayoutInfo
(
VeùÜ
<
SVGCh¬
>& 
ch¬s
)

73 : 
curx
(0.0f)

74 , 
cury
(0.0f)

75 , 
ªgË
(0.0f)

76 , 
dx
(0.0f)

77 , 
dy
(0.0f)

78 , 
shiáx
(0.0f)

79 , 
shiáy
(0.0f)

80 , 
·thExŒaAdvªû
(0.0f)

81 , 
·thTextL’gth
(0.0f)

82 , 
·thChunkL’gth
(0.0f)

83 , 
svgCh¬s
(
ch¬s
)

84 , 
ÃxtD¿wnS•”©ed
(
çl£
)

85 , 
xSckChªged
(
çl£
)

86 , 
ySckChªged
(
çl£
)

87 , 
dxSckChªged
(
çl£
)

88 , 
dySckChªged
(
çl£
)

89 , 
ªgËSckChªged
(
çl£
)

90 , 
ba£lšeShiáSckChªged
(
çl£
)

91 , 
·thLayout
(
çl£
)

92 , 
cu¼’tOff£t
(0.0f)

93 , 
¡¬tOff£t
(0.0f)

94 , 
ÏyoutP©hL’gth
(0.0f)

98 
boŞ
 
	gSVGCh¬aù”LayoutInfo
::
xV®ueAvaabË
() const

100  
xSck
.
isEm±y
(è? 
çl£
 : xSck.
Ï¡
().
pos™iÚ
(è< xSck.Ï¡().
size
();

103 
boŞ
 
	gSVGCh¬aù”LayoutInfo
::
yV®ueAvaabË
() const

105  
ySck
.
isEm±y
(è? 
çl£
 : ySck.
Ï¡
().
pos™iÚ
(è< ySck.Ï¡().
size
();

108 
boŞ
 
	gSVGCh¬aù”LayoutInfo
::
dxV®ueAvaabË
() const

110  
dxSck
.
isEm±y
(è? 
çl£
 : dxSck.
Ï¡
().
pos™iÚ
(è< dxSck.Ï¡().
size
();

113 
boŞ
 
	gSVGCh¬aù”LayoutInfo
::
dyV®ueAvaabË
() const

115  
dySck
.
isEm±y
(è? 
çl£
 : dySck.
Ï¡
().
pos™iÚ
(è< dySck.Ï¡().
size
();

118 
boŞ
 
	gSVGCh¬aù”LayoutInfo
::
ªgËV®ueAvaabË
() const

120  
ªgËSck
.
isEm±y
(è? 
çl£
 :‡ngËSck.
Ï¡
().
pos™iÚ
(è<‡ngËSck.Ï¡().
size
();

123 
boŞ
 
	gSVGCh¬aù”LayoutInfo
::
ba£lšeShiáV®ueAvaabË
() const

125  !
ba£lšeShiáSck
.
isEm±y
();

128 
	gSVGCh¬aù”LayoutInfo
::
xV®ueNext
() const

130 
ASSERT
(!
xSck
.
isEm±y
());

131  
	gxSck
.
Ï¡
().
v®ueAtCu¼’tPos™iÚ
();

134 
	gSVGCh¬aù”LayoutInfo
::
yV®ueNext
() const

136 
ASSERT
(!
ySck
.
isEm±y
());

137  
	gySck
.
Ï¡
().
v®ueAtCu¼’tPos™iÚ
();

140 
	gSVGCh¬aù”LayoutInfo
::
dxV®ueNext
() const

142 
ASSERT
(!
dxSck
.
isEm±y
());

143  
	gdxSck
.
Ï¡
().
v®ueAtCu¼’tPos™iÚ
();

146 
	gSVGCh¬aù”LayoutInfo
::
dyV®ueNext
() const

148 
ASSERT
(!
dySck
.
isEm±y
());

149  
	gdySck
.
Ï¡
().
v®ueAtCu¼’tPos™iÚ
();

152 
	gSVGCh¬aù”LayoutInfo
::
ªgËV®ueNext
() const

154 
ASSERT
(!
ªgËSck
.
isEm±y
());

155  
	gªgËSck
.
Ï¡
().
v®ueAtCu¼’tPos™iÚ
();

158 
	gSVGCh¬aù”LayoutInfo
::
ba£lšeShiáV®ueNext
() const

160 
ASSERT
(!
ba£lšeShiáSck
.
isEm±y
());

161  
	gba£lšeShiáSck
.
Ï¡
();

164 
	gSVGCh¬aù”LayoutInfo
::
´oûs£dSšgËCh¬aù”
()

166 
xSckW®k
();

167 
ySckW®k
();

168 
dxSckW®k
();

169 
dySckW®k
();

170 
ªgËSckW®k
();

171 
ba£lšeShiáSckW®k
();

174 
	gSVGCh¬aù”LayoutInfo
::
´oûs£dChunk
(
§vedShiáX
, 
§vedShiáY
)

177 
	gcurx
 +ğ
§vedShiáX
 - 
shiáx
;

178 
	gcury
 +ğ
§vedShiáY
 - 
shiáy
;

180 ià(
šP©hLayout
()) {

181 
	gshiáx
 = 
§vedShiáX
;

182 
	gshiáy
 = 
§vedShiáY
;

186 
	gªgË
 = 0.0f;

188 ià(
	gxSckChªged
) {

189 
ASSERT
(!
xSck
.
isEm±y
());

190 
	gxSck
.
»moveLa¡
();

191 
	gxSckChªged
 = 
çl£
;

194 ià(
	gySckChªged
) {

195 
ASSERT
(!
ySck
.
isEm±y
());

196 
	gySck
.
»moveLa¡
();

197 
	gySckChªged
 = 
çl£
;

200 ià(
	gdxSckChªged
) {

201 
ASSERT
(!
dxSck
.
isEm±y
());

202 
	gdxSck
.
»moveLa¡
();

203 
	gdxSckChªged
 = 
çl£
;

206 ià(
	gdySckChªged
) {

207 
ASSERT
(!
dySck
.
isEm±y
());

208 
	gdySck
.
»moveLa¡
();

209 
	gdySckChªged
 = 
çl£
;

212 ià(
	gªgËSckChªged
) {

213 
ASSERT
(!
ªgËSck
.
isEm±y
());

214 
	gªgËSck
.
»moveLa¡
();

215 
	gªgËSckChªged
 = 
çl£
;

218 ià(
	gba£lšeShiáSckChªged
) {

219 
ASSERT
(!
ba£lšeShiáSck
.
isEm±y
());

220 
	gba£lšeShiáSck
.
»moveLa¡
();

221 
	gba£lšeShiáSckChªged
 = 
çl£
;

225 
boŞ
 
	gSVGCh¬aù”LayoutInfo
::
ÃxtP©hLayoutPoštAndAngË
(
glyphAdvªû
, 
exŒaAdvªû
, 
ÃwOff£t
)

227 ià(
	gÏyoutP©hL’gth
 <= 0.0f)

228  
çl£
;

230 ià(
	gÃwOff£t
 !ğ
FLT_MIN
)

231 
cu¼’tOff£t
 = 
¡¬tOff£t
 + 
ÃwOff£t
;

234 
	gcu¼’tOff£t
 +ğ
exŒaAdvªû
;

236 
	goff£t
 = 
cu¼’tOff£t
 + 
glyphAdvªû
 / 2.0f;

237 
	gcu¼’tOff£t
 +ğ
glyphAdvªû
 + 
·thExŒaAdvªû
;

239 ià(
	goff£t
 < 0.0à|| off£ˆ> 
	gÏyoutP©hL’gth
)

240  
	gçl£
;

242 
boŞ
 
	gok
 = 
çl£
;

243 
FlßtPošt
 
	gpošt
 = 
ÏyoutP©h
.
poštAtL’gth
(
off£t
, 
ok
);

244 
ASSERT
(
ok
);

246 
	gcurx
 = 
pošt
.
x
();

247 
	gcury
 = 
pošt
.
y
();

249 
	gªgË
 = 
ÏyoutP©h
.
nÜm®AngËAtL’gth
(
off£t
, 
ok
);

250 
ASSERT
(
ok
);

253  
	gŒue
;

256 
boŞ
 
	gSVGCh¬aù”LayoutInfo
::
šP©hLayout
() const

258  
·thLayout
;

261 
	gSVGCh¬aù”LayoutInfo
::
£tInP©hLayout
(
boŞ
 
v®ue
)

263 
·thLayout
 = 
v®ue
;

265 
	g·thExŒaAdvªû
 = 0.0f;

266 
	g·thTextL’gth
 = 0.0f;

267 
	g·thChunkL’gth
 = 0.0f;

270 
	gSVGCh¬aù”LayoutInfo
::
addLayoutInfÜm©iÚ
(
IÆšeFlowBox
* 
æowBox
, 
‹xtAnchÜS¹Off£t
)

272 
boŞ
 
	gisIn™ŸlLayout
 = 
xSck
.
isEm±y
(è&& 
ySck
.isEmpty() &&

273 
dxSck
.
isEm±y
(è&& 
dySck
.isEmpty() &&

274 
ªgËSck
.
isEm±y
(è&& 
ba£lšeShiáSck
.isEmpty() &&

275 
curx
 =ğ0.0à&& 
cury
 == 0.0f;

277 
R’d”SVGTextP©h
* 
	g‹xtP©h
 = 
toR’d”SVGTextP©h
(
æowBox
->
»nd””
());

278 
P©h
 
	g·th
 = 
‹xtP©h
->
ÏyoutP©h
();

280 
	gba£lšeShiá
 = 
ÿlcuÏ‹Ba£lšeShiá
(
‹xtP©h
);

282 
	gÏyoutP©h
 = 
·th
;

283 
	gÏyoutP©hL’gth
 = 
·th
.
Ëngth
();

285 ià(
	gÏyoutP©hL’gth
 <= 0.0f)

288 
	g¡¬tOff£t
 = 
‹xtP©h
->
¡¬tOff£t
();

290 ià(
	g‹xtP©h
->
¡¬tOff£t
(è>ğ0.0à&& 
‹xtP©h
->startOffset() <= 1.0f)

291 
¡¬tOff£t
 *ğ
ÏyoutP©hL’gth
;

293 
	g¡¬tOff£t
 +ğ
‹xtAnchÜS¹Off£t
;

294 
	gcu¼’tOff£t
 = 
¡¬tOff£t
;

297 
addSckCÚ‹Á
(
Ba£lšeShiáSck
, 
ba£lšeShiá
);

299 ià(
	gisIn™ŸlLayout
) {

300 
	gxSckChªged
 = 
çl£
;

301 
	gySckChªged
 = 
çl£
;

302 
	gdxSckChªged
 = 
çl£
;

303 
	gdySckChªged
 = 
çl£
;

304 
	gªgËSckChªged
 = 
çl£
;

305 
	gba£lšeShiáSckChªged
 = 
çl£
;

309 
	gSVGCh¬aù”LayoutInfo
::
addLayoutInfÜm©iÚ
(
SVGTextPos™iÚšgEËm’t
* 
–em’t
)

311 
boŞ
 
isIn™ŸlLayout
 = 
xSck
.
isEm±y
(è&& 
ySck
.isEmpty() &&

312 
dxSck
.
isEm±y
(è&& 
dySck
.isEmpty() &&

313 
ªgËSck
.
isEm±y
(è&& 
ba£lšeShiáSck
.isEmpty() &&

314 
curx
 =ğ0.0à&& 
cury
 == 0.0f;

316 
	gba£lšeShiá
 = 
ÿlcuÏ‹Ba£lšeShiá
(
–em’t
->
»nd””
());

318 
addSckCÚ‹Á
(
XSck
, 
–em’t
->
x
(),ƒlement);

319 
addSckCÚ‹Á
(
YSck
, 
–em’t
->
y
(),ƒlement);

320 
addSckCÚ‹Á
(
DxSck
, 
–em’t
->
dx
(),ƒlement);

321 
addSckCÚ‹Á
(
DySck
, 
–em’t
->
dy
(),ƒlement);

322 
addSckCÚ‹Á
(
AngËSck
, 
–em’t
->
rÙ©e
());

323 
addSckCÚ‹Á
(
Ba£lšeShiáSck
, 
ba£lšeShiá
);

325 ià(
	gisIn™ŸlLayout
) {

326 
	gxSckChªged
 = 
çl£
;

327 
	gySckChªged
 = 
çl£
;

328 
	gdxSckChªged
 = 
çl£
;

329 
	gdySckChªged
 = 
çl£
;

330 
	gªgËSckChªged
 = 
çl£
;

331 
	gba£lšeShiáSckChªged
 = 
çl£
;

335 
	gSVGCh¬aù”LayoutInfo
::
addSckCÚ‹Á
(
SckTy³
 
ty³
, 
SVGNumb”Li¡
* 
li¡
)

337 
	gËngth
 = 
li¡
->
numb”OfI‹ms
();

338 ià(!
	gËngth
)

341 
Pos™iÚedFlßtVeùÜ
 
	gÃwLayoutInfo
;

344 
Exû±iÚCode
 
	gec
 = 0;

345 
	gi
 = 0; i < 
	gËngth
; ++i) {

346 
	gv®ue
 = 
li¡
->
g‘I‹m
(
i
, 
ec
);

347 
ASSERT
(
ec
 == 0);

349 
	gÃwLayoutInfo
.
­³nd
(
v®ue
);

352 
addSckCÚ‹Á
(
ty³
, 
ÃwLayoutInfo
);

355 
	gSVGCh¬aù”LayoutInfo
::
addSckCÚ‹Á
(
SckTy³
 
ty³
, 
SVGL’gthLi¡
* 
li¡
, cÚ¡ 
SVGEËm’t
* 
cÚ‹xt
)

357 
	gËngth
 = 
li¡
->
numb”OfI‹ms
();

358 ià(!
	gËngth
)

361 
Pos™iÚedFlßtVeùÜ
 
	gÃwLayoutInfo
;

363 
Exû±iÚCode
 
	gec
 = 0;

364 
	gi
 = 0; i < 
	gËngth
; ++i) {

365 
	gv®ue
 = 
li¡
->
g‘I‹m
(
i
, 
ec
).
v®ue
(
cÚ‹xt
);

366 
ASSERT
(
ec
 == 0);

368 
	gÃwLayoutInfo
.
­³nd
(
v®ue
);

371 
addSckCÚ‹Á
(
ty³
, 
ÃwLayoutInfo
);

374 
	gSVGCh¬aù”LayoutInfo
::
addSckCÚ‹Á
(
SckTy³
 
ty³
, cÚ¡ 
Pos™iÚedFlßtVeùÜ
& 
li¡
)

376 
	gty³
) {

377 
	gXSck
:

378 
xSckChªged
 = 
Œue
;

379 
	gxSck
.
­³nd
(
li¡
);

381 
	gYSck
:

382 
ySckChªged
 = 
Œue
;

383 
	gySck
.
­³nd
(
li¡
);

385 
	gDxSck
:

386 
dxSckChªged
 = 
Œue
;

387 
	gdxSck
.
­³nd
(
li¡
);

389 
	gDySck
:

390 
dySckChªged
 = 
Œue
;

391 
	gdySck
.
­³nd
(
li¡
);

393 
	gAngËSck
:

394 
ªgËSckChªged
 = 
Œue
;

395 
	gªgËSck
.
­³nd
(
li¡
);

398 
ASSERT_NOT_REACHED
();

402 
	gSVGCh¬aù”LayoutInfo
::
addSckCÚ‹Á
(
SckTy³
 
ty³
, 
v®ue
)

404 ià(
	gv®ue
 == 0.0f)

407 
	gty³
) {

408 
	gBa£lšeShiáSck
:

409 
ba£lšeShiáSckChªged
 = 
Œue
;

410 
	gba£lšeShiáSck
.
­³nd
(
v®ue
);

413 
ASSERT_NOT_REACHED
();

417 
	gSVGCh¬aù”LayoutInfo
::
xSckW®k
()

419 
i
 = 1;

421 !
	gxSck
.
isEm±y
()) {

422 
	gPos™iÚedFlßtVeùÜ
& 
	gcur
 = 
xSck
.
Ï¡
();

423 ià(
	gi
 + 
	gcur
.
pos™iÚ
(è< cur.
size
()) {

424 
	gcur
.
advªû
(
i
);

428 
	gi
 +ğ
cur
.
pos™iÚ
();

429 
	gxSck
.
»moveLa¡
();

430 
	gxSckChªged
 = 
çl£
;

434 
	gSVGCh¬aù”LayoutInfo
::
ySckW®k
()

436 
i
 = 1;

438 !
	gySck
.
isEm±y
()) {

439 
	gPos™iÚedFlßtVeùÜ
& 
	gcur
 = 
ySck
.
Ï¡
();

440 ià(
	gi
 + 
	gcur
.
pos™iÚ
(è< cur.
size
()) {

441 
	gcur
.
advªû
(
i
);

445 
	gi
 +ğ
cur
.
pos™iÚ
();

446 
	gySck
.
»moveLa¡
();

447 
	gySckChªged
 = 
çl£
;

451 
	gSVGCh¬aù”LayoutInfo
::
dxSckW®k
()

453 
i
 = 1;

455 !
	gdxSck
.
isEm±y
()) {

456 
	gPos™iÚedFlßtVeùÜ
& 
	gcur
 = 
dxSck
.
Ï¡
();

457 ià(
	gi
 + 
	gcur
.
pos™iÚ
(è< cur.
size
()) {

458 
	gcur
.
advªû
(
i
);

462 
	gi
 +ğ
cur
.
pos™iÚ
();

463 
	gdxSck
.
»moveLa¡
();

464 
	gdxSckChªged
 = 
çl£
;

468 
	gSVGCh¬aù”LayoutInfo
::
dySckW®k
()

470 
i
 = 1;

472 !
	gdySck
.
isEm±y
()) {

473 
	gPos™iÚedFlßtVeùÜ
& 
	gcur
 = 
dySck
.
Ï¡
();

474 ià(
	gi
 + 
	gcur
.
pos™iÚ
(è< cur.
size
()) {

475 
	gcur
.
advªû
(
i
);

479 
	gi
 +ğ
cur
.
pos™iÚ
();

480 
	gdySck
.
»moveLa¡
();

481 
	gdySckChªged
 = 
çl£
;

485 
	gSVGCh¬aù”LayoutInfo
::
ªgËSckW®k
()

487 
i
 = 1;

489 !
	gªgËSck
.
isEm±y
()) {

490 
	gPos™iÚedFlßtVeùÜ
& 
	gcur
 = 
ªgËSck
.
Ï¡
();

491 ià(
	gi
 + 
	gcur
.
pos™iÚ
(è< cur.
size
()) {

492 
	gcur
.
advªû
(
i
);

496 
	gi
 +ğ
cur
.
pos™iÚ
();

497 
	gªgËSck
.
»moveLa¡
();

498 
	gªgËSckChªged
 = 
çl£
;

502 
	gSVGCh¬aù”LayoutInfo
::
ba£lšeShiáSckW®k
()

504 ià(!
ba£lšeShiáSck
.
isEm±y
()) {

505 
ba£lšeShiáSck
.
»moveLa¡
();

506 
	gba£lšeShiáSckChªged
 = 
çl£
;

510 
boŞ
 
	gSVGCh¬
::
isHidd’
() const

512  
·thD©a
 &&…©hD©a->
hidd’
;

515 
AffšeT¿nsfÜm
 
	gSVGCh¬
::
ch¬aù”T¿nsfÜm
() const

517 
AffšeT¿nsfÜm
 
ùm
;

520 
	gùm
.
Œª¦©e
(
x
, 
y
);

521 
	gùm
.
rÙ©e
(
ªgË
);

523 ià(
	g·thD©a
) {

524 
	gùm
.
sÿËNÚUnifÜm
(
·thD©a
->
xSÿË
,…©hD©a->
ySÿË
);

525 
	gùm
.
Œª¦©e
(
·thD©a
->
xShiá
,…©hD©a->
yShiá
);

526 
	gùm
.
rÙ©e
(
·thD©a
->
Ü›Á©iÚAngË
);

529 
	gùm
.
Œª¦©e
(
Ü›Á©iÚShiáX
 - 
x
, 
Ü›Á©iÚShiáY
 - 
y
);

530  
	gùm
;

	@SVGCharacterLayoutInfo.h

23 #iâdeà
SVGCh¬aù”LayoutInfo_h


24 
	#SVGCh¬aù”LayoutInfo_h


	)

26 #ià
ENABLE
(
SVG
)

27 
	~"AffšeT¿nsfÜm.h
"

28 
	~"SVGR’d”StyË.h
"

29 
	~"SVGTextCÚ‹ÁEËm’t.h
"

31 
	~<wtf/As£¹iÚs.h
>

32 
	~<wtf/HashM­.h
>

33 
	~<wtf/HashS‘.h
>

34 
	~<wtf/RefCouÁed.h
>

35 
	~<wtf/VeùÜ.h
>

37 
Çme¥aû
 
	gWebCÜe
 {

39 
şass
 
	gIÆšeBox
;

40 
şass
 
	gIÆšeFlowBox
;

41 
şass
 
	gSVGIÆšeTextBox
;

42 
şass
 
	gSVGL’gthLi¡
;

43 
şass
 
	gSVGNumb”Li¡
;

44 
şass
 
	gSVGTextPos™iÚšgEËm’t
;

46 
	g‹m¶©e
<
şass
 
	gTy³
>

47 
şass
 
	gPos™iÚedVeùÜ
 : 
public
 
VeùÜ
<
Ty³
> {

48 
public
:

49 
Pos™iÚedVeùÜ
<
Ty³
>()

50 : 
m_pos™iÚ
(0)

54 
pos™iÚ
() const

56  
m_pos™iÚ
;

59 
advªû
(
pos™iÚ
)

61 
	gm_pos™iÚ
 +ğ
pos™iÚ
;

62 
ASSERT
(
m_pos™iÚ
 < 
VeùÜ
<
Ty³
>::
size
());

65 
Ty³
 
v®ueAtCu¼’tPos™iÚ
() const

67 
ASSERT
(
m_pos™iÚ
 < 
VeùÜ
<
Ty³
>::
size
());

68  
	gVeùÜ
<
	gTy³
>::
©
(
m_pos™iÚ
);

71 
	g´iv©e
:

72 
m_pos™iÚ
;

75 
şass
 
	gPos™iÚedFlßtVeùÜ
 : 
public
 
Pos™iÚedVeùÜ
<> { };

76 
	gSVGCh¬
;

78 
	sSVGCh¬aù”LayoutInfo
 {

79 
SVGCh¬aù”LayoutInfo
(
VeùÜ
<
SVGCh¬
>&);

81 
	eSckTy³
 { 
	gXSck
, 
	gYSck
, 
	gDxSck
, 
	gDySck
, 
	gAngËSck
, 
	gBa£lšeShiáSck
 };

83 
boŞ
 
xV®ueAvaabË
() const;

84 
boŞ
 
yV®ueAvaabË
() const;

85 
boŞ
 
dxV®ueAvaabË
() const;

86 
boŞ
 
dyV®ueAvaabË
() const;

87 
boŞ
 
ªgËV®ueAvaabË
() const;

88 
boŞ
 
ba£lšeShiáV®ueAvaabË
() const;

90 
xV®ueNext
() const;

91 
yV®ueNext
() const;

92 
dxV®ueNext
() const;

93 
dyV®ueNext
() const;

94 
ªgËV®ueNext
() const;

95 
ba£lšeShiáV®ueNext
() const;

97 
´oûs£dChunk
(
§vedShiáX
, 
§vedShiáY
);

98 
´oûs£dSšgËCh¬aù”
();

100 
boŞ
 
ÃxtP©hLayoutPoštAndAngË
(
glyphAdvªû
, 
exŒaAdvªû
, 
ÃwOff£t
);

103 
addLayoutInfÜm©iÚ
(
IÆšeFlowBox
*, 
‹xtAnchÜOff£t
 = 0.0f);

105 
boŞ
 
šP©hLayout
() const;

106 
£tInP©hLayout
(
boŞ
 
v®ue
);

109 
addLayoutInfÜm©iÚ
(
SVGTextPos™iÚšgEËm’t
*);

112 
	gcurx
;

113 
	gcury
;

116 
	gªgË
;

119 
	gdx
;

120 
	gdy
;

123 
	gshiáx
;

124 
	gshiáy
;

127 
	g·thExŒaAdvªû
;

128 
	g·thTextL’gth
;

129 
	g·thChunkL’gth
;

132 
	gVeùÜ
<
	gSVGCh¬
>& 
	gsvgCh¬s
;

133 
boŞ
 
	gÃxtD¿wnS•”©ed
 : 1;

135 
	g´iv©e
:

137 
addSckCÚ‹Á
(
SckTy³
, );

140 
addSckCÚ‹Á
(
SckTy³
, 
SVGNumb”Li¡
*);

143 
addSckCÚ‹Á
(
SckTy³
, 
SVGL’gthLi¡
*, cÚ¡ 
SVGEËm’t
*);

145 
addSckCÚ‹Á
(
SckTy³
, cÚ¡ 
Pos™iÚedFlßtVeùÜ
&);

147 
xSckW®k
();

148 
ySckW®k
();

149 
dxSckW®k
();

150 
dySckW®k
();

151 
ªgËSckW®k
();

152 
ba£lšeShiáSckW®k
();

154 
	g´iv©e
:

155 
boŞ
 
xSckChªged
 : 1;

156 
boŞ
 
	gySckChªged
 : 1;

157 
boŞ
 
	gdxSckChªged
 : 1;

158 
boŞ
 
	gdySckChªged
 : 1;

159 
boŞ
 
	gªgËSckChªged
 : 1;

160 
boŞ
 
	gba£lšeShiáSckChªged
 : 1;

163 
boŞ
 
	g·thLayout
 : 1;

164 
	gcu¼’tOff£t
;

165 
	g¡¬tOff£t
;

166 
	gÏyoutP©hL’gth
;

167 
P©h
 
	gÏyoutP©h
;

169 
	gVeùÜ
<
	gPos™iÚedFlßtVeùÜ
> 
	gxSck
;

170 
	gVeùÜ
<
	gPos™iÚedFlßtVeùÜ
> 
	gySck
;

171 
	gVeùÜ
<
	gPos™iÚedFlßtVeùÜ
> 
	gdxSck
;

172 
	gVeùÜ
<
	gPos™iÚedFlßtVeùÜ
> 
	gdySck
;

173 
	gVeùÜ
<
	gPos™iÚedFlßtVeùÜ
> 
	gªgËSck
;

174 
	gVeùÜ
<> 
	gba£lšeShiáSck
;

178 
	gSVGCh¬OnP©h
 : 
RefCouÁed
<
SVGCh¬OnP©h
> {

179 
PassRefPŒ
<
SVGCh¬OnP©h
> 
ü—‹
(è{  
adİtRef
(
Ãw
 SVGCharOnPath); }

181 
	gxSÿË
;

182 
	gySÿË
;

184 
	gxShiá
;

185 
	gyShiá
;

187 
	gÜ›Á©iÚAngË
;

189 
boŞ
 
	ghidd’
 : 1;

191 
	g´iv©e
:

192 
SVGCh¬OnP©h
()

193 : 
xSÿË
(1.0f)

194 , 
ySÿË
(1.0f)

195 , 
xShiá
(0.0f)

196 , 
yShiá
(0.0f)

197 , 
Ü›Á©iÚAngË
(0.0f)

198 , 
hidd’
(
çl£
)

203 
	sSVGCh¬
 {

204 
SVGCh¬
()

205 : 
x
(0.0f)

206 , 
y
(0.0f)

207 , 
ªgË
(0.0f)

208 , 
Ü›Á©iÚShiáX
(0.0f)

209 , 
Ü›Á©iÚShiáY
(0.0f)

210 , 
·thD©a
()

211 , 
d¿wnS•”©ed
(
çl£
)

212 , 
ÃwTextChunk
(
çl£
)

216 ~
SVGCh¬
()

220 
	gx
;

221 
	gy
;

222 
	gªgË
;

224 
	gÜ›Á©iÚShiáX
;

225 
	gÜ›Á©iÚShiáY
;

227 
	gRefPŒ
<
	gSVGCh¬OnP©h
> 
	g·thD©a
;

230 
boŞ
 
	gd¿wnS•”©ed
 : 1;

233 
boŞ
 
	gÃwTextChunk
 : 1;

236 
boŞ
 
isHidd’
() const;

237 
AffšeT¿nsfÜm
 
ch¬aù”T¿nsfÜm
() const;

240 
	sSVGIÆšeBoxCh¬aù”Rªge
 {

241 
SVGIÆšeBoxCh¬aù”Rªge
()

242 : 
¡¬tOff£t
(
INT_MIN
)

243 , 
’dOff£t
(
INT_MIN
)

244 , 
box
(0)

248 
boŞ
 
isO³n
(ècÚ¡ {  (
	g¡¬tOff£t
 =ğ
’dOff£t
è&& (’dOff£ˆ=ğ
INT_MIN
); }

249 
boŞ
 
isClo£d
(ècÚ¡ {  
	g¡¬tOff£t
 !ğ
INT_MIN
 && 
’dOff£t
 != INT_MIN; }

251 
	g¡¬tOff£t
;

252 
	g’dOff£t
;

254 
IÆšeBox
* 
	gbox
;

258 
	gSVGTextCÚ‹ÁEËm’t
::
	tSVGL’gthAdju¡Ty³
 
	tEL’gthAdju¡
;

260 
	sSVGTextChunk
 {

261 
SVGTextChunk
()

262 : 
ªchÜ
(
TA_START
)

263 , 
‹xtL’gth
(0.0f)

264 , 
ËngthAdju¡
(
SVGTextCÚ‹ÁEËm’t
::
LENGTHADJUST_SPACING
)

265 , 
ùm
()

266 , 
isV”tiÿlText
(
çl£
)

267 , 
isTextP©h
(
çl£
)

268 , 
¡¬t
(0)

269 , 
’d
(0)

273 
ETextAnchÜ
 
	gªchÜ
;

276 
	g‹xtL’gth
;

277 
EL’gthAdju¡
 
	gËngthAdju¡
;

278 
AffšeT¿nsfÜm
 
	gùm
;

281 
boŞ
 
	gisV”tiÿlText
 : 1;

282 
boŞ
 
	gisTextP©h
 : 1;

285 
	gVeùÜ
<
	gSVGCh¬
>::
™”©Ü
 
¡¬t
;

286 
	gVeùÜ
<
	gSVGCh¬
>::
™”©Ü
 
’d
;

288 
	gVeùÜ
<
	gSVGIÆšeBoxCh¬aù”Rªge
> 
	gboxes
;

291 
	sSVGTextChunkW®k”Ba£
 {

292 
	gvœtu®
 ~
SVGTextChunkW®k”Ba£
() { }

294 
vœtu®
 
İ”©Ü
()(
SVGIÆšeTextBox
* 
	g‹xtBox
, 
	g¡¬tOff£t
, cÚ¡ 
	gAffšeT¿nsfÜm
& 
	gchunkCtm
,

295 cÚ¡ 
	gVeùÜ
<
	gSVGCh¬
>::
™”©Ü
& 
¡¬t
, cÚ¡ VeùÜ<SVGCh¬>::™”©Ü& 
’d
) = 0;

298 
vœtu®
 
¡¬t
(
IÆšeBox
*) = 0;

299 
vœtu®
 
’d
(
IÆšeBox
*) = 0;

302 
	g‹m¶©e
<
ty³Çme
 
	gC®lbackCÏss
>

303 
	gSVGTextChunkW®k”
 : 
public
 
SVGTextChunkW®k”Ba£
 {

304 
public
:

305 (
C®lbackCÏss
::*
	tSVGTextChunkW®k”C®lback
)(
	tSVGIÆšeTextBox
* 
	t‹xtBox
,

306 
	t¡¬tOff£t
,

307 cÚ¡ 
	tAffšeT¿nsfÜm
& 
	tchunkCtm
,

308 cÚ¡ 
	tVeùÜ
<
	tSVGCh¬
>::
	t™”©Ü
& 
	t¡¬t
,

309 cÚ¡ 
	tVeùÜ
<
	tSVGCh¬
>::
	t™”©Ü
& 
	t’d
);

312 (
	gC®lbackCÏss
::*
	tSVGTextChunkS¹C®lback
)(
	tIÆšeBox
* 
	tbox
);

313 (
	gC®lbackCÏss
::*
	tSVGTextChunkEndC®lback
)(
	tIÆšeBox
* 
	tbox
);

315 
SVGTextChunkW®k”
(
C®lbackCÏss
* 
objeù
,

316 
SVGTextChunkW®k”C®lback
 
w®k”
,

317 
SVGTextChunkS¹C®lback
 
¡¬t
 = 0,

318 
SVGTextChunkEndC®lback
 
’d
 = 0)

319 : 
m_objeù
(
objeù
)

320 , 
m_w®k”C®lback
(
w®k”
)

321 , 
m_¡¬tC®lback
(
¡¬t
)

322 , 
m_’dC®lback
(
’d
)

324 
ASSERT
(
objeù
);

325 
ASSERT
(
w®k”
);

328 
vœtu®
 
İ”©Ü
()(
SVGIÆšeTextBox
* 
	g‹xtBox
, 
	g¡¬tOff£t
, cÚ¡ 
	gAffšeT¿nsfÜm
& 
	gchunkCtm
,

329 cÚ¡ 
	gVeùÜ
<
	gSVGCh¬
>::
™”©Ü
& 
¡¬t
, cÚ¡ VeùÜ<SVGCh¬>::™”©Ü& 
’d
)

331 (*
m_objeù
.*
m_w®k”C®lback
)(
‹xtBox
, 
	g¡¬tOff£t
, 
	gchunkCtm
, 
	g¡¬t
, 
	g’d
);

335 
vœtu®
 
¡¬t
(
IÆšeBox
* 
box
)

337 ià(
	gm_¡¬tC®lback
)

338 (*
	gm_objeù
.*
	gm_¡¬tC®lback
)(
	gbox
);

340 
ASSERT_NOT_REACHED
();

343 
vœtu®
 
’d
(
IÆšeBox
* 
box
)

345 ià(
	gm_’dC®lback
)

346 (*
	gm_objeù
.*
	gm_’dC®lback
)(
	gbox
);

348 
ASSERT_NOT_REACHED
();

351 
	g´iv©e
:

352 
C®lbackCÏss
* 
m_objeù
;

353 
SVGTextChunkW®k”C®lback
 
	gm_w®k”C®lback
;

354 
SVGTextChunkS¹C®lback
 
	gm_¡¬tC®lback
;

355 
SVGTextChunkEndC®lback
 
	gm_’dC®lback
;

358 
	sSVGTextChunkLayoutInfo
 {

359 
SVGTextChunkLayoutInfo
(
VeùÜ
<
SVGTextChunk
>& 
‹xtChunks
)

360 : 
assignChunkPrİ”t›s
(
Œue
)

361 , 
hªdlšgTextP©h
(
çl£
)

362 , 
svgTextChunks
(
‹xtChunks
)

363 , 
™
(0)

367 
boŞ
 
	gassignChunkPrİ”t›s
 : 1;

368 
boŞ
 
	ghªdlšgTextP©h
 : 1;

370 
	gVeùÜ
<
	gSVGTextChunk
>& 
	gsvgTextChunks
;

371 
	gVeùÜ
<
	gSVGCh¬
>::
™”©Ü
 
™
;

373 
SVGTextChunk
 
	gchunk
;

376 
	sSVGTextDecÜ©iÚInfo
 {

378 
	gHashM­
<, 
	gR’d”Objeù
*> 
	gflS”v”M­
;

379 
	gHashM­
<, 
	gR’d”Objeù
*> 
	g¡rokeS”v”M­
;

	@SVGInlineFlowBox.cpp

25 
	~"cÚfig.h
"

27 #ià
ENABLE
(
SVG
)

28 
	~"SVGIÆšeFlowBox.h
"

29 
	~"SVGNames.h
"

31 
Çme¥aû
 
	gWebCÜe
 {

33 
usšg
 
Çme¥aû
 
	gSVGNames
;

35 
	gSVGIÆšeFlowBox
::
·št
(
R’d”Objeù
::
PaštInfo
&, , )

37 
ASSERT_NOT_REACHED
();

40 
	gSVGIÆšeFlowBox
::
¶aûBoxesHÜizÚÎy
(, &, &, 
boŞ
&)

46 
	gSVGIÆšeFlowBox
::
v”tiÿÎyAlignBoxes
()

	@SVGInlineFlowBox.h

24 #iâdeà
SVGIÆšeFlowBox_h


25 
	#SVGIÆšeFlowBox_h


	)

27 #ià
ENABLE
(
SVG
)

28 
	~"IÆšeFlowBox.h
"

30 
Çme¥aû
 
	gWebCÜe
 {

32 şas 
	cSVGIÆšeFlowBox
 : 
public
 
IÆšeFlowBox
 {

33 
public
:

34 
SVGIÆšeFlowBox
(
R’d”Objeù
* 
obj
)

35 : 
IÆšeFlowBox
(
obj
)

36 , 
m_height
(0)

40 
vœtu®
 
vœtu®Height
(ècÚ¡ {  
	gm_height
; }

41 
£tHeight
(
h
è{ 
	gm_height
 = h; }

43 
vœtu®
 
·št
(
R’d”Objeù
::
PaštInfo
&, 
tx
, 
ty
);

44 
vœtu®
 
¶aûBoxesHÜizÚÎy
(
x
, & 
ËáPos™iÚ
, & 
rightPos™iÚ
, 
boŞ
& 
ÃedsWÜdS·cšg
);

45 
vœtu®
 
v”tiÿÎyAlignBoxes
(
heightOfBlock
);

47 
	g´iv©e
:

48 
m_height
;

	@SVGInlineTextBox.cpp

22 
	~"cÚfig.h
"

24 #ià
ENABLE
(
SVG
)

25 
	~"SVGIÆšeTextBox.h
"

27 
	~"Docum’t.h
"

28 
	~"Ed™Ü.h
"

29 
	~"F¿me.h
"

30 
	~"G¿phicsCÚ‹xt.h
"

31 
	~"IÆšeFlowBox.h
"

32 
	~"Rªge.h
"

33 
	~"SVGPaštS”v”.h
"

34 
	~"SVGRoÙIÆšeBox.h
"

35 
	~"Text.h
"

37 
	~<æßt.h
>

39 
Çme¥aû
 
	gWebCÜe
 {

41 
	gSVGIÆšeTextBox
::
SVGIÆšeTextBox
(
R’d”Objeù
* 
obj
)

42 : 
IÆšeTextBox
(
obj
)

43 , 
m_height
(0)

47 
	gSVGIÆšeTextBox
::
£ËùiÚTİ
()

49  
m_y
;

52 
	gSVGIÆšeTextBox
::
£ËùiÚHeight
()

54  
m_height
;

57 
SVGRoÙIÆšeBox
* 
	gSVGIÆšeTextBox
::
svgRoÙIÆšeBox
() const

60 
IÆšeFlowBox
* 
·»ÁBox
 = 
·»Á
();

62 
	g·»ÁBox
 && !·»ÁBox->
isRoÙIÆšeBox
())

63 
	g·»ÁBox
 = 
·»ÁBox
->
·»Á
();

65 
ASSERT
(
·»ÁBox
);

66 
ASSERT
(
·»ÁBox
->
isRoÙIÆšeBox
());

68 ià(!
	g·»ÁBox
->
isSVGRoÙIÆšeBox
())

71  
	g¡©ic_ÿ¡
<
	gSVGRoÙIÆšeBox
*>(
	g·»ÁBox
);

74 
	gSVGIÆšeTextBox
::
ÿlcuÏ‹GlyphWidth
(
R’d”StyË
* 
¡yË
, 
off£t
, 
exŒaCh¬sAvaabË
, & 
ch¬sCÚsumed
, 
SŒšg
& 
glyphName
) const

76 
ASSERT
(
¡yË
);

77  
	g¡yË
->
fÚt
().
æßtWidth
(
svgTextRunFÜIÆšeTextBox
(
‹xtR’d””
()->
‹xt
()->
ch¬aù”s
(è+ 
off£t
, 1, 
¡yË
, 
this
, 0), 
exŒaCh¬sAvaabË
, 
ch¬sCÚsumed
, 
glyphName
);

80 
	gSVGIÆšeTextBox
::
ÿlcuÏ‹GlyphHeight
(
R’d”StyË
* 
¡yË
, , ) const

84  
	g¡yË
->
fÚt
().
asûÁ
(è+ styË->fÚt().
desûÁ
();

87 
FlßtReù
 
	gSVGIÆšeTextBox
::
ÿlcuÏ‹GlyphBound¬›s
(
R’d”StyË
* 
¡yË
, 
off£t
, cÚ¡ 
SVGCh¬
& 
svgCh¬
) const

89 cÚ¡ 
	gFÚt
& 
	gfÚt
 = 
¡yË
->
fÚt
();

92 
	gglyphWidth
 = 0.0f;

95 
	gch¬sCÚsumed
;

96 
SŒšg
 
	gglyphName
;

97 ià(
dœeùiÚ
(è=ğ
LTR
)

98 
glyphWidth
 = 
ÿlcuÏ‹GlyphWidth
(
¡yË
, 
off£t
, 0, 
ch¬sCÚsumed
, 
glyphName
);

100 
	gglyphWidth
 = 
ÿlcuÏ‹GlyphWidth
(
¡yË
, 
¡¬t
(è+ 
’d
(è- 
off£t
, 0, 
ch¬sCÚsumed
, 
glyphName
);

102 
	gx1
 = 
svgCh¬
.
x
;

103 
	gx2
 = 
svgCh¬
.
x
 + 
glyphWidth
;

105 
	gy1
 = 
svgCh¬
.
y
 - 
fÚt
.
asûÁ
();

106 
	gy2
 = 
svgCh¬
.
y
 + 
fÚt
.
desûÁ
();

108 
FlßtReù
 
glyphReù
(
x1
, 
y1
, 
x2
 - x1, 
y2
 - y1);

111 
	gglyphReù
 = 
svgCh¬
.
ch¬aù”T¿nsfÜm
().
m­Reù
(
glyphReù
);

113  
	gglyphReù
;

117 
	sSVGIÆšeTextBoxClo£¡Ch¬aù”ToPos™iÚW®k”
 {

118 
SVGIÆšeTextBoxClo£¡Ch¬aù”ToPos™iÚW®k”
(
x
, 
y
)

119 : 
m_ch¬aù”
(0)

120 , 
m_di¡ªû
(
FLT_MAX
)

121 , 
m_x
(
x
)

122 , 
m_y
(
y
)

123 , 
m_off£tOfH™Ch¬aù”
(0)

127 
chunkPÜtiÚC®lback
(
SVGIÆšeTextBox
* 
‹xtBox
, 
¡¬tOff£t
, cÚ¡ 
AffšeT¿nsfÜm
& 
chunkCtm
,

128 cÚ¡ 
VeùÜ
<
SVGCh¬
>::
™”©Ü
& 
¡¬t
, cÚ¡ VeùÜ<SVGCh¬>::™”©Ü& 
’d
)

130 
R’d”StyË
* 
¡yË
 = 
‹xtBox
->
‹xtR’d””
()->style();

132 
	gVeùÜ
<
	gSVGCh¬
>::
™”©Ü
 
şo£¡Ch¬aù”
 = 0;

133 
	gşo£¡Off£t
 = 
UINT_MAX
;

135 
	gVeùÜ
<
	gSVGCh¬
>::
™”©Ü
 
™
 = 
¡¬t
; 
	g™
 !ğ
’d
; ++it) {

136 ià(
	g™
->
isHidd’
())

139 
	gÃwOff£t
 = 
‹xtBox
->
¡¬t
(è+ (
™
 - s¹è+ 
¡¬tOff£t
;

140 
FlßtReù
 
	gglyphReù
 = 
chunkCtm
.
m­Reù
(
‹xtBox
->
ÿlcuÏ‹GlyphBound¬›s
(
¡yË
, 
ÃwOff£t
, *
™
));

144 ià(
	g‹xtBox
->
dœeùiÚ
(è=ğ
RTL
)

145 
ÃwOff£t
 = 
‹xtBox
->
¡¬t
(è+extBox->
’d
() -‚ewOffset;

148 
	gxDi¡ªû
 = 
glyphReù
.
x
(è+ glyphReù.
width
(è/ 2.0à- 
m_x
;

149 
	gyDi¡ªû
 = 
glyphReù
.
y
(è- glyphReù.
height
(è/ 2.0à- 
m_y
;

151 
	gÃwDi¡ªû
 = 
sq¹f
(
xDi¡ªû
 * xDi¡ªû + 
yDi¡ªû
 * yDistance);

152 ià(
	gÃwDi¡ªû
 <ğ
m_di¡ªû
) {

153 
m_di¡ªû
 = 
ÃwDi¡ªû
;

154 
	gşo£¡Off£t
 = 
ÃwOff£t
;

155 
	gşo£¡Ch¬aù”
 = 
™
;

159 ià(
	gşo£¡Off£t
 !ğ
UINT_MAX
) {

161 
m_ch¬aù”
 = 
şo£¡Ch¬aù”
;

162 
	gm_off£tOfH™Ch¬aù”
 = 
şo£¡Off£t
;

166 
SVGCh¬
* 
ch¬aù”
() const

168  
	gm_ch¬aù”
;

171 
off£tOfH™Ch¬aù”
() const

173 ià(!
	gm_ch¬aù”
)

176  
	gm_off£tOfH™Ch¬aù”
;

179 
	g´iv©e
:

180 
VeùÜ
<
SVGCh¬
>::
™”©Ü
 
m_ch¬aù”
;

181 
	gm_di¡ªû
;

183 
	gm_x
;

184 
	gm_y
;

185 
	gm_off£tOfH™Ch¬aù”
;

189 
	sSVGIÆšeTextBoxS–eùiÚReùW®k”
 {

190 
SVGIÆšeTextBoxS–eùiÚReùW®k”
()

194 
chunkPÜtiÚC®lback
(
SVGIÆšeTextBox
* 
‹xtBox
, 
¡¬tOff£t
, cÚ¡ 
AffšeT¿nsfÜm
& 
chunkCtm
,

195 cÚ¡ 
VeùÜ
<
SVGCh¬
>::
™”©Ü
& 
¡¬t
, cÚ¡ VeùÜ<SVGCh¬>::™”©Ü& 
’d
)

197 
R’d”StyË
* 
¡yË
 = 
‹xtBox
->
‹xtR’d””
()->style();

199 
	gVeùÜ
<
	gSVGCh¬
>::
™”©Ü
 
™
 = 
¡¬t
; 
	g™
 !ğ
’d
; ++it) {

200 ià(
	g™
->
isHidd’
())

203 
	gÃwOff£t
 = 
‹xtBox
->
¡¬t
(è+ (
™
 - s¹è+ 
¡¬tOff£t
;

204 
	gm_£ËùiÚReù
.
un™e
(
‹xtBox
->
ÿlcuÏ‹GlyphBound¬›s
(
¡yË
, 
ÃwOff£t
, *
™
));

207 
	gm_£ËùiÚReù
 = 
chunkCtm
.
m­Reù
(
m_£ËùiÚReù
);

210 
FlßtReù
 
£ËùiÚReù
() const

212  
	gm_£ËùiÚReù
;

215 
	g´iv©e
:

216 
FlßtReù
 
m_£ËùiÚReù
;

219 
SVGCh¬
* 
	gSVGIÆšeTextBox
::
şo£¡Ch¬aù”ToPos™iÚ
(
x
, 
y
, & 
off£tOfH™Ch¬aù”
) const

221 
SVGRoÙIÆšeBox
* 
	groÙBox
 = 
svgRoÙIÆšeBox
();

222 ià(!
	groÙBox
)

225 
SVGIÆšeTextBoxClo£¡Ch¬aù”ToPos™iÚW®k”
 
w®k”C®lback
(
x
, 
y
);

226 
	gSVGTextChunkW®k”
<
	gSVGIÆšeTextBoxClo£¡Ch¬aù”ToPos™iÚW®k”
> 
w®k”
(&
w®k”C®lback
, &
SVGIÆšeTextBoxClo£¡Ch¬aù”ToPos™iÚW®k”
::
chunkPÜtiÚC®lback
);

228 
	groÙBox
->
w®kTextChunks
(&
w®k”
, 
this
);

230 
	goff£tOfH™Ch¬aù”
 = 
w®k”C®lback
.
off£tOfH™Ch¬aù”
();

231  
	gw®k”C®lback
.
ch¬aù”
();

234 
boŞ
 
	gSVGIÆšeTextBox
::
svgCh¬aù”H™sPos™iÚ
(
x
, 
y
, & 
şo£¡Off£tInBox
) const

236 
	goff£tOfH™Ch¬aù”
 = 0;

237 
SVGCh¬
* 
	gch¬AtPosPŒ
 = 
şo£¡Ch¬aù”ToPos™iÚ
(
x
, 
y
, 
off£tOfH™Ch¬aù”
);

238 ià(!
	gch¬AtPosPŒ
)

239  
	gçl£
;

241 
	gSVGCh¬
& 
	gch¬AtPos
 = *
ch¬AtPosPŒ
;

242 
R’d”StyË
* 
	g¡yË
 = 
‹xtR’d””
()->
¡yË
(
m_fœ¡Lše
);

243 
FlßtReù
 
	gglyphReù
 = 
ÿlcuÏ‹GlyphBound¬›s
(
¡yË
, 
off£tOfH™Ch¬aù”
, 
ch¬AtPos
);

246 ià(
dœeùiÚ
(è=ğ
RTL
)

247 
off£tOfH™Ch¬aù”
++;

251 
	gşo£¡Off£tInBox
 = 
off£tOfH™Ch¬aù”
;

256 ià(
	gy
 < 
	gch¬AtPos
.y - 
	gglyphReù
.
height
() || y > charAtPos.y)

257  
	gçl£
;

260 ià(
	gx
 < 
	gch¬AtPos
.x) {

261 ià(
	gşo£¡Off£tInBox
 > 0 && 
dœeùiÚ
(è=ğ
LTR
)

262  
Œue
;

263 ià(
	gşo£¡Off£tInBox
 < (è
’d
(è&& 
dœeùiÚ
(è=ğ
RTL
)

264  
Œue
;

266  
	gçl£
;

270 ià(
	gx
 >ğ
ch¬AtPos
.
x
 + 
glyphReù
.
width
() / 2.0)

271 
şo£¡Off£tInBox
 +ğ
dœeùiÚ
(è=ğ
RTL
 ? -1 : 1;

274 ià(
	gx
 >ğ
ch¬AtPos
.
x
 + 
glyphReù
.
width
(è&& 
şo£¡Off£tInBox
 =ğ(è
’d
())

275  
çl£
;

277  
	gŒue
;

280 
	gSVGIÆšeTextBox
::
off£tFÜPos™iÚ
(, 
boŞ
) const

283 
ASSERT_NOT_REACHED
();

287 
	gSVGIÆšeTextBox
::
pos™iÚFÜOff£t
() const

290 
ASSERT_NOT_REACHED
();

294 
boŞ
 
	gSVGIÆšeTextBox
::
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
& 
»suÉ
, 
x
, 
y
, 
tx
, 
ty
)

296 
ASSERT
(!
isLšeB»ak
());

298 
IÁReù
 
	g»ù
 = 
£ËùiÚReù
(0, 0, 0, 
Ën
());

299 ià(
»nd””
()->
¡yË
()->
visib™y
(è=ğ
VISIBLE
 && 
»ù
.
cÚšs
(
x
, 
y
)) {

300 
»nd””
()->
upd©eH™Te¡ResuÉ
(
»suÉ
, 
IÁPošt
(
x
 - 
tx
, 
y
 - 
ty
));

301  
	gŒue
;

304  
	gçl£
;

307 
IÁReù
 
	gSVGIÆšeTextBox
::
£ËùiÚReù
(, , 
¡¬tPos
, 
’dPos
)

309 ià(
	g¡¬tPos
 >ğ
’dPos
)

310  
IÁReù
();

314 
SVGRoÙIÆšeBox
* 
	groÙBox
 = 
svgRoÙIÆšeBox
();

315 ià(!
	groÙBox
)

316  
IÁReù
();

318 
SVGIÆšeTextBoxS–eùiÚReùW®k”
 
	gw®k”C®lback
;

319 
	gSVGTextChunkW®k”
<
	gSVGIÆšeTextBoxS–eùiÚReùW®k”
> 
w®k”
(&
w®k”C®lback
, &
SVGIÆšeTextBoxS–eùiÚReùW®k”
::
chunkPÜtiÚC®lback
);

321 
	groÙBox
->
w®kTextChunks
(&
w®k”
, 
this
);

322  
’şosšgIÁReù
(
w®k”C®lback
.
£ËùiÚReù
());

325 
boŞ
 
	gSVGIÆšeTextBox
::
chunkS–eùiÚS¹End
(cÚ¡ 
UCh¬
* 
chunk
, 
chunkL’gth
, & 
£ËùiÚS¹
, & 
£ËùiÚEnd
)

330 
	gchunkS¹
 = 
chunk
 - 
‹xtR’d””
()->
ch¬aù”s
();

331 
ASSERT
(0 <ğ
chunkS¹
);

333 
£ËùiÚS¹End
(
£ËùiÚS¹
, 
£ËùiÚEnd
);

334 ià(
	g£ËùiÚEnd
 <ğ
chunkS¹
)

335  
çl£
;

336 ià(
	gchunkS¹
 + 
	gchunkL’gth
 <ğ
£ËùiÚS¹
)

337  
çl£
;

340 
	g£ËùiÚS¹
 -ğ
chunkS¹
;

341 
	g£ËùiÚEnd
 -ğ
chunkS¹
;

343 ià(
	g£ËùiÚS¹
 < 0)

344 
	g£ËùiÚS¹
 = 0;

345 ià(
	gchunkL’gth
 < 
	g£ËùiÚEnd
)

346 
	g£ËùiÚEnd
 = 
chunkL’gth
;

348  
	g£ËùiÚS¹
 < 
	g£ËùiÚEnd
;

351 
	gSVGIÆšeTextBox
::
·štCh¬aù”s
(
R’d”Objeù
::
PaštInfo
& 
·štInfo
, 
tx
, 
ty
, cÚ¡ 
SVGCh¬
& 
svgCh¬
, cÚ¡ 
UCh¬
* 
ch¬s
, 
Ëngth
, 
SVGTextPaštInfo
& 
‹xtPaštInfo
)

353 ià(
»nd””
()->
¡yË
()->
visib™y
(è!ğ
VISIBLE
 || 
·štInfo
.
pha£
 =ğ
PaštPha£Ouše
)

356 
ASSERT
(
·štInfo
.
pha£
 !ğ
PaštPha£S–fOuše
 &&…aštInfo.pha£ !ğ
PaštPha£ChdOušes
);

358 
R’d”Text
* 
	g‹xt
 = 
‹xtR’d””
();

359 
ASSERT
(
‹xt
);

361 
boŞ
 
	gisPrštšg
 = 
‹xt
->
docum’t
()->
´štšg
();

364 
boŞ
 
	ghaveS–eùiÚ
 = !
isPrštšg
 && 
£ËùiÚS‹
(è!ğ
R’d”Objeù
::
S–eùiÚNÚe
;

365 ià(!
	ghaveS–eùiÚ
 && 
	g·štInfo
.
	gpha£
 =ğ
PaštPha£S–eùiÚ
)

370 
boŞ
 
	gcÚšsCompos™iÚ
 = 
‹xt
->
docum’t
()->
äame
()->
ed™Ü
()->
compos™iÚNode
(è=ğ‹xt->
node
();

371 
boŞ
 
	gu£Cu¡omUnd”lšes
 = 
cÚšsCompos™iÚ
 && 
‹xt
->
docum’t
()->
äame
()->
ed™Ü
()->
compos™iÚU£sCu¡omUnd”lšes
();

374 
R’d”StyË
* 
	g¡yËToU£
 = 
‹xt
->
¡yË
(
isFœ¡LšeStyË
());

375 cÚ¡ 
	gFÚt
& 
	gfÚt
 = 
¡yËToU£
->
fÚt
();

377 
AffšeT¿nsfÜm
 
	gùm
 = 
svgCh¬
.
ch¬aù”T¿nsfÜm
();

378 ià(!
	gùm
.
isId’t™y
())

379 
	g·štInfo
.
	gcÚ‹xt
->
cÚÿtCTM
(
ùm
);

383 ià(
	g·štInfo
.
	gpha£
 !ğ
PaštPha£S–eùiÚ
 && !
isPrštšg
 && 
‹xtPaštInfo
.
subpha£
 =ğ
SVGTextPaštSubpha£Background
) {

384 #ià
PLATFORM
(
MAC
)

386 ià(
¡yËToU£
->
highlight
(è!ğ
nuÎAtom
 && !
·štInfo
.
cÚ‹xt
->
·štšgDi§bËd
())

387 
·štCu¡omHighlight
(
tx
, 
ty
, 
¡yËToU£
->
highlight
());

390 ià(
	gcÚšsCompos™iÚ
 && !
	gu£Cu¡omUnd”lšes
)

391 
·štCompos™iÚBackground
(
·štInfo
.
cÚ‹xt
, 
tx
, 
ty
, 
¡yËToU£
, 
fÚt
,

392 
‹xt
->
docum’t
()->
äame
()->
ed™Ü
()->
compos™iÚS¹
(),

393 
‹xt
->
docum’t
()->
äame
()->
ed™Ü
()->
compos™iÚEnd
());

395 
·štDocum’tM¬k”s
(
·štInfo
.
cÚ‹xt
, 
tx
, 
ty
, 
¡yËToU£
, 
fÚt
, 
Œue
);

397 ià(
	ghaveS–eùiÚ
 && !
	gu£Cu¡omUnd”lšes
) {

398 
	gboxS¹Off£t
 = 
ch¬s
 - 
‹xt
->
ch¬aù”s
(è- 
¡¬t
();

399 
·štS–eùiÚ
(
boxS¹Off£t
, 
svgCh¬
, 
ch¬s
, 
Ëngth
, 
·štInfo
.
cÚ‹xt
, 
¡yËToU£
, 
fÚt
);

403 
boŞ
 
	gisGlyphPha£
 = 
‹xtPaštInfo
.
subpha£
 =ğ
SVGTextPaštSubpha£GlyphFl
 ||extPaštInfo.subpha£ =ğ
SVGTextPaštSubpha£GlyphSŒoke
;

404 
boŞ
 
	gisS–eùiÚGlyphPha£
 = 
‹xtPaštInfo
.
subpha£
 =ğ
SVGTextPaštSubpha£GlyphFlS–eùiÚ
 ||extPaštInfo.subpha£ =ğ
SVGTextPaštSubpha£GlyphSŒokeS–eùiÚ
;

406 ià(
	gisGlyphPha£
 || 
	gisS–eùiÚGlyphPha£
) {

409 
boŞ
 
	g£tShadow
 = 
çl£
;

410 ià(
	g¡yËToU£
->
‹xtShadow
()) {

411 
	g·štInfo
.
	gcÚ‹xt
->
£tShadow
(
IÁSize
(
¡yËToU£
->
‹xtShadow
()->
x
(), styËToU£->‹xtShadow()->
y
()),

412 
¡yËToU£
->
‹xtShadow
()->
blur
(), styËToU£->‹xtShadow()->
cŞÜ
(),

413 
¡yËToU£
->
cŞÜS·û
());

414 
	g£tShadow
 = 
Œue
;

417 
IÁPošt
 
Üigš
((è
svgCh¬
.
x
, (èsvgCh¬.
y
);

418 
TextRun
 
	grun
 = 
svgTextRunFÜIÆšeTextBox
(
ch¬s
, 
Ëngth
, 
¡yËToU£
, 
this
, 
svgCh¬
.
x
);

420 #ià
ENABLE
(
SVG_FONTS
)

423 
ASSERT
(
‹xtPaštInfo
.
aùivePaštS”v”
);

424 
	grun
.
£tAùivePaštS”v”
(
‹xtPaštInfo
.
aùivePaštS”v”
);

427 
	g£ËùiÚS¹
 = 0;

428 
	g£ËùiÚEnd
 = 0;

429 
boŞ
 
	ghaveS–eùedRªge
 = 
haveS–eùiÚ
 && 
chunkS–eùiÚS¹End
(
ch¬s
, 
Ëngth
, 
£ËùiÚS¹
, 
£ËùiÚEnd
);

431 ià(
	gisGlyphPha£
) {

432 ià(
	ghaveS–eùedRªge
) {

433 
	g·štInfo
.
	gcÚ‹xt
->
d¿wText
(
fÚt
, 
run
, 
Üigš
, 0, 
£ËùiÚS¹
);

434 
	g·štInfo
.
	gcÚ‹xt
->
d¿wText
(
fÚt
, 
run
, 
Üigš
, 
£ËùiÚEnd
,„un.
Ëngth
());

436 
	g·štInfo
.
	gcÚ‹xt
->
d¿wText
(
fÚt
, 
run
, 
Üigš
);

438 
ASSERT
(
isS–eùiÚGlyphPha£
);

439 ià(
	ghaveS–eùedRªge
)

440 
	g·štInfo
.
	gcÚ‹xt
->
d¿wText
(
fÚt
, 
run
, 
Üigš
, 
£ËùiÚS¹
, 
£ËùiÚEnd
);

443 ià(
	g£tShadow
)

444 
	g·štInfo
.
	gcÚ‹xt
->
ş—rShadow
();

447 ià(
	g·štInfo
.
	gpha£
 !ğ
PaštPha£S–eùiÚ
 && 
‹xtPaštInfo
.
subpha£
 =ğ
SVGTextPaštSubpha£FÜeground
) {

448 
·štDocum’tM¬k”s
(
·štInfo
.
cÚ‹xt
, 
tx
, 
ty
, 
¡yËToU£
, 
fÚt
, 
çl£
);

450 ià(
	gu£Cu¡omUnd”lšes
) {

451 cÚ¡ 
	gVeùÜ
<
	gCompos™iÚUnd”lše
>& 
	gund”lšes
 = 
‹xt
->
docum’t
()->
äame
()->
ed™Ü
()->
cu¡omCompos™iÚUnd”lšes
();

452 
size_t
 
	gnumUnd”lšes
 = 
und”lšes
.
size
();

454 
size_t
 
	gšdex
 = 0; index < 
	gnumUnd”lšes
; ++index) {

455 cÚ¡ 
	gCompos™iÚUnd”lše
& 
	gund”lše
 = 
und”lšes
[
šdex
];

457 ià(
	gund”lše
.
	g’dOff£t
 <ğ
¡¬t
())

463 ià(
	gund”lše
.
	g¡¬tOff£t
 <ğ
’d
()) {

465 
·štCompos™iÚUnd”lše
(
·štInfo
.
cÚ‹xt
, 
tx
, 
ty
, 
und”lše
);

466 ià(
	gund”lše
.
	g’dOff£t
 > 
’d
() + 1)

477 ià(!
	gùm
.
isId’t™y
())

478 
	g·štInfo
.
	gcÚ‹xt
->
cÚÿtCTM
(
ùm
.
šv”£
());

481 
	gSVGIÆšeTextBox
::
·štS–eùiÚ
(
boxS¹Off£t
, cÚ¡ 
SVGCh¬
& 
svgCh¬
, cÚ¡ 
UCh¬
*, 
Ëngth
, 
G¿phicsCÚ‹xt
* 
p
, 
R’d”StyË
* 
¡yË
, cÚ¡ 
FÚt
& 
fÚt
)

483 ià(
£ËùiÚS‹
(è=ğ
R’d”Objeù
::
S–eùiÚNÚe
)

486 
	g¡¬tPos
, 
	g’dPos
;

487 
£ËùiÚS¹End
(
¡¬tPos
, 
’dPos
);

489 ià(
	g¡¬tPos
 >ğ
’dPos
)

492 
CŞÜ
 
	g‹xtCŞÜ
 = 
¡yË
->
cŞÜ
();

493 
CŞÜ
 
	gcŞÜ
 = 
»nd””
()->
£ËùiÚBackgroundCŞÜ
();

494 ià(!
	gcŞÜ
.
isV®id
(è|| cŞÜ.
®pha
() == 0)

499 ià(
	g‹xtCŞÜ
 =ğ
cŞÜ
)

500 
cŞÜ
 = 
CŞÜ
(0xfà- cŞÜ.
»d
(), 0xfà- cŞÜ.
g»’
(), 0xfà- cŞÜ.
blue
());

504 ià((
	g¡¬tPos
 > 
	gboxS¹Off£t
 && 
	g’dPos
 > boxS¹Off£ˆ+ 
	gËngth
è|| boxS¹Off£ˆ>ğ
’dPos
)

507 ià(
	g’dPos
 > 
	gboxS¹Off£t
 + 
	gËngth
)

508 
	g’dPos
 = 
boxS¹Off£t
 + 
Ëngth
;

510 ià(
	g¡¬tPos
 < 
	gboxS¹Off£t
)

511 
	g¡¬tPos
 = 
boxS¹Off£t
;

513 
ASSERT
(
¡¬tPos
 >ğ
boxS¹Off£t
);

514 
ASSERT
(
’dPos
 <ğ
boxS¹Off£t
 + 
Ëngth
);

515 
ASSERT
(
¡¬tPos
 < 
’dPos
);

517 
	gp
->
§ve
();

519 
	gadju¡
 = 
¡¬tPos
 >ğ
boxS¹Off£t
 ? boxStartOffset : 0;

520 
	gp
->
d¿wHighlightFÜText
(
fÚt
, 
svgTextRunFÜIÆšeTextBox
(
‹xtR’d””
()->
‹xt
()->
ch¬aù”s
(è+ 
¡¬t
(è+ 
boxS¹Off£t
, 
Ëngth
, 
¡yË
, 
this
, 
svgCh¬
.
x
),

521 
IÁPošt
((è
svgCh¬
.
x
, (èsvgCh¬.
y
 - 
fÚt
.
asûÁ
()),

522 
fÚt
.
asûÁ
(è+ fÚt.
desûÁ
(), 
cŞÜ
, 
¡yË
->
cŞÜS·û
(), 
¡¬tPos
 - 
adju¡
, 
’dPos
 -‡djust);

524 
	gp
->
»¡Üe
();

527 
šlše
 
P©h
 
·thFÜDecÜ©iÚ
(
ETextDecÜ©iÚ
 
decÜ©iÚ
, 
R’d”Objeù
* 
objeù
, 
x
, 
y
, 
width
)

529 
	gthickÃss
 = 
SVGR’d”StyË
::
cssPrim™iveToL’gth
(
objeù
, objeù->
¡yË
()->
svgStyË
()->
¡rokeWidth
(), 1.0f);

531 cÚ¡ 
	gFÚt
& 
	gfÚt
 = 
objeù
->
¡yË
()->
fÚt
();

532 
	gthickÃss
 = 
max
(
thickÃss
 * 
powf
(
fÚt
.
size
(), 2.0fè/ fÚt.
un™sP”Em
(), 1.0f);

534 ià(
	gdecÜ©iÚ
 =ğ
UNDERLINE
)

535 
y
 +ğ
thickÃss
 * 1.5f;

536 ià(
	gdecÜ©iÚ
 =ğ
OVERLINE
)

537 
y
 +ğ
thickÃss
;

539 
	gh®fThickÃss
 = 
thickÃss
 / 2.0f;

540  
	gP©h
::
ü—‹ReùªgË
(
FlßtReù
(
x
 + 
h®fThickÃss
, 
y
, 
width
 - 2.0à* h®fThickÃss, 
thickÃss
));

543 
	gSVGIÆšeTextBox
::
·štDecÜ©iÚ
(
ETextDecÜ©iÚ
 
decÜ©iÚ
, 
G¿phicsCÚ‹xt
* 
cÚ‹xt
, 
tx
, 
ty
, 
width
, cÚ¡ 
SVGCh¬
& 
svgCh¬
, cÚ¡ 
SVGTextDecÜ©iÚInfo
& 
šfo
)

545 ià(
»nd””
()->
¡yË
()->
visib™y
(è!ğ
VISIBLE
)

549 
ASSERT
(
decÜ©iÚ
 =ğ
TDNONE
 || decÜ©iÚ =ğ
UNDERLINE
 || decÜ©iÚ =ğ
OVERLINE
 || decÜ©iÚ =ğ
LINE_THROUGH
 || decÜ©iÚ =ğ
BLINK
);

551 
boŞ
 
	gisFËd
 = 
šfo
.
flS”v”M­
.
cÚšs
(
decÜ©iÚ
);

552 
boŞ
 
	gisSŒoked
 = 
šfo
.
¡rokeS”v”M­
.
cÚšs
(
decÜ©iÚ
);

554 ià(!
	gisFËd
 && !
	gisSŒoked
)

557 
	gba£lše
 = 
»nd””
()->
¡yË
(
m_fœ¡Lše
)->
fÚt
().
asûÁ
();

558 ià(
	gdecÜ©iÚ
 =ğ
UNDERLINE
)

559 
ty
 +ğ
ba£lše
;

560 ià(
	gdecÜ©iÚ
 =ğ
LINE_THROUGH
)

561 
ty
 +ğ2 * 
ba£lše
 / 3;

563 
	gcÚ‹xt
->
§ve
();

564 
	gcÚ‹xt
->
begšP©h
();

566 
AffšeT¿nsfÜm
 
	gùm
 = 
svgCh¬
.
ch¬aù”T¿nsfÜm
();

567 ià(!
	gùm
.
isId’t™y
())

568 
	gcÚ‹xt
->
cÚÿtCTM
(
ùm
);

570 ià(
	gisFËd
) {

571 ià(
R’d”Objeù
* 
	gflObjeù
 = 
šfo
.
flS”v”M­
.
g‘
(
decÜ©iÚ
)) {

572 ià(
SVGPaštS”v”
* 
flPaštS”v”
 = SVGPaštS”v”::flPaštS”v”(
flObjeù
->
¡yË
(), fillObject)) {

573 
	gcÚ‹xt
->
addP©h
(
·thFÜDecÜ©iÚ
(
decÜ©iÚ
, 
flObjeù
, 
tx
, 
ty
, 
width
));

574 
	gflPaštS”v”
->
d¿w
(
cÚ‹xt
, 
flObjeù
, 
AµlyToFlT¬g‘Ty³
);

579 ià(
	gisSŒoked
) {

580 ià(
R’d”Objeù
* 
	g¡rokeObjeù
 = 
šfo
.
¡rokeS”v”M­
.
g‘
(
decÜ©iÚ
)) {

581 ià(
SVGPaštS”v”
* 
¡rokePaštS”v”
 = SVGPaštS”v”::¡rokePaštS”v”(
¡rokeObjeù
->
¡yË
(), strokeObject)) {

582 
	gcÚ‹xt
->
addP©h
(
·thFÜDecÜ©iÚ
(
decÜ©iÚ
, 
¡rokeObjeù
, 
tx
, 
ty
, 
width
));

583 
	g¡rokePaštS”v”
->
d¿w
(
cÚ‹xt
, 
¡rokeObjeù
, 
AµlyToSŒokeT¬g‘Ty³
);

588 
	gcÚ‹xt
->
»¡Üe
();

	@SVGInlineTextBox.h

22 #iâdeà
SVGIÆšeTextBox_h


23 
	#SVGIÆšeTextBox_h


	)

25 #ià
ENABLE
(
SVG
)

26 
	~"IÆšeTextBox.h
"

28 
Çme¥aû
 
	gWebCÜe
 {

30 
şass
 
	gSVGRoÙIÆšeBox
;

32 
	gSVGCh¬
;

33 
	gSVGTextDecÜ©iÚInfo
;

35 
	eSVGTextPaštSubpha£
 {

36 
	gSVGTextPaštSubpha£Background
,

37 
	gSVGTextPaštSubpha£GlyphFl
,

38 
	gSVGTextPaštSubpha£GlyphFlS–eùiÚ
,

39 
	gSVGTextPaštSubpha£GlyphSŒoke
,

40 
	gSVGTextPaštSubpha£GlyphSŒokeS–eùiÚ
,

41 
	gSVGTextPaštSubpha£FÜeground


44 
	sSVGTextPaštInfo
 {

45 
SVGTextPaštInfo
(è: 
aùivePaštS”v”
(0), 
subpha£
(
SVGTextPaštSubpha£Background
) {}

47 
SVGPaštS”v”
* 
	gaùivePaštS”v”
;

48 
SVGTextPaštSubpha£
 
	gsubpha£
;

51 şas 
	cSVGIÆšeTextBox
 : 
public
 
IÆšeTextBox
 {

52 
public
:

53 
SVGIÆšeTextBox
(
R’d”Objeù
* 
obj
);

55 
vœtu®
 
vœtu®Height
(ècÚ¡ {  
	gm_height
; }

56 
£tHeight
(
h
è{ 
	gm_height
 = h; }

58 
vœtu®
 
£ËùiÚTİ
();

59 
vœtu®
 
£ËùiÚHeight
();

61 
vœtu®
 
off£tFÜPos™iÚ
(
x
, 
boŞ
 
šşudeP¬tŸlGlyphs
 = 
Œue
) const;

62 
vœtu®
 
pos™iÚFÜOff£t
(
off£t
) const;

64 
vœtu®
 
boŞ
 
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, 
x
, 
y
, 
tx
, 
ty
);

65 
vœtu®
 
IÁReù
 
£ËùiÚReù
(
absx
, 
absy
, 
¡¬tPos
, 
’dPos
);

68 
·štCh¬aù”s
(
R’d”Objeù
::
PaštInfo
&, 
tx
, 
ty
, cÚ¡ 
SVGCh¬
&, cÚ¡ 
UCh¬
* 
ch¬s
, 
Ëngth
, 
SVGTextPaštInfo
&);

71 
·štS–eùiÚ
(
boxS¹Off£t
, cÚ¡ 
SVGCh¬
&, cÚ¡ 
UCh¬
*, 
Ëngth
, 
G¿phicsCÚ‹xt
*, 
R’d”StyË
*, cÚ¡ 
FÚt
&);

74 
·štDecÜ©iÚ
(
ETextDecÜ©iÚ
, 
G¿phicsCÚ‹xt
*, 
tx
, 
ty
, 
width
, cÚ¡ 
SVGCh¬
&, cÚ¡ 
SVGTextDecÜ©iÚInfo
&);

76 
SVGRoÙIÆšeBox
* 
svgRoÙIÆšeBox
() const;

79 
ÿlcuÏ‹GlyphWidth
(
R’d”StyË
* 
¡yË
, 
off£t
, 
exŒaCh¬sAvaabË
, & 
ch¬sCÚsumed
, 
SŒšg
& 
glyphName
) const;

80 
ÿlcuÏ‹GlyphHeight
(
R’d”StyË
*, 
off£t
, 
exŒaCh¬sAvaabË
) const;

82 
FlßtReù
 
ÿlcuÏ‹GlyphBound¬›s
(
R’d”StyË
*, 
off£t
, cÚ¡ 
SVGCh¬
&) const;

83 
SVGCh¬
* 
şo£¡Ch¬aù”ToPos™iÚ
(
x
, 
y
, & 
off£t
) const;

85 
	g´iv©e
:

86 
ä›nd
 
şass
 
R’d”SVGIÆšeText
;

87 
boŞ
 
svgCh¬aù”H™sPos™iÚ
(
x
, 
y
, & 
off£t
) const;

88 
boŞ
 
chunkS–eùiÚS¹End
(cÚ¡ 
UCh¬
* 
chunk
, 
chunkL’gth
, & 
£ËùiÚS¹
, & 
£ËùiÚEnd
);

90 
	gm_height
;

	@SVGMarkerData.h

20 #iâdeà
SVGM¬k”D©a_h


21 
	#SVGM¬k”D©a_h


	)

23 #ià
ENABLE
(
SVG
)

24 
	~"FlßtCÚv”siÚ.h
"

25 
	~"P©h.h
"

26 
	~<wtf/M©hExŒas.h
>

28 
Çme¥aû
 
	gWebCÜe
 {

30 
şass
 
	gR’d”SVGResourûM¬k”
;

32 şas 
	cSVGM¬k”D©a
 {

33 
	gpublic
:

34 
	eTy³
 {

35 
Unknown
 = 0,

36 
	gS¹
,

37 
	gMid
,

38 
	gEnd


41 
SVGM¬k”D©a
(cÚ¡ 
Ty³
& 
ty³
 = 
Unknown
, 
R’d”SVGResourûM¬k”
* 
m¬k”
 = 0)

42 : 
m_ty³
(
ty³
)

43 , 
m_m¬k”
(
m¬k”
)

47 
FlßtPošt
 
Üigš
(ècÚ¡ {  
	gm_Üigš
; }

48 
R’d”SVGResourûM¬k”
* 
m¬k”
(ècÚ¡ {  
	gm_m¬k”
; }

50 
cu¼’tAngË
() const

52 
FlßtSize
 
	gš¦İeChªge
 = 
m_š¦İePošts
[1] - m_inslopePoints[0];

53 
FlßtSize
 
	gout¦İeChªge
 = 
m_out¦İePošts
[1] - m_outslopePoints[0];

55 
	gš¦İe
 = 
¿d2deg
(
©ª2
(
š¦İeChªge
.
height
(), in¦İeChªge.
width
()));

56 
	gout¦İe
 = 
¿d2deg
(
©ª2
(
out¦İeChªge
.
height
(), out¦İeChªge.
width
()));

58 
	gªgË
 = 0;

59 
	gm_ty³
) {

60 
	gS¹
:

61 
ªgË
 = 
out¦İe
;

63 
	gMid
:

64 
ªgË
 = (
š¦İe
 + 
out¦İe
) / 2;

66 
	gEnd
:

67 
ªgË
 = 
š¦İe
;

70 
ASSERT_NOT_REACHED
();

74  
Ç¼owP»cisiÚToFlßt
(
ªgË
);

77 
upd©eTy³AndM¬k”
(cÚ¡ 
Ty³
& 
ty³
, 
R’d”SVGResourûM¬k”
* 
m¬k”
)

79 
	gm_ty³
 = 
ty³
;

80 
	gm_m¬k”
 = 
m¬k”
;

83 
upd©eOut¦İe
(cÚ¡ 
FlßtPošt
& 
pošt
)

85 
	gm_out¦İePošts
[0] = 
m_Üigš
;

86 
	gm_out¦İePošts
[1] = 
pošt
;

89 
upd©eM¬k”D©aFÜP©hEËm’t
(cÚ¡ 
P©hEËm’t
* 
–em’t
)

91 
FlßtPošt
* 
	gpošts
 = 
–em’t
->
pošts
;

93 
	g–em’t
->
	gty³
) {

94 
	gP©hEËm’tAddQuadCurveToPošt
:

96 
m_Üigš
 = 
pošts
[1];

98 
	gP©hEËm’tAddCurveToPošt
:

99 
m_š¦İePošts
[0] = 
pošts
[1];

100 
	gm_š¦İePošts
[1] = 
pošts
[2];

101 
	gm_Üigš
 = 
pošts
[2];

103 
	gP©hEËm’tMoveToPošt
:

104 
m_sub·thS¹
 = 
pošts
[0];

105 
	gP©hEËm’tAddLšeToPošt
:

106 
upd©eIn¦İe
(
pošts
[0]);

107 
	gm_Üigš
 = 
pošts
[0];

109 
	gP©hEËm’tClo£Sub·th
:

110 
upd©eIn¦İe
(
pošts
[0]);

111 
	gm_Üigš
 = 
m_sub·thS¹
;

112 
	gm_sub·thS¹
 = 
FlßtPošt
();

116 
	g´iv©e
:

117 
upd©eIn¦İe
(cÚ¡ 
FlßtPošt
& 
pošt
)

119 
m_š¦İePošts
[0] = 
m_Üigš
;

120 
	gm_š¦İePošts
[1] = 
pošt
;

123 
Ty³
 
	gm_ty³
;

124 
R’d”SVGResourûM¬k”
* 
	gm_m¬k”
;

125 
FlßtPošt
 
	gm_Üigš
;

126 
FlßtPošt
 
	gm_sub·thS¹
;

127 
FlßtPošt
 
	gm_š¦İePošts
[2];

128 
FlßtPošt
 
	gm_out¦İePošts
[2];

	@SVGMarkerLayoutInfo.cpp

24 
	~"cÚfig.h
"

26 #ià
ENABLE
(
SVG
)

27 
	~"SVGM¬k”LayoutInfo.h
"

29 
	~"R’d”SVGResourûM¬k”.h
"

31 
Çme¥aû
 
	gWebCÜe
 {

33 
	gSVGM¬k”LayoutInfo
::
SVGM¬k”LayoutInfo
()

34 : 
m_midM¬k”
(0)

35 , 
m_–em’tIndex
(0)

36 , 
m_¡rokeWidth
(0)

40 
	gSVGM¬k”LayoutInfo
::~
SVGM¬k”LayoutInfo
()

44 
šlše
 
´oûssS¹AndMidM¬k”s
(* 
šfoPŒ
, cÚ¡ 
P©hEËm’t
* 
–em’t
)

46 
	gSVGM¬k”LayoutInfo
& 
	gšfo
 = *
»š‹½»t_ÿ¡
<
SVGM¬k”LayoutInfo
*>(
šfoPŒ
);

47 
	gSVGM¬k”D©a
& 
	gm¬k”D©a
 = 
šfo
.
m¬k”D©a
();

48 & 
	g–em’tIndex
 = 
šfo
.
–em’tIndex
();

51 
	gm¬k”D©a
.
upd©eOut¦İe
(
–em’t
->
pošts
[0]);

54 
R’d”SVGResourûM¬k”
* 
	gm¬k”
 = 
m¬k”D©a
.
m¬k”
();

55 ià(
	g–em’tIndex
 > 0 && 
	gm¬k”
)

56 
	gšfo
.
addLayou‹dM¬k”
(
m¬k”
, 
m¬k”D©a
.
Üigš
(), m¬k”D©a.
cu¼’tAngË
());

59 
	gm¬k”D©a
.
upd©eM¬k”D©aFÜP©hEËm’t
(
–em’t
);

62 ià(
	g–em’tIndex
 == 1)

63 
m¬k”D©a
.
upd©eTy³AndM¬k”
(
SVGM¬k”D©a
::
Mid
, 
šfo
.
midM¬k”
());

65 ++
	g–em’tIndex
;

68 
FlßtReù
 
	gSVGM¬k”LayoutInfo
::
ÿlcuÏ‹Bound¬›s
(
R’d”SVGResourûM¬k”
* 
¡¬tM¬k”
, R’d”SVGResourûM¬k”* 
midM¬k”
, R’d”SVGResourûM¬k”* 
’dM¬k”
, 
¡rokeWidth
, cÚ¡ 
P©h
& 
·th
)

70 
	gm_Ïyout
.
ş—r
();

71 
	gm_midM¬k”
 = 
midM¬k”
;

72 
	gm_¡rokeWidth
 = 
¡rokeWidth
;

73 
	gm_–em’tIndex
 = 0;

74 
	gm_m¬k”D©a
 = 
SVGM¬k”D©a
(SVGM¬k”D©a::
S¹
, 
¡¬tM¬k”
);

75 
	g·th
.
­¶y
(
this
, 
´oûssS¹AndMidM¬k”s
);

77 ià(
	g’dM¬k”
) {

78 
	gm_m¬k”D©a
.
upd©eTy³AndM¬k”
(
SVGM¬k”D©a
::
End
, 
’dM¬k”
);

79 
addLayou‹dM¬k”
(
’dM¬k”
, 
m_m¬k”D©a
.
Üigš
(), m_m¬k”D©a.
cu¼’tAngË
());

82 ià(
	gm_Ïyout
.
isEm±y
())

83  
FlßtReù
();

85 
	gVeùÜ
<
	gM¬k”Layout
>::
™”©Ü
 
™
 = 
m_Ïyout
.
begš
();

86 
	gVeùÜ
<
	gM¬k”Layout
>::
™”©Ü
 
’d
 = 
m_Ïyout
.end();

88 
FlßtReù
 
	gbounds
;

89 ; 
	g™
 !ğ
’d
; ++it) {

90 
	gM¬k”Layout
& 
	gÏyout
 = *
™
;

92 
R’d”SVGResourûM¬k”
* 
	gm¬k”CÚ‹Á
 = 
Ïyout
.
m¬k”
;

93 
ASSERT
(
m¬k”CÚ‹Á
);

95 
	gbounds
.
un™e
(
m¬k”CÚ‹Á
->
m¬k”Bound¬›s
(
Ïyout
.
m©rix
));

98  
	gbounds
;

101 
	gSVGM¬k”LayoutInfo
::
d¿wM¬k”s
(
R’d”Objeù
::
PaštInfo
& 
·štInfo
)

103 ià(
m_Ïyout
.
isEm±y
())

106 
	gVeùÜ
<
	gM¬k”Layout
>::
™”©Ü
 
™
 = 
m_Ïyout
.
begš
();

107 
	gVeùÜ
<
	gM¬k”Layout
>::
™”©Ü
 
’d
 = 
m_Ïyout
.end();

109 ; 
	g™
 !ğ
’d
; ++it) {

110 
	gM¬k”Layout
& 
	gÏyout
 = *
™
;

111 
	gÏyout
.
	gm¬k”
->
d¿w
(
·štInfo
, 
Ïyout
.
m©rix
);

115 
	gSVGM¬k”LayoutInfo
::
addLayou‹dM¬k”
(
R’d”SVGResourûM¬k”
* 
m¬k”
, cÚ¡ 
FlßtPošt
& 
Üigš
, 
ªgË
)

117 
ASSERT
(
m¬k”
);

118 
	gm_Ïyout
.
­³nd
(
M¬k”Layout
(
m¬k”
, m¬k”->
m¬k”T¿nsfÜm©iÚ
(
Üigš
, 
ªgË
, 
m_¡rokeWidth
)));

	@SVGMarkerLayoutInfo.h

20 #iâdeà
SVGM¬k”LayoutInfo_h


21 
	#SVGM¬k”LayoutInfo_h


	)

23 #ià
ENABLE
(
SVG
)

24 
	~"R’d”Objeù.h
"

25 
	~"SVGM¬k”D©a.h
"

26 
	~<wtf/NÚcİyabË.h
>

28 
Çme¥aû
 
	gWebCÜe
 {

30 
şass
 
	gP©h
;

31 
şass
 
	gR’d”SVGResourûM¬k”
;

33 
	sM¬k”Layout
 {

34 
M¬k”Layout
(
R’d”SVGResourûM¬k”
* 
m¬k”Obj
 = 0, 
AffšeT¿nsfÜm
 
m©rixObj
 = AffineTransform())

35 : 
m¬k”
(
m¬k”Obj
)

36 , 
m©rix
(
m©rixObj
)

38 
ASSERT
(
m¬k”
);

41 
R’d”SVGResourûM¬k”
* 
	gm¬k”
;

42 
AffšeT¿nsfÜm
 
	gm©rix
;

45 şas 
	cSVGM¬k”LayoutInfo
 : 
public
 
NÚcİyabË
 {

46 
public
:

47 
SVGM¬k”LayoutInfo
();

48 ~
SVGM¬k”LayoutInfo
();

50 
FlßtReù
 
ÿlcuÏ‹Bound¬›s
(
R’d”SVGResourûM¬k”
* 
¡¬tM¬k”
, R’d”SVGResourûM¬k”* 
midM¬k”
, R’d”SVGResourûM¬k”* 
’dM¬k”
, 
¡rokeWidth
, cÚ¡ 
P©h
&);

51 
d¿wM¬k”s
(
R’d”Objeù
::
PaštInfo
&);

54 
	gSVGM¬k”D©a
& 
m¬k”D©a
(è{  
	gm_m¬k”D©a
; }

55 
R’d”SVGResourûM¬k”
* 
midM¬k”
(ècÚ¡ {  
	gm_midM¬k”
; }

56 & 
–em’tIndex
(è{  
	gm_–em’tIndex
; }

57 
addLayou‹dM¬k”
(
R’d”SVGResourûM¬k”
*, cÚ¡ 
FlßtPošt
& 
Üigš
, 
ªgË
);

59 
	g´iv©e
:

60 
R’d”SVGResourûM¬k”
* 
m_midM¬k”
;

63 
	gm_–em’tIndex
;

64 
SVGM¬k”D©a
 
	gm_m¬k”D©a
;

65 
	gm_¡rokeWidth
;

68 
	gVeùÜ
<
	gM¬k”Layout
> 
	gm_Ïyout
;

	@SVGRenderSupport.cpp

26 
	~"cÚfig.h
"

28 #ià
ENABLE
(
SVG
)

29 
	~"SVGR’d”SuµÜt.h
"

31 
	~"AffšeT¿nsfÜm.h
"

32 
	~"Docum’t.h
"

33 
	~"ImageBufãr.h
"

34 
	~"R’d”Objeù.h
"

35 
	~"R’d”SVGCÚš”.h
"

36 
	~"R’d”SVGResourû.h
"

37 
	~"R’d”SVGResourûCl³r.h
"

38 
	~"R’d”SVGResourûM¬k”.h
"

39 
	~"R’d”SVGResourûMask”.h
"

40 
	~"R’d”V›w.h
"

41 
	~"SVGResourûF‹r.h
"

42 
	~"SVGStyËdEËm’t.h
"

43 
	~"SVGURIReã»nû.h
"

44 
	~"T¿nsfÜmS‹.h
"

45 
	~<wtf/Unu£dP¬am.h
>

47 
Çme¥aû
 
	gWebCÜe
 {

49 
	gSVGR’d”Ba£
::~
SVGR’d”Ba£
()

53 
IÁReù
 
SVGR’d”Ba£
::
ş³dOv”æowReùFÜR•ašt
(
R’d”Objeù
* 
objeù
, 
R’d”BoxMod–Objeù
* 
»·štCÚš”
)

56 ià(
	gobjeù
->
¡yË
()->
visib™y
(è!ğ
VISIBLE
 && !
objeù
->
’şosšgLay”
()->
hasVisibËCÚ‹Á
())

57  
IÁReù
();

61 
IÁReù
 
	g»·štReù
 = 
’şosšgIÁReù
(
objeù
->
»·štReùInLoÿlCoÜdš©es
());

62 
	gobjeù
->
compu‹ReùFÜR•ašt
(
»·štCÚš”
, 
»·štReù
);

63  
	g»·štReù
;

66 
	gSVGR’d”Ba£
::
compu‹ReùFÜR•ašt
(
R’d”Objeù
* 
objeù
, 
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
IÁReù
& 
»·štReù
, 
boŞ
 
fixed
)

68 
	gobjeù
->
¡yË
()->
svgStyË
()->
šæ©eFÜShadow
(
»·štReù
);

71 
	g»·štReù
 = 
objeù
->
loÿlToP¬’tT¿nsfÜm
().
m­Reù
(
»·štReù
);

72 
	gobjeù
->
·»Á
()->
compu‹ReùFÜR•ašt
(
»·štCÚš”
, 
»·štReù
, 
fixed
);

75 
	gSVGR’d”Ba£
::
m­LoÿlToCÚš”
(cÚ¡ 
R’d”Objeù
* 
objeù
, 
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
boŞ
 
fixed
 , boŞ 
u£T¿nsfÜms
, 
T¿nsfÜmS‹
& 
ŒªsfÜmS‹
)

77 
ASSERT
(!
fixed
);

78 
ASSERT
(
u£T¿nsfÜms
);

79 
	gŒªsfÜmS‹
.
­¶yT¿nsfÜm
(
objeù
->
loÿlToP¬’tT¿nsfÜm
());

80 
	gobjeù
->
·»Á
()->
m­LoÿlToCÚš”
(
»·štCÚš”
, 
fixed
, 
u£T¿nsfÜms
, 
ŒªsfÜmS‹
);

83 
boŞ
 
	gSVGR’d”Ba£
::
´•¬eToR’d”SVGCÚ‹Á
(
R’d”Objeù
* 
objeù
, R’d”Objeù::
PaštInfo
& 
·štInfo
, cÚ¡ 
FlßtReù
& 
»·štReù
, 
SVGResourûF‹r
*& 
f‹r
, SVGResourûF‹r* 
roÙF‹r
)

85 #ià!
ENABLE
(
FILTERS
)

86 
UNUSED_PARAM
(
f‹r
);

87 
UNUSED_PARAM
(
roÙF‹r
);

90 
ASSERT
(
objeù
);

91 
SVGEËm’t
* 
	gsvgEËm’t
 = 
¡©ic_ÿ¡
<SVGEËm’t*>(
objeù
->
node
());

92 
ASSERT
(
svgEËm’t
 && svgEËm’t->
docum’t
(è&& svgEËm’t->
isStyËd
());

94 
SVGStyËdEËm’t
* 
	g¡yËdEËm’t
 = 
¡©ic_ÿ¡
<SVGStyËdEËm’t*>(
svgEËm’t
);

95 cÚ¡ 
R’d”StyË
* 
	g¡yË
 = 
objeù
->
¡yË
();

96 
ASSERT
(
¡yË
);

98 cÚ¡ 
SVGR’d”StyË
* 
	gsvgStyË
 = 
¡yË
->
svgStyË
();

99 
ASSERT
(
svgStyË
);

102 
	gİac™y
 = 
¡yË
->
İac™y
();

103 ià(
	gİac™y
 < 1.0f) {

104 
	g·štInfo
.
	gcÚ‹xt
->
ş
(
»·štReù
);

105 
	g·štInfo
.
	gcÚ‹xt
->
begšT¿n¥¬’cyLay”
(
İac™y
);

108 ià(cÚ¡ 
ShadowD©a
* 
	gshadow
 = 
svgStyË
->
shadow
()) {

109 
·štInfo
.
cÚ‹xt
->
ş
(
»·štReù
);

110 
	g·štInfo
.
	gcÚ‹xt
->
£tShadow
(
IÁSize
(
shadow
->
x
(), shadow->
y
()), shadow->
blur
(), shadow->
cŞÜ
(), 
¡yË
->
cŞÜS·û
());

111 
	g·štInfo
.
	gcÚ‹xt
->
begšT¿n¥¬’cyLay”
(1.0f);

114 #ià
ENABLE
(
FILTERS
)

115 
AtomicSŒšg
 
f‹rId
(
svgStyË
->
f‹r
());

118 
AtomicSŒšg
 
ş³rId
(
svgStyË
->
şP©h
());

119 
AtomicSŒšg
 
mask”Id
(
svgStyË
->
maskEËm’t
());

121 
Docum’t
* 
	gdocum’t
 = 
objeù
->
docum’t
();

123 #ià
ENABLE
(
FILTERS
)

124 
SVGResourûF‹r
* 
	gÃwF‹r
 = 
g‘F‹rById
(
docum’t
, 
f‹rId
, 
objeù
);

125 ià(
	gÃwF‹r
 =ğ
roÙF‹r
) {

128 
f‹r
 = 0;

129 
	gf‹rId
 = 
SŒšg
();

131 
	gf‹r
 = 
ÃwF‹r
;

134 ià(
R’d”SVGResourûMask”
* 
	gmask”
 = 
g‘R’d”SVGResourûById
<R’d”SVGResourûMask”>(
docum’t
, 
	gmask”Id
)) {

135 ià(!
	gmask”
->
­¶yResourû
(
objeù
, 
·štInfo
.
cÚ‹xt
))

136  
	gçl£
;

137 } ià(!
	gmask”Id
.
isEm±y
())

138 
	gsvgEËm’t
->
docum’t
()->
acûssSVGEx‹nsiÚs
()->
addP’dšgResourû
(
mask”Id
, 
¡yËdEËm’t
);

140 ià(
R’d”SVGResourûCl³r
* 
	gş³r
 = 
g‘R’d”SVGResourûById
<R’d”SVGResourûCl³r>(
docum’t
, 
	gş³rId
))

141 
	gş³r
->
­¶yResourû
(
objeù
, 
·štInfo
.
cÚ‹xt
);

142 ià(!
	gş³rId
.
isEm±y
())

143 
	gsvgEËm’t
->
docum’t
()->
acûssSVGEx‹nsiÚs
()->
addP’dšgResourû
(
ş³rId
, 
¡yËdEËm’t
);

145 #ià
ENABLE
(
FILTERS
)

146 ià(
	gf‹r
) {

147 
	gf‹r
->
addCl›Á
(
¡yËdEËm’t
);

148 ià(!
	gf‹r
->
´•¬eF‹r
(
·štInfo
.
cÚ‹xt
, 
objeù
))

149  
	gçl£
;

150 } ià(!
	gf‹rId
.
isEm±y
())

151 
	gsvgEËm’t
->
docum’t
()->
acûssSVGEx‹nsiÚs
()->
addP’dšgResourû
(
f‹rId
, 
¡yËdEËm’t
);

154  
	gŒue
;

157 
	gSVGR’d”Ba£
::
fšishR’d”SVGCÚ‹Á
(
R’d”Objeù
* 
objeù
, R’d”Objeù::
PaštInfo
& 
·štInfo
, 
SVGResourûF‹r
*& 
f‹r
, 
G¿phicsCÚ‹xt
* 
§vedCÚ‹xt
)

159 #ià!
ENABLE
(
FILTERS
)

160 
UNUSED_PARAM
(
f‹r
);

161 
UNUSED_PARAM
(
§vedCÚ‹xt
);

164 
ASSERT
(
objeù
);

166 cÚ¡ 
R’d”StyË
* 
	g¡yË
 = 
objeù
->
¡yË
();

167 
ASSERT
(
¡yË
);

169 #ià
ENABLE
(
FILTERS
)

170 ià(
	gf‹r
) {

171 
	gf‹r
->
­¶yF‹r
(
·štInfo
.
cÚ‹xt
, 
objeù
);

172 
	g·štInfo
.
	gcÚ‹xt
 = 
§vedCÚ‹xt
;

176 
	gİac™y
 = 
¡yË
->
İac™y
();

177 ià(
	gİac™y
 < 1.0f)

178 
	g·štInfo
.
	gcÚ‹xt
->
’dT¿n¥¬’cyLay”
();

182 ià(
	g¡yË
->
svgStyË
()->
shadow
())

183 
	g·štInfo
.
	gcÚ‹xt
->
’dT¿n¥¬’cyLay”
();

186 
»nd”SubŒ“ToImage
(
ImageBufãr
* 
image
, 
R’d”Objeù
* 
™em
)

188 
ASSERT
(
™em
);

189 
ASSERT
(
image
);

190 
ASSERT
(
image
->
cÚ‹xt
());

191 
	gR’d”Objeù
::
PaštInfo
 
šfo
(
image
->
cÚ‹xt
(), 
IÁReù
(), 
PaštPha£FÜeground
, 0, 0, 0);

195 
R’d”SVGCÚš”
* 
	gsvgCÚš”
 = 0;

196 ià(
	g™em
 && i‹m->
isSVGCÚš”
())

197 
	gsvgCÚš”
 = 
toR’d”SVGCÚš”
(
™em
);

199 
boŞ
 
	gd¿wsCÚ‹Ás
 = 
svgCÚš”
 ? svgCÚš”->
d¿wsCÚ‹Ás
(è: 
çl£
;

200 ià(
	gsvgCÚš”
 && !
	gd¿wsCÚ‹Ás
)

201 
	gsvgCÚš”
->
£tD¿wsCÚ‹Ás
(
Œue
);

203 
	g™em
->
ÏyoutIfN“ded
();

204 
	g™em
->
·št
(
šfo
, 0, 0);

206 ià(
	gsvgCÚš”
 && !
	gd¿wsCÚ‹Ás
)

207 
	gsvgCÚš”
->
£tD¿wsCÚ‹Ás
(
çl£
);

210 
şampImageBufãrSizeToV›wpÜt
(
F¿meV›w
* 
äameV›w
, 
IÁSize
& 
size
)

212 ià(!
	gäameV›w
)

215 
	gv›wWidth
 = 
äameV›w
->
visibËWidth
();

216 
	gv›wHeight
 = 
äameV›w
->
visibËHeight
();

218 ià(
	gsize
.
width
(è> 
	gv›wWidth
)

219 
	gsize
.
£tWidth
(
v›wWidth
);

221 ià(
	gsize
.
height
(è> 
	gv›wHeight
)

222 
	gsize
.
£tHeight
(
v›wHeight
);

225 
FlßtReù
 
	gSVGR’d”Ba£
::
compu‹CÚš”BoundšgBox
(cÚ¡ 
R’d”Objeù
* 
cÚš”
, 
boŞ
 
šşudeAÎPaš‹dCÚ‹Á
)

227 
FlßtReù
 
	gboundšgBox
;

229 
R’d”Objeù
* 
	gcu¼’t
 = 
cÚš”
->
fœ¡Chd
();

230 ; 
	gcu¼’t
 !ğ0; cu¼’ˆğ
cu¼’t
->
ÃxtSiblšg
()) {

231 
FlßtReù
 
chdBBox
 = 
šşudeAÎPaš‹dCÚ‹Á
 ? 
cu¼’t
->
»·štReùInLoÿlCoÜdš©es
(è: cu¼’t->
objeùBoundšgBox
();

232 
FlßtReù
 
	gchdBBoxInLoÿlCoÜds
 = 
cu¼’t
->
loÿlToP¬’tT¿nsfÜm
().
m­Reù
(
chdBBox
);

233 
	gboundšgBox
.
un™e
(
chdBBoxInLoÿlCoÜds
);

236  
	gboundšgBox
;

239 
	gSVGR’d”Ba£
::
ÏyoutChd»n
(
R’d”Objeù
* 
¡¬t
, 
boŞ
 
£lfN“dsLayout
)

241 
R’d”Objeù
* 
	gchd
 = 
¡¬t
->
fœ¡Chd
(); chd; chd = 
chd
->
ÃxtSiblšg
()) {

246 
boŞ
 
ÃedsLayout
 = 
£lfN“dsLayout
;

247 ià(!
	gÃedsLayout
) {

248 ià(
SVGEËm’t
* 
	g–em’t
 = 
chd
->
node
()->
isSVGEËm’t
(è? 
¡©ic_ÿ¡
<SVGElement*>(child->node()) : 0) {

249 ià(
–em’t
->
isStyËd
())

250 
ÃedsLayout
 = 
¡©ic_ÿ¡
<
SVGStyËdEËm’t
*>(
–em’t
)->
hasR–©iveV®ues
();

254 ià(
	gÃedsLayout
)

255 
	gchd
->
£tN“dsLayout
(
Œue
, 
çl£
);

257 
	gchd
->
ÏyoutIfN“ded
();

258 
ASSERT
(!
chd
->
ÃedsLayout
());

262 
boŞ
 
	gSVGR’d”Ba£
::
isOv”æowHidd’
(cÚ¡ 
R’d”Objeù
* 
objeù
)

265 
ASSERT
(
objeù
->
¡yË
()->
ov”æowX
(è=ğobjeù->¡yË()->
ov”æowY
());

268 
ASSERT
(
objeù
->
¡yË
()->
ov”æowX
(è!ğ
OSCROLL
);

271 
ASSERT
(!
objeù
->
isRoÙ
());

273  
	gobjeù
->
¡yË
()->
ov”æowX
(è=ğ
OHIDDEN
;

276 
FlßtReù
 
	gSVGR’d”Ba£
::
f‹rBoundšgBoxFÜR’d””
(cÚ¡ 
R’d”Objeù
* 
objeù
) const

278 #ià
ENABLE
(
FILTERS
)

279 
SVGResourûF‹r
* 
f‹r
 = 
g‘F‹rById
(
objeù
->
docum’t
(), objeù->
¡yË
()->
svgStyË
()->filter(), object);

280 ià(
	gf‹r
)

281  
	gf‹r
->
f‹rBoundšgBox
(
objeù
->
objeùBoundšgBox
());

283 
UNUSED_PARAM
(
objeù
);

285  
FlßtReù
();

288 
FlßtReù
 
	gSVGR’d”Ba£
::
ş³rBoundšgBoxFÜR’d””
(cÚ¡ 
R’d”Objeù
* 
objeù
) const

290 ià(
R’d”SVGResourûCl³r
* 
ş³r
 = 
g‘R’d”SVGResourûById
<R’d”SVGResourûCl³r>(
objeù
->
docum’t
(), 
	gobjeù
->
¡yË
()->
svgStyË
()->
şP©h
()))

291  
	gş³r
->
»sourûBoundšgBox
(
objeù
->
objeùBoundšgBox
());

293  
FlßtReù
();

296 
FlßtReù
 
	gSVGR’d”Ba£
::
mask”BoundšgBoxFÜR’d””
(cÚ¡ 
R’d”Objeù
* 
objeù
) const

298 ià(
R’d”SVGResourûMask”
* 
mask”
 = 
g‘R’d”SVGResourûById
<R’d”SVGResourûMask”>(
objeù
->
docum’t
(), 
	gobjeù
->
¡yË
()->
svgStyË
()->
maskEËm’t
()))

299  
	gmask”
->
»sourûBoundšgBox
(
objeù
->
objeùBoundšgBox
());

301  
FlßtReù
();

304 
d”egi¡”FromResourûs
(
R’d”Objeù
* 
objeù
)

307 ià(
R’d”SVGResourûMask”
* 
	gmask”
 = 
g‘R’d”SVGResourûById
<R’d”SVGResourûMask”>(
objeù
->
docum’t
(), 
	gobjeù
->
¡yË
()->
svgStyË
()->
maskEËm’t
()))

308 
	gmask”
->
šv®id©eCl›Á
(
objeù
);

309 ià(
R’d”SVGResourûCl³r
* 
	gş³r
 = 
g‘R’d”SVGResourûById
<R’d”SVGResourûCl³r>(
objeù
->
docum’t
(), 
	gobjeù
->
¡yË
()->
svgStyË
()->
şP©h
()))

310 
	gş³r
->
šv®id©eCl›Á
(
objeù
);

311 ià(
R’d”SVGResourûM¬k”
* 
	g¡¬tM¬k”
 = 
g‘R’d”SVGResourûById
<R’d”SVGResourûM¬k”>(
objeù
->
docum’t
(), 
	gobjeù
->
¡yË
()->
svgStyË
()->
¡¬tM¬k”
()))

312 
	g¡¬tM¬k”
->
šv®id©eCl›Á
(
objeù
);

313 ià(
R’d”SVGResourûM¬k”
* 
	gmidM¬k”
 = 
g‘R’d”SVGResourûById
<R’d”SVGResourûM¬k”>(
objeù
->
docum’t
(), 
	gobjeù
->
¡yË
()->
svgStyË
()->
midM¬k”
()))

314 
	gmidM¬k”
->
šv®id©eCl›Á
(
objeù
);

315 ià(
R’d”SVGResourûM¬k”
* 
	g’dM¬k”
 = 
g‘R’d”SVGResourûById
<R’d”SVGResourûM¬k”>(
objeù
->
docum’t
(), 
	gobjeù
->
¡yË
()->
svgStyË
()->
’dM¬k”
()))

316 
	g’dM¬k”
->
šv®id©eCl›Á
(
objeù
);

319 
­¶yT¿nsfÜmToPaštInfo
(
R’d”Objeù
::
PaštInfo
& 
·štInfo
, cÚ¡ 
AffšeT¿nsfÜm
& 
loÿlToAnû¡ÜT¿nsfÜm
)

321 ià(
	gloÿlToAnû¡ÜT¿nsfÜm
.
isId’t™y
())

324 
	g·štInfo
.
	gcÚ‹xt
->
cÚÿtCTM
(
loÿlToAnû¡ÜT¿nsfÜm
);

325 
	g·štInfo
.
	g»ù
 = 
loÿlToAnû¡ÜT¿nsfÜm
.
šv”£
().
m­Reù
(
·štInfo
.
»ù
);

328 cÚ¡ 
R’d”Objeù
* 
fšdTextRoÙObjeù
(cÚ¡ R’d”Objeù* 
¡¬t
)

330 
	g¡¬t
 && !¡¬t->
isSVGText
())

331 
	g¡¬t
 = 
¡¬t
->
·»Á
();

332 
ASSERT
(
¡¬t
);

333 
ASSERT
(
¡¬t
->
isSVGText
());

335  
	g¡¬t
;

	@SVGRenderSupport.h

24 #iâdeà
SVGR’d”Ba£_h


25 
	#SVGR’d”Ba£_h


	)

27 #ià
ENABLE
(
SVG
)

28 
	~"R’d”Objeù.h
"

29 
	~"SVGEËm’t.h
"

30 
	~"SVGStyËdEËm’t.h
"

32 
Çme¥aû
 
	gWebCÜe
 {

34 
şass
 
	gSVGResourûF‹r
;

35 
şass
 
	gImageBufãr
;

41 şas 
	cSVGR’d”Ba£
 {

42 
	gpublic
:

43 
vœtu®
 ~
SVGR’d”Ba£
();

45 
vœtu®
 cÚ¡ 
SVGR’d”Ba£
* 
toSVGR’d”Ba£
(ècÚ¡ {  
	gthis
; }

50 
boŞ
 
´•¬eToR’d”SVGCÚ‹Á
(
R’d”Objeù
*, R’d”Objeù::
PaštInfo
&, cÚ¡ 
FlßtReù
& 
boundšgBox
, 
SVGResourûF‹r
*&, SVGResourûF‹r* 
roÙF‹r
 = 0);

51 
fšishR’d”SVGCÚ‹Á
(
R’d”Objeù
*, R’d”Objeù::
PaštInfo
&, 
SVGResourûF‹r
*&, 
G¿phicsCÚ‹xt
* 
§vedCÚ‹xt
);

54 
ÏyoutChd»n
(
R’d”Objeù
*, 
boŞ
 
£lfN“dsLayout
);

57 
boŞ
 
isOv”æowHidd’
(cÚ¡ 
R’d”Objeù
*);

59 
vœtu®
 
FlßtReù
 
¡rokeBoundšgBox
() const {  FloatRect(); }

60 
vœtu®
 
FlßtReù
 
m¬k”BoundšgBox
() const {  FloatRect(); }

63 
FlßtReù
 
f‹rBoundšgBoxFÜR’d””
(cÚ¡ 
R’d”Objeù
*) const;

64 
FlßtReù
 
ş³rBoundšgBoxFÜR’d””
(cÚ¡ 
R’d”Objeù
*) const;

65 
FlßtReù
 
mask”BoundšgBoxFÜR’d””
(cÚ¡ 
R’d”Objeù
*) const;

67 
	g´Ùeùed
:

68 
IÁReù
 
ş³dOv”æowReùFÜR•ašt
(
R’d”Objeù
*, 
R’d”BoxMod–Objeù
* 
»·štCÚš”
);

69 
compu‹ReùFÜR•ašt
(
R’d”Objeù
*, 
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
IÁReù
&, 
boŞ
 
fixed
);

71 
m­LoÿlToCÚš”
(cÚ¡ 
R’d”Objeù
*, 
R’d”BoxMod–Objeù
* 
»·štCÚš”
, 
boŞ
 
u£T¿nsfÜms
, boŞ 
fixed
, 
T¿nsfÜmS‹
&);

75 
FlßtReù
 
compu‹CÚš”BoundšgBox
(cÚ¡ 
R’d”Objeù
* 
cÚš”
, 
boŞ
 
šşudeAÎPaš‹dCÚ‹Á
);

80 
­¶yT¿nsfÜmToPaštInfo
(
R’d”Objeù
::
PaštInfo
&, cÚ¡ 
AffšeT¿nsfÜm
& 
loÿlToChdT¿nsfÜm
);

83 
»nd”SubŒ“ToImage
(
ImageBufãr
*, 
R’d”Objeù
*);

85 
d”egi¡”FromResourûs
(
R’d”Objeù
*);

86 
şampImageBufãrSizeToV›wpÜt
(
F¿meV›w
*, 
IÁSize
& 
imageBufãrSize
);

88 cÚ¡ 
R’d”Objeù
* 
fšdTextRoÙObjeù
(cÚ¡ R’d”Objeù* 
¡¬t
);

	@SVGRenderTreeAsText.cpp

28 
	~"cÚfig.h
"

30 #ià
ENABLE
(
SVG
)

31 
	~"SVGR’d”T»eAsText.h
"

33 
	~"G¿phicsTy³s.h
"

34 
	~"HTMLNames.h
"

35 
	~"IÆšeTextBox.h
"

36 
	~"NodeR’d”StyË.h
"

37 
	~"P©h.h
"

38 
	~"R’d”Image.h
"

39 
	~"R’d”P©h.h
"

40 
	~"R’d”SVGCÚš”.h
"

41 
	~"R’d”SVGIÆšeText.h
"

42 
	~"R’d”SVGResourûCl³r.h
"

43 
	~"R’d”SVGResourûM¬k”.h
"

44 
	~"R’d”SVGResourûMask”.h
"

45 
	~"R’d”SVGRoÙ.h
"

46 
	~"R’d”SVGText.h
"

47 
	~"R’d”T»eAsText.h
"

48 
	~"SVGCh¬aù”LayoutInfo.h
"

49 
	~"SVGIÆšeTextBox.h
"

50 
	~"SVGPaštS”v”G¿d›Á.h
"

51 
	~"SVGPaštS”v”P©‹º.h
"

52 
	~"SVGPaštS”v”SŞid.h
"

53 
	~"SVGRoÙIÆšeBox.h
"

54 
	~"SVGStyËdEËm’t.h
"

55 
	~<m©h.h
>

57 
Çme¥aû
 
	gWebCÜe
 {

63 şas 
	cTextSŒ—mS•¬©Ü
 {

64 
	gpublic
:

65 
TextSŒ—mS•¬©Ü
(cÚ¡ 
SŒšg
& 
s
)

66 : 
m_£·¿tÜ
(
s
)

67 , 
m_ÃedToS•¬©e
(
çl£
)

71 
	g´iv©e
:

72 
ä›nd
 
TextSŒ—m
& 
İ”©Ü
<<(TextSŒ—m&, 
	gTextSŒ—mS•¬©Ü
&);

74 
SŒšg
 
	gm_£·¿tÜ
;

75 
boŞ
 
	gm_ÃedToS•¬©e
;

78 
	gTextSŒ—m
& 
	gİ”©Ü
<<(TextSŒ—m& 
	gts
, 
	gTextSŒ—mS•¬©Ü
& 
	g£p
)

80 ià(
	g£p
.
	gm_ÃedToS•¬©e
)

81 
	gts
 << 
	g£p
.
	gm_£·¿tÜ
;

83 
	g£p
.
	gm_ÃedToS•¬©e
 = 
Œue
;

84  
	gts
;

87 
	g‹m¶©e
<
ty³Çme
 
	gV®ueTy³
>

88 
	$wr™eNameV®uePaœ
(
TextSŒ—m
& 
ts
, cÚ¡ * 
Çme
, 
V®ueTy³
 
v®ue
)

90 
ts
 << " [" << 
Çme
 << "=" << 
v®ue
 << "]";

91 
	}
}

93 
	g‹m¶©e
<
ty³Çme
 
	gV®ueTy³
>

94 
	$wr™eNameAndQuÙedV®ue
(
TextSŒ—m
& 
ts
, cÚ¡ * 
Çme
, 
V®ueTy³
 
v®ue
)

96 
ts
 << " [" << 
Çme
 << "=\"" << 
v®ue
 << "\"]";

97 
	}
}

99 
	$wr™eIfNÙEm±y
(
TextSŒ—m
& 
ts
, cÚ¡ * 
Çme
, cÚ¡ 
SŒšg
& 
v®ue
)

101 ià(!
v®ue
.
	`isEm±y
())

102 
	`wr™eNameV®uePaœ
(
ts
, 
Çme
, 
v®ue
);

103 
	}
}

105 
	g‹m¶©e
<
ty³Çme
 
	gV®ueTy³
>

106 
	$wr™eIfNÙDeçuÉ
(
TextSŒ—m
& 
ts
, cÚ¡ * 
Çme
, 
V®ueTy³
 
v®ue
, V®ueTy³ 
deçuÉV®ue
)

108 ià(
v®ue
 !ğ
deçuÉV®ue
)

109 
	`wr™eNameV®uePaœ
(
ts
, 
Çme
, 
v®ue
);

110 
	}
}

112 
	gTextSŒ—m
& 
	gİ”©Ü
<<(TextSŒ—m& 
	gts
, cÚ¡ 
	gIÁPošt
& 
	gp
)

114  
	gts
 << "(" << 
	gp
.
x
(è<< "," <<….
y
() << ")";

117 
	gTextSŒ—m
& 
	gİ”©Ü
<<(TextSŒ—m& 
	gts
, cÚ¡ 
	gIÁReù
& 
	gr
)

119  
	gts
 << "© (" << 
	gr
.
x
(è<< "," <<„.
y
(è<< "èsiz" <<„.
width
(è<< "x" <<„.
height
();

122 
boŞ
 
	$hasF¿ùiÚs
(
v®
)

124 
•sÚ
 = 0.0001;

125 
iv®
 = 
¡©ic_ÿ¡
<>(
v®
);

126 
dv®
 = 
¡©ic_ÿ¡
<>(
iv®
);

127  
	`çbs
(
v®
 - 
dv®
è> 
•sÚ
;

128 
	}
}

130 
	gTextSŒ—m
& 
	gİ”©Ü
<<(TextSŒ—m& 
	gts
, cÚ¡ 
	gFlßtReù
 &
	gr
)

132 
	gts
 << "at (";

133 ià(
hasF¿ùiÚs
(
r
.
x
()))

134 
	gts
 << 
	gr
.
x
();

136 
	gts
 << (
	gr
.
x
());

137 
	gts
 << ",";

138 ià(
hasF¿ùiÚs
(
r
.
y
()))

139 
	gts
 << 
	gr
.
y
();

141 
	gts
 << (
	gr
.
y
());

142 
	gts
 << ") size ";

143 ià(
hasF¿ùiÚs
(
r
.
width
()))

144 
	gts
 << 
	gr
.
width
();

146 
	gts
 << (
	gr
.
width
());

147 
	gts
 << "x";

148 ià(
hasF¿ùiÚs
(
r
.
height
()))

149 
	gts
 << 
	gr
.
height
();

151 
	gts
 << (
	gr
.
height
());

152  
	gts
;

155 
	gTextSŒ—m
& 
	gİ”©Ü
<<(TextSŒ—m& 
	gts
, cÚ¡ 
	gFlßtPošt
& 
	gp
)

157 
	gts
 << "(";

158 ià(
hasF¿ùiÚs
(
p
.
x
()))

159 
	gts
 << 
	gp
.
x
();

161 
	gts
 << (
	gp
.
x
());

162 
	gts
 << ",";

163 ià(
hasF¿ùiÚs
(
p
.
y
()))

164 
	gts
 << 
	gp
.
y
();

166 
	gts
 << (
	gp
.
y
());

167  
	gts
 << ")";

170 
	gTextSŒ—m
& 
	gİ”©Ü
<<(TextSŒ—m& 
	gts
, cÚ¡ 
	gFlßtSize
& 
	gs
)

172 
	gts
 << "width=";

173 ià(
hasF¿ùiÚs
(
s
.
width
()))

174 
	gts
 << 
	gs
.
width
();

176 
	gts
 << (
	gs
.
width
());

177 
	gts
 << " height=";

178 ià(
hasF¿ùiÚs
(
s
.
height
()))

179 
	gts
 << 
	gs
.
height
();

181 
	gts
 << (
	gs
.
height
());

182  
	gts
;

185 
	gTextSŒ—m
& 
	gİ”©Ü
<<(TextSŒ—m& 
	gts
, cÚ¡ 
	gAffšeT¿nsfÜm
& 
	gŒªsfÜm
)

187 ià(
	gŒªsfÜm
.
isId’t™y
())

188 
	gts
 << "identity";

190 
	gts
 << "{m=(("

191 << 
	gŒªsfÜm
.
a
(è<< "," <<¿nsfÜm.
b
()

193 << 
	gŒªsfÜm
.
c
(è<< "," <<¿nsfÜm.
d
()

195 << 
	gŒªsfÜm
.
e
(è<< "," <<¿nsfÜm.
f
()

198  
	gts
;

201 
	gTextSŒ—m
& 
	gİ”©Ü
<<(TextSŒ—m& 
	gts
, cÚ¡ 
WšdRuË
 
	gruË
)

203 
	gruË
) {

204 
	gRULE_NONZERO
:

205 
ts
 << "NON-ZERO";

207 
	gRULE_EVENODD
:

208 
ts
 << "EVEN-ODD";

212  
	gts
;

215 
	gTextSŒ—m
& 
	gİ”©Ü
<<(TextSŒ—m& 
	gts
, cÚ¡ 
	gSVGUn™Ty³s
::
SVGUn™Ty³
& 
un™Ty³
)

217 
un™Ty³
) {

218 
SVGUn™Ty³s
::
SVG_UNIT_TYPE_UNKNOWN
:

219 
ts
 << "unknown";

221 
	gSVGUn™Ty³s
::
SVG_UNIT_TYPE_USERSPACEONUSE
:

222 
ts
 << "userSpaceOnUse";

224 
	gSVGUn™Ty³s
::
SVG_UNIT_TYPE_OBJECTBOUNDINGBOX
:

225 
ts
 << "objectBoundingBox";

229  
	gts
;

232 
	gTextSŒ—m
& 
	gİ”©Ü
<<(TextSŒ—m& 
	gts
, cÚ¡ 
	gSVGM¬k”EËm’t
::
SVGM¬k”Un™sTy³
& 
m¬k”Un™
)

234 
m¬k”Un™
) {

235 
SVGM¬k”EËm’t
::
SVG_MARKERUNITS_UNKNOWN
:

236 
ts
 << "unknown";

238 
	gSVGM¬k”EËm’t
::
SVG_MARKERUNITS_USERSPACEONUSE
:

239 
ts
 << "userSpaceOnUse";

241 
	gSVGM¬k”EËm’t
::
SVG_MARKERUNITS_STROKEWIDTH
:

242 
ts
 << "strokeWidth";

246  
	gts
;

249 
	gTextSŒ—m
& 
	gİ”©Ü
<<(TextSŒ—m& 
	gts
, cÚ¡ 
	gCŞÜ
& 
	gc
)

251  
	gts
 << 
	gc
.
Çme
();

254 
	$wr™eInd’t
(
TextSŒ—m
& 
ts
, 
šd’t
)

256 
i
 = 0; i !ğ
šd’t
; ++i)

257 
ts
 << " ";

258 
	}
}

261 
	gTextSŒ—m
& 
	gİ”©Ü
<<(TextSŒ—m& 
	gts
, cÚ¡ 
	gDashA¼ay
& 
	ga
)

263 
	gts
 << "{";

264 
	gDashA¼ay
::
cÚ¡_™”©Ü
 
’d
 = 
a
.end();

265 
	gDashA¼ay
::
cÚ¡_™”©Ü
 
™
 = 
a
.
begš
(); 
	g™
 !ğ
’d
; ++it) {

266 ià(
	g™
 !ğ
a
.
begš
())

267 
ts
 << ", ";

268 
	gts
 << *
	g™
;

270 
	gts
 << "}";

271  
	gts
;

275 
	gTextSŒ—m
& 
	gİ”©Ü
<<(TextSŒ—m& 
	gts
, 
LšeC­
 
	g¡yË
)

277 
	g¡yË
) {

278 
	gBu‰C­
:

279 
ts
 << "BUTT";

281 
	gRoundC­
:

282 
ts
 << "ROUND";

284 
	gSqu¬eC­
:

285 
ts
 << "SQUARE";

288  
	gts
;

292 
	gTextSŒ—m
& 
	gİ”©Ü
<<(TextSŒ—m& 
	gts
, 
LšeJoš
 
	g¡yË
)

294 
	g¡yË
) {

295 
	gM™”Još
:

296 
ts
 << "MITER";

298 
	gRoundJoš
:

299 
ts
 << "ROUND";

301 
	gBev–Još
:

302 
ts
 << "BEVEL";

305  
	gts
;

308 
	$wr™eStyË
(
TextSŒ—m
& 
ts
, cÚ¡ 
R’d”Objeù
& 
objeù
)

310 cÚ¡ 
R’d”StyË
* 
¡yË
 = 
objeù
.
	`¡yË
();

311 cÚ¡ 
SVGR’d”StyË
* 
svgStyË
 = 
¡yË
->
	`svgStyË
();

313 ià(!
objeù
.
	`loÿlT¿nsfÜm
().
	`isId’t™y
())

314 
	`wr™eNameV®uePaœ
(
ts
, "ŒªsfÜm", 
objeù
.
	`loÿlT¿nsfÜm
());

315 
	`wr™eIfNÙDeçuÉ
(
ts
, "imag»nd”šg", 
svgStyË
->
	`imageR’d”šg
(), 
SVGR’d”StyË
::
	`š™ŸlImageR’d”šg
());

316 
	`wr™eIfNÙDeçuÉ
(
ts
, "İac™y", 
¡yË
->
	`İac™y
(), 
R’d”StyË
::
	`š™ŸlO·c™y
());

317 ià(
objeù
.
	`isR’d”P©h
()) {

318 cÚ¡ 
R’d”P©h
& 
·th
 = 
¡©ic_ÿ¡
<cÚ¡ R’d”P©h&>(
objeù
);

319 
SVGPaštS”v”
* 
¡rokePaštS”v”
 = SVGPaštS”v”::
	`¡rokePaštS”v”
(
¡yË
, &
·th
);

320 ià(
¡rokePaštS”v”
) {

321 
TextSŒ—mS•¬©Ü
 
	`s
(" ");

322 
ts
 << " [stroke={";

323 ià(
¡rokePaštS”v”
)

324 
ts
 << 
s
 << *
¡rokePaštS”v”
;

326 
dashOff£t
 = 
SVGR’d”StyË
::
	`cssPrim™iveToL’gth
(&
·th
, 
svgStyË
->
	`¡rokeDashOff£t
(), 0.0f);

327 cÚ¡ 
DashA¼ay
& 
dashA¼ay
 = 
	`dashA¼ayFromR’d”šgStyË
(
¡yË
, 
objeù
.
	`docum’t
()->
	`docum’tEËm’t
()->
	`»nd”StyË
());

328 
¡rokeWidth
 = 
SVGR’d”StyË
::
	`cssPrim™iveToL’gth
(&
·th
, 
svgStyË
->
	`¡rokeWidth
(), 1.0f);

330 
	`wr™eIfNÙDeçuÉ
(
ts
, "İac™y", 
svgStyË
->
	`¡rokeO·c™y
(), 1.0f);

331 
	`wr™eIfNÙDeçuÉ
(
ts
, "¡rokwidth", 
¡rokeWidth
, 1.0);

332 
	`wr™eIfNÙDeçuÉ
(
ts
, "m™”†im™", 
svgStyË
->
	`¡rokeM™”Lim™
(), 4.0f);

333 
	`wr™eIfNÙDeçuÉ
(
ts
, "lšÿp", 
svgStyË
->
	`ÿpStyË
(), 
Bu‰C­
);

334 
	`wr™eIfNÙDeçuÉ
(
ts
, "lšjoš", 
svgStyË
->
	`jošStyË
(), 
M™”Još
);

335 
	`wr™eIfNÙDeçuÉ
(
ts
, "dash off£t", 
dashOff£t
, 0.0);

336 ià(!
dashA¼ay
.
	`isEm±y
())

337 
	`wr™eNameV®uePaœ
(
ts
, "dash‡¼ay", 
dashA¼ay
);

339 
ts
 << "}]";

341 
SVGPaštS”v”
* 
flPaštS”v”
 = SVGPaštS”v”::
	`flPaštS”v”
(
¡yË
, &
·th
);

342 ià(
flPaštS”v”
) {

343 
TextSŒ—mS•¬©Ü
 
	`s
(" ");

344 
ts
 << " [fill={";

345 ià(
flPaštS”v”
)

346 
ts
 << 
s
 << *
flPaštS”v”
;

348 
	`wr™eIfNÙDeçuÉ
(
ts
, "İac™y", 
svgStyË
->
	`flO·c™y
(), 1.0f);

349 
	`wr™eIfNÙDeçuÉ
(
ts
, "fÈruË", 
svgStyË
->
	`flRuË
(), 
RULE_NONZERO
);

350 
ts
 << "}]";

352 
	`wr™eIfNÙDeçuÉ
(
ts
, "ş„uË", 
svgStyË
->
	`şRuË
(), 
RULE_NONZERO
);

355 
	`wr™eIfNÙEm±y
(
ts
, "¡¬ˆm¬k”", 
svgStyË
->
	`¡¬tM¬k”
());

356 
	`wr™eIfNÙEm±y
(
ts
, "middË m¬k”", 
svgStyË
->
	`midM¬k”
());

357 
	`wr™eIfNÙEm±y
(
ts
, "’d m¬k”", 
svgStyË
->
	`’dM¬k”
());

358 
	`wr™eIfNÙEm±y
(
ts
, "f‹r", 
svgStyË
->
	`f‹r
());

359 
	}
}

361 
	gTextSŒ—m
& 
	$wr™ePos™iÚAndStyË
(
TextSŒ—m
& 
ts
, cÚ¡ 
R’d”Objeù
& 
objeù
)

363 
ts
 << " " << 
cÚ¡_ÿ¡
<
R’d”Objeù
&>(
objeù
).
	`absŞu‹Cl³dOv”æowReù
();

364 
	`wr™eStyË
(
ts
, 
objeù
);

365  
ts
;

366 
	}
}

368 
	gTextSŒ—m
& 
	gİ”©Ü
<<(TextSŒ—m& 
	gts
, cÚ¡ 
	gR’d”P©h
& 
	g·th
)

370 
wr™ePos™iÚAndStyË
(
ts
, 
·th
);

371 
wr™eNameAndQuÙedV®ue
(
ts
, "d©a", 
·th
.·th().
debugSŒšg
());

372  
	gts
;

375 
	gTextSŒ—m
& 
	gİ”©Ü
<<(TextSŒ—m& 
	gts
, cÚ¡ 
	gR’d”SVGRoÙ
& 
	groÙ
)

377  
wr™ePos™iÚAndStyË
(
ts
, 
roÙ
);

380 
	$wr™eR’d”SVGTextBox
(
TextSŒ—m
& 
ts
, cÚ¡ 
R’d”Block
& 
‹xt
)

382 
SVGRoÙIÆšeBox
* 
box
 = 
¡©ic_ÿ¡
<SVGRoÙIÆšeBox*>(
‹xt
.
	`fœ¡RoÙBox
());

384 ià(!
box
)

387 
VeùÜ
<
SVGTextChunk
>& 
chunks
 = 
cÚ¡_ÿ¡
<VeùÜ<SVGTextChunk>& >(
box
->
	`svgTextChunks
());

388 
ts
 << "‡ˆ(" << 
‹xt
.
	`x
(è<< "," <<ext.
	`y
(è<< "èsiz" << 
box
->
	`width
(è<< "x" << box->
	`height
(è<< " cÚš " << 
chunks
.
	`size
() << " chunk(s)";

390 ià(
‹xt
.
	`·»Á
(è&& (‹xt.·»Á()->
	`¡yË
()->
	`cŞÜ
() !=ext.style()->color()))

391 
	`wr™eNameV®uePaœ
(
ts
, "cŞÜ", 
‹xt
.
	`¡yË
()->
	`cŞÜ
().
	`Çme
());

392 
	}
}

394 
šlše
 
boŞ
 
	$cÚšsIÆšeTextBox
(
SVGTextChunk
& 
chunk
, 
SVGIÆšeTextBox
* 
box
)

396 
VeùÜ
<
SVGIÆšeBoxCh¬aù”Rªge
>::
™”©Ü
 
boxIt
 = 
chunk
.
boxes
.
	`begš
();

397 
VeùÜ
<
SVGIÆšeBoxCh¬aù”Rªge
>::
™”©Ü
 
boxEnd
 = 
chunk
.
boxes
.
	`’d
();

399 
boŞ
 
found
 = 
çl£
;

400 ; 
boxIt
 !ğ
boxEnd
; ++boxIt) {

401 
SVGIÆšeBoxCh¬aù”Rªge
& 
¿nge
 = *
boxIt
;

403 ià(
box
 =ğ
¡©ic_ÿ¡
<
SVGIÆšeTextBox
*>(
¿nge
.box)) {

404 
found
 = 
Œue
;

409  
found
;

410 
	}
}

412 
šlše
 
	$wr™eSVGIÆšeTextBox
(
TextSŒ—m
& 
ts
, 
SVGIÆšeTextBox
* 
‹xtBox
, 
šd’t
)

414 
SVGRoÙIÆšeBox
* 
roÙBox
 = 
‹xtBox
->
	`svgRoÙIÆšeBox
();

415 ià(!
roÙBox
)

418 
VeùÜ
<
SVGTextChunk
>& 
chunks
 = 
cÚ¡_ÿ¡
<VeùÜ<SVGTextChunk>& >(
roÙBox
->
	`svgTextChunks
());

420 
VeùÜ
<
SVGTextChunk
>::
™”©Ü
 
™
 = 
chunks
.
	`begš
();

421 
VeùÜ
<
SVGTextChunk
>::
™”©Ü
 
’d
 = 
chunks
.
	`’d
();

424 
i
 = 1;

425 ; 
™
 !ğ
’d
; ++it) {

426 
SVGTextChunk
& 
cur
 = *
™
;

429 
VeùÜ
<
SVGIÆšeBoxCh¬aù”Rªge
>::
™”©Ü
 
boxIt
 = 
cur
.
boxes
.
	`begš
();

430 
VeùÜ
<
SVGIÆšeBoxCh¬aù”Rªge
>::
™”©Ü
 
boxEnd
 = 
cur
.
boxes
.
	`’d
();

432 ià(!
	`cÚšsIÆšeTextBox
(
cur
, 
‹xtBox
)) {

433 
i
++;

437 
	`wr™eInd’t
(
ts
, 
šd’t
 + 1);

439 
j
 = 1;

440 
ts
 << "chunk " << 
i
 << " ";

442 ià(
cur
.
ªchÜ
 =ğ
TA_MIDDLE
) {

443 
ts
 << "(middle‡nchor";

444 ià(
cur
.
isV”tiÿlText
)

445 
ts
 << ", vertical";

446 
ts
 << ") ";

447 } ià(
cur
.
ªchÜ
 =ğ
TA_END
) {

448 
ts
 << "(end‡nchor";

449 ià(
cur
.
isV”tiÿlText
)

450 
ts
 << ", vertical";

451 
ts
 << ") ";

452 } ià(
cur
.
isV”tiÿlText
)

453 
ts
 << "(vertical) ";

455 
tÙ®Off£t
 = 0;

457 ; 
boxIt
 !ğ
boxEnd
; ++boxIt) {

458 
SVGIÆšeBoxCh¬aù”Rªge
& 
¿nge
 = *
boxIt
;

460 
off£t
 = 
¿nge
.
’dOff£t
 -„ªge.
¡¬tOff£t
;

461 
	`ASSERT
(
cur
.
¡¬t
 + 
tÙ®Off£t
 <ğcur.
’d
);

463 
tÙ®Off£t
 +ğ
off£t
;

465 ià(
‹xtBox
 !ğ
¡©ic_ÿ¡
<
SVGIÆšeTextBox
*>(
¿nge
.
box
)) {

466 
j
++;

470 
FlßtPošt
 
tİLeá
 = 
	`tİLeáPos™iÚOfCh¬aù”Rªge
(
cur
.
¡¬t
 + 
tÙ®Off£t
 - 
off£t
, cur.start +otalOffset);

472 
ts
 << "‹xˆruÀ" << 
j
 << "‡ˆ(" << 
tİLeá
.
	`x
(è<< "," <<İLeá.
	`y
() << ") ";

473 
ts
 << "¡¬tOff£ˆ" << 
¿nge
.
¡¬tOff£t
 << "ƒndOff£ˆ" <<„ªge.
’dOff£t
;

475 ià(
cur
.
isV”tiÿlText
)

476 
ts
 << " heighˆ" << 
	`cummuÏ‹dHeightOfIÆšeBoxCh¬aù”Rªge
(
¿nge
);

478 
ts
 << " width " << 
	`cummuÏ‹dWidthOfIÆšeBoxCh¬aù”Rªge
(
¿nge
);

480 ià(
‹xtBox
->
	`dœeùiÚ
(è=ğ
RTL
 ||extBox->
m_dœOv”ride
) {

481 
ts
 << (
‹xtBox
->
	`dœeùiÚ
(è=ğ
RTL
 ? " RTL" : " LTR");

483 ià(
‹xtBox
->
m_dœOv”ride
)

484 
ts
 << " override";

487 
ts
 << ": " << 
	`quÙeAndEsÿ³NÚPršbËs
(
	`SŒšg
(
‹xtBox
->
	`‹xtR’d””
()->
	`‹xt
()).
	`sub¡ršg
ÑextBox->
	`¡¬t
(è+ 
¿nge
.
¡¬tOff£t
, 
off£t
)) << "\n";

489 
j
++;

492 
i
++;

494 
	}
}

496 
šlše
 
	$wr™eSVGIÆšeTextBoxes
(
TextSŒ—m
& 
ts
, cÚ¡ 
R’d”Text
& 
‹xt
, 
šd’t
)

498 
IÆšeTextBox
* 
box
 = 
‹xt
.
	`fœ¡TextBox
(); box; box = box->
	`ÃxtTextBox
())

499 
	`wr™eSVGIÆšeTextBox
(
ts
, 
¡©ic_ÿ¡
<
SVGIÆšeTextBox
*>(
box
), 
šd’t
);

500 
	}
}

502 
	$wr™eSnd¬dP»fix
(
TextSŒ—m
& 
ts
, cÚ¡ 
R’d”Objeù
& 
objeù
, 
šd’t
)

504 
	`wr™eInd’t
(
ts
, 
šd’t
);

505 
ts
 << 
objeù
.
	`»nd”Name
();

507 ià(
objeù
.
	`node
())

508 
ts
 << " {" << 
objeù
.
	`node
()->
	`nodeName
() << "}";

509 
	}
}

511 
	$wr™eChd»n
(
TextSŒ—m
& 
ts
, cÚ¡ 
R’d”Objeù
& 
objeù
, 
šd’t
)

513 
R’d”Objeù
* 
chd
 = 
objeù
.
	`fœ¡Chd
(); chd; chd = chd->
	`ÃxtSiblšg
())

514 
	`wr™e
(
ts
, *
chd
, 
šd’t
 + 1);

515 
	}
}

517 
	$wr™eSVGResourû
(
TextSŒ—m
& 
ts
, cÚ¡ 
R’d”Objeù
& 
objeù
, 
šd’t
)

519 
	`wr™eSnd¬dP»fix
(
ts
, 
objeù
, 
šd’t
);

521 
EËm’t
* 
–em’t
 = 
¡©ic_ÿ¡
<EËm’t*>(
objeù
.
	`node
());

522 cÚ¡ 
AtomicSŒšg
& 
id
 = 
–em’t
->
	`g‘IDA‰ribu‹
();

523 
	`wr™eNameAndQuÙedV®ue
(
ts
, "id", 
id
);

525 
R’d”SVGResourû
* 
»sourû
 = 
cÚ¡_ÿ¡
<
R’d”Objeù
&>(
objeù
).
	`toR’d”SVGResourû
();

526 ià(
»sourû
->
	`»sourûTy³
(è=ğ
Mask”ResourûTy³
) {

527 
R’d”SVGResourûMask”
* 
mask”
 = 
¡©ic_ÿ¡
<R’d”SVGResourûMask”*>(
»sourû
);

528 
	`ASSERT
(
mask”
);

529 
	`wr™eNameV®uePaœ
(
ts
, "maskUn™s", 
mask”
->
	`maskUn™s
());

530 
	`wr™eNameV®uePaœ
(
ts
, "maskCÚ‹ÁUn™s", 
mask”
->
	`maskCÚ‹ÁUn™s
());

531 } ià(
»sourû
->
	`»sourûTy³
(è=ğ
Cl³rResourûTy³
) {

532 
R’d”SVGResourûCl³r
* 
ş³r
 = 
¡©ic_ÿ¡
<R’d”SVGResourûCl³r*>(
»sourû
);

533 
	`ASSERT
(
ş³r
);

534 
	`wr™eNameV®uePaœ
(
ts
, "şP©hUn™s", 
ş³r
->
	`şP©hUn™s
());

535 } ià(
»sourû
->
	`»sourûTy³
(è=ğ
M¬k”ResourûTy³
) {

536 
R’d”SVGResourûM¬k”
* 
m¬k”
 = 
¡©ic_ÿ¡
<R’d”SVGResourûM¬k”*>(
»sourû
);

537 
	`ASSERT
(
m¬k”
);

538 
	`wr™eNameV®uePaœ
(
ts
, "m¬k”Un™s", 
m¬k”
->
	`m¬k”Un™s
());

539 
ts
 << " [»à© " << 
m¬k”
->
	`»ã»nûPošt
() << "]";

540 
ts
 << " [angle=";

541 ià(
m¬k”
->
	`ªgË
() == -1)

542 
ts
 << "auto" << "]";

544 
ts
 << 
m¬k”
->
	`ªgË
() << "]";

548 
ts
 << "\n";

549 
	`wr™eChd»n
(
ts
, 
objeù
, 
šd’t
);

550 
	}
}

552 
	$wr™eSVGCÚš”
(
TextSŒ—m
& 
ts
, cÚ¡ 
R’d”Objeù
& 
cÚš”
, 
šd’t
)

554 
	`wr™eSnd¬dP»fix
(
ts
, 
cÚš”
, 
šd’t
);

555 
	`wr™ePos™iÚAndStyË
(
ts
, 
cÚš”
);

556 
ts
 << "\n";

557 
	`wr™eResourûs
(
ts
, 
cÚš”
, 
šd’t
);

558 
	`wr™eChd»n
(
ts
, 
cÚš”
, 
šd’t
);

559 
	}
}

561 
	$wr™e
(
TextSŒ—m
& 
ts
, cÚ¡ 
R’d”SVGRoÙ
& 
roÙ
, 
šd’t
)

563 
	`wr™eSnd¬dP»fix
(
ts
, 
roÙ
, 
šd’t
);

564 
ts
 << 
roÙ
 << "\n";

565 
	`wr™eChd»n
(
ts
, 
roÙ
, 
šd’t
);

566 
	}
}

568 
	$wr™eSVGText
(
TextSŒ—m
& 
ts
, cÚ¡ 
R’d”Block
& 
‹xt
, 
šd’t
)

570 
	`wr™eSnd¬dP»fix
(
ts
, 
‹xt
, 
šd’t
);

571 
	`wr™eR’d”SVGTextBox
(
ts
, 
‹xt
);

572 
ts
 << "\n";

573 
	`wr™eResourûs
(
ts
, 
‹xt
, 
šd’t
);

574 
	`wr™eChd»n
(
ts
, 
‹xt
, 
šd’t
);

575 
	}
}

577 
	$wr™eSVGIÆšeText
(
TextSŒ—m
& 
ts
, cÚ¡ 
R’d”Text
& 
‹xt
, 
šd’t
)

579 
	`wr™eSnd¬dP»fix
(
ts
, 
‹xt
, 
šd’t
);

582 
ts
 << " " << 
	`FlßtReù
(
‹xt
.
	`fœ¡RunOrigš
(),ext.
	`lšesBoundšgBox
().
	`size
()) << "\n";

583 
	`wr™eResourûs
(
ts
, 
‹xt
, 
šd’t
);

584 
	`wr™eSVGIÆšeTextBoxes
(
ts
, 
‹xt
, 
šd’t
);

585 
	}
}

587 
	$wr™eSVGImage
(
TextSŒ—m
& 
ts
, cÚ¡ 
R’d”Image
& 
image
, 
šd’t
)

589 
	`wr™eSnd¬dP»fix
(
ts
, 
image
, 
šd’t
);

590 
	`wr™ePos™iÚAndStyË
(
ts
, 
image
);

591 
ts
 << "\n";

592 
	`wr™eResourûs
(
ts
, 
image
, 
šd’t
);

593 
	}
}

595 
	$wr™e
(
TextSŒ—m
& 
ts
, cÚ¡ 
R’d”P©h
& 
·th
, 
šd’t
)

597 
	`wr™eSnd¬dP»fix
(
ts
, 
·th
, 
šd’t
);

598 
ts
 << 
·th
 << "\n";

599 
	`wr™eResourûs
(
ts
, 
·th
, 
šd’t
);

600 
	}
}

602 
	$wr™eResourûs
(
TextSŒ—m
& 
ts
, cÚ¡ 
R’d”Objeù
& 
objeù
, 
šd’t
)

604 cÚ¡ 
R’d”StyË
* 
¡yË
 = 
objeù
.
	`¡yË
();

605 cÚ¡ 
SVGR’d”StyË
* 
svgStyË
 = 
¡yË
->
	`svgStyË
();

607 ià(!
svgStyË
->
	`maskEËm’t
().
	`isEm±y
()) {

608 ià(
R’d”SVGResourûMask”
* 
mask”
 = 
g‘R’d”SVGResourûById
<R’d”SVGResourûMask”>(
objeù
.
	`docum’t
(), 
svgStyË
->
	`maskEËm’t
())) {

609 
	`wr™eInd’t
(
ts
, 
šd’t
);

610 
ts
 << " ";

611 
	`wr™eNameAndQuÙedV®ue
(
ts
, "mask”", 
svgStyË
->
	`maskEËm’t
());

612 
ts
 << " ";

613 
	`wr™eSnd¬dP»fix
(
ts
, *
mask”
, 0);

614 
ts
 << " " << 
mask”
->
	`»sourûBoundšgBox
(
objeù
.
	`objeùBoundšgBox
()) << "\n";

617 ià(!
svgStyË
->
	`şP©h
().
	`isEm±y
()) {

618 ià(
R’d”SVGResourûCl³r
* 
ş³r
 = 
g‘R’d”SVGResourûById
<R’d”SVGResourûCl³r>(
objeù
.
	`docum’t
(), 
svgStyË
->
	`şP©h
())) {

619 
	`wr™eInd’t
(
ts
, 
šd’t
);

620 
ts
 << " ";

621 
	`wr™eNameAndQuÙedV®ue
(
ts
, "şP©h", 
svgStyË
->
	`şP©h
());

622 
ts
 << " ";

623 
	`wr™eSnd¬dP»fix
(
ts
, *
ş³r
, 0);

624 
ts
 << " " << 
ş³r
->
	`»sourûBoundšgBox
(
objeù
.
	`objeùBoundšgBox
()) << "\n";

628 
	}
}

630 
	$wr™eR’d”Resourûs
(
TextSŒ—m
& 
ts
, 
Node
* 
·»Á
)

632 
	`ASSERT
(
·»Á
);

633 
Node
* 
node
 = 
·»Á
;

635 ià(!
node
->
	`isSVGEËm’t
())

637 
SVGEËm’t
* 
svgEËm’t
 = 
¡©ic_ÿ¡
<SVGEËm’t*>(
node
);

638 ià(!
svgEËm’t
->
	`isStyËd
())

641 
SVGStyËdEËm’t
* 
¡yËd
 = 
¡©ic_ÿ¡
<SVGStyËdEËm’t*>(
svgEËm’t
);

642 
RefPŒ
<
SVGResourû
> 
	`»sourû
(
¡yËd
->
	`ÿnvasResourû
(
node
->
	`»nd””
()));

643 ià(!
»sourû
)

646 
SŒšg
 
–em’tId
 = 
svgEËm’t
->
	`g‘A‰ribu‹
(svgEËm’t->
	`idA‰ribu‹Name
());

648 ià(
»sourû
->
	`isPaštS”v”
()) {

649 
RefPŒ
<
SVGPaštS”v”
> 
·štS”v”
 = 
WTF
::
¡©ic_poš‹r_ÿ¡
<SVGPaštS”v”>(
»sourû
);

650 
ts
 << "KR’d”šgPaštS”v” {id=\"" << 
–em’tId
 << "\" " << *
·štS”v”
 << "}" << "\n";

652 
ts
 << "KCªvasResourû {id=\"" << 
–em’tId
 << "\" " << *
»sourû
 << "}" << "\n";

653 } (
node
 =‚ode->
	`Œav”£NextNode
(
·»Á
)));

654 
	}
}

	@SVGRenderTreeAsText.h

26 #iâdeà
SVGR’d”T»eAsText_h


27 
	#SVGR’d”T»eAsText_h


	)

29 #ià
ENABLE
(
SVG
)

31 
	~"TextSŒ—m.h
"

33 
Çme¥aû
 
	gWebCÜe
 {

35 
şass
 
	gCŞÜ
;

36 
şass
 
	gFlßtPošt
;

37 
şass
 
	gFlßtReù
;

38 
şass
 
	gFlßtSize
;

39 
şass
 
	gIÁPošt
;

40 
şass
 
	gIÁReù
;

41 
şass
 
	gNode
;

42 
şass
 
	gR’d”Block
;

43 
şass
 
	gR’d”Image
;

44 
şass
 
	gR’d”Objeù
;

45 
şass
 
	gR’d”P©h
;

46 
şass
 
	gR’d”SVGRoÙ
;

47 
şass
 
	gR’d”Text
;

48 
şass
 
	gAffšeT¿nsfÜm
;

49 
şass
 
	gSVGUn™Ty³s
;

52 
wr™e
(
TextSŒ—m
&, cÚ¡ 
R’d”P©h
&, 
šd’t
);

53 
wr™e
(
TextSŒ—m
&, cÚ¡ 
R’d”SVGRoÙ
&, 
šd’t
);

54 
wr™eSVGResourû
(
TextSŒ—m
&, cÚ¡ 
R’d”Objeù
&, 
šd’t
);

55 
wr™eSVGCÚš”
(
TextSŒ—m
&, cÚ¡ 
R’d”Objeù
&, 
šd’t
);

56 
wr™eSVGImage
(
TextSŒ—m
&, cÚ¡ 
R’d”Image
&, 
šd’t
);

57 
wr™eSVGIÆšeText
(
TextSŒ—m
&, cÚ¡ 
R’d”Text
&, 
šd’t
);

58 
wr™eSVGText
(
TextSŒ—m
&, cÚ¡ 
R’d”Block
&, 
šd’t
);

59 
wr™eResourûs
(
TextSŒ—m
&, cÚ¡ 
R’d”Objeù
&, 
šd’t
);

61 
wr™eR’d”Resourûs
(
TextSŒ—m
&, 
Node
* 
·»Á
);

64 
	gTextSŒ—m
& 
	gİ”©Ü
<<(TextSŒ—m&, cÚ¡ 
	gAffšeT¿nsfÜm
&);

65 
	gTextSŒ—m
& 
	gİ”©Ü
<<(TextSŒ—m&, cÚ¡ 
	gIÁReù
&);

66 
	gTextSŒ—m
& 
	gİ”©Ü
<<(TextSŒ—m&, cÚ¡ 
	gCŞÜ
&);

67 
	gTextSŒ—m
& 
	gİ”©Ü
<<(TextSŒ—m&, cÚ¡ 
	gIÁPošt
&);

68 
	gTextSŒ—m
& 
	gİ”©Ü
<<(TextSŒ—m&, cÚ¡ 
	gFlßtSize
&);

69 
	gTextSŒ—m
& 
	gİ”©Ü
<<(TextSŒ—m&, cÚ¡ 
	gFlßtReù
&);

70 
	gTextSŒ—m
& 
	gİ”©Ü
<<(TextSŒ—m&, cÚ¡ 
	gFlßtPošt
&);

75 
	g‹m¶©e
<
ty³Çme
 
	gI‹m
>

76 
	gTextSŒ—m
& 
	gİ”©Ü
<<(TextSŒ—m& 
	gts
, cÚ¡ 
	gVeùÜ
<
	gI‹m
*>& 
	gv
)

78 
	gts
 << "[";

80 
	gi
 = 0; i < 
	gv
.
size
(); i++) {

81 
	gts
 << *
	gv
[
i
];

82 ià(
	gi
 < 
	gv
.
size
() - 1)

83 
	gts
 << ", ";

86 
	gts
 << "]";

87  
	gts
;

90 
	g‹m¶©e
<
ty³Çme
 
	gI‹m
>

91 
	gTextSŒ—m
& 
	gİ”©Ü
<<(TextSŒ—m& 
	gts
, cÚ¡ 
	gVeùÜ
<
	gI‹m
>& 
	gv
)

93 
	gts
 << "[";

95 
	gi
 = 0; i < 
	gv
.
size
(); i++) {

96 
	gts
 << 
	gv
[
i
];

97 ià(
	gi
 < 
	gv
.
size
() - 1)

98 
	gts
 << ", ";

101 
	gts
 << "]";

102  
	gts
;

105 
	g‹m¶©e
<
ty³Çme
 
	gPoš‹r
>

106 
	gTextSŒ—m
& 
	gİ”©Ü
<<(TextSŒ—m& 
	gts
, 
Poš‹r
* 
	gt
)

108 
	gts
 << 
	g»š‹½»t_ÿ¡
<
	gšŒ_t
>(
	gt
);

109  
	gts
;

	@SVGRootInlineBox.cpp

25 
	~"cÚfig.h
"

27 #ià
ENABLE
(
SVG
)

28 
	~"SVGRoÙIÆšeBox.h
"

30 
	~"Ed™Ü.h
"

31 
	~"FlßtCÚv”siÚ.h
"

32 
	~"F¿me.h
"

33 
	~"G¿phicsCÚ‹xt.h
"

34 
	~"R’d”Block.h
"

35 
	~"R’d”SVGRoÙ.h
"

36 
	~"SVGIÆšeFlowBox.h
"

37 
	~"SVGIÆšeTextBox.h
"

38 
	~"SVGFÚtEËm’t.h
"

39 
	~"SVGPaštS”v”.h
"

40 
	~"SVGR’d”StyËDefs.h
"

41 
	~"SVGR’d”SuµÜt.h
"

42 
	~"SVGResourûF‹r.h
"

43 
	~"SVGTextPos™iÚšgEËm’t.h
"

44 
	~"SVGURIReã»nû.h
"

45 
	~"Text.h
"

46 
	~"UnicodeRªge.h
"

48 
	~<æßt.h
>

52 
	#DEBUG_CHUNK_BUILDING
 0

	)

54 
Çme¥aû
 
	gWebCÜe
 {

56 
šlše
 
boŞ
 
isV”tiÿlWr™šgMode
(cÚ¡ 
SVGR’d”StyË
* 
¡yË
)

58  
	g¡yË
->
wr™šgMode
(è=ğ
WM_TBRL
 || 
¡yË
->wr™šgMode(è=ğ
WM_TB
;

61 
šlše
 
EAlignm’tBa£lše
 
domšªtBa£lšeToShiá
(
boŞ
 
isV”tiÿlText
, cÚ¡ 
R’d”Objeù
* 
‹xt
, cÚ¡ 
FÚt
& 
fÚt
)

63 
ASSERT
(
‹xt
);

65 cÚ¡ 
SVGR’d”StyË
* 
	g¡yË
 = 
‹xt
->
¡yË
(è?ext->¡yË()->
svgStyË
() : 0;

66 
ASSERT
(
¡yË
);

68 cÚ¡ 
SVGR’d”StyË
* 
	g·»ÁStyË
 = 
‹xt
->
·»Á
(è&&ext->·»Á()->
¡yË
(è?ext->·»Á()->¡yË()->
svgStyË
() : 0;

70 
EDomšªtBa£lše
 
	gba£lše
 = 
¡yË
->
domšªtBa£lše
();

71 ià(
	gba£lše
 =ğ
DB_AUTO
) {

72 ià(
isV”tiÿlText
)

73 
ba£lše
 = 
DB_CENTRAL
;

75 
	gba£lše
 = 
DB_ALPHABETIC
;

78 
	gba£lše
) {

79 
	gDB_USE_SCRIPT
:

82  
AB_ALPHABETIC
;

83 
	gDB_NO_CHANGE
:

85 ià(
·»ÁStyË
)

86  
domšªtBa£lšeToShiá
(
isV”tiÿlText
, 
‹xt
->
·»Á
(), 
fÚt
);

88 
ASSERT_NOT_REACHED
();

89  
	gAB_AUTO
;

91 
	gDB_RESET_SIZE
:

93 ià(
·»ÁStyË
)

94  
domšªtBa£lšeToShiá
(
isV”tiÿlText
, 
‹xt
->
·»Á
(), 
fÚt
);

96 
ASSERT_NOT_REACHED
();

97  
	gAB_AUTO
;

99 
	gDB_IDEOGRAPHIC
:

100  
AB_IDEOGRAPHIC
;

101 
	gDB_ALPHABETIC
:

102  
AB_ALPHABETIC
;

103 
	gDB_HANGING
:

104  
AB_HANGING
;

105 
	gDB_MATHEMATICAL
:

106  
AB_MATHEMATICAL
;

107 
	gDB_CENTRAL
:

108  
AB_CENTRAL
;

109 
	gDB_MIDDLE
:

110  
AB_MIDDLE
;

111 
	gDB_TEXT_AFTER_EDGE
:

112  
AB_TEXT_AFTER_EDGE
;

113 
	gDB_TEXT_BEFORE_EDGE
:

114  
AB_TEXT_BEFORE_EDGE
;

116 
ASSERT_NOT_REACHED
();

117  
	gAB_AUTO
;

121 
šlše
 
®ignm’tBa£lšeToShiá
(
boŞ
 
isV”tiÿlText
, cÚ¡ 
R’d”Objeù
* 
‹xt
, cÚ¡ 
FÚt
& 
fÚt
)

123 
ASSERT
(
‹xt
);

125 cÚ¡ 
SVGR’d”StyË
* 
	g¡yË
 = 
‹xt
->
¡yË
(è?ext->¡yË()->
svgStyË
() : 0;

126 
ASSERT
(
¡yË
);

128 cÚ¡ 
SVGR’d”StyË
* 
	g·»ÁStyË
 = 
‹xt
->
·»Á
(è&&ext->·»Á()->
¡yË
(è?ext->·»Á()->¡yË()->
svgStyË
() : 0;

130 
EAlignm’tBa£lše
 
	gba£lše
 = 
¡yË
->
®ignm’tBa£lše
();

131 ià(
	gba£lše
 =ğ
AB_AUTO
) {

132 ià(
·»ÁStyË
 && 
¡yË
->
domšªtBa£lše
(è=ğ
DB_AUTO
)

133 
ba£lše
 = 
domšªtBa£lšeToShiá
(
isV”tiÿlText
, 
‹xt
->
·»Á
(), 
fÚt
);

135 
	gba£lše
 = 
domšªtBa£lšeToShiá
(
isV”tiÿlText
, 
‹xt
, 
fÚt
);

137 
ASSERT
(
ba£lše
 !ğ
AB_AUTO
);

141 
	gba£lše
) {

142 
	gAB_BASELINE
:

144 ià(
·»ÁStyË
)

145  
domšªtBa£lšeToShiá
(
isV”tiÿlText
, 
‹xt
->
·»Á
(), 
fÚt
);

149 
	gAB_BEFORE_EDGE
:

150 
AB_TEXT_BEFORE_EDGE
:

151  
fÚt
.
asûÁ
();

152 
	gAB_MIDDLE
:

153  
fÚt
.
xHeight
() / 2.0f;

154 
	gAB_CENTRAL
:

158 
	gAB_AFTER_EDGE
:

159 
AB_TEXT_AFTER_EDGE
:

160 
AB_IDEOGRAPHIC
:

161  
fÚt
.
desûÁ
();

162 
	gAB_ALPHABETIC
:

164 
	gAB_HANGING
:

165  
fÚt
.
asûÁ
() * 8.0f / 10.0f;

166 
	gAB_MATHEMATICAL
:

167  
fÚt
.
asûÁ
() / 2.0f;

169 
ASSERT_NOT_REACHED
();

174 
šlše
 
glyphOr›Á©iÚToAngË
(cÚ¡ 
SVGR’d”StyË
* 
svgStyË
, 
boŞ
 
isV”tiÿlText
, cÚ¡ 
UCh¬
& 
ch¬aù”
)

176 
	gisV”tiÿlText
 ? 
	gsvgStyË
->
glyphOr›Á©iÚV”tiÿl
(è: 
svgStyË
->
glyphOr›Á©iÚHÜizÚl
()) {

177 
GO_AUTO
:

181 
unicodeRªge
 = 
fšdCh¬UnicodeRªge
(
ch¬aù”
);

182 ià(
	gunicodeRªge
 =ğ
cRªgeS‘L©š
 || 
unicodeRªge
 =ğ
cRªgeA¿bic
)

187 
	gGO_90DEG
:

189 
	gGO_180DEG
:

191 
	gGO_270DEG
:

193 
	gGO_0DEG
:

199 
šlše
 
boŞ
 
glyphOr›Á©iÚIsMuÉlyOf180Deg»es
(
Ü›Á©iÚAngË
)

201  
çbsf
(
fmodf
(
Ü›Á©iÚAngË
, 180.0f)) == 0.0f;

204 
šlše
 
ÿlcuÏ‹GlyphAdvªûAndShiáRe¥eùšgOr›Á©iÚ
(
boŞ
 
isV”tiÿlText
, 
Ü›Á©iÚAngË
, 
glyphWidth
, 
glyphHeight
, cÚ¡ 
FÚt
& 
fÚt
, 
SVGCh¬
& 
svgCh¬
, & 
xOr›Á©iÚShiá
, & 
yOr›Á©iÚShiá
)

206 
boŞ
 
	gÜ›Á©iÚIsMuÉlyOf180Deg»es
 = 
glyphOr›Á©iÚIsMuÉlyOf180Deg»es
(
Ü›Á©iÚAngË
);

217 ià(
	gisV”tiÿlText
) {

218 ià(
	gÜ›Á©iÚAngË
 == 0.0f) {

219 
xOr›Á©iÚShiá
 = -
glyphWidth
 / 2.0f;

220 
	gyOr›Á©iÚShiá
 = 
fÚt
.
asûÁ
();

221 } ià(
	gÜ›Á©iÚAngË
 == 90.0f) {

222 
xOr›Á©iÚShiá
 = -
glyphHeight
;

223 
	gyOr›Á©iÚShiá
 = 
fÚt
.
desûÁ
();

224 
	gsvgCh¬
.
	gÜ›Á©iÚShiáY
 = -
fÚt
.
asûÁ
();

225 } ià(
	gÜ›Á©iÚAngË
 == 270.0f) {

226 
xOr›Á©iÚShiá
 = 
glyphHeight
;

227 
	gyOr›Á©iÚShiá
 = 
fÚt
.
desûÁ
();

228 
	gsvgCh¬
.
	gÜ›Á©iÚShiáX
 = -
glyphWidth
;

229 
	gsvgCh¬
.
	gÜ›Á©iÚShiáY
 = -
fÚt
.
asûÁ
();

230 } ià(
	gÜ›Á©iÚAngË
 == 180.0f) {

231 
yOr›Á©iÚShiá
 = 
fÚt
.
asûÁ
();

232 
	gsvgCh¬
.
	gÜ›Á©iÚShiáX
 = -
glyphWidth
 / 2.0f;

233 
	gsvgCh¬
.
	gÜ›Á©iÚShiáY
 = 
fÚt
.
asûÁ
(è- fÚt.
desûÁ
();

237 ià(
	gÜ›Á©iÚAngË
 !ğ0.0à&& !
Ü›Á©iÚIsMuÉlyOf180Deg»es
)

238  
glyphWidth
;

240  
	gglyphHeight
;

244 ià(
	gÜ›Á©iÚAngË
 == 90.0f) {

245 
xOr›Á©iÚShiá
 = 
glyphWidth
 / 2.0f;

246 
	gyOr›Á©iÚShiá
 = -
fÚt
.
desûÁ
();

247 
	gsvgCh¬
.
	gÜ›Á©iÚShiáX
 = -
glyphWidth
 / 2.0à- 
fÚt
.
desûÁ
();

248 
	gsvgCh¬
.
	gÜ›Á©iÚShiáY
 = 
fÚt
.
desûÁ
();

249 } ià(
	gÜ›Á©iÚAngË
 == 270.0f) {

250 
xOr›Á©iÚShiá
 = -
glyphWidth
 / 2.0f;

251 
	gyOr›Á©iÚShiá
 = -
fÚt
.
desûÁ
();

252 
	gsvgCh¬
.
	gÜ›Á©iÚShiáX
 = -
glyphWidth
 / 2.0à+ 
fÚt
.
desûÁ
();

253 
	gsvgCh¬
.
	gÜ›Á©iÚShiáY
 = 
glyphHeight
;

254 } ià(
	gÜ›Á©iÚAngË
 == 180.0f) {

255 
xOr›Á©iÚShiá
 = 
glyphWidth
 / 2.0f;

256 
	gsvgCh¬
.
	gÜ›Á©iÚShiáX
 = -
glyphWidth
 / 2.0f;

257 
	gsvgCh¬
.
	gÜ›Á©iÚShiáY
 = 
fÚt
.
asûÁ
(è- fÚt.
desûÁ
();

261 ià(
	gÜ›Á©iÚAngË
 !ğ0.0à&& !
Ü›Á©iÚIsMuÉlyOf180Deg»es
)

262  
glyphHeight
;

264  
	gglyphWidth
;

267 
šlše
 
¡¬tTextChunk
(
SVGTextChunkLayoutInfo
& 
šfo
)

269 
	gšfo
.
	gchunk
.
	gboxes
.
ş—r
();

270 
	gšfo
.
	gchunk
.
	gboxes
.
­³nd
(
SVGIÆšeBoxCh¬aù”Rªge
());

272 
	gšfo
.
	gchunk
.
	g¡¬t
 = 
šfo
.
™
;

273 
	gšfo
.
	gassignChunkPrİ”t›s
 = 
Œue
;

276 
šlše
 
şo£TextChunk
(
SVGTextChunkLayoutInfo
& 
šfo
)

278 
ASSERT
(!
šfo
.
chunk
.
boxes
.
Ï¡
().
isO³n
());

279 
ASSERT
(
šfo
.
chunk
.
boxes
.
Ï¡
().
isClo£d
());

281 
	gšfo
.
	gchunk
.
	g’d
 = 
šfo
.
™
;

282 
ASSERT
(
šfo
.
chunk
.
’d
 >ğšfo.chunk.
¡¬t
);

284 
	gšfo
.
	gsvgTextChunks
.
­³nd
(
šfo
.
chunk
);

287 
R’d”SVGRoÙ
* 
fšdSVGRoÙObjeù
(
R’d”Objeù
* 
¡¬t
)

290 
	g¡¬t
 && !¡¬t->
isSVGRoÙ
())

291 
	g¡¬t
 = 
¡¬t
->
·»Á
();

292 
ASSERT
(
¡¬t
);

293  
toR’d”SVGRoÙ
(
¡¬t
);

296 
šlše
 
FlßtPošt
 
tİLeáPos™iÚOfCh¬aù”Rªge
(
VeùÜ
<
SVGCh¬
>& 
ch¬s
)

298  
tİLeáPos™iÚOfCh¬aù”Rªge
(
ch¬s
.
begš
(), ch¬s.
’d
());

301 
FlßtPošt
 
tİLeáPos™iÚOfCh¬aù”Rªge
(
VeùÜ
<
SVGCh¬
>::
™”©Ü
 
™
, VeùÜ<SVGCh¬>::™”©Ü 
’d
)

303 
lowX
 = 
FLT_MAX
, 
	glowY
 = FLT_MAX;

304 ; 
	g™
 !ğ
’d
; ++it) {

305 ià(
	g™
->
isHidd’
())

308 
	gx
 = (*
™
).
x
;

309 
	gy
 = (*
™
).
y
;

311 ià(
	gx
 < 
	glowX
)

312 
	glowX
 = 
x
;

314 ià(
	gy
 < 
	glowY
)

315 
	glowY
 = 
y
;

318  
FlßtPošt
(
lowX
, 
lowY
);

322 
ÿlcuÏ‹K”nšg
(
R’d”Objeù
* 
™em
)

324 cÚ¡ 
	gFÚt
& 
	gfÚt
 = 
™em
->
¡yË
()->
fÚt
();

325 cÚ¡ 
SVGR’d”StyË
* 
	gsvgStyË
 = 
™em
->
¡yË
()->
svgStyË
();

327 
	gk”nšg
 = 0.0f;

328 ià(
CSSPrim™iveV®ue
* 
	g´im™ive
 = 
¡©ic_ÿ¡
<CSSPrim™iveV®ue*>(
svgStyË
->
k”nšg
())) {

329 
k”nšg
 = 
´im™ive
->
g‘FlßtV®ue
();

331 ià(
	g´im™ive
->
´im™iveTy³
(è=ğ
CSSPrim™iveV®ue
::
CSS_PERCENTAGE
 && 
fÚt
.
pix–Size
() > 0)

332 
k”nšg
 = k”nšg / 100.0à* 
fÚt
.
pix–Size
();

335  
	gk”nšg
;

339 
	sSVGRoÙIÆšeBoxPaštW®k”
 {

340 
SVGRoÙIÆšeBoxPaštW®k”
(
SVGRoÙIÆšeBox
* 
roÙBox
, 
SVGResourûF‹r
* 
roÙF‹r
, 
R’d”Objeù
::
PaštInfo
 
·štInfo
, 
tx
, 
ty
)

341 : 
m_roÙBox
(
roÙBox
)

342 , 
m_chunkS¹ed
(
çl£
)

343 , 
m_·štInfo
(
·štInfo
)

344 , 
m_§vedInfo
(
·štInfo
)

345 , 
m_boundšgBox
(
tx
 + 
roÙBox
->
x
(), 
ty
 +„oÙBox->
y
(),„oÙBox->
width
(),„oÙBox->
height
())

346 , 
m_f‹r
(0)

347 , 
m_roÙF‹r
(
roÙF‹r
)

348 , 
m_flPaštS”v”
(0)

349 , 
m_¡rokePaštS”v”
(0)

350 , 
m_flPaštS”v”Objeù
(0)

351 , 
m_¡rokePaštS”v”Objeù
(0)

352 , 
m_tx
(
tx
)

353 , 
m_ty
(
ty
)

357 ~
SVGRoÙIÆšeBoxPaštW®k”
()

359 
ASSERT
(!
m_f‹r
);

360 
ASSERT
(!
m_flPaštS”v”
);

361 
ASSERT
(!
m_flPaštS”v”Objeù
);

362 
ASSERT
(!
m_¡rokePaštS”v”
);

363 
ASSERT
(!
m_¡rokePaštS”v”Objeù
);

364 
ASSERT
(!
m_chunkS¹ed
);

367 
boŞ
 
mayHaveS–eùiÚ
(
SVGIÆšeTextBox
* 
box
) const

369 
	g£ËùiÚS¹
 = 0, 
	g£ËùiÚEnd
 = 0;

370 
	gbox
->
£ËùiÚS¹End
(
£ËùiÚS¹
, 
£ËùiÚEnd
);

371  
	g£ËùiÚS¹
 < 
	g£ËùiÚEnd
;

374 
‹¬downFlPaštS”v”
()

376 ià(!
	gm_flPaštS”v”
)

379 
	gm_flPaštS”v”
->
‹¬down
(
m_·štInfo
.
cÚ‹xt
, 
m_flPaštS”v”Objeù
, 
AµlyToFlT¬g‘Ty³
, 
Œue
);

381 
	gm_flPaštS”v”
 = 0;

382 
	gm_flPaštS”v”Objeù
 = 0;

385 
‹¬downSŒokePaštS”v”
()

387 ià(!
	gm_¡rokePaštS”v”
)

390 
	gm_¡rokePaštS”v”
->
‹¬down
(
m_·štInfo
.
cÚ‹xt
, 
m_¡rokePaštS”v”Objeù
, 
AµlyToSŒokeT¬g‘Ty³
, 
Œue
);

392 
	gm_¡rokePaštS”v”
 = 0;

393 
	gm_¡rokePaštS”v”Objeù
 = 0;

396 
chunkS¹C®lback
(
IÆšeBox
* 
box
)

398 
ASSERT
(!
m_chunkS¹ed
);

399 
	gm_chunkS¹ed
 = 
Œue
;

401 
IÆšeFlowBox
* 
	gæowBox
 = 
box
->
·»Á
();

404 
R’d”Objeù
* 
	gobjeù
 = 
æowBox
->
»nd””
();

405 
ASSERT
(
objeù
);

407 
	gm_§vedInfo
 = 
m_·štInfo
;

408 
	gm_·štInfo
.
	gcÚ‹xt
->
§ve
();

411 ià(!
	gæowBox
->
isRoÙIÆšeBox
())

412 
	gSVGR’d”Ba£
::
´•¬eToR’d”SVGCÚ‹Á
(
objeù
, 
m_·štInfo
, 
m_boundšgBox
, 
m_f‹r
, 
m_roÙF‹r
);

415 
chunkEndC®lback
(
IÆšeBox
* 
box
)

417 
ASSERT
(
m_chunkS¹ed
);

418 
	gm_chunkS¹ed
 = 
çl£
;

420 
IÆšeFlowBox
* 
	gæowBox
 = 
box
->
·»Á
();

422 
R’d”Objeù
* 
	gobjeù
 = 
æowBox
->
»nd””
();

423 
ASSERT
(
objeù
);

426 
‹¬downFlPaštS”v”
();

427 
‹¬downSŒokePaštS”v”
();

430 ià(!
	gæowBox
->
isRoÙIÆšeBox
()) {

431 
	gSVGR’d”Ba£
::
fšishR’d”SVGCÚ‹Á
(
objeù
, 
m_·štInfo
, 
m_f‹r
, 
m_§vedInfo
.
cÚ‹xt
);

432 
	gm_f‹r
 = 0;

436 
	gm_·štInfo
.
	gcÚ‹xt
->
»¡Üe
();

437 
	gm_·štInfo
.
	g»ù
 = 
m_§vedInfo
.
»ù
;

440 
boŞ
 
£tupBackground
(
SVGIÆšeTextBox
* )

442 
	gm_‹xtPaštInfo
.
	gsubpha£
 = 
SVGTextPaštSubpha£Background
;

443  
	gŒue
;

446 
boŞ
 
£tupFl
(
SVGIÆšeTextBox
* 
box
)

448 
IÆšeFlowBox
* 
	gæowBox
 = 
box
->
·»Á
();

451 
R’d”Objeù
* 
	gobjeù
 = 
æowBox
->
»nd””
();

452 
ASSERT
(
objeù
);

454 
ASSERT
(!
m_¡rokePaštS”v”
);

455 
‹¬downFlPaštS”v”
();

457 
	gm_‹xtPaštInfo
.
	gsubpha£
 = 
SVGTextPaštSubpha£GlyphFl
;

458 
	gm_flPaštS”v”
 = 
SVGPaštS”v”
::
flPaštS”v”
(
objeù
->
¡yË
(), object);

459 ià(
	gm_flPaštS”v”
) {

460 
	gm_flPaštS”v”
->
£tup
(
m_·štInfo
.
cÚ‹xt
, 
objeù
, 
AµlyToFlT¬g‘Ty³
, 
Œue
);

461 
	gm_flPaštS”v”Objeù
 = 
objeù
;

462  
	gŒue
;

465  
	gçl£
;

468 
boŞ
 
£tupFlS–eùiÚ
(
SVGIÆšeTextBox
* 
box
)

470 
IÆšeFlowBox
* 
	gæowBox
 = 
box
->
·»Á
();

473 
R’d”Objeù
* 
	gobjeù
 = 
æowBox
->
»nd””
();

474 
ASSERT
(
objeù
);

475 
R’d”StyË
* 
	g¡yË
 = 
objeù
->
g‘CachedP£udoStyË
(
SELECTION
);

476 ià(!
	g¡yË
)

477 
	g¡yË
 = 
objeù
->
¡yË
();

479 
ASSERT
(!
m_¡rokePaštS”v”
);

480 
‹¬downFlPaštS”v”
();

482 ià(!
mayHaveS–eùiÚ
(
box
))

483  
	gçl£
;

485 
	gm_‹xtPaštInfo
.
	gsubpha£
 = 
SVGTextPaštSubpha£GlyphFlS–eùiÚ
;

486 
	gm_flPaštS”v”
 = 
SVGPaštS”v”
::
flPaštS”v”
(
¡yË
, 
objeù
);

487 ià(
	gm_flPaštS”v”
) {

488 
	gm_flPaštS”v”
->
£tup
(
m_·štInfo
.
cÚ‹xt
, 
objeù
, 
¡yË
, 
AµlyToFlT¬g‘Ty³
, 
Œue
);

489 
	gm_flPaštS”v”Objeù
 = 
objeù
;

490  
	gŒue
;

493  
	gçl£
;

496 
boŞ
 
£tupSŒoke
(
SVGIÆšeTextBox
* 
box
)

498 
IÆšeFlowBox
* 
	gæowBox
 = 
box
->
·»Á
();

501 
R’d”Objeù
* 
	gobjeù
 = 
æowBox
->
»nd””
();

502 
ASSERT
(
objeù
);

505 
‹¬downFlPaštS”v”
();

506 
‹¬downSŒokePaštS”v”
();

508 
	gm_‹xtPaštInfo
.
	gsubpha£
 = 
SVGTextPaštSubpha£GlyphSŒoke
;

509 
	gm_¡rokePaštS”v”
 = 
SVGPaštS”v”
::
¡rokePaštS”v”
(
objeù
->
¡yË
(), object);

511 ià(
	gm_¡rokePaštS”v”
) {

512 
	gm_¡rokePaštS”v”
->
£tup
(
m_·štInfo
.
cÚ‹xt
, 
objeù
, 
AµlyToSŒokeT¬g‘Ty³
, 
Œue
);

513 
	gm_¡rokePaštS”v”Objeù
 = 
objeù
;

514  
	gŒue
;

517  
	gçl£
;

520 
boŞ
 
£tupSŒokeS–eùiÚ
(
SVGIÆšeTextBox
* 
box
)

522 
IÆšeFlowBox
* 
	gæowBox
 = 
box
->
·»Á
();

525 
R’d”Objeù
* 
	gobjeù
 = 
æowBox
->
»nd””
();

526 
ASSERT
(
objeù
);

527 
R’d”StyË
* 
	g¡yË
 = 
objeù
->
g‘CachedP£udoStyË
(
SELECTION
);

528 ià(!
	g¡yË
)

529 
	g¡yË
 = 
objeù
->
¡yË
();

532 
‹¬downFlPaštS”v”
();

533 
‹¬downSŒokePaštS”v”
();

535 ià(!
mayHaveS–eùiÚ
(
box
))

536  
	gçl£
;

538 
	gm_‹xtPaštInfo
.
	gsubpha£
 = 
SVGTextPaštSubpha£GlyphSŒokeS–eùiÚ
;

539 
	gm_¡rokePaštS”v”
 = 
SVGPaštS”v”
::
¡rokePaštS”v”
(
¡yË
, 
objeù
);

540 ià(
	gm_¡rokePaštS”v”
) {

541 
	gm_¡rokePaštS”v”
->
£tup
(
m_·štInfo
.
cÚ‹xt
, 
objeù
, 
¡yË
, 
AµlyToSŒokeT¬g‘Ty³
, 
Œue
);

542 
	gm_¡rokePaštS”v”Objeù
 = 
objeù
;

543  
	gŒue
;

546  
	gçl£
;

549 
boŞ
 
£tupFÜeground
(
SVGIÆšeTextBox
* )

551 
‹¬downFlPaštS”v”
();

552 
‹¬downSŒokePaštS”v”
();

554 
	gm_‹xtPaštInfo
.
	gsubpha£
 = 
SVGTextPaštSubpha£FÜeground
;

556  
	gŒue
;

559 
SVGPaštS”v”
* 
aùivePaštS”v”
() const

561 
	gm_‹xtPaštInfo
.
	gsubpha£
) {

562 
	gSVGTextPaštSubpha£GlyphFl
:

563 
SVGTextPaštSubpha£GlyphFlS–eùiÚ
:

564 
ASSERT
(
m_flPaštS”v”
);

565  
	gm_flPaštS”v”
;

566 
	gSVGTextPaštSubpha£GlyphSŒoke
:

567 
SVGTextPaštSubpha£GlyphSŒokeS–eùiÚ
:

568 
ASSERT
(
m_¡rokePaštS”v”
);

569  
	gm_¡rokePaštS”v”
;

570 
	gSVGTextPaštSubpha£Background
:

571 
SVGTextPaštSubpha£FÜeground
:

577 
chunkPÜtiÚC®lback
(
SVGIÆšeTextBox
* 
‹xtBox
, 
¡¬tOff£t
, cÚ¡ 
AffšeT¿nsfÜm
& 
chunkCtm
,

578 cÚ¡ 
VeùÜ
<
SVGCh¬
>::
™”©Ü
& 
¡¬t
, cÚ¡ VeùÜ<SVGCh¬>::™”©Ü& 
’d
)

580 ià(
£tupBackground
(
‹xtBox
))

581 
·štChunk
(
‹xtBox
, 
¡¬tOff£t
, 
chunkCtm
, 
¡¬t
, 
’d
);

583 ià(
£tupFl
(
‹xtBox
))

584 
·štChunk
(
‹xtBox
, 
¡¬tOff£t
, 
chunkCtm
, 
¡¬t
, 
’d
);

586 ià(
£tupFlS–eùiÚ
(
‹xtBox
))

587 
·štChunk
(
‹xtBox
, 
¡¬tOff£t
, 
chunkCtm
, 
¡¬t
, 
’d
);

589 ià(
£tupSŒoke
(
‹xtBox
))

590 
·štChunk
(
‹xtBox
, 
¡¬tOff£t
, 
chunkCtm
, 
¡¬t
, 
’d
);

592 ià(
£tupSŒokeS–eùiÚ
(
‹xtBox
))

593 
·štChunk
(
‹xtBox
, 
¡¬tOff£t
, 
chunkCtm
, 
¡¬t
, 
’d
);

595 ià(
£tupFÜeground
(
‹xtBox
))

596 
·štChunk
(
‹xtBox
, 
¡¬tOff£t
, 
chunkCtm
, 
¡¬t
, 
’d
);

599 
·štChunk
(
SVGIÆšeTextBox
* 
‹xtBox
, 
¡¬tOff£t
, cÚ¡ 
AffšeT¿nsfÜm
& 
chunkCtm
,

600 cÚ¡ 
VeùÜ
<
SVGCh¬
>::
™”©Ü
& 
¡¬t
, cÚ¡ VeùÜ<SVGCh¬>::™”©Ü& 
’d
)

602 
R’d”Text
* 
‹xt
 = 
‹xtBox
->
‹xtR’d””
();

603 
ASSERT
(
‹xt
);

605 
R’d”StyË
* 
	g¡yËToU£
 = 
‹xt
->
¡yË
(
‹xtBox
->
isFœ¡LšeStyË
());

606 
ASSERT
(
¡yËToU£
);

608 
	g¡¬tOff£t
 +ğ
‹xtBox
->
¡¬t
();

610 
	g‹xtDecÜ©iÚs
 = 
¡yËToU£
->
‹xtDecÜ©iÚsInEfãù
();

612 
	g‹xtWidth
 = 0;

613 
IÁPošt
 
	gdecÜ©iÚOrigš
;

614 
SVGTextDecÜ©iÚInfo
 
	gšfo
;

616 ià(!
	gchunkCtm
.
isId’t™y
())

617 
	gm_·štInfo
.
	gcÚ‹xt
->
cÚÿtCTM
(
chunkCtm
);

619 
	gVeùÜ
<
	gSVGCh¬
>::
™”©Ü
 
™
 = 
¡¬t
; 
	g™
 !ğ
’d
; ++it) {

620 ià(
	g™
->
isHidd’
())

624 
	gVeùÜ
<
	gSVGCh¬
>::
™”©Ü
 
™S—rch
 = 
™
 + 1;

625 
	g™S—rch
 !ğ
’d
) {

626 ià(
™S—rch
->
d¿wnS•”©ed
 || itS—rch->
isHidd’
())

629 
	g™S—rch
++;

632 cÚ¡ 
UCh¬
* 
	g¡ršgS¹
 = 
‹xt
->
ch¬aù”s
(è+ 
¡¬tOff£t
 + (
™
 - 
¡¬t
);

633 
	g¡ršgL’gth
 = 
™S—rch
 - 
™
;

636 ià(
	g‹xtDecÜ©iÚs
 !ğ
TDNONE
 && 
m_·štInfo
.
pha£
 !ğ
PaštPha£S–eùiÚ
) {

637 
‹xtWidth
 = 
¡yËToU£
->
fÚt
().
width
(
svgTextRunFÜIÆšeTextBox
(
¡ršgS¹
, 
¡ršgL’gth
, styËToU£, 
‹xtBox
, (*
™
).
x
));

638 
	gdecÜ©iÚOrigš
 = 
IÁPošt
((è(*
™
).
x
, (è(*™).
y
 - 
¡yËToU£
->
fÚt
().
asûÁ
());

639 
	gšfo
 = 
m_roÙBox
->
»Œ›vePaštS”v”sFÜTextDecÜ©iÚ
(
‹xt
);

642 ià(
	g‹xtDecÜ©iÚs
 & 
	gUNDERLINE
 && 
	g‹xtWidth
 != 0.0f)

643 
‹xtBox
->
·štDecÜ©iÚ
(
UNDERLINE
, 
m_·štInfo
.
cÚ‹xt
, 
decÜ©iÚOrigš
.
x
(), decÜ©iÚOrigš.
y
(), 
‹xtWidth
, *
™
, 
šfo
);

645 ià(
	g‹xtDecÜ©iÚs
 & 
	gOVERLINE
 && 
	g‹xtWidth
 != 0.0f)

646 
‹xtBox
->
·štDecÜ©iÚ
(
OVERLINE
, 
m_·štInfo
.
cÚ‹xt
, 
decÜ©iÚOrigš
.
x
(), decÜ©iÚOrigš.
y
(), 
‹xtWidth
, *
™
, 
šfo
);

649 
	gm_‹xtPaštInfo
.
	gaùivePaštS”v”
 = 
aùivePaštS”v”
();

650 
	g‹xtBox
->
·štCh¬aù”s
(
m_·štInfo
, 
m_tx
, 
m_ty
, *
™
, 
¡ršgS¹
, 
¡ršgL’gth
, 
m_‹xtPaštInfo
);

653 ià(
	g‹xtDecÜ©iÚs
 & 
	gLINE_THROUGH
 && 
	g‹xtWidth
 != 0.0f)

654 
‹xtBox
->
·štDecÜ©iÚ
(
LINE_THROUGH
, 
m_·štInfo
.
cÚ‹xt
, 
decÜ©iÚOrigš
.
x
(), decÜ©iÚOrigš.
y
(), 
‹xtWidth
, *
™
, 
šfo
);

657 
	g™
 = 
™S—rch
 - 1;

660 ià(!
	gchunkCtm
.
isId’t™y
())

661 
	gm_·štInfo
.
	gcÚ‹xt
->
cÚÿtCTM
(
chunkCtm
.
šv”£
());

664 
	g´iv©e
:

665 
SVGRoÙIÆšeBox
* 
m_roÙBox
;

666 
boŞ
 
	gm_chunkS¹ed
 : 1;

668 
	gR’d”Objeù
::
PaštInfo
 
m_·štInfo
;

669 
	gR’d”Objeù
::
PaštInfo
 
m_§vedInfo
;

671 
FlßtReù
 
	gm_boundšgBox
;

672 
SVGResourûF‹r
* 
	gm_f‹r
;

673 
SVGResourûF‹r
* 
	gm_roÙF‹r
;

675 
SVGPaštS”v”
* 
	gm_flPaštS”v”
;

676 
SVGPaštS”v”
* 
	gm_¡rokePaštS”v”
;

678 
R’d”Objeù
* 
	gm_flPaštS”v”Objeù
;

679 
R’d”Objeù
* 
	gm_¡rokePaštS”v”Objeù
;

681 
	gm_tx
;

682 
	gm_ty
;

684 
SVGTextPaštInfo
 
	gm_‹xtPaštInfo
;

687 
	gSVGRoÙIÆšeBox
::
·št
(
R’d”Objeù
::
PaštInfo
& 
·štInfo
, 
tx
, 
ty
)

689 ià(
	g·štInfo
.
	gcÚ‹xt
->
·štšgDi§bËd
(è||…aštInfo.
	gpha£
 !ğ
PaštPha£FÜeground
)

692 
	gR’d”Objeù
::
PaštInfo
 
§vedInfo
(
·štInfo
);

693 
	g·štInfo
.
	gcÚ‹xt
->
§ve
();

695 
SVGResourûF‹r
* 
	gf‹r
 = 0;

696 
FlßtReù
 
boundšgBox
(
tx
 + 
x
(), 
ty
 + 
y
(), 
width
(), 
height
());

699 ià(
	gSVGR’d”Ba£
::
´•¬eToR’d”SVGCÚ‹Á
(
»nd””
(), 
·štInfo
, 
boundšgBox
, 
f‹r
)) {

701 
SVGRoÙIÆšeBoxPaštW®k”
 
w®k”C®lback
(
this
, 
f‹r
, 
·štInfo
, 
tx
, 
ty
);

702 
	gSVGTextChunkW®k”
<
	gSVGRoÙIÆšeBoxPaštW®k”
> 
w®k”
(&
w®k”C®lback
,

703 &
SVGRoÙIÆšeBoxPaštW®k”
::
chunkPÜtiÚC®lback
,

704 &
SVGRoÙIÆšeBoxPaštW®k”
::
chunkS¹C®lback
,

705 &
SVGRoÙIÆšeBoxPaštW®k”
::
chunkEndC®lback
);

707 
w®kTextChunks
(&
w®k”
);

711 
	gSVGR’d”Ba£
::
fšishR’d”SVGCÚ‹Á
(
»nd””
(), 
·štInfo
, 
f‹r
, 
§vedInfo
.
cÚ‹xt
);

712 
	g·štInfo
.
	gcÚ‹xt
->
»¡Üe
();

715 
	gSVGRoÙIÆšeBox
::
¶aûBoxesHÜizÚÎy
(, & 
ËáPos™iÚ
, & 
rightPos™iÚ
, 
boŞ
&)

718 
	gËáPos™iÚ
 = 0;

719 
	grightPos™iÚ
 = 0;

723 
	gSVGRoÙIÆšeBox
::
v”tiÿÎyAlignBoxes
()

726  
height
();

729 
cummuÏ‹dWidthOfIÆšeBoxCh¬aù”Rªge
(
SVGIÆšeBoxCh¬aù”Rªge
& 
¿nge
)

731 
ASSERT
(!
¿nge
.
isO³n
());

732 
ASSERT
(
¿nge
.
isClo£d
());

733 
ASSERT
(
¿nge
.
box
->
isIÆšeTextBox
());

735 
IÆšeTextBox
* 
	g‹xtBox
 = 
¡©ic_ÿ¡
<IÆšeTextBox*>(
¿nge
.
box
);

736 
R’d”Text
* 
	g‹xt
 = 
‹xtBox
->
‹xtR’d””
();

737 
R’d”StyË
* 
	g¡yË
 = 
‹xt
->
¡yË
();

739  
	g¡yË
->
fÚt
().
æßtWidth
(
svgTextRunFÜIÆšeTextBox
(
‹xt
->
ch¬aù”s
(è+ 
‹xtBox
->
¡¬t
(è+ 
¿nge
.
¡¬tOff£t
,„ªge.
’dOff£t
 -„ªge.¡¬tOff£t, 
¡yË
,extBox, 0));

742 
cummuÏ‹dHeightOfIÆšeBoxCh¬aù”Rªge
(
SVGIÆšeBoxCh¬aù”Rªge
& 
¿nge
)

744 
ASSERT
(!
¿nge
.
isO³n
());

745 
ASSERT
(
¿nge
.
isClo£d
());

746 
ASSERT
(
¿nge
.
box
->
isIÆšeTextBox
());

748 
IÆšeTextBox
* 
	g‹xtBox
 = 
¡©ic_ÿ¡
<IÆšeTextBox*>(
¿nge
.
box
);

749 
R’d”Text
* 
	g‹xt
 = 
‹xtBox
->
‹xtR’d””
();

750 cÚ¡ 
	gFÚt
& 
	gfÚt
 = 
‹xt
->
¡yË
()->
fÚt
();

752  (
	g¿nge
.
	g’dOff£t
 -„ªge.
	g¡¬tOff£t
è* (
	gfÚt
.
asûÁ
(è+ fÚt.
desûÁ
());

755 
TextRun
 
svgTextRunFÜIÆšeTextBox
(cÚ¡ 
UCh¬
* 
c
, 
Ën
, 
R’d”StyË
* 
¡yË
, cÚ¡ 
IÆšeTextBox
* 
‹xtBox
, 
xPos
)

757 
ASSERT
(
‹xtBox
);

758 
ASSERT
(
¡yË
);

760 
TextRun
 
run
(
c
, 
Ën
, 
çl£
, 
¡©ic_ÿ¡
<>(
xPos
), 
‹xtBox
->
toAdd
(),extBox->
dœeùiÚ
(è=ğ
RTL
,extBox->
m_dœOv”ride
 || 
¡yË
->
visu®lyOrd”ed
());

762 #ià
ENABLE
(
SVG_FONTS
)

763 
	grun
.
£tReã»ncšgR’d”Objeù
(
‹xtBox
->
‹xtR’d””
()->
·»Á
());

767 
	grun
.
di§bËS·cšg
();

768  
	grun
;

771 
cummuÏ‹dWidthOrHeightOfTextChunk
(
SVGTextChunk
& 
chunk
, 
boŞ
 
ÿlcWidthOÆy
)

773 
	gËngth
 = 0.0f;

774 
	gVeùÜ
<
	gSVGCh¬
>::
™”©Ü
 
ch¬It
 = 
chunk
.
¡¬t
;

776 
	gVeùÜ
<
	gSVGIÆšeBoxCh¬aù”Rªge
>::
™”©Ü
 
™
 = 
chunk
.
boxes
.
begš
();

777 
	gVeùÜ
<
	gSVGIÆšeBoxCh¬aù”Rªge
>::
™”©Ü
 
’d
 = 
chunk
.
boxes
.end();

779 ; 
	g™
 !ğ
’d
; ++it) {

780 
	gSVGIÆšeBoxCh¬aù”Rªge
& 
	g¿nge
 = *
™
;

782 
SVGIÆšeTextBox
* 
	gbox
 = 
¡©ic_ÿ¡
<SVGIÆšeTextBox*>(
¿nge
.
box
);

783 
R’d”StyË
* 
	g¡yË
 = 
box
->
»nd””
()->
¡yË
();

785 
	gi
 = 
¿nge
.
¡¬tOff£t
; i < 
	g¿nge
.
	g’dOff£t
; ++i) {

786 
ASSERT
(
ch¬It
 <ğ
chunk
.
’d
);

791 
	gVeùÜ
<
	gSVGCh¬
>::
™”©Ü
 
™S—rch
 = 
ch¬It
 + 1;

792 
	gVeùÜ
<
	gSVGCh¬
>::
™”©Ü
 
’dS—rch
 = 
ch¬It
 + 
¿nge
.
’dOff£t
 - 
i
;

793 
	g™S—rch
 !ğ
’dS—rch
) {

795 ià(
™S—rch
->
d¿wnS•”©ed
)

798 
	g™S—rch
++;

801 
	gpos™iÚOff£t
 = 
™S—rch
 - 
ch¬It
;

804 
SVGIÆšeBoxCh¬aù”Rªge
 
	gsubRªge
;

805 
	gsubRªge
.
	gbox
 = 
¿nge
.
box
;

806 
	gsubRªge
.
	g¡¬tOff£t
 = 
i
;

807 
	gsubRªge
.
	g’dOff£t
 = 
i
 + 
pos™iÚOff£t
;

809 ià(
	gÿlcWidthOÆy
)

810 
	gËngth
 +ğ
cummuÏ‹dWidthOfIÆšeBoxCh¬aù”Rªge
(
subRªge
);

812 
	gËngth
 +ğ
cummuÏ‹dHeightOfIÆšeBoxCh¬aù”Rªge
(
subRªge
);

817 ià(
	g™S—rch
 > 
	gchunk
.
	g¡¬t
 && itS—rch < chunk.
	g’d
) {

818 
	gSVGCh¬
& 
	gÏ¡Ch¬aù”
 = *(
™S—rch
 - 1);

819 
	gSVGCh¬
& 
	gcu¼’tCh¬aù”
 = *
™S—rch
;

821 
	goff£t
 = 
box
->
dœeùiÚ
(è=ğ
RTL
 ? box->
’d
(è- 
i
 - 
pos™iÚOff£t
 + 1 : box->
¡¬t
() + i +…ositionOffset - 1;

824 
	gch¬sCÚsumed
 = 1;

825 
SŒšg
 
	gglyphName
;

826 ià(
	gÿlcWidthOÆy
) {

827 
	gÏ¡GlyphWidth
 = 
box
->
ÿlcuÏ‹GlyphWidth
(
¡yË
, 
off£t
, 0, 
ch¬sCÚsumed
, 
glyphName
);

828 
	gËngth
 +ğ
cu¼’tCh¬aù”
.
x
 - 
Ï¡Ch¬aù”
.x - 
Ï¡GlyphWidth
;

830 
	gÏ¡GlyphHeight
 = 
box
->
ÿlcuÏ‹GlyphHeight
(
¡yË
, 
off£t
, 0);

831 
	gËngth
 +ğ
cu¼’tCh¬aù”
.
y
 - 
Ï¡Ch¬aù”
.y - 
Ï¡GlyphHeight
;

836 
	gi
 +ğ
pos™iÚOff£t
 - 1;

837 
	gch¬It
 = 
™S—rch
;

841 
ASSERT
(
ch¬It
 =ğ
chunk
.
’d
);

842  
	gËngth
;

845 
cummuÏ‹dWidthOfTextChunk
(
SVGTextChunk
& 
chunk
)

847  
cummuÏ‹dWidthOrHeightOfTextChunk
(
chunk
, 
Œue
);

850 
cummuÏ‹dHeightOfTextChunk
(
SVGTextChunk
& 
chunk
)

852  
cummuÏ‹dWidthOrHeightOfTextChunk
(
chunk
, 
çl£
);

855 
ÿlcuÏ‹TextAnchÜShiáFÜTextChunk
(
SVGTextChunk
& 
chunk
, 
ETextAnchÜ
 
ªchÜ
)

857 
	gshiá
 = 0.0f;

859 ià(
	gchunk
.
	gisV”tiÿlText
)

860 
	gshiá
 = 
cummuÏ‹dHeightOfTextChunk
(
chunk
);

862 
	gshiá
 = 
cummuÏ‹dWidthOfTextChunk
(
chunk
);

864 ià(
	gªchÜ
 =ğ
TA_MIDDLE
)

865 
shiá
 *= -0.5f;

867 
	gshiá
 *= -1.0f;

869  
	gshiá
;

872 
­¶yTextAnchÜToTextChunk
(
SVGTextChunk
& 
chunk
)

877 ià(
	gchunk
.
	gªchÜ
 =ğ
TA_START
)

880 
	gshiá
 = 
ÿlcuÏ‹TextAnchÜShiáFÜTextChunk
(
chunk
, chunk.
ªchÜ
);

883 
	gVeùÜ
<
	gSVGCh¬
>::
™”©Ü
 
chunkIt
 = 
chunk
.
¡¬t
;

884 ; 
	gchunkIt
 !ğ
chunk
.
’d
; ++chunkIt) {

885 
	gSVGCh¬
& 
	gcurCh¬
 = *
chunkIt
;

887 ià(
	gchunk
.
	gisV”tiÿlText
)

888 
	gcurCh¬
.
	gy
 +ğ
shiá
;

890 
	gcurCh¬
.
	gx
 +ğ
shiá
;

894 
	gVeùÜ
<
	gSVGIÆšeBoxCh¬aù”Rªge
>::
™”©Ü
 
boxIt
 = 
chunk
.
boxes
.
begš
();

895 
	gVeùÜ
<
	gSVGIÆšeBoxCh¬aù”Rªge
>::
™”©Ü
 
boxEnd
 = 
chunk
.
boxes
.
’d
();

897 ; 
	gboxIt
 !ğ
boxEnd
; ++boxIt) {

898 
	gSVGIÆšeBoxCh¬aù”Rªge
& 
	g¿nge
 = *
boxIt
;

900 
IÆšeBox
* 
	gcurBox
 = 
¿nge
.
box
;

901 
ASSERT
(
curBox
->
isIÆšeTextBox
());

904 ià(
	gchunk
.
	gisV”tiÿlText
)

905 
	gcurBox
->
£tY
(
curBox
->
y
(è+ 
¡©ic_ÿ¡
<>(
shiá
));

907 
	gcurBox
->
£tX
(
curBox
->
x
(è+ 
¡©ic_ÿ¡
<>(
shiá
));

911 
ÿlcuÏ‹TextL’gthCÜ»ùiÚFÜTextChunk
(
SVGTextChunk
& 
chunk
, 
EL’gthAdju¡
 
ËngthAdju¡
, & 
compu‹dL’gth
)

913 ià(
	gchunk
.
	g‹xtL’gth
 <= 0.0f)

916 
	gcompu‹dWidth
 = 
cummuÏ‹dWidthOfTextChunk
(
chunk
);

917 
	gcompu‹dHeight
 = 
cummuÏ‹dHeightOfTextChunk
(
chunk
);

919 ià((
	gcompu‹dWidth
 <ğ0.0à&& !
chunk
.
isV”tiÿlText
) ||

920 (
compu‹dHeight
 <ğ0.0à&& 
chunk
.
isV”tiÿlText
))

923 ià(
	gchunk
.
	gisV”tiÿlText
)

924 
	gcompu‹dL’gth
 = 
compu‹dHeight
;

926 
	gcompu‹dL’gth
 = 
compu‹dWidth
;

928 ià(
	gËngthAdju¡
 =ğ
SVGTextCÚ‹ÁEËm’t
::
LENGTHADJUST_SPACINGANDGLYPHS
) {

929 ià(
chunk
.
isV”tiÿlText
)

930 
chunk
.
ùm
.
sÿËNÚUnifÜm
(1.0f, chunk.
‹xtL’gth
 / 
compu‹dL’gth
);

932 
	gchunk
.
	gùm
.
sÿËNÚUnifÜm
(
chunk
.
‹xtL’gth
 / 
compu‹dL’gth
, 1.0f);

937  (
	gchunk
.
	g‹xtL’gth
 - 
	gcompu‹dL’gth
è/ (chunk.
	g’d
 - chunk.
	g¡¬t
);

940 
­¶yTextL’gthCÜ»ùiÚToTextChunk
(
SVGTextChunk
& 
chunk
)

946 
	gcompu‹dL’gth
 = 0.0f;

947 
	g¥acšgToAµly
 = 
ÿlcuÏ‹TextL’gthCÜ»ùiÚFÜTextChunk
(
chunk
, chunk.
ËngthAdju¡
, 
compu‹dL’gth
);

949 ià(!
	gchunk
.
	gùm
.
isId’t™y
(è&& chunk.
	gËngthAdju¡
 =ğ
SVGTextCÚ‹ÁEËm’t
::
LENGTHADJUST_SPACINGANDGLYPHS
) {

950 
SVGCh¬
& 
fœ¡Ch¬
 = *(
chunk
.
¡¬t
);

953 
AffšeT¿nsfÜm
 
ÃwChunkCtm
(
chunk
.
ùm
);

954 
	gÃwChunkCtm
.
Œª¦©eRight
(
fœ¡Ch¬
.
x
, fœ¡Ch¬.
y
);

955 
	gÃwChunkCtm
.
Œª¦©e
(-
fœ¡Ch¬
.
x
, -fœ¡Ch¬.
y
);

957 
	gchunk
.
	gùm
 = 
ÃwChunkCtm
;

961 ià(
	g¥acšgToAµly
 != 0.0f) {

962 
VeùÜ
<
SVGCh¬
>::
™”©Ü
 
chunkIt
 = 
chunk
.
¡¬t
;

963 ; 
	gchunkIt
 !ğ
chunk
.
’d
; ++chunkIt) {

964 
	gSVGCh¬
& 
	gcurCh¬
 = *
chunkIt
;

965 
	gcurCh¬
.
	gd¿wnS•”©ed
 = 
Œue
;

967 ià(
	gchunk
.
	gisV”tiÿlText
)

968 
	gcurCh¬
.
	gy
 +ğ(
chunkIt
 - 
chunk
.
¡¬t
è* 
¥acšgToAµly
;

970 
	gcurCh¬
.
	gx
 +ğ(
chunkIt
 - 
chunk
.
¡¬t
è* 
¥acšgToAµly
;

975 
	gSVGRoÙIÆšeBox
::
compu‹P”Ch¬aù”LayoutInfÜm©iÚ
()

978 
m_svgCh¬s
.
ş—r
();

979 
	gm_svgTextChunks
.
ş—r
();

982 
SVGCh¬aù”LayoutInfo
 
šfo
(
m_svgCh¬s
);

983 
budLayoutInfÜm©iÚ
(
this
, 
šfo
);

988 
budTextChunks
(
m_svgCh¬s
, 
m_svgTextChunks
, 
this
);

992 
ÏyoutTextChunks
();

996 
FlßtPošt
 
	gtİLeá
 = 
tİLeáPos™iÚOfCh¬aù”Rªge
(
m_svgCh¬s
);

997 
block
()->
£tLoÿtiÚ
((è
æoÜf
(
tİLeá
.
x
()), (èæoÜfÑİLeá.
y
()));

1001 
ÏyoutIÆšeBoxes
();

1004 
	gSVGRoÙIÆšeBox
::
budLayoutInfÜm©iÚ
(
IÆšeFlowBox
* 
¡¬t
, 
SVGCh¬aù”LayoutInfo
& 
šfo
)

1006 ià(
	g¡¬t
->
isRoÙIÆšeBox
()) {

1007 
ASSERT
(
¡¬t
->
»nd””
()->
node
()->
hasTagName
(
SVGNames
::
‹xtTag
));

1009 
SVGTextPos™iÚšgEËm’t
* 
	gpos™iÚšgEËm’t
 = 
¡©ic_ÿ¡
<SVGTextPos™iÚšgEËm’t*>(
¡¬t
->
»nd””
()->
node
());

1010 
ASSERT
(
pos™iÚšgEËm’t
);

1011 
ASSERT
(
pos™iÚšgEËm’t
->
·»ÁNode
());

1013 
	gšfo
.
addLayoutInfÜm©iÚ
(
pos™iÚšgEËm’t
);

1016 
La¡GlyphInfo
 
	gÏ¡Glyph
;

1018 
IÆšeBox
* 
	gcu¼
 = 
¡¬t
->
fœ¡Chd
(); cu¼; cu¼ = 
cu¼
->
ÃxtOnLše
()) {

1019 ià(
cu¼
->
»nd””
()->
isText
())

1020 
budLayoutInfÜm©iÚFÜTextBox
(
šfo
, 
¡©ic_ÿ¡
<
IÆšeTextBox
*>(
cu¼
), 
Ï¡Glyph
);

1022 
ASSERT
(
cu¼
->
isIÆšeFlowBox
());

1023 
IÆšeFlowBox
* 
	gæowBox
 = 
¡©ic_ÿ¡
<IÆšeFlowBox*>(
cu¼
);

1025 ià(!
	gæowBox
->
»nd””
()->
node
())

1028 
boŞ
 
	gisAnchÜ
 = 
æowBox
->
»nd””
()->
node
()->
hasTagName
(
SVGNames
::
aTag
);

1029 
boŞ
 
	gisTextP©h
 = 
æowBox
->
»nd””
()->
node
()->
hasTagName
(
SVGNames
::
‹xtP©hTag
);

1031 ià(!
	gisTextP©h
 && !
	gisAnchÜ
) {

1032 
SVGTextPos™iÚšgEËm’t
* 
	gpos™iÚšgEËm’t
 = 
¡©ic_ÿ¡
<SVGTextPos™iÚšgEËm’t*>(
æowBox
->
»nd””
()->
node
());

1033 
ASSERT
(
pos™iÚšgEËm’t
);

1034 
ASSERT
(
pos™iÚšgEËm’t
->
·»ÁNode
());

1036 
	gšfo
.
addLayoutInfÜm©iÚ
(
pos™iÚšgEËm’t
);

1037 } ià(!
	gisAnchÜ
) {

1038 
	gšfo
.
£tInP©hLayout
(
Œue
);

1041 
SVGTextCÚ‹ÁEËm’t
* 
	g‹xtCÚ‹Á
 = 0;

1042 
Node
* 
	gnode
 = 
æowBox
->
»nd””
()->
node
();

1043 ià(
	gnode
 &&‚ode->
isSVGEËm’t
())

1044 
	g‹xtCÚ‹Á
 = 
¡©ic_ÿ¡
<
SVGTextCÚ‹ÁEËm’t
*>(
node
);

1045 
ASSERT
(
‹xtCÚ‹Á
);

1047 
EL’gthAdju¡
 
	gËngthAdju¡
 = (EL’gthAdju¡è
‹xtCÚ‹Á
->
ËngthAdju¡
();

1048 
ETextAnchÜ
 
	gªchÜ
 = 
æowBox
->
»nd””
()->
¡yË
()->
svgStyË
()->
‹xtAnchÜ
();

1049 
	g‹xtAnchÜS¹Off£t
 = 0.0f;

1054 
	gVeùÜ
<
	gSVGCh¬
> 
	g‹mpCh¬s
;

1055 
	gVeùÜ
<
	gSVGTextChunk
> 
	g‹mpChunks
;

1057 
SVGCh¬aù”LayoutInfo
 
‹mpInfo
(
‹mpCh¬s
);

1058 
budLayoutInfÜm©iÚ
(
æowBox
, 
‹mpInfo
);

1060 
budTextChunks
(
‹mpCh¬s
, 
‹mpChunks
, 
æowBox
);

1062 
	gVeùÜ
<
	gSVGTextChunk
>::
™”©Ü
 
™
 = 
‹mpChunks
.
begš
();

1063 
	gVeùÜ
<
	gSVGTextChunk
>::
™”©Ü
 
’d
 = 
‹mpChunks
.end();

1065 
	gcompu‹dL’gth
 = 0.0f;

1067 ; 
	g™
 !ğ
’d
; ++it) {

1068 
	gSVGTextChunk
& 
	gchunk
 = *
™
;

1071 
	gšfo
.
	g·thExŒaAdvªû
 +ğ
ÿlcuÏ‹TextL’gthCÜ»ùiÚFÜTextChunk
(
chunk
, 
ËngthAdju¡
, 
compu‹dL’gth
);

1073 ià(
	gËngthAdju¡
 =ğ
SVGTextCÚ‹ÁEËm’t
::
LENGTHADJUST_SPACINGANDGLYPHS
) {

1074 
šfo
.
·thTextL’gth
 +ğ
compu‹dL’gth
;

1075 
	gšfo
.
	g·thChunkL’gth
 +ğ
chunk
.
‹xtL’gth
;

1079 ià(
	gªchÜ
 =ğ
TA_START
)

1082 
	g‹xtAnchÜS¹Off£t
 +ğ
ÿlcuÏ‹TextAnchÜShiáFÜTextChunk
(
chunk
, 
ªchÜ
);

1085 
	gšfo
.
addLayoutInfÜm©iÚ
(
æowBox
, 
‹xtAnchÜS¹Off£t
);

1088 
	gshiáxSaved
 = 
šfo
.
shiáx
;

1089 
	gshiáySaved
 = 
šfo
.
shiáy
;

1091 
budLayoutInfÜm©iÚ
(
æowBox
, 
šfo
);

1092 
	gšfo
.
´oûs£dChunk
(
shiáxSaved
, 
shiáySaved
);

1094 ià(
	gisTextP©h
)

1095 
	gšfo
.
£tInP©hLayout
(
çl£
);

1100 
	gSVGRoÙIÆšeBox
::
ÏyoutIÆšeBoxes
()

1102 
lowX
 = 
INT_MAX
;

1103 
	glowY
 = 
INT_MAX
;

1104 
	ghighX
 = 
INT_MIN
;

1105 
	ghighY
 = 
INT_MIN
;

1108 
	gVeùÜ
<
	gSVGCh¬
>::
™”©Ü
 
™
 = 
m_svgCh¬s
.
begš
();

1109 
ÏyoutIÆšeBoxes
(
this
, 
™
, 
lowX
, 
highX
, 
lowY
, 
highY
);

1110 
ASSERT
(
™
 =ğ
m_svgCh¬s
.
’d
());

1113 
	gSVGRoÙIÆšeBox
::
ÏyoutIÆšeBoxes
(
IÆšeFlowBox
* 
¡¬t
, 
VeùÜ
<
SVGCh¬
>::
™”©Ü
& 
™
, & 
lowX
, & 
highX
, & 
lowY
, & 
highY
)

1115 
IÆšeBox
* 
	gcu¼
 = 
¡¬t
->
fœ¡Chd
(); cu¼; cu¼ = 
cu¼
->
ÃxtOnLše
()) {

1116 
R’d”StyË
* 
¡yË
 = 
cu¼
->
»nd””
()->style();

1117 ià(
	gcu¼
->
»nd””
()->
isText
()) {

1118 
SVGIÆšeTextBox
* 
	g‹xtBox
 = 
¡©ic_ÿ¡
<SVGIÆšeTextBox*>(
cu¼
);

1119 
	gËngth
 = 
‹xtBox
->
Ën
();

1121 
SVGCh¬
 
	gcurCh¬
 = *
™
;

1122 
ASSERT
(
™
 !ğ
m_svgCh¬s
.
’d
());

1124 
FlßtReù
 
	g¡ršgReù
;

1125 
	gi
 = 0; i < 
	gËngth
; ++i) {

1126 
ASSERT
(
™
 !ğ
m_svgCh¬s
.
’d
());

1128 ià(
	g™
->
isHidd’
()) {

1129 ++
	g™
;

1133 
	g¡ršgReù
.
un™e
(
‹xtBox
->
ÿlcuÏ‹GlyphBound¬›s
(
¡yË
,extBox->
¡¬t
(è+ 
i
, *
™
));

1134 ++
	g™
;

1137 
IÁReù
 
	g’şo£dSŒšgReù
 = 
’şosšgIÁReù
(
¡ršgReù
);

1139 
	gmšX
 = 
’şo£dSŒšgReù
.
x
();

1140 
	gmaxX
 = 
mšX
 + 
’şo£dSŒšgReù
.
width
();

1142 
	gmšY
 = 
’şo£dSŒšgReù
.
y
();

1143 
	gmaxY
 = 
mšY
 + 
’şo£dSŒšgReù
.
height
();

1145 
	gcu¼
->
£tX
(
mšX
 - 
block
()->
x
());

1146 
	gcu¼
->
£tWidth
(
’şo£dSŒšgReù
.
width
());

1148 
	gcu¼
->
£tY
(
mšY
 - 
block
()->
y
());

1149 
	g‹xtBox
->
£tHeight
(
’şo£dSŒšgReù
.
height
());

1151 ià(
	gmšX
 < 
	glowX
)

1152 
	glowX
 = 
mšX
;

1154 ià(
	gmaxX
 > 
	ghighX
)

1155 
	ghighX
 = 
maxX
;

1157 ià(
	gmšY
 < 
	glowY
)

1158 
	glowY
 = 
mšY
;

1160 ià(
	gmaxY
 > 
	ghighY
)

1161 
	ghighY
 = 
maxY
;

1163 
ASSERT
(
cu¼
->
isIÆšeFlowBox
());

1165 
	gmšX
 = 
INT_MAX
;

1166 
	gmšY
 = 
INT_MAX
;

1167 
	gmaxX
 = 
INT_MIN
;

1168 
	gmaxY
 = 
INT_MIN
;

1170 
IÆšeFlowBox
* 
	gæowBox
 = 
¡©ic_ÿ¡
<IÆšeFlowBox*>(
cu¼
);

1172 ià(!
	gæowBox
->
»nd””
()->
node
())

1175 
ÏyoutIÆšeBoxes
(
æowBox
, 
™
, 
mšX
, 
maxX
, 
mšY
, 
maxY
);

1177 
	gcu¼
->
£tX
(
mšX
 - 
block
()->
x
());

1178 
	gcu¼
->
£tWidth
(
maxX
 - 
mšX
);

1180 
	gcu¼
->
£tY
(
mšY
 - 
block
()->
y
());

1181 
	g¡©ic_ÿ¡
<
	gSVGIÆšeFlowBox
*>(
	gcu¼
)->
£tHeight
(
maxY
 - 
mšY
);

1183 ià(
	gmšX
 < 
	glowX
)

1184 
	glowX
 = 
mšX
;

1186 ià(
	gmaxX
 > 
	ghighX
)

1187 
	ghighX
 = 
maxX
;

1189 ià(
	gmšY
 < 
	glowY
)

1190 
	glowY
 = 
mšY
;

1192 ià(
	gmaxY
 > 
	ghighY
)

1193 
	ghighY
 = 
maxY
;

1197 ià(
	g¡¬t
->
isSVGRoÙIÆšeBox
()) {

1198 
	gtİ
 = 
lowY
 - 
block
()->
y
();

1199 
	gbÙtom
 = 
highY
 - 
block
()->
y
();

1201 
	g¡¬t
->
£tX
(
lowX
 - 
block
()->
x
());

1202 
	g¡¬t
->
£tY
(
tİ
);

1204 
	g¡¬t
->
£tWidth
(
highX
 - 
lowX
);

1205 
	g¡©ic_ÿ¡
<
	gSVGRoÙIÆšeBox
*>(
	g¡¬t
)->
£tHeight
(
highY
 - 
lowY
);

1207 
	g¡¬t
->
compu‹V”tiÿlOv”æow
(
tİ
, 
bÙtom
, 
Œue
);

1208 
	g¡©ic_ÿ¡
<
	gSVGRoÙIÆšeBox
*>(
	g¡¬t
)->
£tLšeTİBÙtomPos™iÚs
(
tİ
, 
bÙtom
);

1212 
	gSVGRoÙIÆšeBox
::
budLayoutInfÜm©iÚFÜTextBox
(
SVGCh¬aù”LayoutInfo
& 
šfo
, 
IÆšeTextBox
* 
‹xtBox
, 
La¡GlyphInfo
& 
Ï¡Glyph
)

1214 
R’d”Text
* 
	g‹xt
 = 
‹xtBox
->
‹xtR’d””
();

1215 
ASSERT
(
‹xt
);

1217 
R’d”StyË
* 
	g¡yË
 = 
‹xt
->
¡yË
(
‹xtBox
->
isFœ¡LšeStyË
());

1218 
ASSERT
(
¡yË
);

1220 cÚ¡ 
	gFÚt
& 
	gfÚt
 = 
¡yË
->
fÚt
();

1221 
SVGIÆšeTextBox
* 
	gsvgTextBox
 = 
¡©ic_ÿ¡
<SVGIÆšeTextBox*>(
‹xtBox
);

1223 
	gËngth
 = 
‹xtBox
->
Ën
();

1225 cÚ¡ 
SVGR’d”StyË
* 
	gsvgStyË
 = 
¡yË
->
svgStyË
();

1226 
boŞ
 
	gisV”tiÿlText
 = 
isV”tiÿlWr™šgMode
(
svgStyË
);

1228 
	gch¬sCÚsumed
 = 0;

1229 
	gi
 = 0; i < 
	gËngth
; i +ğ
ch¬sCÚsumed
) {

1230 
SVGCh¬
 
svgCh¬
;

1232 ià(
	gšfo
.
šP©hLayout
())

1233 
	gsvgCh¬
.
	g·thD©a
 = 
SVGCh¬OnP©h
::
ü—‹
();

1235 
	gglyphWidth
 = 0.0f;

1236 
	gglyphHeight
 = 0.0f;

1238 
	gexŒaCh¬sAvaabË
 = 
Ëngth
 - 
i
 - 1;

1240 
SŒšg
 
	gunicodeSŒ
;

1241 
SŒšg
 
	gglyphName
;

1242 ià(
	g‹xtBox
->
dœeùiÚ
(è=ğ
RTL
) {

1243 
glyphWidth
 = 
svgTextBox
->
ÿlcuÏ‹GlyphWidth
(
¡yË
, 
‹xtBox
->
’d
(è- 
i
, 
exŒaCh¬sAvaabË
, 
ch¬sCÚsumed
, 
glyphName
);

1244 
	gglyphHeight
 = 
svgTextBox
->
ÿlcuÏ‹GlyphHeight
(
¡yË
, 
‹xtBox
->
’d
(è- 
i
, 
exŒaCh¬sAvaabË
);

1245 
	gunicodeSŒ
 = 
SŒšg
(
‹xtBox
->
‹xtR’d””
()->
‹xt
()->
ch¬aù”s
(è+extBox->
’d
(è- 
i
, 
ch¬sCÚsumed
);

1247 
	gglyphWidth
 = 
svgTextBox
->
ÿlcuÏ‹GlyphWidth
(
¡yË
, 
‹xtBox
->
¡¬t
(è+ 
i
, 
exŒaCh¬sAvaabË
, 
ch¬sCÚsumed
, 
glyphName
);

1248 
	gglyphHeight
 = 
svgTextBox
->
ÿlcuÏ‹GlyphHeight
(
¡yË
, 
‹xtBox
->
¡¬t
(è+ 
i
, 
exŒaCh¬sAvaabË
);

1249 
	gunicodeSŒ
 = 
SŒšg
(
‹xtBox
->
‹xtR’d””
()->
‹xt
()->
ch¬aù”s
(è+extBox->
¡¬t
(è+ 
i
, 
ch¬sCÚsumed
);

1252 
boŞ
 
	gassigÃdX
 = 
çl£
;

1253 
boŞ
 
	gassigÃdY
 = 
çl£
;

1255 ià(
	gšfo
.
xV®ueAvaabË
(è&& (!šfo.
šP©hLayout
(è|| (šfo.šP©hLayout(è&& !
	gisV”tiÿlText
))) {

1256 ià(!
	gisV”tiÿlText
)

1257 
	gsvgCh¬
.
	gÃwTextChunk
 = 
Œue
;

1259 
	gassigÃdX
 = 
Œue
;

1260 
	gsvgCh¬
.
	gd¿wnS•”©ed
 = 
Œue
;

1261 
	gšfo
.
	gcurx
 = 
šfo
.
xV®ueNext
();

1264 ià(
	gšfo
.
yV®ueAvaabË
(è&& (!šfo.
šP©hLayout
(è|| (šfo.šP©hLayout(è&& 
	gisV”tiÿlText
))) {

1265 ià(
	gisV”tiÿlText
)

1266 
	gsvgCh¬
.
	gÃwTextChunk
 = 
Œue
;

1268 
	gassigÃdY
 = 
Œue
;

1269 
	gsvgCh¬
.
	gd¿wnS•”©ed
 = 
Œue
;

1270 
	gšfo
.
	gcury
 = 
šfo
.
yV®ueNext
();

1273 
	gdx
 = 0.0f;

1274 
	gdy
 = 0.0f;

1277 ià(
	gšfo
.
dxV®ueAvaabË
()) {

1278 
	gsvgCh¬
.
	gd¿wnS•”©ed
 = 
Œue
;

1280 
	gdx
 = 
šfo
.
dxV®ueNext
();

1281 
	gšfo
.
	gdx
 +ğ
dx
;

1283 ià(!
	gšfo
.
šP©hLayout
())

1284 
	gšfo
.
	gcurx
 +ğ
dx
;

1288 ià(
	gšfo
.
dyV®ueAvaabË
()) {

1289 
	gsvgCh¬
.
	gd¿wnS•”©ed
 = 
Œue
;

1291 
	gdy
 = 
šfo
.
dyV®ueNext
();

1292 
	gšfo
.
	gdy
 +ğ
dy
;

1294 ià(!
	gšfo
.
šP©hLayout
())

1295 
	gšfo
.
	gcury
 +ğ
dy
;

1299 
	g¥acšg
 = 
fÚt
.
Ë‰”S·cšg
(è+ 
ÿlcuÏ‹K”nšg
(
‹xtBox
->
»nd””
()->
node
()->renderer());

1301 cÚ¡ 
UCh¬
* 
	gcu¼’tCh¬aù”
 = 
‹xt
->
ch¬aù”s
(è+ (
‹xtBox
->
dœeùiÚ
(è=ğ
RTL
 ?extBox->
’d
(è- 
i
 :extBox->
¡¬t
() + i);

1302 cÚ¡ 
UCh¬
* 
	gÏ¡Ch¬aù”
 = 0;

1304 ià(
	g‹xtBox
->
dœeùiÚ
(è=ğ
RTL
) {

1305 ià(
i
 < 
‹xtBox
->
’d
())

1306 
Ï¡Ch¬aù”
 = 
‹xt
->
ch¬aù”s
(è+ 
‹xtBox
->
’d
(è- 
i
 + 1;

1308 ià(
	gi
 > 0)

1309 
	gÏ¡Ch¬aù”
 = 
‹xt
->
ch¬aù”s
(è+ 
‹xtBox
->
¡¬t
(è+ 
i
 - 1;

1312 ià(
	gšfo
.
	gÃxtD¿wnS•”©ed
 || 
	g¥acšg
 != 0.0f) {

1313 
šfo
.
ÃxtD¿wnS•”©ed
 = 
çl£
;

1314 
	gsvgCh¬
.
	gd¿wnS•”©ed
 = 
Œue
;

1317 ià(
	gcu¼’tCh¬aù”
 && 
	gFÚt
::
Œ—tAsS·û
(*
cu¼’tCh¬aù”
è&& 
Ï¡Ch¬aù”
 && !
FÚt
::treatAsSpace(*lastCharacter)) {

1318 
¥acšg
 +ğ
fÚt
.
wÜdS·cšg
();

1320 ià(
	g¥acšg
 !ğ0.0à&& !
šfo
.
šP©hLayout
())

1321 
šfo
.
ÃxtD¿wnS•”©ed
 = 
Œue
;

1324 
	gÜ›Á©iÚAngË
 = 
glyphOr›Á©iÚToAngË
(
svgStyË
, 
isV”tiÿlText
, *
cu¼’tCh¬aù”
);

1326 
	gxOr›Á©iÚShiá
 = 0.0f;

1327 
	gyOr›Á©iÚShiá
 = 0.0f;

1328 
	gglyphAdvªû
 = 
ÿlcuÏ‹GlyphAdvªûAndShiáRe¥eùšgOr›Á©iÚ
(
isV”tiÿlText
, 
Ü›Á©iÚAngË
, 
glyphWidth
, 
glyphHeight
,

1329 
fÚt
, 
svgCh¬
, 
xOr›Á©iÚShiá
, 
yOr›Á©iÚShiá
);

1332 ià(
	gšfo
.
šP©hLayout
()) {

1333 
	gexŒaAdvªû
 = 
isV”tiÿlText
 ? 
dy
 : 
dx
;

1334 
	gÃwOff£t
 = 
FLT_MIN
;

1336 ià(
	gassigÃdX
 && !
	gisV”tiÿlText
)

1337 
	gÃwOff£t
 = 
šfo
.
curx
;

1338 ià(
	gassigÃdY
 && 
	gisV”tiÿlText
)

1339 
	gÃwOff£t
 = 
šfo
.
cury
;

1341 
	gcÜ»ùedGlyphAdvªû
 = 
glyphAdvªû
;

1344 ià(
	gšfo
.
	g·thTextL’gth
 > 0.0à&& info.
	g·thChunkL’gth
 > 0.0f) {

1345 ià(
	gisV”tiÿlText
) {

1346 
	gsvgCh¬
.
	g·thD©a
->
	gySÿË
 = 
šfo
.
·thChunkL’gth
 / info.
·thTextL’gth
;

1347 
	g¥acšg
 *ğ
svgCh¬
.
·thD©a
->
ySÿË
;

1348 
	gcÜ»ùedGlyphAdvªû
 *ğ
svgCh¬
.
·thD©a
->
ySÿË
;

1350 
	gsvgCh¬
.
	g·thD©a
->
	gxSÿË
 = 
šfo
.
·thChunkL’gth
 / info.
·thTextL’gth
;

1351 
	g¥acšg
 *ğ
svgCh¬
.
·thD©a
->
xSÿË
;

1352 
	gcÜ»ùedGlyphAdvªû
 *ğ
svgCh¬
.
·thD©a
->
xSÿË
;

1357 
	g·thExŒaAdvªû
 = 
šfo
.
·thExŒaAdvªû
;

1358 
	gšfo
.
	g·thExŒaAdvªû
 +ğ
¥acšg
;

1360 
	gsvgCh¬
.
	g·thD©a
->
	ghidd’
 = !
šfo
.
ÃxtP©hLayoutPoštAndAngË
(
cÜ»ùedGlyphAdvªû
, 
exŒaAdvªû
, 
ÃwOff£t
);

1361 
	gsvgCh¬
.
	gd¿wnS•”©ed
 = 
Œue
;

1363 
	gšfo
.
	g·thExŒaAdvªû
 = 
·thExŒaAdvªû
;

1367 ià(
	gšfo
.
ªgËV®ueAvaabË
())

1368 
	gšfo
.
	gªgË
 = 
šfo
.
ªgËV®ueNext
();

1371 ià(
	gšfo
.
ba£lšeShiáV®ueAvaabË
()) {

1372 
	gsvgCh¬
.
	gd¿wnS•”©ed
 = 
Œue
;

1373 
	gshiá
 = 
šfo
.
ba£lšeShiáV®ueNext
();

1375 ià(
	gisV”tiÿlText
)

1376 
	gšfo
.
	gshiáx
 +ğ
shiá
;

1378 
	gšfo
.
	gshiáy
 -ğ
shiá
;

1382 
	gyOr›Á©iÚShiá
 +ğ
®ignm’tBa£lšeToShiá
(
isV”tiÿlText
, 
‹xt
, 
fÚt
);

1384 
	gsvgCh¬
.
	gx
 = 
šfo
.
curx
;

1385 
	gsvgCh¬
.
	gy
 = 
šfo
.
cury
;

1386 
	gsvgCh¬
.
	gªgË
 = 
šfo
.
ªgË
;

1389 ià(!
	gšfo
.
šP©hLayout
()) {

1390 
	gsvgCh¬
.
	gx
 +ğ
šfo
.
shiáx
 + 
xOr›Á©iÚShiá
;

1391 
	gsvgCh¬
.
	gy
 +ğ
šfo
.
shiáy
 + 
yOr›Á©iÚShiá
;

1393 ià(
	gÜ›Á©iÚAngË
 != 0.0f)

1394 
svgCh¬
.
ªgË
 +ğ
Ü›Á©iÚAngË
;

1396 ià(
	gsvgCh¬
.
	gªgË
 != 0.0f)

1397 
svgCh¬
.
d¿wnS•”©ed
 = 
Œue
;

1399 
	gsvgCh¬
.
	g·thD©a
->
	gÜ›Á©iÚAngË
 = 
Ü›Á©iÚAngË
;

1401 ià(
	gisV”tiÿlText
)

1402 
	gsvgCh¬
.
	gªgË
 -= 90.0f;

1404 
	gsvgCh¬
.
	g·thD©a
->
	gxShiá
 = 
šfo
.
shiáx
 + 
xOr›Á©iÚShiá
;

1405 
	gsvgCh¬
.
	g·thD©a
->
	gyShiá
 = 
šfo
.
shiáy
 + 
yOr›Á©iÚShiá
;

1408 ià(
	gisV”tiÿlText
) {

1409 
	gsvgCh¬
.
	g·thD©a
->
	gxShiá
 +ğ
šfo
.
dx
;

1410 
	gsvgCh¬
.
	g·thD©a
->
	gyShiá
 -ğ
glyphAdvªû
 / 2.0f;

1412 
	gsvgCh¬
.
	g·thD©a
->
	gxShiá
 -ğ
glyphAdvªû
 / 2.0f;

1413 
	gsvgCh¬
.
	g·thD©a
->
	gyShiá
 +ğ
šfo
.
dy
;

1417 
	gk”nšg
 = 0.0f;

1418 #ià
ENABLE
(
SVG_FONTS
)

1419 
SVGFÚtEËm’t
* 
	gsvgFÚt
 = 0;

1420 ià(
	g¡yË
->
fÚt
().
isSVGFÚt
())

1421 
	gsvgFÚt
 = 
¡yË
->
fÚt
().
svgFÚt
();

1423 ià(
	gÏ¡Glyph
.
	gisV®id
 && 
	g¡yË
->
fÚt
().
isSVGFÚt
()) {

1424 
SVGHÜizÚlK”nšgPaœ
 
	gk”nšgPaœ
;

1425 ià(
	gsvgFÚt
->
g‘HÜizÚlK”nšgPaœFÜSŒšgsAndGlyphs
(
Ï¡Glyph
.
unicode
,†a¡Glyph.
glyphName
, 
unicodeSŒ
, glyphName, 
k”nšgPaœ
))

1426 
	gk”nšg
 = 
Ç¼owP»cisiÚToFlßt
(
k”nšgPaœ
.
k”nšg
);

1429 ià(
	g¡yË
->
fÚt
().
isSVGFÚt
()) {

1430 
	gÏ¡Glyph
.
	gunicode
 = 
unicodeSŒ
;

1431 
	gÏ¡Glyph
.
	gglyphName
 = 
glyphName
;

1432 
	gÏ¡Glyph
.
	gisV®id
 = 
Œue
;

1433 
	gk”nšg
 *ğ
¡yË
->
fÚt
().
size
(è/ styË->fÚt().
´im¬yFÚt
()->
un™sP”Em
();

1435 
	gÏ¡Glyph
.
	gisV®id
 = 
çl£
;

1438 
	gsvgCh¬
.
	gx
 -ğ
k”nšg
;

1441 ià(
	gisV”tiÿlText
) {

1442 
	gsvgCh¬
.
	gd¿wnS•”©ed
 = 
Œue
;

1443 
	gšfo
.
	gcury
 +ğ
glyphAdvªû
 + 
¥acšg
;

1445 
	gšfo
.
	gcurx
 +ğ
glyphAdvªû
 + 
¥acšg
 - 
k”nšg
;

1448 
	gk
 = 0; k < 
	gch¬sCÚsumed
; ++k) {

1449 
	gšfo
.
	gsvgCh¬s
.
­³nd
(
svgCh¬
);

1450 
	gšfo
.
´oûs£dSšgËCh¬aù”
();

1451 
	gsvgCh¬
.
	gd¿wnS•”©ed
 = 
çl£
;

1452 
	gsvgCh¬
.
	gÃwTextChunk
 = 
çl£
;

1457 
	gSVGRoÙIÆšeBox
::
budTextChunks
(
VeùÜ
<
SVGCh¬
>& 
svgCh¬s
, VeùÜ<
SVGTextChunk
>& 
svgTextChunks
, 
IÆšeFlowBox
* 
¡¬t
)

1459 
SVGTextChunkLayoutInfo
 
šfo
(
svgTextChunks
);

1460 
	gšfo
.
	g™
 = 
svgCh¬s
.
begš
();

1461 
	gšfo
.
	gchunk
.
	g¡¬t
 = 
svgCh¬s
.
begš
();

1462 
	gšfo
.
	gchunk
.
	g’d
 = 
svgCh¬s
.
begš
();

1464 
budTextChunks
(
svgCh¬s
, 
¡¬t
, 
šfo
);

1465 
ASSERT
(
šfo
.
™
 =ğ
svgCh¬s
.
’d
());

1468 
	gSVGRoÙIÆšeBox
::
budTextChunks
(
VeùÜ
<
SVGCh¬
>& 
svgCh¬s
, 
IÆšeFlowBox
* 
¡¬t
, 
SVGTextChunkLayoutInfo
& 
šfo
)

1470 #ià
DEBUG_CHUNK_BUILDING
 > 1

1471 
årštf
(
¡d”r
, " -> budTextChunks(¡¬t=%p)\n", 
¡¬t
);

1474 
IÆšeBox
* 
	gcu¼
 = 
¡¬t
->
fœ¡Chd
(); cu¼; cu¼ = 
cu¼
->
ÃxtOnLše
()) {

1475 ià(
cu¼
->
»nd””
()->
isText
()) {

1476 
IÆšeTextBox
* 
‹xtBox
 = 
¡©ic_ÿ¡
<IÆšeTextBox*>(
cu¼
);

1478 
	gËngth
 = 
‹xtBox
->
Ën
();

1479 ià(!
	gËngth
)

1482 #ià
DEBUG_CHUNK_BUILDING
 > 1

1483 
årštf
(
¡d”r
, " -> Handle inlineext box (%p) with %i characters (start: %i,ƒnd: %i), handlingTextPath=%i\n",

1484 
‹xtBox
, 
Ëngth
,extBox->
¡¬t
(),extBox->
’d
(), (è
šfo
.
hªdlšgTextP©h
);

1487 
R’d”Text
* 
	g‹xt
 = 
‹xtBox
->
‹xtR’d””
();

1488 
ASSERT
(
‹xt
);

1489 
ASSERT
(
‹xt
->
node
());

1491 
SVGTextCÚ‹ÁEËm’t
* 
	g‹xtCÚ‹Á
 = 0;

1492 
Node
* 
	gnode
 = 
‹xt
->
node
()->
·»Á
();

1493 
	gnode
 &&‚ode->
isSVGEËm’t
(è&& !
	g‹xtCÚ‹Á
) {

1494 ià(
	g¡©ic_ÿ¡
<
	gSVGEËm’t
*>(
	gnode
)->
isTextCÚ‹Á
())

1495 
	g‹xtCÚ‹Á
 = 
¡©ic_ÿ¡
<
SVGTextCÚ‹ÁEËm’t
*>(
node
);

1497 
	gnode
 = 
node
->
·»ÁNode
();

1499 
ASSERT
(
‹xtCÚ‹Á
);

1502 
boŞ
 
	gisFœ¡Ch¬aù”
 = 
šfo
.
svgTextChunks
.
isEm±y
(è&& info.
chunk
.
¡¬t
 =ğšfo.
™
 && info.chunk.¡¬ˆ=ğšfo.chunk.
’d
;

1503 ià(
	gisFœ¡Ch¬aù”
) {

1504 
ASSERT
(
šfo
.
chunk
.
boxes
.
isEm±y
());

1505 
	gšfo
.
	gchunk
.
	gboxes
.
­³nd
(
SVGIÆšeBoxCh¬aù”Rªge
());

1507 
ASSERT
(!
šfo
.
chunk
.
boxes
.
isEm±y
());

1510 
	gi
 = 0; i < 
	gËngth
; ++i) {

1511 
ASSERT
(
šfo
.
™
 !ğ
svgCh¬s
.
’d
());

1513 
	gSVGIÆšeBoxCh¬aù”Rªge
& 
	g¿nge
 = 
šfo
.
chunk
.
boxes
.
Ï¡
();

1514 ià(
	g¿nge
.
isO³n
()) {

1515 
	g¿nge
.
	gbox
 = 
cu¼
;

1516 
	g¿nge
.
	g¡¬tOff£t
 = (
i
 == 0 ? 0 : i - 1);

1518 #ià
DEBUG_CHUNK_BUILDING
 > 1

1519 
årštf
(
¡d”r
, " | -> Rªgi İ’! box=%p, s¹Off£t=%i\n", 
¿nge
.
box
,„ªge.
¡¬tOff£t
);

1524 ià(
	gšfo
.
	gassignChunkPrİ”t›s
) {

1525 
	gšfo
.
	gassignChunkPrİ”t›s
 = 
çl£
;

1527 
	gšfo
.
	gchunk
.
	gisV”tiÿlText
 = 
isV”tiÿlWr™šgMode
(
‹xt
->
¡yË
()->
svgStyË
());

1528 
	gšfo
.
	gchunk
.
	gisTextP©h
 = 
šfo
.
hªdlšgTextP©h
;

1529 
	gšfo
.
	gchunk
.
	gªchÜ
 = 
‹xt
->
¡yË
()->
svgStyË
()->
‹xtAnchÜ
();

1530 
	gšfo
.
	gchunk
.
	g‹xtL’gth
 = 
‹xtCÚ‹Á
->
‹xtL’gth
().
v®ue
(textContent);

1531 
	gšfo
.
	gchunk
.
	gËngthAdju¡
 = (
EL’gthAdju¡
è
‹xtCÚ‹Á
->
ËngthAdju¡
();

1533 #ià
DEBUG_CHUNK_BUILDING
 > 1

1534 
årštf
(
¡d”r
, " | -> AssigÀchunk…rİ”t›s, isV”tiÿlText=%i,‡nchÜ=%i\n", 
šfo
.
chunk
.
isV”tiÿlText
, info.chunk.
ªchÜ
);

1538 ià(
	gi
 > 0 && !
	gisFœ¡Ch¬aù”
 && (*
	gšfo
.
	g™
).
	gÃwTextChunk
) {

1540 
ASSERT
(!
¿nge
.
isO³n
());

1541 
ASSERT
(!
¿nge
.
isClo£d
());

1543 
	g¿nge
.
	g’dOff£t
 = 
i
;

1544 
şo£TextChunk
(
šfo
);

1546 #ià
DEBUG_CHUNK_BUILDING
 > 1

1547 
årštf
(
¡d”r
, " | -> Clo£ mid-‹xˆchunk,‡ˆ’dOff£t: %˜ªd s¹šg‚ew mid chunk!\n", 
¿nge
.
’dOff£t
);

1551 
¡¬tTextChunk
(
šfo
);

1552 ià(
	gi
 + 1 =ğ
Ëngth
) {

1553 #ià
DEBUG_CHUNK_BUILDING
 > 1

1554 
årštf
(
¡d”r
, " | -> Record†ast chunk of inlineext box!\n");

1557 
¡¬tTextChunk
(
šfo
);

1558 
	gSVGIÆšeBoxCh¬aù”Rªge
& 
	g¿nge
 = 
šfo
.
chunk
.
boxes
.
Ï¡
();

1560 
	gšfo
.
	gassignChunkPrİ”t›s
 = 
çl£
;

1561 
	gšfo
.
	gchunk
.
	gisV”tiÿlText
 = 
isV”tiÿlWr™šgMode
(
‹xt
->
¡yË
()->
svgStyË
());

1562 
	gšfo
.
	gchunk
.
	gisTextP©h
 = 
šfo
.
hªdlšgTextP©h
;

1563 
	gšfo
.
	gchunk
.
	gªchÜ
 = 
‹xt
->
¡yË
()->
svgStyË
()->
‹xtAnchÜ
();

1564 
	gšfo
.
	gchunk
.
	g‹xtL’gth
 = 
‹xtCÚ‹Á
->
‹xtL’gth
().
v®ue
(textContent);

1565 
	gšfo
.
	gchunk
.
	gËngthAdju¡
 = (
EL’gthAdju¡
è
‹xtCÚ‹Á
->
ËngthAdju¡
();

1567 
	g¿nge
.
	gbox
 = 
cu¼
;

1568 
	g¿nge
.
	g¡¬tOff£t
 = 
i
;

1570 
ASSERT
(!
¿nge
.
isO³n
());

1571 
ASSERT
(!
¿nge
.
isClo£d
());

1576 ià(
	gisFœ¡Ch¬aù”
)

1577 
	gisFœ¡Ch¬aù”
 = 
çl£
;

1579 ++
	gšfo
.
	g™
;

1582 #ià
DEBUG_CHUNK_BUILDING
 > 1

1583 
årštf
(
¡d”r
, " -> Finished inlineext box!\n");

1586 
	gSVGIÆšeBoxCh¬aù”Rªge
& 
	g¿nge
 = 
šfo
.
chunk
.
boxes
.
Ï¡
();

1587 ià(!
	g¿nge
.
isO³n
(è&& !¿nge.
isClo£d
()) {

1588 #ià
DEBUG_CHUNK_BUILDING
 > 1

1589 
årštf
(
¡d”r
, " -> La¡„ªgnÙ clo£d - closšg w™hƒndOff£t: %i\n", 
Ëngth
);

1593 
	g¿nge
.
	g’dOff£t
 = 
Ëngth
;

1595 ià(
	gšfo
.
	g™
 !ğ
svgCh¬s
.
’d
()) {

1596 #ià
DEBUG_CHUNK_BUILDING
 > 1

1597 
årštf
(
¡d”r
, " -> Not‡t†ast character yet!\n");

1602 ià((*
	gšfo
.
	g™
).
	gÃwTextChunk
) {

1603 #ià
DEBUG_CHUNK_BUILDING
 > 1

1604 
årštf
(
¡d”r
, " -> Next character starts‚ew chunk! Closing current chunk,‡nd starting‡‚ew one...\n");

1607 
şo£TextChunk
(
šfo
);

1608 
¡¬tTextChunk
(
šfo
);

1611 
	gšfo
.
	gchunk
.
	gboxes
.
­³nd
(
SVGIÆšeBoxCh¬aù”Rªge
());

1613 #ià
DEBUG_CHUNK_BUILDING
 > 1

1614 
årštf
(
¡d”r
, " -> Next character does NOT start‡‚ew chunk! Starting‚ew character„ange...\n");

1618 #ià
DEBUG_CHUNK_BUILDING
 > 1

1619 
årštf
(
¡d”r
, " -> Closing final chunk! Finished…rocessing!\n");

1623 
şo£TextChunk
(
šfo
);

1627 
ASSERT
(
cu¼
->
isIÆšeFlowBox
());

1628 
IÆšeFlowBox
* 
	gæowBox
 = 
¡©ic_ÿ¡
<IÆšeFlowBox*>(
cu¼
);

1630 ià(!
	gæowBox
->
»nd””
()->
node
())

1633 
boŞ
 
	gisTextP©h
 = 
æowBox
->
»nd””
()->
node
()->
hasTagName
(
SVGNames
::
‹xtP©hTag
);

1635 #ià
DEBUG_CHUNK_BUILDING
 > 1

1636 
årštf
(
¡d”r
, " -> HªdË iÆšæow box (%p), isTextP©h=%i\n", 
æowBox
, (è
isTextP©h
);

1639 ià(
	gisTextP©h
)

1640 
	gšfo
.
	ghªdlšgTextP©h
 = 
Œue
;

1642 
budTextChunks
(
svgCh¬s
, 
æowBox
, 
šfo
);

1644 ià(
	gisTextP©h
)

1645 
	gšfo
.
	ghªdlšgTextP©h
 = 
çl£
;

1649 #ià
DEBUG_CHUNK_BUILDING
 > 1

1650 
årštf
(
¡d”r
, " <- budTextChunks(¡¬t=%p)\n", 
¡¬t
);

1654 cÚ¡ 
	gVeùÜ
<
	gSVGTextChunk
>& 
	gSVGRoÙIÆšeBox
::
svgTextChunks
() const

1656  
m_svgTextChunks
;

1659 
	gSVGRoÙIÆšeBox
::
ÏyoutTextChunks
()

1661 
VeùÜ
<
SVGTextChunk
>::
™”©Ü
 
™
 = 
m_svgTextChunks
.
begš
();

1662 
	gVeùÜ
<
	gSVGTextChunk
>::
™”©Ü
 
’d
 = 
m_svgTextChunks
.end();

1664 ; 
	g™
 !ğ
’d
; ++it) {

1665 
	gSVGTextChunk
& 
	gchunk
 = *
™
;

1667 #ià
DEBUG_CHUNK_BUILDING
 > 0

1669 
årštf
(
¡d”r
, "Handle TEXT CHUNK!‡nchor=%i,extLength=%f,†engthAdjust=%i, isVerticalText=%i, isTextPath=%i start=%p,ƒnd=%p -> dist: %i\n",

1670 (è
chunk
.
ªchÜ
, chunk.
‹xtL’gth
, (èchunk.
ËngthAdju¡
, (èchunk.
isV”tiÿlText
,

1671 (è
chunk
.
isTextP©h
, chunk.
¡¬t
, chunk.
’d
, () (chunk.end - chunk.start));

1673 
	gVeùÜ
<
	gSVGIÆšeBoxCh¬aù”Rªge
>::
™”©Ü
 
boxIt
 = 
chunk
.
boxes
.
begš
();

1674 
	gVeùÜ
<
	gSVGIÆšeBoxCh¬aù”Rªge
>::
™”©Ü
 
boxEnd
 = 
chunk
.
boxes
.
’d
();

1676 
	gi
 = 0;

1677 ; 
	gboxIt
 !ğ
boxEnd
; ++boxIt) {

1678 
	gSVGIÆšeBoxCh¬aù”Rªge
& 
	g¿nge
 = *
boxIt
; 
	gi
++;

1679 
årštf
(
¡d”r
, " -> RANGE %˜STARTOFFSET: %i, ENDOFFSET: %i, BOX: %p\n", 
i
, 
¿nge
.
¡¬tOff£t
,„ªge.
’dOff£t
,„ªge.
box
);

1684 ià(
	gchunk
.
	gisTextP©h
)

1688 
­¶yTextL’gthCÜ»ùiÚToTextChunk
(
chunk
);

1691 
­¶yTextAnchÜToTextChunk
(
chunk
);

1695 
šlše
 
addPaštS”v”ToTextDecÜ©iÚInfo
(
ETextDecÜ©iÚ
 
decÜ©iÚ
, 
SVGTextDecÜ©iÚInfo
& 
šfo
, 
R’d”Objeù
* 
objeù
)

1697 ià(
	gobjeù
->
¡yË
()->
svgStyË
()->
hasFl
())

1698 
	gšfo
.
	gflS”v”M­
.
£t
(
decÜ©iÚ
, 
objeù
);

1700 ià(
	gobjeù
->
¡yË
()->
svgStyË
()->
hasSŒoke
())

1701 
	gšfo
.
	g¡rokeS”v”M­
.
£t
(
decÜ©iÚ
, 
objeù
);

1704 
SVGTextDecÜ©iÚInfo
 
	gSVGRoÙIÆšeBox
::
»Œ›vePaštS”v”sFÜTextDecÜ©iÚ
(
R’d”Objeù
* 
¡¬t
)

1706 
ASSERT
(
¡¬t
);

1708 
	gVeùÜ
<
	gR’d”Objeù
*> 
	g·»ÁChaš
;

1709 (
	g¡¬t
 = 
¡¬t
->
·»Á
())) {

1710 
·»ÁChaš
.
´•’d
(
¡¬t
);

1713 ià(
	g¡¬t
->
isSVGText
())

1717 
	gVeùÜ
<
	gR’d”Objeù
*>::
™”©Ü
 
™
 = 
·»ÁChaš
.
begš
();

1718 
	gVeùÜ
<
	gR’d”Objeù
*>::
™”©Ü
 
’d
 = 
·»ÁChaš
.end();

1720 
SVGTextDecÜ©iÚInfo
 
	gšfo
;

1722 ; 
	g™
 !ğ
’d
; ++it) {

1723 
R’d”Objeù
* 
	gobjeù
 = *
™
;

1724 
ASSERT
(
objeù
);

1726 
R’d”StyË
* 
	g¡yË
 = 
objeù
->
¡yË
();

1727 
ASSERT
(
¡yË
);

1729 
	gdecÜ©iÚs
 = 
¡yË
->
‹xtDecÜ©iÚ
();

1730 ià(
	gdecÜ©iÚs
 !ğ
NONE
) {

1731 ià(
decÜ©iÚs
 & 
OVERLINE
)

1732 
addPaštS”v”ToTextDecÜ©iÚInfo
(
OVERLINE
, 
šfo
, 
objeù
);

1734 ià(
	gdecÜ©iÚs
 & 
	gUNDERLINE
)

1735 
addPaštS”v”ToTextDecÜ©iÚInfo
(
UNDERLINE
, 
šfo
, 
objeù
);

1737 ià(
	gdecÜ©iÚs
 & 
	gLINE_THROUGH
)

1738 
addPaštS”v”ToTextDecÜ©iÚInfo
(
LINE_THROUGH
, 
šfo
, 
objeù
);

1742  
	gšfo
;

1745 
	gSVGRoÙIÆšeBox
::
w®kTextChunks
(
SVGTextChunkW®k”Ba£
* 
w®k”
, cÚ¡ 
SVGIÆšeTextBox
* 
‹xtBox
)

1747 
ASSERT
(
w®k”
);

1749 
	gVeùÜ
<
	gSVGTextChunk
>::
™”©Ü
 
™
 = 
m_svgTextChunks
.
begš
();

1750 
	gVeùÜ
<
	gSVGTextChunk
>::
™”©Ü
 
™End
 = 
m_svgTextChunks
.
’d
();

1752 ; 
	g™
 !ğ
™End
; ++it) {

1753 
	gSVGTextChunk
& 
	gcurChunk
 = *
™
;

1755 
	gVeùÜ
<
	gSVGIÆšeBoxCh¬aù”Rªge
>::
™”©Ü
 
boxIt
 = 
curChunk
.
boxes
.
begš
();

1756 
	gVeùÜ
<
	gSVGIÆšeBoxCh¬aù”Rªge
>::
™”©Ü
 
boxEnd
 = 
curChunk
.
boxes
.
’d
();

1758 
IÆšeBox
* 
	gÏ¡NÙif›dBox
 = 0;

1759 
IÆšeBox
* 
	g´evBox
 = 0;

1761 
	gchunkOff£t
 = 0;

1762 
boŞ
 
	g¡¬‹dFœ¡Chunk
 = 
çl£
;

1764 ; 
	gboxIt
 !ğ
boxEnd
; ++boxIt) {

1765 
	gSVGIÆšeBoxCh¬aù”Rªge
& 
	g¿nge
 = *
boxIt
;

1767 
ASSERT
(
¿nge
.
box
->
isIÆšeTextBox
());

1768 
SVGIÆšeTextBox
* 
	g¿ngeTextBox
 = 
¡©ic_ÿ¡
<SVGIÆšeTextBox*>(
¿nge
.
box
);

1770 ià(
	g‹xtBox
 && 
	g¿ngeTextBox
 !ğ
‹xtBox
) {

1771 
chunkOff£t
 +ğ
¿nge
.
’dOff£t
 -„ªge.
¡¬tOff£t
;

1776 ià(!
	g‹xtBox
 && !
	g¡¬‹dFœ¡Chunk
) {

1777 
	g¡¬‹dFœ¡Chunk
 = 
Œue
;

1779 
	gÏ¡NÙif›dBox
 = 
¿nge
.
box
;

1780 
	gw®k”
->
¡¬t
(
¿nge
.
box
);

1783 ià(
	g´evBox
 &&…»vBox !ğ
¿nge
.
box
) {

1784 
Ï¡NÙif›dBox
 = 
¿nge
.
box
;

1786 
	gw®k”
->
’d
(
´evBox
);

1787 
	gw®k”
->
¡¬t
(
Ï¡NÙif›dBox
);

1791 
	gËngth
 = 
¿nge
.
’dOff£t
 -„ªge.
¡¬tOff£t
;

1793 
	gVeùÜ
<
	gSVGCh¬
>::
™”©Ü
 
™Ch¬Begš
 = 
curChunk
.
¡¬t
 + 
chunkOff£t
;

1794 
	gVeùÜ
<
	gSVGCh¬
>::
™”©Ü
 
™Ch¬End
 = 
curChunk
.
¡¬t
 + 
chunkOff£t
 + 
Ëngth
;

1795 
ASSERT
(
™Ch¬End
 <ğ
curChunk
.
’d
);

1798 (*
	gw®k”
)(
	g¿ngeTextBox
, 
	g¿nge
.
	g¡¬tOff£t
, 
	gcurChunk
.
	gùm
, 
	g™Ch¬Begš
, 
	g™Ch¬End
);

1800 
	gchunkOff£t
 +ğ
Ëngth
;

1802 ià(!
	g‹xtBox
)

1803 
	g´evBox
 = 
¿nge
.
box
;

1806 ià(!
	g‹xtBox
 && 
	g¡¬‹dFœ¡Chunk
)

1807 
	gw®k”
->
’d
(
Ï¡NÙif›dBox
);

	@SVGRootInlineBox.h

25 #iâdeà
SVGRoÙIÆšeBox_h


26 
	#SVGRoÙIÆšeBox_h


	)

28 #ià
ENABLE
(
SVG
)

29 
	~"RoÙIÆšeBox.h
"

30 
	~"SVGCh¬aù”LayoutInfo.h
"

31 
	~"SVGR’d”SuµÜt.h
"

33 
Çme¥aû
 
	gWebCÜe
 {

35 
şass
 
	gIÆšeTextBox
;

36 
şass
 
	gR’d”SVGRoÙ
;

37 
şass
 
	gSVGIÆšeTextBox
;

39 
	sLa¡GlyphInfo
 {

40 
La¡GlyphInfo
(è: 
isV®id
(
çl£
) { }

42 
SŒšg
 
unicode
;

43 
SŒšg
 
	gglyphName
;

44 
boŞ
 
	gisV®id
;

47 
şass
 
	gSVGRoÙIÆšeBox
 : 
public
 
RoÙIÆšeBox
, 
´Ùeùed
 
	gSVGR’d”Ba£
 {

48 
	gpublic
:

49 
SVGRoÙIÆšeBox
(
R’d”Objeù
* 
obj
)

50 : 
RoÙIÆšeBox
(
obj
)

51 , 
m_height
(0)

54 
vœtu®
 cÚ¡ 
SVGR’d”Ba£
* 
toSVGR’d”Ba£
(ècÚ¡ {  
	gthis
; }

56 
vœtu®
 
boŞ
 
isSVGRoÙIÆšeBox
(è{  
	gŒue
; }

58 
vœtu®
 
vœtu®Height
(ècÚ¡ {  
	gm_height
; }

59 
£tHeight
(
h
è{ 
	gm_height
 = h; }

61 
vœtu®
 
·št
(
R’d”Objeù
::
PaštInfo
&, 
tx
, 
ty
);

63 
vœtu®
 
¶aûBoxesHÜizÚÎy
(
x
, & 
ËáPos™iÚ
, & 
rightPos™iÚ
, 
boŞ
& 
ÃedsWÜdS·cšg
);

64 
vœtu®
 
v”tiÿÎyAlignBoxes
(
heightOfBlock
);

66 
vœtu®
 
compu‹P”Ch¬aù”LayoutInfÜm©iÚ
();

68 
vœtu®
 
FlßtReù
 
objeùBoundšgBox
() const {  FloatRect(); }

69 
vœtu®
 
FlßtReù
 
»·štReùInLoÿlCoÜdš©es
() const {  FloatRect(); }

72 cÚ¡ 
	gVeùÜ
<
	gSVGTextChunk
>& 
svgTextChunks
() const;

74 
w®kTextChunks
(
SVGTextChunkW®k”Ba£
*, cÚ¡ 
SVGIÆšeTextBox
* 
‹xtBox
 = 0);

76 
	g´iv©e
:

77 
ä›nd
 
SVGRoÙIÆšeBoxPaštW®k”
;

79 
ÏyoutIÆšeBoxes
();

80 
ÏyoutIÆšeBoxes
(
IÆšeFlowBox
* 
¡¬t
, 
VeùÜ
<
SVGCh¬
>::
™”©Ü
& 
™
, & 
mšX
, & 
maxX
, & 
mšY
, & 
maxY
);

82 
budLayoutInfÜm©iÚ
(
IÆšeFlowBox
* 
¡¬t
, 
SVGCh¬aù”LayoutInfo
&);

83 
budLayoutInfÜm©iÚFÜTextBox
(
SVGCh¬aù”LayoutInfo
&, 
IÆšeTextBox
*, 
La¡GlyphInfo
&);

85 
budTextChunks
(
VeùÜ
<
SVGCh¬
>&, VeùÜ<
SVGTextChunk
>&, 
IÆšeFlowBox
* 
¡¬t
);

86 
budTextChunks
(
VeùÜ
<
SVGCh¬
>&, 
IÆšeFlowBox
* 
¡¬t
, 
SVGTextChunkLayoutInfo
&);

87 
ÏyoutTextChunks
();

89 
SVGTextDecÜ©iÚInfo
 
»Œ›vePaštS”v”sFÜTextDecÜ©iÚ
(
R’d”Objeù
* 
¡¬t
);

91 
	g´iv©e
:

92 
m_height
;

93 
	gVeùÜ
<
	gSVGCh¬
> 
	gm_svgCh¬s
;

94 
	gVeùÜ
<
	gSVGTextChunk
> 
	gm_svgTextChunks
;

98 
TextRun
 
svgTextRunFÜIÆšeTextBox
(cÚ¡ 
UCh¬
*, 
Ën
, 
R’d”StyË
* 
¡yË
, cÚ¡ 
IÆšeTextBox
* 
‹xtBox
, 
xPos
);

99 
FlßtPošt
 
tİLeáPos™iÚOfCh¬aù”Rªge
(
VeùÜ
<
SVGCh¬
>::
™”©Ü
 
¡¬t
, VeùÜ<SVGCh¬>::™”©Ü 
’d
);

100 
cummuÏ‹dWidthOfIÆšeBoxCh¬aù”Rªge
(
SVGIÆšeBoxCh¬aù”Rªge
& 
¿nge
);

101 
cummuÏ‹dHeightOfIÆšeBoxCh¬aù”Rªge
(
SVGIÆšeBoxCh¬aù”Rªge
& 
¿nge
);

103 
R’d”SVGRoÙ
* 
fšdSVGRoÙObjeù
(
R’d”Objeù
* 
¡¬t
);

	@SVGShadowTreeElements.cpp

20 
	~"cÚfig.h
"

22 #ià
ENABLE
(
SVG
)

23 
	~"SVGShadowT»eEËm’ts.h
"

25 
	~"Docum’t.h
"

26 
	~"FlßtSize.h
"

27 
	~"R’d”Objeù.h
"

28 
	~"SVGNames.h
"

30 
Çme¥aû
 
	gWebCÜe
 {

33 
	gSVGShadowT»eCÚš”EËm’t
::
SVGShadowT»eCÚš”EËm’t
(
Docum’t
* 
docum’t
)

34 : 
SVGGEËm’t
(
SVGNames
::
gTag
, 
docum’t
)

38 
	gSVGShadowT»eCÚš”EËm’t
::~
SVGShadowT»eCÚš”EËm’t
()

42 
FlßtSize
 
SVGShadowT»eCÚš”EËm’t
::
cÚš”T¿n¦©iÚ
() const

44  
FlßtSize
(
m_xOff£t
.
v®ue
(
this
), 
m_yOff£t
.value(this));

48 
	gSVGShadowT»eRoÙEËm’t
::
SVGShadowT»eRoÙEËm’t
(
Docum’t
* 
docum’t
, 
Node
* 
shadowP¬’t
)

49 : 
SVGShadowT»eCÚš”EËm’t
(
docum’t
)

50 , 
m_shadowP¬’t
(
shadowP¬’t
)

52 
£tInDocum’t
(
Œue
);

55 
	gSVGShadowT»eRoÙEËm’t
::~
SVGShadowT»eRoÙEËm’t
()

59 
SVGShadowT»eRoÙEËm’t
::
©chEËm’t
(
PassRefPŒ
<
R’d”StyË
> 
¡yË
, 
R’d”A»Ç
* 
¬’a
)

61 
ASSERT
(
m_shadowP¬’t
);

64 
R’d”Objeù
* 
	g»nd””
 = 
ü—‹R’d””
(
¬’a
, 
¡yË
.
g‘
());

65 ià(
	g»nd””
) {

66 
£tR’d””
(
»nd””
);

67 
	g»nd””
->
£tStyË
(
¡yË
);

71 
£tA‰ached
();

74 ià(
	g»nd””
)

75 
	gm_shadowP¬’t
->
»nd””
()->
addChd
(renderer);

	@SVGShadowTreeElements.h

20 #iâdeà
SVGShadowT»eEËm’ts_h


21 
	#SVGShadowT»eEËm’ts_h


	)

23 #ià
ENABLE
(
SVG
)

24 
	~"SVGGEËm’t.h
"

25 
	~"SVGL’gth.h
"

27 
Çme¥aû
 
	gWebCÜe
 {

29 
şass
 
	gFlßtSize
;

31 şas 
	cSVGShadowT»eCÚš”EËm’t
 : 
public
 
SVGGEËm’t
 {

32 
public
:

33 
SVGShadowT»eCÚš”EËm’t
(
Docum’t
*);

34 
	gvœtu®
 ~
SVGShadowT»eCÚš”EËm’t
();

36 
vœtu®
 
boŞ
 
isShadowT»eCÚš”EËm’t
(ècÚ¡ {  
	gŒue
; }

38 
FlßtSize
 
cÚš”T¿n¦©iÚ
() const;

39 
£tCÚš”Off£t
(cÚ¡ 
SVGL’gth
& 
x
, cÚ¡ SVGL’gth& 
y
)

41 
	gm_xOff£t
 = 
x
;

42 
	gm_yOff£t
 = 
y
;

45 
	g´iv©e
:

46 
SVGL’gth
 
m_xOff£t
;

47 
SVGL’gth
 
	gm_yOff£t
;

50 şas 
	cSVGShadowT»eRoÙEËm’t
 : 
public
 
SVGShadowT»eCÚš”EËm’t
 {

51 
public
:

52 
SVGShadowT»eRoÙEËm’t
(
Docum’t
*, 
Node
* 
shadowP¬’t
);

53 
	gvœtu®
 ~
SVGShadowT»eRoÙEËm’t
();

55 
vœtu®
 
boŞ
 
isShadowNode
(ècÚ¡ {  
	gm_shadowP¬’t
; }

56 
vœtu®
 
Node
* 
shadowP¬’tNode
(è{  
	gm_shadowP¬’t
; }

58 
©chEËm’t
(
PassRefPŒ
<
R’d”StyË
>, 
R’d”A»Ç
*);

60 
	g´iv©e
:

61 
Node
* 
m_shadowP¬’t
;

	@ScrollBehavior.cpp

44 
	~"cÚfig.h
"

45 
	~"SüŞlBehaviÜ.h
"

47 
Çme¥aû
 
	gWebCÜe
 {

49 cÚ¡ 
SüŞlAlignm’t
 
	gSüŞlAlignm’t
::
®ignC’‹rIfN“ded
 = { 
noSüŞl
, 
®ignC’‹r
, 
®ignToClo£¡Edge
 };

50 cÚ¡ 
SüŞlAlignm’t
 
	gSüŞlAlignm’t
::
®ignToEdgeIfN“ded
 = { 
noSüŞl
, 
®ignToClo£¡Edge
,‡lignToClosestEdge };

51 cÚ¡ 
SüŞlAlignm’t
 
	gSüŞlAlignm’t
::
®ignC’‹rAlways
 = { 
®ignC’‹r
,‡lignCenter,‡lignCenter };

52 cÚ¡ 
SüŞlAlignm’t
 
	gSüŞlAlignm’t
::
®ignTİAlways
 = { 
®ignTİ
,‡lignTop,‡lignTop };

53 cÚ¡ 
SüŞlAlignm’t
 
	gSüŞlAlignm’t
::
®ignBÙtomAlways
 = { 
®ignBÙtom
,‡lignBottom,‡lignBottom };

	@ScrollBehavior.h

44 #iâdeà
SüŞlBehaviÜ_h


45 
	#SüŞlBehaviÜ_h


	)

47 
Çme¥aû
 
	gWebCÜe
 {

49 
	eSüŞlBehaviÜ
 {

50 
	gnoSüŞl
,

51 
	g®ignC’‹r
,

52 
	g®ignTİ
,

53 
	g®ignBÙtom
,

54 
	g®ignLeá
,

55 
	g®ignRight
,

56 
	g®ignToClo£¡Edge


59 
	sSüŞlAlignm’t
 {

60 
SüŞlBehaviÜ
 
g‘VisibËBehaviÜ
(cÚ¡ 
SüŞlAlignm’t
& 
s
è{  
	gs
.
	gm_»ùVisibË
; }

61 
SüŞlBehaviÜ
 
g‘P¬tŸlBehaviÜ
(cÚ¡ 
SüŞlAlignm’t
& 
s
è{  
	gs
.
	gm_»ùP¬tŸl
; }

62 
SüŞlBehaviÜ
 
g‘Hidd’BehaviÜ
(cÚ¡ 
SüŞlAlignm’t
& 
s
è{  
	gs
.
	gm_»ùHidd’
; }

64 cÚ¡ 
SüŞlAlignm’t
 
	g®ignC’‹rIfN“ded
;

65 cÚ¡ 
SüŞlAlignm’t
 
	g®ignToEdgeIfN“ded
;

66 cÚ¡ 
SüŞlAlignm’t
 
	g®ignC’‹rAlways
;

67 cÚ¡ 
SüŞlAlignm’t
 
	g®ignTİAlways
;

68 cÚ¡ 
SüŞlAlignm’t
 
	g®ignBÙtomAlways
;

70 
SüŞlBehaviÜ
 
	gm_»ùVisibË
;

71 
SüŞlBehaviÜ
 
	gm_»ùHidd’
;

72 
SüŞlBehaviÜ
 
	gm_»ùP¬tŸl
;

	@TableLayout.h

21 #iâdeà
TabËLayout_h


22 
	#TabËLayout_h


	)

24 
	~<wtf/NÚcİyabË.h
>

26 
Çme¥aû
 
	gWebCÜe
 {

28 
şass
 
	gR’d”TabË
;

30 şas 
	cTabËLayout
 : 
public
 
NÚcİyabË
 {

31 
public
:

32 
TabËLayout
(
R’d”TabË
* 
bË
)

33 : 
m_bË
(
bË
)

37 
vœtu®
 ~
TabËLayout
() { }

39 
vœtu®
 
ÿlcP»fWidths
(& 
mšWidth
, & 
maxWidth
) = 0;

40 
vœtu®
 
Ïyout
() = 0;

42 
	g´Ùeùed
:

43 
R’d”TabË
* 
m_bË
;

	@TextControlInnerElements.cpp

26 
	~"cÚfig.h
"

27 
	~"TextCÚŒŞIÂ”EËm’ts.h
"

29 
	~"BefÜeTextIn£¹edEv’t.h
"

30 
	~"Docum’t.h
"

31 
	~"Ev’tHªdËr.h
"

32 
	~"Ev’tNames.h
"

33 
	~"F¿me.h
"

34 
	~"HTMLIÅutEËm’t.h
"

35 
	~"HTMLNames.h
"

36 
	~"HTMLTextA»aEËm’t.h
"

37 
	~"Mou£Ev’t.h
"

38 
	~"R’d”Lay”.h
"

39 
	~"R’d”TextCÚŒŞSšgËLše.h
"

41 
Çme¥aû
 
	gWebCÜe
 {

43 şas 
	cR’d”TextCÚŒŞIÂ”Block
 : 
public
 
R’d”Block
 {

44 
public
:

45 
R’d”TextCÚŒŞIÂ”Block
(
Node
* 
node
, 
boŞ
 
isMuÉiLše
è: 
R’d”Block
Òode), 
m_muÉiLše
(isMultiLine) { }

47 
vœtu®
 
boŞ
 
nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
&, 
H™Te¡ResuÉ
&, 
x
, 
y
, 
tx
, 
ty
, 
H™Te¡AùiÚ
);

48 
vœtu®
 
VisibËPos™iÚ
 
pos™iÚFÜPošt
(cÚ¡ 
IÁPošt
&);

49 
	g´iv©e
:

50 
boŞ
 
m_muÉiLše
;

53 
boŞ
 
	gR’d”TextCÚŒŞIÂ”Block
::
	$nodeAtPošt
(cÚ¡ 
H™Te¡Reque¡
& 
»que¡
, 
H™Te¡ResuÉ
& 
»suÉ
, 
x
, 
y
, 
tx
, 
ty
, 
H™Te¡AùiÚ
 
h™Te¡AùiÚ
)

55 
R’d”Objeù
* 
»nd””
 = 
	`node
()->
	`shadowAnû¡ÜNode
()->
	`»nd””
();

57 
boŞ
 
¶aûhŞd”IsVisibË
 = 
çl£
;

58 ià(
»nd””
->
	`isTextF›ld
())

59 
¶aûhŞd”IsVisibË
 = 
	`toR’d”TextCÚŒŞSšgËLše
(
»nd””
)->
	`¶aûhŞd”IsVisibË
();

61  
R’d”Block
::
	`nodeAtPošt
(
»que¡
, 
»suÉ
, 
x
, 
y
, 
tx
, 
ty
, 
¶aûhŞd”IsVisibË
 ? 
H™Te¡BlockBackground
 : 
h™Te¡AùiÚ
);

62 
	}
}

64 
VisibËPos™iÚ
 
	gR’d”TextCÚŒŞIÂ”Block
::
	$pos™iÚFÜPošt
(cÚ¡ 
IÁPošt
& 
pošt
)

66 
IÁPošt
 
	`cÚ‹ÁsPošt
(
pošt
);

70 ià(
m_muÉiLše
) {

71 
R’d”TextCÚŒŞ
* 
»nd””
 = 
	`toR’d”TextCÚŒŞ
(
	`node
()->
	`shadowAnû¡ÜNode
()->
	`»nd””
());

72 ià(
»nd””
->
	`hasOv”æowCl
())

73 
cÚ‹ÁsPošt
 +ğ
»nd””
->
	`Ïy”
()->
	`süŞËdCÚ‹ÁOff£t
();

76  
R’d”Block
::
	`pos™iÚFÜPošt
(
cÚ‹ÁsPošt
);

77 
	}
}

79 
	gTextCÚŒŞIÂ”EËm’t
::
	$TextCÚŒŞIÂ”EËm’t
(
Docum’t
* 
doc
, 
Node
* 
shadowP¬’t
)

80 : 
	`HTMLDivEËm’t
(
HTMLNames
::
divTag
, 
doc
)

81 , 
	$m_shadowP¬’t
(
shadowP¬’t
)

83 
	}
}

85 
	gTextCÚŒŞIÂ”EËm’t
::
©chIÂ”EËm’t
(
Node
* 
·»Á
, 
PassRefPŒ
<
R’d”StyË
> 
¡yË
, 
R’d”A»Ç
* 
¬’a
)

91 
R’d”Objeù
* 
	g»nd””
 = 
ü—‹R’d””
(
¬’a
, 
¡yË
.
g‘
());

92 ià(
	g»nd””
) {

93 
£tR’d””
(
»nd””
);

94 
	g»nd””
->
£tStyË
(
¡yË
);

98 
£tA‰ached
();

99 
£tInDocum’t
(
Œue
);

102 ià(!
	gm_shadowP¬’t
)

103 
	g·»Á
->
addChd
(
this
);

106 ià(
	g»nd””
)

107 
	g·»Á
->
»nd””
()->
addChd
(renderer);

110 
	gTextCÚŒŞIÂ”TextEËm’t
::
	$TextCÚŒŞIÂ”TextEËm’t
(
Docum’t
* 
doc
, 
Node
* 
shadowP¬’t
)

111 : 
	$TextCÚŒŞIÂ”EËm’t
(
doc
, 
shadowP¬’t
)

113 
	}
}

115 
	gTextCÚŒŞIÂ”TextEËm’t
::
	$deçuÉEv’tHªdËr
(
Ev’t
* 
evt
)

118 
Node
* 
shadowAnû¡Ü
 = 
	`shadowAnû¡ÜNode
();

119 ià(
shadowAnû¡Ü
 && shadowAnû¡Ü->
	`»nd””
()) {

120 
	`ASSERT
(
shadowAnû¡Ü
->
	`»nd””
()->
	`isTextCÚŒŞ
());

121 ià(
evt
->
	`isBefÜeTextIn£¹edEv’t
()) {

122 ià(
shadowAnû¡Ü
->
	`»nd””
()->
	`isTextF›ld
())

123 
¡©ic_ÿ¡
<
HTMLIÅutEËm’t
*>(
shadowAnû¡Ü
)->
	`deçuÉEv’tHªdËr
(
evt
);

125 
¡©ic_ÿ¡
<
HTMLTextA»aEËm’t
*>(
shadowAnû¡Ü
)->
	`deçuÉEv’tHªdËr
(
evt
);

127 ià(
evt
->
	`ty³
(è=ğ
	`ev’tNames
().
webk™Ed™abËCÚ‹ÁChªgedEv’t
)

128 
	`toR’d”TextCÚŒŞ
(
shadowAnû¡Ü
->
	`»nd””
())->
	`subŒ“HasChªged
();

130 ià(!
evt
->
	`deçuÉHªdËd
())

131 
HTMLDivEËm’t
::
	`deçuÉEv’tHªdËr
(
evt
);

132 
	}
}

134 
R’d”Objeù
* 
	gTextCÚŒŞIÂ”TextEËm’t
::
	$ü—‹R’d””
(
R’d”A»Ç
* 
¬’a
, 
R’d”StyË
*)

136 
boŞ
 
muÉiLše
 = 
çl£
;

137 
Node
* 
shadowAnû¡Ü
 = 
	`shadowAnû¡ÜNode
();

138 ià(
shadowAnû¡Ü
 && shadowAnû¡Ü->
	`»nd””
()) {

139 
	`ASSERT
(
shadowAnû¡Ü
->
	`»nd””
()->
	`isTextF›ld
(è|| shadowAnû¡Ü->»nd””()->
	`isTextA»a
());

140 
muÉiLše
 = 
shadowAnû¡Ü
->
	`»nd””
()->
	`isTextA»a
();

142  
	`Ãw
 (
¬’a
è
	`R’d”TextCÚŒŞIÂ”Block
(
this
, 
muÉiLše
);

143 
	}
}

145 
	gS—rchF›ldResuÉsBu‰ÚEËm’t
::
	$S—rchF›ldResuÉsBu‰ÚEËm’t
(
Docum’t
* 
doc
)

146 : 
	$TextCÚŒŞIÂ”EËm’t
(
doc
)

148 
	}
}

150 
S—rchF›ldResuÉsBu‰ÚEËm’t
::
	$deçuÉEv’tHªdËr
(
Ev’t
* 
evt
)

153 
HTMLIÅutEËm’t
* 
šput
 = 
¡©ic_ÿ¡
<HTMLIÅutEËm’t*>(
	`shadowAnû¡ÜNode
());

154 ià(
evt
->
	`ty³
(è=ğ
	`ev’tNames
().
mou£downEv’t
 &&ƒvt->
	`isMou£Ev’t
(è&& 
¡©ic_ÿ¡
<
Mou£Ev’t
*>Óvt)->
	`bu‰Ú
(è=ğ
LeáBu‰Ú
) {

155 
šput
->
	`focus
();

156 
šput
->
	`£Ëù
();

157 
R’d”TextCÚŒŞSšgËLše
* 
»nd””
 = 
	`toR’d”TextCÚŒŞSšgËLše
(
šput
->
	`»nd””
());

158 ià(
»nd””
->
	`pİupIsVisibË
())

159 
»nd””
->
	`hidePİup
();

160 ià(
šput
->
	`maxResuÉs
() > 0)

161 
»nd””
->
	`showPİup
();

162 
evt
->
	`£tDeçuÉHªdËd
();

164 ià(!
evt
->
	`deçuÉHªdËd
())

165 
HTMLDivEËm’t
::
	`deçuÉEv’tHªdËr
(
evt
);

166 
	}
}

168 
	gS—rchF›ldCªûlBu‰ÚEËm’t
::
	$S—rchF›ldCªûlBu‰ÚEËm’t
(
Docum’t
* 
doc
)

169 : 
	`TextCÚŒŞIÂ”EËm’t
(
doc
)

170 , 
	$m_ÿ±uršg
(
çl£
)

172 
	}
}

174 
	gS—rchF›ldCªûlBu‰ÚEËm’t
::
	$d‘ach
()

176 ià(
m_ÿ±uršg
) {

177 ià(
F¿me
* 
äame
 = 
	`docum’t
()->
	`äame
())

178 
äame
->
	`ev’tHªdËr
()->
	`£tC­turšgMou£Ev’tsNode
(0);

180 
TextCÚŒŞIÂ”EËm’t
::
	`d‘ach
();

181 
	}
}

184 
	gS—rchF›ldCªûlBu‰ÚEËm’t
::
	$deçuÉEv’tHªdËr
(
Ev’t
* 
evt
)

187 
HTMLIÅutEËm’t
* 
šput
 = 
¡©ic_ÿ¡
<HTMLIÅutEËm’t*>(
	`shadowAnû¡ÜNode
());

188 ià(
evt
->
	`ty³
(è=ğ
	`ev’tNames
().
mou£downEv’t
 &&ƒvt->
	`isMou£Ev’t
(è&& 
¡©ic_ÿ¡
<
Mou£Ev’t
*>Óvt)->
	`bu‰Ú
(è=ğ
LeáBu‰Ú
) {

189 
šput
->
	`focus
();

190 
šput
->
	`£Ëù
();

191 
evt
->
	`£tDeçuÉHªdËd
();

192 ià(
	`»nd””
(è&&„’d””()->
	`visibËToH™Te¡šg
())

193 ià(
F¿me
* 
äame
 = 
	`docum’t
()->
	`äame
()) {

194 
äame
->
	`ev’tHªdËr
()->
	`£tC­turšgMou£Ev’tsNode
(
this
);

195 
m_ÿ±uršg
 = 
Œue
;

197 } ià(
evt
->
	`ty³
(è=ğ
	`ev’tNames
().
mou£upEv’t
 &&ƒvt->
	`isMou£Ev’t
(è&& 
¡©ic_ÿ¡
<
Mou£Ev’t
*>Óvt)->
	`bu‰Ú
(è=ğ
LeáBu‰Ú
) {

198 ià(
m_ÿ±uršg
 && 
	`»nd””
(è&&„’d””()->
	`visibËToH™Te¡šg
()) {

199 ià(
	`hov”ed
()) {

200 
šput
->
	`£tV®ue
("");

201 
šput
->
	`ÚS—rch
();

202 
evt
->
	`£tDeçuÉHªdËd
();

204 ià(
F¿me
* 
äame
 = 
	`docum’t
()->
	`äame
()) {

205 
äame
->
	`ev’tHªdËr
()->
	`£tC­turšgMou£Ev’tsNode
(0);

206 
m_ÿ±uršg
 = 
çl£
;

210 ià(!
evt
->
	`deçuÉHªdËd
())

211 
HTMLDivEËm’t
::
	`deçuÉEv’tHªdËr
(
evt
);

212 
	}
}

	@TextControlInnerElements.h

26 #iâdeà
TextCÚŒŞIÂ”EËm’ts_h


27 
	#TextCÚŒŞIÂ”EËm’ts_h


	)

29 
	~"HTMLDivEËm’t.h
"

31 
Çme¥aû
 
	gWebCÜe
 {

33 
şass
 
	gSŒšg
;

35 şas 
	cTextCÚŒŞIÂ”EËm’t
 : 
public
 
HTMLDivEËm’t
 {

36 
public
:

37 
TextCÚŒŞIÂ”EËm’t
(
Docum’t
*, 
Node
* 
shadowP¬’t
 = 0);

39 
vœtu®
 
boŞ
 
isMou£Focu§bË
(ècÚ¡ {  
	gçl£
; }

40 
vœtu®
 
boŞ
 
isShadowNode
(ècÚ¡ {  
	gm_shadowP¬’t
; }

41 
vœtu®
 
Node
* 
shadowP¬’tNode
(è{  
	gm_shadowP¬’t
; }

42 
£tShadowP¬’tNode
(
Node
* 
node
è{ 
	gm_shadowP¬’t
 =‚ode; }

43 
©chIÂ”EËm’t
(
Node
*, 
PassRefPŒ
<
R’d”StyË
>, 
R’d”A»Ç
*);

45 
	g´iv©e
:

46 
Node
* 
m_shadowP¬’t
;

49 şas 
	cTextCÚŒŞIÂ”TextEËm’t
 : 
public
 
TextCÚŒŞIÂ”EËm’t
 {

50 
public
:

51 
TextCÚŒŞIÂ”TextEËm’t
(
Docum’t
*, 
Node
* 
shadowP¬’t
);

52 
vœtu®
 
R’d”Objeù
* 
ü—‹R’d””
(
R’d”A»Ç
*, 
R’d”StyË
*);

53 
vœtu®
 
deçuÉEv’tHªdËr
(
Ev’t
*);

56 şas 
	cS—rchF›ldResuÉsBu‰ÚEËm’t
 : 
public
 
TextCÚŒŞIÂ”EËm’t
 {

57 
public
:

58 
S—rchF›ldResuÉsBu‰ÚEËm’t
(
Docum’t
*);

59 
vœtu®
 
deçuÉEv’tHªdËr
(
Ev’t
*);

62 şas 
	cS—rchF›ldCªûlBu‰ÚEËm’t
 : 
public
 
TextCÚŒŞIÂ”EËm’t
 {

63 
public
:

64 
S—rchF›ldCªûlBu‰ÚEËm’t
(
Docum’t
*);

65 
vœtu®
 
deçuÉEv’tHªdËr
(
Ev’t
*);

66 
vœtu®
 
d‘ach
();

67 
	g´iv©e
:

68 
boŞ
 
m_ÿ±uršg
;

	@TrailingFloatsRootInlineBox.h

26 #iâdeà
T¿šgFlßtsRoÙIÆšeBox_h


27 
	#T¿šgFlßtsRoÙIÆšeBox_h


	)

29 
	~"RoÙIÆšeBox.h
"

31 
Çme¥aû
 
	gWebCÜe
 {

33 şas 
	cT¿šgFlßtsRoÙIÆšeBox
 : 
public
 
RoÙIÆšeBox
 {

34 
public
:

35 
T¿šgFlßtsRoÙIÆšeBox
(
R’d”Objeù
* 
objeù
è: 
RoÙIÆšeBox
(object)

37 #ià
ENABLE
(
SVG
)

38 
£tHasVœtu®Height
();

42 
	g´iv©e
:

43 
vœtu®
 
vœtu®Height
() const {  0; }

	@TransformState.cpp

26 
	~"cÚfig.h
"

27 
	~"T¿nsfÜmS‹.h
"

29 
Çme¥aû
 
	gWebCÜe
 {

31 
	gT¿nsfÜmS‹
::
move
(
x
, 
y
, 
T¿nsfÜmAccumuÏtiÚ
 
accumuÏ‹
)

33 ià(
	gm_accumuÏtšgT¿nsfÜm
 && 
	gm_accumuÏ‹dT¿nsfÜm
) {

35 ià(
	gm_dœeùiÚ
 =ğ
AµlyT¿nsfÜmDœeùiÚ
)

36 
m_accumuÏ‹dT¿nsfÜm
->
Œª¦©eRight
(
x
, 
y
);

38 
	gm_accumuÏ‹dT¿nsfÜm
->
Œª¦©e
(-
x
, -
y
);

41 ià(
	gaccumuÏ‹
 =ğ
FÏ‰’T¿nsfÜm
)

42 
æ©‹n
();

45 
	gm_Ï¡PÏÇrPošt
.
move
(
x
, 
y
);

46 ià(
	gm_m­Quad
)

47 
	gm_Ï¡PÏÇrQuad
.
move
(
x
, 
y
);

49 
	gm_accumuÏtšgT¿nsfÜm
 = 
accumuÏ‹
 =ğ
AccumuÏ‹T¿nsfÜm
;

53 
	gT¿nsfÜmS‹
::
­¶yT¿nsfÜm
(cÚ¡ 
AffšeT¿nsfÜm
& 
ŒªsfÜmFromCÚš”
, 
T¿nsfÜmAccumuÏtiÚ
 
accumuÏ‹
)

55 
­¶yT¿nsfÜm
(
ŒªsfÜmFromCÚš”
.
toT¿nsfÜm©iÚM©rix
(), 
accumuÏ‹
);

58 
	gT¿nsfÜmS‹
::
­¶yT¿nsfÜm
(cÚ¡ 
T¿nsfÜm©iÚM©rix
& 
ŒªsfÜmFromCÚš”
, 
T¿nsfÜmAccumuÏtiÚ
 
accumuÏ‹
)

61 ià(
	gm_accumuÏ‹dT¿nsfÜm
) {

62 ià(
	gm_dœeùiÚ
 =ğ
AµlyT¿nsfÜmDœeùiÚ
)

63 
m_accumuÏ‹dT¿nsfÜm
->
muÉly
(
ŒªsfÜmFromCÚš”
);

65 
	gm_accumuÏ‹dT¿nsfÜm
->
muÉLeá
(
ŒªsfÜmFromCÚš”
);

66 } ià(
	gaccumuÏ‹
 =ğ
AccumuÏ‹T¿nsfÜm
) {

68 
m_accumuÏ‹dT¿nsfÜm
.
£t
(
Ãw
 
T¿nsfÜm©iÚM©rix
(
ŒªsfÜmFromCÚš”
));

71 ià(
	gaccumuÏ‹
 =ğ
FÏ‰’T¿nsfÜm
) {

72 cÚ¡ 
T¿nsfÜm©iÚM©rix
* 
fš®T¿nsfÜm
 = 
m_accumuÏ‹dT¿nsfÜm
 ? m_accumuÏ‹dT¿nsfÜm.
g‘
(è: &
ŒªsfÜmFromCÚš”
;

73 
æ©‹nW™hT¿nsfÜm
(*
fš®T¿nsfÜm
);

75 
	gm_accumuÏtšgT¿nsfÜm
 = 
accumuÏ‹
 =ğ
AccumuÏ‹T¿nsfÜm
;

78 
	gT¿nsfÜmS‹
::
æ©‹n
()

80 ià(!
m_accumuÏ‹dT¿nsfÜm
) {

81 
m_accumuÏtšgT¿nsfÜm
 = 
çl£
;

85 
æ©‹nW™hT¿nsfÜm
(*
m_accumuÏ‹dT¿nsfÜm
);

88 
FlßtPošt
 
	gT¿nsfÜmS‹
::
m­³dPošt
() const

90 ià(!
m_accumuÏ‹dT¿nsfÜm
)

91  
m_Ï¡PÏÇrPošt
;

93 ià(
	gm_dœeùiÚ
 =ğ
AµlyT¿nsfÜmDœeùiÚ
)

94  
m_accumuÏ‹dT¿nsfÜm
->
m­Pošt
(
m_Ï¡PÏÇrPošt
);

96  
	gm_accumuÏ‹dT¿nsfÜm
->
šv”£
().
´ojeùPošt
(
m_Ï¡PÏÇrPošt
);

99 
FlßtQuad
 
	gT¿nsfÜmS‹
::
m­³dQuad
() const

101 ià(!
m_accumuÏ‹dT¿nsfÜm
)

102  
m_Ï¡PÏÇrQuad
;

104 ià(
	gm_dœeùiÚ
 =ğ
AµlyT¿nsfÜmDœeùiÚ
)

105  
m_accumuÏ‹dT¿nsfÜm
->
m­Quad
(
m_Ï¡PÏÇrQuad
);

107  
	gm_accumuÏ‹dT¿nsfÜm
->
šv”£
().
´ojeùQuad
(
m_Ï¡PÏÇrQuad
);

110 
	gT¿nsfÜmS‹
::
æ©‹nW™hT¿nsfÜm
(cÚ¡ 
T¿nsfÜm©iÚM©rix
& 
t
)

112 ià(
m_dœeùiÚ
 =ğ
AµlyT¿nsfÜmDœeùiÚ
) {

113 
m_Ï¡PÏÇrPošt
 = 
t
.
m­Pošt
(m_lastPlanarPoint);

114 ià(
	gm_m­Quad
)

115 
	gm_Ï¡PÏÇrQuad
 = 
t
.
m­Quad
(
m_Ï¡PÏÇrQuad
);

117 
T¿nsfÜm©iÚM©rix
 
	gšv”£T¿nsfÜm
 = 
t
.
šv”£
();

118 
	gm_Ï¡PÏÇrPošt
 = 
šv”£T¿nsfÜm
.
´ojeùPošt
(
m_Ï¡PÏÇrPošt
);

119 ià(
	gm_m­Quad
)

120 
	gm_Ï¡PÏÇrQuad
 = 
šv”£T¿nsfÜm
.
´ojeùQuad
(
m_Ï¡PÏÇrQuad
);

126 ià(
	gm_accumuÏ‹dT¿nsfÜm
)

127 
	gm_accumuÏ‹dT¿nsfÜm
->
makeId’t™y
();

128 
	gm_accumuÏtšgT¿nsfÜm
 = 
çl£
;

132 
	gH™Te¡šgT¿nsfÜmS‹
::
Œª¦©e
(
x
, 
y
, 
T¿nsfÜmAccumuÏtiÚ
 
accumuÏ‹
)

134 
	gm_accumuÏ‹dT¿nsfÜm
.
Œª¦©e
(
x
, 
y
);

135 ià(
	gaccumuÏ‹
 =ğ
FÏ‰’T¿nsfÜm
)

136 
æ©‹nW™hT¿nsfÜm
(
m_accumuÏ‹dT¿nsfÜm
);

138 
	gm_accumuÏtšgT¿nsfÜm
 = 
accumuÏ‹
 =ğ
AccumuÏ‹T¿nsfÜm
;

141 
	gH™Te¡šgT¿nsfÜmS‹
::
­¶yT¿nsfÜm
(cÚ¡ 
T¿nsfÜm©iÚM©rix
& 
ŒªsfÜmFromCÚš”
, 
T¿nsfÜmAccumuÏtiÚ
 
accumuÏ‹
)

143 
	gm_accumuÏ‹dT¿nsfÜm
.
muÉLeá
(
ŒªsfÜmFromCÚš”
);

144 ià(
	gaccumuÏ‹
 =ğ
FÏ‰’T¿nsfÜm
)

145 
æ©‹nW™hT¿nsfÜm
(
m_accumuÏ‹dT¿nsfÜm
);

147 
	gm_accumuÏtšgT¿nsfÜm
 = 
accumuÏ‹
 =ğ
AccumuÏ‹T¿nsfÜm
;

150 
	gH™Te¡šgT¿nsfÜmS‹
::
æ©‹n
()

152 
æ©‹nW™hT¿nsfÜm
(
m_accumuÏ‹dT¿nsfÜm
);

155 
	gH™Te¡šgT¿nsfÜmS‹
::
æ©‹nW™hT¿nsfÜm
(cÚ¡ 
T¿nsfÜm©iÚM©rix
& 
t
)

157 
T¿nsfÜm©iÚM©rix
 
šv”£T¿nsfÜm
 = 
t
.
šv”£
();

158 
	gm_Ï¡PÏÇrPošt
 = 
šv”£T¿nsfÜm
.
´ojeùPošt
(
m_Ï¡PÏÇrPošt
);

159 
	gm_Ï¡PÏÇrQuad
 = 
šv”£T¿nsfÜm
.
´ojeùQuad
(
m_Ï¡PÏÇrQuad
);

161 
	gm_accumuÏ‹dT¿nsfÜm
.
makeId’t™y
();

162 
	gm_accumuÏtšgT¿nsfÜm
 = 
çl£
;

165 
FlßtPošt
 
	gH™Te¡šgT¿nsfÜmS‹
::
m­³dPošt
() const

167  
m_accumuÏ‹dT¿nsfÜm
.
šv”£
().
´ojeùPošt
(
m_Ï¡PÏÇrPošt
);

170 
FlßtQuad
 
	gH™Te¡šgT¿nsfÜmS‹
::
m­³dQuad
() const

172  
m_accumuÏ‹dT¿nsfÜm
.
šv”£
().
´ojeùQuad
(
m_Ï¡PÏÇrQuad
);

	@TransformState.h

26 #iâdeà
T¿nsfÜmS‹_h


27 
	#T¿nsfÜmS‹_h


	)

29 
	~"AffšeT¿nsfÜm.h
"

30 
	~"FlßtPošt.h
"

31 
	~"FlßtQuad.h
"

32 
	~"IÁSize.h
"

33 
	~"T¿nsfÜm©iÚM©rix.h
"

34 
	~<wtf/NÚcİyabË.h
>

35 
	~<wtf/PassRefPŒ.h
>

36 
	~<wtf/OwnPŒ.h
>

37 
	~<wtf/RefCouÁed.h
>

39 
Çme¥aû
 
	gWebCÜe
 {

41 şas 
	cT¿nsfÜmS‹
 : 
public
 
NÚcİyabË
 {

42 
public
:

43 
	eT¿nsfÜmDœeùiÚ
 { 
AµlyT¿nsfÜmDœeùiÚ
, 
	gUÇµlyInv”£T¿nsfÜmDœeùiÚ
 };

44 
	eT¿nsfÜmAccumuÏtiÚ
 { 
	gFÏ‰’T¿nsfÜm
, 
	gAccumuÏ‹T¿nsfÜm
 };

47 
T¿nsfÜmS‹
(
T¿nsfÜmDœeùiÚ
 
m­pšgDœeùiÚ
, cÚ¡ 
FlßtPošt
& 
p
, cÚ¡ 
FlßtQuad
* 
quad
 = 0)

48 : 
m_Ï¡PÏÇrPošt
(
p
)

49 , 
m_accumuÏtšgT¿nsfÜm
(
çl£
)

50 , 
m_m­Quad
(
quad
 != 0)

51 , 
m_dœeùiÚ
(
m­pšgDœeùiÚ
)

53 ià(
	gquad
)

54 
	gm_Ï¡PÏÇrQuad
 = *
quad
;

57 
move
(cÚ¡ 
IÁSize
& 
s
, 
T¿nsfÜmAccumuÏtiÚ
 
accumuÏ‹
 = 
FÏ‰’T¿nsfÜm
)

59 
move
(
s
.
width
(), s.
height
(), 
accumuÏ‹
);

62 
move
(
x
, 
y
, 
T¿nsfÜmAccumuÏtiÚ
 = 
FÏ‰’T¿nsfÜm
);

63 
­¶yT¿nsfÜm
(cÚ¡ 
AffšeT¿nsfÜm
& 
ŒªsfÜmFromCÚš”
, 
T¿nsfÜmAccumuÏtiÚ
 = 
FÏ‰’T¿nsfÜm
);

64 
­¶yT¿nsfÜm
(cÚ¡ 
T¿nsfÜm©iÚM©rix
& 
ŒªsfÜmFromCÚš”
, 
T¿nsfÜmAccumuÏtiÚ
 = 
FÏ‰’T¿nsfÜm
);

65 
æ©‹n
();

68 
FlßtPošt
 
Ï¡PÏÇrPošt
(ècÚ¡ {  
	gm_Ï¡PÏÇrPošt
; }

69 
FlßtQuad
 
Ï¡PÏÇrQuad
(ècÚ¡ {  
	gm_Ï¡PÏÇrQuad
; }

72 
FlßtPošt
 
m­³dPošt
() const;

73 
FlßtQuad
 
m­³dQuad
() const;

75 
	g´iv©e
:

76 
æ©‹nW™hT¿nsfÜm
(cÚ¡ 
T¿nsfÜm©iÚM©rix
&);

78 
FlßtPošt
 
	gm_Ï¡PÏÇrPošt
;

79 
FlßtQuad
 
	gm_Ï¡PÏÇrQuad
;

82 
	gOwnPŒ
<
	gT¿nsfÜm©iÚM©rix
> 
	gm_accumuÏ‹dT¿nsfÜm
;

83 
boŞ
 
	gm_accumuÏtšgT¿nsfÜm
;

84 
boŞ
 
	gm_m­Quad
;

85 
T¿nsfÜmDœeùiÚ
 
	gm_dœeùiÚ
;

88 
şass
 
	gH™Te¡šgT¿nsfÜmS‹
 : 
public
 
RefCouÁed
<
H™Te¡šgT¿nsfÜmS‹
> {

89 
public
:

90 
PassRefPŒ
<
H™Te¡šgT¿nsfÜmS‹
> 
ü—‹
(cÚ¡ 
FlßtPošt
& 
p
, cÚ¡ 
FlßtQuad
& 
quad
)

92  
adİtRef
(
Ãw
 
H™Te¡šgT¿nsfÜmS‹
(
p
, 
quad
));

95 
	gPassRefPŒ
<
	gH™Te¡šgT¿nsfÜmS‹
> 
ü—‹
(cÚ¡ 
H™Te¡šgT¿nsfÜmS‹
& 
Ùh”
)

97  
adİtRef
(
Ãw
 
H™Te¡šgT¿nsfÜmS‹
(
Ùh”
));

100 
	eT¿nsfÜmAccumuÏtiÚ
 { 
	gFÏ‰’T¿nsfÜm
, 
	gAccumuÏ‹T¿nsfÜm
 };

101 
Œª¦©e
(
x
, 
y
, 
T¿nsfÜmAccumuÏtiÚ
);

102 
­¶yT¿nsfÜm
(cÚ¡ 
T¿nsfÜm©iÚM©rix
& 
ŒªsfÜmFromCÚš”
, 
T¿nsfÜmAccumuÏtiÚ
);

104 
FlßtPošt
 
m­³dPošt
() const;

105 
FlßtQuad
 
m­³dQuad
() const;

106 
æ©‹n
();

108 
FlßtPošt
 
	gm_Ï¡PÏÇrPošt
;

109 
FlßtQuad
 
	gm_Ï¡PÏÇrQuad
;

110 
T¿nsfÜm©iÚM©rix
 
	gm_accumuÏ‹dT¿nsfÜm
;

111 
boŞ
 
	gm_accumuÏtšgT¿nsfÜm
;

113 
	g´iv©e
:

114 
H™Te¡šgT¿nsfÜmS‹
(cÚ¡ 
FlßtPošt
& 
p
, cÚ¡ 
FlßtQuad
& 
quad
)

115 : 
m_Ï¡PÏÇrPošt
(
p
)

116 , 
m_Ï¡PÏÇrQuad
(
quad
)

117 , 
m_accumuÏtšgT¿nsfÜm
(
çl£
)

121 
H™Te¡šgT¿nsfÜmS‹
(cÚ¡ H™Te¡šgT¿nsfÜmS‹& 
Ùh”
)

122 : 
RefCouÁed
<
H™Te¡šgT¿nsfÜmS‹
>()

123 , 
m_Ï¡PÏÇrPošt
(
Ùh”
.m_lastPlanarPoint)

124 , 
m_Ï¡PÏÇrQuad
(
Ùh”
.m_lastPlanarQuad)

125 , 
m_accumuÏ‹dT¿nsfÜm
(
Ùh”
.m_accumulatedTransform)

126 , 
m_accumuÏtšgT¿nsfÜm
(
Ùh”
.m_accumulatingTransform)

130 
æ©‹nW™hT¿nsfÜm
(cÚ¡ 
T¿nsfÜm©iÚM©rix
&);

	@break_lines.cpp

26 
	~"cÚfig.h
"

27 
	~"b»ak_lšes.h
"

29 
	~"Ch¬aù”Names.h
"

30 
	~"TextB»akI‹¿tÜ.h
"

32 #ià
PLATFORM
(
MAC
)

33 
	~<CÜeS”viûs/CÜeS”viûs.h
>

36 
Çme¥aû
 
	gWebCÜe
 {

38 
šlše
 
boŞ
 
isB»akabËS·û
(
UCh¬
 
ch
, boŞ 
Œ—tNoB»akS·ûAsB»ak
)

40 
	gch
) {

44  
Œue
;

45 
	gnoB»akS·û
:

46  
Œ—tNoB»akS·ûAsB»ak
;

48  
çl£
;

54 cÚ¡ 
	gš‹º‘Ex¶Ü”LšeB»aksAá”Que¡iÚM¬kTabË
[0x80] = {

65 cÚ¡ 
size_t
 
	gš‹º‘Ex¶Ü”LšeB»aksAá”Que¡iÚM¬kTabËSize
 = (
š‹º‘Ex¶Ü”LšeB»aksAá”Que¡iÚM¬kTabË
) / (*internetExplorerLineBreaksAfterQuestionMarkTable);

67 
šlše
 
boŞ
 
shouldB»akAá”
(
UCh¬
 
ch
, UCh¬ 
ÃxtCh
)

69 
	gch
) {

73  
ÃxtCh
 < 
š‹º‘Ex¶Ü”LšeB»aksAá”Que¡iÚM¬kTabËSize
 && 
š‹º‘Ex¶Ü”LšeB»aksAá”Que¡iÚM¬kTabË
[nextCh];

76 
soáHyph’
:

80 
ideog¿phicComma
:

81 
ideog¿phicFuÎStİ
:

82  
Œue
;

84  
çl£
;

88 
šlše
 
boŞ
 
ÃedsLšeB»akI‹¿tÜ
(
UCh¬
 
ch
)

90  
	gch
 > 0x7F && ch !ğ
noB»akS·û
;

93 #ià
PLATFORM
(
MAC
è&& 
defšed
(
BUILDING_ON_TIGER
)

94 
šlše
 
TextB»akLoÿtÜRef
 
lšeB»akLoÿtÜ
()

96 
TextB»akLoÿtÜRef
 
	gloÿtÜ
 = 0;

97 
UCC»©eTextB»akLoÿtÜ
(0, 0, 
kUCTextB»akLšeMask
, &
loÿtÜ
);

98  
	gloÿtÜ
;

102 
ÃxtB»akabËPos™iÚ
(cÚ¡ 
UCh¬
* 
¡r
, 
pos
, 
Ën
, 
boŞ
 
Œ—tNoB»akS·ûAsB»ak
)

104 #ià!
PLATFORM
(
MAC
è|| !
defšed
(
BUILDING_ON_TIGER
)

105 
TextB»akI‹¿tÜ
* 
	gb»akI‹¿tÜ
 = 0;

107 
	gÃxtB»ak
 = -1;

109 
UCh¬
 
	gÏ¡Ch
 = 
pos
 > 0 ? 
¡r
[pos - 1] : 0;

110 
	gi
 = 
pos
; i < 
	gËn
; i++) {

111 
UCh¬
 
	gch
 = 
¡r
[
i
];

113 ià(
isB»akabËS·û
(
ch
, 
Œ—tNoB»akS·ûAsB»ak
è|| 
shouldB»akAá”
(
Ï¡Ch
, ch))

114  
	gi
;

116 ià(
ÃedsLšeB»akI‹¿tÜ
(
ch
è||‚“dsLšeB»akI‹¿tÜ(
Ï¡Ch
)) {

117 ià(
	gÃxtB»ak
 < 
	gi
 && i) {

118 #ià!
PLATFORM
(
MAC
è|| !
defšed
(
BUILDING_ON_TIGER
)

119 ià(!
	gb»akI‹¿tÜ
)

120 
	gb»akI‹¿tÜ
 = 
lšeB»akI‹¿tÜ
(
¡r
, 
Ën
);

121 ià(
	gb»akI‹¿tÜ
)

122 
	gÃxtB»ak
 = 
‹xtB»akFŞlowšg
(
b»akI‹¿tÜ
, 
i
 - 1);

124 
TextB»akLoÿtÜRef
 
	gb»akLoÿtÜ
 = 
lšeB»akLoÿtÜ
();

125 ià(
	gb»akLoÿtÜ
) {

126 
UniCh¬A¼ayOff£t
 
	gÃxtUCB»ak
;

127 ià(
UCFšdTextB»ak
(
b»akLoÿtÜ
, 
kUCTextB»akLšeMask
, 0, 
¡r
, 
Ën
, 
i
, &
ÃxtUCB»ak
) == 0)

128 
ÃxtB»ak
 = 
ÃxtUCB»ak
;

132 ià(
	gi
 =ğ
ÃxtB»ak
 && !
isB»akabËS·û
(
Ï¡Ch
, 
Œ—tNoB»akS·ûAsB»ak
))

133  
	gi
;

136 
	gÏ¡Ch
 = 
ch
;

139  
	gËn
;

	@break_lines.h

21 #iâdeà
b»ak_lšes_h


22 
	#b»ak_lšes_h


	)

24 
	~<wtf/unicode/Unicode.h
>

26 
Çme¥aû
 
	gWebCÜe
 {

28 
ÃxtB»akabËPos™iÚ
(cÚ¡ 
UCh¬
*, 
pos
, 
Ën
, 
boŞ
 
b»akNBSP
 = 
çl£
);

30 
šlše
 
boŞ
 
isB»akabË
(cÚ¡ 
UCh¬
* 
¡r
, 
pos
, 
Ën
, & 
ÃxtB»akabË
, boŞ 
b»akNBSP
 = 
çl£
)

32 ià(
pos
 > 
ÃxtB»akabË
)

33 
ÃxtB»akabË
 = 
ÃxtB»akabËPos™iÚ
(
¡r
, 
pos
, 
Ën
, 
b»akNBSP
);

34  
	gpos
 =ğ
ÃxtB»akabË
;

	@/usr/include/math.h

25 #iâdef 
_MATH_H


26 
	#_MATH_H
 1

	)

28 
	~<ã©u»s.h
>

30 
	g__BEGIN_DECLS


34 
	~<b™s/huge_v®.h
>

35 #ifdeà
__USE_ISOC99


36 
	~<b™s/huge_v®f.h
>

37 
	~<b™s/huge_v®l.h
>

40 
	~<b™s/šf.h
>

43 
	~<b™s/Çn.h
>

47 
	~<b™s/m©hdef.h
>

54 
	#__MATHCALL
(
funùiÚ
,
suffix
, 
¬gs
) \

55 
	`__MATHDECL
 (
_MdoubË_
,
funùiÚ
,
suffix
, 
¬gs
)

	)

56 
	#__MATHDECL
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

57 
	`__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
); \

58 
	`__MATHDECL_1
(
ty³
, 
	`__CONCAT
(
__
,
funùiÚ
),
suffix
, 
¬gs
)

	)

59 
	#__MATHCALLX
(
funùiÚ
,
suffix
, 
¬gs
, 
©Œib
) \

60 
	`__MATHDECLX
 (
_MdoubË_
,
funùiÚ
,
suffix
, 
¬gs
, 
©Œib
)

	)

61 
	#__MATHDECLX
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
, 
©Œib
) \

62 
	`__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
è
	`__©Œibu‹__
 (
©Œib
); \

63 
	`__MATHDECL_1
(
ty³
, 
	`__CONCAT
(
__
,
funùiÚ
),
suffix
, 
¬gs
è
	`__©Œibu‹__
 (
©Œib
)

	)

64 
	#__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

65 
ty³
 
	`__MATH_PRECNAME
(
funùiÚ
,
suffix
è
¬gs
 
__THROW


	)

67 
	#_MdoubË_
 

	)

68 
	#__MATH_PRECNAME
(
Çme
,
r
è
	`__CONCAT
Òame,r)

	)

69 
	#_MdoubË_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_STD


	)

70 
	#_MdoubË_END_NAMESPACE
 
__END_NAMESPACE_STD


	)

71 
	~<b™s/m©hÿÎs.h
>

72 #undeà
_MdoubË_


73 #undeà
_MdoubË_BEGIN_NAMESPACE


74 #undeà
_MdoubË_END_NAMESPACE


75 #undeà
__MATH_PRECNAME


77 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_ISOC99


83 #iâdeà
_Mæßt_


84 
	#_Mæßt_
 

	)

86 
	#_MdoubË_
 
_Mæßt_


	)

87 #ifdeà
__STDC__


88 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f
##
	)
r

90 
	#__MATH_PRECNAME
(
Çme
,
r
èÇm
f
 
	)
r

92 
	#_MdoubË_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_C99


	)

93 
	#_MdoubË_END_NAMESPACE
 
__END_NAMESPACE_C99


	)

94 
	~<b™s/m©hÿÎs.h
>

95 #undeà
_MdoubË_


96 #undeà
_MdoubË_BEGIN_NAMESPACE


97 #undeà
_MdoubË_END_NAMESPACE


98 #undeà
__MATH_PRECNAME


100 #ià(
__STDC__
 - 0 || 
__GNUC__
 - 0) \

101 && (!
defšed
 
__NO_LONG_DOUBLE_MATH
 || defšed 
__LDBL_COMPAT
)

102 #ifdeà
__LDBL_COMPAT


104 #ifdeà
__USE_ISOC99


105 
	$__Ædbl_Ãx‰ow¬df
 (
__x
, 
__y
)

106 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

107 #ifdeà
__REDIRECT_NTH


108 
	`__REDIRECT_NTH
 (
Ãx‰ow¬df
, (
__x
, 
__y
),

109 
__Ædbl_Ãx‰ow¬df
)

110 
	`__©Œibu‹__
 ((
__cÚ¡__
));

111 
	`__REDIRECT_NTH
 (
Ãx‰ow¬d
, (
__x
, 
__y
),

112 
Ãxá”
è
	`__©Œibu‹__
 ((
__cÚ¡__
));

113 
	`__REDIRECT_NTH
 (
Ãx‰ow¬dl
,

114 (
__x
, 
__y
),

115 
Ãxá”
è
	`__©Œibu‹__
 ((
__cÚ¡__
));

122 #undeà
__MATHDECL_1


123 
	#__MATHDECL_2
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
, 
®Ÿs
) \

124 
ty³
 
	`__REDIRECT_NTH
(
	`__MATH_PRECNAME
(
funùiÚ
,
suffix
), \

125 
¬gs
, 
®Ÿs
)

	)

126 
	#__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

127 
	`__MATHDECL_2
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
, 
	`__CONCAT
(funùiÚ,suffix))

	)

130 #iâdeà
_MlÚg_doubË_


131 
	#_MlÚg_doubË_
 

	)

133 
	#_MdoubË_
 
_MlÚg_doubË_


	)

134 #ifdeà
__STDC__


135 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
l
##
	)
r

137 
	#__MATH_PRECNAME
(
Çme
,
r
èÇm
l
 
	)
r

139 
	#_MdoubË_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_C99


	)

140 
	#_MdoubË_END_NAMESPACE
 
__END_NAMESPACE_C99


	)

141 
	~<b™s/m©hÿÎs.h
>

142 #undeà
_MdoubË_


143 #undeà
_MdoubË_BEGIN_NAMESPACE


144 #undeà
_MdoubË_END_NAMESPACE


145 #undeà
__MATH_PRECNAME


150 #undeà
__MATHDECL_1


151 #undeà
__MATHDECL


152 #undeà
__MATHCALL


155 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


157 
signgam
;

162 #ifdeà
__USE_ISOC99


200 
FP_NAN
,

201 
	#FP_NAN
 
FP_NAN


	)

202 
FP_INFINITE
,

203 
	#FP_INFINITE
 
FP_INFINITE


	)

204 
FP_ZERO
,

205 
	#FP_ZERO
 
FP_ZERO


	)

206 
FP_SUBNORMAL
,

207 
	#FP_SUBNORMAL
 
FP_SUBNORMAL


	)

208 
FP_NORMAL


209 
	#FP_NORMAL
 
FP_NORMAL


	)

213 #ifdeà
__NO_LONG_DOUBLE_MATH


214 
	#åşassify
(
x
) \

215 ( (
x
è=ğ (è? 
	`__åşassifyf
 (xè: 
	`__åşassify
 (x))

	)

217 
	#åşassify
(
x
) \

218 ( (
x
) ==  () \

219 ? 
	`__åşassifyf
 (
x
) \

220 :  (
x
) ==  () \

221 ? 
	`__åşassify
 (
x
è: 
	`__åşassifyl
 (x))

	)

225 #ifdeà
__NO_LONG_DOUBLE_MATH


226 
	#signb™
(
x
) \

227 ( (
x
è=ğ (è? 
	`__signb™f
 (xè: 
	`__signb™
 (x))

	)

229 
	#signb™
(
x
) \

230 ( (
x
) ==  () \

231 ? 
	`__signb™f
 (
x
) \

232 :  (
x
) ==  () \

233 ? 
	`__signb™
 (
x
è: 
	`__signb™l
 (x))

	)

237 #ifdeà
__NO_LONG_DOUBLE_MATH


238 
	#isfš™e
(
x
) \

239 ( (
x
è=ğ (è? 
	`__fš™ef
 (xè: 
	`__fš™e
 (x))

	)

241 
	#isfš™e
(
x
) \

242 ( (
x
) ==  () \

243 ? 
	`__fš™ef
 (
x
) \

244 :  (
x
) ==  () \

245 ? 
	`__fš™e
 (
x
è: 
	`__fš™–
 (x))

	)

249 
	#i¢Üm®
(
x
è(
	`åşassify
 (xè=ğ
FP_NORMAL
)

	)

253 #ifdeà
__NO_LONG_DOUBLE_MATH


254 
	#i¢ª
(
x
) \

255 ( (
x
è=ğ (è? 
	`__i¢ªf
 (xè: 
	`__i¢ª
 (x))

	)

257 
	#i¢ª
(
x
) \

258 ( (
x
) ==  () \

259 ? 
	`__i¢ªf
 (
x
) \

260 :  (
x
) ==  () \

261 ? 
	`__i¢ª
 (
x
è: 
	`__i¢ªl
 (x))

	)

265 #ifdeà
__NO_LONG_DOUBLE_MATH


266 
	#isšf
(
x
) \

267 ( (
x
è=ğ (è? 
	`__isšff
 (xè: 
	`__isšf
 (x))

	)

269 
	#isšf
(
x
) \

270 ( (
x
) ==  () \

271 ? 
	`__isšff
 (
x
) \

272 :  (
x
) ==  () \

273 ? 
	`__isšf
 (
x
è: 
	`__isšæ
 (x))

	)

277 
	#MATH_ERRNO
 1

	)

278 
	#MATH_ERREXCEPT
 2

	)

282 #ifdef 
__USE_MISC


286 
_IEEE_
 = -1,

287 
_SVID_
,

288 
_XOPEN_
,

289 
_POSIX_
,

290 
_ISOC_


291 } 
	t_LIB_VERSION_TYPE
;

296 
_LIB_VERSION_TYPE
 
_LIB_VERSION
;

300 #ifdeà
__USE_SVID


306 #ifdeà
__ılu¥lus


307 
__exû±iÚ


309 
exû±iÚ


312 
ty³
;

313 *
Çme
;

314 
¬g1
;

315 
¬g2
;

316 
»tv®
;

317 
	}
};

319 #ifdeà
__ılu¥lus


320 
	$m©h”r
 (
__exû±iÚ
 *
__exc
è
	`throw
 ();

322 
	`m©h”r
 (
exû±iÚ
 *
__exc
);

325 
	#X_TLOSS
 1.41484755040568800000e+16

	)

328 
	#DOMAIN
 1

	)

329 
	#SING
 2

	)

330 
	#OVERFLOW
 3

	)

331 
	#UNDERFLOW
 4

	)

332 
	#TLOSS
 5

	)

333 
	#PLOSS
 6

	)

336 
	#HUGE
 3.40282347e+38F

	)

340 #ifdeà
__USE_XOPEN


342 
	#MAXFLOAT
 3.40282347e+38F

	)

349 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN


350 
	#M_E
 2.7182818284590452354

	)

351 
	#M_LOG2E
 1.4426950408889634074

	)

352 
	#M_LOG10E
 0.43429448190325182765

	)

353 
	#M_LN2
 0.69314718055994530942

	)

354 
	#M_LN10
 2.30258509299404568402

	)

355 
	#M_PI
 3.14159265358979323846

	)

356 
	#M_PI_2
 1.57079632679489661923

	)

357 
	#M_PI_4
 0.78539816339744830962

	)

358 
	#M_1_PI
 0.31830988618379067154

	)

359 
	#M_2_PI
 0.63661977236758134308

	)

360 
	#M_2_SQRTPI
 1.12837916709551257390

	)

361 
	#M_SQRT2
 1.41421356237309504880

	)

362 
	#M_SQRT1_2
 0.70710678118654752440

	)

368 #ifdeà
__USE_GNU


369 
	#M_El
 2.7182818284590452353602874713526625L

	)

370 
	#M_LOG2El
 1.4426950408889634073599246810018921L

	)

371 
	#M_LOG10El
 0.4342944819032518276511289189166051L

	)

372 
	#M_LN2l
 0.6931471805599453094172321214581766L

	)

373 
	#M_LN10l
 2.3025850929940456840179914546843642L

	)

374 
	#M_PIl
 3.1415926535897932384626433832795029L

	)

375 
	#M_PI_2l
 1.5707963267948966192313216916397514L

	)

376 
	#M_PI_4l
 0.7853981633974483096156608458198757L

	)

377 
	#M_1_PIl
 0.3183098861837906715377675267450287L

	)

378 
	#M_2_PIl
 0.6366197723675813430755350534900574L

	)

379 
	#M_2_SQRTPIl
 1.1283791670955125738961589031215452L

	)

380 
	#M_SQRT2l
 1.4142135623730950488016887242096981L

	)

381 
	#M_SQRT1_2l
 0.7071067811865475244008443621048490L

	)

388 #ià
defšed
 
__STRICT_ANSI__
 && !defšed 
__NO_MATH_INLINES


389 
	#__NO_MATH_INLINES
 1

	)

392 #ià
defšed
 
__USE_ISOC99
 && 
	`__GNUC_PREREQ
(2,97)

399 
	#isg»©”
(
x
, 
y
è
	`__butš_isg»©”
(x, y)

	)

400 
	#isg»©”equ®
(
x
, 
y
è
	`__butš_isg»©”equ®
(x, y)

	)

401 
	#i¦ess
(
x
, 
y
è
	`__butš_i¦ess
(x, y)

	)

402 
	#i¦es£qu®
(
x
, 
y
è
	`__butš_i¦es£qu®
(x, y)

	)

403 
	#i¦essg»©”
(
x
, 
y
è
	`__butš_i¦essg»©”
(x, y)

	)

404 
	#isunÜd”ed
(
u
, 
v
è
	`__butš_isunÜd”ed
(u, v)

	)

408 #ifdeà
__USE_EXTERN_INLINES


409 
	~<b™s/m©hšlše.h
>

412 #ifdeà
__USE_ISOC99


416 #iâdeà
isg»©”


417 
	#isg»©”
(
x
, 
y
) \

418 (
__ex‹nsiÚ__
 \

419 ({ 
	`__ty³of__
(
x
è
__x
 = (x); __ty³of__(
y
è
__y
 = (y); \

420 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x > __y; 
	}
}))

	)

424 #iâdeà
isg»©”equ®


425 
	#isg»©”equ®
(
x
, 
y
) \

426 (
__ex‹nsiÚ__
 \

427 ({ 
	`__ty³of__
(
x
è
__x
 = (x); __ty³of__(
y
è
__y
 = (y); \

428 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x >ğ__y; }))

	)

432 #iâdeà
i¦ess


433 
	#i¦ess
(
x
, 
y
) \

434 (
__ex‹nsiÚ__
 \

435 ({ 
	`__ty³of__
(
x
è
__x
 = (x); __ty³of__(
y
è
__y
 = (y); \

436 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x < __y; }))

	)

440 #iâdeà
i¦es£qu®


441 
	#i¦es£qu®
(
x
, 
y
) \

442 (
__ex‹nsiÚ__
 \

443 ({ 
	`__ty³of__
(
x
è
__x
 = (x); __ty³of__(
y
è
__y
 = (y); \

444 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x <ğ__y; }))

	)

448 #iâdeà
i¦essg»©”


449 
	#i¦essg»©”
(
x
, 
y
) \

450 (
__ex‹nsiÚ__
 \

451 ({ 
	`__ty³of__
(
x
è
__x
 = (x); __ty³of__(
y
è
__y
 = (y); \

452 !
	`isunÜd”ed
 (
__x
, 
__y
è&& (__x < __y || __y < __x); }))

	)

456 #iâdeà
isunÜd”ed


457 
	#isunÜd”ed
(
u
, 
v
) \

458 (
__ex‹nsiÚ__
 \

459 ({ 
	`__ty³of__
(
u
è
__u
 = (u); __ty³of__(
v
è
__v
 = (v); \

460 
	`åşassify
 (
__u
è=ğ
FP_NAN
 || fpşassify (
__v
è=ğFP_NAN; }))

	)

465 
	g__END_DECLS


	@/usr/include/stdio.h

24 #iâdeà
_STDIO_H


26 #ià!
defšed
 
__Ãed_FILE
 && !defšed 
__Ãed___FILE


27 
	#_STDIO_H
 1

	)

28 
	~<ã©u»s.h
>

30 
	g__BEGIN_DECLS


32 
	#__Ãed_size_t


	)

33 
	#__Ãed_NULL


	)

34 
	~<¡ddef.h
>

36 
	~<b™s/ty³s.h
>

37 
	#__Ãed_FILE


	)

38 
	#__Ãed___FILE


	)

42 #ià!
defšed
 
__FILE_defšed
 && defšed 
__Ãed_FILE


45 
	g_IO_FILE
;

47 
__BEGIN_NAMESPACE_STD


49 
_IO_FILE
 
	tFILE
;

50 
	g__END_NAMESPACE_STD


51 #ià
defšed
 
__USE_LARGEFILE64
 || defšed 
__USE_SVID
 || defšed 
__USE_POSIX
 \

52 || 
defšed
 
	g__USE_BSD
 || defšed 
	g__USE_ISOC99
 || defšed 
	g__USE_XOPEN
 \

53 || 
defšed
 
__USE_POSIX2


54 
	$__USING_NAMESPACE_STD
(
FILE
)

57 
	#__FILE_defšed
 1

	)

59 #undeà
__Ãed_FILE


62 #ià!
defšed
 
____FILE_defšed
 && defšed 
__Ãed___FILE


65 
_IO_FILE
 
	t__FILE
;

67 
	#____FILE_defšed
 1

	)

69 #undeà
__Ãed___FILE


72 #ifdef 
_STDIO_H


73 
	#_STDIO_USES_IOSTREAM


	)

75 
	~<libio.h
>

77 #ifdeà
__USE_XOPEN


78 #ifdeà
__GNUC__


79 #iâdeà
_VA_LIST_DEFINED


80 
_G_va_li¡
 
	tva_li¡
;

81 
	#_VA_LIST_DEFINED


	)

84 
	~<¡d¬g.h
>

89 
__BEGIN_NAMESPACE_STD


90 #iâdeà
__USE_FILE_OFFSET64


91 
_G_åos_t
 
	tåos_t
;

93 
_G_åos64_t
 
	tåos_t
;

95 
__END_NAMESPACE_STD


96 #ifdeà
__USE_LARGEFILE64


97 
_G_åos64_t
 
	tåos64_t
;

101 
	#_IOFBF
 0

	)

102 
	#_IOLBF
 1

	)

103 
	#_IONBF
 2

	)

107 #iâdeà
BUFSIZ


108 
	#BUFSIZ
 
_IO_BUFSIZ


	)

114 #iâdeà
EOF


115 
	#EOF
 (-1)

	)

121 
	#SEEK_SET
 0

	)

122 
	#SEEK_CUR
 1

	)

123 
	#SEEK_END
 2

	)

126 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


128 
	#P_tmpdœ
 "/tmp"

	)

141 
	~<b™s/¡dio_lim.h
>

145 
_IO_FILE
 *
¡dš
;

146 
_IO_FILE
 *
¡dout
;

147 
_IO_FILE
 *
¡d”r
;

149 
	#¡dš
 
¡dš


	)

150 
	#¡dout
 
¡dout


	)

151 
	#¡d”r
 
¡d”r


	)

153 
__BEGIN_NAMESPACE_STD


155 
	$»move
 (
__cÚ¡
 *
__f’ame
è
__THROW
;

157 
	$»Çme
 (
__cÚ¡
 *
__Şd
, __cÚ¡ *
__Ãw
è
__THROW
;

158 
__END_NAMESPACE_STD


160 #ifdeà
__USE_ATFILE


162 
	$»Çm—t
 (
__Şdfd
, 
__cÚ¡
 *
__Şd
, 
__Ãwfd
,

163 
__cÚ¡
 *
__Ãw
è
__THROW
;

166 
__BEGIN_NAMESPACE_STD


171 #iâdeà
__USE_FILE_OFFSET64


172 
FILE
 *
	$tmpfe
 (è
__wur
;

174 #ifdeà
__REDIRECT


175 
FILE
 *
	`__REDIRECT
 (
tmpfe
, (), 
tmpfe64
è
__wur
;

177 
	#tmpfe
 
tmpfe64


	)

181 #ifdeà
__USE_LARGEFILE64


182 
FILE
 *
	$tmpfe64
 (è
__wur
;

186 *
	$tm²am
 (*
__s
è
__THROW
 
__wur
;

187 
__END_NAMESPACE_STD


189 #ifdeà
__USE_MISC


192 *
	$tm²am_r
 (*
__s
è
__THROW
 
__wur
;

196 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


204 *
	$‹m²am
 (
__cÚ¡
 *
__dœ
, __cÚ¡ *
__pfx
)

205 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

209 
__BEGIN_NAMESPACE_STD


214 
	`fşo£
 (
FILE
 *
__¡»am
);

219 
	`fæush
 (
FILE
 *
__¡»am
);

220 
__END_NAMESPACE_STD


222 #ifdeà
__USE_MISC


229 
	`fæush_uÆocked
 (
FILE
 *
__¡»am
);

232 #ifdeà
__USE_GNU


239 
	`fşo£®l
 ();

243 
__BEGIN_NAMESPACE_STD


244 #iâdeà
__USE_FILE_OFFSET64


249 
FILE
 *
	$fİ’
 (
__cÚ¡
 *
__»¡riù
 
__f’ame
,

250 
__cÚ¡
 *
__»¡riù
 
__modes
è
__wur
;

255 
FILE
 *
	$äeİ’
 (
__cÚ¡
 *
__»¡riù
 
__f’ame
,

256 
__cÚ¡
 *
__»¡riù
 
__modes
,

257 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

259 #ifdeà
__REDIRECT


260 
FILE
 *
	`__REDIRECT
 (
fİ’
, (
__cÚ¡
 *
__»¡riù
 
__f’ame
,

261 
__cÚ¡
 *
__»¡riù
 
__modes
), 
fİ’64
)

262 
__wur
;

263 
FILE
 *
	`__REDIRECT
 (
äeİ’
, (
__cÚ¡
 *
__»¡riù
 
__f’ame
,

264 
__cÚ¡
 *
__»¡riù
 
__modes
,

265 
FILE
 *
__»¡riù
 
__¡»am
), 
äeİ’64
)

266 
__wur
;

268 
	#fİ’
 
fİ’64


	)

269 
	#äeİ’
 
äeİ’64


	)

272 
__END_NAMESPACE_STD


273 #ifdeà
__USE_LARGEFILE64


274 
FILE
 *
	$fİ’64
 (
__cÚ¡
 *
__»¡riù
 
__f’ame
,

275 
__cÚ¡
 *
__»¡riù
 
__modes
è
__wur
;

276 
FILE
 *
	$äeİ’64
 (
__cÚ¡
 *
__»¡riù
 
__f’ame
,

277 
__cÚ¡
 *
__»¡riù
 
__modes
,

278 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

281 #ifdef 
__USE_POSIX


283 
FILE
 *
	$fdİ’
 (
__fd
, 
__cÚ¡
 *
__modes
è
__THROW
 
__wur
;

286 #ifdef 
__USE_GNU


289 
FILE
 *
	$fİ’cook›
 (*
__»¡riù
 
__magic_cook›
,

290 
__cÚ¡
 *
__»¡riù
 
__modes
,

291 
_IO_cook›_io_funùiÚs_t
 
__io_funcs
è
__THROW
 
__wur
;

294 #ifdeà
__USE_XOPEN2K8


296 
FILE
 *
	$fmemİ’
 (*
__s
, 
size_t
 
__Ën
, 
__cÚ¡
 *
__modes
)

297 
__THROW
 
__wur
;

302 
FILE
 *
	$İ’_mem¡»am
 (**
__buæoc
, 
size_t
 *
__siz–oc
è
__THROW
 
__wur
;

306 
__BEGIN_NAMESPACE_STD


309 
	$£tbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
è
__THROW
;

313 
	$£tvbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

314 
__modes
, 
size_t
 
__n
è
__THROW
;

315 
__END_NAMESPACE_STD


317 #ifdef 
__USE_BSD


320 
	$£tbufãr
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

321 
size_t
 
__size
è
__THROW
;

324 
	$£šebuf
 (
FILE
 *
__¡»am
è
__THROW
;

328 
__BEGIN_NAMESPACE_STD


333 
	`årštf
 (
FILE
 *
__»¡riù
 
__¡»am
,

334 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...);

339 
	`´štf
 (
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...);

341 
	$¥rštf
 (*
__»¡riù
 
__s
,

342 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

348 
	`vårštf
 (
FILE
 *
__»¡riù
 
__s
, 
__cÚ¡
 *__»¡riù 
__fÜm©
,

349 
_G_va_li¡
 
__¬g
);

354 
	`v´štf
 (
__cÚ¡
 *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
);

356 
	$v¥rštf
 (*
__»¡riù
 
__s
, 
__cÚ¡
 *__»¡riù 
__fÜm©
,

357 
_G_va_li¡
 
__¬g
è
__THROW
;

358 
__END_NAMESPACE_STD


360 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_ISOC99
 || defšed 
__USE_UNIX98


361 
__BEGIN_NAMESPACE_C99


363 
	$¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

364 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...)

365 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 4)));

367 
	$v¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

368 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

369 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 0)));

370 
__END_NAMESPACE_C99


373 #ifdeà
__USE_GNU


376 
	$va¥rštf
 (**
__»¡riù
 
__±r
, 
__cÚ¡
 *__»¡riù 
__f
,

377 
_G_va_li¡
 
__¬g
)

378 
__THROW
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 0))è
__wur
;

379 
	$__a¥rštf
 (**
__»¡riù
 
__±r
,

380 
__cÚ¡
 *
__»¡riù
 
__fmt
, ...)

381 
__THROW
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

382 
	$a¥rštf
 (**
__»¡riù
 
__±r
,

383 
__cÚ¡
 *
__»¡riù
 
__fmt
, ...)

384 
__THROW
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

387 #ifdeà
__USE_XOPEN2K8


394 
	$vd´štf
 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__fmt
,

395 
_G_va_li¡
 
__¬g
)

396 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

397 
	$d´štf
 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__fmt
, ...)

398 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

402 
__BEGIN_NAMESPACE_STD


407 
	$fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

408 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...è
__wur
;

413 
	$sÿnf
 (
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...è
__wur
;

415 
	$ssÿnf
 (
__cÚ¡
 *
__»¡riù
 
__s
,

416 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

418 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

419 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

420 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

421 #ifdeà
__REDIRECT


425 
	`__REDIRECT
 (
fsÿnf
, (
FILE
 *
__»¡riù
 
__¡»am
,

426 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...),

427 
__isoc99_fsÿnf
è
__wur
;

428 
	`__REDIRECT
 (
sÿnf
, (
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...),

429 
__isoc99_sÿnf
è
__wur
;

430 
	`__REDIRECT
 (
ssÿnf
, (
__cÚ¡
 *
__»¡riù
 
__s
,

431 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...),

432 
__isoc99_ssÿnf
è
__THROW
;

434 
	$__isoc99_fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

435 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...è
__wur
;

436 
	$__isoc99_sÿnf
 (
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...è
__wur
;

437 
	$__isoc99_ssÿnf
 (
__cÚ¡
 *
__»¡riù
 
__s
,

438 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

439 
	#fsÿnf
 
__isoc99_fsÿnf


	)

440 
	#sÿnf
 
__isoc99_sÿnf


	)

441 
	#ssÿnf
 
__isoc99_ssÿnf


	)

445 
__END_NAMESPACE_STD


447 #ifdef 
__USE_ISOC99


448 
__BEGIN_NAMESPACE_C99


453 
	$vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
, 
__cÚ¡
 *__»¡riù 
__fÜm©
,

454 
_G_va_li¡
 
__¬g
)

455 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

461 
	$vsÿnf
 (
__cÚ¡
 *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

462 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

465 
	$vssÿnf
 (
__cÚ¡
 *
__»¡riù
 
__s
,

466 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

467 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

469 #ià!
defšed
 
__USE_GNU
 \

470 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

471 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

472 #ifdeà
__REDIRECT


476 
	`__REDIRECT
 (
vfsÿnf
,

477 (
FILE
 *
__»¡riù
 
__s
,

478 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
),

479 
__isoc99_vfsÿnf
)

480 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

481 
	`__REDIRECT
 (
vsÿnf
, (
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

482 
_G_va_li¡
 
__¬g
), 
__isoc99_vsÿnf
)

483 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

484 
	`__REDIRECT
 (
vssÿnf
,

485 (
__cÚ¡
 *
__»¡riù
 
__s
,

486 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
),

487 
__isoc99_vssÿnf
)

488 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

490 
	$__isoc99_vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
,

491 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

492 
_G_va_li¡
 
__¬g
è
__wur
;

493 
	$__isoc99_vsÿnf
 (
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

494 
_G_va_li¡
 
__¬g
è
__wur
;

495 
	$__isoc99_vssÿnf
 (
__cÚ¡
 *
__»¡riù
 
__s
,

496 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

497 
_G_va_li¡
 
__¬g
è
__THROW
;

498 
	#vfsÿnf
 
__isoc99_vfsÿnf


	)

499 
	#vsÿnf
 
__isoc99_vsÿnf


	)

500 
	#vssÿnf
 
__isoc99_vssÿnf


	)

504 
__END_NAMESPACE_C99


508 
__BEGIN_NAMESPACE_STD


513 
	`fg‘c
 (
FILE
 *
__¡»am
);

514 
	`g‘c
 (
FILE
 *
__¡»am
);

520 
	`g‘ch¬
 ();

521 
__END_NAMESPACE_STD


525 
	#g‘c
(
_å
è
	`_IO_g‘c
 (_å)

	)

527 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


532 
	`g‘c_uÆocked
 (
FILE
 *
__¡»am
);

533 
	`g‘ch¬_uÆocked
 ();

536 #ifdeà
__USE_MISC


543 
	`fg‘c_uÆocked
 (
FILE
 *
__¡»am
);

547 
__BEGIN_NAMESPACE_STD


555 
	`åutc
 (
__c
, 
FILE
 *
__¡»am
);

556 
	`putc
 (
__c
, 
FILE
 *
__¡»am
);

562 
	`putch¬
 (
__c
);

563 
__END_NAMESPACE_STD


567 
	#putc
(
_ch
, 
_å
è
	`_IO_putc
 (_ch, _å)

	)

569 #ifdeà
__USE_MISC


576 
	`åutc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

579 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


584 
	`putc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

585 
	`putch¬_uÆocked
 (
__c
);

589 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 \

590 || (
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

592 
	`g‘w
 (
FILE
 *
__¡»am
);

595 
	`putw
 (
__w
, 
FILE
 *
__¡»am
);

599 
__BEGIN_NAMESPACE_STD


604 *
	$fg‘s
 (*
__»¡riù
 
__s
, 
__n
, 
FILE
 *__»¡riù 
__¡»am
)

605 
__wur
;

612 *
	$g‘s
 (*
__s
è
__wur
;

613 
__END_NAMESPACE_STD


615 #ifdeà
__USE_GNU


622 *
	$fg‘s_uÆocked
 (*
__»¡riù
 
__s
, 
__n
,

623 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

627 #ifdef 
__USE_XOPEN2K8


638 
_IO_ssize_t
 
	$__g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

639 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

640 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

641 
_IO_ssize_t
 
	$g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

642 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

643 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

651 
_IO_ssize_t
 
	$g‘lše
 (**
__»¡riù
 
__lš•Œ
,

652 
size_t
 *
__»¡riù
 
__n
,

653 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

657 
__BEGIN_NAMESPACE_STD


662 
	`åuts
 (
__cÚ¡
 *
__»¡riù
 
__s
, 
FILE
 *__»¡riù 
__¡»am
);

668 
	`puts
 (
__cÚ¡
 *
__s
);

675 
	`ung‘c
 (
__c
, 
FILE
 *
__¡»am
);

682 
size_t
 
	$ä—d
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

683 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

688 
size_t
 
	$fwr™e
 (
__cÚ¡
 *
__»¡riù
 
__±r
, 
size_t
 
__size
,

689 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__s
è
__wur
;

690 
__END_NAMESPACE_STD


692 #ifdeà
__USE_GNU


699 
	`åuts_uÆocked
 (
__cÚ¡
 *
__»¡riù
 
__s
,

700 
FILE
 *
__»¡riù
 
__¡»am
);

703 #ifdeà
__USE_MISC


710 
size_t
 
	$ä—d_uÆocked
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

711 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

712 
size_t
 
	$fwr™e_uÆocked
 (
__cÚ¡
 *
__»¡riù
 
__±r
, 
size_t
 
__size
,

713 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

717 
__BEGIN_NAMESPACE_STD


722 
	`f£ek
 (
FILE
 *
__¡»am
, 
__off
, 
__wh’û
);

727 
	$á–l
 (
FILE
 *
__¡»am
è
__wur
;

732 
	`»wšd
 (
FILE
 *
__¡»am
);

733 
__END_NAMESPACE_STD


740 #ià
defšed
 
__USE_LARGEFILE
 || defšed 
__USE_XOPEN2K


741 #iâdeà
__USE_FILE_OFFSET64


746 
	`f£eko
 (
FILE
 *
__¡»am
, 
__off_t
 
__off
, 
__wh’û
);

751 
__off_t
 
	$á–lo
 (
FILE
 *
__¡»am
è
__wur
;

753 #ifdeà
__REDIRECT


754 
	`__REDIRECT
 (
f£eko
,

755 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
),

756 
f£eko64
);

757 
__off64_t
 
	`__REDIRECT
 (
á–lo
, (
FILE
 *
__¡»am
), 
á–lo64
);

759 
	#f£eko
 
f£eko64


	)

760 
	#á–lo
 
á–lo64


	)

765 
__BEGIN_NAMESPACE_STD


766 #iâdeà
__USE_FILE_OFFSET64


771 
	`fg‘pos
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos_t
 *__»¡riù 
__pos
);

776 
	`f£os
 (
FILE
 *
__¡»am
, 
__cÚ¡
 
åos_t
 *
__pos
);

778 #ifdeà
__REDIRECT


779 
	`__REDIRECT
 (
fg‘pos
, (
FILE
 *
__»¡riù
 
__¡»am
,

780 
åos_t
 *
__»¡riù
 
__pos
), 
fg‘pos64
);

781 
	`__REDIRECT
 (
f£os
,

782 (
FILE
 *
__¡»am
, 
__cÚ¡
 
åos_t
 *
__pos
), 
f£os64
);

784 
	#fg‘pos
 
fg‘pos64


	)

785 
	#f£os
 
f£os64


	)

788 
__END_NAMESPACE_STD


790 #ifdeà
__USE_LARGEFILE64


791 
	`f£eko64
 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
);

792 
__off64_t
 
	$á–lo64
 (
FILE
 *
__¡»am
è
__wur
;

793 
	`fg‘pos64
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos64_t
 *__»¡riù 
__pos
);

794 
	`f£os64
 (
FILE
 *
__¡»am
, 
__cÚ¡
 
åos64_t
 *
__pos
);

797 
__BEGIN_NAMESPACE_STD


799 
	$ş—»¼
 (
FILE
 *
__¡»am
è
__THROW
;

801 
	$ãof
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

803 
	$ã¼Ü
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

804 
__END_NAMESPACE_STD


806 #ifdeà
__USE_MISC


808 
	$ş—»¼_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
;

809 
	$ãof_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

810 
	$ã¼Ü_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

814 
__BEGIN_NAMESPACE_STD


819 
	`³¼Ü
 (
__cÚ¡
 *
__s
);

820 
__END_NAMESPACE_STD


826 
	~<b™s/sys_”¾i¡.h
>

829 #ifdef 
__USE_POSIX


831 
	$f’o
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

834 #ifdeà
__USE_MISC


836 
	$f’o_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

840 #ià(
defšed
 
__USE_POSIX2
 || defšed 
__USE_SVID
 || defšed 
__USE_BSD
 || \

841 
defšed
 
__USE_MISC
)

846 
FILE
 *
	$pİ’
 (
__cÚ¡
 *
__commªd
, __cÚ¡ *
__modes
è
__wur
;

852 
	`pşo£
 (
FILE
 *
__¡»am
);

856 #ifdef 
__USE_POSIX


858 *
	$ù”mid
 (*
__s
è
__THROW
;

862 #ifdeà
__USE_XOPEN


864 *
	`cu£rid
 (*
__s
);

868 #ifdef 
__USE_GNU


869 
ob¡ack
;

872 
	$ob¡ack_´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

873 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...)

874 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

875 
	$ob¡ack_v´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

876 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

877 
_G_va_li¡
 
__¬gs
)

878 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

882 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


886 
	$æockfe
 (
FILE
 *
__¡»am
è
__THROW
;

890 
	$árylockfe
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

893 
	$fuÆockfe
 (
FILE
 *
__¡»am
è
__THROW
;

896 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


900 
	#__Ãed_g‘İt


	)

901 
	~<g‘İt.h
>

906 #ifdeà
__USE_EXTERN_INLINES


907 
	~<b™s/¡dio.h
>

909 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


910 
	~<b™s/¡dio2.h
>

912 #ifdeà
__LDBL_COMPAT


913 
	~<b™s/¡dio-ldbl.h
>

916 
__END_DECLS


	@/usr/include/stdlib.h

23 #iâdef 
_STDLIB_H


25 
	~<ã©u»s.h
>

28 
	#__Ãed_size_t


	)

29 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


30 
	#__Ãed_wch¬_t


	)

31 
	#__Ãed_NULL


	)

33 
	~<¡ddef.h
>

35 
	g__BEGIN_DECLS


37 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


38 
	#_STDLIB_H
 1

	)

40 #ià
defšed
 
__USE_XOPEN
 && !defšed 
_SYS_WAIT_H


42 
	~<b™s/wa™æags.h
>

43 
	~<b™s/wa™¡©us.h
>

45 #ifdeà
__USE_BSD


50 #ià
defšed
 
__GNUC__
 && !defšed 
__ılu¥lus


51 
	#__WAIT_INT
(
¡©us
) \

52 (
	`__ex‹nsiÚ__
 (((uniÚ { 
	`__ty³of
(
¡©us
è
__š
; 
__i
; }) \

53 { .
__š
 = (
¡©us
è}).
__i
))

	)

55 
	#__WAIT_INT
(
¡©us
è(*(*è&(¡©us))

	)

63 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2 || defšed 
__ılu¥lus


64 
	#__WAIT_STATUS
 *

	)

65 
	#__WAIT_STATUS_DEFN
 *

	)

70 
wa™
 *
	m__u±r
;

71 *
	m__Œ
;

72 } 
	t__WAIT_STATUS
 
	t__©Œibu‹__
 ((
	t__Œª¥¬’t_uniÚ__
));

73 
	#__WAIT_STATUS_DEFN
 *

	)

78 
	#__WAIT_INT
(
¡©us
è(¡©us)

	)

79 
	#__WAIT_STATUS
 *

	)

80 
	#__WAIT_STATUS_DEFN
 *

	)

85 
	#WEXITSTATUS
(
¡©us
è
	`__WEXITSTATUS
(
	`__WAIT_INT
(¡©us))

	)

86 
	#WTERMSIG
(
¡©us
è
	`__WTERMSIG
(
	`__WAIT_INT
(¡©us))

	)

87 
	#WSTOPSIG
(
¡©us
è
	`__WSTOPSIG
(
	`__WAIT_INT
(¡©us))

	)

88 
	#WIFEXITED
(
¡©us
è
	`__WIFEXITED
(
	`__WAIT_INT
(¡©us))

	)

89 
	#WIFSIGNALED
(
¡©us
è
	`__WIFSIGNALED
(
	`__WAIT_INT
(¡©us))

	)

90 
	#WIFSTOPPED
(
¡©us
è
	`__WIFSTOPPED
(
	`__WAIT_INT
(¡©us))

	)

91 #ifdeà
__WIFCONTINUED


92 
	#WIFCONTINUED
(
¡©us
è
	`__WIFCONTINUED
(
	`__WAIT_INT
(¡©us))

	)

96 
__BEGIN_NAMESPACE_STD


100 
	mquÙ
;

101 
	m»m
;

102 } 
	tdiv_t
;

105 #iâdeà
__ldiv_t_defšed


108 
	mquÙ
;

109 
	m»m
;

110 } 
	tldiv_t
;

111 
	#__ldiv_t_defšed
 1

	)

113 
	g__END_NAMESPACE_STD


115 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__Îdiv_t_defšed


116 
__BEGIN_NAMESPACE_C99


118 
__ex‹nsiÚ__
 struct

120 
	mquÙ
;

121 
	m»m
;

122 } 
	tÎdiv_t
;

123 
	#__Îdiv_t_defšed
 1

	)

124 
	g__END_NAMESPACE_C99


129 
	#RAND_MAX
 2147483647

	)

134 
	#EXIT_FAILURE
 1

	)

135 
	#EXIT_SUCCESS
 0

	)

139 
	#MB_CUR_MAX
 (
	`__ùy³_g‘_mb_cur_max
 ())

	)

140 
size_t
 
	$__ùy³_g‘_mb_cur_max
 (è
__THROW
 
__wur
;

143 
__BEGIN_NAMESPACE_STD


145 
	$©of
 (
__cÚ¡
 *
__ÅŒ
)

146 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

148 
	$©oi
 (
__cÚ¡
 *
__ÅŒ
)

149 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

151 
	$©Ş
 (
__cÚ¡
 *
__ÅŒ
)

152 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

153 
__END_NAMESPACE_STD


155 #ià
defšed
 
__USE_ISOC99
 || (defšed 
__GLIBC_HAVE_LONG_LONG
 && defšed 
__USE_MISC
)

156 
__BEGIN_NAMESPACE_C99


158 
__ex‹nsiÚ__
 
	$©Şl
 (
__cÚ¡
 *
__ÅŒ
)

159 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

160 
__END_NAMESPACE_C99


163 
__BEGIN_NAMESPACE_STD


165 
	$¡¹od
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

166 **
__»¡riù
 
__’d±r
)

167 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

168 
__END_NAMESPACE_STD


170 #ifdef 
__USE_ISOC99


171 
__BEGIN_NAMESPACE_C99


173 
	$¡¹of
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

174 **
__»¡riù
 
__’d±r
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

176 
	$¡¹Şd
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

177 **
__»¡riù
 
__’d±r
)

178 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

179 
__END_NAMESPACE_C99


182 
__BEGIN_NAMESPACE_STD


184 
	$¡¹Ş
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

185 **
__»¡riù
 
__’d±r
, 
__ba£
)

186 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

188 
	$¡¹oul
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

189 **
__»¡riù
 
__’d±r
, 
__ba£
)

190 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

191 
__END_NAMESPACE_STD


193 #ià
defšed
 
__GLIBC_HAVE_LONG_LONG
 && defšed 
__USE_BSD


195 
__ex‹nsiÚ__


196 
	$¡¹oq
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

197 **
__»¡riù
 
__’d±r
, 
__ba£
)

198 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

200 
__ex‹nsiÚ__


201 
	$¡¹ouq
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

202 **
__»¡riù
 
__’d±r
, 
__ba£
)

203 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

206 #ià
defšed
 
__USE_ISOC99
 || (defšed 
__GLIBC_HAVE_LONG_LONG
 && defšed 
__USE_MISC
)

207 
__BEGIN_NAMESPACE_C99


209 
__ex‹nsiÚ__


210 
	$¡¹Şl
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

211 **
__»¡riù
 
__’d±r
, 
__ba£
)

212 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

214 
__ex‹nsiÚ__


215 
	$¡¹ouÎ
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

216 **
__»¡riù
 
__’d±r
, 
__ba£
)

217 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

218 
__END_NAMESPACE_C99


222 #ifdeà
__USE_GNU


236 
	~<xloÿË.h
>

240 
	$¡¹Ş_l
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

241 **
__»¡riù
 
__’d±r
, 
__ba£
,

242 
__loÿË_t
 
__loc
è
__THROW
 
	`__nÚnuÎ
 ((1, 4)è
__wur
;

244 
	$¡¹oul_l
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

245 **
__»¡riù
 
__’d±r
,

246 
__ba£
, 
__loÿË_t
 
__loc
)

247 
__THROW
 
	`__nÚnuÎ
 ((1, 4)è
__wur
;

249 
__ex‹nsiÚ__


250 
	$¡¹Şl_l
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

251 **
__»¡riù
 
__’d±r
, 
__ba£
,

252 
__loÿË_t
 
__loc
)

253 
__THROW
 
	`__nÚnuÎ
 ((1, 4)è
__wur
;

255 
__ex‹nsiÚ__


256 
	$¡¹ouÎ_l
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

257 **
__»¡riù
 
__’d±r
,

258 
__ba£
, 
__loÿË_t
 
__loc
)

259 
__THROW
 
	`__nÚnuÎ
 ((1, 4)è
__wur
;

261 
	$¡¹od_l
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

262 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

263 
__THROW
 
	`__nÚnuÎ
 ((1, 3)è
__wur
;

265 
	$¡¹of_l
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

266 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

267 
__THROW
 
	`__nÚnuÎ
 ((1, 3)è
__wur
;

269 
	$¡¹Şd_l
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

270 **
__»¡riù
 
__’d±r
,

271 
__loÿË_t
 
__loc
)

272 
__THROW
 
	`__nÚnuÎ
 ((1, 3)è
__wur
;

276 #ifdeà
__USE_EXTERN_INLINES


277 
__BEGIN_NAMESPACE_STD


278 
__ex‹º_šlše
 

279 
	`__NTH
 (
	$©of
 (
__cÚ¡
 *
__ÅŒ
))

281  
	`¡¹od
 (
__ÅŒ
, (**è
NULL
);

282 
	}
}

283 
__ex‹º_šlše
 

284 
__NTH
 (
	$©oi
 (
__cÚ¡
 *
__ÅŒ
))

286  (è
	`¡¹Ş
 (
__ÅŒ
, (**è
NULL
, 10);

287 
	}
}

288 
__ex‹º_šlše
 

289 
__NTH
 (
	$©Ş
 (
__cÚ¡
 *
__ÅŒ
))

291  
	`¡¹Ş
 (
__ÅŒ
, (**è
NULL
, 10);

292 
	}
}

293 
	g__END_NAMESPACE_STD


295 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_ISOC99


296 
__BEGIN_NAMESPACE_C99


297 
__ex‹nsiÚ__
 
__ex‹º_šlše
 

298 
__NTH
 (
	$©Şl
 (
__cÚ¡
 *
__ÅŒ
))

300  
	`¡¹Şl
 (
__ÅŒ
, (**è
NULL
, 10);

301 
	}
}

302 
	g__END_NAMESPACE_C99


307 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN_EXTENDED


311 *
	$l64a
 (
__n
è
__THROW
 
__wur
;

314 
	$a64l
 (
__cÚ¡
 *
__s
)

315 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

319 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_BSD


320 
	~<sys/ty³s.h
>

327 
	$¿ndom
 (è
__THROW
;

330 
	$¤ªdom
 (
__£ed
è
__THROW
;

336 *
	$š™¡©e
 (
__£ed
, *
__¡©ebuf
,

337 
size_t
 
__¡©–’
è
__THROW
 
	`__nÚnuÎ
 ((2));

341 *
	$£t¡©e
 (*
__¡©ebuf
è
__THROW
 
	`__nÚnuÎ
 ((1));

344 #ifdeà
__USE_MISC


349 
	s¿ndom_d©a


351 
št32_t
 *
åŒ
;

352 
št32_t
 *
½Œ
;

353 
št32_t
 *
¡©e
;

354 
¿nd_ty³
;

355 
¿nd_deg
;

356 
¿nd_£p
;

357 
št32_t
 *
’d_±r
;

360 
	$¿ndom_r
 (
¿ndom_d©a
 *
__»¡riù
 
__buf
,

361 
št32_t
 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

363 
	$¤ªdom_r
 (
__£ed
, 
¿ndom_d©a
 *
__buf
)

364 
__THROW
 
	`__nÚnuÎ
 ((2));

366 
	$š™¡©e_r
 (
__£ed
, *
__»¡riù
 
__¡©ebuf
,

367 
size_t
 
__¡©–’
,

368 
¿ndom_d©a
 *
__»¡riù
 
__buf
)

369 
__THROW
 
	`__nÚnuÎ
 ((2, 4));

371 
	$£t¡©e_r
 (*
__»¡riù
 
__¡©ebuf
,

372 
¿ndom_d©a
 *
__»¡riù
 
__buf
)

373 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

378 
__BEGIN_NAMESPACE_STD


380 
	$¿nd
 (è
__THROW
;

382 
	$¤ªd
 (
__£ed
è
__THROW
;

383 
__END_NAMESPACE_STD


385 #ifdeà
__USE_POSIX


387 
	$¿nd_r
 (*
__£ed
è
__THROW
;

391 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


395 
	$d¿nd48
 (è
__THROW
;

396 
	$”ªd48
 (
__xsubi
[3]è
__THROW
 
	`__nÚnuÎ
 ((1));

399 
	$Ìªd48
 (è
__THROW
;

400 
	$Äªd48
 (
__xsubi
[3])

401 
__THROW
 
	`__nÚnuÎ
 ((1));

404 
	$m¿nd48
 (è
__THROW
;

405 
	$j¿nd48
 (
__xsubi
[3])

406 
__THROW
 
	`__nÚnuÎ
 ((1));

409 
	$¤ªd48
 (
__£edv®
è
__THROW
;

410 *
	$£ed48
 (
__£ed16v
[3])

411 
__THROW
 
	`__nÚnuÎ
 ((1));

412 
	$lcÚg48
 (
__·¿m
[7]è
__THROW
 
	`__nÚnuÎ
 ((1));

414 #ifdeà
__USE_MISC


418 
	sd¿nd48_d©a


420 
__x
[3];

421 
__Şd_x
[3];

422 
__c
;

423 
__š™
;

424 
__a
;

428 
	$d¿nd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

429 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

430 
	$”ªd48_r
 (
__xsubi
[3],

431 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

432 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

435 
	$Ìªd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

436 *
__»¡riù
 
__»suÉ
)

437 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

438 
	$Äªd48_r
 (
__xsubi
[3],

439 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

440 *
__»¡riù
 
__»suÉ
)

441 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

444 
	$m¿nd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

445 *
__»¡riù
 
__»suÉ
)

446 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

447 
	$j¿nd48_r
 (
__xsubi
[3],

448 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

449 *
__»¡riù
 
__»suÉ
)

450 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

453 
	$¤ªd48_r
 (
__£edv®
, 
d¿nd48_d©a
 *
__bufãr
)

454 
__THROW
 
	`__nÚnuÎ
 ((2));

456 
	$£ed48_r
 (
__£ed16v
[3],

457 
d¿nd48_d©a
 *
__bufãr
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

459 
	$lcÚg48_r
 (
__·¿m
[7],

460 
d¿nd48_d©a
 *
__bufãr
)

461 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

467 #iâdeà
__m®loc_ªd_ÿÎoc_defšed


468 
	#__m®loc_ªd_ÿÎoc_defšed


	)

469 
__BEGIN_NAMESPACE_STD


471 *
	$m®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

473 *
	$ÿÎoc
 (
size_t
 
__nmemb
, size_ˆ
__size
)

474 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

475 
__END_NAMESPACE_STD


478 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


479 
__BEGIN_NAMESPACE_STD


485 *
	$»®loc
 (*
__±r
, 
size_t
 
__size
)

486 
__THROW
 
__©Œibu‹_w¬n_unu£d_»suÉ__
;

488 
	$ä“
 (*
__±r
è
__THROW
;

489 
__END_NAMESPACE_STD


491 #ifdef 
__USE_MISC


493 
	$cä“
 (*
__±r
è
__THROW
;

496 #ià
defšed
 
__USE_GNU
 || defšed 
__USE_BSD
 || defšed 
__USE_MISC


497 
	~<®loÿ.h
>

500 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


502 *
	$v®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

505 #ifdeà
__USE_XOPEN2K


507 
	$posix_mem®ign
 (**
__mem±r
, 
size_t
 
__®ignm’t
, size_ˆ
__size
)

508 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

511 
__BEGIN_NAMESPACE_STD


513 
	$abÜt
 (è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

517 
	`©ex™
 ((*
__func
è()è
__THROW
 
	`__nÚnuÎ
 ((1));

519 #ifdeà
__USE_GNU


523 #ifdeà
__ılu¥lus


524 "C++" 
	`©_quick_ex™
 ((*
__func
) ())

525 
__THROW
 
	`__asm
 ("©_quick_ex™"è
	`__nÚnuÎ
 ((1));

527 
	`©_quick_ex™
 ((*
__func
è()è
__THROW
 
	`__nÚnuÎ
 ((1));

530 
__END_NAMESPACE_STD


532 #ifdef 
__USE_MISC


535 
	`Ú_ex™
 ((*
__func
è(
__¡©us
, *
__¬g
), *__arg)

536 
__THROW
 
	`__nÚnuÎ
 ((1));

539 
__BEGIN_NAMESPACE_STD


543 
	$ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

545 #ifdeà
__USE_GNU


551 
	$quick_ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

553 
__END_NAMESPACE_STD


555 #ifdeà
__USE_ISOC99


556 
__BEGIN_NAMESPACE_C99


559 
	$_Ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

560 
__END_NAMESPACE_C99


564 
__BEGIN_NAMESPACE_STD


566 *
	$g‘’v
 (
__cÚ¡
 *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

567 
__END_NAMESPACE_STD


571 *
	$__£cu»_g‘’v
 (
__cÚ¡
 *
__Çme
)

572 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

574 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


578 
	$pu‹nv
 (*
__¡ršg
è
__THROW
 
	`__nÚnuÎ
 ((1));

581 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K


584 
	$£‹nv
 (
__cÚ¡
 *
__Çme
, __cÚ¡ *
__v®ue
, 
__»¶aû
)

585 
__THROW
 
	`__nÚnuÎ
 ((2));

588 
	$un£‹nv
 (
__cÚ¡
 *
__Çme
è
__THROW
;

591 #ifdef 
__USE_MISC


595 
	$ş—»nv
 (è
__THROW
;

599 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


604 *
	$mk‹mp
 (*
__‹m¶©e
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

614 #iâdeà
__USE_FILE_OFFSET64


615 
	$mk¡emp
 (*
__‹m¶©e
è
	`__nÚnuÎ
 ((1)è
__wur
;

617 #ifdeà
__REDIRECT


618 
	`__REDIRECT
 (
mk¡emp
, (*
__‹m¶©e
), 
mk¡emp64
)

619 
	`__nÚnuÎ
 ((1)è
__wur
;

621 
	#mk¡emp
 
mk¡emp64


	)

624 #ifdeà
__USE_LARGEFILE64


625 
	$mk¡emp64
 (*
__‹m¶©e
è
	`__nÚnuÎ
 ((1)è
__wur
;

629 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K8


635 *
	$mkd‹mp
 (*
__‹m¶©e
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

638 #ifdeà
__USE_GNU


645 #iâdeà
__USE_FILE_OFFSET64


646 
	$mko¡emp
 (*
__‹m¶©e
, 
__æags
è
	`__nÚnuÎ
 ((1)è
__wur
;

648 #ifdeà
__REDIRECT


649 
	`__REDIRECT
 (
mko¡emp
, (*
__‹m¶©e
, 
__æags
), 
mko¡emp64
)

650 
	`__nÚnuÎ
 ((1)è
__wur
;

652 
	#mko¡emp
 
mko¡emp64


	)

655 #ifdeà
__USE_LARGEFILE64


656 
	$mko¡emp64
 (*
__‹m¶©e
, 
__æags
è
	`__nÚnuÎ
 ((1)è
__wur
;

661 
__BEGIN_NAMESPACE_STD


666 
	$sy¡em
 (
__cÚ¡
 *
__commªd
è
__wur
;

667 
__END_NAMESPACE_STD


670 #ifdef 
__USE_GNU


673 *
	$ÿnÚiÿlize_fe_Çme
 (
__cÚ¡
 *
__Çme
)

674 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

677 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


683 *
	$»®·th
 (
__cÚ¡
 *
__»¡riù
 
__Çme
,

684 *
__»¡riù
 
__»sŞved
è
__THROW
 
__wur
;

689 #iâdeà
__COMPAR_FN_T


690 
	#__COMPAR_FN_T


	)

691 (*
	t__com·r_â_t
è(
	t__cÚ¡
 *, __const *);

693 #ifdef 
__USE_GNU


694 
__com·r_â_t
 
	tcom·risÚ_â_t
;

697 #ifdeà
__USE_GNU


698 (*
	t__com·r_d_â_t
è(
	t__cÚ¡
 *, __const *, *);

701 
__BEGIN_NAMESPACE_STD


704 *
	$b£¬ch
 (
__cÚ¡
 *
__key
, __cÚ¡ *
__ba£
,

705 
size_t
 
__nmemb
, size_ˆ
__size
, 
__com·r_â_t
 
__com·r
)

706 
	`__nÚnuÎ
 ((1, 2, 5)è
__wur
;

710 
	$qsÜt
 (*
__ba£
, 
size_t
 
__nmemb
, size_ˆ
__size
,

711 
__com·r_â_t
 
__com·r
è
	`__nÚnuÎ
 ((1, 4));

712 #ifdeà
__USE_GNU


713 
	$qsÜt_r
 (*
__ba£
, 
size_t
 
__nmemb
, size_ˆ
__size
,

714 
__com·r_d_â_t
 
__com·r
, *
__¬g
)

715 
	`__nÚnuÎ
 ((1, 4));

720 
	$abs
 (
__x
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

721 
	$Ïbs
 (
__x
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

722 
__END_NAMESPACE_STD


724 #ifdeà
__USE_ISOC99


725 
__ex‹nsiÚ__
 
	$Îabs
 (
__x
)

726 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

730 
__BEGIN_NAMESPACE_STD


734 
div_t
 
	$div
 (
__num”
, 
__d’om
)

735 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

736 
ldiv_t
 
	$ldiv
 (
__num”
, 
__d’om
)

737 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

738 
__END_NAMESPACE_STD


740 #ifdeà
__USE_ISOC99


741 
__BEGIN_NAMESPACE_C99


742 
__ex‹nsiÚ__
 
Îdiv_t
 
	$Îdiv
 (
__num”
,

743 
__d’om
)

744 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

745 
__END_NAMESPACE_C99


749 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN_EXTENDED


756 *
	$ecvt
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

757 *
__»¡riù
 
__sign
è
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

762 *
	$fcvt
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

763 *
__»¡riù
 
__sign
è
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

768 *
	$gcvt
 (
__v®ue
, 
__ndig™
, *
__buf
)

769 
__THROW
 
	`__nÚnuÎ
 ((3)è
__wur
;

772 #ifdeà
__USE_MISC


774 *
	$qecvt
 (
__v®ue
, 
__ndig™
,

775 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
)

776 
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

777 *
	$qfcvt
 (
__v®ue
, 
__ndig™
,

778 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
)

779 
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

780 *
	$qgcvt
 (
__v®ue
, 
__ndig™
, *
__buf
)

781 
__THROW
 
	`__nÚnuÎ
 ((3)è
__wur
;

786 
	$ecvt_r
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

787 *
__»¡riù
 
__sign
, *__»¡riù 
__buf
,

788 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

789 
	$fcvt_r
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

790 *
__»¡riù
 
__sign
, *__»¡riù 
__buf
,

791 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

793 
	$qecvt_r
 (
__v®ue
, 
__ndig™
,

794 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
,

795 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

796 
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

797 
	$qfcvt_r
 (
__v®ue
, 
__ndig™
,

798 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
,

799 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

800 
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

805 
__BEGIN_NAMESPACE_STD


808 
	$mbËn
 (
__cÚ¡
 *
__s
, 
size_t
 
__n
è
__THROW
 
__wur
;

811 
	$mbtowc
 (
wch¬_t
 *
__»¡riù
 
__pwc
,

812 
__cÚ¡
 *
__»¡riù
 
__s
, 
size_t
 
__n
è
__THROW
 
__wur
;

815 
	$wùomb
 (*
__s
, 
wch¬_t
 
__wch¬
è
__THROW
 
__wur
;

819 
size_t
 
	$mb¡owcs
 (
wch¬_t
 *
__»¡riù
 
__pwcs
,

820 
__cÚ¡
 *
__»¡riù
 
__s
, 
size_t
 
__n
è
__THROW
;

822 
size_t
 
	$wc¡ombs
 (*
__»¡riù
 
__s
,

823 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__pwcs
, 
size_t
 
__n
)

824 
__THROW
;

825 
__END_NAMESPACE_STD


828 #ifdeà
__USE_SVID


833 
	$½m©ch
 (
__cÚ¡
 *
__»¥Ú£
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

837 #ifdeà
__USE_XOPEN_EXTENDED


844 
	$g‘subİt
 (**
__»¡riù
 
__İtiÚp
,

845 *
__cÚ¡
 *
__»¡riù
 
__tok’s
,

846 **
__»¡riù
 
__v®u•
)

847 
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3)è
__wur
;

851 #ifdeà
__USE_XOPEN


853 
	$£tkey
 (
__cÚ¡
 *
__key
è
__THROW
 
	`__nÚnuÎ
 ((1));

859 #ifdeà
__USE_XOPEN2K


861 
	$posix_İ’±
 (
__oæag
è
__wur
;

864 #ifdeà
__USE_XOPEN


869 
	$g¿Á±
 (
__fd
è
__THROW
;

873 
	$uÆock±
 (
__fd
è
__THROW
;

878 *
	$±¢ame
 (
__fd
è
__THROW
 
__wur
;

881 #ifdeà
__USE_GNU


885 
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
)

886 
__THROW
 
	`__nÚnuÎ
 ((2));

889 
	`g‘±
 ();

892 #ifdeà
__USE_BSD


896 
	$g‘lßdavg
 (
__lßdavg
[], 
__ÃËm
)

897 
__THROW
 
	`__nÚnuÎ
 ((1));

902 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


903 
	~<b™s/¡dlib.h
>

905 #ifdeà
__LDBL_COMPAT


906 
	~<b™s/¡dlib-ldbl.h
>

910 #undeà
__Ãed_m®loc_ªd_ÿÎoc


912 
__END_DECLS


	@/usr/include/string.h

23 #iâdef 
_STRING_H


24 
	#_STRING_H
 1

	)

26 
	~<ã©u»s.h
>

28 
	g__BEGIN_DECLS


31 
	#__Ãed_size_t


	)

32 
	#__Ãed_NULL


	)

33 
	~<¡ddef.h
>

36 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (4, 4)

37 
	#__CORRECT_ISO_CPP_STRING_H_PROTO


	)

41 
__BEGIN_NAMESPACE_STD


43 *
	$memıy
 (*
__»¡riù
 
__de¡
,

44 
__cÚ¡
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

45 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

48 *
	$memmove
 (*
__de¡
, 
__cÚ¡
 *
__¤c
, 
size_t
 
__n
)

49 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

50 
__END_NAMESPACE_STD


55 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN


56 *
	$memcıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
,

57 
__c
, 
size_t
 
__n
)

58 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

62 
__BEGIN_NAMESPACE_STD


64 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

67 
	$memcmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
, 
size_t
 
__n
)

68 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

71 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


74 *
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

75 
__THROW
 
	`__asm
 ("memchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

76 
__cÚ¡
 *
	`memchr
 (__cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

77 
__THROW
 
	`__asm
 ("memchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

79 #ifdeà
__OPTIMIZE__


80 
__ex‹º_®ways_šlše
 *

81 
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
è
__THROW


83  
	`__butš_memchr
 (
__s
, 
__c
, 
__n
);

86 
__ex‹º_®ways_šlše
 
__cÚ¡
 *

87 
	`memchr
 (
__cÚ¡
 *
__s
, 
__c
, 
size_t
 
__n
è
__THROW


89  
	`__butš_memchr
 (
__s
, 
__c
, 
__n
);

92 
	}
}

94 *
	$memchr
 (
__cÚ¡
 *
__s
, 
__c
, 
size_t
 
__n
)

95 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

97 
__END_NAMESPACE_STD


99 #ifdeà
__USE_GNU


102 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


103 "C++" *
	$¿wmemchr
 (*
__s
, 
__c
)

104 
__THROW
 
	`__asm
 ("¿wmemchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

105 "C++" 
__cÚ¡
 *
	$¿wmemchr
 (
__cÚ¡
 *
__s
, 
__c
)

106 
__THROW
 
	`__asm
 ("¿wmemchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

108 *
	$¿wmemchr
 (
__cÚ¡
 *
__s
, 
__c
)

109 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

113 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


114 "C++" *
	$memrchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

115 
__THROW
 
	`__asm
 ("memrchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

116 "C++" 
__cÚ¡
 *
	$memrchr
 (
__cÚ¡
 *
__s
, 
__c
, 
size_t
 
__n
)

117 
__THROW
 
	`__asm
 ("memrchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

119 *
	$memrchr
 (
__cÚ¡
 *
__s
, 
__c
, 
size_t
 
__n
)

120 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

125 
__BEGIN_NAMESPACE_STD


127 *
	$¡rıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
)

128 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

130 *
	$¡ºıy
 (*
__»¡riù
 
__de¡
,

131 
__cÚ¡
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

132 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

135 *
	$¡rÿt
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
)

136 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

138 *
	$¡ºÿt
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
,

139 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

142 
	$¡rcmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
)

143 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

145 
	$¡ºcmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
, 
size_t
 
__n
)

146 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

149 
	$¡rcŞl
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
)

150 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

152 
size_t
 
	$¡rxäm
 (*
__»¡riù
 
__de¡
,

153 
__cÚ¡
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

154 
__THROW
 
	`__nÚnuÎ
 ((2));

155 
__END_NAMESPACE_STD


157 #ifdeà
__USE_XOPEN2K8


161 
	~<xloÿË.h
>

164 
	$¡rcŞl_l
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
, 
__loÿË_t
 
__l
)

165 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

167 
size_t
 
	$¡rxäm_l
 (*
__de¡
, 
__cÚ¡
 *
__¤c
, 
size_t
 
__n
,

168 
__loÿË_t
 
__l
è
__THROW
 
	`__nÚnuÎ
 ((2, 4));

171 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


173 *
	$¡rdup
 (
__cÚ¡
 *
__s
)

174 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

180 #ià
defšed
 
__USE_XOPEN2K8


181 *
	$¡ºdup
 (
__cÚ¡
 *
__¡ršg
, 
size_t
 
__n
)

182 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

185 #ià
defšed
 
__USE_GNU
 && defšed 
__GNUC__


187 
	#¡rdu·
(
s
) \

188 (
__ex‹nsiÚ__
 \

190 
__cÚ¡
 *
__Şd
 = (
s
); \

191 
size_t
 
__Ën
 = 
	`¡¾’
 (
__Şd
) + 1; \

192 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
); \

193 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

194 
	}
}))

	)

197 
	#¡ºdu·
(
s
, 
n
) \

198 (
__ex‹nsiÚ__
 \

200 
__cÚ¡
 *
__Şd
 = (
s
); \

201 
size_t
 
__Ën
 = 
	`¡ºËn
 (
__Şd
, (
n
)); \

202 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
 + 1); \

203 
__Ãw
[
__Ën
] = '\0'; \

204 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

205 }))

	)

208 
	g__BEGIN_NAMESPACE_STD


210 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


213 *
¡rchr
 (*
__s
, 
__c
)

214 
__THROW
 
__asm
 ("¡rchr"è
__©Œibu‹_pu»__
 
__nÚnuÎ
 ((1));

215 
__cÚ¡
 *
¡rchr
 (__cÚ¡ *
__s
, 
__c
)

216 
__THROW
 
__asm
 ("¡rchr"è
__©Œibu‹_pu»__
 
__nÚnuÎ
 ((1));

218 #ifdeà
__OPTIMIZE__


219 
__ex‹º_®ways_šlše
 *

220 
¡rchr
 (*
__s
, 
__c
è
	g__THROW


222  
__butš_¡rchr
 (
__s
, 
__c
);

225 
__ex‹º_®ways_šlše
 
__cÚ¡
 *

226 
¡rchr
 (
__cÚ¡
 *
__s
, 
__c
è
	g__THROW


228  
__butš_¡rchr
 (
__s
, 
__c
);

233 *
	$¡rchr
 (
__cÚ¡
 *
__s
, 
__c
)

234 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

237 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


240 *
	`¡¼chr
 (*
__s
, 
__c
)

241 
__THROW
 
	`__asm
 ("¡¼chr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

242 
__cÚ¡
 *
	`¡¼chr
 (__cÚ¡ *
__s
, 
__c
)

243 
__THROW
 
	`__asm
 ("¡¼chr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

245 #ifdeà
__OPTIMIZE__


246 
__ex‹º_®ways_šlše
 *

247 
	`¡¼chr
 (*
__s
, 
__c
è
__THROW


249  
	`__butš_¡¼chr
 (
__s
, 
__c
);

252 
__ex‹º_®ways_šlše
 
__cÚ¡
 *

253 
	`¡¼chr
 (
__cÚ¡
 *
__s
, 
__c
è
__THROW


255  
	`__butš_¡¼chr
 (
__s
, 
__c
);

258 
	}
}

260 *
	$¡¼chr
 (
__cÚ¡
 *
__s
, 
__c
)

261 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

263 
__END_NAMESPACE_STD


265 #ifdeà
__USE_GNU


268 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


269 "C++" *
	$¡rchºul
 (*
__s
, 
__c
)

270 
__THROW
 
	`__asm
 ("¡rchºul"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

271 "C++" 
__cÚ¡
 *
	$¡rchºul
 (
__cÚ¡
 *
__s
, 
__c
)

272 
__THROW
 
	`__asm
 ("¡rchºul"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

274 *
	$¡rchºul
 (
__cÚ¡
 *
__s
, 
__c
)

275 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

279 
__BEGIN_NAMESPACE_STD


282 
size_t
 
	$¡rc¥n
 (
__cÚ¡
 *
__s
, __cÚ¡ *
__»jeù
)

283 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

286 
size_t
 
	$¡r¥n
 (
__cÚ¡
 *
__s
, __cÚ¡ *
__acû±
)

287 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

289 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


292 *
	`¡½brk
 (*
__s
, 
__cÚ¡
 *
__acû±
)

293 
__THROW
 
	`__asm
 ("¡½brk"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

294 
__cÚ¡
 *
	`¡½brk
 (__cÚ¡ *
__s
, __cÚ¡ *
__acû±
)

295 
__THROW
 
	`__asm
 ("¡½brk"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

297 #ifdeà
__OPTIMIZE__


298 
__ex‹º_®ways_šlše
 *

299 
	`¡½brk
 (*
__s
, 
__cÚ¡
 *
__acû±
è
__THROW


301  
	`__butš_¡½brk
 (
__s
, 
__acû±
);

304 
__ex‹º_®ways_šlše
 
__cÚ¡
 *

305 
	`¡½brk
 (
__cÚ¡
 *
__s
, __cÚ¡ *
__acû±
è
__THROW


307  
	`__butš_¡½brk
 (
__s
, 
__acû±
);

310 
	}
}

312 *
	$¡½brk
 (
__cÚ¡
 *
__s
, __cÚ¡ *
__acû±
)

313 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

316 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


319 *
	`¡r¡r
 (*
__hay¡ack
, 
__cÚ¡
 *
__ÃedË
)

320 
__THROW
 
	`__asm
 ("¡r¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

321 
__cÚ¡
 *
	`¡r¡r
 (__cÚ¡ *
__hay¡ack
,

322 
__cÚ¡
 *
__ÃedË
)

323 
__THROW
 
	`__asm
 ("¡r¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

325 #ifdeà
__OPTIMIZE__


326 
__ex‹º_®ways_šlše
 *

327 
	`¡r¡r
 (*
__hay¡ack
, 
__cÚ¡
 *
__ÃedË
è
__THROW


329  
	`__butš_¡r¡r
 (
__hay¡ack
, 
__ÃedË
);

332 
__ex‹º_®ways_šlše
 
__cÚ¡
 *

333 
	`¡r¡r
 (
__cÚ¡
 *
__hay¡ack
, __cÚ¡ *
__ÃedË
è
__THROW


335  
	`__butš_¡r¡r
 (
__hay¡ack
, 
__ÃedË
);

338 
	}
}

340 *
	$¡r¡r
 (
__cÚ¡
 *
__hay¡ack
, __cÚ¡ *
__ÃedË
)

341 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

346 *
	$¡¹ok
 (*
__»¡riù
 
__s
, 
__cÚ¡
 *__»¡riù 
__d–im
)

347 
__THROW
 
	`__nÚnuÎ
 ((2));

348 
__END_NAMESPACE_STD


352 *
	$__¡¹ok_r
 (*
__»¡riù
 
__s
,

353 
__cÚ¡
 *
__»¡riù
 
__d–im
,

354 **
__»¡riù
 
__§ve_±r
)

355 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

356 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


357 *
	$¡¹ok_r
 (*
__»¡riù
 
__s
, 
__cÚ¡
 *__»¡riù 
__d–im
,

358 **
__»¡riù
 
__§ve_±r
)

359 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

362 #ifdeà
__USE_GNU


364 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


365 "C++" *
	$¡rÿ£¡r
 (*
__hay¡ack
, 
__cÚ¡
 *
__ÃedË
)

366 
__THROW
 
	`__asm
 ("¡rÿ£¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

367 "C++" 
__cÚ¡
 *
	$¡rÿ£¡r
 (
__cÚ¡
 *
__hay¡ack
,

368 
__cÚ¡
 *
__ÃedË
)

369 
__THROW
 
	`__asm
 ("¡rÿ£¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

371 *
	$¡rÿ£¡r
 (
__cÚ¡
 *
__hay¡ack
, __cÚ¡ *
__ÃedË
)

372 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

376 #ifdeà
__USE_GNU


380 *
	$memmem
 (
__cÚ¡
 *
__hay¡ack
, 
size_t
 
__hay¡ackËn
,

381 
__cÚ¡
 *
__ÃedË
, 
size_t
 
__ÃedËËn
)

382 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 3));

386 *
	$__mempıy
 (*
__»¡riù
 
__de¡
,

387 
__cÚ¡
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

388 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

389 *
	$mempıy
 (*
__»¡riù
 
__de¡
,

390 
__cÚ¡
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

391 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

395 
__BEGIN_NAMESPACE_STD


397 
size_t
 
	$¡¾’
 (
__cÚ¡
 *
__s
)

398 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

399 
__END_NAMESPACE_STD


401 #ifdef 
__USE_XOPEN2K8


404 
size_t
 
	$¡ºËn
 (
__cÚ¡
 *
__¡ršg
, 
size_t
 
__maxËn
)

405 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

409 
__BEGIN_NAMESPACE_STD


411 *
	$¡»¼Ü
 (
__”ºum
è
__THROW
;

412 
__END_NAMESPACE_STD


413 #ià
defšed
 
__USE_XOPEN2K
 || defšed 
__USE_MISC


421 #ià
defšed
 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


424 #ifdeà
__REDIRECT_NTH


425 
	`__REDIRECT_NTH
 (
¡»¼Ü_r
,

426 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
),

427 
__xpg_¡»¼Ü_r
è
	`__nÚnuÎ
 ((2));

429 
	$__xpg_¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

430 
__THROW
 
	`__nÚnuÎ
 ((2));

431 
	#¡»¼Ü_r
 
__xpg_¡»¼Ü_r


	)

436 *
	$¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

437 
__THROW
 
	`__nÚnuÎ
 ((2));

441 #ifdeà
__USE_XOPEN2K8


443 *
	$¡»¼Ü_l
 (
__”ºum
, 
__loÿË_t
 
__l
è
__THROW
;

449 
	$__bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

451 #ifdeà
__USE_BSD


453 
	$bcİy
 (
__cÚ¡
 *
__¤c
, *
__de¡
, 
size_t
 
__n
)

454 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

457 
	$bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

460 
	$bcmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
, 
size_t
 
__n
)

461 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

464 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


467 *
	`šdex
 (*
__s
, 
__c
)

468 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

469 
__cÚ¡
 *
	`šdex
 (__cÚ¡ *
__s
, 
__c
)

470 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

472 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


473 
__ex‹º_®ways_šlše
 *

474 
	`šdex
 (*
__s
, 
__c
è
__THROW


476  
	`__butš_šdex
 (
__s
, 
__c
);

479 
__ex‹º_®ways_šlše
 
__cÚ¡
 *

480 
	`šdex
 (
__cÚ¡
 *
__s
, 
__c
è
__THROW


482  
	`__butš_šdex
 (
__s
, 
__c
);

485 
	}
}

487 *
	$šdex
 (
__cÚ¡
 *
__s
, 
__c
)

488 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

492 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


495 *
	`ršdex
 (*
__s
, 
__c
)

496 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

497 
__cÚ¡
 *
	`ršdex
 (__cÚ¡ *
__s
, 
__c
)

498 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

500 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


501 
__ex‹º_®ways_šlše
 *

502 
	`ršdex
 (*
__s
, 
__c
è
__THROW


504  
	`__butš_ršdex
 (
__s
, 
__c
);

507 
__ex‹º_®ways_šlše
 
__cÚ¡
 *

508 
	`ršdex
 (
__cÚ¡
 *
__s
, 
__c
è
__THROW


510  
	`__butš_ršdex
 (
__s
, 
__c
);

513 
	}
}

515 *
	$ršdex
 (
__cÚ¡
 *
__s
, 
__c
)

516 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

521 
	$ffs
 (
__i
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

525 #ifdef 
__USE_GNU


526 
	$ff¦
 (
__l
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

527 #ifdeà
__GNUC__


528 
__ex‹nsiÚ__
 
	$ff¦l
 (
__Î
)

529 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

534 
	$¡rÿ£cmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
)

535 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

538 
	$¡ºÿ£cmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
, 
size_t
 
__n
)

539 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

542 #ifdef 
__USE_GNU


545 
	$¡rÿ£cmp_l
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
,

546 
__loÿË_t
 
__loc
)

547 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

549 
	$¡ºÿ£cmp_l
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
,

550 
size_t
 
__n
, 
__loÿË_t
 
__loc
)

551 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 4));

554 #ifdef 
__USE_BSD


557 *
	$¡r£p
 (**
__»¡riù
 
__¡ršgp
,

558 
__cÚ¡
 *
__»¡riù
 
__d–im
)

559 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

562 #ifdef 
__USE_XOPEN2K8


564 *
	$¡rsigÇl
 (
__sig
è
__THROW
;

567 *
	$__¡pıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
)

568 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

569 *
	$¡pıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
)

570 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

574 *
	$__¡²ıy
 (*
__»¡riù
 
__de¡
,

575 
__cÚ¡
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

576 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

577 *
	$¡²ıy
 (*
__»¡riù
 
__de¡
,

578 
__cÚ¡
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

579 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

582 #ifdef 
__USE_GNU


584 
	$¡rv”scmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
)

585 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

588 *
	$¡räy
 (*
__¡ršg
è
__THROW
 
	`__nÚnuÎ
 ((1));

591 *
	$memäob
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

593 #iâdeà
ba£Çme


598 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


599 "C++" *
	$ba£Çme
 (*
__f’ame
)

600 
__THROW
 
	`__asm
 ("ba£Çme"è
	`__nÚnuÎ
 ((1));

601 "C++" 
__cÚ¡
 *
	$ba£Çme
 (
__cÚ¡
 *
__f’ame
)

602 
__THROW
 
	`__asm
 ("ba£Çme"è
	`__nÚnuÎ
 ((1));

604 *
	$ba£Çme
 (
__cÚ¡
 *
__f’ame
è
__THROW
 
	`__nÚnuÎ
 ((1));

610 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

611 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__OPTIMIZE_SIZE__
 \

612 && !
defšed
 
__NO_INLINE__
 && !defšed 
__ılu¥lus


632 
	~<b™s/¡ršg.h
>

635 
	~<b™s/¡ršg2.h
>

638 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


640 
	~<b™s/¡ršg3.h
>

644 
__END_DECLS


	@/usr/include/alloca.h

19 #iâdef 
_ALLOCA_H


20 
	#_ALLOCA_H
 1

	)

22 
	~<ã©u»s.h
>

24 
	#__Ãed_size_t


	)

25 
	~<¡ddef.h
>

27 
	g__BEGIN_DECLS


30 #undeà
®loÿ


33 *
	$®loÿ
 (
size_t
 
__size
è
__THROW
;

35 #ifdef 
__GNUC__


36 
	#®loÿ
(
size
è
	`__butš_®loÿ
 (size)

	)

39 
__END_DECLS


	@/usr/include/bits/huge_val.h

22 #iâdeà
_MATH_H


28 #ià
__GNUC_PREREQ
(3,3)

29 
	#HUGE_VAL
 (
	`__butš_huge_v®
())

	)

30 #–ià
__GNUC_PREREQ
(2,96)

31 
	#HUGE_VAL
 (
__ex‹nsiÚ__
 0x1.0
p2047
)

	)

32 #–ià
defšed
 
__GNUC__


34 
	#HUGE_VAL
 \

35 (
__ex‹nsiÚ__
 \

36 ((uniÚ { 
__l
 
	`__©Œibu‹__
((
	`__mode__
(
__DI__
))); 
__d
; }) \

37 { 
__l
: 0x7ff0000000000000ULL }).
__d
)

	)

41 
	~<’dŸn.h
>

43 uniÚ { 
	m__c
[8]; 
	m__d
; } 
	t__huge_v®_t
;

45 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


46 
	#__HUGE_VAL_by‹s
 { 0x7f, 0xf0, 0, 0, 0, 0, 0, 0 }

	)

48 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


49 
	#__HUGE_VAL_by‹s
 { 0, 0, 0, 0, 0, 0, 0xf0, 0x7à}

	)

52 
__huge_v®_t
 
	g__huge_v®
 = { 
__HUGE_VAL_by‹s
 };

53 
	#HUGE_VAL
 (
__huge_v®
.
__d
)

	)

	@/usr/include/bits/huge_valf.h

22 #iâdeà
_MATH_H


28 #ià
__GNUC_PREREQ
(3,3)

29 
	#HUGE_VALF
 (
	`__butš_huge_v®f
())

	)

30 #–ià
__GNUC_PREREQ
(2,96)

31 
	#HUGE_VALF
 (
__ex‹nsiÚ__
 0x1.0
p255f
)

	)

32 #–ià
defšed
 
__GNUC__


34 
	#HUGE_VALF
 \

35 (
__ex‹nsiÚ__
 \

36 ((uniÚ { 
__l
 
	`__©Œibu‹__
((
	`__mode__
(
__SI__
))); 
__d
; }) \

37 { 
__l
: 0x7f800000UL }).
__d
)

	)

41 uniÚ { 
	m__c
[4]; 
	m__f
; } 
	t__huge_v®f_t
;

43 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


44 
	#__HUGE_VALF_by‹s
 { 0x7f, 0x80, 0, 0 }

	)

46 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


47 
	#__HUGE_VALF_by‹s
 { 0, 0, 0x80, 0x7à}

	)

50 
__huge_v®f_t
 
	g__huge_v®f
 = { 
__HUGE_VALF_by‹s
 };

51 
	#HUGE_VALF
 (
__huge_v®f
.
__f
)

	)

	@/usr/include/bits/huge_vall.h

21 #iâdeà
_MATH_H


25 #ià
__GNUC_PREREQ
(3,3)

26 
	#HUGE_VALL
 (
	`__butš_huge_v®l
())

	)

28 
	#HUGE_VALL
 ((è
HUGE_VAL
)

	)

	@/usr/include/bits/inf.h

20 #iâdeà
_MATH_H


26 #ià
__GNUC_PREREQ
(3,3)

27 
	#INFINITY
 (
	`__butš_šff
())

	)

29 
	#INFINITY
 
HUGE_VALF


	)

	@/usr/include/bits/mathcalls.h

46 #iâdeà
_MATH_H


53 
_MdoubË_BEGIN_NAMESPACE


55 
__MATHCALL
 (
acos
,, (
_MdoubË_
 
__x
));

57 
__MATHCALL
 (
asš
,, (
_MdoubË_
 
__x
));

59 
__MATHCALL
 (
©ª
,, (
_MdoubË_
 
__x
));

61 
__MATHCALL
 (
©ª2
,, (
_MdoubË_
 
__y
, _MdoubË_ 
__x
));

64 
__MATHCALL
 (
cos
,, (
_MdoubË_
 
__x
));

66 
__MATHCALL
 (
sš
,, (
_MdoubË_
 
__x
));

68 
__MATHCALL
 (
n
,, (
_MdoubË_
 
__x
));

73 
__MATHCALL
 (
cosh
,, (
_MdoubË_
 
__x
));

75 
__MATHCALL
 (
sšh
,, (
_MdoubË_
 
__x
));

77 
__MATHCALL
 (
nh
,, (
_MdoubË_
 
__x
));

78 
	g_MdoubË_END_NAMESPACE


80 #ifdeà
__USE_GNU


82 
__MATHDECL
 (,
sšcos
,,

83 (
_MdoubË_
 
__x
, _MdoubË_ *
__sšx
, _MdoubË_ *
__cosx
));

86 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_ISOC99


87 
__BEGIN_NAMESPACE_C99


89 
__MATHCALL
 (
acosh
,, (
_MdoubË_
 
__x
));

91 
__MATHCALL
 (
asšh
,, (
_MdoubË_
 
__x
));

93 
__MATHCALL
 (
©ªh
,, (
_MdoubË_
 
__x
));

94 
	g__END_NAMESPACE_C99


99 
_MdoubË_BEGIN_NAMESPACE


101 
__MATHCALL
 (
exp
,, (
_MdoubË_
 
__x
));

104 
__MATHCALL
 (
äexp
,, (
_MdoubË_
 
__x
, *
__expÚ’t
));

107 
__MATHCALL
 (
ldexp
,, (
_MdoubË_
 
__x
, 
__expÚ’t
));

110 
__MATHCALL
 (
log
,, (
_MdoubË_
 
__x
));

113 
__MATHCALL
 (
log10
,, (
_MdoubË_
 
__x
));

116 
__MATHCALL
 (
modf
,, (
_MdoubË_
 
__x
, _MdoubË_ *
__Œ
));

117 
	g_MdoubË_END_NAMESPACE


119 #ifdeà
__USE_GNU


121 
__MATHCALL
 (
exp10
,, (
_MdoubË_
 
__x
));

123 
__MATHCALL
 (
pow10
,, (
_MdoubË_
 
__x
));

126 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_ISOC99


127 
__BEGIN_NAMESPACE_C99


129 
__MATHCALL
 (
expm1
,, (
_MdoubË_
 
__x
));

132 
__MATHCALL
 (
log1p
,, (
_MdoubË_
 
__x
));

135 
__MATHCALL
 (
logb
,, (
_MdoubË_
 
__x
));

136 
	g__END_NAMESPACE_C99


139 #ifdeà
__USE_ISOC99


140 
__BEGIN_NAMESPACE_C99


142 
__MATHCALL
 (
exp2
,, (
_MdoubË_
 
__x
));

145 
__MATHCALL
 (
log2
,, (
_MdoubË_
 
__x
));

146 
	g__END_NAMESPACE_C99


152 
_MdoubË_BEGIN_NAMESPACE


154 
__MATHCALL
 (
pow
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

157 
__MATHCALL
 (
sq¹
,, (
_MdoubË_
 
__x
));

158 
	g_MdoubË_END_NAMESPACE


160 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN
 || defšed 
__USE_ISOC99


161 
__BEGIN_NAMESPACE_C99


163 
__MATHCALL
 (
hypÙ
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

164 
	g__END_NAMESPACE_C99


167 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_ISOC99


168 
__BEGIN_NAMESPACE_C99


170 
__MATHCALL
 (
cb¹
,, (
_MdoubË_
 
__x
));

171 
	g__END_NAMESPACE_C99


177 
_MdoubË_BEGIN_NAMESPACE


179 
__MATHCALLX
 (
û
,, (
_MdoubË_
 
__x
), (
__cÚ¡__
));

182 
__MATHCALLX
 (
çbs
,, (
_MdoubË_
 
__x
), (
__cÚ¡__
));

185 
__MATHCALLX
 (
æoÜ
,, (
_MdoubË_
 
__x
), (
__cÚ¡__
));

188 
__MATHCALL
 (
fmod
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

193 
__MATHDECL_1
 (,
__isšf
,, (
_MdoubË_
 
__v®ue
)è
__©Œibu‹__
 ((
__cÚ¡__
));

196 
__MATHDECL_1
 (,
__fš™e
,, (
_MdoubË_
 
__v®ue
)è
__©Œibu‹__
 ((
__cÚ¡__
));

197 
	g_MdoubË_END_NAMESPACE


199 #ifdeà
__USE_MISC


202 
__MATHDECL_1
 (,
isšf
,, (
_MdoubË_
 
__v®ue
)è
__©Œibu‹__
 ((
__cÚ¡__
));

205 
__MATHDECL_1
 (,
fš™e
,, (
_MdoubË_
 
__v®ue
)è
__©Œibu‹__
 ((
__cÚ¡__
));

208 
__MATHCALL
 (
d»m
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

212 
__MATHCALL
 (
signifiÿnd
,, (
_MdoubË_
 
__x
));

215 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_ISOC99


216 
__BEGIN_NAMESPACE_C99


218 
__MATHCALLX
 (
cİysign
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
), (
__cÚ¡__
));

219 
	g__END_NAMESPACE_C99


222 #ifdeà
__USE_ISOC99


223 
__BEGIN_NAMESPACE_C99


225 
__MATHCALLX
 (
Çn
,, (
__cÚ¡
 *
__gb
), (
__cÚ¡__
));

226 
	g__END_NAMESPACE_C99


231 
__MATHDECL_1
 (,
__i¢ª
,, (
_MdoubË_
 
__v®ue
)è
__©Œibu‹__
 ((
__cÚ¡__
));

233 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


235 
__MATHDECL_1
 (,
i¢ª
,, (
_MdoubË_
 
__v®ue
)è
__©Œibu‹__
 ((
__cÚ¡__
));

238 
__MATHCALL
 (
j0
,, (
_MdoubË_
));

239 
__MATHCALL
 (
j1
,, (
_MdoubË_
));

240 
__MATHCALL
 (
jn
,, (, 
_MdoubË_
));

241 
__MATHCALL
 (
y0
,, (
_MdoubË_
));

242 
__MATHCALL
 (
y1
,, (
_MdoubË_
));

243 
__MATHCALL
 (
yn
,, (, 
_MdoubË_
));

247 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN
 || defšed 
__USE_ISOC99


248 
__BEGIN_NAMESPACE_C99


250 
__MATHCALL
 (
”f
,, (
_MdoubË_
));

251 
__MATHCALL
 (
”fc
,, (
_MdoubË_
));

252 
__MATHCALL
 (
lgamma
,, (
_MdoubË_
));

253 
	g__END_NAMESPACE_C99


256 #ifdeà
__USE_ISOC99


257 
__BEGIN_NAMESPACE_C99


259 
__MATHCALL
 (
tgamma
,, (
_MdoubË_
));

260 
	g__END_NAMESPACE_C99


263 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


265 
__MATHCALL
 (
gamma
,, (
_MdoubË_
));

268 #ifdeà
__USE_MISC


272 
__MATHCALL
 (
lgamma
,
_r
, (
_MdoubË_
, *
__signgamp
));

276 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_ISOC99


277 
__BEGIN_NAMESPACE_C99


280 
__MATHCALL
 (
ršt
,, (
_MdoubË_
 
__x
));

283 
__MATHCALLX
 (
Ãxá”
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
), (
__cÚ¡__
));

284 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__LDBL_COMPAT


285 
__MATHCALLX
 (
Ãx‰ow¬d
,, (
_MdoubË_
 
__x
, 
__y
), (
__cÚ¡__
));

289 
__MATHCALL
 (
»mašd”
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

291 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_ISOC99


293 
__MATHCALL
 (
sÿlbn
,, (
_MdoubË_
 
__x
, 
__n
));

297 
__MATHDECL
 (,
ogb
,, (
_MdoubË_
 
__x
));

300 #ifdeà
__USE_ISOC99


302 
__MATHCALL
 (
sÿlbÊ
,, (
_MdoubË_
 
__x
, 
__n
));

306 
__MATHCALL
 (
Ã¬byšt
,, (
_MdoubË_
 
__x
));

310 
__MATHCALLX
 (
round
,, (
_MdoubË_
 
__x
), (
__cÚ¡__
));

314 
__MATHCALLX
 (
Œunc
,, (
_MdoubË_
 
__x
), (
__cÚ¡__
));

319 
__MATHCALL
 (
»mquo
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
, *
__quo
));

326 
__MATHDECL
 (,
Ìšt
,, (
_MdoubË_
 
__x
));

327 
__MATHDECL
 (,
Îršt
,, (
_MdoubË_
 
__x
));

331 
__MATHDECL
 (,
Ìound
,, (
_MdoubË_
 
__x
));

332 
__MATHDECL
 (,
Îround
,, (
_MdoubË_
 
__x
));

336 
__MATHCALL
 (
fdim
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

339 
__MATHCALL
 (
fmax
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

342 
__MATHCALL
 (
fmš
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

346 
__MATHDECL_1
 (, 
__åşassify
,, (
_MdoubË_
 
__v®ue
))

347 
__©Œibu‹__
 ((
__cÚ¡__
));

350 
__MATHDECL_1
 (, 
__signb™
,, (
_MdoubË_
 
__v®ue
))

351 
__©Œibu‹__
 ((
__cÚ¡__
));

355 
__MATHCALL
 (
fma
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
, _MdoubË_ 
__z
));

358 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_ISOC99


359 
	g__END_NAMESPACE_C99


362 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


364 
__MATHCALL
 (
sÿlb
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__n
));

	@/usr/include/bits/mathdef.h

19 #ià!
defšed
 
_MATH_H
 && !defšed 
_COMPLEX_H


23 #ià
defšed
 
__USE_ISOC99
 && defšed 
_MATH_H
 && !defšed 
_MATH_H_MATHDEF


24 
	#_MATH_H_MATHDEF
 1

	)

26 
	~<b™s/wÜdsize.h
>

28 #ià
__WORDSIZE
 =ğ64 || (
defšed
 
__FLT_EVAL_METHOD__
 && __FLT_EVAL_METHOD__ == 0)

31 
	tæßt_t
;

32 
	tdoubË_t
;

38 
	tæßt_t
;

40 
	tdoubË_t
;

45 
	#FP_ILOGB0
 (-2147483647 - 1)

	)

46 
	#FP_ILOGBNAN
 (-2147483647 - 1)

	)

	@/usr/include/bits/mathinline.h

21 #iâdeà
_MATH_H


25 #iâdeà
__ex‹º_šlše


26 
	#__MATH_INLINE
 
__šlše


	)

28 
	#__MATH_INLINE
 
__ex‹º_šlše


	)

32 #ià
defšed
 
__USE_ISOC99
 && defšed 
__GNUC__
 && __GNUC__ >= 2

35 
__MATH_INLINE
 

36 
__NTH
 (
	$__signb™f
 (
__x
))

38 
__ex‹nsiÚ__
 uniÚ { 
__f
; 
__i
; } 
__u
 = { __f: 
__x
 };

39  
__u
.
__i
 < 0;

40 
	}
}

41 
__MATH_INLINE
 

42 
__NTH
 (
	$__signb™
 (
__x
))

44 
__ex‹nsiÚ__
 uniÚ { 
__d
; 
__i
[2]; } 
__u
 = { __d: 
__x
 };

45  
__u
.
__i
[1] < 0;

46 
	}
}

47 
__MATH_INLINE
 

48 
__NTH
 (
	$__signb™l
 (
__x
))

50 
__ex‹nsiÚ__
 uniÚ { 
__l
; 
__i
[3]; } 
__u
 = { __l: 
__x
 };

51  (
__u
.
__i
[2] & 0x8000) != 0;

52 
	}
}

	@/usr/include/bits/nan.h

20 #iâdeà
_MATH_H


27 #ià
__GNUC_PREREQ
(3,3)

29 
	#NAN
 (
	`__butš_Çnf
 (""))

	)

31 #–ià
defšed
 
__GNUC__


33 
	#NAN
 \

34 (
__ex‹nsiÚ__
 \

35 ((uniÚ { 
__l
 
	`__©Œibu‹__
 ((
	`__mode__
 (
__SI__
))); 
__d
; }) \

36 { 
__l
: 0x7fc00000UL }).
__d
)

	)

40 
	~<’dŸn.h
>

42 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


43 
	#__Çn_by‹s
 { 0x7f, 0xc0, 0, 0 }

	)

45 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


46 
	#__Çn_by‹s
 { 0, 0, 0xc0, 0x7à}

	)

49 uniÚ { 
	m__c
[4]; 
	m__d
; } 
__Çn_uniÚ


50 
	g__©Œibu‹_u£d__
 = { 
__Çn_by‹s
 };

51 
	#NAN
 (
__Çn_uniÚ
.
__d
)

	)

	@/usr/include/bits/stdio-ldbl.h

20 #iâdeà
_STDIO_H


24 
__BEGIN_NAMESPACE_STD


25 
	$__LDBL_REDIR_DECL
 (
årštf
)

26 
	$__LDBL_REDIR_DECL
 (
´štf
)

27 
	$__LDBL_REDIR_DECL
 (
¥rštf
)

28 
	$__LDBL_REDIR_DECL
 (
vårštf
)

29 
	$__LDBL_REDIR_DECL
 (
v´štf
)

30 
	$__LDBL_REDIR_DECL
 (
v¥rštf
)

31 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

32 && !
defšed
 
__REDIRECT
 \

33 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

34 
	$__LDBL_REDIR1_DECL
 (
fsÿnf
, 
__Ædbl___isoc99_fsÿnf
)

35 
	$__LDBL_REDIR1_DECL
 (
sÿnf
, 
__Ædbl___isoc99_sÿnf
)

36 
	$__LDBL_REDIR1_DECL
 (
ssÿnf
, 
__Ædbl___isoc99_ssÿnf
)

38 
	$__LDBL_REDIR_DECL
 (
fsÿnf
)

39 
	$__LDBL_REDIR_DECL
 (
sÿnf
)

40 
	$__LDBL_REDIR_DECL
 (
ssÿnf
)

42 
__END_NAMESPACE_STD


44 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_ISOC99
 || defšed 
__USE_UNIX98


45 
__BEGIN_NAMESPACE_C99


46 
	$__LDBL_REDIR_DECL
 (
¢´štf
)

47 
	$__LDBL_REDIR_DECL
 (
v¢´štf
)

48 
__END_NAMESPACE_C99


51 #ifdef 
__USE_ISOC99


52 
__BEGIN_NAMESPACE_C99


53 #ià!
defšed
 
__USE_GNU
 && !defšed 
__REDIRECT
 \

54 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

55 
	$__LDBL_REDIR1_DECL
 (
vfsÿnf
, 
__Ædbl___isoc99_vfsÿnf
)

56 
	$__LDBL_REDIR1_DECL
 (
vsÿnf
, 
__Ædbl___isoc99_vsÿnf
)

57 
	$__LDBL_REDIR1_DECL
 (
vssÿnf
, 
__Ædbl___isoc99_vssÿnf
)

59 
	$__LDBL_REDIR_DECL
 (
vfsÿnf
)

60 
	$__LDBL_REDIR_DECL
 (
vssÿnf
)

61 
	$__LDBL_REDIR_DECL
 (
vsÿnf
)

63 
__END_NAMESPACE_C99


66 #ifdeà
__USE_GNU


67 
	$__LDBL_REDIR_DECL
 (
vd´štf
)

68 
	$__LDBL_REDIR_DECL
 (
d´štf
)

69 
	$__LDBL_REDIR_DECL
 (
va¥rštf
)

70 
	$__LDBL_REDIR_DECL
 (
__a¥rštf
)

71 
	$__LDBL_REDIR_DECL
 (
a¥rštf
)

72 
	$__LDBL_REDIR_DECL
 (
ob¡ack_´štf
)

73 
	$__LDBL_REDIR_DECL
 (
ob¡ack_v´štf
)

76 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


77 
	$__LDBL_REDIR_DECL
 (
__¥rštf_chk
)

78 
	$__LDBL_REDIR_DECL
 (
__v¥rštf_chk
)

79 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_ISOC99
 || defšed 
__USE_UNIX98


80 
	$__LDBL_REDIR_DECL
 (
__¢´štf_chk
)

81 
	$__LDBL_REDIR_DECL
 (
__v¢´štf_chk
)

83 #ià
__USE_FORTIFY_LEVEL
 > 1

84 
	$__LDBL_REDIR_DECL
 (
__årštf_chk
)

85 
	$__LDBL_REDIR_DECL
 (
__´štf_chk
)

86 
	$__LDBL_REDIR_DECL
 (
__vårštf_chk
)

87 
	$__LDBL_REDIR_DECL
 (
__v´štf_chk
)

88 #ifdeà
__USE_GNU


89 
	$__LDBL_REDIR_DECL
 (
__a¥rštf_chk
)

90 
	$__LDBL_REDIR_DECL
 (
__va¥rštf_chk
)

91 
	$__LDBL_REDIR_DECL
 (
__d´štf_chk
)

92 
	$__LDBL_REDIR_DECL
 (
__vd´štf_chk
)

93 
	$__LDBL_REDIR_DECL
 (
__ob¡ack_´štf_chk
)

94 
	$__LDBL_REDIR_DECL
 (
__ob¡ack_v´štf_chk
)

	@/usr/include/bits/stdio.h

20 #iâdeà
_STDIO_H


24 #iâdeà
__ex‹º_šlše


25 
	#__STDIO_INLINE
 
šlše


	)

27 
	#__STDIO_INLINE
 
__ex‹º_šlše


	)

31 #ifdeà
__USE_EXTERN_INLINES


34 #ià!(
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše
)

36 
__STDIO_INLINE
 

37 
	$v´štf
 (
__cÚ¡
 *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__¬g
)

39  
	`vårštf
 (
¡dout
, 
__fmt
, 
__¬g
);

40 
	}
}

44 
__STDIO_INLINE
 

45 
	$g‘ch¬
 ()

47  
	`_IO_g‘c
 (
¡dš
);

48 
	}
}

51 #ifdeà
__USE_MISC


53 
__STDIO_INLINE
 

54 
	$fg‘c_uÆocked
 (
FILE
 *
__å
)

56  
	`_IO_g‘c_uÆocked
 (
__å
);

57 
	}
}

61 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


63 
__STDIO_INLINE
 

64 
	$g‘c_uÆocked
 (
FILE
 *
__å
)

66  
	`_IO_g‘c_uÆocked
 (
__å
);

67 
	}
}

70 
__STDIO_INLINE
 

71 
	$g‘ch¬_uÆocked
 ()

73  
	`_IO_g‘c_uÆocked
 (
¡dš
);

74 
	}
}

79 
__STDIO_INLINE
 

80 
	$putch¬
 (
__c
)

82  
	`_IO_putc
 (
__c
, 
¡dout
);

83 
	}
}

86 #ifdeà
__USE_MISC


88 
__STDIO_INLINE
 

89 
	$åutc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
)

91  
	`_IO_putc_uÆocked
 (
__c
, 
__¡»am
);

92 
	}
}

96 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


98 
__STDIO_INLINE
 

99 
	$putc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
)

101  
	`_IO_putc_uÆocked
 (
__c
, 
__¡»am
);

102 
	}
}

105 
__STDIO_INLINE
 

106 
	$putch¬_uÆocked
 (
__c
)

108  
	`_IO_putc_uÆocked
 (
__c
, 
¡dout
);

109 
	}
}

113 #ifdef 
__USE_GNU


115 
__STDIO_INLINE
 
_IO_ssize_t


116 
	$g‘lše
 (**
__lš•Œ
, 
size_t
 *
__n
, 
FILE
 *
__¡»am
)

118  
	`__g‘d–im
 (
__lš•Œ
, 
__n
, '\n', 
__¡»am
);

119 
	}
}

123 #ifdeà
__USE_MISC


125 
__STDIO_INLINE
 

126 
__NTH
 (
	$ãof_uÆocked
 (
FILE
 *
__¡»am
))

128  
	`_IO_ãof_uÆocked
 (
__¡»am
);

129 
	}
}

132 
__STDIO_INLINE
 

133 
__NTH
 (
	$ã¼Ü_uÆocked
 (
FILE
 *
__¡»am
))

135  
	`_IO_ã¼Ü_uÆocked
 (
__¡»am
);

136 
	}
}

142 #ià
defšed
 
__USE_MISC
 && defšed 
__GNUC__
 && defšed 
__OPTIMIZE__
 \

143 && !
defšed
 
	g__ılu¥lus


145 
	#ä—d_uÆocked
(
±r
, 
size
, 
n
, 
¡»am
) \

146 (
	`__ex‹nsiÚ__
 ((
	`__butš_cÚ¡ªt_p
 (
size
è&& __butš_cÚ¡ªt_°(
n
) \

147 && (
size_t
è(
size
è* (size_tè(
n
) <= 8 \

148 && (
size_t
è(
size
) != 0) \

149 ? ({ *
__±r
 = (*è(
±r
); \

150 
FILE
 *
__¡»am
 = (
¡»am
); \

151 
size_t
 
__út
; \

152 
__út
 = (
size_t
è(
size
è* (size_tè(
n
); \

153 
__út
 > 0; --__cnt) \

155 
__c
 = 
	`_IO_g‘c_uÆocked
 (
__¡»am
); \

156 ià(
__c
 =ğ
EOF
) \

158 *
__±r
++ = 
__c
; \

160 ((
size_t
è(
size
è* (size_tè(
n
è- 
__út
) \

161 / (
size_t
è(
size
); }) \

162 : (((
	`__butš_cÚ¡ªt_p
 (
size
è&& (
size_t
) (size) == 0) \

163 || (
	`__butš_cÚ¡ªt_p
 (
n
è&& (
size_t
) (n) == 0)) \

165 ? ((è(
±r
), (è(
¡»am
), (è(
size
), \

166 (è(
n
), (
size_t
) 0) \

167 : 
	`ä—d_uÆocked
 (
±r
, 
size
, 
n
, 
¡»am
))))

	)

169 
	#fwr™e_uÆocked
(
±r
, 
size
, 
n
, 
¡»am
) \

170 (
	`__ex‹nsiÚ__
 ((
	`__butš_cÚ¡ªt_p
 (
size
è&& __butš_cÚ¡ªt_°(
n
) \

171 && (
size_t
è(
size
è* (size_tè(
n
) <= 8 \

172 && (
size_t
è(
size
) != 0) \

173 ? ({ cÚ¡ *
__±r
 = (cÚ¡ *è(
±r
); \

174 
FILE
 *
__¡»am
 = (
¡»am
); \

175 
size_t
 
__út
; \

176 
__út
 = (
size_t
è(
size
è* (size_tè(
n
); \

177 
__út
 > 0; --__cnt) \

178 ià(
	`_IO_putc_uÆocked
 (*
__±r
++, 
__¡»am
è=ğ
EOF
) \

180 ((
size_t
è(
size
è* (size_tè(
n
è- 
__út
) \

181 / (
size_t
è(
size
); }) \

182 : (((
	`__butš_cÚ¡ªt_p
 (
size
è&& (
size_t
) (size) == 0) \

183 || (
	`__butš_cÚ¡ªt_p
 (
n
è&& (
size_t
) (n) == 0)) \

185 ? ((è(
±r
), (è(
¡»am
), (è(
size
), \

186 (è(
n
), (
size_t
) 0) \

187 : 
	`fwr™e_uÆocked
 (
±r
, 
size
, 
n
, 
¡»am
))))

	)

191 #undeà
__STDIO_INLINE


	@/usr/include/bits/stdio2.h

20 #iâdeà
_STDIO_H


24 
	$__¥rštf_chk
 (*
__»¡riù
 
__s
, 
__æag
, 
size_t
 
__¦’
,

25 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

26 
	$__v¥rštf_chk
 (*
__»¡riù
 
__s
, 
__æag
, 
size_t
 
__¦’
,

27 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

28 
_G_va_li¡
 
__­
è
__THROW
;

30 #ifdeà
__va_¬g_·ck


31 
__ex‹º_®ways_šlše
 

32 
	`__NTH
 (
	$¥rštf
 (*
__»¡riù
 
__s
, 
__cÚ¡
 *__»¡riù 
__fmt
, ...))

34  
	`__butš___¥rštf_chk
 (
__s
, 
__USE_FORTIFY_LEVEL
 - 1,

35 
	`__bos
 (
__s
), 
__fmt
, 
	`__va_¬g_·ck
 ());

36 
	}
}

37 #–ià!
defšed
 
__ılu¥lus


38 
	#¥rštf
(
¡r
, ...) \

39 
	`__butš___¥rštf_chk
 (
¡r
, 
__USE_FORTIFY_LEVEL
 - 1, 
	`__bos
 (str), \

40 
__VA_ARGS__
)

	)

43 
__ex‹º_®ways_šlše
 

44 
__NTH
 (
	$v¥rštf
 (*
__»¡riù
 
__s
, 
__cÚ¡
 *__»¡riù 
__fmt
,

45 
_G_va_li¡
 
__­
))

47  
	`__butš___v¥rštf_chk
 (
__s
, 
__USE_FORTIFY_LEVEL
 - 1,

48 
	`__bos
 (
__s
), 
__fmt
, 
__­
);

49 
	}
}

51 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_ISOC99
 || defšed 
__USE_UNIX98


53 
	$__¢´štf_chk
 (*
__»¡riù
 
__s
, 
size_t
 
__n
, 
__æag
,

54 
size_t
 
__¦’
, 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

55 ...è
__THROW
;

56 
	$__v¢´štf_chk
 (*
__»¡riù
 
__s
, 
size_t
 
__n
, 
__æag
,

57 
size_t
 
__¦’
, 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

58 
_G_va_li¡
 
__­
è
__THROW
;

60 #ifdeà
__va_¬g_·ck


61 
__ex‹º_®ways_šlše
 

62 
	`__NTH
 (
	$¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__n
,

63 
__cÚ¡
 *
__»¡riù
 
__fmt
, ...))

65  
	`__butš___¢´štf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

66 
	`__bos
 (
__s
), 
__fmt
, 
	`__va_¬g_·ck
 ());

67 
	}
}

68 #–ià!
defšed
 
__ılu¥lus


69 
	#¢´štf
(
¡r
, 
Ën
, ...) \

70 
	`__butš___¢´štf_chk
 (
¡r
, 
Ën
, 
__USE_FORTIFY_LEVEL
 - 1, 
	`__bos
 (str), \

71 
__VA_ARGS__
)

	)

74 
__ex‹º_®ways_šlše
 

75 
__NTH
 (
	$v¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__n
,

76 
__cÚ¡
 *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__­
))

78  
	`__butš___v¢´štf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

79 
	`__bos
 (
__s
), 
__fmt
, 
__­
);

80 
	}
}

84 #ià
__USE_FORTIFY_LEVEL
 > 1

86 
__årštf_chk
 (
FILE
 *
__»¡riù
 
__¡»am
, 
__æag
,

87 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...);

88 
__´štf_chk
 (
__æag
, 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...);

89 
__vårštf_chk
 (
FILE
 *
__»¡riù
 
__¡»am
, 
__æag
,

90 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__­
);

91 
__v´štf_chk
 (
__æag
, 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

92 
_G_va_li¡
 
__­
);

94 #ifdeà
__va_¬g_·ck


95 
__ex‹º_®ways_šlše
 

96 
	$årštf
 (
FILE
 *
__»¡riù
 
__¡»am
, 
__cÚ¡
 *__»¡riù 
__fmt
, ...)

98  
	`__årštf_chk
 (
__¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

99 
	`__va_¬g_·ck
 ());

100 
	}
}

102 
__ex‹º_®ways_šlše
 

103 
	$´štf
 (
__cÚ¡
 *
__»¡riù
 
__fmt
, ...)

105  
	`__´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
	`__va_¬g_·ck
 ());

106 
	}
}

107 #–ià!
defšed
 
__ılu¥lus


108 
	#´štf
(...) \

109 
	`__´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

110 
	#årštf
(
¡»am
, ...) \

111 
	`__årštf_chk
 (
¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

114 
__ex‹º_®ways_šlše
 

115 
	$v´štf
 (
__cÚ¡
 *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__­
)

117 #ifdeà
__USE_EXTERN_INLINES


118  
	`__vårštf_chk
 (
¡dout
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

120  
	`__v´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

122 
	}
}

124 
__ex‹º_®ways_šlše
 

125 
	$vårštf
 (
FILE
 *
__»¡riù
 
__¡»am
,

126 
__cÚ¡
 *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__­
)

128  
	`__vårštf_chk
 (
__¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

129 
	}
}

131 #ifdeà
__USE_GNU


133 
	$__a¥rštf_chk
 (**
__»¡riù
 
__±r
, 
__æag
,

134 
__cÚ¡
 *
__»¡riù
 
__fmt
, ...)

135 
__THROW
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 3, 4))è
__wur
;

136 
	$__va¥rštf_chk
 (**
__»¡riù
 
__±r
, 
__æag
,

137 
__cÚ¡
 *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__¬g
)

138 
__THROW
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 3, 0))è
__wur
;

139 
	$__d´štf_chk
 (
__fd
, 
__æag
, 
__cÚ¡
 *
__»¡riù
 
__fmt
,

140 ...è
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 4)));

141 
	$__vd´štf_chk
 (
__fd
, 
__æag
,

142 
__cÚ¡
 *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__¬g
)

143 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 0)));

144 
	$__ob¡ack_´štf_chk
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

145 
__æag
, 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

147 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 4)));

148 
	$__ob¡ack_v´štf_chk
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

149 
__æag
,

150 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

151 
_G_va_li¡
 
__¬gs
)

152 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 0)));

154 #ifdeà
__va_¬g_·ck


155 
__ex‹º_®ways_šlše
 

156 
	`__NTH
 (
	$a¥rštf
 (**
__»¡riù
 
__±r
, 
__cÚ¡
 *__»¡riù 
__fmt
, ...))

158  
	`__a¥rštf_chk
 (
__±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

159 
	`__va_¬g_·ck
 ());

160 
	}
}

162 
__ex‹º_®ways_šlše
 

163 
__NTH
 (
	$__a¥rštf
 (**
__»¡riù
 
__±r
, 
__cÚ¡
 *__»¡riù 
__fmt
,

166  
	`__a¥rštf_chk
 (
__±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

167 
	`__va_¬g_·ck
 ());

168 
	}
}

170 
__ex‹º_®ways_šlše
 

171 
	$d´štf
 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__fmt
, ...)

173  
	`__d´štf_chk
 (
__fd
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

174 
	`__va_¬g_·ck
 ());

175 
	}
}

177 
__ex‹º_®ways_šlše
 

178 
__NTH
 (
	$ob¡ack_´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

179 
__cÚ¡
 *
__»¡riù
 
__fmt
, ...))

181  
	`__ob¡ack_´štf_chk
 (
__ob¡ack
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

182 
	`__va_¬g_·ck
 ());

183 
	}
}

184 #–ià!
defšed
 
__ılu¥lus


185 
	#a¥rštf
(
±r
, ...) \

186 
	`__a¥rštf_chk
 (
±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

187 
	#__a¥rštf
(
±r
, ...) \

188 
	`__a¥rštf_chk
 (
±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

189 
	#d´štf
(
fd
, ...) \

190 
	`__d´štf_chk
 (
fd
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

191 
	#ob¡ack_´štf
(
ob¡ack
, ...) \

192 
	`__ob¡ack_´štf_chk
 (
ob¡ack
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

195 
__ex‹º_®ways_šlše
 

196 
__NTH
 (
	$va¥rštf
 (**
__»¡riù
 
__±r
, 
__cÚ¡
 *__»¡riù 
__fmt
,

197 
_G_va_li¡
 
__­
))

199  
	`__va¥rštf_chk
 (
__±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

200 
	}
}

202 
__ex‹º_®ways_šlše
 

203 
	$vd´štf
 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__­
)

205  
	`__vd´štf_chk
 (
__fd
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

206 
	}
}

208 
__ex‹º_®ways_šlše
 

209 
__NTH
 (
	$ob¡ack_v´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

210 
__cÚ¡
 *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__­
))

212  
	`__ob¡ack_v´štf_chk
 (
__ob¡ack
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

213 
__­
);

214 
	}
}

220 *
	$__g‘s_chk
 (*
__¡r
, 
size_t
è
__wur
;

221 *
	`__REDIRECT
 (
__g‘s_w¬n
, (*
__¡r
), 
g‘s
)

222 
__wur
 
	`__w¬Ç‰r
 ("please use fgets or getline instead, gets can't "

225 
__ex‹º_®ways_šlše
 
__wur
 *

226 
	$g‘s
 (*
__¡r
)

228 ià(
	`__bos
 (
__¡r
è!ğ(
size_t
) -1)

229  
	`__g‘s_chk
 (
__¡r
, 
	`__bos
 (__str));

230  
	`__g‘s_w¬n
 (
__¡r
);

231 
	}
}

233 *
	$__fg‘s_chk
 (*
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

234 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

235 *
	`__REDIRECT
 (
__fg‘s_®Ÿs
,

236 (*
__»¡riù
 
__s
, 
__n
,

237 
FILE
 *
__»¡riù
 
__¡»am
), 
fg‘s
è
__wur
;

238 *
	`__REDIRECT
 (
__fg‘s_chk_w¬n
,

239 (*
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

240 
FILE
 *
__»¡riù
 
__¡»am
), 
__fg‘s_chk
)

241 
__wur
 
	`__w¬Ç‰r
 ("fgets called with bigger sizehan†ength "

244 
__ex‹º_®ways_šlše
 
__wur
 *

245 
	$fg‘s
 (*
__»¡riù
 
__s
, 
__n
, 
FILE
 *__»¡riù 
__¡»am
)

247 ià(
	`__bos
 (
__s
è!ğ(
size_t
) -1)

249 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
) || __n <= 0)

250  
	`__fg‘s_chk
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__¡»am
);

252 ià((
size_t
è
__n
 > 
	`__bos
 (
__s
))

253  
	`__fg‘s_chk_w¬n
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__¡»am
);

255  
	`__fg‘s_®Ÿs
 (
__s
, 
__n
, 
__¡»am
);

256 
	}
}

258 
size_t
 
	$__ä—d_chk
 (*
__»¡riù
 
__±r
, 
size_t
 
__±¾’
,

259 
size_t
 
__size
, size_ˆ
__n
,

260 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

261 
size_t
 
	`__REDIRECT
 (
__ä—d_®Ÿs
,

262 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

263 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
),

264 
ä—d
è
__wur
;

265 
size_t
 
	`__REDIRECT
 (
__ä—d_chk_w¬n
,

266 (*
__»¡riù
 
__±r
, 
size_t
 
__±¾’
,

267 
size_t
 
__size
, size_ˆ
__n
,

268 
FILE
 *
__»¡riù
 
__¡»am
),

269 
__ä—d_chk
)

270 
__wur
 
	`__w¬Ç‰r
 ("fread called with bigger size *‚membhan†ength "

273 
__ex‹º_®ways_šlše
 
__wur
 
size_t


274 
	$ä—d
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
, size_ˆ
__n
,

275 
FILE
 *
__»¡riù
 
__¡»am
)

277 ià(
	`__bos0
 (
__±r
è!ğ(
size_t
) -1)

279 ià(!
	`__butš_cÚ¡ªt_p
 (
__size
)

280 || !
	`__butš_cÚ¡ªt_p
 (
__n
)

281 || (
__size
 | 
__n
è>ğ(((
size_t
) 1) << (8 *  (size_t) / 2)))

282  
	`__ä—d_chk
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
, 
__¡»am
);

284 ià(
__size
 * 
__n
 > 
	`__bos0
 (
__±r
))

285  
	`__ä—d_chk_w¬n
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
, 
__¡»am
);

287  
	`__ä—d_®Ÿs
 (
__±r
, 
__size
, 
__n
, 
__¡»am
);

288 
	}
}

290 #ifdeà
__USE_GNU


291 *
	$__fg‘s_uÆocked_chk
 (*
__»¡riù
 
__s
, 
size_t
 
__size
,

292 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

293 *
	`__REDIRECT
 (
__fg‘s_uÆocked_®Ÿs
,

294 (*
__»¡riù
 
__s
, 
__n
,

295 
FILE
 *
__»¡riù
 
__¡»am
), 
fg‘s_uÆocked
è
__wur
;

296 *
	`__REDIRECT
 (
__fg‘s_uÆocked_chk_w¬n
,

297 (*
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

298 
FILE
 *
__»¡riù
 
__¡»am
), 
__fg‘s_uÆocked_chk
)

299 
__wur
 
	`__w¬Ç‰r
 ("fgets_unlocked called with bigger sizehan†ength "

302 
__ex‹º_®ways_šlše
 
__wur
 *

303 
	$fg‘s_uÆocked
 (*
__»¡riù
 
__s
, 
__n
, 
FILE
 *__»¡riù 
__¡»am
)

305 ià(
	`__bos
 (
__s
è!ğ(
size_t
) -1)

307 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
) || __n <= 0)

308  
	`__fg‘s_uÆocked_chk
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__¡»am
);

310 ià((
size_t
è
__n
 > 
	`__bos
 (
__s
))

311  
	`__fg‘s_uÆocked_chk_w¬n
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__¡»am
);

313  
	`__fg‘s_uÆocked_®Ÿs
 (
__s
, 
__n
, 
__¡»am
);

314 
	}
}

317 #ifdeà
__USE_MISC


318 #undeà
ä—d_uÆocked


319 
size_t
 
	$__ä—d_uÆocked_chk
 (*
__»¡riù
 
__±r
, 
size_t
 
__±¾’
,

320 
size_t
 
__size
, size_ˆ
__n
,

321 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

322 
size_t
 
	`__REDIRECT
 (
__ä—d_uÆocked_®Ÿs
,

323 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

324 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
),

325 
ä—d_uÆocked
è
__wur
;

326 
size_t
 
	`__REDIRECT
 (
__ä—d_uÆocked_chk_w¬n
,

327 (*
__»¡riù
 
__±r
, 
size_t
 
__±¾’
,

328 
size_t
 
__size
, size_ˆ
__n
,

329 
FILE
 *
__»¡riù
 
__¡»am
),

330 
__ä—d_uÆocked_chk
)

331 
__wur
 
	`__w¬Ç‰r
 ("fread_unlocked called with bigger size *‚membhan "

334 
__ex‹º_®ways_šlše
 
__wur
 
size_t


335 
	$ä—d_uÆocked
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
, size_ˆ
__n
,

336 
FILE
 *
__»¡riù
 
__¡»am
)

338 ià(
	`__bos0
 (
__±r
è!ğ(
size_t
) -1)

340 ià(!
	`__butš_cÚ¡ªt_p
 (
__size
)

341 || !
	`__butš_cÚ¡ªt_p
 (
__n
)

342 || (
__size
 | 
__n
è>ğ(((
size_t
) 1) << (8 *  (size_t) / 2)))

343  
	`__ä—d_uÆocked_chk
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
,

344 
__¡»am
);

346 ià(
__size
 * 
__n
 > 
	`__bos0
 (
__±r
))

347  
	`__ä—d_uÆocked_chk_w¬n
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
,

348 
__¡»am
);

351 #ifdeà
__USE_EXTERN_INLINES


352 ià(
	`__butš_cÚ¡ªt_p
 (
__size
)

353 && 
	`__butš_cÚ¡ªt_p
 (
__n
)

354 && (
__size
 | 
__n
è< (((
size_t
) 1) << (8 *  (size_t) / 2))

355 && 
__size
 * 
__n
 <= 8)

357 
size_t
 
__út
 = 
__size
 * 
__n
;

358 *
__ıŒ
 = (*è
__±r
;

359 ià(
__út
 == 0)

362 ; 
__út
 > 0; --__cnt)

364 
__c
 = 
	`_IO_g‘c_uÆocked
 (
__¡»am
);

365 ià(
__c
 =ğ
EOF
)

367 *
__ıŒ
++ = 
__c
;

369  (
__ıŒ
 - (*è
__±r
è/ 
__size
;

372  
	`__ä—d_uÆocked_®Ÿs
 (
__±r
, 
__size
, 
__n
, 
__¡»am
);

373 
	}
}

	@/usr/include/bits/stdio_lim.h

19 #ià!
defšed
 
_STDIO_H
 && !defšed 
__Ãed_FOPEN_MAX
 && !defšed 
__Ãed_IOV_MAX


23 #ifdeà
_STDIO_H


24 
	#L_tm²am
 20

	)

25 
	#TMP_MAX
 238328

	)

26 
	#FILENAME_MAX
 4096

	)

28 #ifdeà
__USE_POSIX


29 
	#L_ù”mid
 9

	)

30 #ià!
defšed
 
__USE_XOPEN2K
 || defšed 
__USE_GNU


31 
	#L_cu£rid
 9

	)

36 #ià
defšed
 
__Ãed_FOPEN_MAX
 || defšed 
_STDIO_H


37 #undeà
FOPEN_MAX


38 
	#FOPEN_MAX
 16

	)

41 #ià
defšed
 
__Ãed_IOV_MAX
 && !defšed 
IOV_MAX


42 
	#IOV_MAX
 1024

	)

	@/usr/include/bits/stdlib-ldbl.h

20 #iâdeà
_STDLIB_H


24 #ifdef 
__USE_ISOC99


25 
__BEGIN_NAMESPACE_C99


26 
	$__LDBL_REDIR1_DECL
 (
¡¹Şd
, 
¡¹od
)

27 
__END_NAMESPACE_C99


30 #ifdeà
__USE_GNU


31 
	$__LDBL_REDIR1_DECL
 (
¡¹Şd_l
, 
¡¹od_l
)

34 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN_EXTENDED


35 #ifdeà
__USE_MISC


36 
	$__LDBL_REDIR1_DECL
 (
qecvt
, 
ecvt
)

37 
	$__LDBL_REDIR1_DECL
 (
qfcvt
, 
fcvt
)

38 
	$__LDBL_REDIR1_DECL
 (
qgcvt
, 
gcvt
)

39 
	$__LDBL_REDIR1_DECL
 (
qecvt_r
, 
ecvt_r
)

40 
	$__LDBL_REDIR1_DECL
 (
qfcvt_r
, 
fcvt_r
)

	@/usr/include/bits/stdlib.h

20 #iâdeà
_STDLIB_H


24 *
	$__»®·th_chk
 (
__cÚ¡
 *
__»¡riù
 
__Çme
,

25 *
__»¡riù
 
__»sŞved
,

26 
size_t
 
__»sŞvedËn
è
__THROW
 
__wur
;

27 *
	`__REDIRECT_NTH
 (
__»®·th_®Ÿs
,

28 (
__cÚ¡
 *
__»¡riù
 
__Çme
,

29 *
__»¡riù
 
__»sŞved
), 
»®·th
è
__wur
;

30 *
	`__REDIRECT_NTH
 (
__»®·th_chk_w¬n
,

31 (
__cÚ¡
 *
__»¡riù
 
__Çme
,

32 *
__»¡riù
 
__»sŞved
,

33 
size_t
 
__»sŞvedËn
), 
__»®·th_chk
è
__wur


34 
	`__w¬Ç‰r
 ("second‡rgument of„ealpath must beƒither NULL or‡t "

37 
__ex‹º_®ways_šlše
 
__wur
 *

38 
	`__NTH
 (
	$»®·th
 (
__cÚ¡
 *
__»¡riù
 
__Çme
, *__»¡riù 
__»sŞved
))

40 ià(
	`__bos
 (
__»sŞved
è!ğ(
size_t
) -1)

42 #ià
defšed
 
_LIBC_LIMITS_H_
 && defšed 
PATH_MAX


43 ià(
	`__bos
 (
__»sŞved
è< 
PATH_MAX
)

44  
	`__»®·th_chk_w¬n
 (
__Çme
, 
__»sŞved
, 
	`__bos
 (__resolved));

46  
	`__»®·th_chk
 (
__Çme
, 
__»sŞved
, 
	`__bos
 (__resolved));

49  
	`__»®·th_®Ÿs
 (
__Çme
, 
__»sŞved
);

50 
	}
}

53 
	$__±¢ame_r_chk
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
,

54 
size_t
 
__Ä—l
è
__THROW
 
	`__nÚnuÎ
 ((2));

55 
	`__REDIRECT_NTH
 (
__±¢ame_r_®Ÿs
, (
__fd
, *
__buf
,

56 
size_t
 
__buæ’
), 
±¢ame_r
)

57 
	`__nÚnuÎ
 ((2));

58 
	`__REDIRECT_NTH
 (
__±¢ame_r_chk_w¬n
,

59 (
__fd
, *
__buf
, 
size_t
 
__buæ’
,

60 
size_t
 
__Ä—l
), 
__±¢ame_r_chk
)

61 
	`__nÚnuÎ
 ((2)è
	`__w¬Ç‰r
 ("ptsname_r called with buflen biggerhan "

64 
__ex‹º_®ways_šlše
 

65 
	`__NTH
 (
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
))

67 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

69 ià(!
	`__butš_cÚ¡ªt_p
 (
__buæ’
))

70  
	`__±¢ame_r_chk
 (
__fd
, 
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

71 ià(
__buæ’
 > 
	`__bos
 (
__buf
))

72  
	`__±¢ame_r_chk_w¬n
 (
__fd
, 
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

74  
	`__±¢ame_r_®Ÿs
 (
__fd
, 
__buf
, 
__buæ’
);

75 
	}
}

78 
	$__wùomb_chk
 (*
__s
, 
wch¬_t
 
__wch¬
, 
size_t
 
__buæ’
)

79 
__THROW
 
__wur
;

80 
	`__REDIRECT_NTH
 (
__wùomb_®Ÿs
, (*
__s
, 
wch¬_t
 
__wch¬
),

81 
wùomb
è
__wur
;

83 
__ex‹º_®ways_šlše
 
__wur
 

84 
	`__NTH
 (
	$wùomb
 (*
__s
, 
wch¬_t
 
__wch¬
))

89 
	#__STDLIB_MB_LEN_MAX
 16

	)

90 #ià
defšed
 
MB_LEN_MAX
 && MB_LEN_MAX !ğ
__STDLIB_MB_LEN_MAX


93 ià(
	`__bos
 (
__s
è!ğ(
size_t
è-1 && 
__STDLIB_MB_LEN_MAX
 > __bos (__s))

94  
	`__wùomb_chk
 (
__s
, 
__wch¬
, 
	`__bos
 (__s));

95  
	`__wùomb_®Ÿs
 (
__s
, 
__wch¬
);

96 
	}
}

99 
size_t
 
	$__mb¡owcs_chk
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

100 
__cÚ¡
 *
__»¡riù
 
__¤c
,

101 
size_t
 
__Ën
, size_ˆ
__d¡Ën
è
__THROW
;

102 
size_t
 
	`__REDIRECT_NTH
 (
__mb¡owcs_®Ÿs
,

103 (
wch¬_t
 *
__»¡riù
 
__d¡
,

104 
__cÚ¡
 *
__»¡riù
 
__¤c
,

105 
size_t
 
__Ën
), 
mb¡owcs
);

106 
size_t
 
	`__REDIRECT_NTH
 (
__mb¡owcs_chk_w¬n
,

107 (
wch¬_t
 *
__»¡riù
 
__d¡
,

108 
__cÚ¡
 *
__»¡riù
 
__¤c
,

109 
size_t
 
__Ën
, size_ˆ
__d¡Ën
), 
__mb¡owcs_chk
)

110 
	`__w¬Ç‰r
 ("mbstowcs called with dst buffer smallerhan†en "

113 
__ex‹º_®ways_šlše
 
size_t


114 
	`__NTH
 (
	$mb¡owcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
, 
__cÚ¡
 *__»¡riù 
__¤c
,

115 
size_t
 
__Ën
))

117 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

119 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

120  
	`__mb¡owcs_chk
 (
__d¡
, 
__¤c
, 
__Ën
,

121 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

123 ià(
__Ën
 > 
	`__bos
 (
__d¡
è/  (
wch¬_t
))

124  
	`__mb¡owcs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__Ën
,

125 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

127  
	`__mb¡owcs_®Ÿs
 (
__d¡
, 
__¤c
, 
__Ën
);

128 
	}
}

131 
size_t
 
	$__wc¡ombs_chk
 (*
__»¡riù
 
__d¡
,

132 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

133 
size_t
 
__Ën
, size_ˆ
__d¡Ën
è
__THROW
;

134 
size_t
 
	`__REDIRECT_NTH
 (
__wc¡ombs_®Ÿs
,

135 (*
__»¡riù
 
__d¡
,

136 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

137 
size_t
 
__Ën
), 
wc¡ombs
);

138 
size_t
 
	`__REDIRECT_NTH
 (
__wc¡ombs_chk_w¬n
,

139 (*
__»¡riù
 
__d¡
,

140 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

141 
size_t
 
__Ën
, size_ˆ
__d¡Ën
), 
__wc¡ombs_chk
)

142 
	`__w¬Ç‰r
 ("wcstombs called with dst buffer smallerhan†en");

144 
__ex‹º_®ways_šlše
 
size_t


145 
	`__NTH
 (
	$wc¡ombs
 (*
__»¡riù
 
__d¡
, 
__cÚ¡
 
wch¬_t
 *__»¡riù 
__¤c
,

146 
size_t
 
__Ën
))

148 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

150 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

151  
	`__wc¡ombs_chk
 (
__d¡
, 
__¤c
, 
__Ën
, 
	`__bos
 (__dst));

152 ià(
__Ën
 > 
	`__bos
 (
__d¡
))

153  
	`__wc¡ombs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__Ën
, 
	`__bos
 (__dst));

155  
	`__wc¡ombs_®Ÿs
 (
__d¡
, 
__¤c
, 
__Ën
);

156 
	}
}

	@/usr/include/bits/string.h

20 #iâdeà
_STRING_H


26 
	#_STRING_ARCH_uÇligÃd
 1

	)

	@/usr/include/bits/string2.h

21 #iâdeà
_STRING_H


25 #ià!
defšed
 
__NO_STRING_INLINES
 && !defšed 
__BOUNDED_POINTERS__


42 #iâdeà
__STRING_INLINE


43 #ifdeà
__ılu¥lus


44 
	#__STRING_INLINE
 
šlše


	)

46 
	#__STRING_INLINE
 
__ex‹º_šlše


	)

50 #ià
_STRING_ARCH_uÇligÃd


52 
	~<’dŸn.h
>

53 
	~<b™s/ty³s.h
>

55 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


56 
	#__STRING2_SMALL_GET16
(
¤c
, 
idx
) \

57 (((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
 + 1] << 8 \

58 | ((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
])

	)

59 
	#__STRING2_SMALL_GET32
(
¤c
, 
idx
) \

60 (((((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
 + 3] << 8 \

61 | ((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
 + 2]) << 8 \

62 | ((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
 + 1]) << 8 \

63 | ((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
])

	)

65 
	#__STRING2_SMALL_GET16
(
¤c
, 
idx
) \

66 (((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
] << 8 \

67 | ((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
 + 1])

	)

68 
	#__STRING2_SMALL_GET32
(
¤c
, 
idx
) \

69 (((((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
] << 8 \

70 | ((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
 + 1]) << 8 \

71 | ((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
 + 2]) << 8 \

72 | ((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
 + 3])

	)

77 
	#__STRING2_COPY_TYPE
(
N
) \

78 ¡ruù { 
__¬r
[
N
]; } \

79 
	t__©Œibu‹__
 ((
	t__·cked__
)è
	t__STRING2_COPY_ARR
##
	tN


	)

80 
	t__STRING2_COPY_TYPE
 (2);

81 
__STRING2_COPY_TYPE
 (3);

82 
__STRING2_COPY_TYPE
 (4);

83 
__STRING2_COPY_TYPE
 (5);

84 
__STRING2_COPY_TYPE
 (6);

85 
__STRING2_COPY_TYPE
 (7);

86 
__STRING2_COPY_TYPE
 (8);

87 #undeà
__STRING2_COPY_TYPE


93 
	#__¡ršg2_1b±r_p
(
__x
) \

94 ((
size_t
)(cÚ¡ *)((
__x
è+ 1è- (size_t)(cÚ¡ *)(__xè=ğ1)

	)

97 #ià!
defšed
 
_HAVE_STRING_ARCH_mem£t


98 #ià!
__GNUC_PREREQ
 (3, 0)

99 #ià
_STRING_ARCH_uÇligÃd


100 
	#mem£t
(
s
, 
c
, 
n
) \

101 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
n
) && (n) <= 16 \

102 ? ((
n
) == 1 \

103 ? 
	`__mem£t_1
 (
s
, 
c
) \

104 : 
	`__mem£t_gc
 (
s
, 
c
, 
n
)) \

105 : (
	`__butš_cÚ¡ªt_p
 (
c
) && (c) == '\0' \

106 ? ({ *
__s
 = (
s
); 
	`__bz”o
 (__s, 
n
); __s; }) \

107 : 
	`mem£t
 (
s
, 
c
, 
n
))))

	)

109 
	#__mem£t_1
(
s
, 
c
è({ *
__s
 = (s); \

110 *((
__ušt8_t
 *è
__s
èğ(__ušt8_tè
c
; __s; })

	)

112 
	#__mem£t_gc
(
s
, 
c
, 
n
) \

113 ({ *
__s
 = (
s
); \

115 
__ui
; \

116 
__usi
; \

117 
__uc
; \

118 } *
__u
 = 
__s
; \

119 
__ušt8_t
 
__c
 = (__ušt8_tè(
c
); \

122 (è(
n
)) \

125 
__u
->
__ui
 = 
__c
 * 0x01010101; \

126 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

128 
__u
->
__ui
 = 
__c
 * 0x01010101; \

129 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

131 
__u
->
__ui
 = 
__c
 * 0x01010101; \

132 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

134 
__u
->
__usi
 = (è
__c
 * 0x0101; \

135 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2); \

136 
__u
->
__uc
 = (è
__c
; \

140 
__u
->
__ui
 = 
__c
 * 0x01010101; \

141 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

143 
__u
->
__ui
 = 
__c
 * 0x01010101; \

144 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

146 
__u
->
__ui
 = 
__c
 * 0x01010101; \

147 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

149 
__u
->
__usi
 = (è
__c
 * 0x0101; \

153 
__u
->
__ui
 = 
__c
 * 0x01010101; \

154 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

156 
__u
->
__ui
 = 
__c
 * 0x01010101; \

157 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

159 
__u
->
__ui
 = 
__c
 * 0x01010101; \

160 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

162 
__u
->
__uc
 = (è
__c
; \

166 
__u
->
__ui
 = 
__c
 * 0x01010101; \

167 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

169 
__u
->
__ui
 = 
__c
 * 0x01010101; \

170 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

172 
__u
->
__ui
 = 
__c
 * 0x01010101; \

173 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

175 
__u
->
__ui
 = 
__c
 * 0x01010101; \

180 
__s
; })

	)

182 
	#mem£t
(
s
, 
c
, 
n
) \

183 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
c
) && (c) == '\0' \

184 ? ({ *
__s
 = (
s
); 
	`__bz”o
 (__s, 
n
); __s; }) \

185 : 
	`mem£t
 (
s
, 
c
, 
n
)))

	)

194 #ià
__GNUC_PREREQ
 (2, 91)

195 
	#__bz”o
(
s
, 
n
è
	`__butš_mem£t
 (s, '\0',‚)

	)

203 #ifdeà
__USE_GNU


204 #ià!
defšed
 
_HAVE_STRING_ARCH_mempıy
 || defšed 
_FORCE_INLINES


205 #iâdeà
_HAVE_STRING_ARCH_mempıy


206 #ià
__GNUC_PREREQ
 (3, 4)

207 
	#__mempıy
(
de¡
, 
¤c
, 
n
è
	`__butš_mempıy
 (de¡, src,‚)

	)

208 #–ià
__GNUC_PREREQ
 (3, 0)

209 
	#__mempıy
(
de¡
, 
¤c
, 
n
) \

210 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
è&& __butš_cÚ¡ªt_°(
n
) \

211 && 
	`__¡ršg2_1b±r_p
 (
¤c
è&& 
n
 <= 8 \

212 ? 
	`__butš_memıy
 (
de¡
, 
¤c
, 
n
) + (n) \

213 : 
	`__mempıy
 (
de¡
, 
¤c
, 
n
)))

	)

215 
	#__mempıy
(
de¡
, 
¤c
, 
n
) \

216 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
è&& __butš_cÚ¡ªt_°(
n
) \

217 && 
	`__¡ršg2_1b±r_p
 (
¤c
è&& 
n
 <= 8 \

218 ? 
	`__mempıy_sm®l
 (
de¡
, 
	`__mempıy_¬gs
 (
¤c
), 
n
) \

219 : 
	`__mempıy
 (
de¡
, 
¤c
, 
n
)))

	)

223 
	#mempıy
(
de¡
, 
¤c
, 
n
è
	`__mempıy
 (de¡, src,‚)

	)

226 #ià!
__GNUC_PREREQ
 (3, 0è|| 
defšed
 
_FORCE_INLINES


227 #ià
_STRING_ARCH_uÇligÃd


228 #iâdeà
_FORCE_INLINES


229 
	#__mempıy_¬gs
(
¤c
) \

230 ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[2], \

231 ((
__cÚ¡
 *è(
¤c
))[4], ((__const *) (src))[6], \

232 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET16
 (
¤c
, 0), \

233 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET16
 (
¤c
, 4), \

234 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET32
 (
¤c
, 0), \

235 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET32
 (
¤c
, 4)

	)

237 
__STRING_INLINE
 *
__mempıy_sm®l
 (*, , , , ,

238 
__ušt16_t
, __ušt16_t, 
__ušt32_t
,

239 
__ušt32_t
, 
size_t
);

240 
__STRING_INLINE
 *

241 
	$__mempıy_sm®l
 (*
__de¡1
,

242 
__¤c0_1
, 
__¤c2_1
, 
__¤c4_1
, 
__¤c6_1
,

243 
__ušt16_t
 
__¤c0_2
, __ušt16_ˆ
__¤c4_2
,

244 
__ušt32_t
 
__¤c0_4
, __ušt32_ˆ
__¤c4_4
,

245 
size_t
 
__¤ş’
)

248 
__ušt32_t
 
__ui
;

249 
__ušt16_t
 
__usi
;

250 
__uc
;

251 
__c
;

252 } *
__u
 = 
__de¡1
;

253 (è
__¤ş’
)

256 
__u
->
__c
 = 
__¤c0_1
;

257 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 1);

260 
__u
->
__usi
 = 
__¤c0_2
;

261 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

264 
__u
->
__usi
 = 
__¤c0_2
;

265 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

266 
__u
->
__c
 = 
__¤c2_1
;

267 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 1);

270 
__u
->
__ui
 = 
__¤c0_4
;

271 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

274 
__u
->
__ui
 = 
__¤c0_4
;

275 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

276 
__u
->
__c
 = 
__¤c4_1
;

277 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 1);

280 
__u
->
__ui
 = 
__¤c0_4
;

281 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

282 
__u
->
__usi
 = 
__¤c4_2
;

283 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

286 
__u
->
__ui
 = 
__¤c0_4
;

287 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

288 
__u
->
__usi
 = 
__¤c4_2
;

289 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

290 
__u
->
__c
 = 
__¤c6_1
;

291 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 1);

294 
__u
->
__ui
 = 
__¤c0_4
;

295 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

296 
__u
->
__ui
 = 
__¤c4_4
;

297 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

300  (*è
__u
;

301 
	}
}

303 #iâdeà
_FORCE_INLINES


304 
	#__mempıy_¬gs
(
¤c
) \

305 ((
__cÚ¡
 *è(
¤c
))[0], \

306 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR2
) \

307 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1] } }), \

308 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR3
) \

309 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

310 ((
__cÚ¡
 *è(
¤c
))[2] } }), \

311 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR4
) \

312 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

313 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3] } }), \

314 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR5
) \

315 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

316 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

317 ((
__cÚ¡
 *è(
¤c
))[4] } }), \

318 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR6
) \

319 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

320 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

321 ((
__cÚ¡
 *è(
¤c
))[4], ((__const *) (src))[5] } }), \

322 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR7
) \

323 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

324 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

325 ((
__cÚ¡
 *è(
¤c
))[4], ((__const *) (src))[5], \

326 ((
__cÚ¡
 *è(
¤c
))[6] } }), \

327 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR8
) \

328 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

329 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

330 ((
__cÚ¡
 *è(
¤c
))[4], ((__const *) (src))[5], \

331 ((
__cÚ¡
 *è(
¤c
))[6], ((__cÚ¡ *è(¤c))[7] } })

	)

333 
__STRING_INLINE
 *
__mempıy_sm®l
 (*, , 
__STRING2_COPY_ARR2
,

334 
__STRING2_COPY_ARR3
,

335 
__STRING2_COPY_ARR4
,

336 
__STRING2_COPY_ARR5
,

337 
__STRING2_COPY_ARR6
,

338 
__STRING2_COPY_ARR7
,

339 
__STRING2_COPY_ARR8
, 
size_t
);

340 
__STRING_INLINE
 *

341 
	$__mempıy_sm®l
 (*
__de¡
, 
__¤c1
,

342 
__STRING2_COPY_ARR2
 
__¤c2
, 
__STRING2_COPY_ARR3
 
__¤c3
,

343 
__STRING2_COPY_ARR4
 
__¤c4
, 
__STRING2_COPY_ARR5
 
__¤c5
,

344 
__STRING2_COPY_ARR6
 
__¤c6
, 
__STRING2_COPY_ARR7
 
__¤c7
,

345 
__STRING2_COPY_ARR8
 
__¤c8
, 
size_t
 
__¤ş’
)

348 
__c
;

349 
__STRING2_COPY_ARR2
 
__sÿ2
;

350 
__STRING2_COPY_ARR3
 
__sÿ3
;

351 
__STRING2_COPY_ARR4
 
__sÿ4
;

352 
__STRING2_COPY_ARR5
 
__sÿ5
;

353 
__STRING2_COPY_ARR6
 
__sÿ6
;

354 
__STRING2_COPY_ARR7
 
__sÿ7
;

355 
__STRING2_COPY_ARR8
 
__sÿ8
;

356 } *
__u
 = 
__de¡
;

357 (è
__¤ş’
)

360 
__u
->
__c
 = 
__¤c1
;

363 
__ex‹nsiÚ__
 
__u
->
__sÿ2
 = 
__¤c2
;

366 
__ex‹nsiÚ__
 
__u
->
__sÿ3
 = 
__¤c3
;

369 
__ex‹nsiÚ__
 
__u
->
__sÿ4
 = 
__¤c4
;

372 
__ex‹nsiÚ__
 
__u
->
__sÿ5
 = 
__¤c5
;

375 
__ex‹nsiÚ__
 
__u
->
__sÿ6
 = 
__¤c6
;

378 
__ex‹nsiÚ__
 
__u
->
__sÿ7
 = 
__¤c7
;

381 
__ex‹nsiÚ__
 
__u
->
__sÿ8
 = 
__¤c8
;

384  
	`__ex‹nsiÚ__
 ((*è
__u
 + 
__¤ş’
);

385 
	}
}

393 #iâdeà
_HAVE_STRING_ARCH_¡rchr


394 *
__¿wmemchr
 (cÚ¡ *
__s
, 
__c
);

395 #ià
__GNUC_PREREQ
 (3, 2)

396 
	#¡rchr
(
s
, 
c
) \

397 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
c
è&& !__butš_cÚ¡ªt_°(
s
) \

398 && (
c
) == '\0' \

399 ? (*è
	`__¿wmemchr
 (
s
, 
c
) \

400 : 
	`__butš_¡rchr
 (
s
, 
c
)))

	)

402 
	#¡rchr
(
s
, 
c
) \

403 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
c
) && (c) == '\0' \

404 ? (*è
	`__¿wmemchr
 (
s
, 
c
) \

405 : 
	`¡rchr
 (
s
, 
c
)))

	)

411 #ià(!
defšed
 
_HAVE_STRING_ARCH_¡rıy
 && !
__GNUC_PREREQ
 (3, 0)) \

412 || 
defšed
 
	g_FORCE_INLINES


413 #ià!
defšed
 
_HAVE_STRING_ARCH_¡rıy
 && !
__GNUC_PREREQ
 (3, 0)

414 
	#¡rıy
(
de¡
, 
¤c
) \

415 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
) \

416 ? (
	`__¡ršg2_1b±r_p
 (
¤c
è&& 
	`¡¾’
 (src) + 1 <= 8 \

417 ? 
	`__¡rıy_sm®l
 (
de¡
, 
	`__¡rıy_¬gs
 (
¤c
), \

418 
	`¡¾’
 (
¤c
) + 1) \

419 : (*è
	`memıy
 (
de¡
, 
¤c
, 
	`¡¾’
 (src) + 1)) \

420 : 
	`¡rıy
 (
de¡
, 
¤c
)))

	)

423 #ià
_STRING_ARCH_uÇligÃd


424 #iâdeà
_FORCE_INLINES


425 
	#__¡rıy_¬gs
(
¤c
) \

426 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET16
 (
¤c
, 0), \

427 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET16
 (
¤c
, 4), \

428 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET32
 (
¤c
, 0), \

429 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET32
 (
¤c
, 4)

	)

431 
__STRING_INLINE
 *
__¡rıy_sm®l
 (*, 
__ušt16_t
, __uint16_t,

432 
__ušt32_t
, __ušt32_t, 
size_t
);

433 
__STRING_INLINE
 *

434 
	$__¡rıy_sm®l
 (*
__de¡
,

435 
__ušt16_t
 
__¤c0_2
, __ušt16_ˆ
__¤c4_2
,

436 
__ušt32_t
 
__¤c0_4
, __ušt32_ˆ
__¤c4_4
,

437 
size_t
 
__¤ş’
)

440 
__ušt32_t
 
__ui
;

441 
__ušt16_t
 
__usi
;

442 
__uc
;

443 } *
__u
 = (*è
__de¡
;

444 (è
__¤ş’
)

447 
__u
->
__uc
 = '\0';

450 
__u
->
__usi
 = 
__¤c0_2
;

453 
__u
->
__usi
 = 
__¤c0_2
;

454 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

455 
__u
->
__uc
 = '\0';

458 
__u
->
__ui
 = 
__¤c0_4
;

461 
__u
->
__ui
 = 
__¤c0_4
;

462 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

463 
__u
->
__uc
 = '\0';

466 
__u
->
__ui
 = 
__¤c0_4
;

467 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

468 
__u
->
__usi
 = 
__¤c4_2
;

471 
__u
->
__ui
 = 
__¤c0_4
;

472 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

473 
__u
->
__usi
 = 
__¤c4_2
;

474 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

475 
__u
->
__uc
 = '\0';

478 
__u
->
__ui
 = 
__¤c0_4
;

479 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

480 
__u
->
__ui
 = 
__¤c4_4
;

483  
__de¡
;

484 
	}
}

486 #iâdeà
_FORCE_INLINES


487 
	#__¡rıy_¬gs
(
¤c
) \

488 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR2
) \

489 { { ((
__cÚ¡
 *è(
¤c
))[0], '\0' } }), \

490 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR3
) \

491 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

493 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR4
) \

494 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

495 ((
__cÚ¡
 *è(
¤c
))[2], '\0' } }), \

496 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR5
) \

497 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

498 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

500 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR6
) \

501 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

502 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

503 ((
__cÚ¡
 *è(
¤c
))[4], '\0' } }), \

504 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR7
) \

505 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

506 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

507 ((
__cÚ¡
 *è(
¤c
))[4], ((__const *) (src))[5], \

509 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR8
) \

510 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

511 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

512 ((
__cÚ¡
 *è(
¤c
))[4], ((__const *) (src))[5], \

513 ((
__cÚ¡
 *è(
¤c
))[6], '\0' } })

	)

515 
__STRING_INLINE
 *
__¡rıy_sm®l
 (*, 
__STRING2_COPY_ARR2
,

516 
__STRING2_COPY_ARR3
,

517 
__STRING2_COPY_ARR4
,

518 
__STRING2_COPY_ARR5
,

519 
__STRING2_COPY_ARR6
,

520 
__STRING2_COPY_ARR7
,

521 
__STRING2_COPY_ARR8
, 
size_t
);

522 
__STRING_INLINE
 *

523 
	$__¡rıy_sm®l
 (*
__de¡
,

524 
__STRING2_COPY_ARR2
 
__¤c2
, 
__STRING2_COPY_ARR3
 
__¤c3
,

525 
__STRING2_COPY_ARR4
 
__¤c4
, 
__STRING2_COPY_ARR5
 
__¤c5
,

526 
__STRING2_COPY_ARR6
 
__¤c6
, 
__STRING2_COPY_ARR7
 
__¤c7
,

527 
__STRING2_COPY_ARR8
 
__¤c8
, 
size_t
 
__¤ş’
)

530 
__c
;

531 
__STRING2_COPY_ARR2
 
__sÿ2
;

532 
__STRING2_COPY_ARR3
 
__sÿ3
;

533 
__STRING2_COPY_ARR4
 
__sÿ4
;

534 
__STRING2_COPY_ARR5
 
__sÿ5
;

535 
__STRING2_COPY_ARR6
 
__sÿ6
;

536 
__STRING2_COPY_ARR7
 
__sÿ7
;

537 
__STRING2_COPY_ARR8
 
__sÿ8
;

538 } *
__u
 = (*è
__de¡
;

539 (è
__¤ş’
)

542 
__u
->
__c
 = '\0';

545 
__ex‹nsiÚ__
 
__u
->
__sÿ2
 = 
__¤c2
;

548 
__ex‹nsiÚ__
 
__u
->
__sÿ3
 = 
__¤c3
;

551 
__ex‹nsiÚ__
 
__u
->
__sÿ4
 = 
__¤c4
;

554 
__ex‹nsiÚ__
 
__u
->
__sÿ5
 = 
__¤c5
;

557 
__ex‹nsiÚ__
 
__u
->
__sÿ6
 = 
__¤c6
;

560 
__ex‹nsiÚ__
 
__u
->
__sÿ7
 = 
__¤c7
;

563 
__ex‹nsiÚ__
 
__u
->
__sÿ8
 = 
__¤c8
;

566  
__de¡
;

567 
	}
}

573 #ifdeà
__USE_GNU


574 #ià!
defšed
 
_HAVE_STRING_ARCH_¡pıy
 || defšed 
_FORCE_INLINES


575 #iâdeà
_HAVE_STRING_ARCH_¡pıy


576 #ià
__GNUC_PREREQ
 (3, 4)

577 
	#__¡pıy
(
de¡
, 
¤c
è
	`__butš_¡pıy
 (de¡, src)

	)

578 #–ià
__GNUC_PREREQ
 (3, 0)

579 
	#__¡pıy
(
de¡
, 
¤c
) \

580 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
) \

581 ? (
	`__¡ršg2_1b±r_p
 (
¤c
è&& 
	`¡¾’
 (src) + 1 <= 8 \

582 ? 
	`__butš_¡rıy
 (
de¡
, 
¤c
è+ 
	`¡¾’
 (src) \

583 : ((*è(
__mempıy
è(
de¡
, 
¤c
, 
	`¡¾’
 (src) + 1) \

585 : 
	`__¡pıy
 (
de¡
, 
¤c
)))

	)

587 
	#__¡pıy
(
de¡
, 
¤c
) \

588 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
) \

589 ? (
	`__¡ršg2_1b±r_p
 (
¤c
è&& 
	`¡¾’
 (src) + 1 <= 8 \

590 ? 
	`__¡pıy_sm®l
 (
de¡
, 
	`__¡pıy_¬gs
 (
¤c
), \

591 
	`¡¾’
 (
¤c
) + 1) \

592 : ((*è(
__mempıy
è(
de¡
, 
¤c
, 
	`¡¾’
 (src) + 1) \

594 : 
	`__¡pıy
 (
de¡
, 
¤c
)))

	)

598 
	#¡pıy
(
de¡
, 
¤c
è
	`__¡pıy
 (de¡, src)

	)

601 #ià!
__GNUC_PREREQ
 (3, 0è|| 
defšed
 
_FORCE_INLINES


602 #ià
_STRING_ARCH_uÇligÃd


603 #iâdeà
_FORCE_INLINES


604 
	#__¡pıy_¬gs
(
¤c
) \

605 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET16
 (
¤c
, 0), \

606 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET16
 (
¤c
, 4), \

607 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET32
 (
¤c
, 0), \

608 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET32
 (
¤c
, 4)

	)

610 
__STRING_INLINE
 *
__¡pıy_sm®l
 (*, 
__ušt16_t
, __uint16_t,

611 
__ušt32_t
, __ušt32_t, 
size_t
);

612 
__STRING_INLINE
 *

613 
	$__¡pıy_sm®l
 (*
__de¡
,

614 
__ušt16_t
 
__¤c0_2
, __ušt16_ˆ
__¤c4_2
,

615 
__ušt32_t
 
__¤c0_4
, __ušt32_ˆ
__¤c4_4
,

616 
size_t
 
__¤ş’
)

619 
__ui
;

620 
__usi
;

621 
__uc
;

622 
__c
;

623 } *
__u
 = (*è
__de¡
;

624 (è
__¤ş’
)

627 
__u
->
__uc
 = '\0';

630 
__u
->
__usi
 = 
__¤c0_2
;

631 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 1);

634 
__u
->
__usi
 = 
__¤c0_2
;

635 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

636 
__u
->
__uc
 = '\0';

639 
__u
->
__ui
 = 
__¤c0_4
;

640 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 3);

643 
__u
->
__ui
 = 
__¤c0_4
;

644 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

645 
__u
->
__uc
 = '\0';

648 
__u
->
__ui
 = 
__¤c0_4
;

649 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

650 
__u
->
__usi
 = 
__¤c4_2
;

651 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 1);

654 
__u
->
__ui
 = 
__¤c0_4
;

655 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

656 
__u
->
__usi
 = 
__¤c4_2
;

657 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

658 
__u
->
__uc
 = '\0';

661 
__u
->
__ui
 = 
__¤c0_4
;

662 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

663 
__u
->
__ui
 = 
__¤c4_4
;

664 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 3);

667  &
__u
->
__c
;

668 
	}
}

670 #iâdeà
_FORCE_INLINES


671 
	#__¡pıy_¬gs
(
¤c
) \

672 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR2
) \

673 { { ((
__cÚ¡
 *è(
¤c
))[0], '\0' } }), \

674 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR3
) \

675 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

677 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR4
) \

678 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

679 ((
__cÚ¡
 *è(
¤c
))[2], '\0' } }), \

680 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR5
) \

681 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

682 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

684 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR6
) \

685 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

686 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

687 ((
__cÚ¡
 *è(
¤c
))[4], '\0' } }), \

688 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR7
) \

689 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

690 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

691 ((
__cÚ¡
 *è(
¤c
))[4], ((__const *) (src))[5], \

693 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR8
) \

694 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

695 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

696 ((
__cÚ¡
 *è(
¤c
))[4], ((__const *) (src))[5], \

697 ((
__cÚ¡
 *è(
¤c
))[6], '\0' } })

	)

699 
__STRING_INLINE
 *
__¡pıy_sm®l
 (*, 
__STRING2_COPY_ARR2
,

700 
__STRING2_COPY_ARR3
,

701 
__STRING2_COPY_ARR4
,

702 
__STRING2_COPY_ARR5
,

703 
__STRING2_COPY_ARR6
,

704 
__STRING2_COPY_ARR7
,

705 
__STRING2_COPY_ARR8
, 
size_t
);

706 
__STRING_INLINE
 *

707 
	$__¡pıy_sm®l
 (*
__de¡
,

708 
__STRING2_COPY_ARR2
 
__¤c2
, 
__STRING2_COPY_ARR3
 
__¤c3
,

709 
__STRING2_COPY_ARR4
 
__¤c4
, 
__STRING2_COPY_ARR5
 
__¤c5
,

710 
__STRING2_COPY_ARR6
 
__¤c6
, 
__STRING2_COPY_ARR7
 
__¤c7
,

711 
__STRING2_COPY_ARR8
 
__¤c8
, 
size_t
 
__¤ş’
)

714 
__c
;

715 
__STRING2_COPY_ARR2
 
__sÿ2
;

716 
__STRING2_COPY_ARR3
 
__sÿ3
;

717 
__STRING2_COPY_ARR4
 
__sÿ4
;

718 
__STRING2_COPY_ARR5
 
__sÿ5
;

719 
__STRING2_COPY_ARR6
 
__sÿ6
;

720 
__STRING2_COPY_ARR7
 
__sÿ7
;

721 
__STRING2_COPY_ARR8
 
__sÿ8
;

722 } *
__u
 = (*è
__de¡
;

723 (è
__¤ş’
)

726 
__u
->
__c
 = '\0';

729 
__ex‹nsiÚ__
 
__u
->
__sÿ2
 = 
__¤c2
;

732 
__ex‹nsiÚ__
 
__u
->
__sÿ3
 = 
__¤c3
;

735 
__ex‹nsiÚ__
 
__u
->
__sÿ4
 = 
__¤c4
;

738 
__ex‹nsiÚ__
 
__u
->
__sÿ5
 = 
__¤c5
;

741 
__ex‹nsiÚ__
 
__u
->
__sÿ6
 = 
__¤c6
;

744 
__ex‹nsiÚ__
 
__u
->
__sÿ7
 = 
__¤c7
;

747 
__ex‹nsiÚ__
 
__u
->
__sÿ8
 = 
__¤c8
;

750  
__de¡
 + 
__¤ş’
 - 1;

751 
	}
}

759 #iâdeà
_HAVE_STRING_ARCH_¡ºıy


760 #ià
__GNUC_PREREQ
 (3, 2)

761 
	#¡ºıy
(
de¡
, 
¤c
, 
n
è
	`__butš_¡ºıy
 (de¡, src,‚)

	)

763 
	#¡ºıy
(
de¡
, 
¤c
, 
n
) \

764 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
è&& __butš_cÚ¡ªt_°(
n
) \

765 ? (
	`¡¾’
 (
¤c
è+ 1 >ğ((
size_t
è(
n
)) \

766 ? (*è
	`memıy
 (
de¡
, 
¤c
, 
n
) \

767 : 
	`¡ºıy
 (
de¡
, 
¤c
, 
n
)) \

768 : 
	`¡ºıy
 (
de¡
, 
¤c
, 
n
)))

	)

774 #iâdeà
_HAVE_STRING_ARCH_¡ºÿt


775 #ifdeà
_USE_STRING_ARCH_¡rchr


776 
	#¡ºÿt
(
de¡
, 
¤c
, 
n
) \

777 (
	`__ex‹nsiÚ__
 ({ *
__de¡
 = (
de¡
); \

778 
	`__butš_cÚ¡ªt_p
 (
¤c
è&& __butš_cÚ¡ªt_°(
n
) \

779 ? (
	`¡¾’
 (
¤c
è< ((
size_t
è(
n
)) \

780 ? 
	`¡rÿt
 (
__de¡
, 
¤c
) \

781 : (*((*è
	`__mempıy
 (
	`¡rchr
 (
__de¡
, '\0'), \

782 
¤c
, 
n
)èğ'\0', 
__de¡
)) \

783 : 
	`¡ºÿt
 (
de¡
, 
¤c
, 
n
); }))

	)

784 #–ià
__GNUC_PREREQ
 (3, 2)

785 
	#¡ºÿt
(
de¡
, 
¤c
, 
n
è
	`__butš_¡ºÿt
 (de¡, src,‚)

	)

787 
	#¡ºÿt
(
de¡
, 
¤c
, 
n
) \

788 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
è&& __butš_cÚ¡ªt_°(
n
) \

789 ? (
	`¡¾’
 (
¤c
è< ((
size_t
è(
n
)) \

790 ? 
	`¡rÿt
 (
de¡
, 
¤c
) \

791 : 
	`¡ºÿt
 (
de¡
, 
¤c
, 
n
)) \

792 : 
	`¡ºÿt
 (
de¡
, 
¤c
, 
n
)))

	)

798 #iâdeà
_HAVE_STRING_ARCH_¡rcmp


799 #ià
__GNUC_PREREQ
 (3, 2)

800 
	#¡rcmp
(
s1
, 
s2
) \

801 
__ex‹nsiÚ__
 \

802 ({ 
size_t
 
__s1_Ën
, 
__s2_Ën
; \

803 (
	`__butš_cÚ¡ªt_p
 (
s1
è&& __butš_cÚ¡ªt_°(
s2
) \

804 && (
__s1_Ën
 = 
	`¡¾’
 (
s1
), 
__s2_Ën
 = sŒËÀ(
s2
), \

805 (!
	`__¡ršg2_1b±r_p
 (
s1
è|| 
__s1_Ën
 >= 4) \

806 && (!
	`__¡ršg2_1b±r_p
 (
s2
è|| 
__s2_Ën
 >= 4)) \

807 ? 
	`__butš_¡rcmp
 (
s1
, 
s2
) \

808 : (
	`__butš_cÚ¡ªt_p
 (
s1
è&& 
	`__¡ršg2_1b±r_p
 (s1) \

809 && (
__s1_Ën
 = 
	`¡¾’
 (
s1
), __s1_len < 4) \

810 ? (
	`__butš_cÚ¡ªt_p
 (
s2
è&& 
	`__¡ršg2_1b±r_p
 (s2) \

811 ? 
	`__butš_¡rcmp
 (
s1
, 
s2
) \

812 : 
	`__¡rcmp_cg
 (
s1
, 
s2
, 
__s1_Ën
)) \

813 : (
	`__butš_cÚ¡ªt_p
 (
s2
è&& 
	`__¡ršg2_1b±r_p
 (s2) \

814 && (
__s2_Ën
 = 
	`¡¾’
 (
s2
), __s2_len < 4) \

815 ? (
	`__butš_cÚ¡ªt_p
 (
s1
è&& 
	`__¡ršg2_1b±r_p
 (s1) \

816 ? 
	`__butš_¡rcmp
 (
s1
, 
s2
) \

817 : 
	`__¡rcmp_gc
 (
s1
, 
s2
, 
__s2_Ën
)) \

818 : 
	`__butš_¡rcmp
 (
s1
, 
s2
)))); })

	)

820 
	#¡rcmp
(
s1
, 
s2
) \

821 
__ex‹nsiÚ__
 \

822 ({ 
size_t
 
__s1_Ën
, 
__s2_Ën
; \

823 (
	`__butš_cÚ¡ªt_p
 (
s1
è&& __butš_cÚ¡ªt_°(
s2
) \

824 && (
__s1_Ën
 = 
	`¡¾’
 (
s1
), 
__s2_Ën
 = sŒËÀ(
s2
), \

825 (!
	`__¡ršg2_1b±r_p
 (
s1
è|| 
__s1_Ën
 >= 4) \

826 && (!
	`__¡ršg2_1b±r_p
 (
s2
è|| 
__s2_Ën
 >= 4)) \

827 ? 
	`memcmp
 ((
__cÚ¡
 *è(
s1
), (__cÚ¡ *è(
s2
), \

828 (
__s1_Ën
 < 
__s2_Ën
 ? __s1_len : __s2_len) + 1) \

829 : (
	`__butš_cÚ¡ªt_p
 (
s1
è&& 
	`__¡ršg2_1b±r_p
 (s1) \

830 && (
__s1_Ën
 = 
	`¡¾’
 (
s1
), __s1_len < 4) \

831 ? (
	`__butš_cÚ¡ªt_p
 (
s2
è&& 
	`__¡ršg2_1b±r_p
 (s2) \

832 ? 
	`__¡rcmp_cc
 (
s1
, 
s2
, 
__s1_Ën
) \

833 : 
	`__¡rcmp_cg
 (
s1
, 
s2
, 
__s1_Ën
)) \

834 : (
	`__butš_cÚ¡ªt_p
 (
s2
è&& 
	`__¡ršg2_1b±r_p
 (s2) \

835 && (
__s2_Ën
 = 
	`¡¾’
 (
s2
), __s2_len < 4) \

836 ? (
	`__butš_cÚ¡ªt_p
 (
s1
è&& 
	`__¡ršg2_1b±r_p
 (s1) \

837 ? 
	`__¡rcmp_cc
 (
s1
, 
s2
, 
__s2_Ën
) \

838 : 
	`__¡rcmp_gc
 (
s1
, 
s2
, 
__s2_Ën
)) \

839 : 
	`¡rcmp
 (
s1
, 
s2
)))); })

	)

842 
	#__¡rcmp_cc
(
s1
, 
s2
, 
l
) \

843 (
	`__ex‹nsiÚ__
 ({ 
__»suÉ
 = \

844 (((
__cÚ¡
 *è(__cÚ¡ *è(
s1
))[0] \

845 - ((
__cÚ¡
 *è(__cÚ¡ *)(
s2
))[0]);\

846 ià(
l
 > 0 && 
__»suÉ
 == 0) \

848 
__»suÉ
 = (((
__cÚ¡
 *) \

849 (
__cÚ¡
 *è(
s1
))[1] \

850 - ((
__cÚ¡
 *) \

851 (
__cÚ¡
 *è(
s2
))[1]); \

852 ià(
l
 > 1 && 
__»suÉ
 == 0) \

854 
__»suÉ
 = \

855 (((
__cÚ¡
 *) \

856 (
__cÚ¡
 *è(
s1
))[2] \

857 - ((
__cÚ¡
 *) \

858 (
__cÚ¡
 *è(
s2
))[2]); \

859 ià(
l
 > 2 && 
__»suÉ
 == 0) \

860 
__»suÉ
 = \

861 (((
__cÚ¡
 *) \

862 (
__cÚ¡
 *è(
s1
))[3] \

863 - ((
__cÚ¡
 *) \

864 (
__cÚ¡
 *è(
s2
))[3]); \

867 
__»suÉ
; }))

	)

869 
	#__¡rcmp_cg
(
s1
, 
s2
, 
l1
) \

870 (
	`__ex‹nsiÚ__
 ({ 
__cÚ¡
 *
__s2
 = \

871 (
__cÚ¡
 *è(__cÚ¡ *è(
s2
); \

872 
__»suÉ
 = \

873 (((
__cÚ¡
 *è(__cÚ¡ *è(
s1
))[0] \

874 - 
__s2
[0]); \

875 ià(
l1
 > 0 && 
__»suÉ
 == 0) \

877 
__»suÉ
 = (((
__cÚ¡
 *) \

878 (
__cÚ¡
 *è(
s1
))[1] - 
__s2
[1]); \

879 ià(
l1
 > 1 && 
__»suÉ
 == 0) \

881 
__»suÉ
 = (((
__cÚ¡
 *) \

882 (
__cÚ¡
 *è(
s1
))[2] - 
__s2
[2]);\

883 ià(
l1
 > 2 && 
__»suÉ
 == 0) \

884 
__»suÉ
 = (((
__cÚ¡
 *) \

885 (
__cÚ¡
 *è(
s1
))[3] \

886 - 
__s2
[3]); \

889 
__»suÉ
; }))

	)

891 
	#__¡rcmp_gc
(
s1
, 
s2
, 
l2
) \

892 (
	`__ex‹nsiÚ__
 ({ 
__cÚ¡
 *
__s1
 = \

893 (
__cÚ¡
 *è(__cÚ¡ *è(
s1
); \

894 
__»suÉ
 = \

895 
__s1
[0] - ((
__cÚ¡
 *) \

896 (
__cÚ¡
 *è(
s2
))[0]; \

897 ià(
l2
 > 0 && 
__»suÉ
 == 0) \

899 
__»suÉ
 = (
__s1
[1] \

900 - ((
__cÚ¡
 *) \

901 (
__cÚ¡
 *è(
s2
))[1]); \

902 ià(
l2
 > 1 && 
__»suÉ
 == 0) \

904 
__»suÉ
 = \

905 (
__s1
[2] - ((
__cÚ¡
 *) \

906 (
__cÚ¡
 *è(
s2
))[2]); \

907 ià(
l2
 > 2 && 
__»suÉ
 == 0) \

908 
__»suÉ
 = \

909 (
__s1
[3] \

910 - ((
__cÚ¡
 *) \

911 (
__cÚ¡
 *è(
s2
))[3]); \

914 
__»suÉ
; }))

	)

919 #iâdeà
_HAVE_STRING_ARCH_¡ºcmp


920 
	#¡ºcmp
(
s1
, 
s2
, 
n
) \

921 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
n
) \

922 && ((
	`__butš_cÚ¡ªt_p
 (
s1
) \

923 && 
	`¡¾’
 (
s1
è< ((
size_t
è(
n
))) \

924 || (
	`__butš_cÚ¡ªt_p
 (
s2
) \

925 && 
	`¡¾’
 (
s2
è< ((
size_t
è(
n
)))) \

926 ? 
	`¡rcmp
 (
s1
, 
s2
è: 
	`¡ºcmp
 (s1, s2, 
n
)))

	)

932 #ià!
defšed
 
_HAVE_STRING_ARCH_¡rc¥n
 || defšed 
_FORCE_INLINES


933 #iâdeà
_HAVE_STRING_ARCH_¡rc¥n


934 #ià
__GNUC_PREREQ
 (3, 2)

935 
	#¡rc¥n
(
s
, 
»jeù
) \

936 
__ex‹nsiÚ__
 \

937 ({ 
__r0
, 
__r1
, 
__r2
; \

938 (
	`__butš_cÚ¡ªt_p
 (
»jeù
è&& 
	`__¡ršg2_1b±r_p
 (reject) \

939 ? ((
	`__butš_cÚ¡ªt_p
 (
s
è&& 
	`__¡ršg2_1b±r_p
 (s)) \

940 ? 
	`__butš_¡rc¥n
 (
s
, 
»jeù
) \

941 : ((
__r0
 = ((
__cÚ¡
 *è(
»jeù
))[0], __r0 == '\0') \

942 ? 
	`¡¾’
 (
s
) \

943 : ((
__r1
 = ((
__cÚ¡
 *è(
»jeù
))[1], __r1 == '\0') \

944 ? 
	`__¡rc¥n_c1
 (
s
, 
__r0
) \

945 : ((
__r2
 = ((
__cÚ¡
 *è(
»jeù
))[2], __r2 == '\0') \

946 ? 
	`__¡rc¥n_c2
 (
s
, 
__r0
, 
__r1
) \

947 : (((
__cÚ¡
 *è(
»jeù
))[3] == '\0' \

948 ? 
	`__¡rc¥n_c3
 (
s
, 
__r0
, 
__r1
, 
__r2
) \

949 : 
	`__butš_¡rc¥n
 (
s
, 
»jeù
)))))) \

950 : 
	`__butš_¡rc¥n
 (
s
, 
»jeù
)); })

	)

952 
	#¡rc¥n
(
s
, 
»jeù
) \

953 
__ex‹nsiÚ__
 \

954 ({ 
__r0
, 
__r1
, 
__r2
; \

955 (
	`__butš_cÚ¡ªt_p
 (
»jeù
è&& 
	`__¡ršg2_1b±r_p
 (reject) \

956 ? ((
__r0
 = ((
__cÚ¡
 *è(
»jeù
))[0], __r0 == '\0') \

957 ? 
	`¡¾’
 (
s
) \

958 : ((
__r1
 = ((
__cÚ¡
 *è(
»jeù
))[1], __r1 == '\0') \

959 ? 
	`__¡rc¥n_c1
 (
s
, 
__r0
) \

960 : ((
__r2
 = ((
__cÚ¡
 *è(
»jeù
))[2], __r2 == '\0') \

961 ? 
	`__¡rc¥n_c2
 (
s
, 
__r0
, 
__r1
) \

962 : (((
__cÚ¡
 *è(
»jeù
))[3] == '\0' \

963 ? 
	`__¡rc¥n_c3
 (
s
, 
__r0
, 
__r1
, 
__r2
) \

964 : 
	`¡rc¥n
 (
s
, 
»jeù
))))) \

965 : 
	`¡rc¥n
 (
s
, 
»jeù
)); })

	)

969 
__STRING_INLINE
 
size_t
 
__¡rc¥n_c1
 (
__cÚ¡
 *
__s
, 
__»jeù
);

970 
__STRING_INLINE
 
size_t


971 
	$__¡rc¥n_c1
 (
__cÚ¡
 *
__s
, 
__»jeù
)

973 
size_t
 
__»suÉ
 = 0;

974 
__s
[
__»suÉ
] !ğ'\0' && __s[__»suÉ] !ğ
__»jeù
)

975 ++
__»suÉ
;

976  
__»suÉ
;

977 
	}
}

979 
__STRING_INLINE
 
size_t
 
__¡rc¥n_c2
 (
__cÚ¡
 *
__s
, 
__»jeù1
,

980 
__»jeù2
);

981 
__STRING_INLINE
 
size_t


982 
	$__¡rc¥n_c2
 (
__cÚ¡
 *
__s
, 
__»jeù1
, 
__»jeù2
)

984 
size_t
 
__»suÉ
 = 0;

985 
__s
[
__»suÉ
] !ğ'\0' && __s[__»suÉ] !ğ
__»jeù1


986 && 
__s
[
__»suÉ
] !ğ
__»jeù2
)

987 ++
__»suÉ
;

988  
__»suÉ
;

989 
	}
}

991 
__STRING_INLINE
 
size_t
 
__¡rc¥n_c3
 (
__cÚ¡
 *
__s
, 
__»jeù1
,

992 
__»jeù2
, 
__»jeù3
);

993 
__STRING_INLINE
 
size_t


994 
	$__¡rc¥n_c3
 (
__cÚ¡
 *
__s
, 
__»jeù1
, 
__»jeù2
,

995 
__»jeù3
)

997 
size_t
 
__»suÉ
 = 0;

998 
__s
[
__»suÉ
] !ğ'\0' && __s[__»suÉ] !ğ
__»jeù1


999 && 
__s
[
__»suÉ
] !ğ
__»jeù2
 && __s[__»suÉ] !ğ
__»jeù3
)

1000 ++
__»suÉ
;

1001  
__»suÉ
;

1002 
	}
}

1008 #ià!
defšed
 
_HAVE_STRING_ARCH_¡r¥n
 || defšed 
_FORCE_INLINES


1009 #iâdeà
_HAVE_STRING_ARCH_¡r¥n


1010 #ià
__GNUC_PREREQ
 (3, 2)

1011 
	#¡r¥n
(
s
, 
acû±
) \

1012 
__ex‹nsiÚ__
 \

1013 ({ 
__a0
, 
__a1
, 
__a2
; \

1014 (
	`__butš_cÚ¡ªt_p
 (
acû±
è&& 
	`__¡ršg2_1b±r_p
 (accept) \

1015 ? ((
	`__butš_cÚ¡ªt_p
 (
s
è&& 
	`__¡ršg2_1b±r_p
 (s)) \

1016 ? 
	`__butš_¡r¥n
 (
s
, 
acû±
) \

1017 : ((
__a0
 = ((
__cÚ¡
 *è(
acû±
))[0], __a0 == '\0') \

1018 ? ((è(
s
), 0) \

1019 : ((
__a1
 = ((
__cÚ¡
 *è(
acû±
))[1], __a1 == '\0') \

1020 ? 
	`__¡r¥n_c1
 (
s
, 
__a0
) \

1021 : ((
__a2
 = ((
__cÚ¡
 *è(
acû±
))[2], __a2 == '\0') \

1022 ? 
	`__¡r¥n_c2
 (
s
, 
__a0
, 
__a1
) \

1023 : (((
__cÚ¡
 *è(
acû±
))[3] == '\0' \

1024 ? 
	`__¡r¥n_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1025 : 
	`__butš_¡r¥n
 (
s
, 
acû±
)))))) \

1026 : 
	`__butš_¡r¥n
 (
s
, 
acû±
)); })

	)

1028 
	#¡r¥n
(
s
, 
acû±
) \

1029 
__ex‹nsiÚ__
 \

1030 ({ 
__a0
, 
__a1
, 
__a2
; \

1031 (
	`__butš_cÚ¡ªt_p
 (
acû±
è&& 
	`__¡ršg2_1b±r_p
 (accept) \

1032 ? ((
__a0
 = ((
__cÚ¡
 *è(
acû±
))[0], __a0 == '\0') \

1033 ? ((è(
s
), 0) \

1034 : ((
__a1
 = ((
__cÚ¡
 *è(
acû±
))[1], __a1 == '\0') \

1035 ? 
	`__¡r¥n_c1
 (
s
, 
__a0
) \

1036 : ((
__a2
 = ((
__cÚ¡
 *è(
acû±
))[2], __a2 == '\0') \

1037 ? 
	`__¡r¥n_c2
 (
s
, 
__a0
, 
__a1
) \

1038 : (((
__cÚ¡
 *è(
acû±
))[3] == '\0' \

1039 ? 
	`__¡r¥n_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1040 : 
	`¡r¥n
 (
s
, 
acû±
))))) \

1041 : 
	`¡r¥n
 (
s
, 
acû±
)); })

	)

1045 
__STRING_INLINE
 
size_t
 
__¡r¥n_c1
 (
__cÚ¡
 *
__s
, 
__acû±
);

1046 
__STRING_INLINE
 
size_t


1047 
	$__¡r¥n_c1
 (
__cÚ¡
 *
__s
, 
__acû±
)

1049 
size_t
 
__»suÉ
 = 0;

1051 
__s
[
__»suÉ
] =ğ
__acû±
)

1052 ++
__»suÉ
;

1053  
__»suÉ
;

1054 
	}
}

1056 
__STRING_INLINE
 
size_t
 
__¡r¥n_c2
 (
__cÚ¡
 *
__s
, 
__acû±1
,

1057 
__acû±2
);

1058 
__STRING_INLINE
 
size_t


1059 
	$__¡r¥n_c2
 (
__cÚ¡
 *
__s
, 
__acû±1
, 
__acû±2
)

1061 
size_t
 
__»suÉ
 = 0;

1063 
__s
[
__»suÉ
] =ğ
__acû±1
 || __s[__»suÉ] =ğ
__acû±2
)

1064 ++
__»suÉ
;

1065  
__»suÉ
;

1066 
	}
}

1068 
__STRING_INLINE
 
size_t
 
__¡r¥n_c3
 (
__cÚ¡
 *
__s
, 
__acû±1
,

1069 
__acû±2
, 
__acû±3
);

1070 
__STRING_INLINE
 
size_t


1071 
	$__¡r¥n_c3
 (
__cÚ¡
 *
__s
, 
__acû±1
, 
__acû±2
, 
__acû±3
)

1073 
size_t
 
__»suÉ
 = 0;

1075 
__s
[
__»suÉ
] =ğ
__acû±1
 || __s[__»suÉ] =ğ
__acû±2


1076 || 
__s
[
__»suÉ
] =ğ
__acû±3
)

1077 ++
__»suÉ
;

1078  
__»suÉ
;

1079 
	}
}

1084 #ià!
defšed
 
_HAVE_STRING_ARCH_¡½brk
 || defšed 
_FORCE_INLINES


1085 #iâdeà
_HAVE_STRING_ARCH_¡½brk


1086 #ià
__GNUC_PREREQ
 (3, 2)

1087 
	#¡½brk
(
s
, 
acû±
) \

1088 
__ex‹nsiÚ__
 \

1089 ({ 
__a0
, 
__a1
, 
__a2
; \

1090 (
	`__butš_cÚ¡ªt_p
 (
acû±
è&& 
	`__¡ršg2_1b±r_p
 (accept) \

1091 ? ((
	`__butš_cÚ¡ªt_p
 (
s
è&& 
	`__¡ršg2_1b±r_p
 (s)) \

1092 ? 
	`__butš_¡½brk
 (
s
, 
acû±
) \

1093 : ((
__a0
 = ((
__cÚ¡
 *è(
acû±
))[0], __a0 == '\0') \

1094 ? ((è(
s
), (*è
NULL
) \

1095 : ((
__a1
 = ((
__cÚ¡
 *è(
acû±
))[1], __a1 == '\0') \

1096 ? 
	`__butš_¡rchr
 (
s
, 
__a0
) \

1097 : ((
__a2
 = ((
__cÚ¡
 *è(
acû±
))[2], __a2 == '\0') \

1098 ? 
	`__¡½brk_c2
 (
s
, 
__a0
, 
__a1
) \

1099 : (((
__cÚ¡
 *è(
acû±
))[3] == '\0' \

1100 ? 
	`__¡½brk_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1101 : 
	`__butš_¡½brk
 (
s
, 
acû±
)))))) \

1102 : 
	`__butš_¡½brk
 (
s
, 
acû±
)); })

	)

1104 
	#¡½brk
(
s
, 
acû±
) \

1105 
__ex‹nsiÚ__
 \

1106 ({ 
__a0
, 
__a1
, 
__a2
; \

1107 (
	`__butš_cÚ¡ªt_p
 (
acû±
è&& 
	`__¡ršg2_1b±r_p
 (accept) \

1108 ? ((
__a0
 = ((
__cÚ¡
 *è(
acû±
))[0], __a0 == '\0') \

1109 ? ((è(
s
), (*è
NULL
) \

1110 : ((
__a1
 = ((
__cÚ¡
 *è(
acû±
))[1], __a1 == '\0') \

1111 ? 
	`¡rchr
 (
s
, 
__a0
) \

1112 : ((
__a2
 = ((
__cÚ¡
 *è(
acû±
))[2], __a2 == '\0') \

1113 ? 
	`__¡½brk_c2
 (
s
, 
__a0
, 
__a1
) \

1114 : (((
__cÚ¡
 *è(
acû±
))[3] == '\0' \

1115 ? 
	`__¡½brk_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1116 : 
	`¡½brk
 (
s
, 
acû±
))))) \

1117 : 
	`¡½brk
 (
s
, 
acû±
)); })

	)

1121 
__STRING_INLINE
 *
__¡½brk_c2
 (
__cÚ¡
 *
__s
, 
__acû±1
,

1122 
__acû±2
);

1123 
__STRING_INLINE
 *

1124 
	$__¡½brk_c2
 (
__cÚ¡
 *
__s
, 
__acû±1
, 
__acû±2
)

1127 *
__s
 !ğ'\0' && *__ !ğ
__acû±1
 && *__ !ğ
__acû±2
)

1128 ++
__s
;

1129  *
__s
 =ğ'\0' ? 
NULL
 : (*è(
size_t
) __s;

1130 
	}
}

1132 
__STRING_INLINE
 *
__¡½brk_c3
 (
__cÚ¡
 *
__s
, 
__acû±1
,

1133 
__acû±2
, 
__acû±3
);

1134 
__STRING_INLINE
 *

1135 
	$__¡½brk_c3
 (
__cÚ¡
 *
__s
, 
__acû±1
, 
__acû±2
,

1136 
__acû±3
)

1139 *
__s
 !ğ'\0' && *__ !ğ
__acû±1
 && *__ !ğ
__acû±2


1140 && *
__s
 !ğ
__acû±3
)

1141 ++
__s
;

1142  *
__s
 =ğ'\0' ? 
NULL
 : (*è(
size_t
) __s;

1143 
	}
}

1149 #ià!
defšed
 
_HAVE_STRING_ARCH_¡r¡r
 && !
__GNUC_PREREQ
 (2, 97)

1150 
	#¡r¡r
(
hay¡ack
, 
ÃedË
) \

1151 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
ÃedË
è&& 
	`__¡ršg2_1b±r_p
 (needle) \

1152 ? (((
__cÚ¡
 *è(
ÃedË
))[0] == '\0' \

1153 ? (*è(
size_t
è(
hay¡ack
) \

1154 : (((
__cÚ¡
 *è(
ÃedË
))[1] == '\0' \

1155 ? 
	`¡rchr
 (
hay¡ack
, \

1156 ((
__cÚ¡
 *è(
ÃedË
))[0]) \

1157 : 
	`¡r¡r
 (
hay¡ack
, 
ÃedË
))) \

1158 : 
	`¡r¡r
 (
hay¡ack
, 
ÃedË
)))

	)

1162 #ià!
defšed
 
_HAVE_STRING_ARCH_¡¹ok_r
 || defšed 
_FORCE_INLINES


1163 #iâdeà
_HAVE_STRING_ARCH_¡¹ok_r


1164 
	#__¡¹ok_r
(
s
, 
£p
, 
Ãx
) \

1165 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
£p
è&& 
	`__¡ršg2_1b±r_p
 (sep) \

1166 && ((
__cÚ¡
 *è(
£p
))[0] != '\0' \

1167 && ((
__cÚ¡
 *è(
£p
))[1] == '\0' \

1168 ? 
	`__¡¹ok_r_1c
 (
s
, ((
__cÚ¡
 *è(
£p
))[0], 
Ãx
) \

1169 : 
	`__¡¹ok_r
 (
s
, 
£p
, 
Ãx
)))

	)

1172 
__STRING_INLINE
 *
__¡¹ok_r_1c
 (*
__s
, 
__£p
, **
__Ãx
);

1173 
__STRING_INLINE
 *

1174 
	$__¡¹ok_r_1c
 (*
__s
, 
__£p
, **
__Ãx
)

1176 *
__»suÉ
;

1177 ià(
__s
 =ğ
NULL
)

1178 
__s
 = *
__Ãx
;

1179 *
__s
 =ğ
__£p
)

1180 ++
__s
;

1181 
__»suÉ
 = 
NULL
;

1182 ià(*
__s
 != '\0')

1184 
__»suÉ
 = 
__s
++;

1185 *
__s
 != '\0')

1186 ià(*
__s
++ =ğ
__£p
)

1188 
__s
[-1] = '\0';

1192 *
__Ãx
 = 
__s
;

1193  
__»suÉ
;

1194 
	}
}

1195 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


1196 
	#¡¹ok_r
(
s
, 
£p
, 
Ãx
è
	`__¡¹ok_r
 (s, s•,‚ex)

	)

1201 #ià!
defšed
 
_HAVE_STRING_ARCH_¡r£p
 || defšed 
_FORCE_INLINES


1202 #iâdeà
_HAVE_STRING_ARCH_¡r£p


1204 *
__¡r£p_g
 (**
__¡ršgp
, 
__cÚ¡
 *
__d–im
);

1205 
	#__¡r£p
(
s
, 
»jeù
) \

1206 
__ex‹nsiÚ__
 \

1207 ({ 
__r0
, 
__r1
, 
__r2
; \

1208 (
	`__butš_cÚ¡ªt_p
 (
»jeù
è&& 
	`__¡ršg2_1b±r_p
 (reject) \

1209 && (
__r0
 = ((
__cÚ¡
 *è(
»jeù
))[0], \

1210 ((
__cÚ¡
 *è(
»jeù
))[0] != '\0') \

1211 ? ((
__r1
 = ((
__cÚ¡
 *è(
»jeù
))[1], \

1212 ((
__cÚ¡
 *è(
»jeù
))[1] == '\0') \

1213 ? 
	`__¡r£p_1c
 (
s
, 
__r0
) \

1214 : ((
__r2
 = ((
__cÚ¡
 *è(
»jeù
))[2], __r2 == '\0') \

1215 ? 
	`__¡r£p_2c
 (
s
, 
__r0
, 
__r1
) \

1216 : (((
__cÚ¡
 *è(
»jeù
))[3] == '\0' \

1217 ? 
	`__¡r£p_3c
 (
s
, 
__r0
, 
__r1
, 
__r2
) \

1218 : 
	`__¡r£p_g
 (
s
, 
»jeù
)))) \

1219 : 
	`__¡r£p_g
 (
s
, 
»jeù
)); })

	)

1222 
__STRING_INLINE
 *
__¡r£p_1c
 (**
__s
, 
__»jeù
);

1223 
__STRING_INLINE
 *

1224 
	$__¡r£p_1c
 (**
__s
, 
__»jeù
)

1226 *
__»tv®
 = *
__s
;

1227 ià(
__»tv®
 !ğ
NULL
 && (*
__s
 = 
	`¡rchr
 (__»tv®, 
__»jeù
)) != NULL)

1228 *(*
__s
)++ = '\0';

1229  
__»tv®
;

1230 
	}
}

1232 
__STRING_INLINE
 *
__¡r£p_2c
 (**
__s
, 
__»jeù1
, 
__»jeù2
);

1233 
__STRING_INLINE
 *

1234 
	$__¡r£p_2c
 (**
__s
, 
__»jeù1
, 
__»jeù2
)

1236 *
__»tv®
 = *
__s
;

1237 ià(
__»tv®
 !ğ
NULL
)

1239 *
__ı
 = 
__»tv®
;

1242 ià(*
__ı
 == '\0')

1244 
__ı
 = 
NULL
;

1247 ià(*
__ı
 =ğ
__»jeù1
 || *__ı =ğ
__»jeù2
)

1249 *
__ı
++ = '\0';

1252 ++
__ı
;

1254 *
__s
 = 
__ı
;

1256  
__»tv®
;

1257 
	}
}

1259 
__STRING_INLINE
 *
__¡r£p_3c
 (**
__s
, 
__»jeù1
, 
__»jeù2
,

1260 
__»jeù3
);

1261 
__STRING_INLINE
 *

1262 
	$__¡r£p_3c
 (**
__s
, 
__»jeù1
, 
__»jeù2
, 
__»jeù3
)

1264 *
__»tv®
 = *
__s
;

1265 ià(
__»tv®
 !ğ
NULL
)

1267 *
__ı
 = 
__»tv®
;

1270 ià(*
__ı
 == '\0')

1272 
__ı
 = 
NULL
;

1275 ià(*
__ı
 =ğ
__»jeù1
 || *__ı =ğ
__»jeù2
 || *__ı =ğ
__»jeù3
)

1277 *
__ı
++ = '\0';

1280 ++
__ı
;

1282 *
__s
 = 
__ı
;

1284  
__»tv®
;

1285 
	}
}

1286 #ifdeà
__USE_BSD


1287 
	#¡r£p
(
s
, 
»jeù
è
	`__¡r£p
 (s,„ejeù)

	)

1294 #ifdeà
__USE_MISC


1296 #ià!
defšed
 
_HAVE_STRING_ARCH_¡rdup
 || !defšed 
_HAVE_STRING_ARCH_¡ºdup


1297 
	#__Ãed_m®loc_ªd_ÿÎoc


	)

1298 
	~<¡dlib.h
>

1301 #iâdeà
_HAVE_STRING_ARCH_¡rdup


1303 *
	$__¡rdup
 (
__cÚ¡
 *
__¡ršg
è
__THROW
 
__©Œibu‹_m®loc__
;

1304 
	#__¡rdup
(
s
) \

1305 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
s
è&& 
	`__¡ršg2_1b±r_p
 (s) \

1306 ? (((
__cÚ¡
 *è(
s
))[0] == '\0' \

1307 ? (*è
	`ÿÎoc
 ((
size_t
) 1, (size_t) 1) \

1308 : ({ 
size_t
 
__Ën
 = 
	`¡¾’
 (
s
) + 1; \

1309 *
__»tv®
 = (*è
	`m®loc
 (
__Ën
); \

1310 ià(
__»tv®
 !ğ
NULL
) \

1311 
__»tv®
 = (*è
	`memıy
 (__»tv®, 
s
, 
__Ën
); \

1312 
__»tv®
; 
	}
})) \

1313 : 
	`__¡rdup
 (
s
)))

	)

1315 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


1316 
	#¡rdup
(
s
è
	`__¡rdup
 (s)

	)

1320 #iâdeà
_HAVE_STRING_ARCH_¡ºdup


1322 *
	$__¡ºdup
 (
__cÚ¡
 *
__¡ršg
, 
size_t
 
__n
)

1323 
__THROW
 
__©Œibu‹_m®loc__
;

1324 
	#__¡ºdup
(
s
, 
n
) \

1325 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
s
è&& 
	`__¡ršg2_1b±r_p
 (s) \

1326 ? (((
__cÚ¡
 *è(
s
))[0] == '\0' \

1327 ? (*è
	`ÿÎoc
 ((
size_t
) 1, (size_t) 1) \

1328 : ({ 
size_t
 
__Ën
 = 
	`¡¾’
 (
s
) + 1; \

1329 
size_t
 
__n
 = (
n
); \

1330 *
__»tv®
; \

1331 ià(
__n
 < 
__Ën
) \

1332 
__Ën
 = 
__n
 + 1; \

1333 
__»tv®
 = (*è
	`m®loc
 (
__Ën
); \

1334 ià(
__»tv®
 !ğ
NULL
) \

1336 
__»tv®
[
__Ën
 - 1] = '\0'; \

1337 
__»tv®
 = (*è
	`memıy
 (__»tv®, 
s
, \

1338 
__Ën
 - 1); \

1340 
__»tv®
; 
	}
})) \

1341 : 
	`__¡ºdup
 (
s
, 
n
)))

	)

1343 #ifdeà
__USE_GNU


1344 
	#¡ºdup
(
s
, 
n
è
	`__¡ºdup
 (s,‚)

	)

1350 #iâdeà
_FORCE_INLINES


1351 #undeà
__STRING_INLINE


	@/usr/include/bits/string3.h

19 #iâdeà
_STRING_H


23 
__w¬ndeş
 (
__w¬n_mem£t_z”o_Ën
,

26 #iâdeà
__ılu¥lus


30 #undeà
memıy


31 #undeà
memmove


32 #undeà
mem£t


33 #undeà
¡rÿt


34 #undeà
¡rıy


35 #undeà
¡ºÿt


36 #undeà
¡ºıy


37 #ifdeà
__USE_GNU


38 #undeà
mempıy


39 #undeà
¡pıy


41 #ifdeà
__USE_BSD


42 #undeà
bcİy


43 #undeà
bz”o


48 
__ex‹º_®ways_šlše
 *

49 
__NTH
 (
	$memıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
,

50 
size_t
 
__Ën
))

52  
	`__butš___memıy_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos0
 (__dest));

53 
	}
}

55 
__ex‹º_®ways_šlše
 *

56 
__NTH
 (
	$memmove
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
,

57 
size_t
 
__Ën
))

59  
	`__butš___memmove_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos0
 (__dest));

60 
	}
}

62 #ifdeà
__USE_GNU


63 
__ex‹º_®ways_šlše
 *

64 
__NTH
 (
	$mempıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
,

65 
size_t
 
__Ën
))

67  
	`__butš___mempıy_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos0
 (__dest));

68 
	}
}

77 
__ex‹º_®ways_šlše
 *

78 
__NTH
 (
	$mem£t
 (*
__de¡
, 
__ch
, 
size_t
 
__Ën
))

80 ià(
	`__butš_cÚ¡ªt_p
 (
__Ën
) && __len == 0)

82 
	`__w¬n_mem£t_z”o_Ën
 ();

83  
__de¡
;

85  
	`__butš___mem£t_chk
 (
__de¡
, 
__ch
, 
__Ën
, 
	`__bos0
 (__dest));

86 
	}
}

88 #ifdeà
__USE_BSD


89 
__ex‹º_®ways_šlše
 

90 
__NTH
 (
	$bcİy
 (
__cÚ¡
 *
__»¡riù
 
__¤c
, *__»¡riù 
__de¡
,

91 
size_t
 
__Ën
))

93 (è
	`__butš___memmove_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos0
 (__dest));

94 
	}
}

96 
__ex‹º_®ways_šlše
 

97 
__NTH
 (
	$bz”o
 (*
__de¡
, 
size_t
 
__Ën
))

99 (è
	`__butš___mem£t_chk
 (
__de¡
, '\0', 
__Ën
, 
	`__bos0
 (__dest));

100 
	}
}

103 
__ex‹º_®ways_šlše
 *

104 
__NTH
 (
	$¡rıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
))

106  
	`__butš___¡rıy_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__dest));

107 
	}
}

109 #ifdeà
__USE_GNU


110 
__ex‹º_®ways_šlše
 *

111 
__NTH
 (
	$¡pıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
))

113  
	`__butš___¡pıy_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__dest));

114 
	}
}

118 
__ex‹º_®ways_šlše
 *

119 
__NTH
 (
	$¡ºıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
,

120 
size_t
 
__Ën
))

122  
	`__butš___¡ºıy_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos
 (__dest));

123 
	}
}

126 *
	$__¡²ıy_chk
 (*
__de¡
, 
__cÚ¡
 *
__¤c
, 
size_t
 
__n
,

127 
size_t
 
__de¡Ën
è
__THROW
;

128 *
	`__REDIRECT_NTH
 (
__¡²ıy_®Ÿs
, (*
__de¡
,

129 
__cÚ¡
 *
__¤c
,

130 
size_t
 
__n
), 
¡²ıy
);

132 
__ex‹º_®ways_šlše
 *

133 
	`__NTH
 (
	$¡²ıy
 (*
__de¡
, 
__cÚ¡
 *
__¤c
, 
size_t
 
__n
))

135 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1

136 && (!
	`__butš_cÚ¡ªt_p
 (
__n
è|| __À<ğ
	`__bos
 (
__de¡
)))

137  
	`__¡²ıy_chk
 (
__de¡
, 
__¤c
, 
__n
, 
	`__bos
 (__dest));

138  
	`__¡²ıy_®Ÿs
 (
__de¡
, 
__¤c
, 
__n
);

139 
	}
}

142 
__ex‹º_®ways_šlše
 *

143 
__NTH
 (
	$¡rÿt
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
))

145  
	`__butš___¡rÿt_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__dest));

146 
	}
}

149 
__ex‹º_®ways_šlše
 *

150 
__NTH
 (
	$¡ºÿt
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
,

151 
size_t
 
__Ën
))

153  
	`__butš___¡ºÿt_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos
 (__dest));

154 
	}
}

	@/usr/include/bits/sys_errlist.h

20 #iâdeà
_STDIO_H


26 #ifdeà 
__USE_BSD


27 
sys_Ã¼
;

28 
__cÚ¡
 *__cÚ¡ 
sys_”¾i¡
[];

30 #ifdeà 
__USE_GNU


31 
_sys_Ã¼
;

32 
__cÚ¡
 *__cÚ¡ 
_sys_”¾i¡
[];

	@/usr/include/bits/types.h

24 #iâdef 
_BITS_TYPES_H


25 
	#_BITS_TYPES_H
 1

	)

27 
	~<ã©u»s.h
>

28 
	~<b™s/wÜdsize.h
>

31 
	t__u_ch¬
;

32 
	t__u_shÜt
;

33 
	t__u_št
;

34 
	t__u_lÚg
;

37 sigÃd 
	t__št8_t
;

38 
	t__ušt8_t
;

39 sigÃd 
	t__št16_t
;

40 
	t__ušt16_t
;

41 sigÃd 
	t__št32_t
;

42 
	t__ušt32_t
;

43 #ià
__WORDSIZE
 == 64

44 sigÃd 
	t__št64_t
;

45 
	t__ušt64_t
;

46 #–ià
defšed
 
__GLIBC_HAVE_LONG_LONG


47 
__ex‹nsiÚ__
 sigÃd 
	t__št64_t
;

48 
__ex‹nsiÚ__
 
	t__ušt64_t
;

52 #ià
__WORDSIZE
 == 64

53 
	t__quad_t
;

54 
	t__u_quad_t
;

55 #–ià
defšed
 
__GLIBC_HAVE_LONG_LONG


56 
__ex‹nsiÚ__
 
	t__quad_t
;

57 
__ex‹nsiÚ__
 
	t__u_quad_t
;

61 
	m__v®
[2];

62 } 
	t__quad_t
;

65 
__u_lÚg
 
	m__v®
[2];

66 } 
	t__u_quad_t
;

99 
	#__S16_TYPE
 

	)

100 
	#__U16_TYPE
 

	)

101 
	#__S32_TYPE
 

	)

102 
	#__U32_TYPE
 

	)

103 
	#__SLONGWORD_TYPE
 

	)

104 
	#__ULONGWORD_TYPE
 

	)

105 #ià
__WORDSIZE
 == 32

106 
	#__SQUAD_TYPE
 
__quad_t


	)

107 
	#__UQUAD_TYPE
 
__u_quad_t


	)

108 
	#__SWORD_TYPE
 

	)

109 
	#__UWORD_TYPE
 

	)

110 
	#__SLONG32_TYPE
 

	)

111 
	#__ULONG32_TYPE
 

	)

112 
	#__S64_TYPE
 
__quad_t


	)

113 
	#__U64_TYPE
 
__u_quad_t


	)

116 
	#__STD_TYPE
 
__ex‹nsiÚ__
 

	)

117 #–ià
__WORDSIZE
 == 64

118 
	t__SQUAD_TYPE
 

	)

119 
	t__UQUAD_TYPE
 

	)

120 
	t__SWORD_TYPE
 

	)

121 
	t__UWORD_TYPE
 

	)

122 
	t__SLONG32_TYPE
 

	)

123 
	t__ULONG32_TYPE
 

	)

124 
	t__S64_TYPE
 

	)

125 
	t__U64_TYPE
 

	)

127 
	t__STD_TYPE
 

	)

131 
	~<b™s/ty³sizes.h
>

134 
__STD_TYPE
 
	t__DEV_T_TYPE
 
	t__dev_t
;

135 
__STD_TYPE
 
__UID_T_TYPE
 
	g__uid_t
;

136 
__STD_TYPE
 
__GID_T_TYPE
 
	g__gid_t
;

137 
__STD_TYPE
 
__INO_T_TYPE
 
	g__šo_t
;

138 
__STD_TYPE
 
__INO64_T_TYPE
 
	g__šo64_t
;

139 
__STD_TYPE
 
__MODE_T_TYPE
 
	g__mode_t
;

140 
__STD_TYPE
 
__NLINK_T_TYPE
 
	g__Æšk_t
;

141 
__STD_TYPE
 
__OFF_T_TYPE
 
	g__off_t
;

142 
__STD_TYPE
 
__OFF64_T_TYPE
 
	g__off64_t
;

143 
__STD_TYPE
 
__PID_T_TYPE
 
	g__pid_t
;

144 
__STD_TYPE
 
__FSID_T_TYPE
 
	g__fsid_t
;

145 
__STD_TYPE
 
__CLOCK_T_TYPE
 
	g__şock_t
;

146 
__STD_TYPE
 
__RLIM_T_TYPE
 
	g__¾im_t
;

147 
__STD_TYPE
 
__RLIM64_T_TYPE
 
	g__¾im64_t
;

148 
__STD_TYPE
 
__ID_T_TYPE
 
	g__id_t
;

149 
__STD_TYPE
 
__TIME_T_TYPE
 
	g__time_t
;

150 
__STD_TYPE
 
__USECONDS_T_TYPE
 
	g__u£cÚds_t
;

151 
__STD_TYPE
 
__SUSECONDS_T_TYPE
 
	g__su£cÚds_t
;

153 
__STD_TYPE
 
__DADDR_T_TYPE
 
	g__daddr_t
;

154 
__STD_TYPE
 
__SWBLK_T_TYPE
 
	g__swblk_t
;

155 
__STD_TYPE
 
__KEY_T_TYPE
 
	g__key_t
;

158 
__STD_TYPE
 
__CLOCKID_T_TYPE
 
	g__şockid_t
;

161 
__STD_TYPE
 
__TIMER_T_TYPE
 
	g__tim”_t
;

164 
__STD_TYPE
 
__BLKSIZE_T_TYPE
 
	g__blksize_t
;

169 
__STD_TYPE
 
__BLKCNT_T_TYPE
 
	g__blkút_t
;

170 
__STD_TYPE
 
__BLKCNT64_T_TYPE
 
	g__blkút64_t
;

173 
__STD_TYPE
 
__FSBLKCNT_T_TYPE
 
	g__fsblkút_t
;

174 
__STD_TYPE
 
__FSBLKCNT64_T_TYPE
 
	g__fsblkút64_t
;

177 
__STD_TYPE
 
__FSFILCNT_T_TYPE
 
	g__fsfút_t
;

178 
__STD_TYPE
 
__FSFILCNT64_T_TYPE
 
	g__fsfút64_t
;

180 
__STD_TYPE
 
__SSIZE_T_TYPE
 
	g__ssize_t
;

184 
__off64_t
 
	t__loff_t
;

185 
__quad_t
 *
	t__qaddr_t
;

186 *
	t__ÿddr_t
;

189 
__STD_TYPE
 
__SWORD_TYPE
 
	g__šŒ_t
;

192 
__STD_TYPE
 
__U32_TYPE
 
	g__sockËn_t
;

195 #undeà
__STD_TYPE


	@/usr/include/bits/waitflags.h

20 #ià!
defšed
 
_SYS_WAIT_H
 && !defšed 
_STDLIB_H


26 
	#WNOHANG
 1

	)

27 
	#WUNTRACED
 2

	)

30 
	#WSTOPPED
 2

	)

31 
	#WEXITED
 4

	)

32 
	#WCONTINUED
 8

	)

33 
	#WNOWAIT
 0x01000000

	)

35 
	#__WNOTHREAD
 0x20000000

	)

37 
	#__WALL
 0x40000000

	)

38 
	#__WCLONE
 0x80000000

	)

	@/usr/include/bits/waitstatus.h

20 #ià!
defšed
 
_SYS_WAIT_H
 && !defšed 
_STDLIB_H


29 
	#__WEXITSTATUS
(
¡©us
è(((¡©usè& 0xff00è>> 8)

	)

32 
	#__WTERMSIG
(
¡©us
è((¡©usè& 0x7f)

	)

35 
	#__WSTOPSIG
(
¡©us
è
	`__WEXITSTATUS
(¡©us)

	)

38 
	#__WIFEXITED
(
¡©us
è(
	`__WTERMSIG
(¡©usè=ğ0)

	)

41 
	#__WIFSIGNALED
(
¡©us
) \

42 (((sigÃd è(((
¡©us
è& 0x7fè+ 1è>> 1è> 0)

	)

45 
	#__WIFSTOPPED
(
¡©us
è(((¡©usè& 0xffè=ğ0x7f)

	)

49 #ifdeà
WCONTINUED


50 
	#__WIFCONTINUED
(
¡©us
è((¡©usè=ğ
__W_CONTINUED
)

	)

54 
	#__WCOREDUMP
(
¡©us
è((¡©usè& 
__WCOREFLAG
)

	)

57 
	#__W_EXITCODE
(
»t
, 
sig
è(Ô‘è<< 8 | (sig))

	)

58 
	#__W_STOPCODE
(
sig
è((sigè<< 8 | 0x7f)

	)

59 
	#__W_CONTINUED
 0xffff

	)

60 
	#__WCOREFLAG
 0x80

	)

63 #ifdef 
__USE_BSD


65 
	~<’dŸn.h
>

67 
	uwa™


69 
	mw_¡©us
;

72 #if 
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


73 
	m__w_‹rmsig
:7;

74 
	m__w_cÜedump
:1;

75 
	m__w_»tcode
:8;

78 #if 
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


80 
	m__w_»tcode
:8;

81 
	m__w_cÜedump
:1;

82 
	m__w_‹rmsig
:7;

84 } 
	m__wa™_‹rmš©ed
;

87 #if 
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


88 
	m__w_¡İv®
:8;

89 
	m__w_¡İsig
:8;

92 #if 
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


94 
	m__w_¡İsig
:8;

95 
	m__w_¡İv®
:8;

97 } 
	m__wa™_¡İ³d
;

100 
	#w_‹rmsig
 
__wa™_‹rmš©ed
.
__w_‹rmsig


	)

101 
	#w_cÜedump
 
__wa™_‹rmš©ed
.
__w_cÜedump


	)

102 
	#w_»tcode
 
__wa™_‹rmš©ed
.
__w_»tcode


	)

103 
	#w_¡İsig
 
__wa™_¡İ³d
.
__w_¡İsig


	)

104 
	#w_¡İv®
 
__wa™_¡İ³d
.
__w_¡İv®


	)

	@/usr/include/features.h

19 #iâdef 
_FEATURES_H


20 
	#_FEATURES_H
 1

	)

95 #undeà
__USE_ISOC99


96 #undeà
__USE_ISOC95


97 #undeà
__USE_POSIX


98 #undeà
__USE_POSIX2


99 #undeà
__USE_POSIX199309


100 #undeà
__USE_POSIX199506


101 #undeà
__USE_XOPEN


102 #undeà
__USE_XOPEN_EXTENDED


103 #undeà
__USE_UNIX98


104 #undeà
__USE_XOPEN2K


105 #undeà
__USE_XOPEN2K8


106 #undeà
__USE_LARGEFILE


107 #undeà
__USE_LARGEFILE64


108 #undeà
__USE_FILE_OFFSET64


109 #undeà
__USE_BSD


110 #undeà
__USE_SVID


111 #undeà
__USE_MISC


112 #undeà
__USE_ATFILE


113 #undeà
__USE_GNU


114 #undeà
__USE_REENTRANT


115 #undeà
__USE_FORTIFY_LEVEL


116 #undeà
__FAVOR_BSD


117 #undeà
__KERNEL_STRICT_NAMES


121 #iâdeà
_LOOSE_KERNEL_NAMES


122 
	#__KERNEL_STRICT_NAMES


	)

126 
	#__USE_ANSI
 1

	)

135 #ià
defšed
 
__GNUC__
 && defšed 
__GNUC_MINOR__


136 
	#__GNUC_PREREQ
(
maj
, 
mš
) \

137 ((
__GNUC__
 << 16è+ 
__GNUC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

139 
	#__GNUC_PREREQ
(
maj
, 
mš
è0

	)

144 #ià
defšed
 
_BSD_SOURCE
 && \

145 !(
defšed
 
	g_POSIX_SOURCE
 || defšed 
	g_POSIX_C_SOURCE
 || \

146 
defšed
 
	g_XOPEN_SOURCE
 || defšed 
	g_XOPEN_SOURCE_EXTENDED
 || \

147 
defšed
 
	g_GNU_SOURCE
 || defšed 
	g_SVID_SOURCE
)

148 
	#__FAVOR_BSD
 1

	)

152 #ifdeà
_GNU_SOURCE


153 #undeà
_ISOC99_SOURCE


154 
	#_ISOC99_SOURCE
 1

	)

155 #undeà
_POSIX_SOURCE


156 
	#_POSIX_SOURCE
 1

	)

157 #undeà
_POSIX_C_SOURCE


158 
	#_POSIX_C_SOURCE
 200809L

	)

159 #undeà
_XOPEN_SOURCE


160 
	#_XOPEN_SOURCE
 700

	)

161 #undeà
_XOPEN_SOURCE_EXTENDED


162 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

163 #undeà
_LARGEFILE64_SOURCE


164 
	#_LARGEFILE64_SOURCE
 1

	)

165 #undeà
_BSD_SOURCE


166 
	#_BSD_SOURCE
 1

	)

167 #undeà
_SVID_SOURCE


168 
	#_SVID_SOURCE
 1

	)

169 #undeà
_ATFILE_SOURCE


170 
	#_ATFILE_SOURCE
 1

	)

175 #ià(!
defšed
 
__STRICT_ANSI__
 && !defšed 
_ISOC99_SOURCE
 && \

176 !
defšed
 
	g_POSIX_SOURCE
 && !defšed 
	g_POSIX_C_SOURCE
 && \

177 !
defšed
 
	g_XOPEN_SOURCE
 && !defšed 
	g_XOPEN_SOURCE_EXTENDED
 && \

178 !
defšed
 
	g_BSD_SOURCE
 && !defšed 
	g_SVID_SOURCE
)

179 
	#_BSD_SOURCE
 1

	)

180 
	#_SVID_SOURCE
 1

	)

187 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC9X_SOURCE
 \

188 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

189 
	#__USE_ISOC99
 1

	)

193 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC9X_SOURCE
 \

194 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

195 
	#__USE_ISOC95
 1

	)

200 #ià((!
defšed
 
__STRICT_ANSI__
 || (
_XOPEN_SOURCE
 - 0) >= 500) && \

201 !
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE
)

202 
	#_POSIX_SOURCE
 1

	)

203 #ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

204 
	#_POSIX_C_SOURCE
 2

	)

205 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

206 
	#_POSIX_C_SOURCE
 199506L

	)

207 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

208 
	#_POSIX_C_SOURCE
 200112L

	)

210 
	#_POSIX_C_SOURCE
 200809L

	)

212 
	#__USE_POSIX_IMPLICITLY
 1

	)

215 #ià
defšed
 
_POSIX_SOURCE
 || 
_POSIX_C_SOURCE
 >ğ1 || defšed 
_XOPEN_SOURCE


216 
	#__USE_POSIX
 1

	)

219 #ià
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >ğ2 || defšed 
_XOPEN_SOURCE


220 
	#__USE_POSIX2
 1

	)

223 #ià(
_POSIX_C_SOURCE
 - 0) >= 199309L

224 
	#__USE_POSIX199309
 1

	)

227 #ià(
_POSIX_C_SOURCE
 - 0) >= 199506L

228 
	#__USE_POSIX199506
 1

	)

231 #ià(
_POSIX_C_SOURCE
 - 0) >= 200112L

232 
	#__USE_XOPEN2K
 1

	)

233 #undeà
__USE_ISOC99


234 
	#__USE_ISOC99
 1

	)

237 #ià(
_POSIX_C_SOURCE
 - 0) >= 200809L

238 
	#__USE_XOPEN2K8
 1

	)

239 #undeà
_ATFILE_SOURCE


240 
	#_ATFILE_SOURCE
 1

	)

243 #ifdef 
_XOPEN_SOURCE


244 
	#__USE_XOPEN
 1

	)

245 #ià(
_XOPEN_SOURCE
 - 0) >= 500

246 
	#__USE_XOPEN_EXTENDED
 1

	)

247 
	#__USE_UNIX98
 1

	)

248 #undeà
_LARGEFILE_SOURCE


249 
	#_LARGEFILE_SOURCE
 1

	)

250 #ià(
_XOPEN_SOURCE
 - 0) >= 600

251 #ià(
_XOPEN_SOURCE
 - 0) >= 700

252 
	#__USE_XOPEN2K8
 1

	)

254 
	#__USE_XOPEN2K
 1

	)

255 #undeà
__USE_ISOC99


256 
	#__USE_ISOC99
 1

	)

259 #ifdeà
_XOPEN_SOURCE_EXTENDED


260 
	#__USE_XOPEN_EXTENDED
 1

	)

265 #ifdeà
_LARGEFILE_SOURCE


266 
	#__USE_LARGEFILE
 1

	)

269 #ifdeà
_LARGEFILE64_SOURCE


270 
	#__USE_LARGEFILE64
 1

	)

273 #ià
defšed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

274 
	#__USE_FILE_OFFSET64
 1

	)

277 #ià
defšed
 
_BSD_SOURCE
 || defšed 
_SVID_SOURCE


278 
	#__USE_MISC
 1

	)

281 #ifdef 
_BSD_SOURCE


282 
	#__USE_BSD
 1

	)

285 #ifdef 
_SVID_SOURCE


286 
	#__USE_SVID
 1

	)

289 #ifdef 
_ATFILE_SOURCE


290 
	#__USE_ATFILE
 1

	)

293 #ifdef 
_GNU_SOURCE


294 
	#__USE_GNU
 1

	)

297 #ià
defšed
 
_REENTRANT
 || defšed 
_THREAD_SAFE


298 
	#__USE_REENTRANT
 1

	)

301 #ià
defšed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

302 && 
__GNUC_PREREQ
 (4, 1è&& 
defšed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

303 #ià
_FORTIFY_SOURCE
 > 1

304 
	#__USE_FORTIFY_LEVEL
 2

	)

306 
	#__USE_FORTIFY_LEVEL
 1

	)

309 
	#__USE_FORTIFY_LEVEL
 0

	)

313 
	~<b™s/´edefs.h
>

316 
	#__STDC_ISO_10646__
 200009L

	)

324 #undeà
__GNU_LIBRARY__


325 
	#__GNU_LIBRARY__
 6

	)

329 
	#__GLIBC__
 2

	)

330 
	#__GLIBC_MINOR__
 10

	)

332 
	#__GLIBC_PREREQ
(
maj
, 
mš
) \

333 ((
__GLIBC__
 << 16è+ 
__GLIBC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

336 #ià
defšed
 
__GNUC__
 \

337 || (
defšed
 
	g__PGI
 && defšed 
	g__i386__
 ) \

338 || (
defšed
 
	g__INTEL_COMPILER
 && (defšed 
	g__i386__
 || defšed 
	g__Ÿ64__
)) \

339 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L)

340 
	#__GLIBC_HAVE_LONG_LONG
 1

	)

344 #iâdeà
__ASSEMBLER__


345 #iâdeà
_SYS_CDEFS_H


346 
	~<sys/cdefs.h
>

351 #ià
defšed
 
__USE_FILE_OFFSET64
 && !defšed 
__REDIRECT


352 
	#__USE_LARGEFILE
 1

	)

353 
	#__USE_LARGEFILE64
 1

	)

359 #ià
__GNUC_PREREQ
 (2, 7è&& 
defšed
 
__OPTIMIZE__
 \

360 && !
defšed
 
	g__OPTIMIZE_SIZE__
 && !defšed 
	g__NO_INLINE__
 \

361 && 
defšed
 
	g__ex‹º_šlše


362 
	#__USE_EXTERN_INLINES
 1

	)

367 #ià
__GNUC_PREREQ
 (2, 7è&& 
defšed
 
__OPTIMIZE__
 \

368 && (
defšed
 
	g_LIBC
 || !defšed 
	g__OPTIMIZE_SIZE__
è&& !defšed 
	g__NO_INLINE__
 \

369 && 
defšed
 
	g__ex‹º_šlše


370 
	#__USE_EXTERN_INLINES_IN_LIBC
 1

	)

378 
	~<gnu/¡ubs.h
>

	@/usr/include/getopt.h

21 #iâdeà
_GETOPT_H


23 #iâdeà
__Ãed_g‘İt


24 
	#_GETOPT_H
 1

	)

34 #ià!
defšed
 
__GNU_LIBRARY__


35 
	~<ùy³.h
>

38 #iâdeà
__THROW


39 #iâdeà
__GNUC_PREREQ


40 
	#__GNUC_PREREQ
(
maj
, 
mš
è(0)

	)

42 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,8)

43 
	#__THROW
 
	`throw
 ()

	)

45 
	#__THROW


	)

49 #ifdef 
__ılu¥lus


59 *
İrg
;

73 
İtšd
;

78 
İ‹¼
;

82 
İtİt
;

84 #iâdeà
__Ãed_g‘İt


106 
	sİtiÚ


108 cÚ¡ *
	gÇme
;

111 
	ghas_¬g
;

112 *
	gæag
;

113 
	gv®
;

118 
	#no_¬gum’t
 0

	)

119 
	#»quœed_¬gum’t
 1

	)

120 
	#İtiÚ®_¬gum’t
 2

	)

148 #ifdeà
__GNU_LIBRARY__


152 
g‘İt
 (
___¬gc
, *cÚ¡ *
___¬gv
, cÚ¡ *
__shÜtİts
)

153 
__THROW
;

155 #ià
defšed
 
__Ãed_g‘İt
 && defšed 
__USE_POSIX2
 \

156 && !
defšed
 
	g__USE_POSIX_IMPLICITLY
 && !defšed 
	g__USE_GNU


160 #ifdeà
__REDIRECT


161 
__REDIRECT
 (
g‘İt
, (
___¬gc
, *cÚ¡ *
___¬gv
,

162 cÚ¡ *
__shÜtİts
),

163 
__posix_g‘İt
è
__THROW
;

165 
__posix_g‘İt
 (
___¬gc
, *cÚ¡ *
___¬gv
,

166 cÚ¡ *
__shÜtİts
è
__THROW
;

167 
	#g‘İt
 
__posix_g‘İt


	)

171 
g‘İt
 ();

174 #iâdeà
__Ãed_g‘İt


175 
g‘İt_lÚg
 (
___¬gc
, *cÚ¡ *
___¬gv
,

176 cÚ¡ *
__shÜtİts
,

177 cÚ¡ 
İtiÚ
 *
__lÚgİts
, *
__lÚgšd
)

178 
__THROW
;

179 
g‘İt_lÚg_Úly
 (
___¬gc
, *cÚ¡ *
___¬gv
,

180 cÚ¡ *
__shÜtİts
,

181 cÚ¡ 
İtiÚ
 *
__lÚgİts
, *
__lÚgšd
)

182 
__THROW
;

186 #ifdef 
__ılu¥lus


191 #undeà
__Ãed_g‘İt


	@/usr/include/libio.h

29 #iâdeà
_IO_STDIO_H


30 
	#_IO_STDIO_H


	)

32 
	~<_G_cÚfig.h
>

34 
	#_IO_pos_t
 
_G_åos_t


	)

35 
	#_IO_åos_t
 
_G_åos_t


	)

36 
	#_IO_åos64_t
 
_G_åos64_t


	)

37 
	#_IO_size_t
 
_G_size_t


	)

38 
	#_IO_ssize_t
 
_G_ssize_t


	)

39 
	#_IO_off_t
 
_G_off_t


	)

40 
	#_IO_off64_t
 
_G_off64_t


	)

41 
	#_IO_pid_t
 
_G_pid_t


	)

42 
	#_IO_uid_t
 
_G_uid_t


	)

43 
	#_IO_icÚv_t
 
_G_icÚv_t


	)

44 
	#_IO_HAVE_SYS_WAIT
 
_G_HAVE_SYS_WAIT


	)

45 
	#_IO_HAVE_ST_BLKSIZE
 
_G_HAVE_ST_BLKSIZE


	)

46 
	#_IO_BUFSIZ
 
_G_BUFSIZ


	)

47 
	#_IO_va_li¡
 
_G_va_li¡


	)

48 
	#_IO_wšt_t
 
_G_wšt_t


	)

50 #ifdeà
_G_NEED_STDARG_H


52 
	#__Ãed___va_li¡


	)

53 
	~<¡d¬g.h
>

54 #ifdeà
__GNUC_VA_LIST


55 #undeà
_IO_va_li¡


56 
	#_IO_va_li¡
 
__gnuc_va_li¡


	)

60 #iâdeà
__P


61 #ià
_G_HAVE_SYS_CDEFS


62 
	~<sys/cdefs.h
>

64 #ifdeà
__STDC__


65 
	#__P
(
p
è
	)
p

66 
	#__PMT
(
p
è
	)
p

68 
	#__P
(
p
è()

	)

69 
	#__PMT
(
p
è()

	)

75 #iâdeà
_PARAMS


76 
	#_PARAMS
(
´Ùos
è
	`__P
ÕrÙos)

	)

79 #iâdeà
__STDC__


81 cÚ¡

	)

84 
	#_IO_UNIFIED_JUMPTABLES
 1

	)

85 #iâdeà
_G_HAVE_PRINTF_FP


86 
	#_IO_USE_DTOA
 1

	)

89 #iâdeà
EOF


90 
	#EOF
 (-1)

	)

92 #iâdeà
NULL


93 #ià
defšed
 
__GNUG__
 && \

94 (
	g__GNUC__
 > 2 || (__GNUC__ =ğ2 && 
__GNUC_MINOR__
 >= 8))

95 
	#NULL
 (
__nuÎ
)

	)

97 #ià!
defšed
(
__ılu¥lus
)

98 
	#NULL
 ((*)0)

	)

100 
	#NULL
 (0)

	)

105 
	#_IOS_INPUT
 1

	)

106 
	#_IOS_OUTPUT
 2

	)

107 
	#_IOS_ATEND
 4

	)

108 
	#_IOS_APPEND
 8

	)

109 
	#_IOS_TRUNC
 16

	)

110 
	#_IOS_NOCREATE
 32

	)

111 
	#_IOS_NOREPLACE
 64

	)

112 
	#_IOS_BIN
 128

	)

120 
	#_IO_MAGIC
 0xFBAD0000

	)

121 
	#_OLD_STDIO_MAGIC
 0xFABC0000

	)

122 
	#_IO_MAGIC_MASK
 0xFFFF0000

	)

123 
	#_IO_USER_BUF
 1

	)

124 
	#_IO_UNBUFFERED
 2

	)

125 
	#_IO_NO_READS
 4

	)

126 
	#_IO_NO_WRITES
 8

	)

127 
	#_IO_EOF_SEEN
 0x10

	)

128 
	#_IO_ERR_SEEN
 0x20

	)

129 
	#_IO_DELETE_DONT_CLOSE
 0x40

	)

130 
	#_IO_LINKED
 0x80

	)

131 
	#_IO_IN_BACKUP
 0x100

	)

132 
	#_IO_LINE_BUF
 0x200

	)

133 
	#_IO_TIED_PUT_GET
 0x400

	)

134 
	#_IO_CURRENTLY_PUTTING
 0x800

	)

135 
	#_IO_IS_APPENDING
 0x1000

	)

136 
	#_IO_IS_FILEBUF
 0x2000

	)

137 
	#_IO_BAD_SEEN
 0x4000

	)

138 
	#_IO_USER_LOCK
 0x8000

	)

140 
	#_IO_FLAGS2_MMAP
 1

	)

141 
	#_IO_FLAGS2_NOTCANCEL
 2

	)

142 #ifdeà
_LIBC


143 
	#_IO_FLAGS2_FORTIFY
 4

	)

145 
	#_IO_FLAGS2_USER_WBUF
 8

	)

146 #ifdeà
_LIBC


147 
	#_IO_FLAGS2_SCANF_STD
 16

	)

151 
	#_IO_SKIPWS
 01

	)

152 
	#_IO_LEFT
 02

	)

153 
	#_IO_RIGHT
 04

	)

154 
	#_IO_INTERNAL
 010

	)

155 
	#_IO_DEC
 020

	)

156 
	#_IO_OCT
 040

	)

157 
	#_IO_HEX
 0100

	)

158 
	#_IO_SHOWBASE
 0200

	)

159 
	#_IO_SHOWPOINT
 0400

	)

160 
	#_IO_UPPERCASE
 01000

	)

161 
	#_IO_SHOWPOS
 02000

	)

162 
	#_IO_SCIENTIFIC
 04000

	)

163 
	#_IO_FIXED
 010000

	)

164 
	#_IO_UNITBUF
 020000

	)

165 
	#_IO_STDIO
 040000

	)

166 
	#_IO_DONT_CLOSE
 0100000

	)

167 
	#_IO_BOOLALPHA
 0200000

	)

170 
_IO_jump_t
; 
	g_IO_FILE
;

173 #ifdeà
_IO_MTSAFE_IO


174 #ià
defšed
 
__GLIBC__
 && __GLIBC__ >= 2

175 
	~<b™s/¡dio-lock.h
>

180 
	t_IO_lock_t
;

186 
	s_IO_m¬k”
 {

187 
_IO_m¬k”
 *
	m_Ãxt
;

188 
_IO_FILE
 *
	m_sbuf
;

192 
	m_pos
;

194 
£t_¡»ampos
(
¡»ampos
 
¥
è{ 
	m_¥os
 = sp; }

195 
£t_off£t
(
off£t
è{ 
	m_pos
 = off£t; 
	m_¥os
 = (
¡»ampos
)(-2); }

196 
	mpublic
:

197 
¡»amm¬k”
(
¡»ambuf
 *
sb
);

198 ~
¡»amm¬k”
();

199 
§všg
(è{  
	m_¥os
 == -2; }

200 
d–
(
¡»amm¬k”
&);

201 
d–
();

206 
	e__codecvt_»suÉ


208 
	m__codecvt_ok
,

209 
	m__codecvt_·¹Ÿl
,

210 
	m__codecvt_”rÜ
,

211 
	m__codecvt_nocÚv


214 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


217 
	s_IO_codecvt


219 (*
	m__codecvt_de¡r
è(
	m_IO_codecvt
 *);

220 
__codecvt_»suÉ
 (*
__codecvt_do_out
è(
	m_IO_codecvt
 *,

221 
	m__mb¡©e_t
 *,

222 cÚ¡ 
	mwch¬_t
 *,

223 cÚ¡ 
	mwch¬_t
 *,

224 cÚ¡ 
	mwch¬_t
 **, *,

226 
__codecvt_»suÉ
 (*
__codecvt_do_unshiá
è(
	m_IO_codecvt
 *,

227 
	m__mb¡©e_t
 *, *,

229 
__codecvt_»suÉ
 (*
__codecvt_do_š
è(
	m_IO_codecvt
 *,

230 
	m__mb¡©e_t
 *,

232 cÚ¡ **, 
	mwch¬_t
 *,

233 
	mwch¬_t
 *, wchar_t **);

234 (*
	m__codecvt_do_’codšg
è(
	m_IO_codecvt
 *);

235 (*
	m__codecvt_do_®ways_nocÚv
è(
	m_IO_codecvt
 *);

236 (*
	m__codecvt_do_Ëngth
è(
	m_IO_codecvt
 *, 
	m__mb¡©e_t
 *,

237 cÚ¡ *, cÚ¡ *, 
	m_IO_size_t
);

238 (*
	m__codecvt_do_max_Ëngth
è(
	m_IO_codecvt
 *);

240 
_IO_icÚv_t
 
	m__cd_š
;

241 
_IO_icÚv_t
 
	m__cd_out
;

245 
	s_IO_wide_d©a


247 
wch¬_t
 *
	m_IO_»ad_±r
;

248 
wch¬_t
 *
	m_IO_»ad_’d
;

249 
wch¬_t
 *
	m_IO_»ad_ba£
;

250 
wch¬_t
 *
	m_IO_wr™e_ba£
;

251 
wch¬_t
 *
	m_IO_wr™e_±r
;

252 
wch¬_t
 *
	m_IO_wr™e_’d
;

253 
wch¬_t
 *
	m_IO_buf_ba£
;

254 
wch¬_t
 *
	m_IO_buf_’d
;

256 
wch¬_t
 *
	m_IO_§ve_ba£
;

257 
wch¬_t
 *
	m_IO_backup_ba£
;

259 
wch¬_t
 *
	m_IO_§ve_’d
;

261 
__mb¡©e_t
 
	m_IO_¡©e
;

262 
__mb¡©e_t
 
	m_IO_Ï¡_¡©e
;

263 
_IO_codecvt
 
	m_codecvt
;

265 
wch¬_t
 
	m_shÜtbuf
[1];

267 cÚ¡ 
_IO_jump_t
 *
	m_wide_vbË
;

271 
	s_IO_FILE
 {

272 
	m_æags
;

273 
	#_IO_fe_æags
 
_æags


	)

277 * 
	m_IO_»ad_±r
;

278 * 
	m_IO_»ad_’d
;

279 * 
	m_IO_»ad_ba£
;

280 * 
	m_IO_wr™e_ba£
;

281 * 
	m_IO_wr™e_±r
;

282 * 
	m_IO_wr™e_’d
;

283 * 
	m_IO_buf_ba£
;

284 * 
	m_IO_buf_’d
;

286 *
	m_IO_§ve_ba£
;

287 *
	m_IO_backup_ba£
;

288 *
	m_IO_§ve_’d
;

290 
_IO_m¬k”
 *
	m_m¬k”s
;

292 
_IO_FILE
 *
	m_chaš
;

294 
	m_f’o
;

296 
	m_blksize
;

298 
	m_æags2
;

300 
_IO_off_t
 
	m_Şd_off£t
;

302 
	#__HAVE_COLUMN


	)

304 
	m_cur_cŞumn
;

305 sigÃd 
	m_vbË_off£t
;

306 
	m_shÜtbuf
[1];

310 
_IO_lock_t
 *
	m_lock
;

311 #ifdeà
_IO_USE_OLD_IO_FILE


314 
	s_IO_FILE_com¶‘e


316 
_IO_FILE
 
	m_fe
;

318 #ià
defšed
 
_G_IO_IO_FILE_VERSION
 && _G_IO_IO_FILE_VERSION == 0x20001

319 
_IO_off64_t
 
	m_off£t
;

320 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


322 
_IO_codecvt
 *
	m_codecvt
;

323 
_IO_wide_d©a
 *
	m_wide_d©a
;

324 
_IO_FILE
 *
	m_ä“»s_li¡
;

325 *
	m_ä“»s_buf
;

326 
size_t
 
	m_ä“»s_size
;

328 *
	m__·d1
;

329 *
	m__·d2
;

330 *
	m__·d3
;

331 *
	m__·d4
;

332 
size_t
 
	m__·d5
;

334 
	m_mode
;

336 
	m_unu£d2
[15 *  (è- 4 *  (*è-  (
size_t
)];

340 #iâdeà
__ılu¥lus


341 
_IO_FILE
 
	t_IO_FILE
;

344 
	g_IO_FILE_¶us
;

346 
_IO_FILE_¶us
 
_IO_2_1_¡dš_
;

347 
_IO_FILE_¶us
 
_IO_2_1_¡dout_
;

348 
_IO_FILE_¶us
 
_IO_2_1_¡d”r_
;

349 #iâdeà
_LIBC


350 
	#_IO_¡dš
 ((
_IO_FILE
*)(&
_IO_2_1_¡dš_
))

	)

351 
	#_IO_¡dout
 ((
_IO_FILE
*)(&
_IO_2_1_¡dout_
))

	)

352 
	#_IO_¡d”r
 ((
_IO_FILE
*)(&
_IO_2_1_¡d”r_
))

	)

354 
_IO_FILE
 *
_IO_¡dš
 
©Œibu‹_hidd’
;

355 
_IO_FILE
 *
_IO_¡dout
 
©Œibu‹_hidd’
;

356 
_IO_FILE
 *
_IO_¡d”r
 
©Œibu‹_hidd’
;

364 
__ssize_t
 
	t__io_»ad_â
 (*
	t__cook›
, *
	t__buf
, 
	tsize_t
 
	t__nby‹s
);

372 
__ssize_t
 
	t__io_wr™e_â
 (*
	t__cook›
, 
	t__cÚ¡
 *
	t__buf
,

373 
	tsize_t
 
	t__n
);

381 
	t__io_£ek_â
 (*
	t__cook›
, 
	t_IO_off64_t
 *
	t__pos
, 
	t__w
);

384 
	t__io_şo£_â
 (*
	t__cook›
);

387 #ifdeà
_GNU_SOURCE


389 
__io_»ad_â
 
	tcook›_»ad_funùiÚ_t
;

390 
__io_wr™e_â
 
	tcook›_wr™e_funùiÚ_t
;

391 
__io_£ek_â
 
	tcook›_£ek_funùiÚ_t
;

392 
__io_şo£_â
 
	tcook›_şo£_funùiÚ_t
;

397 
__io_»ad_â
 *
	m»ad
;

398 
__io_wr™e_â
 *
	mwr™e
;

399 
__io_£ek_â
 *
	m£ek
;

400 
__io_şo£_â
 *
	mşo£
;

401 } 
	t_IO_cook›_io_funùiÚs_t
;

402 
_IO_cook›_io_funùiÚs_t
 
	tcook›_io_funùiÚs_t
;

404 
	g_IO_cook›_fe
;

407 
_IO_cook›_š™
 (
_IO_cook›_fe
 *
__cfe
, 
__»ad_wr™e
,

408 *
__cook›
, 
_IO_cook›_io_funùiÚs_t
 
__âs
);

412 #ifdeà
__ılu¥lus


416 
__und”æow
 (
_IO_FILE
 *);

417 
__uæow
 (
_IO_FILE
 *);

418 
__ov”æow
 (
_IO_FILE
 *, );

419 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


420 
_IO_wšt_t
 
__wund”æow
 (
_IO_FILE
 *);

421 
_IO_wšt_t
 
__wuæow
 (
_IO_FILE
 *);

422 
_IO_wšt_t
 
__wov”æow
 (
_IO_FILE
 *, _IO_wint_t);

425 #ià 
__GNUC__
 >= 3

426 
	#_IO_BE
(
ex´
, 
»s
è
	`__butš_ex³ù
 (Óx´),„es)

	)

428 
	#_IO_BE
(
ex´
, 
»s
èÓx´)

	)

431 
	#_IO_g‘c_uÆocked
(
_å
) \

432 (
	`_IO_BE
 ((
_å
)->
_IO_»ad_±r
 >ğ(_å)->
_IO_»ad_’d
, 0) \

433 ? 
	`__uæow
 (
_å
è: *(*è(_å)->
_IO_»ad_±r
++)

	)

434 
	#_IO_³ekc_uÆocked
(
_å
) \

435 (
	`_IO_BE
 ((
_å
)->
_IO_»ad_±r
 >ğ(_å)->
_IO_»ad_’d
, 0) \

436 && 
	`__und”æow
 (
_å
è=ğ
EOF
 ? EOF \

437 : *(*è(
_å
)->
_IO_»ad_±r
)

	)

438 
	#_IO_putc_uÆocked
(
_ch
, 
_å
) \

439 (
	`_IO_BE
 ((
_å
)->
_IO_wr™e_±r
 >ğ(_å)->
_IO_wr™e_’d
, 0) \

440 ? 
	`__ov”æow
 (
_å
, (è(
_ch
)) \

441 : (è(*(
_å
)->
_IO_wr™e_±r
++ = (
_ch
)))

	)

443 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


444 
	#_IO_g‘wc_uÆocked
(
_å
) \

445 (
	`_IO_BE
 ((
_å
)->
_wide_d©a
->
_IO_»ad_±r
 >ğ(_å)->_wide_d©a->
_IO_»ad_’d
,\

447 ? 
	`__wuæow
 (
_å
è: (
_IO_wšt_t
è*(_å)->
_wide_d©a
->
_IO_»ad_±r
++)

	)

448 
	#_IO_putwc_uÆocked
(
_wch
, 
_å
) \

449 (
	`_IO_BE
 ((
_å
)->
_wide_d©a
->
_IO_wr™e_±r
 \

450 >ğ(
_å
)->
_wide_d©a
->
_IO_wr™e_’d
, 0) \

451 ? 
	`__wov”æow
 (
_å
, 
_wch
) \

452 : (
_IO_wšt_t
è(*(
_å
)->
_wide_d©a
->
_IO_wr™e_±r
++ = (
_wch
)))

	)

455 
	#_IO_ãof_uÆocked
(
__å
è(((__å)->
_æags
 & 
_IO_EOF_SEEN
è!ğ0)

	)

456 
	#_IO_ã¼Ü_uÆocked
(
__å
è(((__å)->
_æags
 & 
_IO_ERR_SEEN
è!ğ0)

	)

458 
_IO_g‘c
 (
_IO_FILE
 *
__å
);

459 
_IO_putc
 (
__c
, 
_IO_FILE
 *
__å
);

460 
_IO_ãof
 (
_IO_FILE
 *
__å
è
__THROW
;

461 
_IO_ã¼Ü
 (
_IO_FILE
 *
__å
è
__THROW
;

463 
_IO_³ekc_locked
 (
_IO_FILE
 *
__å
);

466 
	#_IO_PENDING_OUTPUT_COUNT
(
_å
) \

467 ((
_å
)->
_IO_wr™e_±r
 - (_å)->
_IO_wr™e_ba£
)

	)

469 
_IO_æockfe
 (
_IO_FILE
 *è
__THROW
;

470 
_IO_fuÆockfe
 (
_IO_FILE
 *è
__THROW
;

471 
_IO_árylockfe
 (
_IO_FILE
 *è
__THROW
;

473 #ifdeà
_IO_MTSAFE_IO


474 
	#_IO_³ekc
(
_å
è
	`_IO_³ekc_locked
 (_å)

	)

475 
	#_IO_æockfe
(
_å
) \

476 ià(((
_å
)->
_æags
 & 
_IO_USER_LOCK
è=ğ0è
	`_IO_æockfe
 (_å)

	)

477 
	#_IO_fuÆockfe
(
_å
) \

478 ià(((
_å
)->
_æags
 & 
_IO_USER_LOCK
è=ğ0è
	`_IO_fuÆockfe
 (_å)

	)

480 
	#_IO_³ekc
(
_å
è
	`_IO_³ekc_uÆocked
 (_å)

	)

481 
	#_IO_æockfe
(
_å
è

	)

482 
	#_IO_fuÆockfe
(
_å
è

	)

483 
	#_IO_árylockfe
(
_å
è

	)

484 
	#_IO_ş—nup_»giÚ_¡¬t
(
_fù
, 
_å
è

	)

485 
	#_IO_ş—nup_»giÚ_’d
(
_Do™
è

	)

488 
_IO_vfsÿnf
 (
_IO_FILE
 * 
__»¡riù
, const * __restrict,

489 
_IO_va_li¡
, *
__»¡riù
);

490 
_IO_vårštf
 (
_IO_FILE
 *
__»¡riù
, const *__restrict,

491 
_IO_va_li¡
);

492 
_IO_ssize_t
 
_IO_·dn
 (
_IO_FILE
 *, , _IO_ssize_t);

493 
_IO_size_t
 
_IO_sg‘n
 (
_IO_FILE
 *, *, _IO_size_t);

495 
_IO_off64_t
 
_IO_£ekoff
 (
_IO_FILE
 *, _IO_off64_t, , );

496 
_IO_off64_t
 
_IO_£ekpos
 (
_IO_FILE
 *, _IO_off64_t, );

498 
_IO_ä“_backup_¬—
 (
_IO_FILE
 *è
__THROW
;

500 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


501 
_IO_wšt_t
 
_IO_g‘wc
 (
_IO_FILE
 *
__å
);

502 
_IO_wšt_t
 
_IO_putwc
 (
wch¬_t
 
__wc
, 
_IO_FILE
 *
__å
);

503 
_IO_fwide
 (
_IO_FILE
 *
__å
, 
__mode
è
__THROW
;

504 #ià
__GNUC__
 >= 2

507 #ià
defšed
 
_LIBC
 && defšed 
SHARED


508 
	~<shlib-com·t.h
>

509 #ià
SHLIB_COMPAT
 (
libc
, 
GLIBC_2_0
, 
GLIBC_2_1
)

510 
	#_IO_fwide_maybe_šcom·tibË
 \

511 (
	`__butš_ex³ù
 (&
_IO_¡dš_u£d
 =ğ
NULL
, 0))

	)

512 cÚ¡ 
_IO_¡dš_u£d
;

513 
w—k_ex‹º
 (
_IO_¡dš_u£d
);

516 #iâdeà
_IO_fwide_maybe_šcom·tibË


517 
	#_IO_fwide_maybe_šcom·tibË
 (0)

	)

521 
	#_IO_fwide
(
__å
, 
__mode
) \

522 ({ 
__»suÉ
 = (
__mode
); \

523 ià(
__»suÉ
 < 0 && ! 
_IO_fwide_maybe_šcom·tibË
) \

525 ià((
__å
)->
_mode
 == 0) \

527 (
__å
)->
_mode
 = -1; \

528 
__»suÉ
 = (
__å
)->
_mode
; \

530 ià(
	`__butš_cÚ¡ªt_p
 (
__mode
) && (__mode) == 0) \

531 
__»suÉ
 = 
_IO_fwide_maybe_šcom·tibË
 ? -1 : (
__å
)->
_mode
; \

533 
__»suÉ
 = 
	`_IO_fwide
 (
__å
, __result); \

534 
__»suÉ
; })

	)

537 
_IO_vfwsÿnf
 (
_IO_FILE
 * 
__»¡riù
, cÚ¡ 
wch¬_t
 * __restrict,

538 
_IO_va_li¡
, *
__»¡riù
);

539 
_IO_vfw´štf
 (
_IO_FILE
 *
__»¡riù
, cÚ¡ 
wch¬_t
 *__restrict,

540 
_IO_va_li¡
);

541 
_IO_ssize_t
 
_IO_w·dn
 (
_IO_FILE
 *, 
wšt_t
, _IO_ssize_t);

542 
_IO_ä“_wbackup_¬—
 (
_IO_FILE
 *è
__THROW
;

545 #ifdeà
__LDBL_COMPAT


546 
	~<b™s/libio-ldbl.h
>

549 #ifdeà
__ılu¥lus


	@/usr/include/sys/types.h

24 #iâdef 
_SYS_TYPES_H


25 
	#_SYS_TYPES_H
 1

	)

27 
	~<ã©u»s.h
>

29 
	g__BEGIN_DECLS


31 
	~<b™s/ty³s.h
>

33 #ifdef 
__USE_BSD


34 #iâdeà
__u_ch¬_defšed


35 
__u_ch¬
 
	tu_ch¬
;

36 
__u_shÜt
 
	tu_shÜt
;

37 
__u_št
 
	tu_št
;

38 
__u_lÚg
 
	tu_lÚg
;

39 
__quad_t
 
	tquad_t
;

40 
__u_quad_t
 
	tu_quad_t
;

41 
__fsid_t
 
	tfsid_t
;

42 
	#__u_ch¬_defšed


	)

46 
__loff_t
 
	tloff_t
;

48 #iâdeà
__šo_t_defšed


49 #iâdeà
__USE_FILE_OFFSET64


50 
__šo_t
 
	tšo_t
;

52 
__šo64_t
 
	tšo_t
;

54 
	#__šo_t_defšed


	)

56 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__šo64_t_defšed


57 
__šo64_t
 
	tšo64_t
;

58 
	#__šo64_t_defšed


	)

61 #iâdeà
__dev_t_defšed


62 
__dev_t
 
	tdev_t
;

63 
	#__dev_t_defšed


	)

66 #iâdeà
__gid_t_defšed


67 
__gid_t
 
	tgid_t
;

68 
	#__gid_t_defšed


	)

71 #iâdeà
__mode_t_defšed


72 
__mode_t
 
	tmode_t
;

73 
	#__mode_t_defšed


	)

76 #iâdeà
__Æšk_t_defšed


77 
__Æšk_t
 
	tÆšk_t
;

78 
	#__Æšk_t_defšed


	)

81 #iâdeà
__uid_t_defšed


82 
__uid_t
 
	tuid_t
;

83 
	#__uid_t_defšed


	)

86 #iâdeà
__off_t_defšed


87 #iâdeà
__USE_FILE_OFFSET64


88 
__off_t
 
	toff_t
;

90 
__off64_t
 
	toff_t
;

92 
	#__off_t_defšed


	)

94 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


95 
__off64_t
 
	toff64_t
;

96 
	#__off64_t_defšed


	)

99 #iâdeà
__pid_t_defšed


100 
__pid_t
 
	tpid_t
;

101 
	#__pid_t_defšed


	)

104 #ià(
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN
è&& !defšed 
__id_t_defšed


105 
__id_t
 
	tid_t
;

106 
	#__id_t_defšed


	)

109 #iâdeà
__ssize_t_defšed


110 
__ssize_t
 
	tssize_t
;

111 
	#__ssize_t_defšed


	)

114 #ifdef 
__USE_BSD


115 #iâdeà
__daddr_t_defšed


116 
__daddr_t
 
	tdaddr_t
;

117 
__ÿddr_t
 
	tÿddr_t
;

118 
	#__daddr_t_defšed


	)

122 #ià(
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN
è&& !defšed 
__key_t_defšed


123 
__key_t
 
	tkey_t
;

124 
	#__key_t_defšed


	)

127 #ifdeà
__USE_XOPEN


128 
	#__Ãed_şock_t


	)

130 
	#__Ãed_time_t


	)

131 
	#__Ãed_tim”_t


	)

132 
	#__Ãed_şockid_t


	)

133 
	~<time.h
>

135 #ifdeà
__USE_XOPEN


136 #iâdeà
__u£cÚds_t_defšed


137 
__u£cÚds_t
 
	tu£cÚds_t
;

138 
	#__u£cÚds_t_defšed


	)

140 #iâdeà
__su£cÚds_t_defšed


141 
__su£cÚds_t
 
	tsu£cÚds_t
;

142 
	#__su£cÚds_t_defšed


	)

146 
	#__Ãed_size_t


	)

147 
	~<¡ddef.h
>

149 #ifdeà
__USE_MISC


151 
	tulÚg
;

152 
	tushÜt
;

153 
	tušt
;

158 #ià!
__GNUC_PREREQ
 (2, 7)

161 #iâdeà
__št8_t_defšed


162 
	#__št8_t_defšed


	)

163 
	tšt8_t
;

164 
	tšt16_t
;

165 
	tšt32_t
;

166 #ià
__WORDSIZE
 == 64

167 
	tšt64_t
;

168 #–ià
__GLIBC_HAVE_LONG_LONG


169 
__ex‹nsiÚ__
 
	tšt64_t
;

174 
	tu_št8_t
;

175 
	tu_št16_t
;

176 
	tu_št32_t
;

177 #ià
__WORDSIZE
 == 64

178 
	tu_št64_t
;

179 #–ià
__GLIBC_HAVE_LONG_LONG


180 
__ex‹nsiÚ__
 
	tu_št64_t
;

183 
	t»gi¡”_t
;

188 
	#__štN_t
(
N
, 
MODE
) \

189 ##
	tN
##
	t_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	tMODE
)))

	)

190 
	t__u_štN_t
(
	tN
, 
	tMODE
) \

191 
	tu_št
##
	tN
##
	t_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	tMODE
)))

	)

193 #iâdeà
	t__št8_t_defšed


194 
	t__št8_t_defšed


	)

195 
	t__štN_t
 (8, 
	t__QI__
);

196 
__štN_t
 (16, 
__HI__
);

197 
__štN_t
 (32, 
__SI__
);

198 
__štN_t
 (64, 
__DI__
);

201 
__u_štN_t
 (8, 
__QI__
);

202 
__u_štN_t
 (16, 
__HI__
);

203 
__u_štN_t
 (32, 
__SI__
);

204 
__u_štN_t
 (64, 
__DI__
);

206 
	t»gi¡”_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	t__wÜd__
)));

212 
	#__BIT_TYPES_DEFINED__
 1

	)

215 #ifdef 
__USE_BSD


217 
	~<’dŸn.h
>

220 
	~<sys/£Ëù.h
>

223 
	~<sys/sysmaüos.h
>

227 #ià
defšed
 
__USE_UNIX98
 && !defšed 
__blksize_t_defšed


228 
__blksize_t
 
	tblksize_t
;

229 
	#__blksize_t_defšed


	)

233 #iâdeà
__USE_FILE_OFFSET64


234 #iâdeà
__blkút_t_defšed


235 
__blkút_t
 
	tblkút_t
;

236 
	#__blkút_t_defšed


	)

238 #iâdeà
__fsblkút_t_defšed


239 
__fsblkút_t
 
	tfsblkút_t
;

240 
	#__fsblkút_t_defšed


	)

242 #iâdeà
__fsfút_t_defšed


243 
__fsfút_t
 
	tfsfút_t
;

244 
	#__fsfút_t_defšed


	)

247 #iâdeà
__blkút_t_defšed


248 
__blkút64_t
 
	tblkút_t
;

249 
	#__blkút_t_defšed


	)

251 #iâdeà
__fsblkút_t_defšed


252 
__fsblkút64_t
 
	tfsblkút_t
;

253 
	#__fsblkút_t_defšed


	)

255 #iâdeà
__fsfút_t_defšed


256 
__fsfút64_t
 
	tfsfút_t
;

257 
	#__fsfút_t_defšed


	)

261 #ifdeà
__USE_LARGEFILE64


262 
__blkút64_t
 
	tblkút64_t
;

263 
__fsblkút64_t
 
	tfsblkút64_t
;

264 
__fsfút64_t
 
	tfsfút64_t
;

269 #ià
defšed
 
__USE_POSIX199506
 || defšed 
__USE_UNIX98


270 
	~<b™s/±h»adty³s.h
>

273 
	g__END_DECLS


	@/usr/include/xlocale.h

21 #iâdeà
_XLOCALE_H


22 
	#_XLOCALE_H
 1

	)

28 
	s__loÿË_¡ruù


31 
loÿË_d©a
 *
	m__loÿËs
[13];

34 cÚ¡ *
	m__ùy³_b
;

35 cÚ¡ *
	m__ùy³_tŞow”
;

36 cÚ¡ *
	m__ùy³_touµ”
;

39 cÚ¡ *
	m__Çmes
[13];

40 } *
	t__loÿË_t
;

43 
__loÿË_t
 
	tloÿË_t
;

	@/usr/include/_G_config.h

4 #iâdeà
_G_cÚfig_h


5 
	#_G_cÚfig_h
 1

	)

9 
	~<b™s/ty³s.h
>

10 
	#__Ãed_size_t


	)

11 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


12 
	#__Ãed_wch¬_t


	)

14 
	#__Ãed_NULL


	)

15 
	~<¡ddef.h
>

16 
	#__Ãed_mb¡©e_t


	)

17 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


18 
	#__Ãed_wšt_t


	)

20 
	~<wch¬.h
>

21 
	#_G_size_t
 
size_t


	)

24 
__off_t
 
	m__pos
;

25 
__mb¡©e_t
 
	m__¡©e
;

26 } 
	t_G_åos_t
;

29 
__off64_t
 
	m__pos
;

30 
__mb¡©e_t
 
	m__¡©e
;

31 } 
	t_G_åos64_t
;

32 
	#_G_ssize_t
 
__ssize_t


	)

33 
	#_G_off_t
 
__off_t


	)

34 
	#_G_off64_t
 
__off64_t


	)

35 
	#_G_pid_t
 
__pid_t


	)

36 
	#_G_uid_t
 
__uid_t


	)

37 
	#_G_wch¬_t
 
wch¬_t


	)

38 
	#_G_wšt_t
 
wšt_t


	)

39 
	#_G_¡©64
 
¡©64


	)

40 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


41 
	~<gcÚv.h
>

44 
__gcÚv_šfo
 
	m__cd
;

47 
__gcÚv_šfo
 
	m__cd
;

48 
__gcÚv_¡•_d©a
 
	m__d©a
;

49 } 
	m__combšed
;

50 } 
	t_G_icÚv_t
;

53 
	t_G_št16_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	t__HI__
)));

54 
	t_G_št32_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	t__SI__
)));

55 
	t_G_ušt16_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	t__HI__
)));

56 
	t_G_ušt32_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	t__SI__
)));

58 
	#_G_HAVE_BOOL
 1

	)

62 
	#_G_HAVE_ATEXIT
 1

	)

63 
	#_G_HAVE_SYS_CDEFS
 1

	)

64 
	#_G_HAVE_SYS_WAIT
 1

	)

65 
	#_G_NEED_STDARG_H
 1

	)

66 
	#_G_va_li¡
 
__gnuc_va_li¡


	)

68 
	#_G_HAVE_PRINTF_FP
 1

	)

69 
	#_G_HAVE_MMAP
 1

	)

70 
	#_G_HAVE_MREMAP
 1

	)

71 
	#_G_HAVE_LONG_DOUBLE_IO
 1

	)

72 
	#_G_HAVE_IO_FILE_OPEN
 1

	)

73 
	#_G_HAVE_IO_GETLINE_INFO
 1

	)

75 
	#_G_IO_IO_FILE_VERSION
 0x20001

	)

77 
	#_G_OPEN64
 
__İ’64


	)

78 
	#_G_LSEEK64
 
__l£ek64


	)

79 
	#_G_MMAP64
 
__mm­64


	)

80 
	#_G_FSTAT64
(
fd
,
buf
è
	`__fx¡©64
 (
_STAT_VER
, fd, buf)

	)

83 
	#_G_HAVE_ST_BLKSIZE
 
	`defšed
 (
_STATBUF_ST_BLKSIZE
)

	)

85 
	#_G_BUFSIZ
 8192

	)

88 
	#_G_NAMES_HAVE_UNDERSCORE
 0

	)

89 
	#_G_VTABLE_LABEL_HAS_LENGTH
 1

	)

90 
	#_G_USING_THUNKS
 1

	)

91 
	#_G_VTABLE_LABEL_PREFIX
 "__vt_"

	)

92 
	#_G_VTABLE_LABEL_PREFIX_ID
 
__vt_


	)

95 #ià
defšed
 
__ılu¥lus
 || defšed 
__STDC__


96 
	#_G_ARGS
(
ARGLIST
è
	)
ARGLIST

98 
	#_G_ARGS
(
ARGLIST
è()

	)

	@/usr/include/bits/libio-ldbl.h

20 #iâdeà
_IO_STDIO_H


24 
	$__LDBL_REDIR_DECL
 (
_IO_vfsÿnf
)

25 
	`__LDBL_REDIR_DECL
 (
_IO_vårštf
)

	@/usr/include/bits/predefs.h

19 #iâdeà
_FEATURES_H


23 #iâdeà
_PREDEFS_H


24 
	#_PREDEFS_H


	)

27 
	#__STDC_IEC_559__
 1

	)

28 
	#__STDC_IEC_559_COMPLEX__
 1

	)

	@/usr/include/bits/pthreadtypes.h

20 #iâdeà
_BITS_PTHREADTYPES_H


21 
	#_BITS_PTHREADTYPES_H
 1

	)

23 
	~<b™s/wÜdsize.h
>

25 #ià
__WORDSIZE
 == 64

26 
	#__SIZEOF_PTHREAD_ATTR_T
 56

	)

27 
	#__SIZEOF_PTHREAD_MUTEX_T
 40

	)

28 
	#__SIZEOF_PTHREAD_MUTEXATTR_T
 4

	)

29 
	#__SIZEOF_PTHREAD_COND_T
 48

	)

30 
	#__SIZEOF_PTHREAD_CONDATTR_T
 4

	)

31 
	#__SIZEOF_PTHREAD_RWLOCK_T
 56

	)

32 
	#__SIZEOF_PTHREAD_RWLOCKATTR_T
 8

	)

33 
	#__SIZEOF_PTHREAD_BARRIER_T
 32

	)

34 
	#__SIZEOF_PTHREAD_BARRIERATTR_T
 4

	)

36 
	#__SIZEOF_PTHREAD_ATTR_T
 36

	)

37 
	#__SIZEOF_PTHREAD_MUTEX_T
 24

	)

38 
	#__SIZEOF_PTHREAD_MUTEXATTR_T
 4

	)

39 
	#__SIZEOF_PTHREAD_COND_T
 48

	)

40 
	#__SIZEOF_PTHREAD_CONDATTR_T
 4

	)

41 
	#__SIZEOF_PTHREAD_RWLOCK_T
 32

	)

42 
	#__SIZEOF_PTHREAD_RWLOCKATTR_T
 8

	)

43 
	#__SIZEOF_PTHREAD_BARRIER_T
 20

	)

44 
	#__SIZEOF_PTHREAD_BARRIERATTR_T
 4

	)

50 
	t±h»ad_t
;

55 
	m__size
[
__SIZEOF_PTHREAD_ATTR_T
];

56 
	m__®ign
;

57 } 
	t±h»ad_©Œ_t
;

60 #ià
__WORDSIZE
 == 64

61 
	s__±h»ad_š‹º®_li¡


63 
__±h»ad_š‹º®_li¡
 *
	m__´ev
;

64 
__±h»ad_š‹º®_li¡
 *
	m__Ãxt
;

65 } 
	t__±h»ad_li¡_t
;

67 
	s__±h»ad_š‹º®_¦i¡


69 
__±h»ad_š‹º®_¦i¡
 *
	m__Ãxt
;

70 } 
	t__±h»ad_¦i¡_t
;

78 
	s__±h»ad_mu‹x_s


80 
	m__lock
;

81 
	m__couÁ
;

82 
	m__owÃr
;

83 #ià
__WORDSIZE
 == 64

84 
	m__nu£rs
;

88 
	m__kšd
;

89 #ià
__WORDSIZE
 == 64

90 
	m__¥šs
;

91 
__±h»ad_li¡_t
 
	m__li¡
;

92 
	#__PTHREAD_MUTEX_HAVE_PREV
 1

	)

94 
	m__nu£rs
;

95 
__ex‹nsiÚ__
 union

97 
	m__¥šs
;

98 
__±h»ad_¦i¡_t
 
	m__li¡
;

101 } 
	m__d©a
;

102 
	m__size
[
__SIZEOF_PTHREAD_MUTEX_T
];

103 
	m__®ign
;

104 } 
	t±h»ad_mu‹x_t
;

108 
	m__size
[
__SIZEOF_PTHREAD_MUTEXATTR_T
];

109 
	m__®ign
;

110 } 
	t±h»ad_mu‹x©Œ_t
;

119 
	m__lock
;

120 
	m__fu‹x
;

121 
__ex‹nsiÚ__
 
	m__tÙ®_£q
;

122 
__ex‹nsiÚ__
 
	m__wakeup_£q
;

123 
__ex‹nsiÚ__
 
	m__wok’_£q
;

124 *
	m__mu‹x
;

125 
	m__nwa™”s
;

126 
	m__brßdÿ¡_£q
;

127 } 
	m__d©a
;

128 
	m__size
[
__SIZEOF_PTHREAD_COND_T
];

129 
__ex‹nsiÚ__
 
	m__®ign
;

130 } 
	t±h»ad_cÚd_t
;

134 
	m__size
[
__SIZEOF_PTHREAD_CONDATTR_T
];

135 
	m__®ign
;

136 } 
	t±h»ad_cÚd©Œ_t
;

140 
	t±h»ad_key_t
;

144 
	t±h»ad_Úû_t
;

147 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


152 #ià
__WORDSIZE
 == 64

155 
	m__lock
;

156 
	m__Ä_»ad”s
;

157 
	m__»ad”s_wakeup
;

158 
	m__wr™”_wakeup
;

159 
	m__Ä_»ad”s_queued
;

160 
	m__Ä_wr™”s_queued
;

161 
	m__wr™”
;

162 
	m__sh¬ed
;

163 
	m__·d1
;

164 
	m__·d2
;

167 
	m__æags
;

168 } 
	m__d©a
;

172 
	m__lock
;

173 
	m__Ä_»ad”s
;

174 
	m__»ad”s_wakeup
;

175 
	m__wr™”_wakeup
;

176 
	m__Ä_»ad”s_queued
;

177 
	m__Ä_wr™”s_queued
;

180 
	m__æags
;

181 
	m__sh¬ed
;

182 
	m__·d1
;

183 
	m__·d2
;

184 
	m__wr™”
;

185 } 
	m__d©a
;

187 
	m__size
[
__SIZEOF_PTHREAD_RWLOCK_T
];

188 
	m__®ign
;

189 } 
	t±h»ad_rwlock_t
;

193 
	m__size
[
__SIZEOF_PTHREAD_RWLOCKATTR_T
];

194 
	m__®ign
;

195 } 
	t±h»ad_rwlock©Œ_t
;

199 #ifdeà
__USE_XOPEN2K


201 vŞ©
	t±h»ad_¥šlock_t
;

208 
	m__size
[
__SIZEOF_PTHREAD_BARRIER_T
];

209 
	m__®ign
;

210 } 
	t±h»ad_b¬r›r_t
;

214 
	m__size
[
__SIZEOF_PTHREAD_BARRIERATTR_T
];

215 
	m__®ign
;

216 } 
	t±h»ad_b¬r›¿‰r_t
;

220 #ià
__WORDSIZE
 == 32

222 
	#__ş—nup_fù_©Œibu‹
 
	`__©Œibu‹__
 ((
	`__»g·rm__
 (1)))

	)

	@/usr/include/bits/stdio-lock.h

20 #iâdeà
_BITS_STDIO_LOCK_H


21 
	#_BITS_STDIO_LOCK_H
 1

	)

23 
	~<b™s/libc-lock.h
>

24 
	~<lowËv–lock.h
>

28 
	#_IO_lock_šex³nsive
 1

	)

30 ¡ruù { 
	mlock
; 
	mút
; *
	mowÃr
; } 
	t_IO_lock_t
;

32 
	#_IO_lock_š™Ÿliz”
 { 
LLL_LOCK_INITIALIZER
, 0, 
NULL
 }

	)

34 
	#_IO_lock_š™
(
_Çme
) \

35 ((
_Çme
èğ(
_IO_lock_t
è
_IO_lock_š™Ÿliz”
 , 0)

	)

37 
	#_IO_lock_fši
(
_Çme
) \

38 ((è0)

	)

40 
	#_IO_lock_lock
(
_Çme
) \

42 *
__£lf
 = 
THREAD_SELF
; \

43 ià((
_Çme
).
owÃr
 !ğ
__£lf
) \

45 
	`Îl_lock
 ((
_Çme
).
lock
, 
LLL_PRIVATE
); \

46 (
_Çme
).
owÃr
 = 
__£lf
; \

48 ++(
_Çme
).
út
; \

49 } 0)

	)

51 
	#_IO_lock_Œylock
(
_Çme
) \

53 
__»suÉ
 = 0; \

54 *
__£lf
 = 
THREAD_SELF
; \

55 ià((
_Çme
).
owÃr
 !ğ
__£lf
) \

57 ià(
	`Îl_Œylock
 ((
_Çme
).
lock
) == 0) \

59 (
_Çme
).
owÃr
 = 
__£lf
; \

60 (
_Çme
).
út
 = 1; \

63 
__»suÉ
 = 
EBUSY
; \

66 ++(
_Çme
).
út
; \

67 
__»suÉ
; \

68 })

	)

70 
	#_IO_lock_uÆock
(
_Çme
) \

72 ià(--(
_Çme
).
út
 == 0) \

74 (
_Çme
).
owÃr
 = 
NULL
; \

75 
	`Îl_uÆock
 ((
_Çme
).
lock
, 
LLL_PRIVATE
); \

77 } 0)

	)

81 
	#_IO_ş—nup_»giÚ_¡¬t
(
_fù
, 
_å
) \

82 
	`__libc_ş—nup_»giÚ_¡¬t
 (((
_å
)->
_æags
 & 
_IO_USER_LOCK
è=ğ0, 
_fù
, _å)

	)

83 
	#_IO_ş—nup_»giÚ_¡¬t_nßrg
(
_fù
) \

84 
	`__libc_ş—nup_»giÚ_¡¬t
 (1, 
_fù
, 
NULL
)

	)

85 
	#_IO_ş—nup_»giÚ_’d
(
_do™
) \

86 
	`__libc_ş—nup_»giÚ_’d
 (
_do™
)

	)

88 #ià
defšed
 
_LIBC
 && !defšed 
NOT_IN_libc


90 #ifdeà
__EXCEPTIONS


91 
	#_IO_acquœe_lock
(
_å
) \

93 
_IO_FILE
 *
_IO_acquœe_lock_fe
 \

94 
	`__©Œibu‹__
((
	`ş—nup
 (
_IO_acquœe_lock_fù
))) \

95 ğ(
_å
); \

96 
	`_IO_æockfe
 (
_IO_acquœe_lock_fe
);

	)

97 
	#_IO_acquœe_lock_ş—r_æags2
(
_å
) \

99 
_IO_FILE
 *
_IO_acquœe_lock_fe
 \

100 
	`__©Œibu‹__
((
	`ş—nup
 (
_IO_acquœe_lock_ş—r_æags2_fù
))) \

101 ğ(
_å
); \

102 
	`_IO_æockfe
 (
_IO_acquœe_lock_fe
);

	)

104 
	#_IO_acquœe_lock
(
_å
è
_IO_acquœe_lock_Ãeds_exû±iÚs_’abËd


	)

105 
	#_IO_acquœe_lock_ş—r_æags2
(
_å
è
	`_IO_acquœe_lock
 (_å)

	)

107 
	#_IO_»Ëa£_lock
(
_å
è; } 0)

	)

	@/usr/include/bits/typesizes.h

20 #iâdeà
_BITS_TYPES_H


24 #iâdef 
_BITS_TYPESIZES_H


25 
	#_BITS_TYPESIZES_H
 1

	)

30 
	#__DEV_T_TYPE
 
__UQUAD_TYPE


	)

31 
	#__UID_T_TYPE
 
__U32_TYPE


	)

32 
	#__GID_T_TYPE
 
__U32_TYPE


	)

33 
	#__INO_T_TYPE
 
__ULONGWORD_TYPE


	)

34 
	#__INO64_T_TYPE
 
__UQUAD_TYPE


	)

35 
	#__MODE_T_TYPE
 
__U32_TYPE


	)

36 
	#__NLINK_T_TYPE
 
__UWORD_TYPE


	)

37 
	#__OFF_T_TYPE
 
__SLONGWORD_TYPE


	)

38 
	#__OFF64_T_TYPE
 
__SQUAD_TYPE


	)

39 
	#__PID_T_TYPE
 
__S32_TYPE


	)

40 
	#__RLIM_T_TYPE
 
__ULONGWORD_TYPE


	)

41 
	#__RLIM64_T_TYPE
 
__UQUAD_TYPE


	)

42 
	#__BLKCNT_T_TYPE
 
__SLONGWORD_TYPE


	)

43 
	#__BLKCNT64_T_TYPE
 
__SQUAD_TYPE


	)

44 
	#__FSBLKCNT_T_TYPE
 
__ULONGWORD_TYPE


	)

45 
	#__FSBLKCNT64_T_TYPE
 
__UQUAD_TYPE


	)

46 
	#__FSFILCNT_T_TYPE
 
__ULONGWORD_TYPE


	)

47 
	#__FSFILCNT64_T_TYPE
 
__UQUAD_TYPE


	)

48 
	#__ID_T_TYPE
 
__U32_TYPE


	)

49 
	#__CLOCK_T_TYPE
 
__SLONGWORD_TYPE


	)

50 
	#__TIME_T_TYPE
 
__SLONGWORD_TYPE


	)

51 
	#__USECONDS_T_TYPE
 
__U32_TYPE


	)

52 
	#__SUSECONDS_T_TYPE
 
__SLONGWORD_TYPE


	)

53 
	#__DADDR_T_TYPE
 
__S32_TYPE


	)

54 
	#__SWBLK_T_TYPE
 
__SLONGWORD_TYPE


	)

55 
	#__KEY_T_TYPE
 
__S32_TYPE


	)

56 
	#__CLOCKID_T_TYPE
 
__S32_TYPE


	)

57 
	#__TIMER_T_TYPE
 *

	)

58 
	#__BLKSIZE_T_TYPE
 
__SLONGWORD_TYPE


	)

59 
	#__FSID_T_TYPE
 sŒuù { 
__v®
[2]; }

	)

60 
	#__SSIZE_T_TYPE
 
__SWORD_TYPE


	)

63 
	#__FD_SETSIZE
 1024

	)

	@/usr/include/bits/wordsize.h

3 #ià
defšed
 
__x86_64__


4 
	#__WORDSIZE
 64

	)

5 
	#__WORDSIZE_COMPAT32
 1

	)

7 
	#__WORDSIZE
 32

	)

	@/usr/include/ctype.h

24 #iâdef 
_CTYPE_H


25 
	#_CTYPE_H
 1

	)

27 
	~<ã©u»s.h
>

28 
	~<b™s/ty³s.h
>

30 
	g__BEGIN_DECLS


32 #iâdeà
_ISb™


41 
	~<’dŸn.h
>

42 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


43 
	#_ISb™
(
b™
è(1 << (b™))

	)

45 
	#_ISb™
(
b™
è((b™è< 8 ? ((1 << (b™)è<< 8è: ((1 << (b™)è>> 8))

	)

50 
	m_ISuµ”
 = 
_ISb™
 (0),

51 
	m_ISlow”
 = 
_ISb™
 (1),

52 
	m_IS®pha
 = 
_ISb™
 (2),

53 
	m_ISdig™
 = 
_ISb™
 (3),

54 
	m_ISxdig™
 = 
_ISb™
 (4),

55 
	m_IS¥aû
 = 
_ISb™
 (5),

56 
	m_IS´št
 = 
_ISb™
 (6),

57 
	m_ISg¿ph
 = 
_ISb™
 (7),

58 
	m_ISbÏnk
 = 
_ISb™
 (8),

59 
	m_ISúŒl
 = 
_ISb™
 (9),

60 
	m_ISpunù
 = 
_ISb™
 (10),

61 
	m_IS®num
 = 
_ISb™
 (11)

81 
__cÚ¡
 **
	$__ùy³_b_loc
 ()

82 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡
));

83 
__cÚ¡
 
__št32_t
 **
	$__ùy³_tŞow”_loc
 ()

84 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡
));

85 
__cÚ¡
 
__št32_t
 **
	$__ùy³_touµ”_loc
 ()

86 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡
));

88 
	#__isùy³
(
c
, 
ty³
) \

89 ((*
	`__ùy³_b_loc
 ())[(è(
c
)] & (è
ty³
)

	)

91 
	#__i§scii
(
c
è(((cè& ~0x7fè=ğ0è

	)

92 
	#__tßscii
(
c
è((cè& 0x7fè

	)

94 
	#__exùy³
(
Çme
è
	`Çme
 (è
__THROW


	)

96 
__BEGIN_NAMESPACE_STD


102 
	`__exùy³
 (
i§Êum
);

103 
	`__exùy³
 (
i§Íha
);

104 
	`__exùy³
 (
isúŒl
);

105 
	`__exùy³
 (
isdig™
);

106 
	`__exùy³
 (
i¦ow”
);

107 
	`__exùy³
 (
isg¿ph
);

108 
	`__exùy³
 (
i¥ršt
);

109 
	`__exùy³
 (
i¥unù
);

110 
	`__exùy³
 (
is¥aû
);

111 
	`__exùy³
 (
isuµ”
);

112 
	`__exùy³
 (
isxdig™
);

116 
	$tŞow”
 (
__c
è
__THROW
;

119 
	$touµ”
 (
__c
è
__THROW
;

121 
__END_NAMESPACE_STD


125 #ifdef 
__USE_ISOC99


126 
__BEGIN_NAMESPACE_C99


128 
	`__exùy³
 (
isbÏnk
);

130 
__END_NAMESPACE_C99


133 #ifdeà
__USE_GNU


135 
	$isùy³
 (
__c
, 
__mask
è
__THROW
;

138 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


142 
	$i§scii
 (
__c
è
__THROW
;

146 
	$tßscii
 (
__c
è
__THROW
;

150 
	`__exùy³
 (
_touµ”
);

151 
	`__exùy³
 (
_tŞow”
);

155 
	#__tobody
(
c
, 
f
, 
a
, 
¬gs
) \

156 (
__ex‹nsiÚ__
 \

157 ({ 
__»s
; \

158 ià( (
c
) > 1) \

160 ià(
	`__butš_cÚ¡ªt_p
 (
c
)) \

162 
__c
 = (
c
); \

163 
__»s
 = 
__c
 < -128 || __ø> 255 ? __ø: (
a
)[__c]; \

166 
__»s
 = 
f
 
¬gs
; \

169 
__»s
 = (
a
)[(è(
c
)]; \

170 
__»s
; 
	}
}))

	)

172 #ià!
defšed
 
__NO_CTYPE
 && !defšed 
__ılu¥lus


173 
	#i§Êum
(
c
è
	`__isùy³
((c), 
_IS®num
)

	)

174 
	#i§Íha
(
c
è
	`__isùy³
((c), 
_IS®pha
)

	)

175 
	#isúŒl
(
c
è
	`__isùy³
((c), 
_ISúŒl
)

	)

176 
	#isdig™
(
c
è
	`__isùy³
((c), 
_ISdig™
)

	)

177 
	#i¦ow”
(
c
è
	`__isùy³
((c), 
_ISlow”
)

	)

178 
	#isg¿ph
(
c
è
	`__isùy³
((c), 
_ISg¿ph
)

	)

179 
	#i¥ršt
(
c
è
	`__isùy³
((c), 
_IS´št
)

	)

180 
	#i¥unù
(
c
è
	`__isùy³
((c), 
_ISpunù
)

	)

181 
	#is¥aû
(
c
è
	`__isùy³
((c), 
_IS¥aû
)

	)

182 
	#isuµ”
(
c
è
	`__isùy³
((c), 
_ISuµ”
)

	)

183 
	#isxdig™
(
c
è
	`__isùy³
((c), 
_ISxdig™
)

	)

185 #ifdeà
__USE_ISOC99


186 
	#isbÏnk
(
c
è
	`__isùy³
((c), 
_ISbÏnk
)

	)

189 #ifdeà
__USE_EXTERN_INLINES


190 
__ex‹º_šlše
 

191 
__NTH
 (
	$tŞow”
 (
__c
))

193  
__c
 >ğ-128 && __ø< 256 ? (*
	`__ùy³_tŞow”_loc
 ())[__c] : __c;

194 
	}
}

196 
__ex‹º_šlše
 

197 
__NTH
 (
	$touµ”
 (
__c
))

199  
__c
 >ğ-128 && __ø< 256 ? (*
	`__ùy³_touµ”_loc
 ())[__c] : __c;

200 
	}
}

203 #ià
__GNUC__
 >ğ2 && 
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


204 
	#tŞow”
(
c
è
	`__tobody
 (c, 
tŞow”
, *
	`__ùy³_tŞow”_loc
 (), (c))

	)

205 
	#touµ”
(
c
è
	`__tobody
 (c, 
touµ”
, *
	`__ùy³_touµ”_loc
 (), (c))

	)

208 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


209 
	#i§scii
(
c
è
	`__i§scii
 (c)

	)

210 
	#tßscii
(
c
è
	`__tßscii
 (c)

	)

212 
	#_tŞow”
(
c
è((è(*
	`__ùy³_tŞow”_loc
 ())[(è(c)])

	)

213 
	#_touµ”
(
c
è((è(*
	`__ùy³_touµ”_loc
 ())[(è(c)])

	)

219 #ifdeà
__USE_XOPEN2K8


233 
	~<xloÿË.h
>

237 
	#__isùy³_l
(
c
, 
ty³
, 
loÿË
) \

238 ((
loÿË
)->
__ùy³_b
[(è(
c
)] & (è
ty³
)

	)

240 
	#__exùy³_l
(
Çme
) \

241 
	`Çme
 (, 
__loÿË_t
è
__THROW


	)

247 
__exùy³_l
 (
i§Êum_l
);

248 
__exùy³_l
 (
i§Íha_l
);

249 
__exùy³_l
 (
isúŒl_l
);

250 
__exùy³_l
 (
isdig™_l
);

251 
__exùy³_l
 (
i¦ow”_l
);

252 
__exùy³_l
 (
isg¿ph_l
);

253 
__exùy³_l
 (
i¥ršt_l
);

254 
__exùy³_l
 (
i¥unù_l
);

255 
__exùy³_l
 (
is¥aû_l
);

256 
__exùy³_l
 (
isuµ”_l
);

257 
__exùy³_l
 (
isxdig™_l
);

259 
__exùy³_l
 (
isbÏnk_l
);

263 
	$__tŞow”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

264 
	$tŞow”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

267 
	$__touµ”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

268 
	$touµ”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

270 #ià
__GNUC__
 >ğ2 && 
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


271 
	#__tŞow”_l
(
c
, 
loÿË
) \

272 
	`__tobody
 (
c
, 
__tŞow”_l
, (
loÿË
)->
__ùy³_tŞow”
, (c,†oÿË))

	)

273 
	#__touµ”_l
(
c
, 
loÿË
) \

274 
	`__tobody
 (
c
, 
__touµ”_l
, (
loÿË
)->
__ùy³_touµ”
, (c,†oÿË))

	)

275 
	#tŞow”_l
(
c
, 
loÿË
è
	`__tŞow”_l
 ((c), (loÿË))

	)

276 
	#touµ”_l
(
c
, 
loÿË
è
	`__touµ”_l
 ((c), (loÿË))

	)

280 #iâdeà
__NO_CTYPE


281 
	#__i§Êum_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS®num
, (l))

	)

282 
	#__i§Íha_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS®pha
, (l))

	)

283 
	#__isúŒl_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISúŒl
, (l))

	)

284 
	#__isdig™_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISdig™
, (l))

	)

285 
	#__i¦ow”_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISlow”
, (l))

	)

286 
	#__isg¿ph_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISg¿ph
, (l))

	)

287 
	#__i¥ršt_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS´št
, (l))

	)

288 
	#__i¥unù_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISpunù
, (l))

	)

289 
	#__is¥aû_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS¥aû
, (l))

	)

290 
	#__isuµ”_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISuµ”
, (l))

	)

291 
	#__isxdig™_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISxdig™
, (l))

	)

293 
	#__isbÏnk_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISbÏnk
, (l))

	)

295 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC


296 
	#__i§scii_l
(
c
,
l
è(Ö), 
	`__i§scii
 (c))

	)

297 
	#__tßscii_l
(
c
,
l
è(Ö), 
	`__tßscii
 (c))

	)

300 
	#i§Êum_l
(
c
,
l
è
	`__i§Êum_l
 ((c), (l))

	)

301 
	#i§Íha_l
(
c
,
l
è
	`__i§Íha_l
 ((c), (l))

	)

302 
	#isúŒl_l
(
c
,
l
è
	`__isúŒl_l
 ((c), (l))

	)

303 
	#isdig™_l
(
c
,
l
è
	`__isdig™_l
 ((c), (l))

	)

304 
	#i¦ow”_l
(
c
,
l
è
	`__i¦ow”_l
 ((c), (l))

	)

305 
	#isg¿ph_l
(
c
,
l
è
	`__isg¿ph_l
 ((c), (l))

	)

306 
	#i¥ršt_l
(
c
,
l
è
	`__i¥ršt_l
 ((c), (l))

	)

307 
	#i¥unù_l
(
c
,
l
è
	`__i¥unù_l
 ((c), (l))

	)

308 
	#is¥aû_l
(
c
,
l
è
	`__is¥aû_l
 ((c), (l))

	)

309 
	#isuµ”_l
(
c
,
l
è
	`__isuµ”_l
 ((c), (l))

	)

310 
	#isxdig™_l
(
c
,
l
è
	`__isxdig™_l
 ((c), (l))

	)

312 
	#isbÏnk_l
(
c
,
l
è
	`__isbÏnk_l
 ((c), (l))

	)

314 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC


315 
	#i§scii_l
(
c
,
l
è
	`__i§scii_l
 ((c), (l))

	)

316 
	#tßscii_l
(
c
,
l
è
	`__tßscii_l
 ((c), (l))

	)

323 
__END_DECLS


	@/usr/include/endian.h

19 #iâdef 
_ENDIAN_H


20 
	#_ENDIAN_H
 1

	)

22 
	~<ã©u»s.h
>

32 
	#__LITTLE_ENDIAN
 1234

	)

33 
	#__BIG_ENDIAN
 4321

	)

34 
	#__PDP_ENDIAN
 3412

	)

37 
	~<b™s/’dŸn.h
>

41 #iâdeà
__FLOAT_WORD_ORDER


42 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

45 #ifdef 
__USE_BSD


46 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

47 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

48 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

49 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

52 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


53 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èLO, 
	)
HI

54 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


55 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èHI, 
	)
LO

59 #ifdeà
__USE_BSD


61 
	~<b™s/by‹sw­.h
>

63 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


64 
	#htobe16
(
x
è
	`__bsw­_16
 (x)

	)

65 
	#htŞe16
(
x
è(x)

	)

66 
	#be16toh
(
x
è
	`__bsw­_16
 (x)

	)

67 
	#Ë16toh
(
x
è(x)

	)

69 
	#htobe32
(
x
è
	`__bsw­_32
 (x)

	)

70 
	#htŞe32
(
x
è(x)

	)

71 
	#be32toh
(
x
è
	`__bsw­_32
 (x)

	)

72 
	#Ë32toh
(
x
è(x)

	)

74 
	#htobe64
(
x
è
	`__bsw­_64
 (x)

	)

75 
	#htŞe64
(
x
è(x)

	)

76 
	#be64toh
(
x
è
	`__bsw­_64
 (x)

	)

77 
	#Ë64toh
(
x
è(x)

	)

79 
	#htobe16
(
x
è(x)

	)

80 
	#htŞe16
(
x
è
	`__bsw­_16
 (x)

	)

81 
	#be16toh
(
x
è(x)

	)

82 
	#Ë16toh
(
x
è
	`__bsw­_16
 (x)

	)

84 
	#htobe32
(
x
è(x)

	)

85 
	#htŞe32
(
x
è
	`__bsw­_32
 (x)

	)

86 
	#be32toh
(
x
è(x)

	)

87 
	#Ë32toh
(
x
è
	`__bsw­_32
 (x)

	)

89 
	#htobe64
(
x
è(x)

	)

90 
	#htŞe64
(
x
è
	`__bsw­_64
 (x)

	)

91 
	#be64toh
(
x
è(x)

	)

92 
	#Ë64toh
(
x
è
	`__bsw­_64
 (x)

	)

	@/usr/include/gnu/stubs.h

4 
	~<b™s/wÜdsize.h
>

6 #ià
__WORDSIZE
 == 32

7 
	~<gnu/¡ubs-32.h
>

8 #–ià
__WORDSIZE
 == 64

9 
	~<gnu/¡ubs-64.h
>

	@/usr/include/sys/cdefs.h

20 #iâdef 
_SYS_CDEFS_H


21 
	#_SYS_CDEFS_H
 1

	)

24 #iâdeà
_FEATURES_H


25 
	~<ã©u»s.h
>

31 #ià
defšed
 
__GNUC__
 && !defšed 
__STDC__


36 #undeà
__P


37 #undeà
__PMT


39 #ifdeà
__GNUC__


46 #ià!
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (3, 3)

47 
	#__THROW
 
	`__©Œibu‹__
 ((
__nÙhrow__
))

	)

48 
	#__NTH
(
fù
è
	`__©Œibu‹__
 ((
__nÙhrow__
)è
	)
fct

50 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,8)

51 
	#__THROW
 
	`throw
 ()

	)

52 
	#__NTH
(
fù
èfù 
	`throw
 ()

	)

54 
	#__THROW


	)

55 
	#__NTH
(
fù
è
	)
fct

61 
	#__šlše


	)

63 
	#__THROW


	)

64 
	#__NTH
(
fù
è
	)
fct

66 
	#__cÚ¡
 cÚ¡

	)

67 
	#__sigÃd
 sigÃd

	)

68 
	#__vŞ©e
 vŞ©e

	)

74 
	#__P
(
¬gs
è
	)
args

75 
	#__PMT
(
¬gs
è
	)
args

80 
	#__CONCAT
(
x
,
y
èx ## 
	)
y

81 
	#__STRING
(
x
è#x

	)

84 
	#__±r_t
 *

	)

85 
	#__lÚg_doubË_t
 

	)

89 #ifdef 
__ılu¥lus


90 
	#__BEGIN_DECLS
 "C" {

	)

91 
	#__END_DECLS
 }

	)

93 
	#__BEGIN_DECLS


	)

94 
	#__END_DECLS


	)

103 #ià
defšed
 
__ılu¥lus
 && defšed 
_GLIBCPP_USE_NAMESPACES


104 
	#__BEGIN_NAMESPACE_STD
 
Çme¥aû
 
¡d
 {

	)

105 
	#__END_NAMESPACE_STD
 }

	)

106 
	#__USING_NAMESPACE_STD
(
Çme
è
usšg
 
¡d
::Çme;

	)

107 
	#__BEGIN_NAMESPACE_C99
 
Çme¥aû
 
__c99
 {

	)

108 
	#__END_NAMESPACE_C99
 }

	)

109 
	#__USING_NAMESPACE_C99
(
Çme
è
usšg
 
__c99
::Çme;

	)

114 
	#__BEGIN_NAMESPACE_STD


	)

115 
	#__END_NAMESPACE_STD


	)

116 
	#__USING_NAMESPACE_STD
(
Çme
)

	)

117 
	#__BEGIN_NAMESPACE_C99


	)

118 
	#__END_NAMESPACE_C99


	)

119 
	#__USING_NAMESPACE_C99
(
Çme
)

	)

124 #iâdeà
__BOUNDED_POINTERS__


125 
	#__bounded


	)

126 
	#__unbounded


	)

127 
	#__±rv®ue


	)

132 
	#__bos
(
±r
è
	`__butš_objeù_size
 (±r, 
__USE_FORTIFY_LEVEL
 > 1)

	)

133 
	#__bos0
(
±r
è
	`__butš_objeù_size
 (±r, 0)

	)

135 #ià
__GNUC_PREREQ
 (4,3)

136 
	#__w¬ndeş
(
Çme
, 
msg
) \

137 
	`Çme
 (è
	`__©Œibu‹__
((
	`__w¬nšg__
 (
msg
)))

	)

138 
	#__w¬Ç‰r
(
msg
è
	`__©Œibu‹__
((
	`__w¬nšg__
 (msg)))

	)

139 
	#__”rÜdeş
(
Çme
, 
msg
) \

140 
	`Çme
 (è
	`__©Œibu‹__
((
	`__”rÜ__
 (
msg
)))

	)

142 
	#__w¬ndeş
(
Çme
, 
msg
è
	`Çme
 ()

	)

143 
	#__w¬Ç‰r
(
msg
)

	)

144 
	#__”rÜdeş
(
Çme
, 
msg
è
	`Çme
 ()

	)

148 #ià
__GNUC_PREREQ
 (2,97)

150 
	#__æex¬r
 []

	)

152 #ifdeà
__GNUC__


153 
	#__æex¬r
 [0]

	)

155 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

156 
	#__æex¬r
 []

	)

159 
	#__æex¬r
 [1]

	)

175 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

177 
	#__REDIRECT
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm´ÙØ
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs))

	)

178 #ifdeà
__ılu¥lus


179 
	#__REDIRECT_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
) \

180 
Çme
 
´Ùo
 
__THROW
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs))

	)

182 
	#__REDIRECT_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
) \

183 
Çme
 
´Ùo
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs)è
__THROW


	)

185 
	#__ASMNAME
(
úame
è
	`__ASMNAME2
 (
__USER_LABEL_PREFIX__
, cÇme)

	)

186 
	#__ASMNAME2
(
´efix
, 
úame
è
	`__STRING
 (´efixè
	)
cname

199 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2

200 
	#__©Œibu‹__
(
xyz
è

	)

206 #ià
__GNUC_PREREQ
 (2,96)

207 
	#__©Œibu‹_m®loc__
 
	`__©Œibu‹__
 ((
__m®loc__
))

	)

209 
	#__©Œibu‹_m®loc__


	)

215 #ià
__GNUC_PREREQ
 (2,96)

216 
	#__©Œibu‹_pu»__
 
	`__©Œibu‹__
 ((
__pu»__
))

	)

218 
	#__©Œibu‹_pu»__


	)

224 #ià
__GNUC_PREREQ
 (3,1)

225 
	#__©Œibu‹_u£d__
 
	`__©Œibu‹__
 ((
__u£d__
))

	)

226 
	#__©Œibu‹_nošlše__
 
	`__©Œibu‹__
 ((
__nošlše__
))

	)

228 
	#__©Œibu‹_u£d__
 
	`__©Œibu‹__
 ((
__unu£d__
))

	)

229 
	#__©Œibu‹_nošlše__


	)

233 #ià
__GNUC_PREREQ
 (3,2)

234 
	#__©Œibu‹_d•»ÿ‹d__
 
	`__©Œibu‹__
 ((
__d•»ÿ‹d__
))

	)

236 
	#__©Œibu‹_d•»ÿ‹d__


	)

245 #ià
__GNUC_PREREQ
 (2,8)

246 
	#__©Œibu‹_fÜm©_¬g__
(
x
è
	`__©Œibu‹__
 ((
	`__fÜm©_¬g__
 (x)))

	)

248 
	#__©Œibu‹_fÜm©_¬g__
(
x
è

	)

255 #ià
__GNUC_PREREQ
 (2,97)

256 
	#__©Œibu‹_fÜm©_¡rfmÚ__
(
a
,
b
) \

257 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__¡rfmÚ__
, 
a
, 
b
)))

	)

259 
	#__©Œibu‹_fÜm©_¡rfmÚ__
(
a
,
b
è

	)

264 #ià
__GNUC_PREREQ
 (3,3)

265 
	#__nÚnuÎ
(
·¿ms
è
	`__©Œibu‹__
 ((
__nÚnuÎ__
…¬ams))

	)

267 
	#__nÚnuÎ
(
·¿ms
)

	)

272 #ià
__GNUC_PREREQ
 (3,4)

273 
	#__©Œibu‹_w¬n_unu£d_»suÉ__
 \

274 
	`__©Œibu‹__
 ((
__w¬n_unu£d_»suÉ__
))

	)

275 #ià
__USE_FORTIFY_LEVEL
 > 0

276 
	#__wur
 
__©Œibu‹_w¬n_unu£d_»suÉ__


	)

279 
	#__©Œibu‹_w¬n_unu£d_»suÉ__


	)

281 #iâdeà
__wur


282 
	#__wur


	)

286 #ià
__GNUC_PREREQ
 (3,2)

287 
	#__®ways_šlše
 
__šlše
 
	`__©Œibu‹__
 ((
__®ways_šlše__
))

	)

289 
	#__®ways_šlše
 
__šlše


	)

294 #ià!
defšed
 
__ılu¥lus
 || 
__GNUC_PREREQ
 (4,3)

295 #ià
defšed
 
__GNUC_STDC_INLINE__
 || defšed 
__ılu¥lus


296 
	#__ex‹º_šlše
 
__šlše
 
	`__©Œibu‹__
 ((
__gnu_šlše__
))

	)

297 #ià
__GNUC_PREREQ
 (4,3)

298 
	#__ex‹º_®ways_šlše
 \

299 
__®ways_šlše
 
	`__©Œibu‹__
 ((
__gnu_šlše__
, 
__¬tificŸl__
))

	)

301 
	#__ex‹º_®ways_šlše
 \

302 
__®ways_šlše
 
	`__©Œibu‹__
 ((
__gnu_šlše__
))

	)

305 
	#__ex‹º_šlše
 
__šlše


	)

306 #ià
__GNUC_PREREQ
 (4,3)

307 
	#__ex‹º_®ways_šlše
 \

308 
__®ways_šlše
 
	`__©Œibu‹__
 ((
__¬tificŸl__
))

	)

310 
	#__ex‹º_®ways_šlše
 
__®ways_šlše


	)

317 #ià
__GNUC_PREREQ
 (4,3)

318 
	#__va_¬g_·ck
(è
	`__butš_va_¬g_·ck
 ()

	)

319 
	#__va_¬g_·ck_Ën
(è
	`__butš_va_¬g_·ck_Ën
 ()

	)

326 #ià!
__GNUC_PREREQ
 (2,8)

327 
	#__ex‹nsiÚ__


	)

331 #ià!
__GNUC_PREREQ
 (2,92)

332 
	#__»¡riù


	)

338 #ià
__GNUC_PREREQ
 (3,1è&& !
defšed
 
__GNUG__


339 
	#__»¡riù_¬r
 
__»¡riù


	)

341 #ifdeà
__GNUC__


342 
	#__»¡riù_¬r


	)

344 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

345 
	#__»¡riù_¬r
 
»¡riù


	)

348 
	#__»¡riù_¬r


	)

353 
	~<b™s/wÜdsize.h
>

355 #ià
defšed
 
__LONG_DOUBLE_MATH_OPTIONAL
 && defšed 
__NO_LONG_DOUBLE_MATH


356 
	#__LDBL_COMPAT
 1

	)

357 #ifdeà
__REDIRECT


358 
	#__LDBL_REDIR1
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT
 (Çme,…rÙo,‡lŸs)

	)

359 
	#__LDBL_REDIR
(
Çme
, 
´Ùo
) \

360 
	`__LDBL_REDIR1
 (
Çme
, 
´Ùo
, 
__Ædbl_
##Çme)

	)

361 
	#__LDBL_REDIR1_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT_NTH
 (Çme,…rÙo,‡lŸs)

	)

362 
	#__LDBL_REDIR_NTH
(
Çme
, 
´Ùo
) \

363 
	`__LDBL_REDIR1_NTH
 (
Çme
, 
´Ùo
, 
__Ædbl_
##Çme)

	)

364 
	#__LDBL_REDIR1_DECL
(
Çme
, 
®Ÿs
) \

365 
	`__ty³of
 (
Çme
èÇm
	`__asm
 (
	`__ASMNAME
 (#®Ÿs));

	)

366 
	#__LDBL_REDIR_DECL
(
Çme
) \

367 
	`__ty³of
 (
Çme
èÇm
	`__asm
 (
	`__ASMNAME
 ("__Ædbl_" #Çme));

	)

368 
	#__REDIRECT_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

369 
	`__LDBL_REDIR1
 (
Çme
, 
´Ùo
, 
__Ædbl_
##
®Ÿs
)

	)

370 
	#__REDIRECT_NTH_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

371 
	`__LDBL_REDIR1_NTH
 (
Çme
, 
´Ùo
, 
__Ædbl_
##
®Ÿs
)

	)

374 #ià!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT


375 
	#__LDBL_REDIR1
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm
	)
proto

376 
	#__LDBL_REDIR
(
Çme
, 
´Ùo
èÇm
	)
proto

377 
	#__LDBL_REDIR1_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm´ÙØ
__THROW


	)

378 
	#__LDBL_REDIR_NTH
(
Çme
, 
´Ùo
èÇm´ÙØ
__THROW


	)

379 
	#__LDBL_REDIR_DECL
(
Çme
)

	)

380 #ifdeà
__REDIRECT


381 
	#__REDIRECT_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT
 (Çme,…rÙo,‡lŸs)

	)

382 
	#__REDIRECT_NTH_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

383 
	`__REDIRECT_NTH
 (
Çme
, 
´Ùo
, 
®Ÿs
)

	)

	@/usr/include/sys/select.h

22 #iâdeà
_SYS_SELECT_H


23 
	#_SYS_SELECT_H
 1

	)

25 
	~<ã©u»s.h
>

28 
	~<b™s/ty³s.h
>

31 
	~<b™s/£Ëù.h
>

34 
	~<b™s/sig£t.h
>

36 #iâdeà
__sig£t_t_defšed


37 
	#__sig£t_t_defšed


	)

38 
__sig£t_t
 
	tsig£t_t
;

42 
	#__Ãed_time_t


	)

43 
	#__Ãed_time¥ec


	)

44 
	~<time.h
>

45 
	#__Ãed_timev®


	)

46 
	~<b™s/time.h
>

48 #iâdeà
__su£cÚds_t_defšed


49 
__su£cÚds_t
 
	tsu£cÚds_t
;

50 
	#__su£cÚds_t_defšed


	)

55 
	t__fd_mask
;

58 #undeà
__NFDBITS


59 #undeà
__FDELT


60 #undeà
__FDMASK


62 
	#__NFDBITS
 (8 *  (
__fd_mask
))

	)

63 
	#__FDELT
(
d
è((dè/ 
__NFDBITS
)

	)

64 
	#__FDMASK
(
d
è((
__fd_mask
è1 << ((dè% 
__NFDBITS
))

	)

71 #ifdeà
__USE_XOPEN


72 
__fd_mask
 
	mfds_b™s
[
__FD_SETSIZE
 / 
__NFDBITS
];

73 
	#__FDS_BITS
(
£t
è((£t)->
fds_b™s
)

	)

75 
__fd_mask
 
	m__fds_b™s
[
__FD_SETSIZE
 / 
__NFDBITS
];

76 
	#__FDS_BITS
(
£t
è((£t)->
__fds_b™s
)

	)

78 } 
	tfd_£t
;

81 
	#FD_SETSIZE
 
__FD_SETSIZE


	)

83 #ifdeà
__USE_MISC


85 
__fd_mask
 
	tfd_mask
;

88 
	#NFDBITS
 
__NFDBITS


	)

93 
	#FD_SET
(
fd
, 
fd£
è
	`__FD_SET
 (fd, fd£)

	)

94 
	#FD_CLR
(
fd
, 
fd£
è
	`__FD_CLR
 (fd, fd£)

	)

95 
	#FD_ISSET
(
fd
, 
fd£
è
	`__FD_ISSET
 (fd, fd£)

	)

96 
	#FD_ZERO
(
fd£
è
	`__FD_ZERO
 (fd£)

	)

99 
__BEGIN_DECLS


109 
£Ëù
 (
__nfds
, 
fd_£t
 *
__»¡riù
 
__»adfds
,

110 
fd_£t
 *
__»¡riù
 
__wr™efds
,

111 
fd_£t
 *
__»¡riù
 
__exû±fds
,

112 
timev®
 *
__»¡riù
 
__timeout
);

114 #ifdeà
__USE_XOPEN2K


121 
p£Ëù
 (
__nfds
, 
fd_£t
 *
__»¡riù
 
__»adfds
,

122 
fd_£t
 *
__»¡riù
 
__wr™efds
,

123 
fd_£t
 *
__»¡riù
 
__exû±fds
,

124 cÚ¡ 
time¥ec
 *
__»¡riù
 
__timeout
,

125 cÚ¡ 
__sig£t_t
 *
__»¡riù
 
__sigmask
);

128 
	g__END_DECLS


	@/usr/include/sys/sysmacros.h

21 #iâdeà
_SYS_SYSMACROS_H


22 
	#_SYS_SYSMACROS_H
 1

	)

24 
	~<ã©u»s.h
>

29 #ifdeà
__GLIBC_HAVE_LONG_LONG


30 
__ex‹nsiÚ__


31 
	$gnu_dev_majÜ
 (
__dev
)

32 
__THROW
;

33 
__ex‹nsiÚ__


34 
	$gnu_dev_mšÜ
 (
__dev
)

35 
__THROW
;

36 
__ex‹nsiÚ__


37 
	$gnu_dev_makedev
 (
__majÜ
,

38 
__mšÜ
)

39 
__THROW
;

41 #ià
defšed
 
__GNUC__
 && __GNUC__ >ğ2 && defšed 
__USE_EXTERN_INLINES


42 
__ex‹nsiÚ__
 
__ex‹º_šlše
 

43 
	`__NTH
 (
	$gnu_dev_majÜ
 (
__dev
))

45  ((
__dev
 >> 8) & 0xfff) | (() (__dev >> 32) & ~0xfff);

46 
	}
}

48 
__ex‹nsiÚ__
 
__ex‹º_šlše
 

49 
__NTH
 (
	$gnu_dev_mšÜ
 (
__dev
))

51  (
__dev
 & 0xff) | (() (__dev >> 12) & ~0xff);

52 
	}
}

54 
__ex‹nsiÚ__
 
__ex‹º_šlše
 

55 
__NTH
 (
	$gnu_dev_makedev
 (
__majÜ
, 
__mšÜ
))

57  ((
__mšÜ
 & 0xffè| ((
__majÜ
 & 0xfff) << 8)

58 | (((è(
__mšÜ
 & ~0xff)) << 12)

59 | (((è(
__majÜ
 & ~0xfff)) << 32));

60 
	}
}

65 
	#majÜ
(
dev
è
	`gnu_dev_majÜ
 (dev)

	)

66 
	#mšÜ
(
dev
è
	`gnu_dev_mšÜ
 (dev)

	)

67 
	#makedev
(
maj
, 
mš
è
	`gnu_dev_makedev
 (maj, mš)

	)

	@/usr/include/time.h

23 #iâdef 
_TIME_H


25 #ià(! 
defšed
 
__Ãed_time_t
 && !defšed 
__Ãed_şock_t
 && \

26 ! 
defšed
 
	g__Ãed_time¥ec
)

27 
	#_TIME_H
 1

	)

28 
	~<ã©u»s.h
>

30 
	g__BEGIN_DECLS


34 #ifdef 
_TIME_H


36 
	#__Ãed_size_t


	)

37 
	#__Ãed_NULL


	)

38 
	~<¡ddef.h
>

42 
	~<b™s/time.h
>

45 #ià!
defšed
 
__STRICT_ANSI__
 && !defšed 
__USE_XOPEN2K


46 #iâdeà
CLK_TCK


47 
	#CLK_TCK
 
CLOCKS_PER_SEC


	)

53 #ià!
defšed
 
__şock_t_defšed
 && (defšed 
_TIME_H
 || defšed 
__Ãed_şock_t
)

54 
	#__şock_t_defšed
 1

	)

56 
	~<b™s/ty³s.h
>

58 
__BEGIN_NAMESPACE_STD


60 
__şock_t
 
	tşock_t
;

61 
	g__END_NAMESPACE_STD


62 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_POSIX
 || defšed 
__USE_MISC


63 
	$__USING_NAMESPACE_STD
(
şock_t
)

67 #undeà
__Ãed_şock_t


69 #ià!
defšed
 
__time_t_defšed
 && (defšed 
_TIME_H
 || defšed 
__Ãed_time_t
)

70 
	#__time_t_defšed
 1

	)

72 
	~<b™s/ty³s.h
>

74 
__BEGIN_NAMESPACE_STD


76 
__time_t
 
	ttime_t
;

77 
__END_NAMESPACE_STD


78 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC
 || defšed 
__USE_SVID


79 
	$__USING_NAMESPACE_STD
(
time_t
)

83 #undeà
__Ãed_time_t


85 #ià!
defšed
 
__şockid_t_defšed
 && \

86 ((
defšed
 
_TIME_H
 && defšed 
__USE_POSIX199309
è|| defšed 
__Ãed_şockid_t
)

87 
	#__şockid_t_defšed
 1

	)

89 
	~<b™s/ty³s.h
>

92 
__şockid_t
 
	tşockid_t
;

95 #undeà
__şockid_time_t


97 #ià!
defšed
 
__tim”_t_defšed
 && \

98 ((
defšed
 
_TIME_H
 && defšed 
__USE_POSIX199309
è|| defšed 
__Ãed_tim”_t
)

99 
	#__tim”_t_defšed
 1

	)

101 
	~<b™s/ty³s.h
>

104 
__tim”_t
 
	ttim”_t
;

107 #undeà
__Ãed_tim”_t


110 #ià!
defšed
 
__time¥ec_defšed
 && \

111 ((
defšed
 
_TIME_H
 && \

112 (
defšed
 
__USE_POSIX199309
 || defšed 
__USE_MISC
)) || \

113 
defšed
 
__Ãed_time¥ec
)

114 
	#__time¥ec_defšed
 1

	)

116 
	~<b™s/ty³s.h
>

120 
	stime¥ec


122 
__time_t
 
tv_£c
;

123 
tv_n£c
;

127 #undeà
__Ãed_time¥ec


130 #ifdef 
_TIME_H


131 
__BEGIN_NAMESPACE_STD


133 
	stm


135 
tm_£c
;

136 
tm_mš
;

137 
tm_hour
;

138 
tm_mday
;

139 
tm_mÚ
;

140 
tm_y—r
;

141 
tm_wday
;

142 
tm_yday
;

143 
tm_isd¡
;

145 #ifdef 
__USE_BSD


146 
tm_gmtoff
;

147 
__cÚ¡
 *
tm_zÚe
;

149 
__tm_gmtoff
;

150 
__cÚ¡
 *
__tm_zÚe
;

153 
__END_NAMESPACE_STD


154 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_POSIX
 || defšed 
__USE_MISC


155 
	$__USING_NAMESPACE_STD
(
tm
)

159 #ifdeà
__USE_POSIX199309


161 
	s™im”¥ec


163 
time¥ec
 
™_š‹rv®
;

164 
time¥ec
 
™_v®ue
;

168 
sigev’t
;

172 #ifdeà
__USE_XOPEN2K


173 #iâdeà
__pid_t_defšed


174 
__pid_t
 
	tpid_t
;

175 
	#__pid_t_defšed


	)

180 
__BEGIN_NAMESPACE_STD


183 
şock_t
 
	$şock
 (è
__THROW
;

186 
time_t
 
	$time
 (
time_t
 *
__tim”
è
__THROW
;

189 
	$difáime
 (
time_t
 
__time1
,ime_ˆ
__time0
)

190 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

193 
time_t
 
	$mktime
 (
tm
 *
__
è
__THROW
;

199 
size_t
 
	$¡ráime
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

200 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

201 
__cÚ¡
 
tm
 *
__»¡riù
 
__
è
__THROW
;

202 
__END_NAMESPACE_STD


204 #ifdeà
__USE_XOPEN


207 *
	$¡½time
 (
__cÚ¡
 *
__»¡riù
 
__s
,

208 
__cÚ¡
 *
__»¡riù
 
__fmt
, 
tm
 *
__
)

209 
__THROW
;

212 #ifdeà
__USE_XOPEN2K8


215 
	~<xloÿË.h
>

217 
size_t
 
	$¡ráime_l
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

218 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

219 
__cÚ¡
 
tm
 *
__»¡riù
 
__
,

220 
__loÿË_t
 
__loc
è
__THROW
;

223 #ifdeà
__USE_GNU


224 *
	$¡½time_l
 (
__cÚ¡
 *
__»¡riù
 
__s
,

225 
__cÚ¡
 *
__»¡riù
 
__fmt
, 
tm
 *
__
,

226 
__loÿË_t
 
__loc
è
__THROW
;

230 
__BEGIN_NAMESPACE_STD


233 
tm
 *
	$gmtime
 (
__cÚ¡
 
time_t
 *
__tim”
è
__THROW
;

237 
tm
 *
	$loÿÉime
 (
__cÚ¡
 
time_t
 *
__tim”
è
__THROW
;

238 
__END_NAMESPACE_STD


240 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


243 
tm
 *
	$gmtime_r
 (
__cÚ¡
 
time_t
 *
__»¡riù
 
__tim”
,

244 
tm
 *
__»¡riù
 
__
è
__THROW
;

248 
tm
 *
	$loÿÉime_r
 (
__cÚ¡
 
time_t
 *
__»¡riù
 
__tim”
,

249 
tm
 *
__»¡riù
 
__
è
__THROW
;

252 
__BEGIN_NAMESPACE_STD


255 *
	$asùime
 (
__cÚ¡
 
tm
 *
__
è
__THROW
;

258 *
	$ùime
 (
__cÚ¡
 
time_t
 *
__tim”
è
__THROW
;

259 
__END_NAMESPACE_STD


261 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


266 *
	$asùime_r
 (
__cÚ¡
 
tm
 *
__»¡riù
 
__
,

267 *
__»¡riù
 
__buf
è
__THROW
;

270 *
	$ùime_r
 (
__cÚ¡
 
time_t
 *
__»¡riù
 
__tim”
,

271 *
__»¡riù
 
__buf
è
__THROW
;

276 *
__tzÇme
[2];

277 
__daylight
;

278 
__timezÚe
;

281 #ifdef 
__USE_POSIX


283 *
tzÇme
[2];

287 
	$tz£t
 (è
__THROW
;

290 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


291 
daylight
;

292 
timezÚe
;

295 #ifdeà
__USE_SVID


298 
	$¡ime
 (
__cÚ¡
 
time_t
 *
__wh’
è
__THROW
;

304 
	#__i¦—p
(
y—r
) \

305 ((
y—r
è% 4 =ğ0 && ((y—rè% 100 !ğ0 || (y—rè% 400 =ğ0))

	)

308 #ifdeà
__USE_MISC


313 
time_t
 
	$timegm
 (
tm
 *
__
è
__THROW
;

316 
time_t
 
	$tim–oÿl
 (
tm
 *
__
è
__THROW
;

319 
	$dysize
 (
__y—r
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

323 #ifdeà
__USE_POSIX199309


328 
	`Çno¦“p
 (
__cÚ¡
 
time¥ec
 *
__»que¡ed_time
,

329 
time¥ec
 *
__»maššg
);

333 
	$şock_g‘»s
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__»s
è
__THROW
;

336 
	$şock_g‘time
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__
è
__THROW
;

339 
	$şock_£‰ime
 (
şockid_t
 
__şock_id
, 
__cÚ¡
 
time¥ec
 *
__
)

340 
__THROW
;

342 #ifdeà
__USE_XOPEN2K


347 
	`şock_Çno¦“p
 (
şockid_t
 
__şock_id
, 
__æags
,

348 
__cÚ¡
 
time¥ec
 *
__»q
,

349 
time¥ec
 *
__»m
);

352 
	$şock_g‘ıuşockid
 (
pid_t
 
__pid
, 
şockid_t
 *
__şock_id
è
__THROW
;

357 
	$tim”_ü—‹
 (
şockid_t
 
__şock_id
,

358 
sigev’t
 *
__»¡riù
 
__evp
,

359 
tim”_t
 *
__»¡riù
 
__tim”id
è
__THROW
;

362 
	$tim”_d–‘e
 (
tim”_t
 
__tim”id
è
__THROW
;

365 
	$tim”_£‰ime
 (
tim”_t
 
__tim”id
, 
__æags
,

366 
__cÚ¡
 
™im”¥ec
 *
__»¡riù
 
__v®ue
,

367 
™im”¥ec
 *
__»¡riù
 
__ov®ue
è
__THROW
;

370 
	$tim”_g‘time
 (
tim”_t
 
__tim”id
, 
™im”¥ec
 *
__v®ue
)

371 
__THROW
;

374 
	$tim”_g‘ov”run
 (
tim”_t
 
__tim”id
è
__THROW
;

378 #ifdeà
__USE_XOPEN_EXTENDED


390 
g‘d©e_”r
;

399 
tm
 *
	`g‘d©e
 (
__cÚ¡
 *
__¡ršg
);

402 #ifdeà
__USE_GNU


413 
	`g‘d©e_r
 (
__cÚ¡
 *
__»¡riù
 
__¡ršg
,

414 
tm
 *
__»¡riù
 
__»sbuå
);

417 
__END_DECLS


	@/usr/include/bits/byteswap.h

21 #ià!
defšed
 
_BYTESWAP_H
 && !defšed 
_NETINET_IN_H
 && !defšed 
_ENDIAN_H


25 #iâdeà
_BITS_BYTESWAP_H


26 
	#_BITS_BYTESWAP_H
 1

	)

28 
	~<b™s/wÜdsize.h
>

31 
	#__bsw­_cÚ¡ªt_16
(
x
) \

32 ((((
x
è>> 8è& 0xffè| (((xè& 0xffè<< 8))

	)

34 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

35 
	#__bsw­_16
(
x
) \

36 (
__ex‹nsiÚ__
 \

37 ({ 
__v
, 
__x
 = (
x
); \

38 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

39 
__v
 = 
	`__bsw­_cÚ¡ªt_16
 (
__x
); \

41 
	`__asm__
 ("rorw $8, %w0" \

42 : "ô" (
__v
) \

43 : "0" (
__x
) \

45 
__v
; }))

	)

48 
	#__bsw­_16
(
x
) \

49 (
__ex‹nsiÚ__
 \

50 ({ 
__x
 = (
x
); 
	`__bsw­_cÚ¡ªt_16
 (__x); }))

	)

55 
	#__bsw­_cÚ¡ªt_32
(
x
) \

56 ((((
x
) & 0xff000000) >> 24) | (((x) & 0x00ff0000) >> 8) | \

57 (((
x
è& 0x0000ff00è<< 8è| (((xè& 0x000000ffè<< 24))

	)

59 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

60 #ià
__WORDSIZE
 =ğ64 || (
defšed
 
__i486__
 || defšed 
__³Áium__
 \

61 || 
defšed
 
	g__³Áium´o__
 || defšed 
	g__³Áium4__
 \

62 || 
defšed
 
	g__k8__
 || defšed 
	g__©hlÚ__
 \

63 || 
defšed
 
	g__k6__
 || defšed 
	g__nocÚa__
 \

64 || 
defšed
 
	g__cÜe2__
 || defšed 
	g__geode__
 \

65 || 
defšed
 
	g__amdçm10__
)

68 
	#__bsw­_32
(
x
) \

69 (
__ex‹nsiÚ__
 \

70 ({ 
__v
, 
__x
 = (
x
); \

71 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

72 
__v
 = 
	`__bsw­_cÚ¡ªt_32
 (
__x
); \

74 
	`__asm__
 ("bsw­ %0" : "ô" (
__v
è: "0" (
__x
)); \

75 
__v
; }))

	)

77 
	#__bsw­_32
(
x
) \

78 (
__ex‹nsiÚ__
 \

79 ({ 
__v
, 
__x
 = (
x
); \

80 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

81 
__v
 = 
	`__bsw­_cÚ¡ªt_32
 (
__x
); \

83 
	`__asm__
 ("rorw $8, %w0;" \

86 : "ô" (
__v
) \

87 : "0" (
__x
) \

89 
__v
; }))

	)

92 
	#__bsw­_32
(
x
) \

93 (
__ex‹nsiÚ__
 \

94 ({ 
__x
 = (
x
); 
	`__bsw­_cÚ¡ªt_32
 (__x); }))

	)

98 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

100 
	#__bsw­_cÚ¡ªt_64
(
x
) \

101 ((((
x
) & 0xff00000000000000ull) >> 56) \

102 | (((
x
) & 0x00ff000000000000ull) >> 40) \

103 | (((
x
) & 0x0000ff0000000000ull) >> 24) \

104 | (((
x
) & 0x000000ff00000000ull) >> 8) \

105 | (((
x
) & 0x00000000ff000000ull) << 8) \

106 | (((
x
) & 0x0000000000ff0000ull) << 24) \

107 | (((
x
) & 0x000000000000ff00ull) << 40) \

108 | (((
x
è& 0x00000000000000ffuÎè<< 56))

	)

110 #ià
__WORDSIZE
 == 64

111 
	#__bsw­_64
(
x
) \

112 (
__ex‹nsiÚ__
 \

113 ({ 
__v
, 
__x
 = (
x
); \

114 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

115 
__v
 = 
	`__bsw­_cÚ¡ªt_64
 (
__x
); \

117 
	`__asm__
 ("bsw­ %q0" : "ô" (
__v
è: "0" (
__x
)); \

118 
__v
; }))

	)

120 
	#__bsw­_64
(
x
) \

121 (
__ex‹nsiÚ__
 \

122 ({ uniÚ { 
__ex‹nsiÚ__
 
__Î
; \

123 
__l
[2]; } 
__w
, 
__r
; \

124 ià(
	`__butš_cÚ¡ªt_p
 (
x
)) \

125 
__r
.
__Î
 = 
	`__bsw­_cÚ¡ªt_64
 (
x
); \

128 
__w
.
__Î
 = (
x
); \

129 
__r
.
__l
[0] = 
	`__bsw­_32
 (
__w
.__l[1]); \

130 
__r
.
__l
[1] = 
	`__bsw­_32
 (
__w
.__l[0]); \

132 
__r
.
__Î
; }))

	)

	@/usr/include/bits/endian.h

3 #iâdeà
_ENDIAN_H


7 
	#__BYTE_ORDER
 
__LITTLE_ENDIAN


	)

	@/usr/include/bits/libc-lock.h

20 #iâdeà
_BITS_LIBC_LOCK_H


21 
	#_BITS_LIBC_LOCK_H
 1

	)

23 
	~<±h»ad.h
>

24 
	#__Ãed_NULL


	)

25 
	~<¡ddef.h
>

34 #ifdeà
_LIBC


35 
	~<lowËv–lock.h
>

36 
	~<s.h
>

37 
	~<±h»ad-funùiÚs.h
>

41 #ià
defšed
 
_LIBC
 || defšed 
_IO_MTSAFE_IO


42 #ià(
defšed
 
NOT_IN_libc
 && !defšed 
IS_IN_lib±h»ad
è|| !defšed 
_LIBC


43 
±h»ad_mu‹x_t
 
	t__libc_lock_t
;

44 ¡ruù { 
±h»ad_mu‹x_t
 
	mmu‹x
; } 
	t__libc_lock_»cursive_t
;

46 
	t__libc_lock_t
;

47 ¡ruù { 
	mlock
; 
	mút
; *
	mowÃr
; } 
	t__libc_lock_»cursive_t
;

49 ¡ruù { 
±h»ad_mu‹x_t
 
	mmu‹x
; } 
	t__¹ld_lock_»cursive_t
;

50 #ifdeà
__USE_UNIX98


51 
±h»ad_rwlock_t
 
	t__libc_rwlock_t
;

53 
__libc_rwlock_İaque__
 
	t__libc_rwlock_t
;

56 
__libc_lock_İaque__
 
	t__libc_lock_t
;

57 
__libc_lock_»cursive_İaque__
 
	t__libc_lock_»cursive_t
;

58 
__libc_rwlock_İaque__
 
	t__libc_rwlock_t
;

62 
±h»ad_key_t
 
	t__libc_key_t
;

71 
	#__libc_lock_defše
(
CLASS
,
NAME
) \

72 
CLASS
 
__libc_lock_t
 
NAME
;

	)

73 
	#__libc_rwlock_defše
(
CLASS
,
NAME
) \

74 
CLASS
 
__libc_rwlock_t
 
NAME
;

	)

75 
	#__libc_lock_defše_»cursive
(
CLASS
,
NAME
) \

76 
CLASS
 
__libc_lock_»cursive_t
 
NAME
;

	)

77 
	#__¹ld_lock_defše_»cursive
(
CLASS
,
NAME
) \

78 
CLASS
 
__¹ld_lock_»cursive_t
 
NAME
;

	)

89 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

90 #ià
LLL_LOCK_INITIALIZER
 == 0

91 
	#__libc_lock_defše_š™Ÿlized
(
CLASS
,
NAME
) \

92 
CLASS
 
__libc_lock_t
 
NAME
;

	)

94 
	#__libc_lock_defše_š™Ÿlized
(
CLASS
,
NAME
) \

95 
CLASS
 
__libc_lock_t
 
NAME
 = 
LLL_LOCK_INITIALIZER
;

	)

98 #ià
__LT_SPINLOCK_INIT
 == 0

99 
	#__libc_lock_defše_š™Ÿlized
(
CLASS
,
NAME
) \

100 
CLASS
 
__libc_lock_t
 
NAME
;

	)

102 
	#__libc_lock_defše_š™Ÿlized
(
CLASS
,
NAME
) \

103 
CLASS
 
__libc_lock_t
 
NAME
 = 
PTHREAD_MUTEX_INITIALIZER
;

	)

107 
	#__libc_rwlock_defše_š™Ÿlized
(
CLASS
,
NAME
) \

108 
CLASS
 
__libc_rwlock_t
 
NAME
 = 
PTHREAD_RWLOCK_INITIALIZER
;

	)

112 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

113 #ià
LLL_LOCK_INITIALIZER
 == 0

114 
	#__libc_lock_defše_š™Ÿlized_»cursive
(
CLASS
,
NAME
) \

115 
CLASS
 
__libc_lock_»cursive_t
 
NAME
;

	)

117 
	#__libc_lock_defše_š™Ÿlized_»cursive
(
CLASS
,
NAME
) \

118 
CLASS
 
__libc_lock_»cursive_t
 
NAME
 = 
_LIBC_LOCK_RECURSIVE_INITIALIZER
;

	)

120 
	#_LIBC_LOCK_RECURSIVE_INITIALIZER
 \

121 { 
LLL_LOCK_INITIALIZER
, 0, 
NULL
 }

	)

123 
	#__libc_lock_defše_š™Ÿlized_»cursive
(
CLASS
,
NAME
) \

124 
CLASS
 
__libc_lock_»cursive_t
 
NAME
 = 
_LIBC_LOCK_RECURSIVE_INITIALIZER
;

	)

125 
	#_LIBC_LOCK_RECURSIVE_INITIALIZER
 \

126 {
PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
}

	)

129 
	#__¹ld_lock_defše_š™Ÿlized_»cursive
(
CLASS
,
NAME
) \

130 
CLASS
 
__¹ld_lock_»cursive_t
 
NAME
 = 
_RTLD_LOCK_RECURSIVE_INITIALIZER
;

	)

131 
	#_RTLD_LOCK_RECURSIVE_INITIALIZER
 \

132 {
PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
}

	)

134 
	#__¹ld_lock_š™Ÿlize
(
NAME
) \

135 (è((
NAME
èğ(
__¹ld_lock_»cursive_t
è
_RTLD_LOCK_RECURSIVE_INITIALIZER
)

	)

142 #ifdeà
__PIC__


143 
	#__libc_maybe_ÿÎ
(
FUNC
, 
ARGS
, 
ELSE
) \

144 (
	`__ex‹nsiÚ__
 ({ 
	`__ty³of
 (
FUNC
è*
_â
 = (FUNC); \

145 
_â
 !ğ
NULL
 ? (*_âè
ARGS
 : 
ELSE
; }))

	)

147 
	#__libc_maybe_ÿÎ
(
FUNC
, 
ARGS
, 
ELSE
) \

148 (
FUNC
 !ğ
NULL
 ? FUNC 
ARGS
 : 
ELSE
)

	)

152 #ià
defšed
 
SHARED
 && !defšed 
NOT_IN_libc


153 
	#PTFAVAIL
(
NAME
è
__libc_±h»ad_funùiÚs_š™


	)

154 
	#__libc_±f_ÿÎ
(
FUNC
, 
ARGS
, 
ELSE
) \

155 (
__libc_±h»ad_funùiÚs_š™
 ? 
	`PTHFCT_CALL
 (
±r_
##
FUNC
, 
ARGS
è: 
ELSE
)

	)

156 
	#__libc_±f_ÿÎ_®ways
(
FUNC
, 
ARGS
) \

157 
	`PTHFCT_CALL
 (
±r_
##
FUNC
, 
ARGS
)

	)

159 
	#PTFAVAIL
(
NAME
è(NAME !ğ
NULL
)

	)

160 
	#__libc_±f_ÿÎ
(
FUNC
, 
ARGS
, 
ELSE
) \

161 
	`__libc_maybe_ÿÎ
 (
FUNC
, 
ARGS
, 
ELSE
)

	)

162 
	#__libc_±f_ÿÎ_®ways
(
FUNC
, 
ARGS
) \

163 
FUNC
 
ARGS


	)

169 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

170 
	#__libc_lock_š™
(
NAME
è((NAMEèğ
LLL_LOCK_INITIALIZER
, 0)

	)

172 
	#__libc_lock_š™
(
NAME
) \

173 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_š™
, (&(
NAME
), 
NULL
), 0)

	)

175 #ià
defšed
 
SHARED
 && !defšed 
NOT_IN_libc


178 
	#__libc_rwlock_š™
(
NAME
) \

179 (
	`__butš_mem£t
 (&(
NAME
), '\0',  (NAME)), 0)

	)

181 
	#__libc_rwlock_š™
(
NAME
) \

182 
	`__libc_maybe_ÿÎ
 (
__±h»ad_rwlock_š™
, (&(
NAME
), 
NULL
), 0)

	)

186 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

187 
	#__libc_lock_š™_»cursive
(
NAME
) \

188 ((
NAME
èğ(
__libc_lock_»cursive_t
è
_LIBC_LOCK_RECURSIVE_INITIALIZER
, 0)

	)

190 
	#__libc_lock_š™_»cursive
(
NAME
) \

192 ià(
__±h»ad_mu‹x_š™
 !ğ
NULL
) \

194 
±h»ad_mu‹x©Œ_t
 
__©Œ
; \

195 
	`__±h»ad_mu‹x©Œ_š™
 (&
__©Œ
); \

196 
	`__±h»ad_mu‹x©Œ_£‰y³
 (&
__©Œ
, 
PTHREAD_MUTEX_RECURSIVE_NP
); \

197 
	`__±h»ad_mu‹x_š™
 (&(
NAME
).
mu‹x
, &
__©Œ
); \

198 
	`__±h»ad_mu‹x©Œ_de¡roy
 (&
__©Œ
); \

200 } 0)

	)

203 
	#__¹ld_lock_š™_»cursive
(
NAME
) \

205 ià(
__±h»ad_mu‹x_š™
 !ğ
NULL
) \

207 
±h»ad_mu‹x©Œ_t
 
__©Œ
; \

208 
	`__±h»ad_mu‹x©Œ_š™
 (&
__©Œ
); \

209 
	`__±h»ad_mu‹x©Œ_£‰y³
 (&
__©Œ
, 
PTHREAD_MUTEX_RECURSIVE_NP
); \

210 
	`__±h»ad_mu‹x_š™
 (&(
NAME
).
mu‹x
, &
__©Œ
); \

211 
	`__±h»ad_mu‹x©Œ_de¡roy
 (&
__©Œ
); \

213 } 0)

	)

218 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

219 
	#__libc_lock_fši
(
NAME
è((è0)

	)

221 
	#__libc_lock_fši
(
NAME
) \

222 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_de¡roy
, (&(
NAME
)), 0)

	)

224 #ià
defšed
 
SHARED
 && !defšed 
NOT_IN_libc


225 
	#__libc_rwlock_fši
(
NAME
è((è0)

	)

227 
	#__libc_rwlock_fši
(
NAME
) \

228 
	`__libc_maybe_ÿÎ
 (
__±h»ad_rwlock_de¡roy
, (&(
NAME
)), 0)

	)

232 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

233 
	#__libc_lock_fši_»cursive
(
NAME
è((è0)

	)

235 
	#__libc_lock_fši_»cursive
(
NAME
) \

236 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_de¡roy
, (&(
NAME
)), 0)

	)

240 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

241 
	#__libc_lock_lock
(
NAME
) \

242 ({ 
	`Îl_lock
 (
NAME
, 
LLL_PRIVATE
); 0; })

	)

244 
	#__libc_lock_lock
(
NAME
) \

245 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_lock
, (&(
NAME
)), 0)

	)

247 
	#__libc_rwlock_rdlock
(
NAME
) \

248 
	`__libc_±f_ÿÎ
 (
__±h»ad_rwlock_rdlock
, (&(
NAME
)), 0)

	)

249 
	#__libc_rwlock_w¾ock
(
NAME
) \

250 
	`__libc_±f_ÿÎ
 (
__±h»ad_rwlock_w¾ock
, (&(
NAME
)), 0)

	)

253 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

254 
	#__libc_lock_lock_»cursive
(
NAME
) \

256 *
£lf
 = 
THREAD_SELF
; \

257 ià((
NAME
).
owÃr
 !ğ
£lf
) \

259 
	`Îl_lock
 ((
NAME
).
lock
, 
LLL_PRIVATE
); \

260 (
NAME
).
owÃr
 = 
£lf
; \

262 ++(
NAME
).
út
; \

263 } 0)

	)

265 
	#__libc_lock_lock_»cursive
(
NAME
) \

266 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_lock
, (&(
NAME
).
mu‹x
), 0)

	)

270 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

271 
	#__libc_lock_Œylock
(
NAME
) \

272 
	`Îl_Œylock
 (
NAME
)

	)

274 
	#__libc_lock_Œylock
(
NAME
) \

275 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_Œylock
, (&(
NAME
)), 0)

	)

277 
	#__libc_rwlock_Œyrdlock
(
NAME
) \

278 
	`__libc_maybe_ÿÎ
 (
__±h»ad_rwlock_Œyrdlock
, (&(
NAME
)), 0)

	)

279 
	#__libc_rwlock_Œyw¾ock
(
NAME
) \

280 
	`__libc_maybe_ÿÎ
 (
__±h»ad_rwlock_Œyw¾ock
, (&(
NAME
)), 0)

	)

283 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

284 
	#__libc_lock_Œylock_»cursive
(
NAME
) \

286 
»suÉ
 = 0; \

287 *
£lf
 = 
THREAD_SELF
; \

288 ià((
NAME
).
owÃr
 !ğ
£lf
) \

290 ià(
	`Îl_Œylock
 ((
NAME
).
lock
) == 0) \

292 (
NAME
).
owÃr
 = 
£lf
; \

293 (
NAME
).
út
 = 1; \

296 
»suÉ
 = 
EBUSY
; \

299 ++(
NAME
).
út
; \

300 
»suÉ
; \

301 })

	)

303 
	#__libc_lock_Œylock_»cursive
(
NAME
) \

304 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_Œylock
, (&(
NAME
)), 0)

	)

307 
	#__¹ld_lock_Œylock_»cursive
(
NAME
) \

308 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_Œylock
, (&(
NAME
).
mu‹x
), 0)

	)

311 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

312 
	#__libc_lock_uÆock
(
NAME
) \

313 
	`Îl_uÆock
 (
NAME
, 
LLL_PRIVATE
)

	)

315 
	#__libc_lock_uÆock
(
NAME
) \

316 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_uÆock
, (&(
NAME
)), 0)

	)

318 
	#__libc_rwlock_uÆock
(
NAME
) \

319 
	`__libc_±f_ÿÎ
 (
__±h»ad_rwlock_uÆock
, (&(
NAME
)), 0)

	)

322 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

324 
	#__libc_lock_uÆock_»cursive
(
NAME
) \

326 ià(--(
NAME
).
út
 == 0) \

328 (
NAME
).
owÃr
 = 
NULL
; \

329 
	`Îl_uÆock
 ((
NAME
).
lock
, 
LLL_PRIVATE
); \

331 } 0)

	)

333 
	#__libc_lock_uÆock_»cursive
(
NAME
) \

334 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_uÆock
, (&(
NAME
)), 0)

	)

337 #ià
defšed
 
_LIBC
 && defšed 
SHARED


338 
	#__¹ld_lock_deçuÉ_lock_»cursive
(
lock
) \

339 ++((
±h»ad_mu‹x_t
 *)(
lock
))->
__d©a
.
__couÁ
;

	)

341 
	#__¹ld_lock_deçuÉ_uÆock_»cursive
(
lock
) \

342 --((
±h»ad_mu‹x_t
 *)(
lock
))->
__d©a
.
__couÁ
;

	)

344 
	#__¹ld_lock_lock_»cursive
(
NAME
) \

345 
	`GL
(
dl_¹ld_lock_»cursive
è(&(
NAME
).
mu‹x
)

	)

347 
	#__¹ld_lock_uÆock_»cursive
(
NAME
) \

348 
	`GL
(
dl_¹ld_uÆock_»cursive
è(&(
NAME
).
mu‹x
)

	)

350 
	#__¹ld_lock_lock_»cursive
(
NAME
) \

351 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_lock
, (&(
NAME
).
mu‹x
), 0)

	)

353 
	#__¹ld_lock_uÆock_»cursive
(
NAME
) \

354 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_uÆock
, (&(
NAME
).
mu‹x
), 0)

	)

358 #ià
PTHREAD_ONCE_INIT
 == 0

361 
	#__libc_Úû_defše
(
CLASS
, 
NAME
) \

362 
CLASS
 
±h»ad_Úû_t
 
NAME


	)

364 
	#__libc_Úû_defše
(
CLASS
, 
NAME
) \

365 
CLASS
 
±h»ad_Úû_t
 
NAME
 = 
PTHREAD_ONCE_INIT


	)

369 
	#__libc_Úû
(
ONCE_CONTROL
, 
INIT_FUNCTION
) \

371 ià(
	`PTFAVAIL
 (
__±h»ad_Úû
)) \

372 
	`__libc_±f_ÿÎ_®ways
 (
__±h»ad_Úû
, (&(
ONCE_CONTROL
), \

373 
INIT_FUNCTION
)); \

374 ià((
ONCE_CONTROL
è=ğ
PTHREAD_ONCE_INIT
) { \

375 
	`INIT_FUNCTION
 (); \

376 (
ONCE_CONTROL
) |= 2; \

378 } 0)

	)

381 
	#__libc_Úû_g‘
(
ONCE_CONTROL
) \

382 ((
ONCE_CONTROL
è!ğ
PTHREAD_ONCE_INIT
)

	)

388 
_±h»ad_ş—nup_push
 (
_±h»ad_ş—nup_bufãr
 *
bufãr
,

389 (*
routše
è(*), *
¬g
);

390 
	`_±h»ad_ş—nup_pİ
 (
_±h»ad_ş—nup_bufãr
 *
bufãr
,

391 
execu‹
);

392 
	`_±h»ad_ş—nup_push_deãr
 (
_±h»ad_ş—nup_bufãr
 *
bufãr
,

393 (*
routše
è(*), *
¬g
);

394 
	`_±h»ad_ş—nup_pİ_»¡Üe
 (
_±h»ad_ş—nup_bufãr
 *
bufãr
,

395 
execu‹
);

398 
	#__libc_ş—nup_»giÚ_¡¬t
(
DOIT
, 
FCT
, 
ARG
) \

399 { 
_±h»ad_ş—nup_bufãr
 
_bufãr
; \

400 
_ava
; \

401 ià(
DOIT
) { \

402 
_ava
 = 
	`PTFAVAIL
 (
_±h»ad_ş—nup_push_deãr
); \

403 ià(
_ava
) { \

404 
	`__libc_±f_ÿÎ_®ways
 (
_±h»ad_ş—nup_push_deãr
, (&
_bufãr
, 
FCT
, \

405 
ARG
)); \

407 
_bufãr
.
__routše
 = (
FCT
); \

408 
_bufãr
.
__¬g
 = (
ARG
); \

411 
_ava
 = 0; \

412 }

	)

415 
	#__libc_ş—nup_»giÚ_’d
(
DOIT
) \

416 ià(
_ava
) { \

417 
	`__libc_±f_ÿÎ_®ways
 (
_±h»ad_ş—nup_pİ_»¡Üe
, (&
_bufãr
, 
DOIT
));\

418 } ià(
DOIT
) \

419 
_bufãr
.
	`__routše
 (_bufãr.
__¬g
); \

420 
	}

	)
}

423 
	#__libc_ş—nup_’d
(
DOIT
) \

424 ià(
_ava
) { \

425 
	`__libc_±f_ÿÎ_®ways
 (
_±h»ad_ş—nup_pİ_»¡Üe
, (&
_bufãr
, 
DOIT
));\

426 } ià(
DOIT
) \

427 
_bufãr
.
	`__routše
 (_bufãr.
__¬g
)

	)

431 
__ex‹º_šlše
 

432 
	$__libc_ş—nup_routše
 (
__±h»ad_ş—nup_äame
 *
f
)

434 ià(
f
->
__do_™
)

435 
f
->
	`__ÿnûl_routše
 (f->
__ÿnûl_¬g
);

436 
	}
}

438 
	#__libc_ş—nup_push
(
fù
, 
¬g
) \

440 
__±h»ad_ş—nup_äame
 
__şäame
 \

441 
	`__©Œibu‹__
 ((
	`__ş—nup__
 (
__libc_ş—nup_routše
))) \

442 ğ{ .
__ÿnûl_routše
 = (
fù
), .
__ÿnûl_¬g
 = (
¬g
), \

443 .
__do_™
 = 1 };

	)

445 
	#__libc_ş—nup_pİ
(
execu‹
) \

446 
__şäame
.
__do_™
 = (
execu‹
); \

447 } 0)

	)

451 
	#__libc_key_ü—‹
(
KEY
, 
DESTRUCTOR
) \

452 
	`__libc_±f_ÿÎ
 (
__±h»ad_key_ü—‹
, (
KEY
, 
DESTRUCTOR
), 1)

	)

455 
	#__libc_g‘¥ecific
(
KEY
) \

456 
	`__libc_±f_ÿÎ
 (
__±h»ad_g‘¥ecific
, (
KEY
), 
NULL
)

	)

459 
	#__libc_£t¥ecific
(
KEY
, 
VALUE
) \

460 
	`__libc_±f_ÿÎ
 (
__±h»ad_£t¥ecific
, (
KEY
, 
VALUE
), 0)

	)

466 
	#__libc_©fÜk
(
PREPARE
, 
PARENT
, 
CHILD
) \

467 
	`__»gi¡”_©fÜk
 (
PREPARE
, 
PARENT
, 
CHILD
, 
NULL
)

	)

468 
__»gi¡”_©fÜk
 ((*
__´•¬e
) (),

469 (*
__·»Á
) (),

470 (*
__chd
) (),

471 *
__dso_hªdË
);

476 
	`__±h»ad_mu‹x_š™
 (
±h»ad_mu‹x_t
 *
__mu‹x
,

477 
__cÚ¡
 
±h»ad_mu‹x©Œ_t
 *
__mu‹x_©Œ
);

479 
	`__±h»ad_mu‹x_de¡roy
 (
±h»ad_mu‹x_t
 *
__mu‹x
);

481 
	`__±h»ad_mu‹x_Œylock
 (
±h»ad_mu‹x_t
 *
__mu‹x
);

483 
	`__±h»ad_mu‹x_lock
 (
±h»ad_mu‹x_t
 *
__mu‹x
);

485 
	`__±h»ad_mu‹x_uÆock
 (
±h»ad_mu‹x_t
 *
__mu‹x
);

487 
	`__±h»ad_mu‹x©Œ_š™
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
);

489 
	`__±h»ad_mu‹x©Œ_de¡roy
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
);

491 
	`__±h»ad_mu‹x©Œ_£‰y³
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

492 
__kšd
);

494 #ifdeà
__USE_UNIX98


495 
	`__±h»ad_rwlock_š™
 (
±h»ad_rwlock_t
 *
__rwlock
,

496 
__cÚ¡
 
±h»ad_rwlock©Œ_t
 *
__©Œ
);

498 
	`__±h»ad_rwlock_de¡roy
 (
±h»ad_rwlock_t
 *
__rwlock
);

500 
	`__±h»ad_rwlock_rdlock
 (
±h»ad_rwlock_t
 *
__rwlock
);

502 
	`__±h»ad_rwlock_Œyrdlock
 (
±h»ad_rwlock_t
 *
__rwlock
);

504 
	`__±h»ad_rwlock_w¾ock
 (
±h»ad_rwlock_t
 *
__rwlock
);

506 
	`__±h»ad_rwlock_Œyw¾ock
 (
±h»ad_rwlock_t
 *
__rwlock
);

508 
	`__±h»ad_rwlock_uÆock
 (
±h»ad_rwlock_t
 *
__rwlock
);

511 
	`__±h»ad_key_ü—‹
 (
±h»ad_key_t
 *
__key
,

512 (*
__de¡r_funùiÚ
) (*));

514 
	`__±h»ad_£t¥ecific
 (
±h»ad_key_t
 
__key
,

515 
__cÚ¡
 *
__poš‹r
);

517 *
	`__±h»ad_g‘¥ecific
 (
±h»ad_key_t
 
__key
);

519 
	`__±h»ad_Úû
 (
±h»ad_Úû_t
 *
__Úû_cÚŒŞ
,

520 (*
__š™_routše
) ());

522 
	`__±h»ad_©fÜk
 ((*
__´•¬e
) (),

523 (*
__·»Á
) (),

524 (*
__chd
) ());

530 #iâdeà
__NO_WEAK_PTHREAD_ALIASES


531 #ifdeà
w—k_ex‹º


532 #ià
_LIBC


533 
	~<bp-sym.h
>

535 
	#BP_SYM
(
sym
è
	)
sym

537 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_mu‹x_š™
))

538 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_mu‹x_de¡roy
))

539 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_mu‹x_lock
))

540 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_mu‹x_Œylock
))

541 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_mu‹x_uÆock
))

542 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_mu‹x©Œ_š™
))

543 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_mu‹x©Œ_de¡roy
))

544 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_mu‹x©Œ_£‰y³
))

545 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_rwlock_š™
))

546 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_rwlock_de¡roy
))

547 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_rwlock_rdlock
))

548 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_rwlock_Œyrdlock
))

549 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_rwlock_w¾ock
))

550 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_rwlock_Œyw¾ock
))

551 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_rwlock_uÆock
))

552 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_key_ü—‹
))

553 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_£t¥ecific
))

554 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_g‘¥ecific
))

555 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_Úû
))

556 
	$w—k_ex‹º
 (
__±h»ad_š™Ÿlize
)

557 
	$w—k_ex‹º
 (
__±h»ad_©fÜk
)

558 
	`w—k_ex‹º
 (
	$BP_SYM
 (
_±h»ad_ş—nup_push_deãr
))

559 
	`w—k_ex‹º
 (
	$BP_SYM
 (
_±h»ad_ş—nup_pİ_»¡Üe
))

560 
	`w—k_ex‹º
 (
	$BP_SYM
 (
±h»ad_£tÿnûl¡©e
))

562 #´agm¨
w—k
 
__±h»ad_mu‹x_š™


563 #´agm¨
w—k
 
__±h»ad_mu‹x_de¡roy


564 #´agm¨
w—k
 
__±h»ad_mu‹x_lock


565 #´agm¨
w—k
 
__±h»ad_mu‹x_Œylock


566 #´agm¨
w—k
 
__±h»ad_mu‹x_uÆock


567 #´agm¨
w—k
 
__±h»ad_mu‹x©Œ_š™


568 #´agm¨
w—k
 
__±h»ad_mu‹x©Œ_de¡roy


569 #´agm¨
w—k
 
__±h»ad_mu‹x©Œ_£‰y³


570 #´agm¨
w—k
 
__±h»ad_rwlock_de¡roy


571 #´agm¨
w—k
 
__±h»ad_rwlock_rdlock


572 #´agm¨
w—k
 
__±h»ad_rwlock_Œyrdlock


573 #´agm¨
w—k
 
__±h»ad_rwlock_w¾ock


574 #´agm¨
w—k
 
__±h»ad_rwlock_Œyw¾ock


575 #´agm¨
w—k
 
__±h»ad_rwlock_uÆock


576 #´agm¨
w—k
 
__±h»ad_key_ü—‹


577 #´agm¨
w—k
 
__±h»ad_£t¥ecific


578 #´agm¨
w—k
 
__±h»ad_g‘¥ecific


579 #´agm¨
w—k
 
__±h»ad_Úû


580 #´agm¨
w—k
 
__±h»ad_š™Ÿlize


581 #´agm¨
w—k
 
__±h»ad_©fÜk


582 #´agm¨
w—k
 
_±h»ad_ş—nup_push_deãr


583 #´agm¨
w—k
 
_±h»ad_ş—nup_pİ_»¡Üe


584 #´agm¨
w—k
 
±h»ad_£tÿnûl¡©e


	@/usr/include/bits/select.h

19 #iâdeà
_SYS_SELECT_H


23 
	~<b™s/wÜdsize.h
>

26 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

28 #ià
__WORDSIZE
 == 64

29 
	#__FD_ZERO_STOS
 "¡osq"

	)

30 
	#__FD_SET_BTS
 "btsq"

	)

31 
	#__FD_CLR_BTR
 "bŒq"

	)

32 
	#__FD_ISSET_BT
 "btq"

	)

34 
	#__FD_ZERO_STOS
 "¡o¦"

	)

35 
	#__FD_SET_BTS
 "bt¦"

	)

36 
	#__FD_CLR_BTR
 "bŒl"

	)

37 
	#__FD_ISSET_BT
 "b"

	)

40 
	#__FD_ZERO
(
fd¥
) \

42 
__d0
, 
__d1
; \

43 
__asm__
 
	`__vŞ©e__
 ("şd;„•; " 
__FD_ZERO_STOS
 \

44 : "=c" (
__d0
), "=D" (
__d1
) \

45 : "a" (0), "0" ( (
fd_£t
) \

46 /  (
__fd_mask
)), \

47 "1" (&
	`__FDS_BITS
 (
fd¥
)[0]) \

49 } 0)

	)

51 
	#__FD_SET
(
fd
, 
fd¥
) \

52 
__asm__
 
	`__vŞ©e__
 (
__FD_SET_BTS
 " %1,%0" \

53 : "=m" (
	`__FDS_BITS
 (
fd¥
)[
	`__FDELT
 (
fd
)]) \

54 : "r" (((è(
fd
)è% 
__NFDBITS
) \

55 : "cc","memÜy")

	)

56 
	#__FD_CLR
(
fd
, 
fd¥
) \

57 
__asm__
 
	`__vŞ©e__
 (
__FD_CLR_BTR
 " %1,%0" \

58 : "=m" (
	`__FDS_BITS
 (
fd¥
)[
	`__FDELT
 (
fd
)]) \

59 : "r" (((è(
fd
)è% 
__NFDBITS
) \

60 : "cc","memÜy")

	)

61 
	#__FD_ISSET
(
fd
, 
fd¥
) \

62 (
__ex‹nsiÚ__
 \

63 ({
__»suÉ
; \

64 
__asm__
 
	`__vŞ©e__
 (
__FD_ISSET_BT
 " %1,%2 ; setcb %b0" \

65 : "=q" (
__»suÉ
) \

66 : "r" (((è(
fd
)è% 
__NFDBITS
), \

67 "m" (
	`__FDS_BITS
 (
fd¥
)[
	`__FDELT
 (
fd
)]) \

69 
__»suÉ
; }))

	)

75 
	#__FD_ZERO
(
£t
) \

77 
__i
; \

78 
fd_£t
 *
__¬r
 = (
£t
); \

79 
__i
 = 0; __˜<  (
fd_£t
è/  (
__fd_mask
); ++__i) \

80 
	`__FDS_BITS
 (
__¬r
)[
__i
] = 0; \

81 } 0)

	)

82 
	#__FD_SET
(
d
, 
£t
è(
	`__FDS_BITS
 (£t)[
	`__FDELT
 (d)] |ğ
	`__FDMASK
 (d))

	)

83 
	#__FD_CLR
(
d
, 
£t
è(
	`__FDS_BITS
 (£t)[
	`__FDELT
 (d)] &ğ~
	`__FDMASK
 (d))

	)

84 
	#__FD_ISSET
(
d
, 
£t
è(
	`__FDS_BITS
 (£t)[
	`__FDELT
 (d)] & 
	`__FDMASK
 (d))

	)

	@/usr/include/bits/sigset.h

21 #iâdef 
_SIGSET_H_ty³s


22 
	#_SIGSET_H_ty³s
 1

	)

24 
	t__sig_©omic_t
;

28 
	#_SIGSET_NWORDS
 (1024 / (8 *  ()))

	)

31 
	m__v®
[
_SIGSET_NWORDS
];

32 } 
	t__sig£t_t
;

43 #ià!
defšed
 
_SIGSET_H_âs
 && defšed 
_SIGNAL_H


44 
	#_SIGSET_H_âs
 1

	)

46 #iâdeà
_EXTERN_INLINE


47 
	#_EXTERN_INLINE
 
__ex‹º_šlše


	)

51 
	#__sigmask
(
sig
) \

52 (((è1è<< (((
sig
è- 1è% (8 *  ())))

	)

55 
	#__sigwÜd
(
sig
è(((sigè- 1è/ (8 *  ()))

	)

57 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

58 
	#__sigem±y£t
(
£t
) \

59 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

60 
sig£t_t
 *
__£t
 = (
£t
); \

61 --
__út
 >ğ0è
__£t
->
__v®
[__cnt] = 0; \

62 0; }))

	)

63 
	#__sigfl£t
(
£t
) \

64 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

65 
sig£t_t
 *
__£t
 = (
£t
); \

66 --
__út
 >ğ0è
__£t
->
__v®
[__cnt] = ~0UL; \

67 0; }))

	)

69 #ifdeà
__USE_GNU


73 
	#__sigi£m±y£t
(
£t
) \

74 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

75 cÚ¡ 
sig£t_t
 *
__£t
 = (
£t
); \

76 
__»t
 = 
__£t
->
__v®
[--
__út
]; \

77 !
__»t
 && --
__út
 >= 0) \

78 
__»t
 = 
__£t
->
__v®
[
__út
]; \

79 
__»t
 =ğ0; }))

	)

80 
	#__sigªd£t
(
de¡
, 
Ëá
, 
right
) \

81 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

82 
sig£t_t
 *
__de¡
 = (
de¡
); \

83 cÚ¡ 
sig£t_t
 *
__Ëá
 = (
Ëá
); \

84 cÚ¡ 
sig£t_t
 *
__right
 = (
right
); \

85 --
__út
 >= 0) \

86 
__de¡
->
__v®
[
__út
] = (
__Ëá
->__val[__cnt] \

87 & 
__right
->
__v®
[
__út
]); \

88 0; }))

	)

89 
	#__sigÜ£t
(
de¡
, 
Ëá
, 
right
) \

90 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

91 
sig£t_t
 *
__de¡
 = (
de¡
); \

92 cÚ¡ 
sig£t_t
 *
__Ëá
 = (
Ëá
); \

93 cÚ¡ 
sig£t_t
 *
__right
 = (
right
); \

94 --
__út
 >= 0) \

95 
__de¡
->
__v®
[
__út
] = (
__Ëá
->__val[__cnt] \

96 | 
__right
->
__v®
[
__út
]); \

97 0; }))

	)

104 
__sigismemb”
 (
__cÚ¡
 
__sig£t_t
 *, );

105 
__sigadd£t
 (
__sig£t_t
 *, );

106 
__sigd–£t
 (
__sig£t_t
 *, );

108 #ifdeà
__USE_EXTERN_INLINES


109 
	#__SIGSETFN
(
NAME
, 
BODY
, 
CONST
) \

110 
_EXTERN_INLINE
 \

111 
	`NAME
 (
CONST
 
__sig£t_t
 *
__£t
, 
__sig
) \

113 
__mask
 = 
	`__sigmask
 (
__sig
); \

114 
__wÜd
 = 
	`__sigwÜd
 (
__sig
); \

115  
BODY
; \

116 }

	)

118 
__SIGSETFN
 (
__sigismemb”
, (
__£t
->
__v®
[
__wÜd
] & 
__mask
è? 1 : 0, 
__cÚ¡
)

119 
__SIGSETFN
 (
__sigadd£t
, ((
__£t
->
__v®
[
__wÜd
] |ğ
__mask
), 0), )

120 
__SIGSETFN
 (
__sigd–£t
, ((
__£t
->
__v®
[
__wÜd
] &ğ~
__mask
), 0), )

122 #undeà
__SIGSETFN


	@/usr/include/bits/time.h

24 #iâdeà
__Ãed_timev®


25 #iâdeà
_BITS_TIME_H


26 
	#_BITS_TIME_H
 1

	)

34 
	#CLOCKS_PER_SEC
 1000000l

	)

36 #ià!
defšed
 
__STRICT_ANSI__
 && !defšed 
__USE_XOPEN2K


39 
	~<b™s/ty³s.h
>

40 
__syscÚf
 ();

41 
	#CLK_TCK
 ((
__şock_t
è
	`__syscÚf
 (2)è

	)

44 #ifdeà
__USE_POSIX199309


46 
	#CLOCK_REALTIME
 0

	)

48 
	#CLOCK_MONOTONIC
 1

	)

50 
	#CLOCK_PROCESS_CPUTIME_ID
 2

	)

52 
	#CLOCK_THREAD_CPUTIME_ID
 3

	)

55 
	#TIMER_ABSTIME
 1

	)

61 #ifdeà
__Ãed_timev®


62 #undeà
__Ãed_timev®


63 #iâdeà
_STRUCT_TIMEVAL


64 
	#_STRUCT_TIMEVAL
 1

	)

65 
	~<b™s/ty³s.h
>

69 
	stimev®


71 
__time_t
 
	mtv_£c
;

72 
__su£cÚds_t
 
	mtv_u£c
;

	@/usr/include/gconv.h

23 #iâdeà
_GCONV_H


24 
	#_GCONV_H
 1

	)

26 
	~<ã©u»s.h
>

27 
	#__Ãed_mb¡©e_t


	)

28 
	#__Ãed_wšt_t


	)

29 
	~<wch¬.h
>

30 
	#__Ãed_size_t


	)

31 
	#__Ãed_wch¬_t


	)

32 
	~<¡ddef.h
>

35 
	#__UNKNOWN_10646_CHAR
 ((
wch¬_t
è0xfffd)

	)

40 
	m__GCONV_OK
 = 0,

41 
	m__GCONV_NOCONV
,

42 
	m__GCONV_NODB
,

43 
	m__GCONV_NOMEM
,

45 
	m__GCONV_EMPTY_INPUT
,

46 
	m__GCONV_FULL_OUTPUT
,

47 
	m__GCONV_ILLEGAL_INPUT
,

48 
	m__GCONV_INCOMPLETE_INPUT
,

50 
	m__GCONV_ILLEGAL_DESCRIPTOR
,

51 
	m__GCONV_INTERNAL_ERROR


58 
	m__GCONV_IS_LAST
 = 0x0001,

59 
	m__GCONV_IGNORE_ERRORS
 = 0x0002

64 
	g__gcÚv_¡•
;

65 
	g__gcÚv_¡•_d©a
;

66 
	g__gcÚv_lßded_objeù
;

67 
	g__gcÚv_Œªs_d©a
;

71 (*
	t__gcÚv_fù
è(
	t__gcÚv_¡•
 *, 
	t__gcÚv_¡•_d©a
 *,

72 
	t__cÚ¡
 **, __const *,

73 **, 
	tsize_t
 *, , );

76 
	$wšt_t
 (*
	t__gcÚv_btowc_fù
è(
	t__gcÚv_¡•
 *, );

79 (*
	t__gcÚv_š™_fù
è(
	t__gcÚv_¡•
 *);

80 (*
	t__gcÚv_’d_fù
è(
	t__gcÚv_¡•
 *);

84 (*
	t__gcÚv_Œªs_fù
è(
	t__gcÚv_¡•
 *,

85 
	t__gcÚv_¡•_d©a
 *, *,

86 
	t__cÚ¡
 *,

87 
	t__cÚ¡
 **,

88 
	t__cÚ¡
 *, **,

89 
	tsize_t
 *);

92 (*
	t__gcÚv_Œªs_cÚ‹xt_fù
è(*, 
	t__cÚ¡
 *,

93 
	t__cÚ¡
 *,

97 (*
	t__gcÚv_Œªs_qu”y_fù
è(
	t__cÚ¡
 *, __const ***,

98 
	tsize_t
 *);

101 (*
	t__gcÚv_Œªs_š™_fù
) (**, const *);

102 (*
	t__gcÚv_Œªs_’d_fù
) (*);

104 
	s__gcÚv_Œªs_d©a


107 
__gcÚv_Œªs_fù
 
__Œªs_fù
;

108 
__gcÚv_Œªs_cÚ‹xt_fù
 
__Œªs_cÚ‹xt_fù
;

109 
__gcÚv_Œªs_’d_fù
 
__Œªs_’d_fù
;

110 *
__d©a
;

111 
__gcÚv_Œªs_d©a
 *
__Ãxt
;

116 
	s__gcÚv_¡•


118 
__gcÚv_lßded_objeù
 *
__shlib_hªdË
;

119 
__cÚ¡
 *
__modÇme
;

121 
__couÁ”
;

123 *
__äom_Çme
;

124 *
__to_Çme
;

126 
__gcÚv_fù
 
__fù
;

127 
__gcÚv_btowc_fù
 
__btowc_fù
;

128 
__gcÚv_š™_fù
 
__š™_fù
;

129 
__gcÚv_’d_fù
 
__’d_fù
;

133 
__mš_Ãeded_äom
;

134 
__max_Ãeded_äom
;

135 
__mš_Ãeded_to
;

136 
__max_Ãeded_to
;

139 
__¡©eful
;

141 *
__d©a
;

146 
	s__gcÚv_¡•_d©a


148 *
__outbuf
;

149 *
__outbuãnd
;

153 
__æags
;

157 
__švoÿtiÚ_couÁ”
;

161 
__š‹º®_u£
;

163 
__mb¡©e_t
 *
__¡©•
;

164 
__mb¡©e_t
 
__¡©e
;

168 
__gcÚv_Œªs_d©a
 *
__Œªs
;

173 
	s__gcÚv_šfo


175 
size_t
 
__n¡•s
;

176 
__gcÚv_¡•
 *
__¡•s
;

177 
__ex‹nsiÚ__
 
__gcÚv_¡•_d©a
 
__d©a
 
__æex¬r
;

178 } *
	t__gcÚv_t
;

	@/usr/include/gnu/stubs-32.h

6 #ifdeà
_LIBC


7 #”rÜ 
AµliÿtiÚs
 
may
 
nÙ
 
defše
 
the
 
maüo
 
_LIBC


10 
	#__¡ub___k”Ãl_co¦


	)

11 
	#__¡ub___k”Ãl_sšl


	)

12 
	#__¡ub___k”Ãl_Æ


	)

13 
	#__¡ub_chæags


	)

14 
	#__¡ub_ç‰ach


	)

15 
	#__¡ub_fchæags


	)

16 
	#__¡ub_fd‘ach


	)

17 
	#__¡ub_g‰y


	)

18 
	#__¡ub_lchmod


	)

19 
	#__¡ub_»voke


	)

20 
	#__¡ub_£ogš


	)

21 
	#__¡ub_sig»tuº


	)

22 
	#__¡ub_s¡k


	)

23 
	#__¡ub_¡ty


	)

	@/usr/include/wchar.h

24 #iâdeà
_WCHAR_H


26 #ià!
defšed
 
__Ãed_mb¡©e_t
 && !defšed 
__Ãed_wšt_t


27 
	#_WCHAR_H
 1

	)

28 
	~<ã©u»s.h
>

31 #ifdeà
_WCHAR_H


33 
	#__Ãed___FILE


	)

34 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


35 
	#__Ãed_FILE


	)

37 
	~<¡dio.h
>

39 
	#__Ãed___va_li¡


	)

40 
	~<¡d¬g.h
>

42 
	~<b™s/wch¬.h
>

45 
	#__Ãed_size_t


	)

46 
	#__Ãed_wch¬_t


	)

47 
	#__Ãed_NULL


	)

49 #ià
defšed
 
_WCHAR_H
 || defšed 
__Ãed_wšt_t
 || !defšed 
__WINT_TYPE__


50 #undeà
__Ãed_wšt_t


51 
	#__Ãed_wšt_t


	)

52 
	~<¡ddef.h
>

55 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (4, 4)

56 
	#__CORRECT_ISO_CPP_WCHAR_H_PROTO


	)

61 #iâdeà
_WINT_T


66 
	#_WINT_T


	)

67 
	twšt_t
;

71 #ià
defšed
 
__ılu¥lus
 && defšed 
_GLIBCPP_USE_NAMESPACES
 \

72 && 
defšed
 
__WINT_TYPE__


73 
__BEGIN_NAMESPACE_STD


74 
__WINT_TYPE__
 
	twšt_t
;

75 
	g__END_NAMESPACE_STD


80 #ià(
defšed
 
_WCHAR_H
 || defšed 
__Ãed_mb¡©e_t
è&& !defšed 
__mb¡©e_t_defšed


81 
	#__mb¡©e_t_defšed
 1

	)

85 
	m__couÁ
;

88 #ifdeà
__WINT_TYPE__


89 
__WINT_TYPE__
 
	m__wch
;

91 
wšt_t
 
	m__wch
;

93 
	m__wchb
[4];

94 } 
	m__v®ue
;

95 } 
	t__mb¡©e_t
;

97 #undeà
__Ãed_mb¡©e_t


102 #ifdeà
_WCHAR_H


104 
__BEGIN_NAMESPACE_C99


106 
__mb¡©e_t
 
	tmb¡©e_t
;

107 
	g__END_NAMESPACE_C99


108 #ifdeà
__USE_GNU


109 
	$__USING_NAMESPACE_C99
(
mb¡©e_t
)

112 #iâdeà
WCHAR_MIN


114 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

115 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

118 #iâdeà
WEOF


119 
	#WEOF
 (0xffffffffu)

	)

124 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_UNIX98


125 
	~<wùy³.h
>

129 
__BEGIN_DECLS


131 
__BEGIN_NAMESPACE_STD


134 
tm
;

135 
__END_NAMESPACE_STD


139 
	$__USING_NAMESPACE_STD
(
tm
)

142 
__BEGIN_NAMESPACE_STD


144 
wch¬_t
 *
	$wcsıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

145 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
è
__THROW
;

147 
wch¬_t
 *
	$wc¢ıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

148 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

149 
__THROW
;

152 
wch¬_t
 *
	$wcsÿt
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

153 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
è
__THROW
;

155 
wch¬_t
 *
	$wc¢ÿt
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

156 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

157 
__THROW
;

160 
	$wcscmp
 (
__cÚ¡
 
wch¬_t
 *
__s1
, __cÚ¡ wch¬_ˆ*
__s2
)

161 
__THROW
 
__©Œibu‹_pu»__
;

163 
	$wc¢cmp
 (
__cÚ¡
 
wch¬_t
 *
__s1
, __cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

164 
__THROW
 
__©Œibu‹_pu»__
;

165 
__END_NAMESPACE_STD


167 #ifdeà
__USE_XOPEN2K8


169 
	$wcsÿ£cmp
 (
__cÚ¡
 
wch¬_t
 *
__s1
, __cÚ¡ wch¬_ˆ*
__s2
è
__THROW
;

172 
	$wc¢ÿ£cmp
 (
__cÚ¡
 
wch¬_t
 *
__s1
, __cÚ¡ wch¬_ˆ*
__s2
,

173 
size_t
 
__n
è
__THROW
;

177 
	~<xloÿË.h
>

179 
	$wcsÿ£cmp_l
 (
__cÚ¡
 
wch¬_t
 *
__s1
, __cÚ¡ wch¬_ˆ*
__s2
,

180 
__loÿË_t
 
__loc
è
__THROW
;

182 
	$wc¢ÿ£cmp_l
 (
__cÚ¡
 
wch¬_t
 *
__s1
, __cÚ¡ wch¬_ˆ*
__s2
,

183 
size_t
 
__n
, 
__loÿË_t
 
__loc
è
__THROW
;

186 
__BEGIN_NAMESPACE_STD


189 
	$wcscŞl
 (
__cÚ¡
 
wch¬_t
 *
__s1
, __cÚ¡ wch¬_ˆ*
__s2
è
__THROW
;

193 
size_t
 
	$wcsxäm
 (
wch¬_t
 *
__»¡riù
 
__s1
,

194 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
è
__THROW
;

195 
__END_NAMESPACE_STD


197 #ifdeà
__USE_XOPEN2K8


203 
	$wcscŞl_l
 (
__cÚ¡
 
wch¬_t
 *
__s1
, __cÚ¡ wch¬_ˆ*
__s2
,

204 
__loÿË_t
 
__loc
è
__THROW
;

209 
size_t
 
	$wcsxäm_l
 (
wch¬_t
 *
__s1
, 
__cÚ¡
 wch¬_ˆ*
__s2
,

210 
size_t
 
__n
, 
__loÿË_t
 
__loc
è
__THROW
;

213 
wch¬_t
 *
	$wcsdup
 (
__cÚ¡
 
wch¬_t
 *
__s
è
__THROW
 
__©Œibu‹_m®loc__
;

216 
__BEGIN_NAMESPACE_STD


218 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


219 "C++" 
wch¬_t
 *
	$wcschr
 (
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

220 
__THROW
 
	`__asm
 ("wcschr"è
__©Œibu‹_pu»__
;

221 "C++" 
__cÚ¡
 
wch¬_t
 *
	$wcschr
 (
__cÚ¡
 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

222 
__THROW
 
	`__asm
 ("wcschr"è
__©Œibu‹_pu»__
;

224 
wch¬_t
 *
	$wcschr
 (
__cÚ¡
 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

225 
__THROW
 
__©Œibu‹_pu»__
;

228 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


229 "C++" 
wch¬_t
 *
	$wc¤chr
 (
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

230 
__THROW
 
	`__asm
 ("wc¤chr"è
__©Œibu‹_pu»__
;

231 "C++" 
__cÚ¡
 
wch¬_t
 *
	$wc¤chr
 (
__cÚ¡
 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

232 
__THROW
 
	`__asm
 ("wc¤chr"è
__©Œibu‹_pu»__
;

234 
wch¬_t
 *
	$wc¤chr
 (
__cÚ¡
 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

235 
__THROW
 
__©Œibu‹_pu»__
;

237 
__END_NAMESPACE_STD


239 #ifdeà
__USE_GNU


242 
wch¬_t
 *
	$wcschºul
 (
__cÚ¡
 
wch¬_t
 *
__s
, wch¬_ˆ
__wc
)

243 
__THROW
 
__©Œibu‹_pu»__
;

246 
__BEGIN_NAMESPACE_STD


249 
size_t
 
	$wcsc¥n
 (
__cÚ¡
 
wch¬_t
 *
__wcs
, __cÚ¡ wch¬_ˆ*
__»jeù
)

250 
__THROW
 
__©Œibu‹_pu»__
;

253 
size_t
 
	$wcs¥n
 (
__cÚ¡
 
wch¬_t
 *
__wcs
, __cÚ¡ wch¬_ˆ*
__acû±
)

254 
__THROW
 
__©Œibu‹_pu»__
;

256 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


257 "C++" 
wch¬_t
 *
	$wc¥brk
 (
wch¬_t
 *
__wcs
, 
__cÚ¡
 wch¬_ˆ*
__acû±
)

258 
__THROW
 
	`__asm
 ("wc¥brk"è
__©Œibu‹_pu»__
;

259 "C++" 
__cÚ¡
 
wch¬_t
 *
	$wc¥brk
 (
__cÚ¡
 
wch¬_t
 *
__wcs
,

260 
__cÚ¡
 
wch¬_t
 *
__acû±
)

261 
__THROW
 
	`__asm
 ("wc¥brk"è
__©Œibu‹_pu»__
;

263 
wch¬_t
 *
	$wc¥brk
 (
__cÚ¡
 
wch¬_t
 *
__wcs
, __cÚ¡ wch¬_ˆ*
__acû±
)

264 
__THROW
 
__©Œibu‹_pu»__
;

267 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


268 "C++" 
wch¬_t
 *
	$wcs¡r
 (
wch¬_t
 *
__hay¡ack
, 
__cÚ¡
 wch¬_ˆ*
__ÃedË
)

269 
__THROW
 
	`__asm
 ("wcs¡r"è
__©Œibu‹_pu»__
;

270 "C++" 
__cÚ¡
 
wch¬_t
 *
	$wcs¡r
 (
__cÚ¡
 
wch¬_t
 *
__hay¡ack
,

271 
__cÚ¡
 
wch¬_t
 *
__ÃedË
)

272 
__THROW
 
	`__asm
 ("wcs¡r"è
__©Œibu‹_pu»__
;

274 
wch¬_t
 *
	$wcs¡r
 (
__cÚ¡
 
wch¬_t
 *
__hay¡ack
, __cÚ¡ wch¬_ˆ*
__ÃedË
)

275 
__THROW
 
__©Œibu‹_pu»__
;

279 
wch¬_t
 *
	$wc¡ok
 (
wch¬_t
 *
__»¡riù
 
__s
,

280 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__d–im
,

281 
wch¬_t
 **
__»¡riù
 
__±r
è
__THROW
;

284 
size_t
 
	$wc¦’
 (
__cÚ¡
 
wch¬_t
 *
__s
è
__THROW
 
__©Œibu‹_pu»__
;

285 
__END_NAMESPACE_STD


287 #ifdeà
__USE_XOPEN


289 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


290 "C++" 
wch¬_t
 *
	$wcswcs
 (
wch¬_t
 *
__hay¡ack
, 
__cÚ¡
 wch¬_ˆ*
__ÃedË
)

291 
__THROW
 
	`__asm
 ("wcswcs"è
__©Œibu‹_pu»__
;

292 "C++" 
__cÚ¡
 
wch¬_t
 *
	$wcswcs
 (
__cÚ¡
 
wch¬_t
 *
__hay¡ack
,

293 
__cÚ¡
 
wch¬_t
 *
__ÃedË
)

294 
__THROW
 
	`__asm
 ("wcswcs"è
__©Œibu‹_pu»__
;

296 
wch¬_t
 *
	$wcswcs
 (
__cÚ¡
 
wch¬_t
 *
__hay¡ack
, __cÚ¡ wch¬_ˆ*
__ÃedË
)

297 
__THROW
 
__©Œibu‹_pu»__
;

301 #ifdeà
__USE_XOPEN2K8


303 
size_t
 
	$wc¢Ën
 (
__cÚ¡
 
wch¬_t
 *
__s
, 
size_t
 
__maxËn
)

304 
__THROW
 
__©Œibu‹_pu»__
;

308 
__BEGIN_NAMESPACE_STD


310 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


311 "C++" 
wch¬_t
 *
	$wmemchr
 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
)

312 
__THROW
 
	`__asm
 ("wmemchr"è
__©Œibu‹_pu»__
;

313 "C++" 
__cÚ¡
 
wch¬_t
 *
	$wmemchr
 (
__cÚ¡
 
wch¬_t
 *
__s
, wch¬_ˆ
__c
,

314 
size_t
 
__n
)

315 
__THROW
 
	`__asm
 ("wmemchr"è
__©Œibu‹_pu»__
;

317 
wch¬_t
 *
	$wmemchr
 (
__cÚ¡
 
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
)

318 
__THROW
 
__©Œibu‹_pu»__
;

322 
	$wmemcmp
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s1
,

323 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
)

324 
__THROW
 
__©Œibu‹_pu»__
;

327 
wch¬_t
 *
	$wmemıy
 (
wch¬_t
 *
__»¡riù
 
__s1
,

328 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
è
__THROW
;

332 
wch¬_t
 *
	$wmemmove
 (
wch¬_t
 *
__s1
, 
__cÚ¡
 wch¬_ˆ*
__s2
, 
size_t
 
__n
)

333 
__THROW
;

336 
wch¬_t
 *
	$wmem£t
 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
è
__THROW
;

337 
__END_NAMESPACE_STD


339 #ifdeà
__USE_GNU


342 
wch¬_t
 *
	$wmempıy
 (
wch¬_t
 *
__»¡riù
 
__s1
,

343 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
)

344 
__THROW
;

348 
__BEGIN_NAMESPACE_STD


351 
wšt_t
 
	$btowc
 (
__c
è
__THROW
;

355 
	$wùob
 (
wšt_t
 
__c
è
__THROW
;

359 
	$mbsš™
 (
__cÚ¡
 
mb¡©e_t
 *
__ps
è
__THROW
 
__©Œibu‹_pu»__
;

363 
size_t
 
	$mb¹owc
 (
wch¬_t
 *
__»¡riù
 
__pwc
,

364 
__cÚ¡
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

365 
mb¡©e_t
 *
__p
è
__THROW
;

368 
size_t
 
	$wütomb
 (*
__»¡riù
 
__s
, 
wch¬_t
 
__wc
,

369 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

372 
size_t
 
	$__mb¾’
 (
__cÚ¡
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

373 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

374 
size_t
 
	$mb¾’
 (
__cÚ¡
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

375 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

376 
__END_NAMESPACE_STD


378 #ifdeà
__USE_EXTERN_INLINES


384 
wšt_t
 
	$__btowc_®Ÿs
 (
__c
è
	`__asm
 ("btowc");

385 
__ex‹º_šlše
 
wšt_t


386 
	`__NTH
 (
	$btowc
 (
__c
))

387 {  (
	`__butš_cÚ¡ªt_p
 (
__c
) && __c >= '\0' && __c <= '\x7f'

388 ? (
wšt_t
è
__c
 : 
	`__btowc_®Ÿs
 (__c)); 
	}
}

390 
	$__wùob_®Ÿs
 (
wšt_t
 
__c
è
	`__asm
 ("wctob");

391 
__ex‹º_šlše
 

392 
	`__NTH
 (
	$wùob
 (
wšt_t
 
__wc
))

393 {  (
	`__butš_cÚ¡ªt_p
 (
__wc
è&& __wø>ğ
L
'\0' && __wc <= L'\x7f'

394 ? (è
__wc
 : 
	`__wùob_®Ÿs
 (__wc)); 
	}
}

396 
__ex‹º_šlše
 
size_t


397 
__NTH
 (
	$mb¾’
 (
__cÚ¡
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

398 
mb¡©e_t
 *
__»¡riù
 
__ps
))

399 {  (
__ps
 !ğ
NULL


400 ? 
	`mb¹owc
 (
NULL
, 
__s
, 
__n
, 
__ps
è: 
	`__mb¾’
 (__s, __n, NULL)); 
	}
}

403 
__BEGIN_NAMESPACE_STD


406 
size_t
 
	$mb¤towcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

407 
__cÚ¡
 **
__»¡riù
 
__¤c
, 
size_t
 
__Ën
,

408 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

412 
size_t
 
	$wc¤tombs
 (*
__»¡riù
 
__d¡
,

413 
__cÚ¡
 
wch¬_t
 **
__»¡riù
 
__¤c
, 
size_t
 
__Ën
,

414 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

415 
__END_NAMESPACE_STD


418 #ifdef 
__USE_XOPEN2K8


421 
size_t
 
	$mb¢¹owcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

422 
__cÚ¡
 **
__»¡riù
 
__¤c
, 
size_t
 
__nmc
,

423 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

427 
size_t
 
	$wc¢¹ombs
 (*
__»¡riù
 
__d¡
,

428 
__cÚ¡
 
wch¬_t
 **
__»¡riù
 
__¤c
,

429 
size_t
 
__nwc
, size_ˆ
__Ën
,

430 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

435 #ifdeà
__USE_XOPEN


437 
	$wcwidth
 (
wch¬_t
 
__c
è
__THROW
;

441 
	$wcswidth
 (
__cÚ¡
 
wch¬_t
 *
__s
, 
size_t
 
__n
è
__THROW
;

445 
__BEGIN_NAMESPACE_STD


448 
	$wc¡od
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

449 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

450 
__END_NAMESPACE_STD


452 #ifdeà
__USE_ISOC99


453 
__BEGIN_NAMESPACE_C99


455 
	$wc¡of
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

456 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

457 
	$wc¡Şd
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

458 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

459 
__END_NAMESPACE_C99


463 
__BEGIN_NAMESPACE_STD


466 
	$wc¡Ş
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

467 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

471 
	$wc¡oul
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

472 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

473 
__THROW
;

474 
__END_NAMESPACE_STD


476 #ià
defšed
 
__USE_ISOC99
 || (defšed 
__GNUC__
 && defšed 
__USE_GNU
)

477 
__BEGIN_NAMESPACE_C99


480 
__ex‹nsiÚ__


481 
	$wc¡Şl
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

482 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

483 
__THROW
;

487 
__ex‹nsiÚ__


488 
	$wc¡ouÎ
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

489 
wch¬_t
 **
__»¡riù
 
__’d±r
,

490 
__ba£
è
__THROW
;

491 
__END_NAMESPACE_C99


494 #ià
defšed
 
__GNUC__
 && defšed 
__USE_GNU


497 
__ex‹nsiÚ__


498 
	$wc¡oq
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

499 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

500 
__THROW
;

504 
__ex‹nsiÚ__


505 
	$wc¡ouq
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

506 
wch¬_t
 **
__»¡riù
 
__’d±r
,

507 
__ba£
è
__THROW
;

510 #ifdeà
__USE_GNU


524 
	~<xloÿË.h
>

528 
	$wc¡Ş_l
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

529 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
,

530 
__loÿË_t
 
__loc
è
__THROW
;

532 
	$wc¡oul_l
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

533 
wch¬_t
 **
__»¡riù
 
__’d±r
,

534 
__ba£
, 
__loÿË_t
 
__loc
è
__THROW
;

536 
__ex‹nsiÚ__


537 
	$wc¡Şl_l
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

538 
wch¬_t
 **
__»¡riù
 
__’d±r
,

539 
__ba£
, 
__loÿË_t
 
__loc
è
__THROW
;

541 
__ex‹nsiÚ__


542 
	$wc¡ouÎ_l
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

543 
wch¬_t
 **
__»¡riù
 
__’d±r
,

544 
__ba£
, 
__loÿË_t
 
__loc
)

545 
__THROW
;

547 
	$wc¡od_l
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

548 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

549 
__THROW
;

551 
	$wc¡of_l
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

552 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

553 
__THROW
;

555 
	$wc¡Şd_l
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

556 
wch¬_t
 **
__»¡riù
 
__’d±r
,

557 
__loÿË_t
 
__loc
è
__THROW
;

561 #ifdef 
__USE_XOPEN2K8


564 
wch¬_t
 *
	$wııy
 (
wch¬_t
 *
__de¡
, 
__cÚ¡
 wch¬_ˆ*
__¤c
è
__THROW
;

568 
wch¬_t
 *
	$wınıy
 (
wch¬_t
 *
__de¡
, 
__cÚ¡
 wch¬_ˆ*
__¤c
, 
size_t
 
__n
)

569 
__THROW
;

575 #ifdef 
__USE_XOPEN2K8


578 
__FILE
 *
	$İ’_wmem¡»am
 (
wch¬_t
 **
__buæoc
, 
size_t
 *
__siz–oc
è
__THROW
;

581 #ià
defšed
 
__USE_ISOC95
 || defšed 
__USE_UNIX98


582 
__BEGIN_NAMESPACE_STD


585 
	$fwide
 (
__FILE
 *
__å
, 
__mode
è
__THROW
;

592 
	`fw´štf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

593 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

599 
	`w´štf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

602 
	$sw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

603 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

604 
__THROW
 ;

610 
	`vfw´štf
 (
__FILE
 *
__»¡riù
 
__s
,

611 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

612 
__gnuc_va_li¡
 
__¬g
)

618 
	`vw´štf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

619 
__gnuc_va_li¡
 
__¬g
)

623 
	$vsw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

624 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

625 
__gnuc_va_li¡
 
__¬g
)

626 
__THROW
 ;

633 
	`fwsÿnf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

634 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

640 
	`wsÿnf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

643 
	$swsÿnf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s
,

644 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

645 
__THROW
 ;

647 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

648 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

649 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

650 #ifdeà
__REDIRECT


654 
	`__REDIRECT
 (
fwsÿnf
, (
__FILE
 *
__»¡riù
 
__¡»am
,

655 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...),

656 
__isoc99_fwsÿnf
)

658 
	`__REDIRECT
 (
wsÿnf
, (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...),

659 
__isoc99_wsÿnf
)

661 
	`__REDIRECT
 (
swsÿnf
, (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s
,

662 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...),

663 
__isoc99_swsÿnf
)

664 
__THROW
 ;

666 
	`__isoc99_fwsÿnf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

667 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...);

668 
	`__isoc99_wsÿnf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...);

669 
	$__isoc99_swsÿnf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s
,

670 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

671 
__THROW
;

672 
	#fwsÿnf
 
__isoc99_fwsÿnf


	)

673 
	#wsÿnf
 
__isoc99_wsÿnf


	)

674 
	#swsÿnf
 
__isoc99_swsÿnf


	)

678 
__END_NAMESPACE_STD


681 #ifdeà
__USE_ISOC99


682 
__BEGIN_NAMESPACE_C99


687 
	`vfwsÿnf
 (
__FILE
 *
__»¡riù
 
__s
,

688 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

689 
__gnuc_va_li¡
 
__¬g
)

695 
	`vwsÿnf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

696 
__gnuc_va_li¡
 
__¬g
)

699 
	$vswsÿnf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s
,

700 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

701 
__gnuc_va_li¡
 
__¬g
)

702 
__THROW
 ;

704 #ià!
defšed
 
__USE_GNU
 \

705 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

706 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

707 #ifdeà
__REDIRECT


708 
	`__REDIRECT
 (
vfwsÿnf
, (
__FILE
 *
__»¡riù
 
__s
,

709 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

710 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vfwsÿnf
)

712 
	`__REDIRECT
 (
vwsÿnf
, (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

713 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vwsÿnf
)

715 
	`__REDIRECT
 (
vswsÿnf
, (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s
,

716 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

717 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vswsÿnf
)

718 
__THROW
 ;

720 
	`__isoc99_vfwsÿnf
 (
__FILE
 *
__»¡riù
 
__s
,

721 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

722 
__gnuc_va_li¡
 
__¬g
);

723 
	`__isoc99_vwsÿnf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

724 
__gnuc_va_li¡
 
__¬g
);

725 
	$__isoc99_vswsÿnf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s
,

726 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

727 
__gnuc_va_li¡
 
__¬g
è
__THROW
;

728 
	#vfwsÿnf
 
__isoc99_vfwsÿnf


	)

729 
	#vwsÿnf
 
__isoc99_vwsÿnf


	)

730 
	#vswsÿnf
 
__isoc99_vswsÿnf


	)

734 
__END_NAMESPACE_C99


738 
__BEGIN_NAMESPACE_STD


743 
wšt_t
 
	`fg‘wc
 (
__FILE
 *
__¡»am
);

744 
wšt_t
 
	`g‘wc
 (
__FILE
 *
__¡»am
);

750 
wšt_t
 
	`g‘wch¬
 ();

757 
wšt_t
 
	`åutwc
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

758 
wšt_t
 
	`putwc
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

764 
wšt_t
 
	`putwch¬
 (
wch¬_t
 
__wc
);

772 
wch¬_t
 *
	`fg‘ws
 (wch¬_ˆ*
__»¡riù
 
__ws
, 
__n
,

773 
__FILE
 *
__»¡riù
 
__¡»am
);

779 
	`åutws
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ws
,

780 
__FILE
 *
__»¡riù
 
__¡»am
);

787 
wšt_t
 
	`ung‘wc
 (wšt_ˆ
__wc
, 
__FILE
 *
__¡»am
);

788 
__END_NAMESPACE_STD


791 #ifdeà
__USE_GNU


799 
wšt_t
 
	`g‘wc_uÆocked
 (
__FILE
 *
__¡»am
);

800 
wšt_t
 
	`g‘wch¬_uÆocked
 ();

808 
wšt_t
 
	`fg‘wc_uÆocked
 (
__FILE
 *
__¡»am
);

816 
wšt_t
 
	`åutwc_uÆocked
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

825 
wšt_t
 
	`putwc_uÆocked
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

826 
wšt_t
 
	`putwch¬_uÆocked
 (
wch¬_t
 
__wc
);

835 
wch¬_t
 *
	`fg‘ws_uÆocked
 (wch¬_ˆ*
__»¡riù
 
__ws
, 
__n
,

836 
__FILE
 *
__»¡riù
 
__¡»am
);

844 
	`åutws_uÆocked
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ws
,

845 
__FILE
 *
__»¡riù
 
__¡»am
);

849 
__BEGIN_NAMESPACE_C99


853 
size_t
 
	$wcsáime
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

854 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

855 
__cÚ¡
 
tm
 *
__»¡riù
 
__
è
__THROW
;

856 
__END_NAMESPACE_C99


858 #ifdeà
__USE_GNU


859 
	~<xloÿË.h
>

863 
size_t
 
	$wcsáime_l
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

864 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

865 
__cÚ¡
 
tm
 *
__»¡riù
 
__
,

866 
__loÿË_t
 
__loc
è
__THROW
;

875 #ià
defšed
 
__USE_UNIX98
 && !defšed 
__USE_GNU


876 
	#__Ãed_iswxxx


	)

877 
	~<wùy³.h
>

881 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


882 
	~<b™s/wch¬2.h
>

885 #ifdeà
__LDBL_COMPAT


886 
	~<b™s/wch¬-ldbl.h
>

889 
__END_DECLS


897 #undeà
__Ãed_mb¡©e_t


898 #undeà
__Ãed_wšt_t


	@/usr/include/bits/wchar-ldbl.h

20 #iâdeà
_WCHAR_H


24 #ià
defšed
 
__USE_ISOC95
 || defšed 
__USE_UNIX98


25 
__BEGIN_NAMESPACE_C99


26 
__LDBL_REDIR_DECL
 (
fw´štf
);

27 
__LDBL_REDIR_DECL
 (
w´štf
);

28 
__LDBL_REDIR_DECL
 (
sw´štf
);

29 
__LDBL_REDIR_DECL
 (
vfw´štf
);

30 
__LDBL_REDIR_DECL
 (
vw´štf
);

31 
__LDBL_REDIR_DECL
 (
vsw´štf
);

32 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

33 && !
defšed
 
	g__REDIRECT
 \

34 && (
defšed
 
	g__STRICT_ANSI__
 || defšed 
	g__USE_XOPEN2K
)

35 
	$__LDBL_REDIR1_DECL
 (
fwsÿnf
, 
__Ædbl___isoc99_fwsÿnf
)

36 
	$__LDBL_REDIR1_DECL
 (
wsÿnf
, 
__Ædbl___isoc99_wsÿnf
)

37 
	$__LDBL_REDIR1_DECL
 (
swsÿnf
, 
__Ædbl___isoc99_swsÿnf
)

39 
	`__LDBL_REDIR_DECL
 (
fwsÿnf
);

40 
	`__LDBL_REDIR_DECL
 (
wsÿnf
);

41 
	`__LDBL_REDIR_DECL
 (
swsÿnf
);

43 
__END_NAMESPACE_C99


46 #ifdeà
__USE_ISOC99


47 
__BEGIN_NAMESPACE_C99


48 
	`__LDBL_REDIR1_DECL
 (
wc¡Şd
, 
wc¡od
);

49 #ià!
defšed
 
__USE_GNU
 && !defšed 
__REDIRECT
 \

50 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

51 
	$__LDBL_REDIR1_DECL
 (
vfwsÿnf
, 
__Ædbl___isoc99_vfwsÿnf
)

52 
	$__LDBL_REDIR1_DECL
 (
vwsÿnf
, 
__Ædbl___isoc99_vwsÿnf
)

53 
	$__LDBL_REDIR1_DECL
 (
vswsÿnf
, 
__Ædbl___isoc99_vswsÿnf
)

55 
	`__LDBL_REDIR_DECL
 (
vfwsÿnf
);

56 
	`__LDBL_REDIR_DECL
 (
vwsÿnf
);

57 
	`__LDBL_REDIR_DECL
 (
vswsÿnf
);

59 
__END_NAMESPACE_C99


62 #ifdeà
__USE_GNU


63 
	`__LDBL_REDIR1_DECL
 (
wc¡Şd_l
, 
wc¡od_l
);

66 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


67 
	$__LDBL_REDIR_DECL
 (
__sw´štf_chk
)

68 
	$__LDBL_REDIR_DECL
 (
__vsw´štf_chk
)

69 #ià
__USE_FORTIFY_LEVEL
 > 1

70 
	$__LDBL_REDIR_DECL
 (
__fw´štf_chk
)

71 
	$__LDBL_REDIR_DECL
 (
__w´štf_chk
)

72 
	$__LDBL_REDIR_DECL
 (
__vfw´štf_chk
)

73 
	$__LDBL_REDIR_DECL
 (
__vw´štf_chk
)

	@/usr/include/bits/wchar.h

20 #iâdeà
_BITS_WCHAR_H


21 
	#_BITS_WCHAR_H
 1

	)

24 #ifdeà
__WCHAR_MAX__


25 
	#__WCHAR_MAX
 
__WCHAR_MAX__


	)

27 
	#__WCHAR_MAX
 (2147483647)

	)

32 #ifdeà
__WCHAR_UNSIGNED__


33 
	#__WCHAR_MIN
 
L
'\0'

	)

37 #–ià
L
'\0' - 1 > 0

38 
	#__WCHAR_MIN
 
L
'\0'

	)

40 
	#__WCHAR_MIN
 (-
__WCHAR_MAX
 - 1)

	)

	@/usr/include/bits/wchar2.h

20 #iâdeà
_WCHAR_H


25 
wch¬_t
 *
	$__wmemıy_chk
 (
wch¬_t
 *
__»¡riù
 
__s1
,

26 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
,

27 
size_t
 
__ns1
è
__THROW
;

28 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmemıy_®Ÿs
,

29 (
wch¬_t
 *
__»¡riù
 
__s1
,

30 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
),

31 
wmemıy
);

32 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmemıy_chk_w¬n
,

33 (
wch¬_t
 *
__»¡riù
 
__s1
,

34 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
,

35 
size_t
 
__ns1
), 
__wmemıy_chk
)

36 
	`__w¬Ç‰r
 ("wmemcpy called with†ength biggerhan size of destination "

39 
__ex‹º_®ways_šlše
 
wch¬_t
 *

40 
	`__NTH
 (
	$wmemıy
 (
wch¬_t
 *
__»¡riù
 
__s1
, 
__cÚ¡
 wch¬_ˆ*__»¡riù 
__s2
,

41 
size_t
 
__n
))

43 ià(
	`__bos0
 (
__s1
è!ğ(
size_t
) -1)

45 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

46  
	`__wmemıy_chk
 (
__s1
, 
__s2
, 
__n
,

47 
	`__bos0
 (
__s1
è/  (
wch¬_t
));

49 ià(
__n
 > 
	`__bos0
 (
__s1
è/  (
wch¬_t
))

50  
	`__wmemıy_chk_w¬n
 (
__s1
, 
__s2
, 
__n
,

51 
	`__bos0
 (
__s1
è/  (
wch¬_t
));

53  
	`__wmemıy_®Ÿs
 (
__s1
, 
__s2
, 
__n
);

54 
	}
}

57 
wch¬_t
 *
	$__wmemmove_chk
 (
wch¬_t
 *
__s1
, 
__cÚ¡
 wch¬_ˆ*
__s2
,

58 
size_t
 
__n
, size_ˆ
__ns1
è
__THROW
;

59 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmemmove_®Ÿs
, (wch¬_ˆ*
__s1
,

60 
__cÚ¡
 
wch¬_t
 *
__s2
,

61 
size_t
 
__n
), 
wmemmove
);

62 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmemmove_chk_w¬n
,

63 (
wch¬_t
 *
__»¡riù
 
__s1
,

64 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
,

65 
size_t
 
__ns1
), 
__wmemmove_chk
)

66 
	`__w¬Ç‰r
 ("wmemmove called with†ength biggerhan size of destination "

69 
__ex‹º_®ways_šlše
 
wch¬_t
 *

70 
	`__NTH
 (
	$wmemmove
 (
wch¬_t
 *
__»¡riù
 
__s1
, 
__cÚ¡
 wch¬_ˆ*__»¡riù 
__s2
,

71 
size_t
 
__n
))

73 ià(
	`__bos0
 (
__s1
è!ğ(
size_t
) -1)

75 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

76  
	`__wmemmove_chk
 (
__s1
, 
__s2
, 
__n
,

77 
	`__bos0
 (
__s1
è/  (
wch¬_t
));

79 ià(
__n
 > 
	`__bos0
 (
__s1
è/  (
wch¬_t
))

80  
	`__wmemmove_chk_w¬n
 (
__s1
, 
__s2
, 
__n
,

81 
	`__bos0
 (
__s1
è/  (
wch¬_t
));

83  
	`__wmemmove_®Ÿs
 (
__s1
, 
__s2
, 
__n
);

84 
	}
}

87 #ifdeà
__USE_GNU


88 
wch¬_t
 *
	$__wmempıy_chk
 (
wch¬_t
 *
__»¡riù
 
__s1
,

89 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
,

90 
size_t
 
__ns1
è
__THROW
;

91 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmempıy_®Ÿs
,

92 (
wch¬_t
 *
__»¡riù
 
__s1
,

93 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
,

94 
size_t
 
__n
), 
wmempıy
);

95 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmempıy_chk_w¬n
,

96 (
wch¬_t
 *
__»¡riù
 
__s1
,

97 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
,

98 
size_t
 
__ns1
), 
__wmempıy_chk
)

99 
	`__w¬Ç‰r
 ("wmempcpy called with†ength biggerhan size of destination "

102 
__ex‹º_®ways_šlše
 
wch¬_t
 *

103 
	`__NTH
 (
	$wmempıy
 (
wch¬_t
 *
__»¡riù
 
__s1
, 
__cÚ¡
 wch¬_ˆ*__»¡riù 
__s2
,

104 
size_t
 
__n
))

106 ià(
	`__bos0
 (
__s1
è!ğ(
size_t
) -1)

108 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

109  
	`__wmempıy_chk
 (
__s1
, 
__s2
, 
__n
,

110 
	`__bos0
 (
__s1
è/  (
wch¬_t
));

112 ià(
__n
 > 
	`__bos0
 (
__s1
è/  (
wch¬_t
))

113  
	`__wmempıy_chk_w¬n
 (
__s1
, 
__s2
, 
__n
,

114 
	`__bos0
 (
__s1
è/  (
wch¬_t
));

116  
	`__wmempıy_®Ÿs
 (
__s1
, 
__s2
, 
__n
);

117 
	}
}

121 
wch¬_t
 *
	$__wmem£t_chk
 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
,

122 
size_t
 
__ns
è
__THROW
;

123 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmem£t_®Ÿs
, (wch¬_ˆ*
__s
, wch¬_ˆ
__c
,

124 
size_t
 
__n
), 
wmem£t
);

125 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmem£t_chk_w¬n
,

126 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
,

127 
size_t
 
__ns
), 
__wmem£t_chk
)

128 
	`__w¬Ç‰r
 ("wmemset called with†ength biggerhan size of destination "

131 
__ex‹º_®ways_šlše
 
wch¬_t
 *

132 
	`__NTH
 (
	$wmem£t
 (
wch¬_t
 *
__»¡riù
 
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
))

134 ià(
	`__bos0
 (
__s
è!ğ(
size_t
) -1)

136 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

137  
	`__wmem£t_chk
 (
__s
, 
__c
, 
__n
, 
	`__bos0
 (__sè/  (
wch¬_t
));

139 ià(
__n
 > 
	`__bos0
 (
__s
è/  (
wch¬_t
))

140  
	`__wmem£t_chk_w¬n
 (
__s
, 
__c
, 
__n
,

141 
	`__bos0
 (
__s
è/  (
wch¬_t
));

143  
	`__wmem£t_®Ÿs
 (
__s
, 
__c
, 
__n
);

144 
	}
}

147 
wch¬_t
 *
	$__wcsıy_chk
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

148 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

149 
size_t
 
__n
è
__THROW
;

150 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wcsıy_®Ÿs
,

151 (
wch¬_t
 *
__»¡riù
 
__de¡
,

152 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
), 
wcsıy
);

154 
__ex‹º_®ways_šlše
 
wch¬_t
 *

155 
	`__NTH
 (
	$wcsıy
 (
wch¬_t
 *
__de¡
, 
__cÚ¡
 wch¬_ˆ*
__¤c
))

157 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1)

158  
	`__wcsıy_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__de¡è/  (
wch¬_t
));

159  
	`__wcsıy_®Ÿs
 (
__de¡
, 
__¤c
);

160 
	}
}

163 
wch¬_t
 *
	$__wııy_chk
 (
wch¬_t
 *
__de¡
, 
__cÚ¡
 wch¬_ˆ*
__¤c
,

164 
size_t
 
__de¡Ën
è
__THROW
;

165 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wııy_®Ÿs
, (wch¬_ˆ*
__de¡
,

166 
__cÚ¡
 
wch¬_t
 *
__¤c
),

167 
wııy
);

169 
__ex‹º_®ways_šlše
 
wch¬_t
 *

170 
	`__NTH
 (
	$wııy
 (
wch¬_t
 *
__de¡
, 
__cÚ¡
 wch¬_ˆ*
__¤c
))

172 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1)

173  
	`__wııy_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__de¡è/  (
wch¬_t
));

174  
	`__wııy_®Ÿs
 (
__de¡
, 
__¤c
);

175 
	}
}

178 
wch¬_t
 *
	$__wc¢ıy_chk
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

179 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
,

180 
size_t
 
__de¡Ën
è
__THROW
;

181 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wc¢ıy_®Ÿs
,

182 (
wch¬_t
 *
__»¡riù
 
__de¡
,

183 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

184 
size_t
 
__n
), 
wc¢ıy
);

185 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wc¢ıy_chk_w¬n
,

186 (
wch¬_t
 *
__»¡riù
 
__de¡
,

187 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

188 
size_t
 
__n
, size_ˆ
__de¡Ën
), 
__wc¢ıy_chk
)

189 
	`__w¬Ç‰r
 ("wcsncpy called with†ength biggerhan size of destination "

192 
__ex‹º_®ways_šlše
 
wch¬_t
 *

193 
	`__NTH
 (
	$wc¢ıy
 (
wch¬_t
 *
__de¡
, 
__cÚ¡
 wch¬_ˆ*
__¤c
, 
size_t
 
__n
))

195 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1)

197 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

198  
	`__wc¢ıy_chk
 (
__de¡
, 
__¤c
, 
__n
,

199 
	`__bos
 (
__de¡
è/  (
wch¬_t
));

200 ià(
__n
 > 
	`__bos
 (
__de¡
è/  (
wch¬_t
))

201  
	`__wc¢ıy_chk_w¬n
 (
__de¡
, 
__¤c
, 
__n
,

202 
	`__bos
 (
__de¡
è/  (
wch¬_t
));

204  
	`__wc¢ıy_®Ÿs
 (
__de¡
, 
__¤c
, 
__n
);

205 
	}
}

208 
wch¬_t
 *
	$__wınıy_chk
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

209 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
,

210 
size_t
 
__de¡Ën
è
__THROW
;

211 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wınıy_®Ÿs
,

212 (
wch¬_t
 *
__»¡riù
 
__de¡
,

213 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

214 
size_t
 
__n
), 
wınıy
);

215 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wınıy_chk_w¬n
,

216 (
wch¬_t
 *
__»¡riù
 
__de¡
,

217 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

218 
size_t
 
__n
, size_ˆ
__de¡Ën
), 
__wınıy_chk
)

219 
	`__w¬Ç‰r
 ("wcpncpy called with†ength biggerhan size of destination "

222 
__ex‹º_®ways_šlše
 
wch¬_t
 *

223 
	`__NTH
 (
	$wınıy
 (
wch¬_t
 *
__de¡
, 
__cÚ¡
 wch¬_ˆ*
__¤c
, 
size_t
 
__n
))

225 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1)

227 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

228  
	`__wınıy_chk
 (
__de¡
, 
__¤c
, 
__n
,

229 
	`__bos
 (
__de¡
è/  (
wch¬_t
));

230 ià(
__n
 > 
	`__bos
 (
__de¡
è/  (
wch¬_t
))

231  
	`__wınıy_chk_w¬n
 (
__de¡
, 
__¤c
, 
__n
,

232 
	`__bos
 (
__de¡
è/  (
wch¬_t
));

234  
	`__wınıy_®Ÿs
 (
__de¡
, 
__¤c
, 
__n
);

235 
	}
}

238 
wch¬_t
 *
	$__wcsÿt_chk
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

239 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

240 
size_t
 
__de¡Ën
è
__THROW
;

241 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wcsÿt_®Ÿs
,

242 (
wch¬_t
 *
__»¡riù
 
__de¡
,

243 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
), 
wcsÿt
);

245 
__ex‹º_®ways_šlše
 
wch¬_t
 *

246 
	`__NTH
 (
	$wcsÿt
 (
wch¬_t
 *
__de¡
, 
__cÚ¡
 wch¬_ˆ*
__¤c
))

248 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1)

249  
	`__wcsÿt_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__de¡è/  (
wch¬_t
));

250  
	`__wcsÿt_®Ÿs
 (
__de¡
, 
__¤c
);

251 
	}
}

254 
wch¬_t
 *
	$__wc¢ÿt_chk
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

255 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

256 
size_t
 
__n
, size_ˆ
__de¡Ën
è
__THROW
;

257 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wc¢ÿt_®Ÿs
,

258 (
wch¬_t
 *
__»¡riù
 
__de¡
,

259 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

260 
size_t
 
__n
), 
wc¢ÿt
);

262 
__ex‹º_®ways_šlše
 
wch¬_t
 *

263 
	`__NTH
 (
	$wc¢ÿt
 (
wch¬_t
 *
__de¡
, 
__cÚ¡
 wch¬_ˆ*
__¤c
, 
size_t
 
__n
))

265 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1)

266  
	`__wc¢ÿt_chk
 (
__de¡
, 
__¤c
, 
__n
,

267 
	`__bos
 (
__de¡
è/  (
wch¬_t
));

268  
	`__wc¢ÿt_®Ÿs
 (
__de¡
, 
__¤c
, 
__n
);

269 
	}
}

272 
	$__sw´štf_chk
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

273 
__æag
, 
size_t
 
__s_Ën
,

274 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

275 
__THROW
 ;

277 
	`__REDIRECT_NTH_LDBL
 (
__sw´štf_®Ÿs
,

278 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

279 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fmt
, ...),

280 
sw´štf
);

282 #ifdeà
__va_¬g_·ck


283 
__ex‹º_®ways_šlše
 

284 
	`__NTH
 (
	$sw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

285 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fmt
, ...))

287 ià(
	`__bos
 (
__s
è!ğ(
size_t
è-1 || 
__USE_FORTIFY_LEVEL
 > 1)

288  
	`__sw´štf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

289 
	`__bos
 (
__s
è/  (
wch¬_t
),

290 
__fmt
, 
	`__va_¬g_·ck
 ());

291  
	`__sw´štf_®Ÿs
 (
__s
, 
__n
, 
__fmt
, 
	`__va_¬g_·ck
 ());

292 
	}
}

293 #–ià!
defšed
 
__ılu¥lus


295 
	#sw´štf
(
s
, 
n
, ...) \

296 (
	`__bos
 (
s
è!ğ(
size_t
è-1 || 
__USE_FORTIFY_LEVEL
 > 1 \

297 ? 
	`__sw´štf_chk
 (
s
, 
n
, 
__USE_FORTIFY_LEVEL
 - 1, \

298 
	`__bos
 (
s
è/  (
wch¬_t
), 
__VA_ARGS__
) \

299 : 
	`sw´štf
 (
s
, 
n
, 
__VA_ARGS__
))

	)

302 
	$__vsw´štf_chk
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

303 
__æag
, 
size_t
 
__s_Ën
,

304 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

305 
__gnuc_va_li¡
 
__¬g
)

306 
__THROW
 ;

308 
	`__REDIRECT_NTH_LDBL
 (
__vsw´štf_®Ÿs
,

309 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

310 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fmt
,

311 
__gnuc_va_li¡
 
__­
), 
vsw´štf
);

313 
__ex‹º_®ways_šlše
 

314 
	`__NTH
 (
	$vsw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

315 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fmt
, 
__gnuc_va_li¡
 
__­
))

317 ià(
	`__bos
 (
__s
è!ğ(
size_t
è-1 || 
__USE_FORTIFY_LEVEL
 > 1)

318  
	`__vsw´štf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

319 
	`__bos
 (
__s
è/  (
wch¬_t
), 
__fmt
, 
__­
);

320  
	`__vsw´štf_®Ÿs
 (
__s
, 
__n
, 
__fmt
, 
__­
);

321 
	}
}

324 #ià
__USE_FORTIFY_LEVEL
 > 1

326 
__fw´štf_chk
 (
__FILE
 *
__»¡riù
 
__¡»am
, 
__æag
,

327 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...);

328 
__w´štf_chk
 (
__æag
, 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

330 
__vfw´štf_chk
 (
__FILE
 *
__»¡riù
 
__¡»am
, 
__æag
,

331 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

332 
__gnuc_va_li¡
 
__­
);

333 
__vw´štf_chk
 (
__æag
, 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

334 
__gnuc_va_li¡
 
__­
);

336 #ifdeà
__va_¬g_·ck


337 
__ex‹º_®ways_šlše
 

338 
	$w´štf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fmt
, ...)

340  
	`__w´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
	`__va_¬g_·ck
 ());

341 
	}
}

343 
__ex‹º_®ways_šlše
 

344 
	$fw´štf
 (
__FILE
 *
__»¡riù
 
__¡»am
, 
__cÚ¡
 
wch¬_t
 *__»¡riù 
__fmt
, ...)

346  
	`__fw´štf_chk
 (
__¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

347 
	`__va_¬g_·ck
 ());

348 
	}
}

349 #–ià!
defšed
 
__ılu¥lus


350 
	#w´štf
(...) \

351 
	`__w´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

352 
	#fw´štf
(
¡»am
, ...) \

353 
	`__fw´štf_chk
 (
¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

356 
__ex‹º_®ways_šlše
 

357 
	$vw´štf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fmt
, 
__gnuc_va_li¡
 
__­
)

359  
	`__vw´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

360 
	}
}

362 
__ex‹º_®ways_šlše
 

363 
	$vfw´štf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

364 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fmt
, 
__gnuc_va_li¡
 
__­
)

366  
	`__vfw´štf_chk
 (
__¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

367 
	}
}

371 
wch¬_t
 *
	$__fg‘ws_chk
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

372 
__FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

373 
wch¬_t
 *
	`__REDIRECT
 (
__fg‘ws_®Ÿs
,

374 (
wch¬_t
 *
__»¡riù
 
__s
, 
__n
,

375 
__FILE
 *
__»¡riù
 
__¡»am
), 
fg‘ws
è
__wur
;

376 
wch¬_t
 *
	`__REDIRECT
 (
__fg‘ws_chk_w¬n
,

377 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

378 
__FILE
 *
__»¡riù
 
__¡»am
), 
__fg‘ws_chk
)

379 
__wur
 
	`__w¬Ç‰r
 ("fgetws called with bigger sizehan†ength "

382 
__ex‹º_®ways_šlše
 
__wur
 
wch¬_t
 *

383 
	$fg‘ws
 (
wch¬_t
 *
__»¡riù
 
__s
, 
__n
, 
__FILE
 *__»¡riù 
__¡»am
)

385 ià(
	`__bos
 (
__s
è!ğ(
size_t
) -1)

387 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
) || __n <= 0)

388  
	`__fg‘ws_chk
 (
__s
, 
	`__bos
 (__sè/  (
wch¬_t
),

389 
__n
, 
__¡»am
);

391 ià((
size_t
è
__n
 > 
	`__bos
 (
__s
è/  (
wch¬_t
))

392  
	`__fg‘ws_chk_w¬n
 (
__s
, 
	`__bos
 (__sè/  (
wch¬_t
),

393 
__n
, 
__¡»am
);

395  
	`__fg‘ws_®Ÿs
 (
__s
, 
__n
, 
__¡»am
);

396 
	}
}

398 #ifdeà
__USE_GNU


399 
wch¬_t
 *
	$__fg‘ws_uÆocked_chk
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__size
,

400 
__n
, 
__FILE
 *
__»¡riù
 
__¡»am
)

401 
__wur
;

402 
wch¬_t
 *
	`__REDIRECT
 (
__fg‘ws_uÆocked_®Ÿs
,

403 (
wch¬_t
 *
__»¡riù
 
__s
, 
__n
,

404 
__FILE
 *
__»¡riù
 
__¡»am
), 
fg‘ws_uÆocked
)

405 
__wur
;

406 
wch¬_t
 *
	`__REDIRECT
 (
__fg‘ws_uÆocked_chk_w¬n
,

407 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

408 
__FILE
 *
__»¡riù
 
__¡»am
),

409 
__fg‘ws_uÆocked_chk
)

410 
__wur
 
	`__w¬Ç‰r
 ("fgetws_unlocked called with bigger sizehan†ength "

413 
__ex‹º_®ways_šlše
 
__wur
 
wch¬_t
 *

414 
	$fg‘ws_uÆocked
 (
wch¬_t
 *
__»¡riù
 
__s
, 
__n
, 
__FILE
 *__»¡riù 
__¡»am
)

416 ià(
	`__bos
 (
__s
è!ğ(
size_t
) -1)

418 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
) || __n <= 0)

419  
	`__fg‘ws_uÆocked_chk
 (
__s
, 
	`__bos
 (__sè/  (
wch¬_t
),

420 
__n
, 
__¡»am
);

422 ià((
size_t
è
__n
 > 
	`__bos
 (
__s
è/  (
wch¬_t
))

423  
	`__fg‘ws_uÆocked_chk_w¬n
 (
__s
, 
	`__bos
 (__sè/  (
wch¬_t
),

424 
__n
, 
__¡»am
);

426  
	`__fg‘ws_uÆocked_®Ÿs
 (
__s
, 
__n
, 
__¡»am
);

427 
	}
}

431 
size_t
 
	$__wütomb_chk
 (*
__s
, 
wch¬_t
 
__wch¬
, 
mb¡©e_t
 *
__p
,

432 
size_t
 
__buæ’
è
__THROW
 
__wur
;

433 
size_t
 
	`__REDIRECT_NTH
 (
__wütomb_®Ÿs
,

434 (*
__»¡riù
 
__s
, 
wch¬_t
 
__wch¬
,

435 
mb¡©e_t
 *
__»¡riù
 
__ps
), 
wütomb
è
__wur
;

437 
__ex‹º_®ways_šlše
 
__wur
 
size_t


438 
	`__NTH
 (
	$wütomb
 (*
__s
, 
wch¬_t
 
__wch¬
, 
mb¡©e_t
 *
__ps
))

443 
	#__WCHAR_MB_LEN_MAX
 16

	)

444 #ià
defšed
 
MB_LEN_MAX
 && MB_LEN_MAX !ğ
__WCHAR_MB_LEN_MAX


447 ià(
	`__bos
 (
__s
è!ğ(
size_t
è-1 && 
__WCHAR_MB_LEN_MAX
 > __bos (__s))

448  
	`__wütomb_chk
 (
__s
, 
__wch¬
, 
__ps
, 
	`__bos
 (__s));

449  
	`__wütomb_®Ÿs
 (
__s
, 
__wch¬
, 
__ps
);

450 
	}
}

453 
size_t
 
	$__mb¤towcs_chk
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

454 
__cÚ¡
 **
__»¡riù
 
__¤c
,

455 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
,

456 
size_t
 
__d¡Ën
è
__THROW
;

457 
size_t
 
	`__REDIRECT_NTH
 (
__mb¤towcs_®Ÿs
,

458 (
wch¬_t
 *
__»¡riù
 
__d¡
,

459 
__cÚ¡
 **
__»¡riù
 
__¤c
,

460 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
),

461 
mb¤towcs
);

462 
size_t
 
	`__REDIRECT_NTH
 (
__mb¤towcs_chk_w¬n
,

463 (
wch¬_t
 *
__»¡riù
 
__d¡
,

464 
__cÚ¡
 **
__»¡riù
 
__¤c
,

465 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
,

466 
size_t
 
__d¡Ën
), 
__mb¤towcs_chk
)

467 
	`__w¬Ç‰r
 ("mbsrtowcs called with dst buffer smallerhan†en "

470 
__ex‹º_®ways_šlše
 
size_t


471 
	`__NTH
 (
	$mb¤towcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
, 
__cÚ¡
 **__»¡riù 
__¤c
,

472 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
))

474 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

476 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

477  
	`__mb¤towcs_chk
 (
__d¡
, 
__¤c
, 
__Ën
, 
__ps
,

478 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

480 ià(
__Ën
 > 
	`__bos
 (
__d¡
è/  (
wch¬_t
))

481  
	`__mb¤towcs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__Ën
, 
__ps
,

482 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

484  
	`__mb¤towcs_®Ÿs
 (
__d¡
, 
__¤c
, 
__Ën
, 
__ps
);

485 
	}
}

488 
size_t
 
	$__wc¤tombs_chk
 (*
__»¡riù
 
__d¡
,

489 
__cÚ¡
 
wch¬_t
 **
__»¡riù
 
__¤c
,

490 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
,

491 
size_t
 
__d¡Ën
è
__THROW
;

492 
size_t
 
	`__REDIRECT_NTH
 (
__wc¤tombs_®Ÿs
,

493 (*
__»¡riù
 
__d¡
,

494 
__cÚ¡
 
wch¬_t
 **
__»¡riù
 
__¤c
,

495 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
),

496 
wc¤tombs
);

497 
size_t
 
	`__REDIRECT_NTH
 (
__wc¤tombs_chk_w¬n
,

498 (*
__»¡riù
 
__d¡
,

499 
__cÚ¡
 
wch¬_t
 **
__»¡riù
 
__¤c
,

500 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
,

501 
size_t
 
__d¡Ën
), 
__wc¤tombs_chk
)

502 
	`__w¬Ç‰r
 ("wcsrtombs called with dst buffer smallerhan†en");

504 
__ex‹º_®ways_šlše
 
size_t


505 
	`__NTH
 (
	$wc¤tombs
 (*
__»¡riù
 
__d¡
, 
__cÚ¡
 
wch¬_t
 **__»¡riù 
__¤c
,

506 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
))

508 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

510 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

511  
	`__wc¤tombs_chk
 (
__d¡
, 
__¤c
, 
__Ën
, 
__ps
, 
	`__bos
 (__dst));

513 ià(
__Ën
 > 
	`__bos
 (
__d¡
))

514  
	`__wc¤tombs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__Ën
, 
__ps
, 
	`__bos
 (__dst));

516  
	`__wc¤tombs_®Ÿs
 (
__d¡
, 
__¤c
, 
__Ën
, 
__ps
);

517 
	}
}

520 #ifdeà
__USE_GNU


521 
size_t
 
	$__mb¢¹owcs_chk
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

522 
__cÚ¡
 **
__»¡riù
 
__¤c
, 
size_t
 
__nmc
,

523 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
,

524 
size_t
 
__d¡Ën
è
__THROW
;

525 
size_t
 
	`__REDIRECT_NTH
 (
__mb¢¹owcs_®Ÿs
,

526 (
wch¬_t
 *
__»¡riù
 
__d¡
,

527 
__cÚ¡
 **
__»¡riù
 
__¤c
, 
size_t
 
__nmc
,

528 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
),

529 
mb¢¹owcs
);

530 
size_t
 
	`__REDIRECT_NTH
 (
__mb¢¹owcs_chk_w¬n
,

531 (
wch¬_t
 *
__»¡riù
 
__d¡
,

532 
__cÚ¡
 **
__»¡riù
 
__¤c
, 
size_t
 
__nmc
,

533 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
,

534 
size_t
 
__d¡Ën
), 
__mb¢¹owcs_chk
)

535 
	`__w¬Ç‰r
 ("mbsnrtowcs called with dst buffer smallerhan†en "

538 
__ex‹º_®ways_šlše
 
size_t


539 
	`__NTH
 (
	$mb¢¹owcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
, 
__cÚ¡
 **__»¡riù 
__¤c
,

540 
size_t
 
__nmc
, size_ˆ
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
))

542 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

544 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

545  
	`__mb¢¹owcs_chk
 (
__d¡
, 
__¤c
, 
__nmc
, 
__Ën
, 
__ps
,

546 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

548 ià(
__Ën
 > 
	`__bos
 (
__d¡
è/  (
wch¬_t
))

549  
	`__mb¢¹owcs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__nmc
, 
__Ën
, 
__ps
,

550 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

552  
	`__mb¢¹owcs_®Ÿs
 (
__d¡
, 
__¤c
, 
__nmc
, 
__Ën
, 
__ps
);

553 
	}
}

556 
size_t
 
	$__wc¢¹ombs_chk
 (*
__»¡riù
 
__d¡
,

557 
__cÚ¡
 
wch¬_t
 **
__»¡riù
 
__¤c
,

558 
size_t
 
__nwc
, size_ˆ
__Ën
,

559 
mb¡©e_t
 *
__»¡riù
 
__ps
, 
size_t
 
__d¡Ën
)

560 
__THROW
;

561 
size_t
 
	`__REDIRECT_NTH
 (
__wc¢¹ombs_®Ÿs
,

562 (*
__»¡riù
 
__d¡
,

563 
__cÚ¡
 
wch¬_t
 **
__»¡riù
 
__¤c
,

564 
size_t
 
__nwc
, size_ˆ
__Ën
,

565 
mb¡©e_t
 *
__»¡riù
 
__ps
), 
wc¢¹ombs
);

566 
size_t
 
	`__REDIRECT_NTH
 (
__wc¢¹ombs_chk_w¬n
,

567 (*
__»¡riù
 
__d¡
,

568 
__cÚ¡
 
wch¬_t
 **
__»¡riù
 
__¤c
,

569 
size_t
 
__nwc
, size_ˆ
__Ën
,

570 
mb¡©e_t
 *
__»¡riù
 
__ps
,

571 
size_t
 
__d¡Ën
), 
__wc¢¹ombs_chk
)

572 
	`__w¬Ç‰r
 ("wcsnrtombs called with dst buffer smallerhan†en");

574 
__ex‹º_®ways_šlše
 
size_t


575 
	`__NTH
 (
	$wc¢¹ombs
 (*
__»¡riù
 
__d¡
, 
__cÚ¡
 
wch¬_t
 **__»¡riù 
__¤c
,

576 
size_t
 
__nwc
, size_ˆ
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
))

578 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

580 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

581  
	`__wc¢¹ombs_chk
 (
__d¡
, 
__¤c
, 
__nwc
, 
__Ën
, 
__ps
,

582 
	`__bos
 (
__d¡
));

584 ià(
__Ën
 > 
	`__bos
 (
__d¡
))

585  
	`__wc¢¹ombs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__nwc
, 
__Ën
, 
__ps
,

586 
	`__bos
 (
__d¡
));

588  
	`__wc¢¹ombs_®Ÿs
 (
__d¡
, 
__¤c
, 
__nwc
, 
__Ën
, 
__ps
);

589 
	}
}

	@/usr/include/pthread.h

20 #iâdeà
_PTHREAD_H


21 
	#_PTHREAD_H
 1

	)

23 
	~<ã©u»s.h
>

24 
	~<’dŸn.h
>

25 
	~<sched.h
>

26 
	~<time.h
>

28 
	#__Ãed_sig£t_t


	)

29 
	~<sigÇl.h
>

30 
	~<b™s/±h»adty³s.h
>

31 
	~<b™s/£tjmp.h
>

32 
	~<b™s/wÜdsize.h
>

38 
	mPTHREAD_CREATE_JOINABLE
,

39 
	#PTHREAD_CREATE_JOINABLE
 
PTHREAD_CREATE_JOINABLE


	)

40 
	mPTHREAD_CREATE_DETACHED


41 
	#PTHREAD_CREATE_DETACHED
 
PTHREAD_CREATE_DETACHED


	)

48 
	mPTHREAD_MUTEX_TIMED_NP
,

49 
	mPTHREAD_MUTEX_RECURSIVE_NP
,

50 
	mPTHREAD_MUTEX_ERRORCHECK_NP
,

51 
	mPTHREAD_MUTEX_ADAPTIVE_NP


52 #ifdeà
__USE_UNIX98


54 
	mPTHREAD_MUTEX_NORMAL
 = 
PTHREAD_MUTEX_TIMED_NP
,

55 
	mPTHREAD_MUTEX_RECURSIVE
 = 
PTHREAD_MUTEX_RECURSIVE_NP
,

56 
	mPTHREAD_MUTEX_ERRORCHECK
 = 
PTHREAD_MUTEX_ERRORCHECK_NP
,

57 
	mPTHREAD_MUTEX_DEFAULT
 = 
PTHREAD_MUTEX_NORMAL


59 #ifdeà
__USE_GNU


61 , 
	mPTHREAD_MUTEX_FAST_NP
 = 
PTHREAD_MUTEX_TIMED_NP


66 #ifdeà
__USE_XOPEN2K


70 
	mPTHREAD_MUTEX_STALLED
,

71 
	mPTHREAD_MUTEX_STALLED_NP
 = 
PTHREAD_MUTEX_STALLED
,

72 
	mPTHREAD_MUTEX_ROBUST
,

73 
	mPTHREAD_MUTEX_ROBUST_NP
 = 
PTHREAD_MUTEX_ROBUST


78 #ifdeà
__USE_UNIX98


82 
	mPTHREAD_PRIO_NONE
,

83 
	mPTHREAD_PRIO_INHERIT
,

84 
	mPTHREAD_PRIO_PROTECT


90 #ià
__WORDSIZE
 == 64

91 
	#PTHREAD_MUTEX_INITIALIZER
 \

92 { { 0, 0, 0, 0, 0, 0, { 0, 0 } } }

	)

93 #ifdeà
__USE_GNU


94 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

95 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 0, { 0, 0 } } }

	)

96 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

97 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 0, { 0, 0 } } }

	)

98 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

99 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 0, { 0, 0 } } }

	)

102 
	#PTHREAD_MUTEX_INITIALIZER
 \

103 { { 0, 0, 0, 0, 0, { 0 } } }

	)

104 #ifdeà
__USE_GNU


105 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

106 { { 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 0, { 0 } } }

	)

107 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

108 { { 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 0, { 0 } } }

	)

109 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

110 { { 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 0, { 0 } } }

	)

116 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


119 
	mPTHREAD_RWLOCK_PREFER_READER_NP
,

120 
	mPTHREAD_RWLOCK_PREFER_WRITER_NP
,

121 
	mPTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,

122 
	mPTHREAD_RWLOCK_DEFAULT_NP
 = 
PTHREAD_RWLOCK_PREFER_READER_NP


126 
	#PTHREAD_RWLOCK_INITIALIZER
 \

127 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } }

	)

128 #ifdeà
__USE_GNU


129 #ià
__WORDSIZE
 == 64

130 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

132 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
 } }

	)

134 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


135 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

136 { { 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
, \

137 0, 0, 0, 0 } }

	)

139 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

140 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,\

141 0 } }

	)

151 
	mPTHREAD_INHERIT_SCHED
,

152 
	#PTHREAD_INHERIT_SCHED
 
PTHREAD_INHERIT_SCHED


	)

153 
	mPTHREAD_EXPLICIT_SCHED


154 
	#PTHREAD_EXPLICIT_SCHED
 
PTHREAD_EXPLICIT_SCHED


	)

161 
	mPTHREAD_SCOPE_SYSTEM
,

162 
	#PTHREAD_SCOPE_SYSTEM
 
PTHREAD_SCOPE_SYSTEM


	)

163 
	mPTHREAD_SCOPE_PROCESS


164 
	#PTHREAD_SCOPE_PROCESS
 
PTHREAD_SCOPE_PROCESS


	)

171 
	mPTHREAD_PROCESS_PRIVATE
,

172 
	#PTHREAD_PROCESS_PRIVATE
 
PTHREAD_PROCESS_PRIVATE


	)

173 
	mPTHREAD_PROCESS_SHARED


174 
	#PTHREAD_PROCESS_SHARED
 
PTHREAD_PROCESS_SHARED


	)

180 
	#PTHREAD_COND_INITIALIZER
 { { 0, 0, 0, 0, 0, (*è0, 0, 0 } }

	)

184 
	s_±h»ad_ş—nup_bufãr


186 (*
	m__routše
) (*);

187 *
	m__¬g
;

188 
	m__ÿnûÉy³
;

189 
_±h»ad_ş—nup_bufãr
 *
	m__´ev
;

195 
	mPTHREAD_CANCEL_ENABLE
,

196 
	#PTHREAD_CANCEL_ENABLE
 
PTHREAD_CANCEL_ENABLE


	)

197 
	mPTHREAD_CANCEL_DISABLE


198 
	#PTHREAD_CANCEL_DISABLE
 
PTHREAD_CANCEL_DISABLE


	)

202 
	mPTHREAD_CANCEL_DEFERRED
,

203 
	#PTHREAD_CANCEL_DEFERRED
 
PTHREAD_CANCEL_DEFERRED


	)

204 
	mPTHREAD_CANCEL_ASYNCHRONOUS


205 
	#PTHREAD_CANCEL_ASYNCHRONOUS
 
PTHREAD_CANCEL_ASYNCHRONOUS


	)

207 
	#PTHREAD_CANCELED
 ((*è-1)

	)

211 
	#PTHREAD_ONCE_INIT
 0

	)

214 #ifdeà
__USE_XOPEN2K


218 
	#PTHREAD_BARRIER_SERIAL_THREAD
 -1

	)

222 
__BEGIN_DECLS


227 
±h»ad_ü—‹
 (
±h»ad_t
 *
__»¡riù
 
__Ãwth»ad
,

228 
__cÚ¡
 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

229 *(*
__¡¬t_routše
) (*),

230 *
__»¡riù
 
__¬g
è
__THROW
 
__nÚnuÎ
 ((1, 3));

236 
	$±h»ad_ex™
 (*
__»tv®
è
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

244 
	`±h»ad_još
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
);

246 #ifdeà
__USE_GNU


249 
	$±h»ad_Œyjoš_Å
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
è
__THROW
;

257 
	`±h»ad_timedjoš_Å
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
,

258 
__cÚ¡
 
time¥ec
 *
__ab¡ime
);

265 
	$±h»ad_d‘ach
 (
±h»ad_t
 
__th
è
__THROW
;

269 
±h»ad_t
 
	$±h»ad_£lf
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

272 
	$±h»ad_equ®
 (
±h»ad_t
 
__th»ad1
,…th»ad_ˆ
__th»ad2
è
__THROW
;

280 
	$±h»ad_©Œ_š™
 (
±h»ad_©Œ_t
 *
__©Œ
è
__THROW
 
	`__nÚnuÎ
 ((1));

283 
	$±h»ad_©Œ_de¡roy
 (
±h»ad_©Œ_t
 *
__©Œ
)

284 
__THROW
 
	`__nÚnuÎ
 ((1));

287 
	$±h»ad_©Œ_g‘d‘ach¡©e
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__©Œ
,

288 *
__d‘ach¡©e
)

289 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

292 
	$±h»ad_©Œ_£td‘ach¡©e
 (
±h»ad_©Œ_t
 *
__©Œ
,

293 
__d‘ach¡©e
)

294 
__THROW
 
	`__nÚnuÎ
 ((1));

298 
	$±h»ad_©Œ_g‘gu¬dsize
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__©Œ
,

299 
size_t
 *
__gu¬dsize
)

300 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

303 
	$±h»ad_©Œ_£tgu¬dsize
 (
±h»ad_©Œ_t
 *
__©Œ
,

304 
size_t
 
__gu¬dsize
)

305 
__THROW
 
	`__nÚnuÎ
 ((1));

309 
	$±h»ad_©Œ_g‘sched·¿m
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__»¡riù


310 
__©Œ
,

311 
sched_·¿m
 *
__»¡riù
 
__·¿m
)

312 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

315 
	$±h»ad_©Œ_£tsched·¿m
 (
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

316 
__cÚ¡
 
sched_·¿m
 *
__»¡riù


317 
__·¿m
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

320 
	$±h»ad_©Œ_g‘schedpŞicy
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__»¡riù


321 
__©Œ
, *
__»¡riù
 
__pŞicy
)

322 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

325 
	$±h»ad_©Œ_£tschedpŞicy
 (
±h»ad_©Œ_t
 *
__©Œ
, 
__pŞicy
)

326 
__THROW
 
	`__nÚnuÎ
 ((1));

329 
	$±h»ad_©Œ_g‘šh”™sched
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__»¡riù


330 
__©Œ
, *
__»¡riù
 
__šh”™
)

331 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

334 
	$±h»ad_©Œ_£tšh”™sched
 (
±h»ad_©Œ_t
 *
__©Œ
,

335 
__šh”™
)

336 
__THROW
 
	`__nÚnuÎ
 ((1));

340 
	$±h»ad_©Œ_g‘scİe
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

341 *
__»¡riù
 
__scİe
)

342 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

345 
	$±h»ad_©Œ_£tscİe
 (
±h»ad_©Œ_t
 *
__©Œ
, 
__scİe
)

346 
__THROW
 
	`__nÚnuÎ
 ((1));

349 
	$±h»ad_©Œ_g‘¡ackaddr
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__»¡riù


350 
__©Œ
, **
__»¡riù
 
__¡ackaddr
)

351 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__©Œibu‹_d•»ÿ‹d__
;

357 
	$±h»ad_©Œ_£t¡ackaddr
 (
±h»ad_©Œ_t
 *
__©Œ
,

358 *
__¡ackaddr
)

359 
__THROW
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
;

362 
	$±h»ad_©Œ_g‘¡acksize
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__»¡riù


363 
__©Œ
, 
size_t
 *
__»¡riù
 
__¡acksize
)

364 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

369 
	$±h»ad_©Œ_£t¡acksize
 (
±h»ad_©Œ_t
 *
__©Œ
,

370 
size_t
 
__¡acksize
)

371 
__THROW
 
	`__nÚnuÎ
 ((1));

373 #ifdeà
__USE_XOPEN2K


375 
	$±h»ad_©Œ_g‘¡ack
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

376 **
__»¡riù
 
__¡ackaddr
,

377 
size_t
 *
__»¡riù
 
__¡acksize
)

378 
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

383 
	$±h»ad_©Œ_£t¡ack
 (
±h»ad_©Œ_t
 *
__©Œ
, *
__¡ackaddr
,

384 
size_t
 
__¡acksize
è
__THROW
 
	`__nÚnuÎ
 ((1));

387 #ifdeà
__USE_GNU


390 
	$±h»ad_©Œ_£ffš™y_Å
 (
±h»ad_©Œ_t
 *
__©Œ
,

391 
size_t
 
__ıu£tsize
,

392 
__cÚ¡
 
ıu_£t_t
 *
__ıu£t
)

393 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

397 
	$±h»ad_©Œ_g‘affš™y_Å
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__©Œ
,

398 
size_t
 
__ıu£tsize
,

399 
ıu_£t_t
 *
__ıu£t
)

400 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

406 
	$±h»ad_g‘©Œ_Å
 (
±h»ad_t
 
__th
, 
±h»ad_©Œ_t
 *
__©Œ
)

407 
__THROW
 
	`__nÚnuÎ
 ((2));

415 
	$±h»ad_£tsched·¿m
 (
±h»ad_t
 
__rg‘_th»ad
, 
__pŞicy
,

416 
__cÚ¡
 
sched_·¿m
 *
__·¿m
)

417 
__THROW
 
	`__nÚnuÎ
 ((3));

420 
	$±h»ad_g‘sched·¿m
 (
±h»ad_t
 
__rg‘_th»ad
,

421 *
__»¡riù
 
__pŞicy
,

422 
sched_·¿m
 *
__»¡riù
 
__·¿m
)

423 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

426 
	$±h»ad_£tsched´io
 (
±h»ad_t
 
__rg‘_th»ad
, 
__´io
)

427 
__THROW
;

430 #ifdeà
__USE_UNIX98


432 
	$±h»ad_g‘cÚcu¼’cy
 (è
__THROW
;

435 
	$±h»ad_£tcÚcu¼’cy
 (
__Ëv–
è
__THROW
;

438 #ifdeà
__USE_GNU


443 
	$±h»ad_y›ld
 (è
__THROW
;

448 
	$±h»ad_£ffš™y_Å
 (
±h»ad_t
 
__th
, 
size_t
 
__ıu£tsize
,

449 
__cÚ¡
 
ıu_£t_t
 *
__ıu£t
)

450 
__THROW
 
	`__nÚnuÎ
 ((3));

453 
	$±h»ad_g‘affš™y_Å
 (
±h»ad_t
 
__th
, 
size_t
 
__ıu£tsize
,

454 
ıu_£t_t
 *
__ıu£t
)

455 
__THROW
 
	`__nÚnuÎ
 ((3));

468 
	`±h»ad_Úû
 (
±h»ad_Úû_t
 *
__Úû_cÚŒŞ
,

469 (*
__š™_routše
è()è
	`__nÚnuÎ
 ((1, 2));

480 
	`±h»ad_£tÿnûl¡©e
 (
__¡©e
, *
__Şd¡©e
);

484 
	`±h»ad_£tÿnûÉy³
 (
__ty³
, *
__Şdty³
);

487 
	`±h»ad_ÿnûl
 (
±h»ad_t
 
__th
);

492 
	`±h»ad_‹¡ÿnûl
 ();

501 
__jmp_buf
 
__ÿnûl_jmp_buf
;

502 
__mask_was_§ved
;

503 } 
__ÿnûl_jmp_buf
[1];

504 *
__·d
[4];

505 } 
	t__±h»ad_unwšd_buf_t
 
	t__©Œibu‹__
 ((
	t__®igÃd__
));

508 #iâdeà
__ş—nup_fù_©Œibu‹


509 
	#__ş—nup_fù_©Œibu‹


	)

514 
	s__±h»ad_ş—nup_äame


516 (*
__ÿnûl_routše
) (*);

517 *
__ÿnûl_¬g
;

518 
__do_™
;

519 
__ÿnûl_ty³
;

522 #ià
defšed
 
__GNUC__
 && defšed 
__EXCEPTIONS


523 #ifdeà
__ılu¥lus


525 şas 
	c__±h»ad_ş—nup_şass


527 (*
__ÿnûl_routše
) (*);

528 *
__ÿnûl_¬g
;

529 
__do_™
;

530 
__ÿnûl_ty³
;

532 
public
:

533 
	`__±h»ad_ş—nup_şass
 ((*
__fù
è(*), *
__¬g
)

534 : 
	`__ÿnûl_routše
 (
__fù
), 
	`__ÿnûl_¬g
 (
__¬g
), 
	$__do_™
 (1) { }

535 ~
	$__±h»ad_ş—nup_şass
 (è{ ià(
__do_™
è
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); 
	}
}

536 
	$__£tdo™
 (
__Ãwv®
è{ 
__do_™
 = __Ãwv®; 
	}
}

537 
	$__deãr
 (è{ 
	`±h»ad_£tÿnûÉy³
 (
PTHREAD_CANCEL_DEFERRED
,

538 &
__ÿnûl_ty³
); 
	}
}

539 
	$__»¡Üe
 (ècÚ¡ { 
	`±h»ad_£tÿnûÉy³
 (
__ÿnûl_ty³
, 0); 
	}
}

549 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

551 
__±h»ad_ş—nup_şass
 
	`__şäame
 (
routše
, 
¬g
)

	)

555 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

556 
__şäame
.
	`__£tdo™
 (
execu‹
); \

557 } 0)

	)

559 #ifdeà
__USE_GNU


563 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

565 
__±h»ad_ş—nup_şass
 
	`__şäame
 (
routše
, 
¬g
); \

566 
__şäame
.
	`__deãr
 ()

	)

571 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

572 
__şäame
.
	`__»¡Üe
 (); \

573 
__şäame
.
	`__£tdo™
 (
execu‹
); \

574 } 0)

	)

581 
__ex‹º_šlše
 

582 
	$__±h»ad_ş—nup_routše
 (
__±h»ad_ş—nup_äame
 *
__äame
)

584 ià(
__äame
->
__do_™
)

585 
__äame
->
	`__ÿnûl_routše
 (__äame->
__ÿnûl_¬g
);

586 
	}
}

595 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

597 
__±h»ad_ş—nup_äame
 
__şäame
 \

598 
	`__©Œibu‹__
 ((
	`__ş—nup__
 (
__±h»ad_ş—nup_routše
))) \

599 ğ{ .
__ÿnûl_routše
 = (
routše
), .
__ÿnûl_¬g
 = (
¬g
), \

600 .
__do_™
 = 1 };

	)

604 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

605 
__şäame
.
__do_™
 = (
execu‹
); \

606 } 0)

	)

608 #ifdeà
__USE_GNU


612 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

614 
__±h»ad_ş—nup_äame
 
__şäame
 \

615 
	`__©Œibu‹__
 ((
	`__ş—nup__
 (
__±h»ad_ş—nup_routše
))) \

616 ğ{ .
__ÿnûl_routše
 = (
routše
), .
__ÿnûl_¬g
 = (
¬g
), \

617 .
__do_™
 = 1 }; \

618 (è
	`±h»ad_£tÿnûÉy³
 (
PTHREAD_CANCEL_DEFERRED
, \

619 &
__şäame
.
__ÿnûl_ty³
)

	)

624 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

625 (è
	`±h»ad_£tÿnûÉy³
 (
__şäame
.
__ÿnûl_ty³
, 
NULL
); \

626 
__şäame
.
__do_™
 = (
execu‹
); \

627 } 0)

	)

638 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

640 
__±h»ad_unwšd_buf_t
 
__ÿnûl_buf
; \

641 (*
__ÿnûl_routše
è(*èğ(
routše
); \

642 *
__ÿnûl_¬g
 = (
¬g
); \

643 
nÙ_fœ¡_ÿÎ
 = 
	`__sig£tjmp
 ((
__jmp_buf_g
 *) (*) \

644 
__ÿnûl_buf
.
__ÿnûl_jmp_buf
, 0); \

645 ià(
	`__butš_ex³ù
 (
nÙ_fœ¡_ÿÎ
, 0)) \

647 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

648 
	`__±h»ad_unwšd_Ãxt
 (&
__ÿnûl_buf
); \

652 
	`__±h»ad_»gi¡”_ÿnûl
 (&
__ÿnûl_buf
); \

653 dØ{

	)

654 
__±h»ad_»gi¡”_ÿnûl
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

655 
__ş—nup_fù_©Œibu‹
;

659 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

662 
	`__±h»ad_uÄegi¡”_ÿnûl
 (&
__ÿnûl_buf
); \

663 ià(
execu‹
) \

664 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

665 } 0)

	)

666 
	$__±h»ad_uÄegi¡”_ÿnûl
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

667 
__ş—nup_fù_©Œibu‹
;

669 #ifdeà
__USE_GNU


673 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

675 
__±h»ad_unwšd_buf_t
 
__ÿnûl_buf
; \

676 (*
__ÿnûl_routše
è(*èğ(
routše
); \

677 *
__ÿnûl_¬g
 = (
¬g
); \

678 
nÙ_fœ¡_ÿÎ
 = 
	`__sig£tjmp
 ((
__jmp_buf_g
 *) (*) \

679 
__ÿnûl_buf
.
__ÿnûl_jmp_buf
, 0); \

680 ià(
	`__butš_ex³ù
 (
nÙ_fœ¡_ÿÎ
, 0)) \

682 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

683 
	`__±h»ad_unwšd_Ãxt
 (&
__ÿnûl_buf
); \

687 
	`__±h»ad_»gi¡”_ÿnûl_deãr
 (&
__ÿnûl_buf
); \

688 dØ{

	)

689 
	`__±h»ad_»gi¡”_ÿnûl_deãr
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

690 
__ş—nup_fù_©Œibu‹
;

695 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

698 
	`__±h»ad_uÄegi¡”_ÿnûl_»¡Üe
 (&
__ÿnûl_buf
); \

699 ià(
execu‹
) \

700 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

701 
	}
} 0)

	)

702 
	$__±h»ad_uÄegi¡”_ÿnûl_»¡Üe
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

703 
__ş—nup_fù_©Œibu‹
;

707 
	$__±h»ad_unwšd_Ãxt
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

708 
__ş—nup_fù_©Œibu‹
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
))

709 #iâdeà
SHARED


710 
	`__©Œibu‹__
 ((
__w—k__
))

716 
__jmp_buf_g
;

717 
	$__sig£tjmp
 (
__jmp_buf_g
 *
__’v
, 
__§vemask
è
__THROW
;

723 
	$±h»ad_mu‹x_š™
 (
±h»ad_mu‹x_t
 *
__mu‹x
,

724 
__cÚ¡
 
±h»ad_mu‹x©Œ_t
 *
__mu‹x©Œ
)

725 
__THROW
 
	`__nÚnuÎ
 ((1));

728 
	$±h»ad_mu‹x_de¡roy
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

729 
__THROW
 
	`__nÚnuÎ
 ((1));

732 
	$±h»ad_mu‹x_Œylock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

733 
__THROW
 
	`__nÚnuÎ
 ((1));

736 
	$±h»ad_mu‹x_lock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

737 
__THROW
 
	`__nÚnuÎ
 ((1));

739 #ifdeà
__USE_XOPEN2K


741 
	$±h»ad_mu‹x_timedlock
 (
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

742 
__cÚ¡
 
time¥ec
 *
__»¡riù


743 
__ab¡ime
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

747 
	$±h»ad_mu‹x_uÆock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

748 
__THROW
 
	`__nÚnuÎ
 ((1));

751 #ifdeà
__USE_UNIX98


753 
	$±h»ad_mu‹x_g‘´ioûšg
 (
__cÚ¡
 
±h»ad_mu‹x_t
 *

754 
__»¡riù
 
__mu‹x
,

755 *
__»¡riù
 
__´ioûšg
)

756 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

760 
	$±h»ad_mu‹x_£rioûšg
 (
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

761 
__´ioûšg
,

762 *
__»¡riù
 
__Şd_ûšg
)

763 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

767 #ifdeà
__USE_XOPEN2K8


769 
	$±h»ad_mu‹x_cÚsi¡’t_Å
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

770 
__THROW
 
	`__nÚnuÎ
 ((1));

771 #ifdeà
__USE_GNU


772 
	$±h»ad_mu‹x_cÚsi¡’t_Å
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

773 
__THROW
 
	`__nÚnuÎ
 ((1));

782 
	$±h»ad_mu‹x©Œ_š™
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
)

783 
__THROW
 
	`__nÚnuÎ
 ((1));

786 
	$±h»ad_mu‹x©Œ_de¡roy
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
)

787 
__THROW
 
	`__nÚnuÎ
 ((1));

790 
	$±h»ad_mu‹x©Œ_g‘psh¬ed
 (
__cÚ¡
 
±h»ad_mu‹x©Œ_t
 *

791 
__»¡riù
 
__©Œ
,

792 *
__»¡riù
 
__psh¬ed
)

793 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

796 
	$±h»ad_mu‹x©Œ_£sh¬ed
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

797 
__psh¬ed
)

798 
__THROW
 
	`__nÚnuÎ
 ((1));

800 #ifdeà
__USE_UNIX98


802 
	$±h»ad_mu‹x©Œ_g‘ty³
 (
__cÚ¡
 
±h»ad_mu‹x©Œ_t
 *
__»¡riù


803 
__©Œ
, *
__»¡riù
 
__kšd
)

804 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

809 
	$±h»ad_mu‹x©Œ_£‰y³
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
, 
__kšd
)

810 
__THROW
 
	`__nÚnuÎ
 ((1));

813 
	$±h»ad_mu‹x©Œ_g‘´ÙocŞ
 (
__cÚ¡
 
±h»ad_mu‹x©Œ_t
 *

814 
__»¡riù
 
__©Œ
,

815 *
__»¡riù
 
__´ÙocŞ
)

816 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

820 
	$±h»ad_mu‹x©Œ_£rÙocŞ
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

821 
__´ÙocŞ
)

822 
__THROW
 
	`__nÚnuÎ
 ((1));

825 
	$±h»ad_mu‹x©Œ_g‘´ioûšg
 (
__cÚ¡
 
±h»ad_mu‹x©Œ_t
 *

826 
__»¡riù
 
__©Œ
,

827 *
__»¡riù
 
__´ioûšg
)

828 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

831 
	$±h»ad_mu‹x©Œ_£rioûšg
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

832 
__´ioûšg
)

833 
__THROW
 
	`__nÚnuÎ
 ((1));

836 #ifdeà
__USE_XOPEN2K


838 
	$±h»ad_mu‹x©Œ_g‘robu¡
 (
__cÚ¡
 
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

839 *
__robu¡Ãss
)

840 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

841 #ifdeà
__USE_GNU


842 
	$±h»ad_mu‹x©Œ_g‘robu¡_Å
 (
__cÚ¡
 
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

843 *
__robu¡Ãss
)

844 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

848 
	$±h»ad_mu‹x©Œ_£Œobu¡
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

849 
__robu¡Ãss
)

850 
__THROW
 
	`__nÚnuÎ
 ((1));

851 #ifdeà
__USE_GNU


852 
	$±h»ad_mu‹x©Œ_£Œobu¡_Å
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

853 
__robu¡Ãss
)

854 
__THROW
 
	`__nÚnuÎ
 ((1));

859 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


864 
	$±h»ad_rwlock_š™
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

865 
__cÚ¡
 
±h»ad_rwlock©Œ_t
 *
__»¡riù


866 
__©Œ
è
__THROW
 
	`__nÚnuÎ
 ((1));

869 
	$±h»ad_rwlock_de¡roy
 (
±h»ad_rwlock_t
 *
__rwlock
)

870 
__THROW
 
	`__nÚnuÎ
 ((1));

873 
	$±h»ad_rwlock_rdlock
 (
±h»ad_rwlock_t
 *
__rwlock
)

874 
__THROW
 
	`__nÚnuÎ
 ((1));

877 
	$±h»ad_rwlock_Œyrdlock
 (
±h»ad_rwlock_t
 *
__rwlock
)

878 
__THROW
 
	`__nÚnuÎ
 ((1));

880 #ifdeà
__USE_XOPEN2K


882 
	$±h»ad_rwlock_timedrdlock
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

883 
__cÚ¡
 
time¥ec
 *
__»¡riù


884 
__ab¡ime
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

888 
	$±h»ad_rwlock_w¾ock
 (
±h»ad_rwlock_t
 *
__rwlock
)

889 
__THROW
 
	`__nÚnuÎ
 ((1));

892 
	$±h»ad_rwlock_Œyw¾ock
 (
±h»ad_rwlock_t
 *
__rwlock
)

893 
__THROW
 
	`__nÚnuÎ
 ((1));

895 #ifdeà
__USE_XOPEN2K


897 
	$±h»ad_rwlock_timedw¾ock
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

898 
__cÚ¡
 
time¥ec
 *
__»¡riù


899 
__ab¡ime
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

903 
	$±h»ad_rwlock_uÆock
 (
±h»ad_rwlock_t
 *
__rwlock
)

904 
__THROW
 
	`__nÚnuÎ
 ((1));

910 
	$±h»ad_rwlock©Œ_š™
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
)

911 
__THROW
 
	`__nÚnuÎ
 ((1));

914 
	$±h»ad_rwlock©Œ_de¡roy
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
)

915 
__THROW
 
	`__nÚnuÎ
 ((1));

918 
	$±h»ad_rwlock©Œ_g‘psh¬ed
 (
__cÚ¡
 
±h»ad_rwlock©Œ_t
 *

919 
__»¡riù
 
__©Œ
,

920 *
__»¡riù
 
__psh¬ed
)

921 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

924 
	$±h»ad_rwlock©Œ_£sh¬ed
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
,

925 
__psh¬ed
)

926 
__THROW
 
	`__nÚnuÎ
 ((1));

929 
	$±h»ad_rwlock©Œ_g‘kšd_Å
 (
__cÚ¡
 
±h»ad_rwlock©Œ_t
 *

930 
__»¡riù
 
__©Œ
,

931 *
__»¡riù
 
__´ef
)

932 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

935 
	$±h»ad_rwlock©Œ_£tkšd_Å
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
,

936 
__´ef
è
__THROW
 
	`__nÚnuÎ
 ((1));

944 
	$±h»ad_cÚd_š™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

945 
__cÚ¡
 
±h»ad_cÚd©Œ_t
 *
__»¡riù


946 
__cÚd_©Œ
è
__THROW
 
	`__nÚnuÎ
 ((1));

949 
	$±h»ad_cÚd_de¡roy
 (
±h»ad_cÚd_t
 *
__cÚd
)

950 
__THROW
 
	`__nÚnuÎ
 ((1));

953 
	$±h»ad_cÚd_sigÇl
 (
±h»ad_cÚd_t
 *
__cÚd
)

954 
__THROW
 
	`__nÚnuÎ
 ((1));

957 
	$±h»ad_cÚd_brßdÿ¡
 (
±h»ad_cÚd_t
 *
__cÚd
)

958 
__THROW
 
	`__nÚnuÎ
 ((1));

965 
	$±h»ad_cÚd_wa™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

966 
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
)

967 
	`__nÚnuÎ
 ((1, 2));

976 
	$±h»ad_cÚd_timedwa™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

977 
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

978 
__cÚ¡
 
time¥ec
 *
__»¡riù


979 
__ab¡ime
è
	`__nÚnuÎ
 ((1, 2, 3));

984 
	$±h»ad_cÚd©Œ_š™
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
)

985 
__THROW
 
	`__nÚnuÎ
 ((1));

988 
	$±h»ad_cÚd©Œ_de¡roy
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
)

989 
__THROW
 
	`__nÚnuÎ
 ((1));

992 
	$±h»ad_cÚd©Œ_g‘psh¬ed
 (
__cÚ¡
 
±h»ad_cÚd©Œ_t
 *

993 
__»¡riù
 
__©Œ
,

994 *
__»¡riù
 
__psh¬ed
)

995 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

998 
	$±h»ad_cÚd©Œ_£sh¬ed
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
,

999 
__psh¬ed
è
__THROW
 
	`__nÚnuÎ
 ((1));

1001 #ifdeà
__USE_XOPEN2K


1003 
	$±h»ad_cÚd©Œ_g‘şock
 (
__cÚ¡
 
±h»ad_cÚd©Œ_t
 *

1004 
__»¡riù
 
__©Œ
,

1005 
__şockid_t
 *
__»¡riù
 
__şock_id
)

1006 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1009 
	$±h»ad_cÚd©Œ_£tşock
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
,

1010 
__şockid_t
 
__şock_id
)

1011 
__THROW
 
	`__nÚnuÎ
 ((1));

1015 #ifdeà
__USE_XOPEN2K


1020 
	$±h»ad_¥š_š™
 (
±h»ad_¥šlock_t
 *
__lock
, 
__psh¬ed
)

1021 
__THROW
 
	`__nÚnuÎ
 ((1));

1024 
	$±h»ad_¥š_de¡roy
 (
±h»ad_¥šlock_t
 *
__lock
)

1025 
__THROW
 
	`__nÚnuÎ
 ((1));

1028 
	$±h»ad_¥š_lock
 (
±h»ad_¥šlock_t
 *
__lock
)

1029 
__THROW
 
	`__nÚnuÎ
 ((1));

1032 
	$±h»ad_¥š_Œylock
 (
±h»ad_¥šlock_t
 *
__lock
)

1033 
__THROW
 
	`__nÚnuÎ
 ((1));

1036 
	$±h»ad_¥š_uÆock
 (
±h»ad_¥šlock_t
 *
__lock
)

1037 
__THROW
 
	`__nÚnuÎ
 ((1));

1044 
	$±h»ad_b¬r›r_š™
 (
±h»ad_b¬r›r_t
 *
__»¡riù
 
__b¬r›r
,

1045 
__cÚ¡
 
±h»ad_b¬r›¿‰r_t
 *
__»¡riù


1046 
__©Œ
, 
__couÁ
)

1047 
__THROW
 
	`__nÚnuÎ
 ((1));

1050 
	$±h»ad_b¬r›r_de¡roy
 (
±h»ad_b¬r›r_t
 *
__b¬r›r
)

1051 
__THROW
 
	`__nÚnuÎ
 ((1));

1054 
	$±h»ad_b¬r›r_wa™
 (
±h»ad_b¬r›r_t
 *
__b¬r›r
)

1055 
__THROW
 
	`__nÚnuÎ
 ((1));

1059 
	$±h»ad_b¬r›¿‰r_š™
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
)

1060 
__THROW
 
	`__nÚnuÎ
 ((1));

1063 
	$±h»ad_b¬r›¿‰r_de¡roy
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
)

1064 
__THROW
 
	`__nÚnuÎ
 ((1));

1067 
	$±h»ad_b¬r›¿‰r_g‘psh¬ed
 (
__cÚ¡
 
±h»ad_b¬r›¿‰r_t
 *

1068 
__»¡riù
 
__©Œ
,

1069 *
__»¡riù
 
__psh¬ed
)

1070 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1073 
	$±h»ad_b¬r›¿‰r_£sh¬ed
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
,

1074 
__psh¬ed
)

1075 
__THROW
 
	`__nÚnuÎ
 ((1));

1087 
	`±h»ad_key_ü—‹
 (
±h»ad_key_t
 *
__key
,

1088 (*
__de¡r_funùiÚ
) (*))

1089 
__THROW
 
	`__nÚnuÎ
 ((1));

1092 
	$±h»ad_key_d–‘e
 (
±h»ad_key_t
 
__key
è
__THROW
;

1095 *
	$±h»ad_g‘¥ecific
 (
±h»ad_key_t
 
__key
è
__THROW
;

1098 
	$±h»ad_£t¥ecific
 (
±h»ad_key_t
 
__key
,

1099 
__cÚ¡
 *
__poš‹r
è
__THROW
 ;

1102 #ifdeà
__USE_XOPEN2K


1104 
	$±h»ad_g‘ıuşockid
 (
±h»ad_t
 
__th»ad_id
,

1105 
__şockid_t
 *
__şock_id
)

1106 
__THROW
 
	`__nÚnuÎ
 ((2));

1121 
	`±h»ad_©fÜk
 ((*
__´•¬e
) (),

1122 (*
__·»Á
) (),

1123 (*
__chd
è()è
__THROW
;

1126 #ifdeà
__USE_EXTERN_INLINES


1128 
__ex‹º_šlše
 

1129 
	`__NTH
 (
	$±h»ad_equ®
 (
±h»ad_t
 
__th»ad1
,…th»ad_ˆ
__th»ad2
))

1131  
__th»ad1
 =ğ
__th»ad2
;

1132 
	}
}

1135 
	g__END_DECLS


	@/usr/include/wctype.h

24 #iâdeà
_WCTYPE_H


26 
	~<ã©u»s.h
>

27 
	~<b™s/ty³s.h
>

29 #iâdeà
__Ãed_iswxxx


30 
	#_WCTYPE_H
 1

	)

33 
	#__Ãed_wšt_t


	)

34 
	~<¡ddef.h
>

38 #iâdeà
WEOF


39 
	#WEOF
 (0xffffffffu)

	)

42 #undeà
__Ãed_iswxxx


47 #iâdeà
__iswxxx_defšed


48 
	#__iswxxx_defšed
 1

	)

50 
__BEGIN_NAMESPACE_C99


53 
	twùy³_t
;

54 
	g__END_NAMESPACE_C99


56 #iâdeà
_ISwb™


61 
	~<’dŸn.h
>

62 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


63 
	#_ISwb™
(
b™
è(1 << (b™))

	)

65 
	#_ISwb™
(
b™
) \

66 ((
b™
) < 8 ? () ((1UL << (bit)) << 24) \

67 : ((
b™
) < 16 ? () ((1UL << (bit)) << 8) \

68 : ((
b™
) < 24 ? () ((1UL << (bit)) >> 8) \

69 : (è((1UL << (
b™
)è>> 24))))

	)

74 
	m__ISwuµ”
 = 0,

75 
	m__ISwlow”
 = 1,

76 
	m__ISw®pha
 = 2,

77 
	m__ISwdig™
 = 3,

78 
	m__ISwxdig™
 = 4,

79 
	m__ISw¥aû
 = 5,

80 
	m__ISw´št
 = 6,

81 
	m__ISwg¿ph
 = 7,

82 
	m__ISwbÏnk
 = 8,

83 
	m__ISwúŒl
 = 9,

84 
	m__ISwpunù
 = 10,

85 
	m__ISw®num
 = 11,

87 
	m_ISwuµ”
 = 
_ISwb™
 (
__ISwuµ”
),

88 
	m_ISwlow”
 = 
_ISwb™
 (
__ISwlow”
),

89 
	m_ISw®pha
 = 
_ISwb™
 (
__ISw®pha
),

90 
	m_ISwdig™
 = 
_ISwb™
 (
__ISwdig™
),

91 
	m_ISwxdig™
 = 
_ISwb™
 (
__ISwxdig™
),

92 
	m_ISw¥aû
 = 
_ISwb™
 (
__ISw¥aû
),

93 
	m_ISw´št
 = 
_ISwb™
 (
__ISw´št
),

94 
	m_ISwg¿ph
 = 
_ISwb™
 (
__ISwg¿ph
),

95 
	m_ISwbÏnk
 = 
_ISwb™
 (
__ISwbÏnk
),

96 
	m_ISwúŒl
 = 
_ISwb™
 (
__ISwúŒl
),

97 
	m_ISwpunù
 = 
_ISwb™
 (
__ISwpunù
),

98 
	m_ISw®num
 = 
_ISwb™
 (
__ISw®num
)

103 
__BEGIN_DECLS


105 
__BEGIN_NAMESPACE_C99


112 
	$isw®num
 (
wšt_t
 
__wc
è
__THROW
;

118 
	$isw®pha
 (
wšt_t
 
__wc
è
__THROW
;

121 
	$iswúŒl
 (
wšt_t
 
__wc
è
__THROW
;

125 
	$iswdig™
 (
wšt_t
 
__wc
è
__THROW
;

129 
	$iswg¿ph
 (
wšt_t
 
__wc
è
__THROW
;

134 
	$iswlow”
 (
wšt_t
 
__wc
è
__THROW
;

137 
	$isw´št
 (
wšt_t
 
__wc
è
__THROW
;

142 
	$iswpunù
 (
wšt_t
 
__wc
è
__THROW
;

147 
	$isw¥aû
 (
wšt_t
 
__wc
è
__THROW
;

152 
	$iswuµ”
 (
wšt_t
 
__wc
è
__THROW
;

157 
	$iswxdig™
 (
wšt_t
 
__wc
è
__THROW
;

162 #ifdeà
__USE_ISOC99


163 
	$iswbÏnk
 (
wšt_t
 
__wc
è
__THROW
;

172 
wùy³_t
 
	$wùy³
 (
__cÚ¡
 *
__´İ”ty
è
__THROW
;

176 
	$iswùy³
 (
wšt_t
 
__wc
, 
wùy³_t
 
__desc
è
__THROW
;

177 
__END_NAMESPACE_C99


184 
__BEGIN_NAMESPACE_C99


187 
__cÚ¡
 
	t__št32_t
 *
	twù¿ns_t
;

188 
__END_NAMESPACE_C99


189 #ifdeà
__USE_GNU


190 
	$__USING_NAMESPACE_C99
(
wù¿ns_t
)

193 
__BEGIN_NAMESPACE_C99


195 
wšt_t
 
	$towlow”
 (
wšt_t
 
__wc
è
__THROW
;

198 
wšt_t
 
	$towuµ”
 (
wšt_t
 
__wc
è
__THROW
;

199 
__END_NAMESPACE_C99


201 
__END_DECLS


208 #ifdeà
_WCTYPE_H


214 
__BEGIN_DECLS


216 
__BEGIN_NAMESPACE_C99


219 
wù¿ns_t
 
	$wù¿ns
 (
__cÚ¡
 *
__´İ”ty
è
__THROW
;

222 
wšt_t
 
	$towù¿ns
 (
wšt_t
 
__wc
, 
wù¿ns_t
 
__desc
è
__THROW
;

223 
__END_NAMESPACE_C99


225 #ifdeà
__USE_XOPEN2K8


227 
	~<xloÿË.h
>

231 
	$isw®num_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

237 
	$isw®pha_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

240 
	$iswúŒl_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

244 
	$iswdig™_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

248 
	$iswg¿ph_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

253 
	$iswlow”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

256 
	$isw´št_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

261 
	$iswpunù_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

266 
	$isw¥aû_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

271 
	$iswuµ”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

276 
	$iswxdig™_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

281 
	$iswbÏnk_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

285 
wùy³_t
 
	$wùy³_l
 (
__cÚ¡
 *
__´İ”ty
, 
__loÿË_t
 
__loÿË
)

286 
__THROW
;

290 
	$iswùy³_l
 (
wšt_t
 
__wc
, 
wùy³_t
 
__desc
, 
__loÿË_t
 
__loÿË
)

291 
__THROW
;

299 
wšt_t
 
	$towlow”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

302 
wšt_t
 
	$towuµ”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

306 
wù¿ns_t
 
	$wù¿ns_l
 (
__cÚ¡
 *
__´İ”ty
, 
__loÿË_t
 
__loÿË
)

307 
__THROW
;

310 
wšt_t
 
	$towù¿ns_l
 (
wšt_t
 
__wc
, 
wù¿ns_t
 
__desc
,

311 
__loÿË_t
 
__loÿË
è
__THROW
;

315 
__END_DECLS


	@/usr/include/bits/setjmp.h

20 #iâdeà
_BITS_SETJMP_H


21 
	#_BITS_SETJMP_H
 1

	)

23 #ià!
defšed
 
_SETJMP_H
 && !defšed 
_PTHREAD_H


27 
	~<b™s/wÜdsize.h
>

29 #iâdeà
_ASM


31 #ià
__WORDSIZE
 == 64

32 
	t__jmp_buf
[8];

34 
	t__jmp_buf
[6];

	@/usr/include/sched.h

20 #iâdef 
_SCHED_H


21 
	#_SCHED_H
 1

	)

23 
	~<ã©u»s.h
>

26 
	~<b™s/ty³s.h
>

28 
	#__Ãed_size_t


	)

29 
	~<¡ddef.h
>

31 
	#__Ãed_time¥ec


	)

32 
	~<time.h
>

35 
	~<b™s/sched.h
>

37 
	#sched_´iÜ™y
 
__sched_´iÜ™y


	)

40 
__BEGIN_DECLS


43 
	$sched_£¬am
 (
__pid_t
 
__pid
, 
__cÚ¡
 
sched_·¿m
 *
__·¿m
)

44 
__THROW
;

47 
	$sched_g‘·¿m
 (
__pid_t
 
__pid
, 
sched_·¿m
 *
__·¿m
è
__THROW
;

50 
	$sched_£tscheduËr
 (
__pid_t
 
__pid
, 
__pŞicy
,

51 
__cÚ¡
 
sched_·¿m
 *
__·¿m
è
__THROW
;

54 
	$sched_g‘scheduËr
 (
__pid_t
 
__pid
è
__THROW
;

57 
	$sched_y›ld
 (è
__THROW
;

60 
	$sched_g‘_´iÜ™y_max
 (
__®gÜ™hm
è
__THROW
;

63 
	$sched_g‘_´iÜ™y_mš
 (
__®gÜ™hm
è
__THROW
;

66 
	$sched_¼_g‘_š‹rv®
 (
__pid_t
 
__pid
, 
time¥ec
 *
__t
è
__THROW
;

69 #ifdeà
__USE_GNU


71 
	#CPU_SETSIZE
 
__CPU_SETSIZE


	)

72 
	#CPU_SET
(
ıu
, 
ıu£
è
	`__CPU_SET_S
 (ıu,  (
ıu_£t_t
), cpu£)

	)

73 
	#CPU_CLR
(
ıu
, 
ıu£
è
	`__CPU_CLR_S
 (ıu,  (
ıu_£t_t
), cpu£)

	)

74 
	#CPU_ISSET
(
ıu
, 
ıu£
è
	`__CPU_ISSET_S
 (ıu,  (
ıu_£t_t
), \

75 
ıu£
)

	)

76 
	#CPU_ZERO
(
ıu£
è
	`__CPU_ZERO_S
 ( (
ıu_£t_t
), cpu£)

	)

77 
	#CPU_COUNT
(
ıu£
è
	`__CPU_COUNT_S
 ( (
ıu_£t_t
), cpu£)

	)

79 
	#CPU_SET_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_SET_S
 (ıu, s‘size, cpu£)

	)

80 
	#CPU_CLR_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_CLR_S
 (ıu, s‘size, cpu£)

	)

81 
	#CPU_ISSET_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_ISSET_S
 (cpu, setsize, \

82 
ıu£
)

	)

83 
	#CPU_ZERO_S
(
£tsize
, 
ıu£
è
	`__CPU_ZERO_S
 (£tsize, cpu£)

	)

84 
	#CPU_COUNT_S
(
£tsize
, 
ıu£
è
	`__CPU_COUNT_S
 (£tsize, cpu£)

	)

86 
	#CPU_EQUAL
(
ıu£1
, 
ıu£2
) \

87 
	`__CPU_EQUAL_S
 ( (
ıu_£t_t
), 
ıu£1
, 
ıu£2
)

	)

88 
	#CPU_EQUAL_S
(
£tsize
, 
ıu£1
, 
ıu£2
) \

89 
	`__CPU_EQUAL_S
 (
£tsize
, 
ıu£1
, 
ıu£2
)

	)

91 
	#CPU_AND
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

92 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, &)

	)

93 
	#CPU_OR
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

94 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, |)

	)

95 
	#CPU_XOR
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

96 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, ^)

	)

97 
	#CPU_AND_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

98 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, &)

	)

99 
	#CPU_OR_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

100 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, |)

	)

101 
	#CPU_XOR_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

102 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, ^)

	)

104 
	#CPU_ALLOC_SIZE
(
couÁ
è
	`__CPU_ALLOC_SIZE
 (couÁ)

	)

105 
	#CPU_ALLOC
(
couÁ
è
	`__CPU_ALLOC
 (couÁ)

	)

106 
	#CPU_FREE
(
ıu£t
è
	`__CPU_FREE
 (ıu£t)

	)

110 
	$sched_£ffš™y
 (
__pid_t
 
__pid
, 
size_t
 
__ıu£tsize
,

111 
__cÚ¡
 
ıu_£t_t
 *
__ıu£t
è
__THROW
;

114 
	$sched_g‘affš™y
 (
__pid_t
 
__pid
, 
size_t
 
__ıu£tsize
,

115 
ıu_£t_t
 *
__ıu£t
è
__THROW
;

118 
__END_DECLS


	@/usr/include/signal.h

23 #iâdef 
_SIGNAL_H


25 #ià!
defšed
 
__Ãed_sig_©omic_t
 && !defšed 
__Ãed_sig£t_t


26 
	#_SIGNAL_H


	)

29 
	~<ã©u»s.h
>

31 
	g__BEGIN_DECLS


33 
	~<b™s/sig£t.h
>

37 #ià
defšed
 
__Ãed_sig_©omic_t
 || defšed 
_SIGNAL_H


38 #iâdeà
__sig_©omic_t_defšed


39 
	#__sig_©omic_t_defšed


	)

40 
__BEGIN_NAMESPACE_STD


41 
__sig_©omic_t
 
	tsig_©omic_t
;

42 
	g__END_NAMESPACE_STD


44 #undeà
__Ãed_sig_©omic_t


47 #ià
defšed
 
__Ãed_sig£t_t
 || (defšed 
_SIGNAL_H
 && defšed 
__USE_POSIX
)

48 #iâdeà
__sig£t_t_defšed


49 
	#__sig£t_t_defšed


	)

50 
__sig£t_t
 
	tsig£t_t
;

52 #undeà
__Ãed_sig£t_t


55 #ifdeà
_SIGNAL_H


57 
	~<b™s/ty³s.h
>

58 
	~<b™s/signum.h
>

60 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


61 #iâdeà
__pid_t_defšed


62 
__pid_t
 
	tpid_t
;

63 
	#__pid_t_defšed


	)

65 #ifdeà
__USE_XOPEN


67 #iâdeà
__uid_t_defšed


68 
__uid_t
 
	tuid_t
;

69 
	#__uid_t_defšed


	)

73 #ifdeà
__USE_POSIX199309


75 
	#__Ãed_time¥ec


	)

76 
	~<time.h
>

79 
	~<b™s/sigšfo.h
>

84 (*
	t__sighªdËr_t
) ();

89 
__sighªdËr_t
 
	$__sysv_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

90 
__THROW
;

91 #ifdeà
__USE_GNU


92 
__sighªdËr_t
 
	$sysv_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

93 
__THROW
;

99 
__BEGIN_NAMESPACE_STD


100 #ifdeà
__USE_BSD


101 
__sighªdËr_t
 
	$sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

102 
__THROW
;

105 #ifdeà
__REDIRECT_NTH


106 
__sighªdËr_t
 
	`__REDIRECT_NTH
 (
sigÇl
,

107 (
__sig
, 
__sighªdËr_t
 
__hªdËr
),

108 
__sysv_sigÇl
);

110 
	#sigÇl
 
__sysv_sigÇl


	)

113 
__END_NAMESPACE_STD


115 #ifdeà
__USE_XOPEN


118 
__sighªdËr_t
 
	$bsd_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

119 
__THROW
;

125 #ifdeà
__USE_POSIX


126 
	$kl
 (
__pid_t
 
__pid
, 
__sig
è
__THROW
;

129 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


133 
	$kÍg
 (
__pid_t
 
__pg½
, 
__sig
è
__THROW
;

136 
__BEGIN_NAMESPACE_STD


138 
	$¿i£
 (
__sig
è
__THROW
;

139 
__END_NAMESPACE_STD


141 #ifdeà
__USE_SVID


143 
__sighªdËr_t
 
	$ssigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

144 
__THROW
;

145 
	$gsigÇl
 (
__sig
è
__THROW
;

148 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN2K


150 
	`psigÇl
 (
__sig
, 
__cÚ¡
 *
__s
);

153 #ifdeà
__USE_XOPEN2K


155 
	`psigšfo
 (
__cÚ¡
 
sigšfo_t
 *
__pšfo
, __cÚ¡ *
__s
);

168 
	`__sig·u£
 (
__sig_Ü_mask
, 
__is_sig
);

170 #ifdeà
__FAVOR_BSD


173 
	$sig·u£
 (
__mask
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

175 #ifdeà
__USE_XOPEN


176 #ifdeà
__GNUC__


177 
	$sig·u£
 (
__sig
è
	`__asm__
 ("__xpg_sigpause");

180 
	#sig·u£
(
sig
è
	`__sig·u£
 ((sig), 1)

	)

186 #ifdeà
__USE_BSD


193 
	#sigmask
(
sig
è
	`__sigmask
(sig)

	)

196 
	$sigblock
 (
__mask
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

199 
	$sig£tmask
 (
__mask
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

202 
	$sigg‘mask
 (è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

206 #ifdeà
__USE_MISC


207 
	#NSIG
 
_NSIG


	)

210 #ifdeà
__USE_GNU


211 
__sighªdËr_t
 
	tsighªdËr_t
;

215 #ifdeà
__USE_BSD


216 
__sighªdËr_t
 
	tsig_t
;

219 #ifdeà
__USE_POSIX


222 
	$sigem±y£t
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

225 
	$sigfl£t
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

228 
	$sigadd£t
 (
sig£t_t
 *
__£t
, 
__signo
è
__THROW
 
	`__nÚnuÎ
 ((1));

231 
	$sigd–£t
 (
sig£t_t
 *
__£t
, 
__signo
è
__THROW
 
	`__nÚnuÎ
 ((1));

234 
	$sigismemb”
 (
__cÚ¡
 
sig£t_t
 *
__£t
, 
__signo
)

235 
__THROW
 
	`__nÚnuÎ
 ((1));

237 #ifdeà
__USE_GNU


239 
	$sigi£m±y£t
 (
__cÚ¡
 
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

242 
	$sigªd£t
 (
sig£t_t
 *
__£t
, 
__cÚ¡
 sig£t_ˆ*
__Ëá
,

243 
__cÚ¡
 
sig£t_t
 *
__right
è
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

246 
	$sigÜ£t
 (
sig£t_t
 *
__£t
, 
__cÚ¡
 sig£t_ˆ*
__Ëá
,

247 
__cÚ¡
 
sig£t_t
 *
__right
è
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

252 
	~<b™s/sigaùiÚ.h
>

255 
	$sig´ocmask
 (
__how
, 
__cÚ¡
 
sig£t_t
 *
__»¡riù
 
__£t
,

256 
sig£t_t
 *
__»¡riù
 
__o£t
è
__THROW
;

263 
	$sigsu¥’d
 (
__cÚ¡
 
sig£t_t
 *
__£t
è
	`__nÚnuÎ
 ((1));

266 
	$sigaùiÚ
 (
__sig
, 
__cÚ¡
 
sigaùiÚ
 *
__»¡riù
 
__aù
,

267 
sigaùiÚ
 *
__»¡riù
 
__ßù
è
__THROW
;

270 
	$sig³ndšg
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

277 
	$sigwa™
 (
__cÚ¡
 
sig£t_t
 *
__»¡riù
 
__£t
, *__»¡riù 
__sig
)

278 
	`__nÚnuÎ
 ((1, 2));

280 #ifdeà
__USE_POSIX199309


285 
	$sigwa™šfo
 (
__cÚ¡
 
sig£t_t
 *
__»¡riù
 
__£t
,

286 
sigšfo_t
 *
__»¡riù
 
__šfo
è
	`__nÚnuÎ
 ((1));

293 
	$sigtimedwa™
 (
__cÚ¡
 
sig£t_t
 *
__»¡riù
 
__£t
,

294 
sigšfo_t
 *
__»¡riù
 
__šfo
,

295 
__cÚ¡
 
time¥ec
 *
__»¡riù
 
__timeout
)

296 
	`__nÚnuÎ
 ((1));

300 
	$sigqueue
 (
__pid_t
 
__pid
, 
__sig
, 
__cÚ¡
 
sigv®
 
__v®
)

301 
__THROW
;

306 #ifdeà
__USE_BSD


310 
__cÚ¡
 *__cÚ¡ 
_sys_sigli¡
[
_NSIG
];

311 
__cÚ¡
 *__cÚ¡ 
sys_sigli¡
[
_NSIG
];

314 
	ssigvec


316 
__sighªdËr_t
 
sv_hªdËr
;

317 
sv_mask
;

319 
sv_æags
;

320 
	#sv_Ú¡ack
 
sv_æags


	)

324 
	#SV_ONSTACK
 (1 << 0)

	)

325 
	#SV_INTERRUPT
 (1 << 1)

	)

326 
	#SV_RESETHAND
 (1 << 2)

	)

334 
	$sigvec
 (
__sig
, 
__cÚ¡
 
sigvec
 *
__vec
,

335 
sigvec
 *
__ovec
è
__THROW
;

339 
	~<b™s/sigcÚ‹xt.h
>

342 
	$sig»tuº
 (
sigcÚ‹xt
 *
__sı
è
__THROW
;

347 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


348 
	#__Ãed_size_t


	)

349 
	~<¡ddef.h
>

354 
	$sigš‹¼u±
 (
__sig
, 
__š‹¼u±
è
__THROW
;

356 
	~<b™s/sig¡ack.h
>

357 #ifdeà
__USE_XOPEN


359 
	~<sys/ucÚ‹xt.h
>

365 
	$sig¡ack
 (
sig¡ack
 *
__ss
, sig¡ack *
__oss
)

366 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

370 
	$sig®t¡ack
 (
__cÚ¡
 
sig®t¡ack
 *
__»¡riù
 
__ss
,

371 
sig®t¡ack
 *
__»¡riù
 
__oss
è
__THROW
;

375 #ifdeà
__USE_XOPEN_EXTENDED


379 
	$sighŞd
 (
__sig
è
__THROW
;

382 
	$sig»l£
 (
__sig
è
__THROW
;

385 
	$sigignÜe
 (
__sig
è
__THROW
;

388 
__sighªdËr_t
 
	$sig£t
 (
__sig
, 
__sighªdËr_t
 
__di¥
è
__THROW
;

391 #ià
defšed
 
__USE_POSIX199506
 || defšed 
__USE_UNIX98


394 
	~<b™s/±h»adty³s.h
>

395 
	~<b™s/sigth»ad.h
>

402 
	$__libc_cu¼’t_sig¹mš
 (è
__THROW
;

404 
	$__libc_cu¼’t_sig¹max
 (è
__THROW
;

408 
__END_DECLS


	@/usr/include/bits/sched.h

22 #iâdeà
__Ãed_sched·¿m


24 #iâdeà
_SCHED_H


30 
	#SCHED_OTHER
 0

	)

31 
	#SCHED_FIFO
 1

	)

32 
	#SCHED_RR
 2

	)

33 #ifdeà
__USE_GNU


34 
	#SCHED_BATCH
 3

	)

37 #ifdeà
__USE_MISC


39 
	#CSIGNAL
 0x000000fà

	)

40 
	#CLONE_VM
 0x00000100

	)

41 
	#CLONE_FS
 0x00000200

	)

42 
	#CLONE_FILES
 0x00000400

	)

43 
	#CLONE_SIGHAND
 0x00000800

	)

44 
	#CLONE_PTRACE
 0x00002000

	)

45 
	#CLONE_VFORK
 0x00004000

	)

47 
	#CLONE_PARENT
 0x00008000

	)

49 
	#CLONE_THREAD
 0x00010000

	)

50 
	#CLONE_NEWNS
 0x00020000

	)

51 
	#CLONE_SYSVSEM
 0x00040000

	)

52 
	#CLONE_SETTLS
 0x00080000

	)

53 
	#CLONE_PARENT_SETTID
 0x00100000

	)

55 
	#CLONE_CHILD_CLEARTID
 0x00200000

	)

57 
	#CLONE_DETACHED
 0x00400000

	)

58 
	#CLONE_UNTRACED
 0x00800000

	)

60 
	#CLONE_CHILD_SETTID
 0x01000000

	)

62 
	#CLONE_NEWUTS
 0x04000000

	)

63 
	#CLONE_NEWIPC
 0x08000000

	)

64 
	#CLONE_NEWUSER
 0x10000000

	)

65 
	#CLONE_NEWPID
 0x20000000

	)

66 
	#CLONE_NEWNET
 0x40000000

	)

67 
	#CLONE_IO
 0x80000000

	)

71 
	ssched_·¿m


73 
	m__sched_´iÜ™y
;

76 
	g__BEGIN_DECLS


78 #ifdeà
__USE_MISC


80 
şÚe
 ((*
__â
è(*
__¬g
), *
__chd_¡ack
,

81 
__æags
, *
__¬g
, ...è
__THROW
;

84 
	$unsh¬e
 (
__æags
è
__THROW
;

87 
	$sched_g‘ıu
 (è
__THROW
;

90 
__END_DECLS


94 #ià!
defšed
 
__defšed_sched·¿m
 \

95 && (
defšed
 
__Ãed_sched·¿m
 || defšed 
_SCHED_H
)

96 
	#__defšed_sched·¿m
 1

	)

98 
	s__sched_·¿m


100 
__sched_´iÜ™y
;

102 #undeà
__Ãed_sched·¿m


106 #ià
defšed
 
_SCHED_H
 && !defšed 
__ıu_£t_t_defšed


107 
	#__ıu_£t_t_defšed


	)

109 
	#__CPU_SETSIZE
 1024

	)

110 
	#__NCPUBITS
 (8 *  (
__ıu_mask
))

	)

113 
	t__ıu_mask
;

116 
	#__CPUELT
(
ıu
è((ıuè/ 
__NCPUBITS
)

	)

117 
	#__CPUMASK
(
ıu
è((
__ıu_mask
è1 << ((ıuè% 
__NCPUBITS
))

	)

122 
__ıu_mask
 
__b™s
[
__CPU_SETSIZE
 / 
__NCPUBITS
];

123 } 
	tıu_£t_t
;

126 #ià
	`__GNUC_PREREQ
 (2, 91)

127 
	#__CPU_ZERO_S
(
£tsize
, 
ıu£
) \

128 dØ
	`__butš_mem£t
 (
ıu£
, '\0', 
£tsize
); 0)

	)

130 
	#__CPU_ZERO_S
(
£tsize
, 
ıu£
) \

132 
size_t
 
__i
; \

133 
size_t
 
__imax
 = (
£tsize
è/  (
__ıu_mask
); \

134 
__ıu_mask
 *
__b™s
 = (
ıu£
)->__bits; \

135 
__i
 = 0; __˜< 
__imax
; ++__i) \

136 
__b™s
[
__i
] = 0; \

137 
	}
} 0)

	)

139 
	#__CPU_SET_S
(
ıu
, 
£tsize
, 
ıu£
) \

140 (
__ex‹nsiÚ__
 \

141 ({ 
size_t
 
__ıu
 = (
ıu
); \

142 
__ıu
 < 8 * (
£tsize
) \

143 ? (((
__ıu_mask
 *è((
ıu£
)->
__b™s
))[
	`__CPUELT
 (
__ıu
)] \

144 |ğ
	`__CPUMASK
 (
__ıu
)) \

145 : 0; }))

	)

146 
	#__CPU_CLR_S
(
ıu
, 
£tsize
, 
ıu£
) \

147 (
__ex‹nsiÚ__
 \

148 ({ 
size_t
 
__ıu
 = (
ıu
); \

149 
__ıu
 < 8 * (
£tsize
) \

150 ? (((
__ıu_mask
 *è((
ıu£
)->
__b™s
))[
	`__CPUELT
 (
__ıu
)] \

151 &ğ~
	`__CPUMASK
 (
__ıu
)) \

152 : 0; }))

	)

153 
	#__CPU_ISSET_S
(
ıu
, 
£tsize
, 
ıu£
) \

154 (
__ex‹nsiÚ__
 \

155 ({ 
size_t
 
__ıu
 = (
ıu
); \

156 
__ıu
 < 8 * (
£tsize
) \

157 ? ((((
__cÚ¡
 
__ıu_mask
 *è((
ıu£
)->
__b™s
))[
	`__CPUELT
 (
__ıu
)] \

158 & 
	`__CPUMASK
 (
__ıu
))) != 0 \

159 : 0; }))

	)

161 
	#__CPU_COUNT_S
(
£tsize
, 
ıu£
) \

162 
	`__sched_ıucouÁ
 (
£tsize
, 
ıu£
)

	)

164 #ià
__GNUC_PREREQ
 (2, 91)

165 
	#__CPU_EQUAL_S
(
£tsize
, 
ıu£1
, 
ıu£2
) \

166 (
	`__butš_memcmp
 (
ıu£1
, 
ıu£2
, 
£tsize
è=ğ0)

	)

168 
	#__CPU_EQUAL_S
(
£tsize
, 
ıu£1
, 
ıu£2
) \

169 (
__ex‹nsiÚ__
 \

170 ({ 
__cÚ¡
 
__ıu_mask
 *
__¬r1
 = (
ıu£1
)->
__b™s
; \

171 
__cÚ¡
 
__ıu_mask
 *
__¬r2
 = (
ıu£2
)->
__b™s
; \

172 
size_t
 
__imax
 = (
£tsize
è/  (
__ıu_mask
); \

173 
size_t
 
__i
; \

174 
__i
 = 0; __˜< 
__imax
; ++__i) \

175 ià(
__b™s
[
__i
] != __bits[__i]) \

177 
__i
 =ğ
__imax
; }))

	)

180 
	#__CPU_OP_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, 
İ
) \

181 (
__ex‹nsiÚ__
 \

182 ({ 
ıu_£t_t
 *
__de¡
 = (
de¡£t
); \

183 
__cÚ¡
 
__ıu_mask
 *
__¬r1
 = (
¤c£t1
)->
__b™s
; \

184 
__cÚ¡
 
__ıu_mask
 *
__¬r2
 = (
¤c£t2
)->
__b™s
; \

185 
size_t
 
__imax
 = (
£tsize
è/  (
__ıu_mask
); \

186 
size_t
 
__i
; \

187 
__i
 = 0; __˜< 
__imax
; ++__i) \

188 ((
__ıu_mask
 *è
__de¡
->
__b™s
)[
__i
] = 
__¬r1
[__i] 
İ
 
__¬r2
[__i]; \

189 
__de¡
; }))

	)

191 
	#__CPU_ALLOC_SIZE
(
couÁ
) \

192 ((((
couÁ
è+ 
__NCPUBITS
 - 1è/ __NCPUBITSè*  (
__ıu_mask
))

	)

193 
	#__CPU_ALLOC
(
couÁ
è
	`__sched_ıu®loc
 (couÁ)

	)

194 
	#__CPU_FREE
(
ıu£t
è
	`__sched_ıuä“
 (ıu£t)

	)

196 
__BEGIN_DECLS


198 
	$__sched_ıucouÁ
 (
size_t
 
__£tsize
, cÚ¡ 
ıu_£t_t
 *
__£
)

199 
__THROW
;

200 
ıu_£t_t
 *
	$__sched_ıu®loc
 (
size_t
 
__couÁ
è
__THROW
 
__wur
;

201 
	$__sched_ıuä“
 (
ıu_£t_t
 *
__£t
è
__THROW
;

203 
__END_DECLS


	@/usr/include/bits/sigaction.h

20 #iâdeà
_SIGNAL_H


25 
	ssigaùiÚ


28 #ifdeà
__USE_POSIX199309


32 
__sighªdËr_t
 
	m§_hªdËr
;

34 (*
	m§_sigaùiÚ
è(, 
	msigšfo_t
 *, *);

36 
	m__sigaùiÚ_hªdËr
;

37 
	#§_hªdËr
 
__sigaùiÚ_hªdËr
.
§_hªdËr


	)

38 
	#§_sigaùiÚ
 
__sigaùiÚ_hªdËr
.
§_sigaùiÚ


	)

40 
__sighªdËr_t
 
	m§_hªdËr
;

44 
__sig£t_t
 
	m§_mask
;

47 
	m§_æags
;

50 (*
	m§_»¡Ü”
) ();

54 
	#SA_NOCLDSTOP
 1

	)

55 
	#SA_NOCLDWAIT
 2

	)

56 
	#SA_SIGINFO
 4

	)

58 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_MISC


59 
	#SA_ONSTACK
 0x08000000

	)

60 
	#SA_RESTART
 0x10000000

	)

61 
	#SA_NODEFER
 0x40000000

	)

63 
	#SA_RESETHAND
 0x80000000

	)

65 #ifdeà
__USE_MISC


66 
	#SA_INTERRUPT
 0x20000000

	)

69 
	#SA_NOMASK
 
SA_NODEFER


	)

70 
	#SA_ONESHOT
 
SA_RESETHAND


	)

71 
	#SA_STACK
 
SA_ONSTACK


	)

75 
	#SIG_BLOCK
 0

	)

76 
	#SIG_UNBLOCK
 1

	)

77 
	#SIG_SETMASK
 2

	)

	@/usr/include/bits/sigcontext.h

19 #iâdeà
_BITS_SIGCONTEXT_H


20 
	#_BITS_SIGCONTEXT_H
 1

	)

22 #ià!
defšed
 
_SIGNAL_H
 && !defšed 
_SYS_UCONTEXT_H


26 
	~<b™s/wÜdsize.h
>

28 
	s_å»g


30 
	msignifiÿnd
[4];

31 
	mexpÚ’t
;

34 
	s_åx»g


36 
	msignifiÿnd
[4];

37 
	mexpÚ’t
;

38 
	m·ddšg
[3];

41 
	s_xmm»g


43 
__ušt32_t
 
	m–em’t
[4];

48 #ià
__WORDSIZE
 == 32

50 
	s_å¡©e


53 
__ušt32_t
 
	mcw
;

54 
__ušt32_t
 
	msw
;

55 
__ušt32_t
 
	mg
;

56 
__ušt32_t
 
	moff
;

57 
__ušt32_t
 
	mcs£l
;

58 
__ušt32_t
 
	md©aoff
;

59 
__ušt32_t
 
	md©a£l
;

60 
_å»g
 
	m_¡
[8];

61 
	m¡©us
;

62 
	mmagic
;

65 
__ušt32_t
 
	m_fx¤_’v
[6];

66 
__ušt32_t
 
	mmxc¤
;

67 
__ušt32_t
 
	m»£rved
;

68 
_åx»g
 
	m_fx¤_¡
[8];

69 
_xmm»g
 
	m_xmm
[8];

70 
__ušt32_t
 
	m·ddšg
[56];

73 #iâdeà
sigcÚ‹xt_¡ruù


78 
	#sigcÚ‹xt_¡ruù
 
sigcÚ‹xt


	)

81 
	ssigcÚ‹xt


83 
	mgs
, 
	m__gsh
;

84 
	mfs
, 
	m__fsh
;

85 
	mes
, 
	m__esh
;

86 
	mds
, 
	m__dsh
;

87 
	medi
;

88 
	mesi
;

89 
	mebp
;

90 
	me¥
;

91 
	mebx
;

92 
	medx
;

93 
	mecx
;

94 
	m—x
;

95 
	mŒ­no
;

96 
	m”r
;

97 
	me
;

98 
	mcs
, 
	m__csh
;

99 
	meæags
;

100 
	me¥_©_sigÇl
;

101 
	mss
, 
	m__ssh
;

102 
_å¡©e
 * 
	må¡©e
;

103 
	mŞdmask
;

104 
	mü2
;

109 
	s_å¡©e


112 
__ušt16_t
 
	mcwd
;

113 
__ušt16_t
 
	mswd
;

114 
__ušt16_t
 
	máw
;

115 
__ušt16_t
 
	mfİ
;

116 
__ušt64_t
 
	mr
;

117 
__ušt64_t
 
	mrdp
;

118 
__ušt32_t
 
	mmxc¤
;

119 
__ušt32_t
 
	mmxü_mask
;

120 
_åx»g
 
	m_¡
[8];

121 
_xmm»g
 
	m_xmm
[16];

122 
__ušt32_t
 
	m·ddšg
[24];

125 
	ssigcÚ‹xt


127 
	mr8
;

128 
	mr9
;

129 
	mr10
;

130 
	mr11
;

131 
	mr12
;

132 
	mr13
;

133 
	mr14
;

134 
	mr15
;

135 
	mrdi
;

136 
	mrsi
;

137 
	mrbp
;

138 
	mrbx
;

139 
	mrdx
;

140 
	m¿x
;

141 
	mrcx
;

142 
	mr¥
;

143 
	mr
;

144 
	meæags
;

145 
	mcs
;

146 
	mgs
;

147 
	mfs
;

148 
	m__·d0
;

149 
	m”r
;

150 
	mŒ­no
;

151 
	mŞdmask
;

152 
	mü2
;

153 
_å¡©e
 * 
	må¡©e
;

154 
	m__»£rved1
 [8];

	@/usr/include/bits/siginfo.h

20 #ià!
defšed
 
_SIGNAL_H
 && !defšed 
__Ãed_sigšfo_t
 \

21 && !
defšed
 
	g__Ãed_sigev’t_t


25 
	~<b™s/wÜdsize.h
>

27 #ià(!
defšed
 
__have_sigv®_t
 \

28 && (
defšed
 
	g_SIGNAL_H
 || defšed 
	g__Ãed_sigšfo_t
 \

29 || 
defšed
 
	g__Ãed_sigev’t_t
))

30 
	#__have_sigv®_t
 1

	)

33 
	usigv®


35 
	msiv®_št
;

36 *
	msiv®_±r
;

37 } 
	tsigv®_t
;

40 #ià(!
defšed
 
__have_sigšfo_t
 \

41 && (
defšed
 
	g_SIGNAL_H
 || defšed 
	g__Ãed_sigšfo_t
))

42 
	#__have_sigšfo_t
 1

	)

44 
	#__SI_MAX_SIZE
 128

	)

45 #ià
__WORDSIZE
 == 64

46 
	#__SI_PAD_SIZE
 ((
__SI_MAX_SIZE
 /  ()è- 4)

	)

48 
	#__SI_PAD_SIZE
 ((
__SI_MAX_SIZE
 /  ()è- 3)

	)

51 
	ssigšfo


53 
	msi_signo
;

54 
	msi_”ºo
;

56 
	msi_code
;

60 
	m_·d
[
__SI_PAD_SIZE
];

65 
__pid_t
 
	msi_pid
;

66 
__uid_t
 
	msi_uid
;

67 } 
	m_kl
;

72 
	msi_tid
;

73 
	msi_ov”run
;

74 
sigv®_t
 
	msi_sigv®
;

75 } 
	m_tim”
;

80 
__pid_t
 
	msi_pid
;

81 
__uid_t
 
	msi_uid
;

82 
sigv®_t
 
	msi_sigv®
;

83 } 
	m_¹
;

88 
__pid_t
 
	msi_pid
;

89 
__uid_t
 
	msi_uid
;

90 
	msi_¡©us
;

91 
__şock_t
 
	msi_utime
;

92 
__şock_t
 
	msi_¡ime
;

93 } 
	m_sigchld
;

98 *
	msi_addr
;

99 } 
	m_sigçuÉ
;

104 
	msi_bªd
;

105 
	msi_fd
;

106 } 
	m_sigpŞl
;

107 } 
	m_sif›lds
;

108 } 
	tsigšfo_t
;

112 
	#si_pid
 
_sif›lds
.
_kl
.
si_pid


	)

113 
	#si_uid
 
_sif›lds
.
_kl
.
si_uid


	)

114 
	#si_tim”id
 
_sif›lds
.
_tim”
.
si_tid


	)

115 
	#si_ov”run
 
_sif›lds
.
_tim”
.
si_ov”run


	)

116 
	#si_¡©us
 
_sif›lds
.
_sigchld
.
si_¡©us


	)

117 
	#si_utime
 
_sif›lds
.
_sigchld
.
si_utime


	)

118 
	#si_¡ime
 
_sif›lds
.
_sigchld
.
si_¡ime


	)

119 
	#si_v®ue
 
_sif›lds
.
_¹
.
si_sigv®


	)

120 
	#si_št
 
_sif›lds
.
_¹
.
si_sigv®
.
siv®_št


	)

121 
	#si_±r
 
_sif›lds
.
_¹
.
si_sigv®
.
siv®_±r


	)

122 
	#si_addr
 
_sif›lds
.
_sigçuÉ
.
si_addr


	)

123 
	#si_bªd
 
_sif›lds
.
_sigpŞl
.
si_bªd


	)

124 
	#si_fd
 
_sif›lds
.
_sigpŞl
.
si_fd


	)

131 
	mSI_ASYNCNL
 = -60,

132 
	#SI_ASYNCNL
 
SI_ASYNCNL


	)

133 
	mSI_TKILL
 = -6,

134 
	#SI_TKILL
 
SI_TKILL


	)

135 
	mSI_SIGIO
,

136 
	#SI_SIGIO
 
SI_SIGIO


	)

137 
	mSI_ASYNCIO
,

138 
	#SI_ASYNCIO
 
SI_ASYNCIO


	)

139 
	mSI_MESGQ
,

140 
	#SI_MESGQ
 
SI_MESGQ


	)

141 
	mSI_TIMER
,

142 
	#SI_TIMER
 
SI_TIMER


	)

143 
	mSI_QUEUE
,

144 
	#SI_QUEUE
 
SI_QUEUE


	)

145 
	mSI_USER
,

146 
	#SI_USER
 
SI_USER


	)

147 
	mSI_KERNEL
 = 0x80

148 
	#SI_KERNEL
 
SI_KERNEL


	)

155 
	mILL_ILLOPC
 = 1,

156 
	#ILL_ILLOPC
 
ILL_ILLOPC


	)

157 
	mILL_ILLOPN
,

158 
	#ILL_ILLOPN
 
ILL_ILLOPN


	)

159 
	mILL_ILLADR
,

160 
	#ILL_ILLADR
 
ILL_ILLADR


	)

161 
	mILL_ILLTRP
,

162 
	#ILL_ILLTRP
 
ILL_ILLTRP


	)

163 
	mILL_PRVOPC
,

164 
	#ILL_PRVOPC
 
ILL_PRVOPC


	)

165 
	mILL_PRVREG
,

166 
	#ILL_PRVREG
 
ILL_PRVREG


	)

167 
	mILL_COPROC
,

168 
	#ILL_COPROC
 
ILL_COPROC


	)

169 
	mILL_BADSTK


170 
	#ILL_BADSTK
 
ILL_BADSTK


	)

176 
	mFPE_INTDIV
 = 1,

177 
	#FPE_INTDIV
 
FPE_INTDIV


	)

178 
	mFPE_INTOVF
,

179 
	#FPE_INTOVF
 
FPE_INTOVF


	)

180 
	mFPE_FLTDIV
,

181 
	#FPE_FLTDIV
 
FPE_FLTDIV


	)

182 
	mFPE_FLTOVF
,

183 
	#FPE_FLTOVF
 
FPE_FLTOVF


	)

184 
	mFPE_FLTUND
,

185 
	#FPE_FLTUND
 
FPE_FLTUND


	)

186 
	mFPE_FLTRES
,

187 
	#FPE_FLTRES
 
FPE_FLTRES


	)

188 
	mFPE_FLTINV
,

189 
	#FPE_FLTINV
 
FPE_FLTINV


	)

190 
	mFPE_FLTSUB


191 
	#FPE_FLTSUB
 
FPE_FLTSUB


	)

197 
	mSEGV_MAPERR
 = 1,

198 
	#SEGV_MAPERR
 
SEGV_MAPERR


	)

199 
	mSEGV_ACCERR


200 
	#SEGV_ACCERR
 
SEGV_ACCERR


	)

206 
	mBUS_ADRALN
 = 1,

207 
	#BUS_ADRALN
 
BUS_ADRALN


	)

208 
	mBUS_ADRERR
,

209 
	#BUS_ADRERR
 
BUS_ADRERR


	)

210 
	mBUS_OBJERR


211 
	#BUS_OBJERR
 
BUS_OBJERR


	)

217 
	mTRAP_BRKPT
 = 1,

218 
	#TRAP_BRKPT
 
TRAP_BRKPT


	)

219 
	mTRAP_TRACE


220 
	#TRAP_TRACE
 
TRAP_TRACE


	)

226 
	mCLD_EXITED
 = 1,

227 
	#CLD_EXITED
 
CLD_EXITED


	)

228 
	mCLD_KILLED
,

229 
	#CLD_KILLED
 
CLD_KILLED


	)

230 
	mCLD_DUMPED
,

231 
	#CLD_DUMPED
 
CLD_DUMPED


	)

232 
	mCLD_TRAPPED
,

233 
	#CLD_TRAPPED
 
CLD_TRAPPED


	)

234 
	mCLD_STOPPED
,

235 
	#CLD_STOPPED
 
CLD_STOPPED


	)

236 
	mCLD_CONTINUED


237 
	#CLD_CONTINUED
 
CLD_CONTINUED


	)

243 
	mPOLL_IN
 = 1,

244 
	#POLL_IN
 
POLL_IN


	)

245 
	mPOLL_OUT
,

246 
	#POLL_OUT
 
POLL_OUT


	)

247 
	mPOLL_MSG
,

248 
	#POLL_MSG
 
POLL_MSG


	)

249 
	mPOLL_ERR
,

250 
	#POLL_ERR
 
POLL_ERR


	)

251 
	mPOLL_PRI
,

252 
	#POLL_PRI
 
POLL_PRI


	)

253 
	mPOLL_HUP


254 
	#POLL_HUP
 
POLL_HUP


	)

257 #undeà
__Ãed_sigšfo_t


261 #ià(
defšed
 
_SIGNAL_H
 || defšed 
__Ãed_sigev’t_t
) \

262 && !
defšed
 
	g__have_sigev’t_t


263 
	#__have_sigev’t_t
 1

	)

266 
	#__SIGEV_MAX_SIZE
 64

	)

267 #ià
__WORDSIZE
 == 64

268 
	#__SIGEV_PAD_SIZE
 ((
__SIGEV_MAX_SIZE
 /  ()è- 4)

	)

270 
	#__SIGEV_PAD_SIZE
 ((
__SIGEV_MAX_SIZE
 /  ()è- 3)

	)

273 
	ssigev’t


275 
sigv®_t
 
	msigev_v®ue
;

276 
	msigev_signo
;

277 
	msigev_nÙify
;

281 
	m_·d
[
__SIGEV_PAD_SIZE
];

285 
__pid_t
 
	m_tid
;

289 (*
	m_funùiÚ
è(
	msigv®_t
);

290 *
	m_©Œibu‹
;

291 } 
	m_sigev_th»ad
;

292 } 
	m_sigev_un
;

293 } 
	tsigev’t_t
;

296 
	#sigev_nÙify_funùiÚ
 
_sigev_un
.
_sigev_th»ad
.
_funùiÚ


	)

297 
	#sigev_nÙify_©Œibu‹s
 
_sigev_un
.
_sigev_th»ad
.
_©Œibu‹


	)

302 
	mSIGEV_SIGNAL
 = 0,

303 
	#SIGEV_SIGNAL
 
SIGEV_SIGNAL


	)

304 
	mSIGEV_NONE
,

305 
	#SIGEV_NONE
 
SIGEV_NONE


	)

306 
	mSIGEV_THREAD
,

307 
	#SIGEV_THREAD
 
SIGEV_THREAD


	)

309 
	mSIGEV_THREAD_ID
 = 4

310 
	#SIGEV_THREAD_ID
 
SIGEV_THREAD_ID


	)

	@/usr/include/bits/signum.h

20 #ifdef 
_SIGNAL_H


23 
	#SIG_ERR
 ((
__sighªdËr_t
è-1è

	)

24 
	#SIG_DFL
 ((
__sighªdËr_t
è0è

	)

25 
	#SIG_IGN
 ((
__sighªdËr_t
è1è

	)

27 #ifdeà
__USE_UNIX98


28 
	#SIG_HOLD
 ((
__sighªdËr_t
è2è

	)

33 
	#SIGHUP
 1

	)

34 
	#SIGINT
 2

	)

35 
	#SIGQUIT
 3

	)

36 
	#SIGILL
 4

	)

37 
	#SIGTRAP
 5

	)

38 
	#SIGABRT
 6

	)

39 
	#SIGIOT
 6

	)

40 
	#SIGBUS
 7

	)

41 
	#SIGFPE
 8

	)

42 
	#SIGKILL
 9

	)

43 
	#SIGUSR1
 10

	)

44 
	#SIGSEGV
 11

	)

45 
	#SIGUSR2
 12

	)

46 
	#SIGPIPE
 13

	)

47 
	#SIGALRM
 14

	)

48 
	#SIGTERM
 15

	)

49 
	#SIGSTKFLT
 16

	)

50 
	#SIGCLD
 
SIGCHLD


	)

51 
	#SIGCHLD
 17

	)

52 
	#SIGCONT
 18

	)

53 
	#SIGSTOP
 19

	)

54 
	#SIGTSTP
 20

	)

55 
	#SIGTTIN
 21

	)

56 
	#SIGTTOU
 22

	)

57 
	#SIGURG
 23

	)

58 
	#SIGXCPU
 24

	)

59 
	#SIGXFSZ
 25

	)

60 
	#SIGVTALRM
 26

	)

61 
	#SIGPROF
 27

	)

62 
	#SIGWINCH
 28

	)

63 
	#SIGPOLL
 
SIGIO


	)

64 
	#SIGIO
 29

	)

65 
	#SIGPWR
 30

	)

66 
	#SIGSYS
 31

	)

67 
	#SIGUNUSED
 31

	)

69 
	#_NSIG
 65

	)

72 
	#SIGRTMIN
 (
	`__libc_cu¼’t_sig¹mš
 ())

	)

73 
	#SIGRTMAX
 (
	`__libc_cu¼’t_sig¹max
 ())

	)

77 
	#__SIGRTMIN
 32

	)

78 
	#__SIGRTMAX
 (
_NSIG
 - 1)

	)

	@/usr/include/bits/sigstack.h

20 #iâdeà
_SIGNAL_H


26 
	ssig¡ack


28 *
	mss_¥
;

29 
	mss_Ú¡ack
;

36 
	mSS_ONSTACK
 = 1,

37 
	#SS_ONSTACK
 
SS_ONSTACK


	)

38 
	mSS_DISABLE


39 
	#SS_DISABLE
 
SS_DISABLE


	)

43 
	#MINSIGSTKSZ
 2048

	)

46 
	#SIGSTKSZ
 8192

	)

50 
	ssig®t¡ack


52 *
	mss_¥
;

53 
	mss_æags
;

54 
size_t
 
	mss_size
;

55 } 
	t¡ack_t
;

	@/usr/include/bits/sigthread.h

20 #iâdeà
_BITS_SIGTHREAD_H


21 
	#_BITS_SIGTHREAD_H
 1

	)

23 #ià!
defšed
 
_SIGNAL_H
 && !defšed 
_PTHREAD_H


31 
	$±h»ad_sigmask
 (
__how
,

32 
__cÚ¡
 
__sig£t_t
 *
__»¡riù
 
__Ãwmask
,

33 
__sig£t_t
 *
__»¡riù
 
__Şdmask
)
__THROW
;

36 
	$±h»ad_kl
 (
±h»ad_t
 
__th»adid
, 
__signo
è
__THROW
;

	@/usr/include/sys/ucontext.h

19 #iâdeà
_SYS_UCONTEXT_H


20 
	#_SYS_UCONTEXT_H
 1

	)

22 
	~<ã©u»s.h
>

23 
	~<sigÇl.h
>

24 
	~<b™s/wÜdsize.h
>

28 
	~<b™s/sigcÚ‹xt.h
>

30 #ià
__WORDSIZE
 == 64

33 
	tg»g_t
;

36 
	#NGREG
 23

	)

39 
g»g_t
 
	tg»g£t_t
[
NGREG
];

41 #ifdeà
__USE_GNU


45 
	mREG_R8
 = 0,

46 
	#REG_R8
 
REG_R8


	)

47 
	mREG_R9
,

48 
	#REG_R9
 
REG_R9


	)

49 
	mREG_R10
,

50 
	#REG_R10
 
REG_R10


	)

51 
	mREG_R11
,

52 
	#REG_R11
 
REG_R11


	)

53 
	mREG_R12
,

54 
	#REG_R12
 
REG_R12


	)

55 
	mREG_R13
,

56 
	#REG_R13
 
REG_R13


	)

57 
	mREG_R14
,

58 
	#REG_R14
 
REG_R14


	)

59 
	mREG_R15
,

60 
	#REG_R15
 
REG_R15


	)

61 
	mREG_RDI
,

62 
	#REG_RDI
 
REG_RDI


	)

63 
	mREG_RSI
,

64 
	#REG_RSI
 
REG_RSI


	)

65 
	mREG_RBP
,

66 
	#REG_RBP
 
REG_RBP


	)

67 
	mREG_RBX
,

68 
	#REG_RBX
 
REG_RBX


	)

69 
	mREG_RDX
,

70 
	#REG_RDX
 
REG_RDX


	)

71 
	mREG_RAX
,

72 
	#REG_RAX
 
REG_RAX


	)

73 
	mREG_RCX
,

74 
	#REG_RCX
 
REG_RCX


	)

75 
	mREG_RSP
,

76 
	#REG_RSP
 
REG_RSP


	)

77 
	mREG_RIP
,

78 
	#REG_RIP
 
REG_RIP


	)

79 
	mREG_EFL
,

80 
	#REG_EFL
 
REG_EFL


	)

81 
	mREG_CSGSFS
,

82 
	#REG_CSGSFS
 
REG_CSGSFS


	)

83 
	mREG_ERR
,

84 
	#REG_ERR
 
REG_ERR


	)

85 
	mREG_TRAPNO
,

86 
	#REG_TRAPNO
 
REG_TRAPNO


	)

87 
	mREG_OLDMASK
,

88 
	#REG_OLDMASK
 
REG_OLDMASK


	)

89 
	mREG_CR2


90 
	#REG_CR2
 
REG_CR2


	)

94 
	s_libc_åx»g


96 
	msignifiÿnd
[4];

97 
	mexpÚ’t
;

98 
	m·ddšg
[3];

101 
	s_libc_xmm»g


103 
__ušt32_t
 
	m–em’t
[4];

106 
	s_libc_å¡©e


109 
__ušt16_t
 
	mcwd
;

110 
__ušt16_t
 
	mswd
;

111 
__ušt16_t
 
	máw
;

112 
__ušt16_t
 
	mfİ
;

113 
__ušt64_t
 
	mr
;

114 
__ušt64_t
 
	mrdp
;

115 
__ušt32_t
 
	mmxc¤
;

116 
__ušt32_t
 
	mmxü_mask
;

117 
_libc_åx»g
 
	m_¡
[8];

118 
_libc_xmm»g
 
	m_xmm
[16];

119 
__ušt32_t
 
	m·ddšg
[24];

123 
_libc_å¡©e
 *
	tå»g£t_t
;

128 
g»g£t_t
 
	mg»gs
;

130 
å»g£t_t
 
	må»gs
;

131 
	m__»£rved1
 [8];

132 } 
	tmcÚ‹xt_t
;

135 
	sucÚ‹xt


137 
	muc_æags
;

138 
ucÚ‹xt
 *
	muc_lšk
;

139 
¡ack_t
 
	muc_¡ack
;

140 
mcÚ‹xt_t
 
	muc_mcÚ‹xt
;

141 
__sig£t_t
 
	muc_sigmask
;

142 
_libc_å¡©e
 
	m__å»gs_mem
;

143 } 
	tucÚ‹xt_t
;

148 
	tg»g_t
;

151 
	#NGREG
 19

	)

154 
g»g_t
 
	tg»g£t_t
[
NGREG
];

156 #ifdeà
__USE_GNU


160 
	mREG_GS
 = 0,

161 
	#REG_GS
 
REG_GS


	)

162 
	mREG_FS
,

163 
	#REG_FS
 
REG_FS


	)

164 
	mREG_ES
,

165 
	#REG_ES
 
REG_ES


	)

166 
	mREG_DS
,

167 
	#REG_DS
 
REG_DS


	)

168 
	mREG_EDI
,

169 
	#REG_EDI
 
REG_EDI


	)

170 
	mREG_ESI
,

171 
	#REG_ESI
 
REG_ESI


	)

172 
	mREG_EBP
,

173 
	#REG_EBP
 
REG_EBP


	)

174 
	mREG_ESP
,

175 
	#REG_ESP
 
REG_ESP


	)

176 
	mREG_EBX
,

177 
	#REG_EBX
 
REG_EBX


	)

178 
	mREG_EDX
,

179 
	#REG_EDX
 
REG_EDX


	)

180 
	mREG_ECX
,

181 
	#REG_ECX
 
REG_ECX


	)

182 
	mREG_EAX
,

183 
	#REG_EAX
 
REG_EAX


	)

184 
	mREG_TRAPNO
,

185 
	#REG_TRAPNO
 
REG_TRAPNO


	)

186 
	mREG_ERR
,

187 
	#REG_ERR
 
REG_ERR


	)

188 
	mREG_EIP
,

189 
	#REG_EIP
 
REG_EIP


	)

190 
	mREG_CS
,

191 
	#REG_CS
 
REG_CS


	)

192 
	mREG_EFL
,

193 
	#REG_EFL
 
REG_EFL


	)

194 
	mREG_UESP
,

195 
	#REG_UESP
 
REG_UESP


	)

196 
	mREG_SS


197 
	#REG_SS
 
REG_SS


	)

202 
	s_libc_å»g


204 
	msignifiÿnd
[4];

205 
	mexpÚ’t
;

208 
	s_libc_å¡©e


210 
	mcw
;

211 
	msw
;

212 
	mg
;

213 
	moff
;

214 
	mcs£l
;

215 
	md©aoff
;

216 
	md©a£l
;

217 
_libc_å»g
 
	m_¡
[8];

218 
	m¡©us
;

222 
_libc_å¡©e
 *
	tå»g£t_t
;

227 
g»g£t_t
 
	mg»gs
;

230 
å»g£t_t
 
	må»gs
;

231 
	mŞdmask
;

232 
	mü2
;

233 } 
	tmcÚ‹xt_t
;

236 
	sucÚ‹xt


238 
	muc_æags
;

239 
ucÚ‹xt
 *
	muc_lšk
;

240 
¡ack_t
 
	muc_¡ack
;

241 
mcÚ‹xt_t
 
	muc_mcÚ‹xt
;

242 
__sig£t_t
 
	muc_sigmask
;

243 
_libc_å¡©e
 
	m__å»gs_mem
;

244 } 
	tucÚ‹xt_t
;

	@
1
.
1
/usr/include
310
6684
AutoTableLayout.cpp
AutoTableLayout.h
BidiRun.cpp
BidiRun.h
CounterNode.cpp
CounterNode.h
EllipsisBox.cpp
EllipsisBox.h
FixedTableLayout.cpp
FixedTableLayout.h
GapRects.h
HitTestRequest.h
HitTestResult.cpp
HitTestResult.h
InlineBox.cpp
InlineBox.h
InlineFlowBox.cpp
InlineFlowBox.h
InlineIterator.h
InlineTextBox.cpp
InlineTextBox.h
LayoutState.cpp
LayoutState.h
MediaControlElements.cpp
MediaControlElements.h
OverlapTestRequestClient.h
PointerEventsHitRules.cpp
PointerEventsHitRules.h
RenderApplet.cpp
RenderApplet.h
RenderArena.cpp
RenderArena.h
RenderBR.cpp
RenderBR.h
RenderBlock.cpp
RenderBlock.h
RenderBlockLineLayout.cpp
RenderBox.cpp
RenderBox.h
RenderBoxModelObject.cpp
RenderBoxModelObject.h
RenderButton.cpp
RenderButton.h
RenderCounter.cpp
RenderCounter.h
RenderDataGrid.cpp
RenderDataGrid.h
RenderEmbeddedObject.cpp
RenderEmbeddedObject.h
RenderFieldset.cpp
RenderFieldset.h
RenderFileUploadControl.cpp
RenderFileUploadControl.h
RenderFlexibleBox.cpp
RenderFlexibleBox.h
RenderForeignObject.cpp
RenderForeignObject.h
RenderFrame.cpp
RenderFrame.h
RenderFrameSet.cpp
RenderFrameSet.h
RenderHTMLCanvas.cpp
RenderHTMLCanvas.h
RenderImage.cpp
RenderImage.h
RenderImageGeneratedContent.cpp
RenderImageGeneratedContent.h
RenderInline.cpp
RenderInline.h
RenderLayer.cpp
RenderLayer.h
RenderLayerBacking.cpp
RenderLayerBacking.h
RenderLayerCompositor.cpp
RenderLayerCompositor.h
RenderLineBoxList.cpp
RenderLineBoxList.h
RenderListBox.cpp
RenderListBox.h
RenderListItem.cpp
RenderListItem.h
RenderListMarker.cpp
RenderListMarker.h
RenderMarquee.cpp
RenderMarquee.h
RenderMedia.cpp
RenderMedia.h
RenderMediaControls.cpp
RenderMediaControls.h
RenderMediaControlsChromium.cpp
RenderMediaControlsChromium.h
RenderMenuList.cpp
RenderMenuList.h
RenderObject.cpp
RenderObject.h
RenderObjectChildList.cpp
RenderObjectChildList.h
RenderOverflow.h
RenderPart.cpp
RenderPart.h
RenderPartObject.cpp
RenderPartObject.h
RenderPath.cpp
RenderPath.h
RenderProgress.cpp
RenderProgress.h
RenderReplaced.cpp
RenderReplaced.h
RenderReplica.cpp
RenderReplica.h
RenderRuby.cpp
RenderRuby.h
RenderRubyBase.cpp
RenderRubyBase.h
RenderRubyRun.cpp
RenderRubyRun.h
RenderRubyText.cpp
RenderRubyText.h
RenderSVGBlock.cpp
RenderSVGBlock.h
RenderSVGContainer.cpp
RenderSVGContainer.h
RenderSVGGradientStop.cpp
RenderSVGGradientStop.h
RenderSVGHiddenContainer.cpp
RenderSVGHiddenContainer.h
RenderSVGImage.cpp
RenderSVGImage.h
RenderSVGInline.cpp
RenderSVGInline.h
RenderSVGInlineText.cpp
RenderSVGInlineText.h
RenderSVGModelObject.cpp
RenderSVGModelObject.h
RenderSVGResource.h
RenderSVGResourceClipper.cpp
RenderSVGResourceClipper.h
RenderSVGResourceMarker.cpp
RenderSVGResourceMarker.h
RenderSVGResourceMasker.cpp
RenderSVGResourceMasker.h
RenderSVGRoot.cpp
RenderSVGRoot.h
RenderSVGShadowTreeRootContainer.cpp
RenderSVGShadowTreeRootContainer.h
RenderSVGTSpan.cpp
RenderSVGTSpan.h
RenderSVGText.cpp
RenderSVGText.h
RenderSVGTextPath.cpp
RenderSVGTextPath.h
RenderSVGTransformableContainer.cpp
RenderSVGTransformableContainer.h
RenderSVGViewportContainer.cpp
RenderSVGViewportContainer.h
RenderScrollbar.cpp
RenderScrollbar.h
RenderScrollbarPart.cpp
RenderScrollbarPart.h
RenderScrollbarTheme.cpp
RenderScrollbarTheme.h
RenderSelectionInfo.h
RenderSlider.cpp
RenderSlider.h
RenderTable.cpp
RenderTable.h
RenderTableCell.cpp
RenderTableCell.h
RenderTableCol.cpp
RenderTableCol.h
RenderTableRow.cpp
RenderTableRow.h
RenderTableSection.cpp
RenderTableSection.h
RenderText.cpp
RenderText.h
RenderTextControl.cpp
RenderTextControl.h
RenderTextControlMultiLine.cpp
RenderTextControlMultiLine.h
RenderTextControlSingleLine.cpp
RenderTextControlSingleLine.h
RenderTextFragment.cpp
RenderTextFragment.h
RenderTheme.cpp
RenderTheme.h
RenderThemeChromiumLinux.cpp
RenderThemeChromiumLinux.h
RenderThemeChromiumMac.h
RenderThemeChromiumSkia.cpp
RenderThemeChromiumSkia.h
RenderThemeChromiumWin.cpp
RenderThemeChromiumWin.h
RenderThemeMac.h
RenderThemeSafari.cpp
RenderThemeSafari.h
RenderThemeWin.cpp
RenderThemeWin.h
RenderThemeWince.cpp
RenderThemeWince.h
RenderTreeAsText.cpp
RenderTreeAsText.h
RenderVideo.cpp
RenderVideo.h
RenderView.cpp
RenderView.h
RenderWidget.cpp
RenderWidget.h
RenderWidgetProtector.h
RenderWordBreak.cpp
RenderWordBreak.h
RootInlineBox.cpp
RootInlineBox.h
SVGCharacterLayoutInfo.cpp
SVGCharacterLayoutInfo.h
SVGInlineFlowBox.cpp
SVGInlineFlowBox.h
SVGInlineTextBox.cpp
SVGInlineTextBox.h
SVGMarkerData.h
SVGMarkerLayoutInfo.cpp
SVGMarkerLayoutInfo.h
SVGRenderSupport.cpp
SVGRenderSupport.h
SVGRenderTreeAsText.cpp
SVGRenderTreeAsText.h
SVGRootInlineBox.cpp
SVGRootInlineBox.h
SVGShadowTreeElements.cpp
SVGShadowTreeElements.h
ScrollBehavior.cpp
ScrollBehavior.h
TableLayout.h
TextControlInnerElements.cpp
TextControlInnerElements.h
TrailingFloatsRootInlineBox.h
TransformState.cpp
TransformState.h
break_lines.cpp
break_lines.h
/usr/include/math.h
/usr/include/stdio.h
/usr/include/stdlib.h
/usr/include/string.h
/usr/include/alloca.h
/usr/include/bits/huge_val.h
/usr/include/bits/huge_valf.h
/usr/include/bits/huge_vall.h
/usr/include/bits/inf.h
/usr/include/bits/mathcalls.h
/usr/include/bits/mathdef.h
/usr/include/bits/mathinline.h
/usr/include/bits/nan.h
/usr/include/bits/stdio-ldbl.h
/usr/include/bits/stdio.h
/usr/include/bits/stdio2.h
/usr/include/bits/stdio_lim.h
/usr/include/bits/stdlib-ldbl.h
/usr/include/bits/stdlib.h
/usr/include/bits/string.h
/usr/include/bits/string2.h
/usr/include/bits/string3.h
/usr/include/bits/sys_errlist.h
/usr/include/bits/types.h
/usr/include/bits/waitflags.h
/usr/include/bits/waitstatus.h
/usr/include/features.h
/usr/include/getopt.h
/usr/include/libio.h
/usr/include/sys/types.h
/usr/include/xlocale.h
/usr/include/_G_config.h
/usr/include/bits/libio-ldbl.h
/usr/include/bits/predefs.h
/usr/include/bits/pthreadtypes.h
/usr/include/bits/stdio-lock.h
/usr/include/bits/typesizes.h
/usr/include/bits/wordsize.h
/usr/include/ctype.h
/usr/include/endian.h
/usr/include/gnu/stubs.h
/usr/include/sys/cdefs.h
/usr/include/sys/select.h
/usr/include/sys/sysmacros.h
/usr/include/time.h
/usr/include/bits/byteswap.h
/usr/include/bits/endian.h
/usr/include/bits/libc-lock.h
/usr/include/bits/select.h
/usr/include/bits/sigset.h
/usr/include/bits/time.h
/usr/include/gconv.h
/usr/include/gnu/stubs-32.h
/usr/include/wchar.h
/usr/include/bits/wchar-ldbl.h
/usr/include/bits/wchar.h
/usr/include/bits/wchar2.h
/usr/include/pthread.h
/usr/include/wctype.h
/usr/include/bits/setjmp.h
/usr/include/sched.h
/usr/include/signal.h
/usr/include/bits/sched.h
/usr/include/bits/sigaction.h
/usr/include/bits/sigcontext.h
/usr/include/bits/siginfo.h
/usr/include/bits/signum.h
/usr/include/bits/sigstack.h
/usr/include/bits/sigthread.h
/usr/include/sys/ucontext.h
